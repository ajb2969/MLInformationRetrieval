<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1603">Absorbing Markov chain</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Absorbing Markov chain</h1>
<hr/>

<p> In the mathematical theory of <a class="uri" href="probability" title="wikilink">probability</a>, an <strong>absorbing Markov chain</strong> is a <a href="Markov_chain" title="wikilink">Markov chain</a> in which every state can reach an absorbing state. An absorbing state is a state that, once entered, cannot be left.</p>

<p>Like general Markov chains, there can be continuous-time absorbing Markov chains with an infinite state space. However, this article concentrates on the discrete-time discrete-state-space case.</p>
<h2 id="formal-definition">Formal definition</h2>

<p>A Markov chain is an absorbing chain if<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<ol>
<li>there is at least one <a href="Markov_chain#Absorbing_states" title="wikilink">absorbing state</a> and</li>
<li>it is possible to go from any state to at least one absorbing state in a finite number of steps.</li>
</ol>

<p>In an absorbing Markov chain, a state that is not absorbing is called transient.</p>
<h3 id="canonical-form">Canonical form</h3>

<p>Let an absorbing Markov chain with transition matrix <em>P</em> have <em>t</em> transient states and <em>r</em> absorbing states. Then</p>

<p>

<math display="block" id="Absorbing_Markov_chain:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>Q</mi>
       </mtd>
       <mtd columnalign="center">
        <mi>R</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>ùüé</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi>I</mi>
         <mi>r</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <matrix>
     <matrixrow>
      <ci>Q</ci>
      <ci>R</ci>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>r</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=\left(\begin{array}[]{cc}Q&R\\
\mathbf{0}&I_{r}\end{array}\right),
  </annotation>
 </semantics>
</math>

 where <em>Q</em> is a <em>t</em>-by-<em>t</em> matrix, <em>R</em> is a nonzero <em>t</em>-by-<em>r</em> matrix, <strong>0</strong> is an <em>r</em>-by-<em>t</em> zero matrix, and <em>I</em><sub><em>r</em></sub> is the <em>r</em>-by-<em>r</em> identity matrix. Thus, <em>Q</em> describes the probability of transitioning from some transient state to another while <em>R</em> describes the probability of transitioning from some transient state to some absorbing state.</p>
<h2 id="fundamental-matrix">Fundamental matrix</h2>

<p>A basic property about an absorbing Markov chain is the expected number of visits to a transient state <em>j</em> starting from a transient state <em>i</em> (before being absorbed). The probability of transitioning from <em>i</em> to <em>j</em> in exactly <em>k</em> steps is the (<em>i</em>,<em>j</em>)-entry of <em>Q</em><sup>k</sup>. Summing this for all <em>k</em> (from 0 to ‚àû) yields the fundamental matrix, denoted by <em>N</em>. It is easy to prove that</p>

<p>

<math display="block" id="Absorbing_Markov_chain:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">‚àë</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">‚àû</mi>
     </munderover>
     <msup>
      <mi>Q</mi>
      <mi>k</mi>
     </msup>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>I</mi>
        <mi>t</mi>
       </msub>
       <mo>-</mo>
       <mi>Q</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>N</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Q</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>t</ci>
       </apply>
       <ci>Q</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=\sum_{k=0}^{\infty}Q^{k}=(I_{t}-Q)^{-1},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>I</em><sub><em>t</em></sub> is the <em>t</em>-by-<em>t</em> identity matrix. The (<em>i</em>,¬†<em>j</em>) entry of matrix <em>N</em> is the expected number of times the chain is in state <em>j</em>, given that the chain started in state <em>i</em>. With the matrix <em>N</em> in hand, other properties of the Markov chain are easy to obtain.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="variance-on-number-of-visits">Variance on number of visits</h3>

<p>The variance on the number of visits to a transient state <em>j</em> with starting at a transient state <em>i</em> (before being absorbed) is the (<em>i</em>,<em>j</em>)-entry of the matrix</p>

<p>

<math display="block" id="Absorbing_Markov_chain:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>N</mi>
     <mn>2</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>N</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>2</mn>
         <msub>
          <mi>N</mi>
          <mo>dg</mo>
         </msub>
        </mrow>
        <mo>-</mo>
        <msub>
         <mi>I</mi>
         <mi>t</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <msub>
      <mi>N</mi>
      <mo>sq</mo>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>N</ci>
         <ci>dg</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>N</ci>
      <ci>sq</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N_{2}=N(2N_{\operatorname{dg}}-I_{t})-N_{\operatorname{sq}},
  </annotation>
 </semantics>
</math>

 where <em>N</em><sub>dg</sub> is the <a href="diagonal_matrix" title="wikilink">diagonal matrix</a> with the same diagonal as <em>N</em> and <em>N</em><sub>sq</sub> is the <a href="Hadamard_product_(matrices)" title="wikilink">Hadamard product</a> of <em>N</em> with itself (i.e. each entry of <em>N</em> is squared).</p>
<h3 id="expected-number-of-steps">Expected number of steps</h3>

<p>The expected number of steps before being absorbed when starting in transient state <em>i</em> is the <em>i</em>th entry of the vector</p>

<p>

<math display="block" id="Absorbing_Markov_chain:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùê≠</mi>
    <mo>=</mo>
    <mrow>
     <mi>N</mi>
     <mn>ùüè</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê≠</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{t}=N\mathbf{1},
  </annotation>
 </semantics>
</math>

 where <strong>1</strong> is a length-<em>t</em> column vector whose entries are all 1.</p>
<h3 id="variance-on-number-of-steps">Variance on number of steps</h3>

<p>The variance on the number of steps before being absorbed when starting in transient state <em>i</em> is the <em>i</em>th entry of the vector</p>

<p>

<math display="block" id="Absorbing_Markov_chain:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>N</mi>
       </mrow>
       <mo>-</mo>
       <msub>
        <mi>I</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>ùê≠</mi>
    </mrow>
    <mo>-</mo>
    <msub>
     <mi>ùê≠</mi>
     <mo>sq</mo>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>ùê≠</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ùê≠</ci>
     <ci>sq</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2N-I_{t})\mathbf{t}-\mathbf{t}_{\operatorname{sq}},
  </annotation>
 </semantics>
</math>

 where <strong>t</strong><sub>sq</sub> is the <a href="Hadamard_product_(matrices)" title="wikilink">Hadamard product</a> of <strong>t</strong> with itself (i.e. each entry of <strong>t</strong> is squared).</p>
<h3 id="transient-probabilities">Transient probabilities</h3>

<p>The probability of visiting transient state <em>j</em> when starting at a transient state <em>i</em> is the (<em>i</em>,<em>j</em>)-entry of the matrix</p>

<p>

<math display="block" id="Absorbing_Markov_chain:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <msub>
        <mi>I</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msubsup>
      <mi>N</mi>
      <mo>dg</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>N</ci>
       <ci>dg</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=(N-I_{t})N_{\operatorname{dg}}^{-1}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="absorbing-probabilities">Absorbing probabilities</h3>

<p>Another property is the probability of being absorbed in the absorbing state <em>j</em> when starting from transient state <em>i</em>, which is the (<em>i</em>,<em>j</em>)-entry of the matrix</p>

<p>

<math display="block" id="Absorbing_Markov_chain:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mrow>
     <mi>N</mi>
     <mi>R</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>B</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=NR.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="examples">Examples</h2>
<h3 id="string-generation">String generation</h3>

<p>Consider the process of repeatedly flipping a <a href="fair_coin" title="wikilink">fair coin</a> until the sequence (heads, tails, heads) appears. This process is modeled by an absorbing Markov chain with transition matrix</p>

<p>

<math display="block" id="Absorbing_Markov_chain:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>P</ci>
    <matrix>
     <matrixrow>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P=\begin{bmatrix}1/2&1/2&0&0\\
0&1/2&1/2&0\\
1/2&0&0&1/2\\
0&0&0&1\end{bmatrix}.
  </annotation>
 </semantics>
</math>

 The first state represents the <a href="empty_string" title="wikilink">empty string</a>, the second state the string "H", the third state the string "HT", and the fourth state the string "HTH". Although in reality, the coin flips cease after the string "HTH" is generated, the perspective of the absorbing Markov chain is that the process has transitioned into the absorbing state representing the string "HTH" and, therefore, cannot leave.</p>

<p>For this absorbing Markov chain, the fundamental matrix is</p>

<p>

<math display="block" id="Absorbing_Markov_chain:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>N</mi>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>I</mi>
       <mo>-</mo>
       <mi>Q</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>[</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mo>[</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mrow>
            <mn>1</mn>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <mn>1</mn>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <mn>1</mn>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
          </mtd>
          <mtd columnalign="center">
           <mrow>
            <mn>1</mn>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mrow>
            <mn>1</mn>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
         </mtr>
        </mtable>
        <mo>]</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>4</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>2</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>I</ci>
       <ci>Q</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <matrix>
        <matrixrow>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
        </matrixrow>
        <matrixrow>
         <cn type="integer">0</cn>
         <cn type="integer">1</cn>
         <cn type="integer">0</cn>
        </matrixrow>
        <matrixrow>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
         <cn type="integer">1</cn>
        </matrixrow>
       </matrix>
       <matrix>
        <matrixrow>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">0</cn>
        </matrixrow>
        <matrixrow>
         <cn type="integer">0</cn>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">0</cn>
         <cn type="integer">0</cn>
        </matrixrow>
       </matrix>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <matrix>
       <matrixrow>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">0</cn>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="integer">4</cn>
       <cn type="integer">4</cn>
       <cn type="integer">2</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">2</cn>
       <cn type="integer">4</cn>
       <cn type="integer">2</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">2</cn>
       <cn type="integer">2</cn>
       <cn type="integer">2</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=(I-Q)^{-1}=\left(\begin{bmatrix}1&0&0\\
0&1&0\\
0&0&1\end{bmatrix}-\begin{bmatrix}1/2&1/2&0\\
0&1/2&1/2\\
1/2&0&0\end{bmatrix}\right)^{-1}=\begin{bmatrix}1/2&-1/2&0\\
0&1/2&-1/2\\
-1/2&0&1\end{bmatrix}^{-1}=\begin{bmatrix}4&4&2\\
2&4&2\\
2&2&2\end{bmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>The expected number of steps starting from each of the transient states is</p>

<p>

<math display="block" id="Absorbing_Markov_chain:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>ùê≠</mi>
    <mo>=</mo>
    <mrow>
     <mi>N</mi>
     <mn>ùüè</mn>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>4</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
        <mtd columnalign="center">
         <mn>2</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>10</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>8</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>6</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>ùê≠</ci>
     <apply>
      <times></times>
      <ci>N</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <matrix>
       <matrixrow>
        <cn type="integer">4</cn>
        <cn type="integer">4</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">4</cn>
        <cn type="integer">2</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
        <cn type="integer">2</cn>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <matrix>
      <matrixrow>
       <cn type="integer">10</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">8</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">6</cn>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{t}=N\mathbf{1}=\begin{bmatrix}4&4&2\\
2&4&2\\
2&2&2\end{bmatrix}\begin{bmatrix}1\\
1\\
1\end{bmatrix}=\begin{bmatrix}10\\
8\\
6\end{bmatrix}.
  </annotation>
 </semantics>
</math>

 Therefore, the expected number of coin flips before observing the sequence (heads, tails, heads) is 10, the entry for the state representing the empty string.</p>
<h3 id="games-of-chance">Games of chance</h3>

<p> Games based entirely on chance can be modeled by an absorbing Markov chain. A classic example of this is the ancient Indian board game <a href="Snakes_and_Ladders" title="wikilink">Snakes and Ladders</a>. The graph on the right<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> plots the probability mass in the lone absorbing state that represents the final square as the transition matrix is raised to larger and larger powers. To determine the expected number of turns to complete the game, compute the vector <strong>t</strong> as described above and examine <strong>t</strong><sub>start</sub>, which is approximately 39.2.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Discrete_phase-type_distribution" title="wikilink">Discrete phase-type distribution</a></li>
<li><a href="Absorbing_set_(random_dynamical_systems)" title="wikilink">Absorbing set (random dynamical systems)</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://demonstrations.wolfram.com/AbsorbingMarkovChain/">Wolfram Demonstration Project: Absorbing Markov Chain</a></li>
<li><a href="http://www.bewersdorff-online.de/amonopoly/">Monopoly as a Markov chain</a></li>
</ul>

<p>"</p>

<p><a href="Category:Markov_processes" title="wikilink">Category:Markov processes</a> <a href="Category:Markov_models" title="wikilink">Category:Markov models</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4">Based on the definition found in <a href="#fnref4">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="623">Autoregressive–moving-average model</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Autoregressive–moving-average model</h1>
<hr/>

<p>In the <a href="statistics" title="wikilink">statistical</a> analysis of <a href="time_series" title="wikilink">time series</a>, <strong>autoregressive–moving-average</strong> (<strong>ARMA</strong>) <strong>models</strong> provide a parsimonious description of a <a href="stationary_stochastic_process" title="wikilink">(weakly) stationary stochastic process</a> in terms of two polynomials, one for the <a href="AR_model" title="wikilink">auto-regression</a> and the second for the <a href="MA_model" title="wikilink">moving average</a>. The general ARMA model was described in the 1951 thesis of <a href="Peter_Whittle" title="wikilink">Peter Whittle</a>, <em>Hypothesis testing in time series analysis</em>, and it was popularized in the 1971 book by <a href="George_E._P._Box" title="wikilink">George E. P. Box</a> and <a href="Gwilym_Jenkins" title="wikilink">Gwilym Jenkins</a>.</p>

<p>Given a time series of data <em>X</em><sub><em>t</em></sub>, the ARMA model is a tool for understanding and, perhaps, predicting future values in this series. The model consists of two parts, an autoregressive (AR) part and a moving average (MA) part. The model is usually then referred to as the ARMA(<em>p</em>,<em>q</em>) model where <em>p</em> is the order of the autoregressive part and <em>q</em> is the order of the moving average part (as defined below).</p>
<h2 id="autoregressive-model">Autoregressive model</h2>

<p>The notation AR(<em>p</em>) refers to the autoregressive model of order <em>p</em>. The AR(<em>p</em>) model is written</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:0">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>c</mi>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>p</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>X</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>c</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=c+\sum_{i=1}^{p}\varphi_{i}X_{t-i}+\varepsilon_{t}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Autoregressive–moving-average_model:1">
 <semantics>
  <mrow>
   <msub>
    <mi>φ</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>φ</mi>
    <mi>p</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>φ</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>φ</ci>
     <ci>p</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi_{1},\ldots,\varphi_{p}
  </annotation>
 </semantics>
</math>

 are <a href="parameter" title="wikilink">parameters</a>, 

<math display="inline" id="Autoregressive–moving-average_model:2">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 is a constant, and the random variable 

<math display="inline" id="Autoregressive–moving-average_model:3">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{t}
  </annotation>
 </semantics>
</math>

 is <a href="white_noise" title="wikilink">white noise</a>.</p>

<p>Some constraints are necessary on the values of the parameters so that the model remains <a href="stationary_process" title="wikilink">stationary</a>. For example, processes in the AR(1) model with |<em>φ</em><sub>1</sub>| ≥ 1 are not stationary.</p>
<h2 id="moving-average-model">Moving-average model</h2>

<p>The notation MA(<em>q</em>) refers to the moving average model of order <em>q</em>:</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:4">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>μ</mi>
    <mo>+</mo>
    <msub>
     <mi>ε</mi>
     <mi>t</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>q</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>θ</mi>
       <mi>i</mi>
      </msub>
      <mpadded width="+1.7pt">
       <msub>
        <mi>ε</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>μ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>q</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ε</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=\mu+\varepsilon_{t}+\sum_{i=1}^{q}\theta_{i}\varepsilon_{t-i}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where the θ<sub>1</sub>, ..., θ<sub><em>q</em></sub> are the parameters of the model, μ is the expectation of 

<math display="inline" id="Autoregressive–moving-average_model:5">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}
  </annotation>
 </semantics>
</math>

 (often assumed to equal 0), and the 

<math display="inline" id="Autoregressive–moving-average_model:6">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{t}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Autoregressive–moving-average_model:7">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mrow>
    <mi>t</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <apply>
     <minus></minus>
     <ci>t</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{t-1}
  </annotation>
 </semantics>
</math>

,... are again, <a href="white_noise" title="wikilink">white noise</a> error terms.</p>
<h2 id="arma-model">ARMA model</h2>

<p>The notation ARMA(<em>p</em>, <em>q</em>) refers to the model with <em>p</em> autoregressive terms and <em>q</em> moving-average terms. This model contains the AR(<em>p</em>) and MA(<em>q</em>) models,</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:8">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>c</mi>
     <mo>+</mo>
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>p</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>X</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>q</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>ε</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>c</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>q</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ε</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=c+\varepsilon_{t}+\sum_{i=1}^{p}\varphi_{i}X_{t-i}+\sum_{i=1}^{q}\theta_%
{i}\varepsilon_{t-i}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>The general ARMA model was described in the 1951 thesis of <a href="Peter_Whittle" title="wikilink">Peter Whittle</a>, who used mathematical analysis (<a href="Laurent_series" title="wikilink">Laurent series</a> and <a href="Fourier_analysis" title="wikilink">Fourier analysis</a>) and statistical inference.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><ref> </ref></p>
<dl>
<dd>Republished as:  ARMA models were popularized by a 1971 book by <a href="George_E._P._Box" title="wikilink">George E. P. Box</a> and Jenkins, who expounded an iterative (<a class="uri" href="Box–Jenkins" title="wikilink">Box–Jenkins</a>) method for choosing and estimating them. This method was useful for low-order polynomials (of degree three or less).<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a>
</dd>
</dl>
<h2 id="note-about-the-error-terms">Note about the error terms</h2>

<p>The error terms 

<math display="inline" id="Autoregressive–moving-average_model:9">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{t}
  </annotation>
 </semantics>
</math>

 are generally assumed to be <a href="independent_identically_distributed_random_variables" title="wikilink">independent identically distributed random variables</a> (i.i.d.) sampled from a <a href="normal_distribution" title="wikilink">normal distribution</a> with zero mean

<math display="block" id="Autoregressive–moving-average_model:10">
 <semantics>
  <msub>
   <mi>ε</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ε</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{t}
  </annotation>
 </semantics>
</math>

 ~ N(0,σ<sup>2</sup>) where σ<sup>2</sup> is the variance. These assumptions may be weakened but doing so will change the properties of the model. In particular, a change to the i.i.d. assumption would make a rather fundamental difference.</p>
<h2 id="specification-in-terms-of-lag-operator">Specification in terms of lag operator</h2>

<p>In some texts the models will be specified in terms of the <a href="lag_operator" title="wikilink">lag operator</a> <em>L</em>. In these terms then the AR(<em>p</em>) model is given by</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:11">
 <semantics>
  <mrow>
   <msub>
    <mi>ε</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>p</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>φ</mi>
         <mi>i</mi>
        </msub>
        <msup>
         <mi>L</mi>
         <mi>i</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>L</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mi>X</mi>
      <mi>t</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>p</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>φ</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>L</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>φ</ci>
      <ci>L</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varepsilon_{t}=\left(1-\sum_{i=1}^{p}\varphi_{i}L^{i}\right)X_{t}=\varphi(L)X%
_{t}\,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Autoregressive–moving-average_model:12">
 <semantics>
  <mi>φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi
  </annotation>
 </semantics>
</math>

 represents the polynomial</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>φ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>L</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>p</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <msup>
        <mi>L</mi>
        <mi>i</mi>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>φ</ci>
     <ci>L</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>L</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(L)=1-\sum_{i=1}^{p}\varphi_{i}L^{i}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Autoregressive–moving-average_model:14">
 <semantics>
  <mi>L</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>L</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L
  </annotation>
 </semantics>
</math>

 indicating the shift parameter</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>L</mi>
      <mi>d</mi>
     </msup>
     <msub>
      <mi>X</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>X</mi>
     <mrow>
      <mi>t</mi>
      <mo>-</mo>
      <mi>d</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>L</ci>
      <ci>d</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <apply>
      <minus></minus>
      <ci>t</ci>
      <ci>d</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L^{d}X_{t}=X_{t-d}.
  </annotation>
 </semantics>
</math>

</p>

<p>The MA(<em>q</em>) model is given by</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:16">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>q</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>θ</mi>
          <mi>i</mi>
         </msub>
         <msup>
          <mi>L</mi>
          <mi>i</mi>
         </msup>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>θ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>L</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>q</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>L</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ε</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>θ</ci>
      <ci>L</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ε</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=\left(1+\sum_{i=1}^{q}\theta_{i}L^{i}\right)\varepsilon_{t}=\theta(L)%
\varepsilon_{t},\,
  </annotation>
 </semantics>
</math>

</p>

<p>where θ represents the polynomial</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>θ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>L</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>q</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
       <msup>
        <mi>L</mi>
        <mi>i</mi>
       </msup>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>θ</ci>
     <ci>L</ci>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>q</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>L</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta(L)=1+\sum_{i=1}^{q}\theta_{i}L^{i}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>Finally, the combined ARMA(<em>p</em>, <em>q</em>) model is given by</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>p</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>φ</mi>
          <mi>i</mi>
         </msub>
         <msup>
          <mi>L</mi>
          <mi>i</mi>
         </msup>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>X</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>q</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>θ</mi>
          <mi>i</mi>
         </msub>
         <msup>
          <mi>L</mi>
          <mi>i</mi>
         </msup>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>ε</mi>
       <mi>t</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>φ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>L</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>q</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>L</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(1-\sum_{i=1}^{p}\varphi_{i}L^{i}\right)X_{t}=\left(1+\sum_{i=1}^{q}%
\theta_{i}L^{i}\right)\varepsilon_{t}\,,
  </annotation>
 </semantics>
</math>

</p>

<p>or more concisely,</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:19">
 <semantics>
  <mrow>
   <mrow>
    <mi>φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>L</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>θ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>L</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>φ</ci>
     <ci>L</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>θ</ci>
     <ci>L</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(L)X_{t}=\theta(L)\varepsilon_{t}\,
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <mi>φ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>L</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>θ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>L</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
     <msub>
      <mi>X</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>φ</ci>
       <ci>L</ci>
      </apply>
      <apply>
       <times></times>
       <ci>θ</ci>
       <ci>L</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ε</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\varphi(L)}{\theta(L)}X_{t}=\varepsilon_{t}\,.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="alternative-notation">Alternative notation</h3>

<p>Some authors, including <a href="George_Box" title="wikilink">Box</a>, <a href="Gwilym_M._Jenkins" title="wikilink">Jenkins</a> &amp; Reinsel use a different convention for the autoregression coefficients.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> This allows all the polynomials involving the lag operator to appear in a similar form throughout. Thus the ARMA model would be written as</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>p</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>ϕ</mi>
          <mi>i</mi>
         </msub>
         <msup>
          <mi>L</mi>
          <mi>i</mi>
         </msup>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>X</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>q</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>θ</mi>
          <mi>i</mi>
         </msub>
         <msup>
          <mi>L</mi>
          <mi>i</mi>
         </msup>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>ε</mi>
       <mi>t</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>p</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ϕ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>L</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>q</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>L</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(1+\sum_{i=1}^{p}\phi_{i}L^{i}\right)X_{t}=\left(1+\sum_{i=1}^{q}\theta_{%
i}L^{i}\right)\varepsilon_{t}\,.
  </annotation>
 </semantics>
</math>

 Moreover, if we set 

<math display="inline" id="Autoregressive–moving-average_model:22">
 <semantics>
  <mrow>
   <msub>
    <mi>ϕ</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>θ</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ϕ</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi_{0}=\theta_{0}=1
  </annotation>
 </semantics>
</math>

, then we get an even more elegant formulation: 

<math display="inline" id="Autoregressive–moving-average_model:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>p</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>ϕ</mi>
       <mi>i</mi>
      </msub>
      <mpadded width="+2.8pt">
       <msup>
        <mi>L</mi>
        <mi>i</mi>
       </msup>
      </mpadded>
      <msub>
       <mi>X</mi>
       <mi>t</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>q</mi>
     </msubsup>
     <mrow>
      <msub>
       <mi>θ</mi>
       <mi>i</mi>
      </msub>
      <mpadded width="+2.8pt">
       <msup>
        <mi>L</mi>
        <mi>i</mi>
       </msup>
      </mpadded>
      <mpadded width="+1.7pt">
       <msub>
        <mi>ε</mi>
        <mi>t</mi>
       </msub>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>p</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>q</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>L</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ε</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=0}^{p}\phi_{i}L^{i}\;X_{t}=\sum_{i=0}^{q}\theta_{i}L^{i}\;\varepsilon_%
{t}\,.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="fitting-models">Fitting models</h2>

<p>ARMA models in general can, after choosing p and q, be fitted by <a href="least_squares" title="wikilink">least squares</a> regression to find the values of the parameters which minimize the error term. It is generally considered good practice to find the smallest values of p and q which provide an acceptable fit to the data. For a pure AR model the <a href="AR_model#Calculation_of_the_AR_parameters" title="wikilink">Yule-Walker equations</a> may be used to provide a fit.</p>

<p>Finding appropriate values of <em>p</em> and <em>q</em> in the ARMA(<em>p</em>,<em>q</em>) model can be facilitated by plotting the <a href="partial_autocorrelation_function" title="wikilink">partial autocorrelation functions</a> for an estimate of <em>p</em>, and likewise using the <a href="autocorrelation_function" title="wikilink">autocorrelation functions</a> for an estimate of <em>q</em>. Further information can be gleaned by considering the same functions for the residuals of a model fitted with an initial selection of <em>p</em> and <em>q</em>.</p>

<p>Brockwell and Davis recommend using <a href="Akaike_information_criterion" title="wikilink">AICc</a> for finding <em>p</em> and <em>q</em>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="implementations-in-statistics-packages">Implementations in statistics packages</h3>
<ul>
<li>In <a href="R_(programming_language)" title="wikilink">R</a>, the <em>arima</em> function (in standard package <em>stats</em>) is documented in <a href="http://search.r-project.org/R/library/stats/html/arima.html">ARIMA Modelling of Time Series</a>. Extension packages contain related and extended functionality, e.g., the <em>tseries</em> package includes an <em>arma</em> function, documented in <a href="http://finzi.psych.upenn.edu/R/library/tseries/html/arma.html">"Fit ARMA Models to Time Series"</a>; the <a href="http://cran.r-project.org/web/packages/fracdiff"><em>fracdiff</em> package</a> contains <em>fracdiff()</em> for fractionally integrated ARMA processes, etc. The CRAN task view on <a href="http://cran.r-project.org/web/views/TimeSeries.html">Time Series</a> contains links to most of these.</li>
<li><a class="uri" href="Mathematica" title="wikilink">Mathematica</a> has a complete library of time series functions including ARMA.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></li>
<li><a class="uri" href="MATLAB" title="wikilink">MATLAB</a> includes functions such as <a href="http://www.mathworks.com/help/econ/arma-model.html"><em>arma</em></a> and <a href="http://www.mathworks.com/help/ident/ref/ar.html"><em>ar</em></a> to estimate AR, ARX (autoregressive exogenous), and ARMAX models. See <a href="http://www.mathworks.com/help/ident/ug/estimating-ar-and-arma-models.html">System Identification Toolbox</a> and <a href="http://www.mathworks.com/help/econ/arima.estimate.html">Econometrics Toolbox</a> for more information.</li>
<li><a class="uri" href="Statsmodels" title="wikilink">Statsmodels</a> Python module includes many models and functions for time series analysis, including ARMA. Formerly part of <a class="uri" href="Scikit-learn" title="wikilink">Scikit-learn</a> it is now stand-alone and integrates well with <a href="Pandas_(software)" title="wikilink">Pandas</a>. <a href="http://statsmodels.sourceforge.net/">See here for more details</a>.</li>
<li><a href="IMSL_Numerical_Libraries" title="wikilink">IMSL Numerical Libraries</a> are libraries of numerical analysis functionality including ARMA and ARIMA procedures implemented in standard programming languages like C, Java, C# .NET, and Fortran.</li>
<li><a class="uri" href="gretl" title="wikilink">gretl</a> can also estimate ARMA model, <a href="http://constantdream.wordpress.com/2008/03/16/gnu-regression-econometrics-and-time-series-library-gretl/">see here where it's mentioned</a>.</li>
<li><a href="GNU_Octave" title="wikilink">GNU Octave</a> can estimate AR models using functions from the extra package <a href="http://octave.sourceforge.net/">octave-forge</a>.</li>
<li><a class="uri" href="Stata" title="wikilink">Stata</a> includes the function <em>arima</em> which can estimate ARMA and <a href="Autoregressive_integrated_moving_average" title="wikilink">ARIMA</a> models. [<a class="uri" href="http://www.stata.com/help.cgi?arima">http://www.stata.com/help.cgi?arima</a>. See here for more details].</li>
<li><a class="uri" href="SuanShu" title="wikilink">SuanShu</a> is a Java library of numerical methods, including comprehensive statistics packages, in which univariate/multivariate ARMA, ARIMA, ARMAX, etc. models are implemented in an object-oriented approach. These implementations are documented in <a href="http://www.numericalmethod.com/javadoc/suanshu/">"SuanShu, a Java numerical and statistical library"</a>.</li>
<li>SAS has an econometric package, ETS, that estimates ARIMA models. <a href="http://support.sas.com/rnd/app/ets/proc/ets_arima.html">See here for more details</a>.</li>
</ul>
<h2 id="applications">Applications</h2>

<p>ARMA is appropriate when a system is a function of a series of unobserved shocks (the MA part) as well as its own behavior. For example, stock prices may be shocked by fundamental information as well as exhibiting technical trending and mean-reversion effects due to market participants.</p>
<h2 id="generalizations">Generalizations</h2>

<p>The dependence of <em>X</em><sub><em>t</em></sub> on past values and the error terms ε<sub>t</sub> is assumed to be linear unless specified otherwise. If the dependence is nonlinear, the model is specifically called a <em>nonlinear moving average</em> (NMA), <em>nonlinear autoregressive</em> (NAR), or <em>nonlinear autoregressive–moving-average</em> (NARMA) model.</p>

<p>Autoregressive–moving-average models can be generalized in other ways. See also <a href="autoregressive_conditional_heteroskedasticity" title="wikilink">autoregressive conditional heteroskedasticity</a> (ARCH) models and <a href="autoregressive_integrated_moving_average" title="wikilink">autoregressive integrated moving average</a> (ARIMA) models. If multiple time series are to be fitted then a vector ARIMA (or VARIMA) model may be fitted. If the time-series in question exhibits long memory then fractional ARIMA (FARIMA, sometimes called ARFIMA) modelling may be appropriate: see <a href="Autoregressive_fractionally_integrated_moving_average" title="wikilink">Autoregressive fractionally integrated moving average</a>. If the data is thought to contain seasonal effects, it may be modeled by a SARIMA (seasonal ARIMA) or a periodic ARMA model.</p>

<p>Another generalization is the <em>multiscale autoregressive</em> (MAR) model. A MAR model is indexed by the nodes of a tree, whereas a standard (discrete time) autoregressive model is indexed by integers.</p>

<p>Note that the ARMA model is a <strong>univariate</strong> model. Extensions for the multivariate case are the <a href="Vector_Autoregression" title="wikilink">Vector Autoregression</a> (VAR) and Vector Autoregression Moving-Average (VARMA).</p>
<h3 id="autoregressivemoving-average-model-with-exogenous-inputs-model-armax-model">Autoregressive–moving-average model with exogenous inputs model (ARMAX model)</h3>

<p>The notation ARMAX(<em>p</em>, <em>q</em>, <em>b</em>) refers to the model with <em>p</em> autoregressive terms, <em>q</em> moving average terms and <em>b</em> exogenous inputs terms. This model contains the AR(<em>p</em>) and MA(<em>q</em>) models and a linear combination of the last <em>b</em> terms of a known and external time series 

<math display="inline" id="Autoregressive–moving-average_model:24">
 <semantics>
  <msub>
   <mi>d</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{t}
  </annotation>
 </semantics>
</math>

. It is given by:</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:25">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>X</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>p</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>X</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>q</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>ε</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>b</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>η</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>d</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>q</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ε</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>b</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>η</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}=\varepsilon_{t}+\sum_{i=1}^{p}\varphi_{i}X_{t-i}+\sum_{i=1}^{q}\theta_{i%
}\varepsilon_{t-i}+\sum_{i=0}^{b}\eta_{i}d_{t-i}.\,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Autoregressive–moving-average_model:26">
 <semantics>
  <mrow>
   <msub>
    <mi>η</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>η</mi>
    <mi>b</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>η</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>η</ci>
     <ci>b</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta_{1},\ldots,\eta_{b}
  </annotation>
 </semantics>
</math>

 are the <strong><em>parameters</em></strong> of the exogenous input 

<math display="inline" id="Autoregressive–moving-average_model:27">
 <semantics>
  <msub>
   <mi>d</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{t}
  </annotation>
 </semantics>
</math>

.</p>

<p>Some nonlinear variants of models with exogenous variables have been defined: see for example <a href="Nonlinear_autoregressive_exogenous_model" title="wikilink">Nonlinear autoregressive exogenous model</a>.</p>

<p>Statistical packages implement the ARMAX model through the use of "exogenous" or "independent" variables. Care must be taken when interpreting the output of those packages, because the estimated parameters usually (for example, in <a href="R_(programming_language)" title="wikilink">R</a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> and <a class="uri" href="gretl" title="wikilink">gretl</a>) refer to the regression:</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>X</mi>
      <mi>t</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>m</mi>
      <mi>t</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>ε</mi>
      <mi>t</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>p</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>φ</mi>
        <mi>i</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>X</mi>
          <mrow>
           <mi>t</mi>
           <mo>-</mo>
           <mi>i</mi>
          </mrow>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>m</mi>
          <mrow>
           <mi>t</mi>
           <mo>-</mo>
           <mi>i</mi>
          </mrow>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>q</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>ε</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>φ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <apply>
          <minus></minus>
          <ci>t</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <apply>
          <minus></minus>
          <ci>t</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>q</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ε</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{t}-m_{t}=\varepsilon_{t}+\sum_{i=1}^{p}\varphi_{i}(X_{t-i}-m_{t-i})+\sum_{i%
=1}^{q}\theta_{i}\varepsilon_{t-i}.\,
  </annotation>
 </semantics>
</math>

 where <em>m<sub>t</sub></em> incorporates all exogenous (or independent) variables:</p>

<p>

<math display="block" id="Autoregressive–moving-average_model:29">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>m</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>c</mi>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>b</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>η</mi>
        <mi>i</mi>
       </msub>
       <msub>
        <mi>d</mi>
        <mrow>
         <mi>t</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>c</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>b</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>η</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{t}=c+\sum_{i=0}^{b}\eta_{i}d_{t-i}.\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Exponential_smoothing" title="wikilink">Exponential smoothing</a></li>
<li><a href="Linear_predictive_coding" title="wikilink">Linear predictive coding</a></li>
<li><a href="Predictive_analytics" title="wikilink">Predictive analytics</a></li>
<li><a href="autoregressive_integrated_moving_average" title="wikilink">Arima, autoregressive integrated moving average</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Noise" title="wikilink">Category:Noise</a> <a href="Category:Time_series_analysis" title="wikilink">Category:Time series analysis</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">: <a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="http://www.wolfram.com/products/applications/timeseries/features.html">Time series features in Mathematica</a><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="http://search.r-project.org/R/library/stats/html/arima.html">ARIMA Modelling of Time Series</a>, R documentation<a href="#fnref6">↩</a></li>
</ol>
</section>
</body>
</html>

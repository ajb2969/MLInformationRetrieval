


Calkin–Wilf tree




Calkin–Wilf tree

  In number theory, the Calkin–Wilf tree is a tree in which the vertices correspond 1-for-1 to the positive rational numbers. The tree is rooted at the number 1, and any rational number expressed in simplest terms as the fraction a/b has as its two children the numbers a/(a + b) and (a + b)/b. Every positive rational number appears exactly once in the tree.
The sequence of rational numbers in a breadth-first traversal of the Calkin–Wilf tree is known as the Calkin–Wilf sequence. Its sequence of numerators (or, offset by one, denominators) is Stern's diatomic series, and can be computed by the fusc function.
The Calkin–Wilf tree is named after Neil Calkin and Herbert Wilf, who considered it in their 2000 paper. The tree was introduced earlier by Jean Berstel and Aldo de Luca1 as Raney tree, since they drew some ideas from a paper by George N. Raney.2 Stern's diatomic series was formulated much earlier by Moritz Abraham Stern, a 19th-century German mathematician who also invented the closely related Stern–Brocot tree.
Definition and structure
 The Calkin–Wilf tree may be defined as a directed graph in which each positive rational number a/b occurs as a vertex and has one outgoing edge to another vertex, its parent. We assume that a/b is in simplest terms; that is, the greatest common divisor of a and b is 1. If a/b The description here is dual to the original definition by Calkin and Wilf, which begins by defining the child relationship and derives the parent relationship as part of a proof that every rational appears once in the tree. As defined here, every rational appears once by definition, and instead the fact that the resulting structure is a tree requires a proof.
Although it is a binary tree (each vertex has two children), the Calkin–Wilf tree is not a binary search tree: its inorder does not coincide with the sorted order of its vertices. However, it is closely related to a different binary search tree on the same set of vertices, the Stern–Brocot tree: the vertices at each level of the two trees coincide, and are related to each other by a bit-reversal permutation.
Breadth first traversal
 The Calkin–Wilf sequence is the sequence of rational numbers generated by a breadth-first traversal of the Calkin–Wilf tree,

1/1, 1/2, 2/1, 1/3, 3/2, 2/3, 3/1, 1/4, 4/3, 3/5, 5/2, 2/5, 5/3, 3/4, ….
 

Because the Calkin–Wilf tree contains every positive rational number exactly once, so does this sequence.3 The denominator of each fraction equals the numerator of the next fraction in the sequence. The Calkin–Wilf sequence can also be generated directly by the formula



where 
 
 
 
  denotes the ith number in the sequence, starting from 
 
 
 
 , and 
 
 
 
  represents the integral part.4
It's also possible to calculate 
 
 
 
  directly. If you count successively equal digits of the binary code of i you get the continued fraction of 
 
 
 
 . You must start counting 1-digits at the end of the binary code. Then you continue counting 0-digits backwards, then you continue counting 1-digits backward and so on.
Example:
 i = 1081 = 
 
 
 
 : The continued fraction is [1;2,3,4,1] hence 
 
 
 
 .
 i = 1990 = 
 
 
 
 : The continued fraction is [0;1,2,3,5] hence 
 
 
 
 .
  If you calculate the continued fraction of any 
 
 
 
  you can determine i.
 Example:

 
 : The continued fraction is [0;1,3] hence i = 
 
 
 
  = 14.

 
 : The continued fraction is [1;3]. But the length of the continued fraction must be a odd number. So you must use [1;2,1] instead which equals [1;3]. Hence i = 
 
 
 
  = 9.
Stern's diatomic sequence
 Stern's diatomic sequence is the integer sequence

0, 1, 1, 2, 1, 3, 2, 3, 1, 4, 3, 5, 2, 5, 3, 4, … .
 

Using zero-based numbering, the nth value in the sequence is the value fusc(n) of the fusc function,5 defined by the recurrence relations fusc(2n) = fusc(n) and fusc(2n + 1) = fusc(n) + fusc(n + 1), with the base cases fusc(0) = 0 and fusc(1) = 1. The nth rational number in a breadth-first traversal of the Calkin–Wilf tree is the number fusc(n) / fusc(n + 1).6 Thus, the diatomic sequence forms both the sequence of numerators and the sequence of denominators of the numbers in the Calkin–Wilf sequence.
The function fusc(n + 1) is the number of odd binomial coefficients of the form $\scriptstyle {n-r\choose r},\ 0\leq 2r{{harvtxt|Carlitz|1964}}. and
 also counts the number of ways of writing ''n'' as a sum of [[power of two|powers of two]] in which each power occurs at most twice. This can be seen from the recurrence defining fusc: the expressions as a sum of powers of two for an even number 2''n'' either have no 1's in them (in which case they are formed by doubling each term an expression for ''n'') or two 1's (in which case the rest of the expression is formed by doubling each term in an expression for ''n'' − 1), so the number of representations is the sum of the number of representations for ''n'' and for ''n'' − 1, matching the recurrence. Similarly, each representation for an odd number 2''n'' + 1 is formed by doubling a representation for ''n'' and adding 1, again matching the recurrence.The OEIS entry credits this fact to {{harvtxt|Carlitz|1964}} and to uncited work of Lind. However, Carlitz' paper describes a more restricted class of sums of powers of two, counted by fusc(''n'') instead of by fusc(''n'' + 1). For instance,
 :6 = 4 + 2 = 4 + 1 + 1 = 2 + 2 + 1 + 1
 has three representations as a sum of powers of two with at most two copies of each power, so fusc(6 + 1) = 3.
 
 ==Relation to Stern–Brocot tree==
 The Calkin–Wilf tree resembles the [[Stern–Brocot tree]] in that both are binary trees with each positive rational number appearing exactly once. Additionally, the top levels of the two trees appear very similar, and in both trees the same numbers appear at the same levels. One tree can be obtained from the other by performing a [[bit-reversal permutation]] on the numbers at each level of the trees.{{sfnp|Gibbons|Lester|Bird|2006}} Alternatively, the number at a given node of the Calkin–Wilf tree can be converted into the number at the same position in the Stern–Brocot tree, and vice versa, by a process involving the reversal of the [[continued fraction]] representations of these numbers.{{sfnp|Bates|Bunder|Tognetti|2010}}
 However, in other ways they have different properties: for instance, the Stern–Brocot tree is a [[binary search tree]]: the left-to-right traversal order of the tree is the same as the numerical order of the numbers in it. This property is not true of the Calkin–Wilf tree.
 
 ==Notes==
 {{reflist}}
 
 ==References==
 *{{citation
  | last1 = Aigner | first1 = Martin| author1-link = Martin Aigner
 | last2 = Ziegler | first2 = Günter M. | author2-link = Günter M. Ziegler
  | edition = 3rd
  | isbn = 978-3-540-40460-6
  | location = Berlin; New York
  | publisher = Springer
  | title = [[Proofs from THE BOOK]]
  | pages = 94–97
  | year = 2004}}
 *{{citation
  | last1 = Bates | first1 = Bruce
  | last2 = Bunder | first2 = Martin
  | last3 = Tognetti | first3 = Keith
  | doi = 10.1016/j.ejc.2010.04.002
  | issue = 7
  | journal = European Journal of Combinatorics
  | mr = 2673006
  | pages = 1637–1661
  | title = Linking the Calkin-Wilf and Stern-Brocot trees
  | volume = 31
  | year = 2010}}
 *{{citation
  | last1 = Berstel | first1 = Jean
  | last2 = de Luca | first2 = Aldo
  | year = 1997
  | title = Sturmian words, Lyndon words and trees
  | journal = [[Theoretical Computer Science (journal)|Theoretical Computer Science]]
  | volume = 178
  | pages = 171–203
  | doi = 10.1016/S0304-3975(96)00101-6}}
 *{{citation
  | last1 = Calkin | first1 = Neil
  | last2 = Wilf | first2 = Herbert
  | issue = 4
  | journal = [[American Mathematical Monthly]]
 | pages = 360–363
  | title = Recounting the rationals
  | url = http://www.math.upenn.edu/~wilf/website/recounting.pdf
  | volume = 107
  | year = 2000
  | doi = 10.2307/2589182
  | publisher = [[Mathematical Association of America]]
 | jstor = 2589182}}.
 *{{citation|first=L.|last=Carlitz|authorlink =Leonard Carlitz|title=A problem in partitions related to the[[Stirling numbers]]|journal=[[Bulletin of the American Mathematical Society]]|volume=70|issue=2|year=1964|pages=275–278|mr=0157907|doi=10.1090/S0002-9904-1964-11118-6}}.
 *{{citation
  |first=Edsger W.|last=Dijkstra|authorlink=Edsger W. Dijkstra
  |title=Selected Writings on Computing: A Personal Perspective
  |publisher=[[Springer-Verlag]]|year=1982|isbn=0-387-90652-5}}. [http://www.cs.utexas.edu/users/EWD/ewd05xx/EWD570.PDF EWD 570: An exercise for Dr.R.M.Burstall], pp. 215–216, and [http://www.cs.utexas.edu/users/EWD/ewd05xx/EWD578.PDF EWD 578: More about the function "fusc" (A sequel to EWD570)], pp. 230–232, reprints of notes originally written in 1976.
 *{{citation
  | last1 = Gibbons | first1 = Jeremy | authorlink1 = Jeremy Gibbons
  | last2 = Lester | first2 = David
  | last3 = Bird | first3 = Richard | author3-link = Richard Bird (computer scientist)
  | doi = 10.1017/S0956796806005880
  | issue = 3
  | journal = [[Journal of Functional Programming]]
  | pages = 281–291
  | title = Functional pearl: Enumerating the rationals
  | volume = 16
  | year = 2006}}.
 *{{citation
  | last = Raney | first = George N.
  | year = 1973
  | title = On continued fractions and finite automata
  | journal = [[Mathematische Annalen]]
  | volume = 206
  | pages = 265–283
  | doi = 10.1007/BF01355980}}
 *{{citation
  | last = Stern | first = Moritz A. | author-link = Moritz Abraham Stern
  | journal = [[Crelle's Journal|Journal für die reine und angewandte Mathematik]]
  | pages = 193–220
  | title = Ueber eine zahlentheoretische Funktion
  | url = http://www.digizeitschriften.de/resolveppn/GDZPPN002150301
  | volume = 55
  | year = 1858}}.
 
 ==External links==
 *{{mathworld|urlname=Calkin-WilfTree|title=Calkin–Wilf Tree}}
 *{{mathworld|urlname=SternsDiatomicSeries|title=Stern's Diatomic Series}}
 *{{citation|url=http://www.cut-the-knot.org/blue/Fusc.shtml|title=Fractions on a Binary Tree II|publisher=[[Cut-the-knot]]|first=Alexander|last=Bogomolny}}
 {{DEFAULTSORT:Calkin-Wilf tree}}
 [[Category:Integer sequences]]
 [[Category:Trees (data structures)]]"$



, Section 6.↩
.↩
: "a list of all positive rational numbers, each appearing once and only once, can be made by writing down 1/1, then the fractions on the level just below the top of the tree, reading from left to right, then the fractions on the next level down, reading from left to right, etc."  discuss efficient functional programming techniques for performing this breadth first traversal.↩
 credit this formula to Moshe Newman.↩
The fusc name was given to it in 1976 by Edsger W. Dijkstra; see EWD570 and EWD578.↩
, Theorem 1.↩





<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1284">MD5CRK</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>MD5CRK</h1>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, <strong>MD5CRK</strong> was a <a href="distributed_computing" title="wikilink">distributed</a> effort (similar to <a class="uri" href="distributed.net" title="wikilink">distributed.net</a>) launched by Jean-Luc Cooke and his company, <a href="http://www.certainkey.com/">CertainKey Cryptosystems</a>, to demonstrate that the <a class="uri" href="MD5" title="wikilink">MD5</a> <a href="message_digest" title="wikilink">message digest</a> <a class="uri" href="algorithm" title="wikilink">algorithm</a> is insecure by finding a <a href="Hash_collision" title="wikilink">collision</a> — two messages that produce the same MD5 hash. The project went live on March 1, 2004. The project ended on August 24, 2004 after researchers independently demonstrated a technique for generating collisions in MD5 using analytical methods by <a href="Xiaoyun_Wang" title="wikilink">Xiaoyun Wang</a>, Feng, <a href="Xuejia_Lai" title="wikilink">Xuejia Lai</a>, and Yu<a href="http://eprint.iacr.org/2004/199.pdf">1</a>. <a href="http://www.certainkey.com/">CertainKey</a> awarded a 10,000 <a href="Canadian_Dollar" title="wikilink">Canadian Dollar</a> <a href="http://www.certainkey.com/news/?13">prize to Wang, Feng, Lai and Yu</a> for their discovery.</p>

<p> A technique called <a href="Floyd's_cycle-finding_algorithm" title="wikilink">Floyd's cycle-finding algorithm</a> was used to try to find a collision for MD5. The algorithm can be described by analogy with a <a href="random_walk" title="wikilink">random walk</a>. Using the principle that any function with a finite number of possible outputs placed in a feedback loop will cycle, one can use a relatively small amount of memory to store outputs with particular structures and use them as "markers" to better detect when a marker has been "passed" before. These markers are called <em>distinguished points</em>, the point where two inputs produce the same output is called a <em>collision point</em>. MD5CRK considered any point whose first 32 <a href="bit" title="wikilink">bits</a> were zeroes to be a distinguished point.</p>
<h2 id="complexity">Complexity</h2>

<p>The expected time to find a collision is not equal to 

<math display="inline" id="MD5CRK:0">
 <semantics>
  <msup>
   <mn>2</mn>
   <mi>N</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <cn type="integer">2</cn>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{N}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="MD5CRK:1">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 is the number of bits in the digest output. It is in fact 

<math display="inline" id="MD5CRK:2">
 <semantics>
  <mfrac>
   <mrow>
    <msup>
     <mn>2</mn>
     <mi>N</mi>
    </msup>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mn>2</mn>
        <mi>N</mi>
       </msup>
       <mo>-</mo>
       <mi>K</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mo>×</mo>
    <mmultiscripts>
     <mn>2</mn>
     <none></none>
     <mi>N</mi>
     <none></none>
     <mi>K</mi>
    </mmultiscripts>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <factorial></factorial>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>N</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <ci>N</ci>
       </apply>
       <ci>K</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <ci>N</ci>
      </apply>
      <ci>K</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{N}!\over{(2^{N}-K)!\times{2^{N}}^{K}}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="MD5CRK:3">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 is the number of function outputs collected.</p>

<p>For this project, the probability of success after 

<math display="inline" id="MD5CRK:4">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 MD5 computations can be approximated by

<math display="block" id="MD5CRK:5">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <msup>
     <mi>e</mi>
     <mfrac>
      <mrow>
       <mi>K</mi>
       <mo>×</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>K</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <msup>
       <mn>2</mn>
       <mrow>
        <mi>N</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mfrac>
    </msup>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>K</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>K</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <apply>
         <plus></plus>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\over{1-e^{K\times(1-K)\over 2^{N+1}}}
  </annotation>
 </semantics>
</math>

.</p>

<p>The expected number of computations required to produce a collision in the 128-bit MD5 message digest function is thus

<math display="block" id="MD5CRK:6">
 <semantics>
  <mrow>
   <mrow>
    <mn>1.17741</mn>
    <mo>×</mo>
    <msup>
     <mn>2</mn>
     <mrow>
      <mi>N</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1.17741</mn>
    <mo>×</mo>
    <msup>
     <mn>2</mn>
     <mn>64</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="float">1.17741</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <divide></divide>
       <ci>N</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="float">1.17741</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">64</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1.17741\times 2^{N/2}}={1.17741\times 2^{64}}
  </annotation>
 </semantics>
</math>

</p>

<p>To give some perspective to this, using <a href="http://www.tcf.vt.edu/">Virginia Tech's System X</a> with a max performance of 12.25 Teraflops, it would take approximately 

<math display="inline" id="MD5CRK:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mn>2.17</mn>
      <mo>×</mo>
      <msup>
       <mn>10</mn>
       <mn>19</mn>
      </msup>
     </mrow>
     <mo>/</mo>
     <mn>12.25</mn>
    </mrow>
    <mo>×</mo>
    <msup>
     <mn>10</mn>
     <mn>12</mn>
    </msup>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>770</mn>
    <mo>,</mo>
    <mn>000</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="float">2.17</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">10</cn>
        <cn type="integer">19</cn>
       </apply>
      </apply>
      <cn type="float">12.25</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">10</cn>
      <cn type="integer">12</cn>
     </apply>
    </apply>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">770</cn>
     <cn type="integer">000</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {2.17\times 10^{19}/12.25\times 10^{12}\approx 1,770,000}
  </annotation>
 </semantics>
</math>

 seconds or about 3 weeks. Or for commodity processors at 2 gigaflops it would take 6,000 machines approximately the same amount of time.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="List_of_distributed_computing_projects" title="wikilink">List of distributed computing projects</a></li>
<li><a href="Brute_force_attack" title="wikilink">Brute force attack</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="Paul_C._van_Oorschot" title="wikilink">Paul C. van Oorschot</a>, Michael J. Wiener: Parallel Collision Search with Application to Hash Functions and Discrete Logarithms. ACM Conference on Computer and Communications Security 1994: pp210–218 <a href="http://www.scs.carleton.ca/~paulv/papers/acmccs94.pdf">Online version</a>.</li>
</ul>

<p>"</p>

<p><a href="Category:Cryptographic_attacks" title="wikilink">Category:Cryptographic attacks</a> <a href="Category:Distributed_computing_projects" title="wikilink">Category:Distributed computing projects</a></p>
</body>
</html>

   Canonical correlation      Canonical correlation  In [[statistics ]], canonical-correlation analysis ( CCA ) is a way of making sense of cross-covariance matrices . If we have two vectors X = ( X 1 , ..., X n ) and Y = ( Y 1 , ..., Y m ) of random variables , and there are correlations among the variables, then canonical-correlation analysis will find linear combinations of the X i and Y j which have maximum correlation with each other. 1 T. R. Knapp notes "virtually all of the commonly encountered parametric tests of significance can be treated as special cases of canonical-correlation analysis, which is the general procedure for investigating the relationships between two sets of variables." 2 The method was first introduced by Harold Hotelling in 1936. 3  Definition  Given two column vectors     X  =    (   x  1   ,  …  ,   x  n   )   ′       X   superscript    subscript  x  1   normal-…   subscript  x  n    normal-′     X=(x_{1},\dots,x_{n})^{\prime}   and    Y  =    (   y  1   ,  …  ,   y  m   )   ′       Y   superscript    subscript  y  1   normal-…   subscript  y  m    normal-′     Y=(y_{1},\dots,y_{m})^{\prime}   of random variables with finite  second moments , one may define the cross-covariance      Σ   X  Y    =   cov   (  X  ,  Y  )         subscript  normal-Σ    X  Y     cov  X  Y     \Sigma_{XY}=\operatorname{cov}(X,Y)   to be the    n  ×  m      n  m    n\times m    matrix whose    (  i  ,  j  )     i  j    (i,j)   entry is the covariance     cov   (   x  i   ,   y  j   )      cov   subscript  x  i    subscript  y  j     \operatorname{cov}(x_{i},y_{j})   . In practice, we would estimate the covariance matrix based on sampled data from   X   X   X   and   Y   Y   Y   (i.e. from a pair of data matrices).  Canonical-correlation analysis seeks vectors   a   a   a   and   b   b   b   such that the random variables     a  ′   X       superscript  a  normal-′   X    a^{\prime}X   and     b  ′   Y       superscript  b  normal-′   Y    b^{\prime}Y   maximize the correlation     ρ  =   corr   (    a  ′   X   ,    b  ′   Y   )        ρ   corr     superscript  a  normal-′   X      superscript  b  normal-′   Y      \rho=\operatorname{corr}(a^{\prime}X,b^{\prime}Y)   . The random variables    U  =    a  ′   X       U     superscript  a  normal-′   X     U=a^{\prime}X   and    V  =    b  ′   Y       V     superscript  b  normal-′   Y     V=b^{\prime}Y   are the first pair of canonical variables . Then one seeks vectors maximizing the same correlation subject to the constraint that they are to be uncorrelated with the first pair of canonical variables; this gives the second pair of canonical variables . This procedure may be continued up to    min   {  m  ,  n  }       m  n    \min\{m,n\}   times.  Computation  Derivation  Let     Σ   X  X    =   cov   (  X  ,  X  )         subscript  normal-Σ    X  X     cov  X  X     \Sigma_{XX}=\operatorname{cov}(X,X)   and     Σ   Y  Y    =   cov   (  Y  ,  Y  )         subscript  normal-Σ    Y  Y     cov  Y  Y     \Sigma_{YY}=\operatorname{cov}(Y,Y)   . The parameter to maximize is       ρ  =     a  ′    Σ   X  Y    b       a  ′    Σ   X  X    a       b  ′    Σ   Y  Y    b       .      ρ       superscript  a  normal-′    subscript  normal-Σ    X  Y    b          superscript  a  normal-′    subscript  normal-Σ    X  X    a         superscript  b  normal-′    subscript  normal-Σ    Y  Y    b        \rho=\frac{a^{\prime}\Sigma_{XY}b}{\sqrt{a^{\prime}\Sigma_{XX}a}\sqrt{b^{%
 \prime}\Sigma_{YY}b}}.     The first step is to define a change of basis and define       c  =    Σ   X  X    1  /  2    a    ,      c     superscript   subscript  normal-Σ    X  X      1  2    a     c=\Sigma_{XX}^{1/2}a,          d  =    Σ   Y  Y    1  /  2    b    .      d     superscript   subscript  normal-Σ    Y  Y      1  2    b     d=\Sigma_{YY}^{1/2}b.     And thus we have       ρ  =     c  ′    Σ   X  X    -   1  /  2      Σ   X  Y     Σ   Y  Y    -   1  /  2     d       c  ′   c       d  ′   d       .      ρ       superscript  c  normal-′    superscript   subscript  normal-Σ    X  X        1  2      subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y        1  2     d          superscript  c  normal-′   c         superscript  d  normal-′   d        \rho=\frac{c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}d}{\sqrt{c%
 ^{\prime}c}\sqrt{d^{\prime}d}}.     By the Cauchy-Schwarz inequality , we have         (    c  ′    Σ   X  X    -   1  /  2      Σ   X  Y     Σ   Y  Y    -   1  /  2      )   d   ≤     (    c  ′    Σ   X  X    -   1  /  2      Σ   X  Y     Σ   Y  Y    -   1  /  2      Σ   Y  Y    -   1  /  2      Σ   Y  X     Σ   X  X    -   1  /  2     c   )    1  /  2      (    d  ′   d   )    1  /  2      ,           superscript  c  normal-′    superscript   subscript  normal-Σ    X  X        1  2      subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y        1  2      d      superscript     superscript  c  normal-′    superscript   subscript  normal-Σ    X  X        1  2      subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y        1  2      superscript   subscript  normal-Σ    Y  Y        1  2      subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X        1  2     c     1  2     superscript     superscript  d  normal-′   d     1  2       \left(c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}\right)d\leq%
 \left(c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}\Sigma_{YY}^{-1%
 /2}\Sigma_{YX}\Sigma_{XX}^{-1/2}c\right)^{1/2}\left(d^{\prime}d\right)^{1/2},          ρ  ≤     (    c  ′    Σ   X  X    -   1  /  2      Σ   X  Y     Σ   Y  Y    -  1     Σ   Y  X     Σ   X  X    -   1  /  2     c   )    1  /  2      (    c  ′   c   )    1  /  2      .      ρ     superscript     superscript  c  normal-′    superscript   subscript  normal-Σ    X  X        1  2      subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y      1     subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X        1  2     c     1  2     superscript     superscript  c  normal-′   c     1  2       \rho\leq\frac{\left(c^{\prime}\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}%
 \Sigma_{YX}\Sigma_{XX}^{-1/2}c\right)^{1/2}}{\left(c^{\prime}c\right)^{1/2}}.     There is equality if the vectors   d   d   d   and     Σ   Y  Y    -   1  /  2      Σ   Y  X     Σ   X  X    -   1  /  2     c       superscript   subscript  normal-Σ    Y  Y        1  2      subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X        1  2     c    \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}c   are collinear. In addition, the maximum of correlation is attained if   c   c   c   is the eigenvector with the maximum eigenvalue for the matrix     Σ   X  X    -   1  /  2      Σ   X  Y     Σ   Y  Y    -  1     Σ   Y  X     Σ   X  X    -   1  /  2          superscript   subscript  normal-Σ    X  X        1  2      subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y      1     subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X        1  2       \Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1/2}   (see Rayleigh quotient ). The subsequent pairs are found by using eigenvalues of decreasing magnitudes. Orthogonality is guaranteed by the symmetry of the correlation matrices.  Solution  The solution is therefore:      c   c   c   is an eigenvector of     Σ   X  X    -   1  /  2      Σ   X  Y     Σ   Y  Y    -  1     Σ   Y  X     Σ   X  X    -   1  /  2          superscript   subscript  normal-Σ    X  X        1  2      subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y      1     subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X        1  2       \Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1/2}        d   d   d   is proportional to     Σ   Y  Y    -   1  /  2      Σ   Y  X     Σ   X  X    -   1  /  2     c       superscript   subscript  normal-Σ    Y  Y        1  2      subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X        1  2     c    \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}c      Reciprocally, there is also:      d   d   d   is an eigenvector of     Σ   Y  Y    -   1  /  2      Σ   Y  X     Σ   X  X    -  1     Σ   X  Y     Σ   Y  Y    -   1  /  2          superscript   subscript  normal-Σ    Y  Y        1  2      subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X      1     subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y        1  2       \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1}\Sigma_{XY}\Sigma_{YY}^{-1/2}        c   c   c   is proportional to     Σ   X  X    -   1  /  2      Σ   X  Y     Σ   Y  Y    -   1  /  2     d       superscript   subscript  normal-Σ    X  X        1  2      subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y        1  2     d    \Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}d      Reversing the change of coordinates, we have that      a   a   a   is an eigenvector of     Σ   X  X    -  1     Σ   X  Y     Σ   Y  Y    -  1     Σ   Y  X         superscript   subscript  normal-Σ    X  X      1     subscript  normal-Σ    X  Y     superscript   subscript  normal-Σ    Y  Y      1     subscript  normal-Σ    Y  X      \Sigma_{XX}^{-1}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}        b   b   b   is an eigenvector of     Σ   Y  Y    -  1     Σ   Y  X     Σ   X  X    -  1     Σ   X  Y         superscript   subscript  normal-Σ    Y  Y      1     subscript  normal-Σ    Y  X     superscript   subscript  normal-Σ    X  X      1     subscript  normal-Σ    X  Y      \Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1}\Sigma_{XY}        a   a   a   is proportional to     Σ   X  X    -  1     Σ   X  Y    b       superscript   subscript  normal-Σ    X  X      1     subscript  normal-Σ    X  Y    b    \Sigma_{XX}^{-1}\Sigma_{XY}b        b   b   b   is proportional to     Σ   Y  Y    -  1     Σ   Y  X    a       superscript   subscript  normal-Σ    Y  Y      1     subscript  normal-Σ    Y  X    a    \Sigma_{YY}^{-1}\Sigma_{YX}a      The canonical variables are defined by:      U  =    c  ′    Σ   X  X    -   1  /  2     X   =    a  ′   X         U     superscript  c  normal-′    superscript   subscript  normal-Σ    X  X        1  2     X           superscript  a  normal-′   X      U=c^{\prime}\Sigma_{XX}^{-1/2}X=a^{\prime}X         V  =    d  ′    Σ   Y  Y    -   1  /  2     Y   =    b  ′   Y         V     superscript  d  normal-′    superscript   subscript  normal-Σ    Y  Y        1  2     Y           superscript  b  normal-′   Y      V=d^{\prime}\Sigma_{YY}^{-1/2}Y=b^{\prime}Y     Implementation  CCA can be computed using singular value decomposition on a correlation matrix. 4 It is available as a function in 5   MATLAB as canoncorr  R as cancor or in FactoMineR  SAS as proc cancorr  Scikit-Learn , Python as Cross decomposition   Hypothesis testing  Each row can be tested for significance with the following method. Since the correlations are sorted, saying that row   i   i   i   is zero implies all further correlations are also zero. If we have   p   p   p   independent observations in a sample and     ρ  ^   i     subscript   normal-^  ρ   i    \widehat{\rho}_{i}   is the estimated correlation for    i  =   1  ,  …  ,   min   {  m  ,  n  }         i   1  normal-…    m  n      i=1,\dots,\min\{m,n\}   . For the   i   i   i   th row, the test statistic is:        χ  2   =   -    (   p  -  1  -    1  2    (   m  +  n  +  1   )     )   ln    ∏   j  =  i    min   {  m  ,  n  }      (   1  -    ρ  ^   j  2    )       ,       superscript  χ  2         p  1      1  2     m  n  1        superscript   subscript  product    j  i      m  n      1   superscript   subscript   normal-^  ρ   j   2         \chi^{2}=-\left(p-1-\frac{1}{2}(m+n+1)\right)\ln\prod_{j=i}^{\min\{m,n\}}(1-%
 \widehat{\rho}_{j}^{2}),     which is asymptotically distributed as a chi-squared with     (    m  -  i   +  1   )    (    n  -  i   +  1   )           m  i   1       n  i   1     (m-i+1)(n-i+1)    degrees of freedom for large   p   p   p   . 6 Since all the correlations from    min   {  m  ,  n  }       m  n    \min\{m,n\}   to   p   p   p   are logically zero (and estimated that way also) the product for the terms after this point is irrelevant.  Practical uses  A typical use for canonical correlation in the experimental context is to take two sets of variables and see what is common amongst the two sets. For example in psychological testing, you could take two well established multidimensional personality tests such as the Minnesota Multiphasic Personality Inventory (MMPI-2) and the NEO . By seeing how the MMPI-2 factors relate to the NEO factors, you could gain insight into what dimensions were common between the tests and how much variance was shared. For example you might find that an extraversion or neuroticism dimension accounted for a substantial amount of shared variance between the two tests.  One can also use canonical-correlation analysis to produce a model equation which relates two sets of variables, for example a set of performance measures and a set of explanatory variables, or a set of outputs and set of inputs. Constraint restrictions can be imposed on such a model to ensure it reflects theoretical requirements or intuitively obvious conditions. This type of model is known as a maximum correlation model. 7  Visualization of the results of canonical correlation is usually through bar plots of the coefficients of the two sets of variables for the pairs of canonical variates showing significant correlation. Some authors suggest that they are best visualized by plotting them as heliographs, a circular format with ray like bars, with each half representing the two sets of variables. 8  Examples  Let    X  =   x  1       X   subscript  x  1     X=x_{1}   with zero expected value , i.e.,     E   (  X  )    =  0       normal-E  X   0    \operatorname{E}(X)=0   . If    Y  =  X      Y  X    Y=X   , i.e.,   X   X   X   and   Y   Y   Y   are perfectly correlated, then, e.g.,    a  =  1      a  1    a=1   and    b  =  1      b  1    b=1   , so that the first (and only in this example) pair of canonical variables is    U  =  X      U  X    U=X   and    V  =  Y  =  X        V  Y       X     V=Y=X   . If    Y  =   -  X       Y    X     Y=-X   , i.e.,   X   X   X   and   Y   Y   Y   are perfectly anticorrelated, then, e.g.,    a  =  1      a  1    a=1   and    b  =   -  1       b    1     b=-1   , so that the first (and only in this example) pair of canonical variables is    U  =  X      U  X    U=X   and    V  =   -  Y   =  X        V    Y        X     V=-Y=X   . We notice that in both cases    U  =  V      U  V    U=V   , which illustrates that the canonical-correlation analysis treats correlated and anticorrelated variables similarly.  Connection to principal angles  Assuming that    X  =    (   x  1   ,  …  ,   x  n   )   ′       X   superscript    subscript  x  1   normal-…   subscript  x  n    normal-′     X=(x_{1},\dots,x_{n})^{\prime}   and    Y  =    (   y  1   ,  …  ,   y  m   )   ′       Y   superscript    subscript  y  1   normal-…   subscript  y  m    normal-′     Y=(y_{1},\dots,y_{m})^{\prime}   have zero expected values , i.e.,     E   (  X  )    =   E   (  Y  )    =  0         normal-E  X    normal-E  Y        0     \operatorname{E}(X)=\operatorname{E}(Y)=0   , their covariance matrices     Σ   X  X    =   Cov   (  X  ,  X  )    =   E   [   X   X  ′    ]           subscript  normal-Σ    X  X     Cov  X  X         normal-E    X   superscript  X  normal-′        \Sigma_{XX}=\operatorname{Cov}(X,X)=\operatorname{E}[XX^{\prime}]   and     Σ   Y  Y    =   Cov   (  Y  ,  Y  )    =   E   [   Y   Y  ′    ]           subscript  normal-Σ    Y  Y     Cov  Y  Y         normal-E    Y   superscript  Y  normal-′        \Sigma_{YY}=\operatorname{Cov}(Y,Y)=\operatorname{E}[YY^{\prime}]   can be viewed as Gram matrices in an inner product for the entries of   X   X   X   and   Y   Y   Y   , correspondingly. In this interpretation, the random variables, entries    x  i     subscript  x  i    x_{i}   of   X   X   X   and    y  j     subscript  y  j    y_{j}   of   Y   Y   Y   are treated as elements of a vector space with an inner product given by the covariance     cov   (   x  i   ,   y  j   )      cov   subscript  x  i    subscript  y  j     \operatorname{cov}(x_{i},y_{j})   , see Covariance#Relationship_to_inner_products .  The definition of the canonical variables   U   U   U   and   V   V   V   is then equivalent to the definition of principal vectors for the pair of subspaces spanned by the entries of   X   X   X   and   Y   Y   Y   with respect to this inner product . The canonical correlations    corr   (  U  ,  V  )      corr  U  V    \operatorname{corr}(U,V)   is equal to the cosine of principal angles .  See also   Generalized Canonical Correlation  Multilinear subspace learning  RV coefficient  Principal angles  Principal component analysis  Regularized canonical correlation analysis  Singular value decomposition  Partial least squares regression   References  External links    A note on the ordinal canonical-correlation analysis of two sets of ranking scores (Also provides a FORTRAN program)- in J. of Quantitative Economics 7(2), 2009, pp. 173-199  Representation-Constrained Canonical Correlation Analysis: A Hybridization of Canonical Correlation and Principal Component Analyses (Also provides a FORTRAN program)- in J. of Applied Economic Sciences 4(1), 2009, pp. 115-124   "  Category:Covariance and correlation  Category:Multivariate statistics     ↩  ↩  ↩  ↩  ↩  ↩  ↩  ↩     
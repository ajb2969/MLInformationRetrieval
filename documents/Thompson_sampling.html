<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1737">Thompson sampling</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Thompson sampling</h1>
<hr/>

<p>In <a href="artificial_intelligence" title="wikilink">artificial intelligence</a>, <strong>Thompson sampling</strong>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> named after William R. Thompson, is a heuristic for choosing actions that addresses the exploration-exploitation dilemma in the <a href="multi-armed_bandit" title="wikilink">multi-armed bandit</a> problem. It consists in choosing the action that maximizes the expected reward with respect to a randomly drawn belief.</p>
<h2 id="description">Description</h2>

<p>Consider a set of contexts 

<math display="inline" id="Thompson_sampling:0">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒳</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒳</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{X}
  </annotation>
 </semantics>
</math>

, a set of actions 

<math display="inline" id="Thompson_sampling:1">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

, and rewards in 

<math display="inline" id="Thompson_sampling:2">
 <semantics>
  <mi>ℝ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℝ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{R}
  </annotation>
 </semantics>
</math>

. In each round, the player obtains a context 

<math display="inline" id="Thompson_sampling:3">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∈</mo>
   <mi class="ltx_font_mathcaligraphic">𝒳</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <ci>𝒳</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in\mathcal{X}
  </annotation>
 </semantics>
</math>

, plays an action 

<math display="inline" id="Thompson_sampling:4">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>∈</mo>
   <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>a</ci>
    <ci>𝒜</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\in\mathcal{A}
  </annotation>
 </semantics>
</math>

 and receives a reward 

<math display="inline" id="Thompson_sampling:5">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>∈</mo>
   <mi>ℝ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>r</ci>
    <ci>ℝ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\in\mathbb{R}
  </annotation>
 </semantics>
</math>

 following a distribution that depends on the context and the issued action. The aim of the player is to play actions such as to maximize the cumulative rewards.</p>

<p>The elements of Thompson sampling are as follows:</p>
<ol>
<li>a set 

<math display="inline" id="Thompson_sampling:6">
 <semantics>
  <mi mathvariant="normal">Θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta
  </annotation>
 </semantics>
</math>

 of parameters 

<math display="inline" id="Thompson_sampling:7">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

;</li>
<li>a prior distribution 

<math display="inline" id="Thompson_sampling:8">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\theta)
  </annotation>
 </semantics>
</math>

 on these parameters;</li>
<li>past observations triplets 

<math display="inline" id="Thompson_sampling:9">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒟</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>;</mo>
     <mi>a</mi>
     <mo>;</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒟</ci>
    <set>
     <list>
      <ci>x</ci>
      <ci>a</ci>
      <ci>r</ci>
     </list>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{D}=\{(x;a;r)\}
  </annotation>
 </semantics>
</math>

;</li>
<li>a likelihood function 

<math display="inline" id="Thompson_sampling:10">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>r</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo>,</mo>
    <mi>a</mi>
    <mo>,</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">a</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(r|\theta,a,x)
  </annotation>
 </semantics>
</math>

;</li>
<li>a posterior distribution 

<math display="inline" id="Thompson_sampling:11">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi class="ltx_font_mathcaligraphic">𝒟</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi class="ltx_font_mathcaligraphic">𝒟</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\theta|\mathcal{D})\propto P(\mathcal{D}|\theta)P(\theta)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Thompson_sampling:12">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi class="ltx_font_mathcaligraphic">𝒟</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\mathcal{D}|\theta)
  </annotation>
 </semantics>
</math>

 is the likelihood function.</li>
</ol>

<p>Thompson sampling consists in playing the action 

<math display="inline" id="Thompson_sampling:13">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mo>∗</mo>
   </msup>
   <mo>∈</mo>
   <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <ci>normal-∗</ci>
    </apply>
    <ci>𝒜</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\ast}\in\mathcal{A}
  </annotation>
 </semantics>
</math>

 according to the probability that it maximizes the expected reward, i.e.</p>

<p>

<math display="block" id="Thompson_sampling:14">
 <semantics>
  <mrow>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>𝕀</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>𝔼</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">|</mo>
     <mi>a</mi>
     <mo>,</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <munder>
     <mi>max</mi>
     <msup>
      <mi>a</mi>
      <mo>′</mo>
     </msup>
    </munder>
    <mi>𝔼</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">|</mo>
     <msup>
      <mi>a</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi class="ltx_font_mathcaligraphic">𝒟</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mi>θ</mi>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <int></int>
    <csymbol cd="unknown">I</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">E</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">r</csymbol>
      <ci>normal-|</ci>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">θ</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <max></max>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <csymbol cd="unknown">E</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">r</csymbol>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>a</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>normal-,</ci>
      <csymbol cd="unknown">x</csymbol>
      <ci>normal-,</ci>
      <csymbol cd="unknown">θ</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">θ</csymbol>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int\mathbb{I}[\mathbb{E}(r|a,x,\theta)=\max_{a^{\prime}}\mathbb{E}(r|a^{%
\prime},x,\theta)]P(\theta|\mathcal{D})\,d\theta,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Thompson_sampling:15">
 <semantics>
  <mi>𝕀</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝕀</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{I}
  </annotation>
 </semantics>
</math>

 is the indicator function.</p>

<p>In practice, the rule is implemented by sampling, in each round, a parameter 

<math display="inline" id="Thompson_sampling:16">
 <semantics>
  <msup>
   <mi>θ</mi>
   <mo>∗</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>θ</ci>
    <ci>normal-∗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta^{\ast}
  </annotation>
 </semantics>
</math>

 from the posterior 

<math display="inline" id="Thompson_sampling:17">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi class="ltx_font_mathcaligraphic">𝒟</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">D</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\theta|\mathcal{D})
  </annotation>
 </semantics>
</math>

, and choosing the action 

<math display="inline" id="Thompson_sampling:18">
 <semantics>
  <msup>
   <mi>a</mi>
   <mo>∗</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>a</ci>
    <ci>normal-∗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\ast}
  </annotation>
 </semantics>
</math>

 that maximizes 

<math display="inline" id="Thompson_sampling:19">
 <semantics>
  <mrow>
   <mi>𝔼</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>r</mi>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>θ</mi>
     <mo>∗</mo>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>a</mi>
     <mo>∗</mo>
    </msup>
    <mo>,</mo>
    <mi>x</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">r</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <ci>normal-∗</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>a</ci>
      <ci>normal-∗</ci>
     </apply>
     <ci>normal-,</ci>
     <csymbol cd="unknown">x</csymbol>
     <ci>normal-]</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{E}[r|\theta^{\ast},a^{\ast},x]
  </annotation>
 </semantics>
</math>

, i.e. the expected reward given the parameter, the action and the current context. Conceptually, this means that the player instantiates his beliefs randomly in each round, and then he acts optimally according to them.</p>
<h2 id="history">History</h2>

<p>Thompson sampling was originally described in an article by Thompson from 1933 <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> but has been largely ignored by the artificial intelligence community. It was subsequently rediscovered numerous times independently in the context of reinforcement learning.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> A first proof of convergence for the bandit case has been shown in 1997.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> The first application to <a href="Markov_decision_process" title="wikilink">Markov decision processes</a> was in 2000.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> A related approach (see <a href="Thompson_sampling#Bayesian_control_rule" title="wikilink">Bayesian control rule</a>) was published in 2010.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> In 2010 it was also shown that Thompson sampling is <em>instantaneously self-correcting</em>.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Asymptotic convergence results for contextual bandits were published in 2011.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> Thompson sampling has also been applied to A/B testing in website design and online advertising.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> Recently, Thompson sampling has formed the basis for accelerated learning in decentralized decision making.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="properties">Properties</h2>
<h3 id="convergence">Convergence</h3>
<h3 id="optimality">Optimality</h3>
<h2 id="relationship-to-other-approaches">Relationship to other approaches</h2>
<h3 id="probability-matching">Probability matching</h3>

<p>Probability matching is a decision strategy in which predictions of class membership are proportional to the class base rates. Thus, if in the training set positive examples are observed 60% of the time, and negative examples are observed 40% of the time, the observer using a probability-matching strategy will predict (for unlabeled examples) a class label of "positive" on 60% of instances, and a class label of "negative" on 40% of instances.</p>
<h3 id="bayesian-control-rule">Bayesian control rule</h3>

<p>A generalization of Thompson sampling to arbitrary dynamical environments and causal structures, known as <strong>Bayesian control rule</strong>, has been shown to be the optimal solution to the adaptive coding problem with actions and observations.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> In this formulation, an agent is conceptualized as a mixture over a set of behaviours. As the agent interacts with its environment, it learns the causal properties and adopts the behaviour that minimizes the relative entropy to the behaviour with the best prediction of the environment's behaviour. If these behaviours have been chosen according to the maximum expected utility principle, then the asymptotic behaviour of the Bayesian control rule matches the asymptotic behaviour of the perfectly rational agent.</p>

<p>The setup is as follows. Let 

<math display="inline" id="Thompson_sampling:20">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mi>T</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>T</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1},a_{2},\ldots,a_{T}
  </annotation>
 </semantics>
</math>

 be the actions issued by an agent up to time 

<math display="inline" id="Thompson_sampling:21">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

, and let 

<math display="inline" id="Thompson_sampling:22">
 <semantics>
  <mrow>
   <msub>
    <mi>o</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>o</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>o</mi>
    <mi>T</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>o</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>o</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>o</ci>
     <ci>T</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o_{1},o_{2},\ldots,o_{T}
  </annotation>
 </semantics>
</math>

 be the observations gathered by the agent up to time 

<math display="inline" id="Thompson_sampling:23">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

. Then, the agent issues the action 

<math display="inline" id="Thompson_sampling:24">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mi>T</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <plus></plus>
     <ci>T</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{T+1}
  </annotation>
 </semantics>
</math>

 with probability:<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>

<p>

<math display="block" id="Thompson_sampling:25">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>T</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>T</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(a_{T+1}|\hat{a}_{1:T},o_{1:T}),
  </annotation>
 </semantics>
</math>

 where the "hat"-notation 

<math display="inline" id="Thompson_sampling:26">
 <semantics>
  <msub>
   <mover accent="true">
    <mi>a</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <ci>normal-^</ci>
     <ci>a</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{a}_{t}
  </annotation>
 </semantics>
</math>

 denotes the fact that 

<math display="inline" id="Thompson_sampling:27">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{t}
  </annotation>
 </semantics>
</math>

 is a causal intervention (see <a class="uri" href="Causality" title="wikilink">Causality</a>), and not an ordinary observation. If the agent holds beliefs 

<math display="inline" id="Thompson_sampling:28">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>∈</mo>
   <mi mathvariant="normal">Θ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>θ</ci>
    <ci>normal-Θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta\in\Theta
  </annotation>
 </semantics>
</math>

 over its behaviors, then the Bayesian control rule becomes</p>

<p>

<math display="block" id="Thompson_sampling:29">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>T</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mo largeop="true" symmetric="true">∫</mo>
    <mi mathvariant="normal">Θ</mi>
   </msub>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>T</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo>,</mo>
    <msub>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mi>θ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>T</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <int></int>
     <ci>normal-Θ</ci>
    </apply>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>T</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">θ</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(a_{T+1}|\hat{a}_{1:T},o_{1:T})=\int_{\Theta}P(a_{T+1}|\theta,\hat{a}_{1:T},o%
_{1:T})P(\theta|\hat{a}_{1:T},o_{1:T})\,d\theta
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Thompson_sampling:30">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\theta|\hat{a}_{1:T},o_{1:T})
  </annotation>
 </semantics>
</math>

 is the posterior distribution over the parameter 

<math display="inline" id="Thompson_sampling:31">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 given actions 

<math display="inline" id="Thompson_sampling:32">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mn>1</mn>
    <mo>:</mo>
    <mi>T</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">1</cn>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1:T}
  </annotation>
 </semantics>
</math>

 and observations 

<math display="inline" id="Thompson_sampling:33">
 <semantics>
  <msub>
   <mi>o</mi>
   <mrow>
    <mn>1</mn>
    <mo>:</mo>
    <mi>T</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>o</ci>
    <apply>
     <ci>normal-:</ci>
     <cn type="integer">1</cn>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o_{1:T}
  </annotation>
 </semantics>
</math>

.</p>

<p>In practice, the Bayesian control amounts to sampling, in each time step, a parameter 

<math display="inline" id="Thompson_sampling:34">
 <semantics>
  <msup>
   <mi>θ</mi>
   <mo>∗</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>θ</ci>
    <ci>normal-∗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta^{\ast}
  </annotation>
 </semantics>
</math>

 from the posterior distribution 

<math display="inline" id="Thompson_sampling:35">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <msub>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(\theta|\hat{a}_{1:T},o_{1:T})
  </annotation>
 </semantics>
</math>

, where the posterior distribution is computed using Bayes' rule by only considering the (causal) likelihoods of the observations 

<math display="inline" id="Thompson_sampling:36">
 <semantics>
  <mrow>
   <msub>
    <mi>o</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>o</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>o</mi>
    <mi>T</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>o</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>o</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>o</ci>
     <ci>T</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   o_{1},o_{2},\ldots,o_{T}
  </annotation>
 </semantics>
</math>

 and ignoring the (causal) likelihoods of the actions 

<math display="inline" id="Thompson_sampling:37">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>a</mi>
    <mi>T</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>T</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{1},a_{2},\ldots,a_{T}
  </annotation>
 </semantics>
</math>

, and then by sampling the action 

<math display="inline" id="Thompson_sampling:38">
 <semantics>
  <msubsup>
   <mi>a</mi>
   <mrow>
    <mi>T</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>∗</mo>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <ci>normal-∗</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>T</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{\ast}_{T+1}
  </annotation>
 </semantics>
</math>

 from the action distribution 

<math display="inline" id="Thompson_sampling:39">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>T</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <msup>
     <mi>θ</mi>
     <mo>∗</mo>
    </msup>
    <mo>,</mo>
    <msub>
     <mover accent="true">
      <mi>a</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mn>1</mn>
      <mo>:</mo>
      <mi>T</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <plus></plus>
       <ci>T</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <ci>normal-∗</ci>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>o</ci>
      <apply>
       <ci>normal-:</ci>
       <cn type="integer">1</cn>
       <ci>T</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(a_{T+1}|\theta^{\ast},\hat{a}_{1:T},o_{1:T})
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Artificial_intelligence" title="wikilink">Category:Artificial intelligence</a> <a href="Category:Heuristic_algorithms" title="wikilink">Category:Heuristic algorithms</a> <a href="Category:Sequential_methods" title="wikilink">Category:Sequential methods</a> <a href="Category:Sequential_experiments" title="wikilink">Category:Sequential experiments</a> <a href="Category:Articles_created_via_the_Article_Wizard" title="wikilink">Category:Articles created via the Article Wizard</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15"></li>
<li id="fn16"></li>
<li id="fn17"></li>
</ol>
</section>
</body>
</html>

   Canonical ensemble      Canonical ensemble   In statistical mechanics , a canonical ensemble is the statistical ensemble that represents the possible states of a mechanical system in thermal equilibrium with a heat bath at some fixed temperature. 1 The system can exchange energy with the heat bath, so that the states of the system will differ in total energy.  The principal thermodynamic variable of the canonical ensemble, determining the probability distribution of states, is the absolute temperature (symbol:   T   T   T   ). The ensemble typically also depends on mechanical variables such as the number of particles in the system (symbol:   N   N   N   ) and the system's volume (symbol:   V   V   V   ), each of which influence the nature of the system's internal states. An ensemble with these three parameters is sometimes called the     N  V  T      N  V  T    NVT   ensemble .  In simple terms, the canonical ensemble assigns a probability   P   P   P   to each distinct microstate given by the following exponential:       P  =   e    F  -  E    k  T      ,      P   superscript  e      F  E     k  T       P=e^{\frac{F-E}{kT}},   where   E   E   E   is the total energy of the microstate, and   k   k   k   is Boltzmann's constant .  The number   F   F   F   is the free energy (specifically, the Helmholtz free energy ) and is a constant for the ensemble. However, the probabilities and   F   F   F   will vary if different N , V , T are selected. The free energy   F   F   F   serves two roles: first, it provides a normalization factor for the probability distribution (the probabilities, over the complete set of microstates, must add up to one); second, many important ensemble averages can be directly calculated from the function    F   (  N  ,  V  ,  T  )       F   N  V  T     F(N,V,T)   .  An alternative but equivalent formulation for the same concept writes the probability as    P  =    1  Z    e   -   E  /   (   k  T   )           P      1  Z    superscript  e      E    k  T         \textstyle P=\frac{1}{Z}e^{-E/(kT)}   , using the canonical partition function     Z  =   e   -   F  /   (   k  T   )          Z   superscript  e      F    k  T        \textstyle Z=e^{-F/(kT)}   rather than the free energy. The equations below (in terms of free energy) may be restated in terms of the canonical partition function by simple mathematical manipulations.  Historically, the canonical ensemble was first described by Boltzmann (who called it a holode ) in 1884 in a relatively unknown paper. 2 It was later reformulated and extensively investigated by Gibbs in 1902. 3  Applicability of canonical ensemble  The canonical ensemble is the ensemble that describes the possible states of an isolated system that is in thermal equilibrium with a heat bath (the derivation of this fact can be found in Gibbs 4 ).  The canonical ensemble applies to systems of any size; while it is necessary to assume that the heat bath is very large (i. e., take a macroscopic limit ), the system itself may be small or large.  The condition that the system is mechanically isolated is necessary in order to ensure it does not exchange energy with any external object besides the heat bath. 5 In general, it is desirable to apply the canonical ensemble to systems that are in direct contact with the heat bath, since it is that contact that ensures the equilibrium. In practical situations, the use of the canonical ensemble is usually justified either 1) by assuming that the contact is mechanically weak, or 2) by incorporating a suitable part of the heat bath connection into the system under analysis, so that the connection's mechanical influence on the system is modeled within the system.  When the total energy is fixed but the internal state of the system is otherwise unknown, the appropriate description is not the canonical ensemble but the microcanonical ensemble . For systems where the particle number is variable (due to contact with a particle reservoir), the correct description is the grand canonical ensemble . For large systems (in the thermodynamic limit ) these other ensembles become essentially equivalent to the canonical ensemble, at least for average quantities.  Properties  Example ensembles  Boltzmann distribution (separable system)  If a system described by a canonical ensemble can be separated into independent parts (this happens if the different parts do not interact), and each of those parts has a fixed material composition, then each part can be seen as a system unto itself and is described by a canonical ensemble having the same temperature as the whole. Moreover, if the system is made up of multiple similar parts, then each part has exactly the same distribution as the other parts.  In this way, the canonical ensemble provides exactly the Boltzmann distribution (also known as Maxwell–Boltzmann statistics ) for systems of any number of particles. In comparison, the justification of the Boltzmann distribution from the microcanonical ensemble only applies for systems with a large number of parts (that is, in the thermodynamic limit).  The Boltzmann distribution itself is one of the most important tools in applying statistical mechanics to real systems, as it massively simplifies the study of systems that can be separated into independent parts (e. g., particles in a gas , electromagnetic modes in a cavity , molecular bonds in a polymer ).  Ising model (strongly interacting system)  In a system composed of pieces that interact with each other, it is usually not possible to find a way to separate the system into independent subsystems as done in the Boltzmann distribution. In these systems it is necessary to resort to using the full expression of the canonical ensemble in order to describe the thermodynamics of the system when it is thermostatted to a heat bath. The canonical ensemble is generally the most straightforward framework for studies of statistical mechanics and even allows one to obtain exact solutions in some interacting model systems. 6  A classic example of this is the Ising model , which is a widely discussed toy model for the phenomena of ferromagnetism and of self-assembled monolayer formation, and is one of the simplest models that shows a phase transition . Lars Onsager famously calculated exactly the free energy of an infinite-sized square-lattice Ising model at zero magnetic field, in the canonical ensemble. 7  Bose–Einstein condensate (strongly interacting system)  One of the most exemplary examples of a strongly interacting system is the Bose–Einstein condensate . Any two finite regions of the same Bose–Einstein condensate are entangled 8 and thus have wave functions dependent on each other. Measuring an observable in one area of a Bose–Einstein condensate immediately collapses wave functions in the other areas.  Precise expressions for the ensemble  The precise mathematical expression for a statistical ensemble depends on the kind of mechanics under consideration—quantum or classical—since the notion of a "microstate" is considerably different in these two cases. In quantum mechanics, the canonical ensemble affords a simple description since diagonalization provides a discrete set of microstates with specific energies. The classical mechanical case is more complex as it involves instead an integral over canonical phase space , and the size of microstates in phase space can be chosen somewhat arbitrarily.  Quantum mechanical   | image1 = Ensemble quantum 1DOF all states.png | width1 = | alt1 = | caption1 = Plot of all possible states of this system. The available stationary states displayed as horizontal bars of varying darkness according to ψ i (x){{!}} 2 }} .  | image2 = Ensemble quantum 1DOF canonical.png | width2 = | alt2 = | caption2 = A canonical ensemble for this system, for the temperature shown. The states are weighted exponentially in energy. }}  A statistical ensemble in quantum mechanics is represented by a density matrix , denoted by   ρ̂   ρ̂   ρ̂   . In basis-free notation, the canonical ensemble is the density matrix        ρ  ^   =   exp   (     1   k  T      (   F  -   H  ^    )    )     ,       normal-^  ρ         1    k  T      F   normal-^  H        \hat{\rho}=\exp\big(\tfrac{1}{kT}(F-\hat{H})\big),   where   Ĥ   Ĥ   Ĥ   is the system's total energy operator ( Hamiltonian ), and    e  x  p   (  )       e  x  p     exp()   is the matrix exponential operator. The free energy   F   F   F   is determined by the probability normalization condition that the density matrix has a trace of one,     T  r  ρ̂   =  1        T  r  ρ̂   1    Trρ̂=1   :        e   -   F   k  T      =    Tr  exp    (   -     1   k  T      H  ^     )     .       superscript  e      F    k  T        Tr          1    k  T     normal-^  H        e^{-\frac{F}{kT}}=\operatorname{Tr}\exp\big(-\tfrac{1}{kT}\hat{H}\big).     The canonical ensemble can alternatively be written in a simple form using bra–ket notation , if the system's energy eigenstates and energy eigenvalues are known. Given a complete basis of energy eigenstates ψ i ⟩}} , indexed by   i   i   i   , the canonical ensemble is:       ρ  ^   =    ∑  i     e    F  -   E  i     k  T      |   ψ  i   ⟩    ⟨   ψ  i   |          normal-^  ρ     subscript   i      superscript  e      F   subscript  E  i      k  T      ket   subscript  ψ  i     bra   subscript  ψ  i        \hat{\rho}=\sum_{i}e^{\frac{F-E_{i}}{kT}}|\psi_{i}\rangle\langle\psi_{i}|           e   -   F   k  T      =    ∑  i    e    -   E  i     k  T       .       superscript  e      F    k  T        subscript   i    superscript  e       subscript  E  i      k  T        e^{-\frac{F}{kT}}=\sum_{i}e^{\frac{-E_{i}}{kT}}.   where the are the energy eigenvalues determined by ψ i ⟩ {{=}} E i {{!}} ψ i ⟩}} . In other words, a set of microstates in quantum mechanics is given by a complete set of stationary states. The density matrix is diagonal in this basis, with the diagonal entries each directly giving a probability.  Classical mechanical  , with the potential    U   (  x  )       U  x    U(x)   shown as a red curve. The side plot shows the distribution of states in energy.  | image1 = Ensemble classical 1DOF all states.png | width1 = | alt1 = | caption1 = Plot of all possible states of this system. The available physical states are evenly distributed in phase space, but with an uneven distribution in energy; the side-plot displays      d  v   /  d   E          d  v   d   E    dv/dE   .  | image2 = Ensemble classical 1DOF canonical.png | width2 = | alt2 = | caption2 = A canonical ensemble for this system, for the temperature shown. The states are weighted exponentially in energy. }}  In classical mechanics, a statistical ensemble is instead represented by a joint probability density function in the system's phase space , , where the and are the canonical coordinates (generalized momenta and generalized coordinates) of the system's internal degrees of freedom. In a system of particles, the number of degrees of freedom   n   n   n   depends on the number of particles   N   N   N   in a way that depends on the physical situation. For a three-dimensional gas of monoatoms (not molecules),    n  =   3  N       n    3  N     n=3N   , however in diatomic gases there will also be rotational and vibrational degrees of freedom.  The probability density function for the canonical ensemble is:       ρ  =    1    h  n   C     e    F  -  E    k  T       ,      ρ      1     superscript  h  n   C     superscript  e      F  E     k  T        \rho=\frac{1}{h^{n}C}e^{\frac{F-E}{kT}},   where      E   E   E   is the energy of the system, a function of the phase ,     h   h   h   is an arbitrary but predetermined constant with the units of    e  n  e  r  g  y  ×  t  i  m  e      e  n  e  r  g  y  normal-×  t  i  m  e    energy×time   , setting the extent of one microstate and providing correct dimensions to   ρ   ρ   ρ   . 9     C   C   C   is an overcounting correction factor, often used for particle systems where identical particles are able to change place with each other. 10     F   F   F   provides a normalizing factor and is also the characteristic state function, the free energy.   Again, the value of   F   F   F   is determined by demanding that   ρ   ρ   ρ   is a normalized probability density function:       e   -   F   k  T      =   ∫   …   ∫    1    h  n   C      e    -  E    k  T      d   p  1   …  d   q  n            superscript  e      F    k  T          normal-…        1     superscript  h  n   C     superscript  e      E     k  T     d   subscript  p  1   normal-…  d   subscript  q  n         e^{-\frac{F}{kT}}=\int\ldots\int\frac{1}{h^{n}C}e^{\frac{-E}{kT}}\,dp_{1}%
 \ldots dq_{n}   This integral is taken over the entire phase space .  In other words, a microstate in classical mechanics is a phase space region, and this region has volume . This means that each microstate spans a range of energy, however this range can be made arbitrarily narrow by choosing   h   h   h   to be very small. The phase space integral can be converted into a summation over microstates, once phase space has been finely divided to a sufficient degree.  Surrounding surface  Сanonical ensemble is a closed system, so its free energy contains surface terms. Therefore, strictly speaking, CE should be called the '    N  V  A  T      N  V  A  T    NVAT    ' ensemble, where A is the area of the surrounding surface. If the partition function has no special surface potential terms, this is the surface of a hard solid.  Notes  References  "  Category:Statistical ensembles     ↩  ↩     ↩  ↩  ↩  (Historical note) Gibbs' original ensemble effectively set    h  =   1  e  n  e  r  g  y  u  n  i  t  t  ×  ×  t  i  m  e  u  n  i  t  t       h    1  e  n  e  r  g  y  u  n  i  t  t  normal-×  normal-×  t  i  m  e  u  n  i  t  t     h=1energyunitt××timeunitt   , leading to unit-dependence in the values of some thermodynamic quantities like entropy and chemical potential. Since the advent of quantum mechanics,   h   h   h   is often taken to be equal to Planck's constant in order to obtain a semiclassical correspondence with quantum mechanics. ↩  In a system of   N   N   N   identical particles,    C  =   N  !       C    N     C=N!   ( factorial of   N   N   N   ). This factor corrects the overcounting in phase space due to identical physical states being found in multiple locations. See the statistical ensemble article for more information on this overcounting. ↩     
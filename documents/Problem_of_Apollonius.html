<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1020">Problem of Apollonius</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Problem of Apollonius</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>Figure 1: A solution (in pink) to Apollonius' problem. The given circles are shown in black.</figcaption>
</figure>

<p> In <a href="Euclidean_geometry" title="wikilink">Euclidean plane geometry</a>, <strong>Apollonius's problem</strong> is to construct <a href="circle" title="wikilink">circles</a> that are <a class="uri" href="tangent" title="wikilink">tangent</a> to three given circles in a plane (Figure 1). <a href="Apollonius_of_Perga" title="wikilink">Apollonius of Perga</a> (ca. 262  190 BC) posed and solved this famous problem in his work  (<em></em>, "Tangencies"); this work has been lost, but a 4th-century report of his results by <a href="Pappus_of_Alexandria" title="wikilink">Pappus of Alexandria</a> has survived. Three given circles generically have eight different circles that are tangent to them (Figure 2) and each solution circle encloses or excludes the three given circles in a different way: in each solution, a different subset of the three circles is enclosed (its complement is excluded) and there are 8 subsets of a set whose cardinality is 3, since 8 = 2<sup>3</sup>.</p>

<p>In the 16th century, <a href="Adriaan_van_Roomen" title="wikilink">Adriaan van Roomen</a> solved the problem using intersecting <a href="hyperbola" title="wikilink">hyperbolas</a>, but this solution does not use only <a href="straightedge_and_compass" title="wikilink">straightedge and compass</a> constructions. <a href="François_Viète" title="wikilink">François Viète</a> found such a solution by exploiting <a href="limiting_case_(mathematics)" title="wikilink">limiting cases</a>: any of the three given circles can be shrunk to zero <a class="uri" href="radius" title="wikilink">radius</a> (a <a href="point_(geometry)" title="wikilink">point</a>) or expanded to infinite radius (a <a href="line_(geometry)" title="wikilink">line</a>). Viète's approach, which uses simpler limiting cases to solve more complicated ones, is considered a plausible reconstruction of Apollonius' method. The method of van Roomen was simplified by <a href="Isaac_Newton" title="wikilink">Isaac Newton</a>, who showed that Apollonius' problem is equivalent to finding a position from the differences of its distances to three known points. This has applications in navigation and positioning systems such as <a class="uri" href="LORAN" title="wikilink">LORAN</a>.</p>

<p>Later mathematicians introduced <a href="algebra" title="wikilink">algebraic methods</a>, which transform a geometric problem into <a href="algebraic_equation" title="wikilink">algebraic equations</a>. These methods were simplified by exploiting <a href="Symmetry_in_mathematics" title="wikilink">symmetries</a> inherent in the problem of Apollonius: for instance solution circles generically occur in pairs, with one solution enclosing the given circles that the other excludes (Figure 2). <a href="Joseph_Diaz_Gergonne" title="wikilink">Joseph Diaz Gergonne</a> used this symmetry to provide an elegant straightedge and compass solution, while other mathematicians used <a href="transformation_(geometry)" title="wikilink">geometrical transformations</a> such as <a href="inversive_geometry" title="wikilink">reflection in a circle</a> to simplify the configuration of the given circles. These developments provide a geometrical setting for algebraic methods (using <a href="Lie_sphere_geometry" title="wikilink">Lie sphere geometry</a>) and a classification of solutions according to 33 essentially different configurations of the given circles.</p>

<p>Apollonius' problem has stimulated much further work. Generalizations to three dimensions—constructing a <a class="uri" href="sphere" title="wikilink">sphere</a> tangent to four given spheres—and <a href="higher_dimension" title="wikilink">beyond</a> have been studied. The configuration of three mutually tangent circles has received particular attention. <a href="René_Descartes" title="wikilink">René Descartes</a> gave a formula relating the radii of the solution circles and the given circles, now known as <a href="Descartes'_theorem" title="wikilink">Descartes' theorem</a>. Solving Apollonius' problem iteratively in this case leads to the <a href="Apollonian_gasket" title="wikilink">Apollonian gasket</a>, which is one of the earliest <a href="fractal" title="wikilink">fractals</a> to be described in print, and is important in <a href="number_theory" title="wikilink">number theory</a> via <a href="Ford_circles" title="wikilink">Ford circles</a> and the <a href="Hardy–Littlewood_circle_method" title="wikilink">Hardy–Littlewood circle method</a>.</p>
<h2 id="statement-of-the-problem">Statement of the problem</h2>

<p>The general statement of Apollonius' problem is to construct one or more circles that are tangent to three given objects in a plane, where an object may be a line, a point or a circle of any size.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> These objects may be arranged in any way and may cross one another; however, they are usually taken to be distinct, meaning that they do not coincide. Solutions to Apollonius' problem are sometimes called <em>Apollonius circles</em>, although the term is also used for <a href="circles_of_Apollonius" title="wikilink">other types of circles</a> associated with Apollonius.</p>

<p>The property of tangency is defined as follows. First, a point, line or circle is assumed to be tangent to itself; hence, if a given circle is already tangent to the other two given objects, it is counted as a solution to Apollonius' problem. Two distinct geometrical objects are said to <em>intersect</em> if they have a point in common. By definition, a point is tangent to a circle or a line if it intersects them, that is, if it lies on them; thus, two distinct points cannot be tangent. If the angle between lines or circles at an intersection point is zero, they are said to be <em>tangent</em>; the intersection point is called a <em>tangent point</em> or a <em>point of tangency</em>. (The word "tangent" derives from the <a class="uri" href="Latin" title="wikilink">Latin</a> <a href="participle" title="wikilink">present participle</a>, <em>tangens</em>, meaning "touching".) In practice, two distinct circles are tangent if they intersect at only one point; if they intersect at zero or two points, they are not tangent. The same holds true for a line and a circle. Two distinct lines cannot be tangent in the plane, although two <a href="parallel_(geometry)" title="wikilink">parallel</a> lines can be considered as tangent at a <a href="point_at_infinity" title="wikilink">point at infinity</a> in <a href="inversive_geometry" title="wikilink">inversive geometry</a> (see <a href="#Inversive_methods" title="wikilink">below</a>).<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>The solution circle may be either internally or externally tangent to each of the given circles. An <em>external</em> tangency is one where the two circles bend away from each other at their point of contact; they lie on opposite sides of the <a href="tangent_lines_to_circles" title="wikilink">tangent line</a> at that point, and they exclude one another. The distance between their centers equals the sum of their radii. By contrast, an <em>internal</em> tangency is one in which the two circles curve in the same way at their point of contact; the two circles lie on the same side of the tangent line, and one circle encloses the other. In this case, the distance between their centers equals the difference of their radii. As an illustration, in Figure 1, the pink solution circle is internally tangent to the medium-sized given black circle on the right, whereas it is externally tangent to the smallest and largest given circles on the left.</p>

<p>Apollonius' problem can also be formulated as the problem of locating one or more points such that the <em>differences</em> of its distances to three given points equal three known values. Consider a solution circle of radius <em>r</em><sub><em>s</em></sub> and three given circles of radii <em>r</em><sub>1</sub>, <em>r</em><sub>2</sub> and <em>r</em><sub>3</sub>. If the solution circle is externally tangent to all three given circles, the distances between the center of the solution circle and the centers of the given circles equal <mtpl> <em>r</em><sub>1</sub> + <em>r</em><sub><em>s</em></sub>}}</mtpl>, <mtpl> <em>r</em><sub>2</sub> + <em>r</em><sub><em>s</em></sub>}}</mtpl> and <mtpl> <em>r</em><sub>3</sub> + <em>r</em><sub><em>s</em></sub>}}</mtpl>, respectively. Therefore, differences in these distances are constants, such as <mtpl> <em>r</em><sub>1</sub> − <em>r</em><sub>2</sub>}}</mtpl>; they depend only on the known radii of the given circles and not on the radius <em>r</em><sub><em>s</em></sub> of the solution circle, which cancels out. This second formulation of Apollonius' problem can be generalized to internally tangent solution circles (for which the center-center distance equals the difference of radii), by changing the corresponding differences of distances to sums of distances, so that the solution-circle radius <em>r</em><sub><em>s</em></sub> again cancels out. The re-formulation in terms of center-center distances is useful in the <a href="#Intersecting_hyperbolas" title="wikilink">solutions below</a> of <a href="Adriaan_van_Roomen" title="wikilink">Adriaan van Roomen</a> and <a href="Isaac_Newton" title="wikilink">Isaac Newton</a>, and also in <a href="hyperbolic_positioning" title="wikilink">hyperbolic positioning</a> or trilateration, which is the task of locating a position from differences in distances to three known points. For example, navigation systems such as <a class="uri" href="LORAN" title="wikilink">LORAN</a> identify a receiver's position from the differences in arrival times of signals from three fixed positions, which correspond to the differences in distances to those transmitters.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="history">History</h2>

<p>A rich repertoire of geometrical and algebraic methods have been developed to solve Apollonius' problem,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> which has been called "the most famous of all" geometry problems.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> The original approach of <a href="Apollonius_of_Perga" title="wikilink">Apollonius of Perga</a> has been lost, but reconstructions have been offered by <a href="François_Viète" title="wikilink">François Viète</a> and others, based on the clues in the description by <a href="Pappus_of_Alexandria" title="wikilink">Pappus</a>.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> The first new solution method was published in 1596 by <a href="Adriaan_van_Roomen" title="wikilink">Adriaan van Roomen</a>, who identified the centers of the solution circles as the intersection points of two <a href="hyperbola" title="wikilink">hyperbolas</a>.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> Van Roomen's method was refined in 1687 by <a href="Isaac_Newton" title="wikilink">Isaac Newton</a> in his <em><a href="Philosophiæ_Naturalis_Principia_Mathematica" title="wikilink">Principia</a></em>,<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a><a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> and by <a href="John_Casey_(mathematician)" title="wikilink">John Casey</a> in 1881.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>Although successful in solving Apollonius' problem, van Roomen's method has a drawback. A prized property in classical <a href="Euclidean_geometry" title="wikilink">Euclidean geometry</a> is the ability to solve problems using only a <a href="compass_and_straightedge_construction" title="wikilink">compass and a straightedge</a>.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> Many constructions are impossible using only these tools, such as <a href="angle_trisection" title="wikilink">dividing an angle in three equal parts</a>. However, many such "impossible" problems can be solved by intersecting curves such as hyperbolas, <a href="ellipse" title="wikilink">ellipses</a> and <a href="parabola" title="wikilink">parabolas</a> (<a href="conic_section" title="wikilink">conic sections</a>). For example, <a href="doubling_the_cube" title="wikilink">doubling the cube</a> (the problem of constructing a cube of twice the volume of a given cube) cannot be done using only a straightedge and compass, but <a class="uri" href="Menaechmus" title="wikilink">Menaechmus</a> showed that the problem can be solved by using the intersections of two <a href="parabola" title="wikilink">parabolas</a>.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a> Therefore, van Roomen's solution—which uses the intersection of two hyperbolas—did not determine if the problem satisfied the straightedge-and-compass property.</p>

<p>Van Roomen's friend <a href="François_Viète" title="wikilink">François Viète</a>, who had urged van Roomen to work on Apollonius' problem in the first place, developed a method that used only compass and straightedge.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> Prior to Viète's solution, <a class="uri" href="Regiomontanus" title="wikilink">Regiomontanus</a> doubted whether Apollonius' problem could be solved by straightedge and compass.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> Viète first solved some simple special cases of Apollonius' problem, such as finding a circle that passes through three given points which has only one solution if the points are distinct; he then built up to solving more complicated special cases, in some cases by shrinking or swelling the given circles.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> According to the 4th-century report of <a href="Pappus_of_Alexandria" title="wikilink">Pappus of Alexandria</a>, Apollonius' own book on this problem—entitled  (<em></em>, "Tangencies"; Latin: <em>De tactionibus</em>, <em>De contactibus</em>)—followed a similar progressive approach.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> Hence, Viète's solution is considered to be a plausible reconstruction of Apollonius' solution, although other reconstructions have been published independently by three different authors.<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a></p>

<p>Several other geometrical solutions to Apollonius' problem were developed in the 19th century. The most notable solutions are those of <a href="Jean-Victor_Poncelet" title="wikilink">Jean-Victor Poncelet</a> (1811)<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> and of <a href="Joseph_Diaz_Gergonne" title="wikilink">Joseph Diaz Gergonne</a> (1814).<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a> Whereas Poncelet's proof relies on <a href="Homothetic_center#Circles" title="wikilink">homothetic centers of circles</a> and the <a href="power_of_a_point" title="wikilink">power of a point</a> theorem, Gergonne's method exploits the conjugate relation between lines and their <a href="Pole_(geometry)" title="wikilink">poles</a> in a circle. Methods using <a href="inversive_geometry" title="wikilink">circle inversion</a> were pioneered by <a href="Julius_Petersen" title="wikilink">Julius Petersen</a> in 1879;<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> one example is the annular solution method of <a href="Harold_Scott_MacDonald_Coxeter" title="wikilink">HSM Coxeter</a>.<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> Another approach uses <a href="Lie_sphere_geometry" title="wikilink">Lie sphere geometry</a>,<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a> which was developed by <a href="Sophus_Lie" title="wikilink">Sophus Lie</a>.</p>

<p>Algebraic solutions to Apollonius' problem were pioneered in the 17th century by <a href="René_Descartes" title="wikilink">René Descartes</a> and <a href="Elisabeth_of_Bohemia,_Princess_Palatine" title="wikilink">Princess Elisabeth of Bohemia</a>, although their solutions were rather complex.<a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a> Practical algebraic methods were developed in the late 18th and 19th centuries by several mathematicians, including <a href="Leonhard_Euler" title="wikilink">Leonhard Euler</a>,<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a> <a href="Nicolas_Fuss" title="wikilink">Nicolas Fuss</a>,<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a> <a href="Carl_Friedrich_Gauss" title="wikilink">Carl Friedrich Gauss</a>,<a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a> <a href="Lazare_Carnot" title="wikilink">Lazare Carnot</a>,<a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a> and <a href="Augustin_Louis_Cauchy" title="wikilink">Augustin Louis Cauchy</a>.<a class="footnoteRef" href="#fn36" id="fnref36"><sup>36</sup></a></p>
<h2 id="solution-methods">Solution methods</h2>
<h3 id="intersecting-hyperbolas">Intersecting hyperbolas</h3>
<figure><b>(Figure)</b>
<figcaption>Figure 3: Two given circles (black) and a circle tangent to both (pink). The center-to-center distances <em>d</em><sub>1</sub> and <em>d</em><sub>2</sub> equal <mtpl></mtpl> and <mtpl></mtpl>, respectively, so their difference is independent of <em>r</em><sub><em>s</em></sub>.</figcaption>
</figure>

<p>The solution of <a href="Adriaan_van_Roomen" title="wikilink">Adriaan van Roomen</a> (1596) is based on the intersection of two <a href="hyperbola" title="wikilink">hyperbolas</a>.<a class="footnoteRef" href="#fn37" id="fnref37"><sup>37</sup></a><a class="footnoteRef" href="#fn38" id="fnref38"><sup>38</sup></a> Let the given circles be denoted as <em>C</em><sub>1</sub>, <em>C</em><sub>2</sub> and <em>C</em><sub>3</sub>. Van Roomen solved the general problem by solving a simpler problem, that of finding the circles that are tangent to <em>two</em> given circles, such as <em>C</em><sub>1</sub> and <em>C</em><sub>2</sub>. He noted that the center of a circle tangent to both given circles must lie on a <a class="uri" href="hyperbola" title="wikilink">hyperbola</a> whose foci are the centers of the given circles. To understand this, let the radii of the solution circle and the two given circles be denoted as <em>r</em><sub><em>s</em></sub>, <em>r</em><sub><em>1</em></sub> and <em>r</em><sub><em>2</em></sub>, respectively (Figure 3). The distance <em>d</em><sub>1</sub> between the centers of the solution circle and <em>C</em><sub>1</sub> is either <mtpl></mtpl> or <mtpl></mtpl>, depending on whether these circles are chosen to be externally or internally tangent, respectively. Similarly, the distance <em>d</em><sub>2</sub> between the centers of the solution circle and <em>C</em><sub>2</sub> is either <mtpl></mtpl> or <mtpl></mtpl>, again depending on their chosen tangency. Thus, the difference <mtpl></mtpl> between these distances is always a constant that is independent of <em>r</em><sub><em>s</em></sub>. This property, of having a fixed difference between the distances to the <a href="Focus_(geometry)" title="wikilink">foci</a>, characterizes hyperbolas, so the possible centers of the solution circle lie on a hyperbola. A second hyperbola can be drawn for the pair of given circles <em>C</em><sub>2</sub> and <em>C</em><sub>3</sub>, where the internal or external tangency of the solution and <em>C</em><sub>2</sub> should be chosen consistently with that of the first hyperbola. An intersection of these two hyperbolas (if any) gives the center of a solution circle that has the chosen internal and external tangencies to the three given circles. The full set of solutions to Apollonius' problem can be found by considering all possible combinations of internal and external tangency of the solution circle to the three given circles.</p>

<p><a href="Isaac_Newton" title="wikilink">Isaac Newton</a> (1687) refined van Roomen's solution, so that the solution-circle centers were located at the intersections of a line with a circle.<a class="footnoteRef" href="#fn39" id="fnref39"><sup>39</sup></a> Newton formulates Apollonius' problem as a problem in <a class="uri" href="trilateration" title="wikilink">trilateration</a>: to locate a point <strong>Z</strong> from three given points <strong>A</strong>, <strong>B</strong> and <strong>C</strong>, such that the differences in distances from <strong>Z</strong> to the three given points have known values.<a class="footnoteRef" href="#fn40" id="fnref40"><sup>40</sup></a> These four points correspond to the center of the solution circle (<strong>Z</strong>) and the centers of the three given circles (<strong>A</strong>, <strong>B</strong> and <strong>C</strong>). </p>

<p>Instead of solving for the two hyperbolas, Newton constructs their <a href="conic_section" title="wikilink">directrix lines</a> instead. For any hyperbola, the ratio of distances from a point <strong>Z</strong> to a focus <strong>A</strong> and to the directrix is a fixed constant called the <a href="Eccentricity_(mathematics)" title="wikilink">eccentricity</a>. The two directrices intersect at a point <strong>T</strong>, and from their two known distance ratios, Newton constructs a line passing through <strong>T</strong> on which <strong>Z</strong> must lie. However, the ratio of distances TZ/TA is also known; hence, <strong>Z</strong> also lies on a known circle, since Apollonius had shown that a <a class="uri" href="circle" title="wikilink">circle</a> can be <a href="Circle#Apollonius_circle" title="wikilink">defined</a> as the set of points that have a given ratio of distances to two fixed points. (As an aside, this definition is the basis of <a href="bipolar_coordinates" title="wikilink">bipolar coordinates</a>.) Thus, the solutions to Apollonius' problem are the intersections of a line with a circle.</p>
<h3 id="viètes-reconstruction">Viète's reconstruction</h3>

<p>As described <a href="#Special_cases" title="wikilink">below</a>, Apollonius' problem has ten special cases, depending on the nature of the three given objects, which may be a circle (<strong>C</strong>), line (<strong>L</strong>) or point (<strong>P</strong>). By custom, these ten cases are distinguished by three letter codes such as <strong>CCP</strong>.<a class="footnoteRef" href="#fn41" id="fnref41"><sup>41</sup></a> Viète solved all ten of these cases using only compass and straightedge constructions, and used the solutions of simpler cases to solve the more complex cases.<a class="footnoteRef" href="#fn42" id="fnref42"><sup>42</sup></a><a class="footnoteRef" href="#fn43" id="fnref43"><sup>43</sup></a> </p>

<p>Viète began by solving the <strong>PPP</strong> case (three points) following the method of <a class="uri" href="Euclid" title="wikilink">Euclid</a> in his <em><a href="Euclid's_Elements" title="wikilink">Elements</a></em>. From this, he derived a <a href="Lemma_(mathematics)" title="wikilink">lemma</a> corresponding to the <a href="power_of_a_point" title="wikilink">power of a point</a> theorem, which he used to solve the <strong>LPP</strong> case (a line and two points). Following Euclid a second time, Viète solved the <strong>LLL</strong> case (three lines) using the <a href="angle_bisector_theorem" title="wikilink">angle bisectors</a>. He then derived a lemma for constructing the line perpendicular to an angle bisector that passes through a point, which he used to solve the <strong>LLP</strong> problem (two lines and a point). This accounts for the first four cases of Apollonius' problem, those that do not involve circles.</p>

<p>To solve the remaining problems, Viète exploited the fact that the given circles and the solution circle may be re-sized in tandem while preserving their tangencies (Figure 4). If the solution-circle radius is changed by an amount Δ<em>r</em>, the radius of its internally tangent given circles must be likewise changed by Δ<em>r</em>, whereas the radius of its externally tangent given circles must be changed by −Δ<em>r</em>. Thus, as the solution circle swells, the internally tangent given circles must swell in tandem, whereas the externally tangent given circles must shrink, to maintain their tangencies.</p>

<p>Viète used this approach to shrink one of the given circles to a point, thus reducing the problem to a simpler, already solved case. He first solved the <strong>CLL</strong> case (a circle and two lines) by shrinking the circle into a point, rendering it a <strong>LLP</strong> case. He then solved the <strong>CLP</strong> case (a circle, a line and a point) using three lemmas. Again shrinking one circle to a point, Viète transformed the <strong>CCL</strong> case into a <strong>CLP</strong> case. He then solved the <strong>CPP</strong> case (a circle and two points) and the <strong>CCP</strong> case (two circles and a point), the latter case by two lemmas. Finally, Viète solved the general <strong>CCC</strong> case (three circles) by shrinking one circle to a point, rendering it a <strong>CCP</strong> case.</p>
<h3 id="algebraic-solutions">Algebraic solutions</h3>

<p>Apollonius' problem can be framed as a system of three equations for the center and radius of the solution circle.<a class="footnoteRef" href="#fn44" id="fnref44"><sup>44</sup></a> Since the three given circles and any solution circle must lie in the same plane, their positions can be specified in terms of the (<em>x</em>, <em>y</em>) <a href="Cartesian_coordinate_system" title="wikilink">coordinates</a> of their centers. For example, the center positions of the three given circles may be written as (<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>), (<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>) and (<em>x</em><sub>3</sub>, <em>y</em><sub>3</sub>), whereas that of a solution circle can be written as (<em>x</em><sub><em>s</em></sub>, <em>y</em><sub><em>s</em></sub>). Similarly, the radii of the given circles and a solution circle can be written as <em>r</em><sub>1</sub>, <em>r</em><sub>2</sub>, <em>r</em><sub>3</sub> and <em>r</em><sub><em>s</em></sub>, respectively. The requirement that a solution circle must exactly touch each of the three given circles can be expressed as three <a href="simultaneous_equation" title="wikilink">coupled</a> <a href="quadratic_equation" title="wikilink">quadratic equations</a> for <em>x</em><sub><em>s</em></sub>, <em>y</em><sub><em>s</em></sub> and <em>r</em><sub><em>s</em></sub>:</p>

<p>

<math display="block" id="Problem_of_Apollonius:0">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>s</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>s</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>r</mi>
       <mi>s</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>s</mi>
        <mn>1</mn>
       </msub>
       <msub>
        <mi>r</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(x_{s}-x_{1}\right)^{2}+\left(y_{s}-y_{1}\right)^{2}=\left(r_{s}-s_{1}r_{%
1}\right)^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Problem_of_Apollonius:1">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>s</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>s</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>r</mi>
       <mi>s</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>s</mi>
        <mn>2</mn>
       </msub>
       <msub>
        <mi>r</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(x_{s}-x_{2}\right)^{2}+\left(y_{s}-y_{2}\right)^{2}=\left(r_{s}-s_{2}r_{%
2}\right)^{{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Problem_of_Apollonius:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>s</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>x</mi>
         <mn>3</mn>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mi>s</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mi>y</mi>
         <mn>3</mn>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>r</mi>
        <mi>s</mi>
       </msub>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>s</mi>
         <mn>3</mn>
        </msub>
        <msub>
         <mi>r</mi>
         <mn>3</mn>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(x_{s}-x_{3}\right)^{2}+\left(y_{s}-y_{3}\right)^{2}=\left(r_{s}-s_{3}r_{%
3}\right)^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The three numbers <em>s</em><sub>1</sub>, <em>s</em><sub>2</sub> and <em>s</em><sub>3</sub> on the <a href="sides_of_an_equation" title="wikilink">right-hand side</a>, called signs, may equal ±1, and specify whether the desired solution circle should touch the corresponding given circle internally (<em>s</em> = 1) or externally (<em>s</em> = −1). For example, in Figures 1 and 4, the pink solution is internally tangent to the medium-sized given circle on the right and externally tangent to the smallest and largest given circles on the left; if the given circles are ordered by radius, the signs for this solution are . Since the three signs may be chosen independently, there are eight possible sets of equations , each set corresponding to one of the eight types of solution circles.</p>

<p>The general system of three equations may be solved by the method of <a href="resultant" title="wikilink">resultants</a>. When multiplied out, all three equations have <mtpl></mtpl> on the left-hand side, and <em>r</em><sub><em>s</em></sub><sup>2</sup> on the right-hand side. Subtracting one equation from another eliminates these quadratic terms; the remaining linear terms may be re-arranged to yield formulae for the coordinates <em>x</em><sub><em>s</em></sub> and <em>y</em><sub><em>s</em></sub></p>

<p>

<math display="block" id="Problem_of_Apollonius:3">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>M</mi>
    <mo>+</mo>
    <mrow>
     <mi>N</mi>
     <msub>
      <mi>r</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>M</ci>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{s}=M+Nr_{s}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Problem_of_Apollonius:4">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>P</mi>
    <mo>+</mo>
    <mrow>
     <mi>Q</mi>
     <msub>
      <mi>r</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>P</ci>
     <apply>
      <times></times>
      <ci>Q</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{s}=P+Qr_{s}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>M</em>, <em>N</em>, <em>P</em> and <em>Q</em> are known functions of the given circles and the choice of signs. Substitution of these formulae into one of the initial three equations gives a quadratic equation for <em>r</em><sub><em>s</em></sub>, which can be solved by the <a href="quadratic_formula" title="wikilink">quadratic formula</a>. Substitution of the numerical value of <em>r</em><sub><em>s</em></sub> into the linear formulae yields the corresponding values of <em>x</em><sub><em>s</em></sub> and <em>y</em><sub><em>s</em></sub>.</p>

<p>The signs <em>s</em><sub>1</sub>, <em>s</em><sub>2</sub> and <em>s</em><sub>3</sub> on the right-hand sides of the equations may be chosen in eight possible ways, and each choice of signs gives up to two solutions, since the equation for <em>r</em><sub><em>s</em></sub> is <a href="quadratic_equation" title="wikilink">quadratic</a>. This might suggest (incorrectly) that there are up to sixteen solutions of Apollonius' problem. However, due to a symmetry of the equations, if (<em>r</em><sub><em>s</em></sub>, <em>x</em><sub><em>s</em></sub>, <em>y</em><sub><em>s</em></sub>) is a solution, with signs <em>s</em><sub><em>i</em></sub>, then so is (−<em>r</em><sub><em>s</em></sub>, <em>x</em><sub><em>s</em></sub>, <em>y</em><sub><em>s</em></sub>), with opposite signs −<em>s</em><sub><em>i</em></sub>, which represents the same solution circle. Therefore, Apollonius' problem has at most eight independent solutions (Figure 2). One way to avoid this double-counting is to consider only solution circles with non-negative radius.</p>

<p>The two roots of any quadratic equation may be of three possible types: two different <a href="real_number" title="wikilink">real numbers</a>, two identical real numbers (i.e., a degenerate double root), or a pair of <a href="complex_conjugate" title="wikilink">complex conjugate</a> roots. The first case corresponds to the usual situation; each pair of roots corresponds to a pair of solutions that are related by <a href="Circle_inversion#Circle_inversion" title="wikilink">circle inversion</a>, as described below (Figure 6). In the second case, both roots are identical, corresponding to a solution circle that transforms into itself under inversion. In this case, one of the given circles is itself a solution to the Apollonius problem, and the number of distinct solutions is reduced by one. The third case of complex conjugate radii does not correspond to a geometrically possible solution for Apollonius' problem, since a solution circle cannot have an imaginary radius; therefore, the number of solutions is reduced by two. Interestingly, Apollonius' problem cannot have seven solutions, although it may have any other number of solutions from zero to eight.<a class="footnoteRef" href="#fn45" id="fnref45"><sup>45</sup></a><a class="footnoteRef" href="#fn46" id="fnref46"><sup>46</sup></a></p>
<h3 id="lie-sphere-geometry">Lie sphere geometry</h3>

<p>The same algebraic equations can be derived in the context of <a href="Lie_sphere_geometry" title="wikilink">Lie sphere geometry</a>.<a class="footnoteRef" href="#fn47" id="fnref47"><sup>47</sup></a> That geometry represents circles, lines and points in a unified way, as a five-dimensional vector <em>X</em> = (<em>v</em>, <em>c</em><sub><em>x</em></sub>, <em>c</em><sub><em>y</em></sub>, <em>w</em>, <em>sr</em>), where <strong>c</strong> = (<em>c</em><sub><em>x</em></sub>, <em>c</em><sub><em>y</em></sub>) is the center of the circle, and <em>r</em> is its (non-negative) radius. If <em>r</em> is not zero, the sign <em>s</em> may be positive or negative; for visualization, <em>s</em> represents the <a href="curve_orientation" title="wikilink">orientation</a> of the circle, with counterclockwise circles having a positive <em>s</em> and clockwise circles having a negative <em>s</em>. The parameter <em>w</em> is zero for a straight line, and one otherwise.</p>

<p>In this five-dimensional world, there is a <a href="bilinear_form" title="wikilink">bilinear</a> product similar to the <a href="dot_product" title="wikilink">dot product</a>:</p>

<p>

<math display="block" id="Problem_of_Apollonius:5">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>:=</mo>
   <msub>
    <mi>v</mi>
    <mn>1</mn>
   </msub>
   <msub>
    <mi>w</mi>
    <mn>2</mn>
   </msub>
   <mo>+</mo>
   <msub>
    <mi>v</mi>
    <mn>2</mn>
   </msub>
   <msub>
    <mi>w</mi>
    <mn>1</mn>
   </msub>
   <mo>+</mo>
   <msub>
    <mi>𝐜</mi>
    <mn>1</mn>
   </msub>
   <mo>⋅</mo>
   <msub>
    <mi>𝐜</mi>
    <mn>2</mn>
   </msub>
   <mo>-</mo>
   <msub>
    <mi>s</mi>
    <mn>1</mn>
   </msub>
   <msub>
    <mi>s</mi>
    <mn>2</mn>
   </msub>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">2</cn>
    </apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>v</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>w</ci>
     <cn type="integer">1</cn>
    </apply>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐜</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-⋅</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐜</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(X_{1}|X_{2}\right):=v_{1}w_{2}+v_{2}w_{1}+\mathbf{c}_{1}\cdot\mathbf{c}_%
{2}-s_{1}s_{2}r_{1}r_{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The <a href="Lie_quadric" title="wikilink">Lie quadric</a> is defined as those vectors whose product with themselves (their <a href="quadratic_form" title="wikilink">square norm</a>) is zero, (<em>X</em>|<em>X</em>) = 0. Let <em>X</em><sub>1</sub> and <em>X</em><sub>2</sub> be two vectors belonging to this quadric; the norm of their difference equals</p>

<p>

<math display="block" id="Problem_of_Apollonius:6">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mn>2</mn>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>v</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>v</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>w</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>w</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>𝐜</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>𝐜</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>⋅</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>𝐜</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>𝐜</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>-</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>r</mi>
      <mn>1</mn>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>s</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>r</mi>
      <mn>2</mn>
     </msub>
     <mo>)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">2</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐜</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐜</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-⋅</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐜</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐜</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(X_{1}-X_{2}|X_{1}-X_{2}\right)=2\left(v_{1}-v_{2}\right)\left(w_{1}-w_{2%
}\right)+\left(\mathbf{c}_{1}-\mathbf{c}_{2}\right)\cdot\left(\mathbf{c}_{1}-%
\mathbf{c}_{2}\right)-\left(s_{1}r_{1}-s_{2}r_{2}\right)^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>The product <a href="distributivity" title="wikilink">distributes</a> over addition and subtraction (more precisely, it is <a href="bilinear_form" title="wikilink">bilinear</a>):</p>

<p>

<math display="block" id="Problem_of_Apollonius:7">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>-</mo>
   <mn>2</mn>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <minus></minus>
    <cn type="integer">2</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(X_{1}-X_{2}|X_{1}-X_{2}\right)=\left(X_{1}|X_{1}\right)-2\left(X_{1}|X_{%
2}\right)+\left(X_{2}|X_{2}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>Since (<em>X</em><sub>1</sub>|<em>X</em><sub>1</sub>) = (<em>X</em><sub>2</sub>|<em>X</em><sub>2</sub>) = 0 (both belong to the Lie quadric) and since <em>w</em><sub>1</sub> = <em>w</em><sub>2</sub> = 1 for circles, the product of any two such vectors on the quadric equals</p>

<p>

<math display="block" id="Problem_of_Apollonius:8">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mn>2</mn>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mo>|</mo>
   <msub>
    <mi>𝐜</mi>
    <mn>1</mn>
   </msub>
   <mo>-</mo>
   <msub>
    <mi>𝐜</mi>
    <mn>2</mn>
   </msub>
   <msup>
    <mo>|</mo>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>r</mi>
      <mn>1</mn>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>s</mi>
      <mn>2</mn>
     </msub>
     <msub>
      <mi>r</mi>
      <mn>2</mn>
     </msub>
     <mo>)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <minus></minus>
    <cn type="integer">2</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>normal-|</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐜</ci>
     <cn type="integer">1</cn>
    </apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐜</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>normal-|</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -2\left(X_{1}|X_{2}\right)=\left|\mathbf{c}_{1}-\mathbf{c}_{2}\right|^{2}-%
\left(s_{1}r_{1}-s_{2}r_{2}\right)^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>where the vertical bars sandwiching <mtpl></mtpl> represent the length of that difference vector, i.e., the <a href="norm_(mathematics)#Euclidean_norm" title="wikilink">Euclidean norm</a>. This formula shows that if two quadric vectors <em>X</em><sub>1</sub> and <em>X</em><sub>2</sub> are orthogonal (perpendicular) to one another—that is, if (<em>X</em><sub>1</sub>|<em>X</em><sub>2</sub>)=0—then their corresponding circles are tangent. For if the two signs <em>s</em><sub>1</sub> and <em>s</em><sub>2</sub> are the same (i.e. the circles have the same "orientation"), the circles are internally tangent; the distance between their centers equals the <em>difference</em> in the radii</p>

<p>

<math display="block" id="Problem_of_Apollonius:9">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msub>
        <mi>𝐜</mi>
        <mn>1</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>𝐜</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>r</mi>
        <mn>1</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>r</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐜</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐜</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\mathbf{c}_{1}-\mathbf{c}_{2}\right|^{2}=\left(r_{1}-r_{2}\right)^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Conversely, if the two signs <em>s</em><sub>1</sub> and <em>s</em><sub>2</sub> are different (i.e. the circles have opposite "orientations"), the circles are externally tangent; the distance between their centers equals the <em>sum</em> of the radii</p>

<p>

<math display="block" id="Problem_of_Apollonius:10">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>|</mo>
      <mrow>
       <msub>
        <mi>𝐜</mi>
        <mn>1</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>𝐜</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>r</mi>
        <mn>1</mn>
       </msub>
       <mo>+</mo>
       <msub>
        <mi>r</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐜</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐜</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left|\mathbf{c}_{1}-\mathbf{c}_{2}\right|^{2}=\left(r_{1}+r_{2}\right)^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore, Apollonius' problem can be re-stated in Lie geometry as a problem of finding perpendicular vectors on the Lie quadric; specifically, the goal is to identify solution vectors <em>X</em><sub>sol</sub> that belong to the Lie quadric and are also orthogonal (perpendicular) to the vectors <em>X</em><sub>1</sub>, <em>X</em><sub>2</sub> and <em>X</em><sub>3</sub> corresponding to the given circles.</p>

<p>

<math display="block" id="Problem_of_Apollonius:11">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mi>sol</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mi>sol</mi>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mi>sol</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>1</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mi>sol</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>2</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>X</mi>
     <mi>sol</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>X</mi>
     <mn>3</mn>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>sol</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>sol</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>sol</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>sol</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <ci>sol</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>X</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cn type="integer">0</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(X_{\mathrm{sol}}|X_{\mathrm{sol}}\right)=\left(X_{\mathrm{sol}}|X_{1}%
\right)=\left(X_{\mathrm{sol}}|X_{2}\right)=\left(X_{\mathrm{sol}}|X_{3}\right%
)=0
  </annotation>
 </semantics>
</math>

</p>

<p>The advantage of this re-statement is that one can exploit theorems from <a href="linear_algebra" title="wikilink">linear algebra</a> on the maximum number of <a href="linearly_independent" title="wikilink">linearly independent</a>, simultaneously perpendicular vectors. This gives another way to calculate the maximum number of solutions and extend the theorem to higher-dimensional spaces.<a class="footnoteRef" href="#fn48" id="fnref48"><sup>48</sup></a><a class="footnoteRef" href="#fn49" id="fnref49"><sup>49</sup></a></p>
<h3 id="inversive-methods">Inversive methods</h3>

<p> A natural setting for problem of Apollonius is <a href="inversive_geometry" title="wikilink">inversive geometry</a>.<a class="footnoteRef" href="#fn50" id="fnref50"><sup>50</sup></a><a class="footnoteRef" href="#fn51" id="fnref51"><sup>51</sup></a> The basic strategy of inversive methods is to transform a given Apollonius problem into another Apollonius problem that is simpler to solve; the solutions to the original problem are found from the solutions of the transformed problem by undoing the transformation. Candidate transformations must change one Apollonius problem into another; therefore, they must transform the given points, circles and lines to other points, circles and lines, and no other shapes. <a href="inversive_geometry" title="wikilink">Circle inversion</a> has this property and allows the center and radius of the inversion circle to be chosen judiciously. Other candidates include the <a href="Euclidean_plane_isometry" title="wikilink">Euclidean plane isometries</a>; however, they do not simplify the problem, since they merely <a href="Translation_(mathematics)" title="wikilink">shift</a>, <a href="Coordinate_rotation" title="wikilink">rotate</a>, and <a href="Reflection_(mathematics)" title="wikilink">mirror</a> the original problem.</p>

<p>Inversion in a circle with center <strong>O</strong> and radius <em>R</em> consists of the following operation (Figure 5): every point <strong>P</strong> is mapped into a new point <strong>P</strong>' such that <strong>O</strong>, <strong>P</strong>, and <strong>P</strong>' are collinear, and the product of the distances of <strong>P</strong> and <strong>P</strong>' to the center <strong>O</strong> equal the radius <em>R</em> squared</p>

<p>

<math display="block" id="Problem_of_Apollonius:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>𝐎𝐏</mi>
      <mo>¯</mo>
     </mover>
     <mo>⋅</mo>
     <mover accent="true">
      <msup>
       <mi>𝐎𝐏</mi>
       <mo>′</mo>
      </msup>
      <mo>¯</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <msup>
     <mi>R</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>𝐎𝐏</ci>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐎𝐏</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\mathbf{OP}}\cdot\overline{\mathbf{OP^{\prime}}}=R^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, if <strong>P</strong> lies outside the circle, then <strong>P</strong>' lies within, and vice versa. When <strong>P</strong> is the same as <strong>O</strong>, the inversion is said to send <strong>P</strong> to infinity. (In <a href="complex_analysis" title="wikilink">complex analysis</a>, "infinity" is defined in terms of the <a href="Riemann_sphere" title="wikilink">Riemann sphere</a>.) Inversion has the useful property that lines and circles are always transformed into lines and circles, and points are always transformed into points. Circles are generally transformed into other circles under inversion; however, if a circle passes through the center of the inversion circle, it is transformed into a straight line, and vice versa. Importantly, if a circle crosses the circle of inversion at right angles (intersects perpendicularly), it is left unchanged by the inversion; it is transformed into itself.</p>

<p>Circle inversions correspond to a subset of <a href="Möbius_transformation" title="wikilink">Möbius transformations</a> on the <a href="Riemann_sphere" title="wikilink">Riemann sphere</a>. The planar Apollonius problem can be transferred to the sphere by an <a href="stereographic_projection" title="wikilink">inverse stereographic projection</a>; hence, solutions of the planar Apollonius problem also pertain to its counterpart on the sphere. Other inversive solutions to the planar problem are possible besides the common ones described below.<a class="footnoteRef" href="#fn52" id="fnref52"><sup>52</sup></a></p>
<h3 id="pairs-of-solutions-by-inversion">Pairs of solutions by inversion</h3>

<p> Solutions to Apollonius' problem generally occur in pairs; for each solution circle, there is a conjugate solution circle (Figure 6).<a class="footnoteRef" href="#fn53" id="fnref53"><sup>53</sup></a> One solution circle excludes the given circles that are enclosed by its conjugate solution, and vice versa. For example, in Figure 6, one solution circle (pink, upper left) encloses two given circles (black), but excludes a third; conversely, its conjugate solution (also pink, lower right) encloses that third given circle, but excludes the other two. The two conjugate solution circles are related by <a href="inversive_geometry" title="wikilink">inversion</a>, by the following argument.</p>

<p>In general, any three distinct circles have a unique circle—the <a href="Power_center_(geometry)" title="wikilink">radical circle</a>—that intersects all of them perpendicularly; the center of that circle is the <a href="power_center_(geometry)" title="wikilink">radical center</a> of the three circles.<a class="footnoteRef" href="#fn54" id="fnref54"><sup>54</sup></a> For illustration, the orange circle in Figure 6 crosses the black given circles at right angles. <a href="inversive_geometry" title="wikilink">Inversion</a> in the radical circle leaves the given circles unchanged, but transforms the two conjugate pink solution circles into one another. Under the same inversion, the corresponding points of tangency of the two solution circles are transformed into one another; for illustration, in Figure 6, the two blue points lying on each green line are transformed into one another. Hence, the lines connecting these conjugate tangent points are invariant under the inversion; therefore, they must pass through the center of inversion, which is the radical center (green lines intersecting at the orange dot in Figure 6).</p>
<h4 id="inversion-to-an-annulus">Inversion to an annulus</h4>

<p>If two of the three given circles do not intersect, a center of inversion can be chosen so that those two given circles become <a class="uri" href="concentric" title="wikilink">concentric</a>.<a class="footnoteRef" href="#fn55" id="fnref55"><sup>55</sup></a><a class="footnoteRef" href="#fn56" id="fnref56"><sup>56</sup></a> Under this inversion, the solution circles must fall within the <a href="Annulus_(mathematics)" title="wikilink">annulus</a> between the two concentric circles. Therefore, they belong to two one-parameter families. In the first family (Figure 7), the solutions do <em>not</em> enclose the inner concentric circle, but rather revolve like ball bearings in the annulus. In the second family (Figure 8), the solution circles enclose the inner concentric circle. There are generally four solutions for each family, yielding eight possible solutions, consistent with the <a href="#Algebraic_solutions" title="wikilink">algebraic solution</a>.</p>
<figure><b>(Figure)</b>
<figcaption>Figure 7: A solution circle (pink) in the first family lies between concentric given circles (black). Twice the solution radius <em>r</em><sub><em>s</em></sub> equals the difference <mtpl></mtpl> of the inner and outer radii, while twice its center distance <em>d</em><sub><em>s</em></sub> equals their sum.</figcaption>
</figure>
<figure><b>(Figure)</b>
<figcaption>Figure 8: A solution circle (pink) in the second family encloses the inner given circle (black). Twice the solution radius <em>r</em><sub><em>s</em></sub> equals the sum <mtpl></mtpl> of the inner and outer radii, while twice its center distance <em>d</em><sub><em>s</em></sub> equals their difference.</figcaption>
</figure>

<p>When two of the given circles are concentric, Apollonius' problem can be solved easily using a method of <a href="Carl_Friedrich_Gauss" title="wikilink">Gauss</a>.<a class="footnoteRef" href="#fn57" id="fnref57"><sup>57</sup></a> The radii of the three given circles are known, as is the distance <em>d</em><sub>non</sub> from the common concentric center to the non-concentric circle (Figure 7). The solution circle can be determined from its radius <em>r</em><sub>s</sub>, the angle θ, and the distances <em>d</em><sub>s</sub> and <em>d</em><sub>T</sub> from its center to the common concentric center and the center of the non-concentric circle, respectively. The radius and distance <em>d</em><sub>s</sub> are known (Figure 7), and the distance <em>d</em><sub>T</sub> = <em>r</em><sub>s</sub> ± <em>r</em><sub>non</sub>, depending on whether the solution circle is internally or externally tangent to the non-concentric circle. Therefore, by the <a href="law_of_cosines" title="wikilink">law of cosines</a>,</p>

<p>

<math display="block" id="Problem_of_Apollonius:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mi>d</mi>
        <mi mathvariant="normal">s</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>d</mi>
        <mi>non</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>-</mo>
      <msubsup>
       <mi>d</mi>
       <mi mathvariant="normal">T</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>d</mi>
       <mi mathvariant="normal">s</mi>
      </msub>
      <msub>
       <mi>d</mi>
       <mi>non</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>≡</mo>
    <msub>
     <mi>C</mi>
     <mo>±</mo>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <cos></cos>
      <ci>θ</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>normal-s</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>non</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>normal-T</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <ci>normal-s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>d</ci>
        <ci>non</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <equivalent></equivalent>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <csymbol cd="latexml">plus-or-minus</csymbol>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \cos\theta=\frac{d_{\mathrm{s}}^{2}+d_{\mathrm{non}}^{2}-d_{\mathrm{T}}^{2}}{2%
d_{\mathrm{s}}d_{\mathrm{non}}}\equiv C_{\pm}.
  </annotation>
 </semantics>
</math>

</p>

<p>Here, a new constant <em>C</em> has been defined for brevity, with the subscript indicating whether the solution is externally or internally tangent. A simple trigonometric rearrangement yields the four solutions</p>

<p>

<math display="block" id="Problem_of_Apollonius:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>θ</mi>
    <mo>=</mo>
    <mrow>
     <mo>±</mo>
     <mrow>
      <mpadded width="+5pt">
       <mn>2</mn>
      </mpadded>
      <mi>atan</mi>
      <mrow>
       <mo>(</mo>
       <msqrt>
        <mfrac>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>C</mi>
         </mrow>
         <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <mi>C</mi>
         </mrow>
        </mfrac>
       </msqrt>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>θ</ci>
    <apply>
     <csymbol cd="latexml">plus-or-minus</csymbol>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>atan</ci>
      <apply>
       <root></root>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>C</ci>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <ci>C</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta=\pm 2\ \mathrm{atan}\left(\sqrt{\frac{1-C}{1+C}}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>This formula represents four solutions, corresponding to the two choices of the sign of θ, and the two choices for <em>C</em>. The remaining four solutions can be obtained by the same method, using the substitutions for <em>r</em><sub>s</sub> and <em>d</em><sub>s</sub> indicated in Figure 8. Thus, all eight solutions of the general Apollonius problem can be found by this method.</p>

<p>Any initial two disjoint given circles can be rendered concentric as follows. The <a href="radical_axis" title="wikilink">radical axis</a> of the two given circles is constructed; choosing two arbitrary points <strong>P</strong> and <strong>Q</strong> on this radical axis, two circles can be constructed that are centered on <strong>P</strong> and <strong>Q</strong> and that intersect the two given circles orthogonally. These two constructed circles intersect each other in two points. Inversion in one such intersection point <strong>F</strong> renders the constructed circles into straight lines emanating from <strong>F</strong> and the two given circles into concentric circles, with the third given circle becoming another circle (in general). This follows because the system of circles is equivalent to a set of <a href="Apollonian_circles" title="wikilink">Apollonian circles</a>, forming a <a href="bipolar_coordinate_system" title="wikilink">bipolar coordinate system</a>.</p>
<h4 id="resizing-and-inversion">Resizing and inversion</h4>

<p>The usefulness of <a href="Inversive_geometry" title="wikilink">inversion</a> can be increased significantly by resizing.<a class="footnoteRef" href="#fn58" id="fnref58"><sup>58</sup></a><a class="footnoteRef" href="#fn59" id="fnref59"><sup>59</sup></a> As noted in <a href="#Viète's_reconstruction" title="wikilink">Viète's reconstruction</a>, the three given circles and the solution circle can be resized in tandem while preserving their tangencies. Thus, the initial Apollonius problem is transformed into another problem that may be easier to solve. For example, the four circles can be resized so that one given circle is shrunk to a point; alternatively, two given circles can often be resized so that they are tangent to one another. Thirdly, given circles that intersect can be resized so that they become non-intersecting, after which the <a href="#Inversion_to_an_annulus" title="wikilink">method for inverting to an annulus</a> can be applied. In all such cases, the solution of the original Apollonius problem is obtained from the solution of the transformed problem by undoing the resizing and inversion.</p>
<h5 id="shrinking-one-given-circle-to-a-point">Shrinking one given circle to a point</h5>

<p>In the first approach, the given circles are shrunk or swelled (appropriately to their tangency) until one given circle is shrunk to a point <strong>P</strong>.<a class="footnoteRef" href="#fn60" id="fnref60"><sup>60</sup></a> In that case, Apollonius' problem degenerates to the <strong>CCP</strong> <a href="Special_cases_of_Apollonius'_problem#Type_7:_Two_circles,_one_point" title="wikilink">limiting case</a>, which is the problem of finding a solution circle tangent to the two remaining given circles that passes through the point <strong>P</strong>. Inversion in a circle centered on <strong>P</strong> transforms the two given circles into new circles, and the solution circle into a line. Therefore, the transformed solution is a line that is tangent to the two transformed given circles. There are four such solution lines, which may be constructed from the external and internal <a href="homothetic_center" title="wikilink">homothetic centers</a> of the two circles. Re-inversion in <strong>P</strong> and undoing the resizing transforms such a solution line into the desired solution circle of the original Apollonius problem. All eight general solutions can be obtained by shrinking and swelling the circles according to the differing internal and external tangencies of each solution; however, different given circles may be shrunk to a point for different solutions.</p>
<h5 id="resizing-two-given-circles-to-tangency">Resizing two given circles to tangency</h5>

<p>In the second approach, the radii of the given circles are modified appropriately by an amount Δ<em>r</em> so that two of them are tangential (touching).<a class="footnoteRef" href="#fn61" id="fnref61"><sup>61</sup></a> Their point of tangency is chosen as the center of <a href="inversion_in_a_circle" title="wikilink">inversion in a circle</a> that intersects each of the two touching circles in two places. Upon inversion, the touching circles become two parallel lines: Their only point of intersection is sent to infinity under inversion, so they cannot meet. The same inversion transforms the third circle into another circle. The solution of the inverted problem must either be (1) a straight line parallel to the two given parallel lines and tangent to the transformed third given circle; or (2) a circle of constant radius that is tangent to the two given parallel lines and the transformed given circle. Re-inversion and adjusting the radii of all circles by Δ<em>r</em> produces a solution circle tangent to the original three circles.</p>
<h3 id="gergonnes-solution">Gergonne's solution</h3>
<figure><b>(Figure)</b>
<figcaption>Figure 9: The two tangent lines of the two tangent points of a given circle intersect on the <a href="radical_axis" title="wikilink">radical axis</a> <em>R</em> (red line) of the two solution circles (pink). The three points of intersection on <em>R</em> are the poles of the lines connecting the blue tangent points in each given circle (black).</figcaption>
</figure>

<p>Gergonne's approach is to consider the solution circles in pairs.<a class="footnoteRef" href="#fn62" id="fnref62"><sup>62</sup></a> Let a pair of solution circles be denoted as <em>C</em><sub>A</sub> and <em>C</em><sub>B</sub> (the pink circles in Figure 6), and let their tangent points with the three given circles be denoted as <strong>A</strong><sub>1</sub>, <strong>A</strong><sub>2</sub>, <strong>A</strong><sub>3</sub>, and <strong>B</strong><sub>1</sub>, <strong>B</strong><sub>2</sub>, <strong>B</strong><sub>3</sub>, respectively. Gergonne's solution aims to locate these six points, and thus solve for the two solution circles.</p>

<p>Gergonne's insight was that if a line <em>L</em><sub>1</sub> could be constructed such that <strong>A</strong><sub>1</sub> and <strong>B</strong><sub>1</sub> were guaranteed to fall on it, those two points could be identified as the intersection points of <em>L</em><sub>1</sub> with the given circle <em>C</em><sub>1</sub> (Figure 6). The remaining four tangent points would be located similarly, by finding lines <em>L</em><sub>2</sub> and <em>L</em><sub>3</sub> that contained <strong>A</strong><sub>2</sub> and <strong>B</strong><sub>2</sub>, and <strong>A</strong><sub>3</sub> and <strong>B</strong><sub>3</sub>, respectively. To construct a line such as <em>L</em><sub>1</sub>, two points must be identified that lie on it; but these points need not be the tangent points. Gergonne was able to identify two other points for each of the three lines. One of the two points has already been identified: the <a href="power_center_(geometry)" title="wikilink">radical center</a> <strong>G</strong> lies on all three lines (Figure 6).</p>

<p>To locate a second point on the lines <em>L</em><sub>1</sub>, <em>L</em><sub>2</sub> and <em>L</em><sub>3</sub>, Gergonne noted a <a href="reciprocation_(geometry)" title="wikilink">reciprocal relationship</a> between those lines and the <a href="radical_axis" title="wikilink">radical axis</a> <em>R</em> of the solution circles, <em>C</em><sub>A</sub> and <em>C</em><sub>B</sub>. To understand this reciprocal relationship, consider the two tangent lines to the circle <em>C</em><sub>1</sub> drawn at its tangent points <strong>A</strong><sub>1</sub> and <strong>B</strong><sub>1</sub> with the solution circles; the intersection of these tangent lines is the <a href="pole_(geometry)" title="wikilink">pole</a> point of <em>L</em><sub>1</sub> in <em>C</em><sub>1</sub>. Since the distances from that pole point to the tangent points <strong>A</strong><sub>1</sub> and <strong>B</strong><sub>1</sub> are equal, this pole point must also lie on the radical axis <em>R</em> of the solution circles, by definition (Figure 9). The relationship between pole points and their polar lines is reciprocal; if the pole of <em>L</em><sub>1</sub> in <em>C</em><sub>1</sub> lies on <em>R</em>, the pole of <em>R</em> in <em>C</em><sub>1</sub> must conversely lie on <em>L</em><sub>1</sub>. Thus, if we can construct <em>R</em>, we can find its pole <strong>P</strong><sub>1</sub> in <em>C</em><sub>1</sub>, giving the needed second point on <em>L</em><sub>1</sub> (Figure 10).</p>
<figure><b>(Figure)</b>
<figcaption>Figure 10: The poles (red points) of the radical axis <em>R</em> in the three given circles (black) lie on the green lines connecting the tangent points. These lines may be constructed from the poles and the <a href="power_center_(geometry)" title="wikilink">radical center</a> (orange).</figcaption>
</figure>

<p>Gergonne found the radical axis <em>R</em> of the unknown solution circles as follows. Any pair of circles has two <a href="homothetic_center" title="wikilink">centers of similarity</a>; these two points are the two possible intersections of two tangent lines to the two circles. Therefore, the three given circles have six centers of similarity, two for each distinct pair of given circles. Remarkably, these six points lie on four lines, three points on each line; moreover, each line corresponds to the <a href="radical_axis" title="wikilink">radical axis</a> of a potential pair of solution circles. To show this, Gergonne considered lines through corresponding points of tangency on two of the given circles, e.g., the line defined by <strong>A</strong><sub>1</sub>/<strong>A</strong><sub>2</sub> and the line defined by <strong>B</strong><sub>1</sub>/<strong>B</strong><sub>2</sub>. Let <strong>X</strong><sub>3</sub> be a center of similitude for the two circles <em>C</em><sub>1</sub> and <em>C</em><sub>2</sub>; then, <strong>A</strong><sub>1</sub>/<strong>A</strong><sub>2</sub> and <strong>B</strong><sub>1</sub>/<strong>B</strong><sub>2</sub> <a href="Homothetic_center#Tangent_circles_and_antihomologous_points" title="wikilink">are pairs of antihomologous points</a>, and their lines intersect at <strong>X</strong><sub>3</sub>. It follows, therefore, that the products of distances are equal</p>

<p>

<math display="block" id="Problem_of_Apollonius:15">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mrow>
      <msub>
       <mi>X</mi>
       <mn>3</mn>
      </msub>
      <msub>
       <mi>A</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>¯</mo>
    </mover>
    <mo>⋅</mo>
    <mover accent="true">
     <mrow>
      <msub>
       <mi>X</mi>
       <mn>3</mn>
      </msub>
      <msub>
       <mi>A</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>¯</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mrow>
      <msub>
       <mi>X</mi>
       <mn>3</mn>
      </msub>
      <msub>
       <mi>B</mi>
       <mn>1</mn>
      </msub>
     </mrow>
     <mo>¯</mo>
    </mover>
    <mo>⋅</mo>
    <mover accent="true">
     <mrow>
      <msub>
       <mi>X</mi>
       <mn>3</mn>
      </msub>
      <msub>
       <mi>B</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mo>¯</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>B</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{X_{3}A_{1}}\cdot\overline{X_{3}A_{2}}=\overline{X_{3}B_{1}}\cdot%
\overline{X_{3}B_{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>which implies that <strong>X</strong><sub>3</sub> lies on the radical axis of the two solution circles. The same argument can be applied to the other pairs of circles, so that three centers of similitude for the given three circles must lie on the radical axes of pairs of solution circles.</p>

<p>In summary, the desired line <em>L</em><sub>1</sub> is defined by two points: the radical center <strong>G</strong> of the three given circles and the pole in <em>C</em><sub>1</sub> of one of the four lines connecting the homothetic centers. Finding the same pole in <em>C</em><sub>2</sub> and <em>C</em><sub>3</sub> gives <em>L</em><sub>2</sub> and <em>L</em><sub>3</sub>, respectively; thus, all six points can be located, from which one pair of solution circles can be found. Repeating this procedure for the remaining three homothetic-center lines yields six more solutions, giving eight solutions in all. However, if a line <em>L</em><sub><em>k</em></sub> does not intersect its circle <em>C</em><sub><em>k</em></sub> for some <em>k</em>, there is no pair of solutions for that homothetic-center line.</p>
<h2 id="special-cases">Special cases</h2>
<h3 id="ten-combinations-of-points-circles-and-lines">Ten combinations of points, circles, and lines</h3>

<p>Apollonius problem is to construct one or more circles tangent to three given objects in a plane, which may be circles, points, or lines. This gives rise to ten types of Apollonius' problem, one corresponding to each combination of circles, lines and points, which may be labeled with three letters, either <strong>C</strong>, <strong>L</strong>, or <strong>P</strong>, to denote whether the given elements are a circle, line or point, respectively (<a href="#Apollonius_problem_types" title="wikilink">Table 1</a>).<a class="footnoteRef" href="#fn63" id="fnref63"><sup>63</sup></a> As an example, the type of Apollonius problem with a given circle, line, and point is denoted as <strong>CLP</strong>.</p>

<p>Some of these <a href="special_case" title="wikilink">special cases</a> are much easier to solve than the general case of three given circles. The two simplest cases are the problems of drawing a circle through three given points (<strong>PPP</strong>) or tangent to three lines (<strong>LLL</strong>), which were solved first by <a class="uri" href="Euclid" title="wikilink">Euclid</a> in his <em><a href="Euclid's_Elements" title="wikilink">Elements</a></em>. For example, the <strong>PPP</strong> problem can be solved as follows. The center of the solution circle is equally distant from all three points, and therefore must lie on the <a href="perpendicular_bisector" title="wikilink">perpendicular bisector</a> line of any two. Hence, the center is the point of intersection of any two perpendicular bisectors. Similarly, in the <strong>LLL</strong> case, the center must lie on a line bisecting the angle at the three intersection points between the three given lines; hence, the center lies at the intersection point of two such angle bisectors. Since there are two such bisectors at every intersection point of the three given lines, there are four solutions to the general <strong>LLL</strong> problem.</p>

<p>Points and lines may be viewed as special cases of circles; a point can be considered as a circle of infinitely small radius, and a line may be thought of an infinitely large circle whose center is also at infinity. From this perspective, the general Apollonius problem is that of constructing circles tangent to three given circles. The nine other cases involving points and lines may be viewed as <a href="limiting_case_(mathematics)" title="wikilink">limiting cases</a> of the general problem.<a class="footnoteRef" href="#fn64" id="fnref64"><sup>64</sup></a><a class="footnoteRef" href="#fn65" id="fnref65"><sup>65</sup></a> These limiting cases often have fewer solutions than the general problem; for example, the replacement of a given circle by a given point halves the number of solutions, since a point can be construed as an infinitesimal circle that is either internally or externally tangent.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Table 1: Ten Types of Apollonius' Problem</p></td>
<td style="text-align: left;">
<p>Index</p></td>
<td style="text-align: left;">
<p>Code</p></td>
<td style="text-align: left;">
<p>Given Elements</p></td>
<td style="text-align: left;">
<p>Number of solutions<br/>
(in general)</p></td>
<td style="text-align: left;">
<p>Example<br/>
(solution in pink; given objects in black)</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p><strong>PPP</strong></p></td>
<td style="text-align: left;">
<p>three points</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius PPP black.svg</figcaption>
</figure></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p><strong>LPP</strong></p></td>
<td style="text-align: left;">
<p>one line and two points</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius LPP black.svg</figcaption>
</figure></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p><strong>LLP</strong></p></td>
<td style="text-align: left;">
<p>two lines and a point</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius LLP black.svg</figcaption>
</figure></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;">
<p><strong>CPP</strong></p></td>
<td style="text-align: left;">
<p>one circle and two points</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius CPP black.svg</figcaption>
</figure></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p><strong>LLL</strong></p></td>
<td style="text-align: left;">
<p>three lines</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius LLL black.svg</figcaption>
</figure></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>6</p></td>
<td style="text-align: left;">
<p><strong>CLP</strong></p></td>
<td style="text-align: left;">
<p>one circle, one line, and a point</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius CLP black.svg</figcaption>
</figure></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>7</p></td>
<td style="text-align: left;">
<p><strong>CCP</strong></p></td>
<td style="text-align: left;">
<p>two circles and a point</p></td>
<td style="text-align: left;">
<p>4</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius CCP black.svg</figcaption>
</figure></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;">
<p><strong>CLL</strong></p></td>
<td style="text-align: left;">
<p>one circle and two lines</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius CLL black.svg</figcaption>
</figure></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>9</p></td>
<td style="text-align: left;">
<p><strong>CCL</strong></p></td>
<td style="text-align: left;">
<p>two circles and a line</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius CCL black.svg</figcaption>
</figure></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>10</p></td>
<td style="text-align: left;">
<p><strong>CCC</strong></p></td>
<td style="text-align: left;">
<p>three circles (the classic problem)</p></td>
<td style="text-align: left;">
<p>8</p></td>
<td style="text-align: left;"><figure><b>(Figure)</b>
<figcaption>Apollonius CCC black.svg</figcaption>
</figure></td>
</tr>
</tbody>
</table>

<p></p>
<h3 id="number-of-solutions">Number of solutions</h3>
<figure><b>(Figure)</b>
<figcaption>Figure 11: An Apollonius problem with no solutions. A solution circle (pink) must cross the dashed given circle (black) to touch both of the other given circles (also black).</figcaption>
</figure>

<p>The problem of counting the number of solutions to different types of Apollonius' problem belongs to the field of <a href="enumerative_geometry" title="wikilink">enumerative geometry</a>.<a class="footnoteRef" href="#fn66" id="fnref66"><sup>66</sup></a><a class="footnoteRef" href="#fn67" id="fnref67"><sup>67</sup></a> The general number of solutions for each of the ten types of Apollonius' problem is given in Table 1 above. However, special arrangements of the given elements may change the number of solutions. For illustration, Apollonius' problem has no solution if one circle separates the two (Figure 11); to touch both the solid given circles, the solution circle would have to cross the dashed given circle; but that it cannot do, if it is to touch the dashed circle tangentially. Conversely, if three given circles are all tangent at the same point, then <em>any</em> circle tangent at the same point is a solution; such Apollonius problems have an infinite number of solutions. If any of the given circles are identical, there is likewise an infinity of solutions. If only two given circles are identical, there are only two distinct given circles; the centers of the solution circles form a <a class="uri" href="hyperbola" title="wikilink">hyperbola</a>, as used in <a href="#Intersecting_hyperbolas" title="wikilink">one solution</a> to Apollonius' problem.</p>

<p>An exhaustive enumeration of the number of solutions for all possible configurations of three given circles, points or lines was first undertaken by Muirhead in 1896,<a class="footnoteRef" href="#fn68" id="fnref68"><sup>68</sup></a> although earlier work had been done by Stoll<a class="footnoteRef" href="#fn69" id="fnref69"><sup>69</sup></a> and Study.<a class="footnoteRef" href="#fn70" id="fnref70"><sup>70</sup></a> However, Muirhead's work was incomplete; it was extended in 1974<a class="footnoteRef" href="#fn71" id="fnref71"><sup>71</sup></a> and a definitive enumeration, with 33 distinct cases, was published in 1983.<a class="footnoteRef" href="#fn72" id="fnref72"><sup>72</sup></a> Although solutions to Apollonius' problem generally occur in pairs related by <a href="#Pairs_of_solutions_by_inversion" title="wikilink">inversion</a>, an odd number of solutions is possible in some cases, e.g., the single solution for <strong>PPP</strong>, or when one or three of the given circles are themselves solutions. (An example of the latter is given in the <a href="#Mutually_tangent_given_circles:_Soddy's_circles_and_Descartes'_theorem" title="wikilink">section</a> on <a href="Descartes'_theorem" title="wikilink">Descartes' theorem</a>.) However, there are no Apollonius problems with seven solutions.<a class="footnoteRef" href="#fn73" id="fnref73"><sup>73</sup></a><a class="footnoteRef" href="#fn74" id="fnref74"><sup>74</sup></a> Alternative solutions based on the <a href="Lie_sphere_geometry" title="wikilink">geometry of circles and spheres</a> have been developed and used in higher dimensions.<a class="footnoteRef" href="#fn75" id="fnref75"><sup>75</sup></a><a class="footnoteRef" href="#fn76" id="fnref76"><sup>76</sup></a></p>
<h3 id="mutually-tangent-given-circles-soddys-circles-and-descartes-theorem">Mutually tangent given circles: Soddy's circles and Descartes' theorem</h3>

<p>If the three given circles are mutually tangent, Apollonius' problem has five solutions. Three solutions are the given circles themselves, since each is tangent to itself and to the other two given circles. The remaining two solutions (shown in red in Figure 12) correspond to the <a href="incircle_and_excircles_of_a_triangle" title="wikilink">inscribed</a> and <a href="circumscribed_circle" title="wikilink">circumscribed circles</a>, and are called <em>Soddy's circles</em>.<a class="footnoteRef" href="#fn77" id="fnref77"><sup>77</sup></a> This special case of Apollonius' problem is also known as the <strong>four coins problem</strong>.<a class="footnoteRef" href="#fn78" id="fnref78"><sup>78</sup></a> The three given circles of this Apollonius problem form a <a href="Steiner_chain" title="wikilink">Steiner chain</a> tangent to the two Soddy's circles.</p>

<p> Either Soddy circle, when taken together with the three given circles, produces a set of four circles that are mutually tangent at six points. The radii of these four circles are related by an equation known as <a href="Descartes'_theorem" title="wikilink">Descartes' theorem</a>. In a 1643 letter to Princess <a href="Elizabeth_of_Bohemia" title="wikilink">Elizabeth of Bohemia</a>,<a class="footnoteRef" href="#fn79" id="fnref79"><sup>79</sup></a> <a href="René_Descartes" title="wikilink">René Descartes</a> showed that</p>

<p>

<math display="block" id="Problem_of_Apollonius:16">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>k</mi>
       <mn>1</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>k</mi>
       <mn>2</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>k</mi>
       <mn>3</mn>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>k</mi>
       <mi>s</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mpadded width="+1.7pt">
     <mn>2</mn>
    </mpadded>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msubsup>
       <mi>k</mi>
       <mn>1</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>k</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>k</mi>
       <mn>3</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>k</mi>
       <mi>s</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>s</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>s</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(k_{1}+k_{2}+k_{3}+k_{s}\right)^{2}=2\,\left(k_{1}^{2}+k_{2}^{2}+k_{3}^{2%
}+k_{s}^{2}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>k</em><sub><em>s</em></sub> = 1/<em>r</em><sub><em>s</em></sub> and <em>r</em><sub><em>s</em></sub> are the <a class="uri" href="curvature" title="wikilink">curvature</a> and radius of the solution circle, respectively, and similarly for the curvatures <em>k</em><sub>1</sub>, <em>k</em><sub>2</sub> and <em>k</em><sub>3</sub> and radii <em>r</em><sub>1</sub>, <em>r</em><sub>2</sub> and <em>r</em><sub>3</sub> of the three given circles. For every set of four mutually tangent circles, there is a second set of four mutually tangent circles that are tangent at the same six points.<a class="footnoteRef" href="#fn80" id="fnref80"><sup>80</sup></a><a class="footnoteRef" href="#fn81" id="fnref81"><sup>81</sup></a> Descartes' theorem was rediscovered independently in 1826 by <a href="Jakob_Steiner" title="wikilink">Jakob Steiner</a>,<a class="footnoteRef" href="#fn82" id="fnref82"><sup>82</sup></a> in 1842 by Philip Beecroft,<a class="footnoteRef" href="#fn83" id="fnref83"><sup>83</sup></a><a class="footnoteRef" href="#fn84" id="fnref84"><sup>84</sup></a> and again in 1936 by <a href="Frederick_Soddy" title="wikilink">Frederick Soddy</a>.<a class="footnoteRef" href="#fn85" id="fnref85"><sup>85</sup></a> Soddy published his findings in the scientific journal <em><a href="Nature_(journal)" title="wikilink">Nature</a></em> as a poem, <em>The Kiss Precise</em>, of which the first two stanzas are reproduced below. The first stanza describes Soddy's circles, whereas the second stanza gives Descartes' theorem. In Soddy's poem, two circles are said to "kiss" if they are tangent, whereas the term "bend" refers to the curvature <em>k</em> of the circle.</p>
<dl>
<dd><dl>
<dd><em>For pairs of lips to kiss maybe</em>
</dd>
<dd><em>Involves no trigonometry.</em>
</dd>
<dd><em>'Tis not so when four circles kiss</em>
</dd>
<dd><em>Each one the other three.</em>
</dd>
<dd><em>To bring this off the four must be</em>
</dd>
<dd><em>As three in one or one in three.</em>
</dd>
<dd><em>If one in three, beyond a doubt</em>
</dd>
<dd><em>Each gets three kisses from without.</em>
</dd>
<dd><em>If three in one, then is that one</em>
</dd>
<dd><em>Thrice kissed internally.</em>
</dd>
</dl>
</dd>
</dl>
<dl>
<dd><em>Four circles to the kissing come.</em>
</dd>
<dd><em>The smaller are the benter.</em>
</dd>
<dd><em>The bend is just the inverse of</em>
</dd>
<dd><em>The distance from the center.</em>
</dd>
<dd><em>Though their intrigue left Euclid dumb</em>
</dd>
<dd><em>There's now no need for rule of thumb.</em>
</dd>
<dd><em>Since zero bend's a dead straight line</em>
</dd>
<dd><em>And concave bends have minus sign,</em>
</dd>
<dd><em>The sum of the squares of all four bends</em>
</dd>
<dd><em>Is half the square of their sum.</em>
</dd>
</dl>

<p>Sundry extensions of Descartes' theorem have been derived by <a href="Daniel_Pedoe" title="wikilink">Daniel Pedoe</a>.<a class="footnoteRef" href="#fn86" id="fnref86"><sup>86</sup></a></p>
<h2 id="generalizations">Generalizations</h2>

<p>Apollonius' problem can be extended to construct all the circles that intersect three given circles at a precise angle θ, or at three specified crossing angles θ<sub>1</sub>, θ<sub>2</sub> and θ<sub>3</sub>;<a class="footnoteRef" href="#fn87" id="fnref87"><sup>87</sup></a> the ordinary Apollonius' problem corresponds to a special case in which the crossing angle is zero for all three given circles. Another generalization is the <a href="duality_(mathematics)" title="wikilink">dual</a> of the first extension, namely, to construct circles with three specified tangential distances from the three given circles.<a class="footnoteRef" href="#fn88" id="fnref88"><sup>88</sup></a></p>

<p> Apollonius' problem can be extended from the plane to the <a class="uri" href="sphere" title="wikilink">sphere</a> and other <a href="quadric_surface" title="wikilink">quadratic surfaces</a>. For the sphere, the problem is to construct all the circles (the boundaries of <a href="spherical_cap" title="wikilink">spherical caps</a>) that are tangent to three given circles on the sphere.<a class="footnoteRef" href="#fn89" id="fnref89"><sup>89</sup></a><a class="footnoteRef" href="#fn90" id="fnref90"><sup>90</sup></a><a class="footnoteRef" href="#fn91" id="fnref91"><sup>91</sup></a> This spherical problem can be rendered into a corresponding planar problem using <a href="stereographic_projection" title="wikilink">stereographic projection</a>. Once the solutions to the planar problem have been constructed, the corresponding solutions to the spherical problem can be determined by inverting the stereographic projection. Even more generally, one can consider the problem of four tangent curves that result from the intersections of an arbitrary quadratic surface and four planes, a problem first considered by <a href="Charles_Dupin" title="wikilink">Charles Dupin</a>.<a class="footnoteRef" href="#fn92" id="fnref92"><sup>92</sup></a></p>

<p>By solving Apollonius' problem repeatedly to find the inscribed circle, the interstices between mutually tangential circles can be filled arbitrarily finely, forming an <a href="Apollonian_gasket" title="wikilink">Apollonian gasket</a>, also known as a <em>Leibniz packing</em> or an <em>Apollonian packing</em>.<a class="footnoteRef" href="#fn93" id="fnref93"><sup>93</sup></a> This gasket is a <a class="uri" href="fractal" title="wikilink">fractal</a>, being self-similar and having a <a href="Hausdorff_dimension" title="wikilink">dimension</a> <em>d</em> that is not known exactly but is roughly 1.3,<a class="footnoteRef" href="#fn94" id="fnref94"><sup>94</sup></a> which is higher than that of a <a href="regular_curve" title="wikilink">regular</a> (or <a href="rectifiable_curve" title="wikilink">rectifiable</a>) curve (<em>d</em> = 1) but less than that of a plane (<em>d</em> = 2). The Apollonian gasket was first described by <a href="Gottfried_Leibniz" title="wikilink">Gottfried Leibniz</a> in the 17th century, and is a curved precursor of the 20th-century <a href="Sierpiński_triangle" title="wikilink">Sierpiński triangle</a>.<a class="footnoteRef" href="#fn95" id="fnref95"><sup>95</sup></a> The Apollonian gasket also has deep connections to other fields of mathematics; for example, it is the limit set of <a href="Kleinian_group" title="wikilink">Kleinian groups</a>.<a class="footnoteRef" href="#fn96" id="fnref96"><sup>96</sup></a></p>

<p>The configuration of a circle tangent to <em>four</em> circles in the plane has special properties, which have been elucidated by Larmor (1891)<a class="footnoteRef" href="#fn97" id="fnref97"><sup>97</sup></a> and Lachlan (1893).<a class="footnoteRef" href="#fn98" id="fnref98"><sup>98</sup></a> Such a configuration is also the basis for <a href="Casey's_theorem" title="wikilink">Casey's theorem</a>,<a class="footnoteRef" href="#fn99" id="fnref99"><sup>99</sup></a> itself a generalization of <a href="Ptolemy's_theorem" title="wikilink">Ptolemy's theorem</a>.<a class="footnoteRef" href="#fn100" id="fnref100"><sup>100</sup></a></p>

<p>The extension of Apollonius' problem to three dimensions, namely, the problem of finding a fifth sphere that is tangent to four given spheres, can be solved by analogous methods.<a class="footnoteRef" href="#fn101" id="fnref101"><sup>101</sup></a> For example, the given and solution spheres can be resized so that one given sphere is shrunk to point while maintaining tangency.<a class="footnoteRef" href="#fn102" id="fnref102"><sup>102</sup></a> Inversion in this point reduces Apollonius' problem to finding a plane that is tangent to three given spheres. There are in general eight such planes, which become the solutions to the original problem by reversing the inversion and the resizing. This problem was first considered by <a href="Pierre_de_Fermat" title="wikilink">Pierre de Fermat</a>,<a class="footnoteRef" href="#fn103" id="fnref103"><sup>103</sup></a> and many alternative solution methods have been developed over the centuries.<a class="footnoteRef" href="#fn104" id="fnref104"><sup>104</sup></a></p>

<p>Apollonius' problem can even be extended to <em>d</em> dimensions, to construct the <a href="hypersphere" title="wikilink">hyperspheres</a> tangent to a given set of  hyperspheres.<a class="footnoteRef" href="#fn105" id="fnref105"><sup>105</sup></a> Following the publication of <a href="Frederick_Soddy" title="wikilink">Frederick Soddy</a>'s re-derivation of the <a href="Descartes_theorem" title="wikilink">Descartes theorem</a> in 1936, several people solved (independently) the mutually tangent case corresponding to Soddy's circles in <em>d</em> dimensions.<a class="footnoteRef" href="#fn106" id="fnref106"><sup>106</sup></a></p>
<h2 id="applications">Applications</h2>

<p>The principal application of Apollonius' problem, as formulated by Isaac Newton, is <a href="hyperbolic_positioning" title="wikilink">hyperbolic trilateration</a>, which seeks to determine a position from the <em>differences</em> in distances to at least three points.<a class="footnoteRef" href="#fn107" id="fnref107"><sup>107</sup></a> For example, a ship may seek to determine its position from the differences in arrival times of signals from three synchronized transmitters. Solutions to Apollonius' problem were used in <a href="World_War_I" title="wikilink">World War I</a> to determine the location of an artillery piece from the time a gunshot was heard at three different positions,<a class="footnoteRef" href="#fn108" id="fnref108"><sup>108</sup></a> and hyperbolic trilateration is the principle used by the <a href="Decca_Navigator_System" title="wikilink">Decca Navigator System</a> and <a class="uri" href="LORAN" title="wikilink">LORAN</a>.<a class="footnoteRef" href="#fn109" id="fnref109"><sup>109</sup></a> Similarly, the location of an aircraft may be determined from the difference in arrival times of its <a href="transponder_(aviation)" title="wikilink">transponder</a> signal at four receiving stations. This <a class="uri" href="multilateration" title="wikilink">multilateration</a> problem is equivalent to the three-dimensional generalization of Apollonius' problem and applies to <a href="GNSS" title="wikilink">global positioning systems</a> such as <a class="uri" href="GPS" title="wikilink">GPS</a>.<a class="footnoteRef" href="#fn110" id="fnref110"><sup>110</sup></a> It is also used to determine the position of calling animals (such as birds and whales), although Apollonius' problem does not pertain if the <a href="speed_of_sound" title="wikilink">speed of sound</a> varies with direction (i.e., the <a href="transmission_medium" title="wikilink">transmission medium</a> not <a class="uri" href="isotropic" title="wikilink">isotropic</a>).<a class="footnoteRef" href="#fn111" id="fnref111"><sup>111</sup></a></p>

<p>Apollonius' problem has other applications. In Book 1, Proposition 21 in his <em><a href="Philosophiæ_Naturalis_Principia_Mathematica" title="wikilink">Principia</a></em>, <a href="Isaac_Newton" title="wikilink">Isaac Newton</a> used his solution of Apollonius' problem to construct an orbit in <a href="celestial_mechanics" title="wikilink">celestial mechanics</a> from the center of attraction and observations of tangent lines to the orbit corresponding to instantaneous <a class="uri" href="velocity" title="wikilink">velocity</a>.<a class="footnoteRef" href="#fn112" id="fnref112"><sup>112</sup></a> The special case of the problem of Apollonius when all three circles are tangent is used in the <a href="Hardy–Littlewood_circle_method" title="wikilink">Hardy–Littlewood circle method</a> of <a href="analytic_number_theory" title="wikilink">analytic number theory</a> to construct <a href="Hans_Rademacher" title="wikilink">Hans Rademacher</a>'s contour for complex integration, given by the boundaries of an <a href="infinite_set" title="wikilink">infinite set</a> of <a href="Ford_circle" title="wikilink">Ford circles</a> each of which touches several others.<a class="footnoteRef" href="#fn113" id="fnref113"><sup>113</sup></a> Finally, Apollonius' problem has been applied to some types of <a href="packing_problem" title="wikilink">packing problems</a>, which arise in disparate fields such as the <a href="error-correcting_code" title="wikilink">error-correcting codes</a> used on <a href="DVD" title="wikilink">DVDs</a> and the design of pharmaceuticals that bind in a particular <a class="uri" href="enzyme" title="wikilink">enzyme</a> of a pathogenic <a href="bacteria" title="wikilink">bacterium</a>.<a class="footnoteRef" href="#fn114" id="fnref114"><sup>114</sup></a></p>
<div style="clear:both">
</div>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Apollonius_point" title="wikilink">Apollonius point</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li>

<p>Trans., introd., and notes by Paul Ver Eecke. </p></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Conformal_geometry" title="wikilink">Category:Conformal geometry</a> <a href="Category:Euclidean_plane_geometry" title="wikilink">Category:Euclidean plane geometry</a> <a href="Category:Incidence_geometry" title="wikilink">Category:Incidence geometry</a> <a href="Category:History_of_geometry" title="wikilink">Category:History of geometry</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14"> <a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"> <a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"></li>
<li id="fn24"></li>
<li id="fn25"><a href="Robert_Simson" title="wikilink">Simson R</a> (1734) <em>Mathematical Collection</em>, volume VII, p. 117.<br/>
<br/>
<a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
<li id="fn28"><a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"></li>
<li id="fn31"></li>
<li id="fn32"> Reprinted in Euler's <em>Opera Omnia</em>, series 1, volume 26, pp. 270–275.<a href="#fnref32">↩</a></li>
<li id="fn33"></li>
<li id="fn34"><a href="#fnref34">↩</a></li>
<li id="fn35"><br/>
<a href="#fnref35">↩</a></li>
<li id="fn36"><a href="#fnref36">↩</a></li>
<li id="fn37"></li>
<li id="fn38"></li>
<li id="fn39"></li>
<li id="fn40"></li>
<li id="fn41"></li>
<li id="fn42"></li>
<li id="fn43"></li>
<li id="fn44"><a href="#fnref44">↩</a></li>
<li id="fn45"></li>
<li id="fn46"><a href="#fnref46">↩</a></li>
<li id="fn47"><a href="#fnref47">↩</a></li>
<li id="fn48"></li>
<li id="fn49"></li>
<li id="fn50"></li>
<li id="fn51"></li>
<li id="fn52"><a href="#fnref52">↩</a></li>
<li id="fn53"></li>
<li id="fn54"><a href="#fnref54">↩</a></li>
<li id="fn55"></li>
<li id="fn56"></li>
<li id="fn57"></li>
<li id="fn58"></li>
<li id="fn59"></li>
<li id="fn60"><a href="#fnref60">↩</a></li>
<li id="fn61"><a href="#fnref61">↩</a></li>
<li id="fn62"></li>
<li id="fn63"></li>
<li id="fn64"><br/>
<br/>
<a href="#fnref64">↩</a></li>
<li id="fn65"></li>
<li id="fn66"></li>
<li id="fn67"><a href="#fnref67">↩</a></li>
<li id="fn68"><a href="#fnref68">↩</a></li>
<li id="fn69"><a href="#fnref69">↩</a></li>
<li id="fn70"><a href="#fnref70">↩</a></li>
<li id="fn71"><a href="#fnref71">↩</a></li>
<li id="fn72"><a href="#fnref72">↩</a></li>
<li id="fn73"></li>
<li id="fn74"></li>
<li id="fn75"></li>
<li id="fn76"><a href="#fnref76">↩</a></li>
<li id="fn77"><a href="#fnref77">↩</a></li>
<li id="fn78"><br/>
<a href="#fnref78">↩</a></li>
<li id="fn79"><a href="René_Descartes" title="wikilink">Descartes R</a>, <em>Œuvres de Descartes, Correspondance IV</em>, (C. Adam and P. Tannery, Eds.), Paris: Leopold Cert 1901. <a href="#fnref79">↩</a></li>
<li id="fn80"></li>
<li id="fn81"></li>
<li id="fn82"><a href="#fnref82">↩</a></li>
<li id="fn83"></li>
<li id="fn84"><br/>
 (<a href="http://www.pballew.net/soddy.html">MathWords online article</a>)<a href="#fnref84">↩</a></li>
<li id="fn85"><a href="#fnref85">↩</a></li>
<li id="fn86"><a href="#fnref86">↩</a></li>
<li id="fn87"></li>
<li id="fn88"></li>
<li id="fn89"></li>
<li id="fn90"><a href="#fnref90">↩</a></li>
<li id="fn91"><a href="#fnref91">↩</a></li>
<li id="fn92"></li>
<li id="fn93"><a href="#fnref93">↩</a></li>
<li id="fn94"><br/>
<br/>
<a href="#fnref94">↩</a></li>
<li id="fn95"><br/>
<a href="#fnref95">↩</a></li>
<li id="fn96"><a href="#fnref96">↩</a></li>
<li id="fn97"><a href="#fnref97">↩</a></li>
<li id="fn98"><a href="#fnref98">↩</a></li>
<li id="fn99"></li>
<li id="fn100"></li>
<li id="fn101"></li>
<li id="fn102"></li>
<li id="fn103"><a href="Pierre_de_Fermat" title="wikilink">de Fermat P</a>, <em>Varia opera mathematica</em>, p. 74, Tolos, 1679.<a href="#fnref103">↩</a></li>
<li id="fn104"> Reprinted in Euler's <em>Opera Omnia</em>, series 1, volume 26, pp. 334–343.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<a href="#fnref104">↩</a></li>
<li id="fn105"></li>
<li id="fn106"><a href="#fnref106">↩</a></li>
<li id="fn107"><a href="#fnref107">↩</a></li>
<li id="fn108"></li>
<li id="fn109"><a href="#fnref109">↩</a></li>
<li id="fn110"><a href="#fnref110">↩</a></li>
<li id="fn111"><a href="#fnref111">↩</a></li>
<li id="fn112"></li>
<li id="fn113"><a href="#fnref113">↩</a></li>
<li id="fn114"><a href="#fnref114">↩</a></li>
</ol>
</section>
</body>
</html>

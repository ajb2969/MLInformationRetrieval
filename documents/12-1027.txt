   Luke's variational principle      Luke's variational principle   In fluid dynamics , Luke's variational principle is a Lagrangian  variational description of the motion of surface waves on a fluid with a free surface , under the action of gravity . This principle is named after J.C. Luke, who published it in 1967. 1 This variational principle is for incompressible and inviscid  potential flows , and is used to derive approximate wave models like the so-called mild-slope equation , 2 or using the averaged Lagrangian approach for wave propagation in inhomogeneous media. 3  Luke's Lagrangian formulation can also be recast into a Hamiltonian formulation in terms of the surface elevation and velocity potential at the free surface. 4 5 6 This is often used when modelling the spectral density evolution of the free-surface in a sea state , sometimes called wave turbulence .  Both the Lagrangian and Hamiltonian formulations can be extended to include surface tension effects.  Luke's Lagrangian  Luke's Lagrangian formulation is for non-linear surface gravity waves on an— incompressible , irrotational and inviscid — potential flow .  The relevant ingredients, needed in order to describe this flow, are:   Φ ( x , z , t ) is the velocity potential ,  ρ is the fluid density ,  g is the acceleration by the Earth's gravity ,  x is the horizontal coordinate vector with components x and y ,  x and y are the horizontal coordinates,  z is the vertical coordinate,  t is time, and  ∇ is the horizontal gradient operator, so ∇ Φ is the horizontal flow velocity consisting of ∂ Φ /∂ x and ∂ Φ /∂ y ,  V ( t ) is the time-dependent fluid domain with free surface.   The Lagrangian   ℒ   ℒ   \mathcal{L}   , as given by Luke, is:       ℒ  =   -    ∫   t  0    t  1      {    ∭   V   (  t  )      ρ   [     ∂  Φ    ∂  t    +    1  2     |   ∇  Φ   |   2    +    1  2     (    ∂  Φ    ∂  z    )   2    +    g   z    ]   d   x   d   y   d   z     }   d  t      .      ℒ      superscript   subscript    subscript  t  0     subscript  t  1         subscript  triple-integral    V  t      ρ   delimited-[]        normal-Φ     t        1  2    superscript     bold-∇  normal-Φ    2        1  2    superscript      normal-Φ     z    2      g  z     d  x  d  y  d  z     d  t       \mathcal{L}=-\int_{t_{0}}^{t_{1}}\left\{\iiint_{V(t)}\rho\left[\frac{\partial%
 \Phi}{\partial t}+\frac{1}{2}\left|\boldsymbol{\nabla}\Phi\right|^{2}+\frac{1}%
 {2}\left(\frac{\partial\Phi}{\partial z}\right)^{2}+g\,z\right]\;\text{d}x\;%
 \text{d}y\;\text{d}z\;\right\}\;\text{d}t.     From Bernoulli's principle , this Lagrangian can be seen to be the integral of the fluid pressure over the whole time-dependent fluid domain V ( t ). This is in agreement with the variational principles for inviscid flow without a free surface, found by Harry Bateman . 7  Variation with respect to the velocity potential Φ ( x , z , t'') and free-moving surfaces like z = η ( x , t'') results in the Laplace equation for the potential in the fluid interior and all required boundary conditions : kinematic boundary conditions on all fluid boundaries and dynamic boundary conditions on free surfaces. 8 This may also include moving wavemaker walls and ship motion.  For the case of a horizontally unbounded domain with the free fluid surface at z = η ( x , t'') and a fixed bed at z =− h ( x ''), Luke's variational principle results in the Lagrangian:       ℒ  =   -    ∫   t  0    t  1     ∬    {     ∫   -   h   (  𝒙  )      η   (  𝒙  ,  t  )       ρ    [     ∂  Φ    ∂  t    +    1  2     |   ∇  Φ   |   2    +    1  2     (    ∂  Φ    ∂  z    )   2     ]   d   z     +     1  2     ρ    g    η  2     }   d   𝒙   d  t       .      ℒ      superscript   subscript    subscript  t  0     subscript  t  1     double-integral         superscript   subscript       h  𝒙       η   𝒙  t       ρ   delimited-[]        normal-Φ     t        1  2    superscript     bold-∇  normal-Φ    2        1  2    superscript      normal-Φ     z    2      d  z        1  2   ρ  g   superscript  η  2      d  𝒙  d  t        \mathcal{L}=-\,\int_{t_{0}}^{t_{1}}\iint\left\{\int_{-h(\boldsymbol{x})}^{\eta%
 (\boldsymbol{x},t)}\rho\,\left[\frac{\partial\Phi}{\partial t}+\,\frac{1}{2}%
 \left|\boldsymbol{\nabla}\Phi\right|^{2}+\,\frac{1}{2}\left(\frac{\partial\Phi%
 }{\partial z}\right)^{2}\right]\;\text{d}z\;+\,\frac{1}{2}\,\rho\,g\,\eta^{2}%
 \right\}\;\text{d}\boldsymbol{x}\;\text{d}t.     The bed-level term proportional to h 2 in the potential energy has been neglected, since it is a constant and does not contribute in the variations. Below, Luke's variational principle is used to arrive at the flow equations for non-linear surface gravity waves on a potential flow.  Derivation of the flow equations resulting from Luke's variational principle  The variation     δ  ℒ   =  0        δ  ℒ   0    \delta\mathcal{L}=0   in the Lagrangian with respect to variations in the velocity potential Φ ( x , z , t''), as well as with respect to the surface elevation η ( x , t''), have to be zero. We consider both variations subsequently.  Variation with respect to the velocity potential  Consider a small variation δΦ in the velocity potential Φ . 9 Then the resulting variation in the Lagrangian is:       δ  Φ   ℒ       subscript  δ  normal-Φ   ℒ    \displaystyle\delta_{\Phi}\mathcal{L}     Using Leibniz integral rule , this becomes, in case of constant density ρ : 10        δ  Φ    ℒ    =          subscript  δ  normal-Φ   ℒ   absent    \displaystyle\delta_{\Phi}\mathcal{L}\,=     The first integral on the right-hand side integrates out to the boundaries, in x and t , of the integration domain and is zero since the variations δΦ are taken to be zero at these boundaries. For variations δΦ which are zero at the free surface and the bed, the second integral remains, which is only zero for arbitrary δΦ in the fluid interior if there the Laplace equation holds:         Δ   Φ    =  0     for  -   h   (  𝒙  )     <   z   <   η   (  𝒙  ,  t  )      ,     formulae-sequence      normal-Δ  normal-Φ   0         for    h  𝒙    z         η   𝒙  t        \Delta\Phi\,=\,0\qquad\text{ for }-h(\boldsymbol{x})\,<\,z\,<\,\eta(%
 \boldsymbol{x},t),     with Δ=∇·∇ + ∂ 2 /∂ z 2 the Laplace operator .  If variations δΦ are considered which are only non-zero at the free surface, only the third integral remains, giving rise to the kinematic free-surface boundary condition:             ∂  η    ∂  t     +    ∇  Φ   ⋅   ∇   η      -     ∂  Φ    ∂  z      =  0.     at   z    =   η   (  𝒙  ,  t  )      .     formulae-sequence            η     t     normal-⋅   bold-∇  normal-Φ    bold-∇  η         normal-Φ     z     0.       at  z     η   𝒙  t       \frac{\partial\eta}{\partial t}\,+\,\boldsymbol{\nabla}\Phi\cdot\boldsymbol{%
 \nabla}\eta\,-\,\frac{\partial\Phi}{\partial z}\,=\,0.\qquad\text{ at }z\,=\,%
 \eta(\boldsymbol{x},t).     Similarly, variations δΦ only non-zero at the bottom z = - h result in the kinematic bed condition:           ∇  Φ   ⋅   ∇   h     +     ∂  Φ    ∂  z      =  0     at   z    =   -   h   (  𝒙  )       .     formulae-sequence       normal-⋅   bold-∇  normal-Φ    bold-∇  h        normal-Φ     z     0       at  z       h  𝒙       \boldsymbol{\nabla}\Phi\cdot\boldsymbol{\nabla}h\,+\,\frac{\partial\Phi}{%
 \partial z}\,=\,0\qquad\text{ at }z\,=\,-h(\boldsymbol{x}).     Variation with respect to the surface elevation  Considering the variation of the Lagrangian with respect to small changes δη gives:        δ  η    ℒ    =    ℒ   (  Φ  ,   η  +   δ  η    )    -   ℒ   (  Φ  ,  η  )     =   -    ∫   t  0    t  1     ∬      [    ρ   δ   η    (     ∂  Φ    ∂  t    +     1  2       |   ∇  Φ   |   2     +     1  2      (    ∂  Φ    ∂  z    )   2    +    g   η    )    ]    z  =   η   (  𝒙  ,  t  )       d   𝒙   d   t       =  0.           subscript  δ  η   ℒ       ℒ   normal-Φ    η    δ  η        ℒ   normal-Φ  η              superscript   subscript    subscript  t  0     subscript  t  1     double-integral     subscript   delimited-[]    ρ  δ  η        normal-Φ     t        1  2    superscript     bold-∇  normal-Φ    2        1  2    superscript      normal-Φ     z    2      g  η        z    η   𝒙  t      d  𝒙  d  t           0.     \delta_{\eta}\mathcal{L}\,=\,\mathcal{L}(\Phi,\eta+\delta\eta)\,-\,\mathcal{L}%
 (\Phi,\eta)=\,-\,\int_{t_{0}}^{t_{1}}\iint\left[\rho\,\delta\eta\,\left(\frac{%
 \partial\Phi}{\partial t}+\,\frac{1}{2}\,\left|\boldsymbol{\nabla}\Phi\right|^%
 {2}\,+\,\frac{1}{2}\,\left(\frac{\partial\Phi}{\partial z}\right)^{2}+\,g\,%
 \eta\right)\,\right]_{z=\eta(\boldsymbol{x},t)}\;\text{d}\boldsymbol{x}\;\text%
 {d}t\,=\,0.     This has to be zero for arbitrary δη , giving rise to the dynamic boundary condition at the free surface:           ∂  Φ    ∂  t    +     1  2       |   ∇  Φ   |   2     +     1  2      (    ∂  Φ    ∂  z    )   2    +    g    η     =  0     at   z    =   η   (  𝒙  ,  t  )      .     formulae-sequence          normal-Φ     t        1  2    superscript     bold-∇  normal-Φ    2        1  2    superscript      normal-Φ     z    2      g  η    0       at  z     η   𝒙  t       \frac{\partial\Phi}{\partial t}+\,\frac{1}{2}\,\left|\boldsymbol{\nabla}\Phi%
 \right|^{2}\,+\,\frac{1}{2}\,\left(\frac{\partial\Phi}{\partial z}\right)^{2}+%
 \,g\,\eta\,=\,0\qquad\text{ at }z\,=\,\eta(\boldsymbol{x},t).     This is the Bernoulli equation for unsteady potential flow, applied at the free surface, and with the pressure above the free surface being a constant — which constant pressure is taken equal to zero for simplicity.  Hamiltonian formulation  The Hamiltonian structure of surface gravity waves on a potential flow was discovered by Vladimir E. Zakharov in 1968, and rediscovered independently by Bert Broer and John Miles : 11 12 13       ρ      ∂  η    ∂  t         ρ      η     t      \displaystyle\rho\,\frac{\partial\eta}{\partial t}     where the surface elevation η and surface potential φ — which is the potential Φ at the free surface z = η ( x , t ) — are the canonical variables . The Hamiltonian    ℋ   (  φ  ,  η  )       ℋ   φ  η     \mathcal{H}(\varphi,\eta)   is the sum of the kinetic and potential energy of the fluid:        ℋ   =   ∬    {     ∫   -   h   (  𝒙  )      η   (  𝒙  ,  t  )        1  2     ρ    [      |   ∇  Φ   |   2    +    (    ∂  Φ    ∂  z    )   2    ]   d   z     +     1  2     ρ    g    η  2     }   d  𝒙     .      ℋ   double-integral         superscript   subscript       h  𝒙       η   𝒙  t         1  2   ρ   delimited-[]     superscript     bold-∇  normal-Φ    2    superscript      normal-Φ     z    2     d  z        1  2   ρ  g   superscript  η  2      d  𝒙      \mathcal{H}\,=\,\iint\left\{\int_{-h(\boldsymbol{x})}^{\eta(\boldsymbol{x},t)}%
 \frac{1}{2}\,\rho\,\left[\left|\boldsymbol{\nabla}\Phi\right|^{2}\,+\,\left(%
 \frac{\partial\Phi}{\partial z}\right)^{2}\right]\,\text{d}z\,+\,\frac{1}{2}\,%
 \rho\,g\,\eta^{2}\right\}\;\text{d}\boldsymbol{x}.     The additional constraint is that the flow in the fluid domain has to satisfy Laplace's equation with appropriate boundary condition at the bottom z =- h ( x ) and that the potential at the free surface z = η is equal to φ        δ  ℋ   /  δ    Φ    =  0.            δ  ℋ   δ   normal-Φ   0.    \delta\mathcal{H}/\delta\Phi\,=\,0.     Relation with Lagrangian formulation  The Hamiltonian formulation can be derived from Luke's Lagrangian description by using Leibniz integral rule on the integral of ∂ Φ /∂ t : 14        ℒ  H   =    ∫   t  0    t  1     ∬    {    φ   (  𝒙  ,  t  )       ∂  η    (  𝒙  ,  t  )     ∂  t      -   H   (  φ  ,  η  ;  𝒙  ,  t  )     }   d   𝒙   d  t      ,       subscript  ℒ  H     superscript   subscript    subscript  t  0     subscript  t  1     double-integral         φ   𝒙  t         η    𝒙  t      t       H   φ  η  𝒙  t      d  𝒙  d  t       \mathcal{L}_{H}=\int_{t_{0}}^{t_{1}}\iint\left\{\varphi(\boldsymbol{x},t)\,%
 \frac{\partial\eta(\boldsymbol{x},t)}{\partial t}\,-\,H(\varphi,\eta;%
 \boldsymbol{x},t)\right\}\;\text{d}\boldsymbol{x}\;\text{d}t,     with     φ   (  𝒙  ,  t  )    =   Φ   (  𝒙  ,   η   (  𝒙  ,  t  )    ,  t  )          φ   𝒙  t      normal-Φ   𝒙    η   𝒙  t    t      \varphi(\boldsymbol{x},t)=\Phi(\boldsymbol{x},\eta(\boldsymbol{x},t),t)   the value of the velocity potential at the free surface, and    H   (  φ  ,  η  ;  𝒙  ,  t  )       H   φ  η  𝒙  t     H(\varphi,\eta;\boldsymbol{x},t)   the Hamiltonian density — sum of the kinetic and potential energy density — and related to the Hamiltonian as:        ℋ   (  φ  ,  η  )    =   ∬   H   (  φ  ,  η  ;  𝒙  ,  t  )   d  𝒙     .        ℋ   φ  η     double-integral    H   φ  η  𝒙  t   d  𝒙      \mathcal{H}(\varphi,\eta)\,=\,\iint H(\varphi,\eta;\boldsymbol{x},t)\;\text{d}%
 \boldsymbol{x}.     The Hamiltonian density is written in terms of the surface potential using Green's third identity on the kinetic energy: 15        H   =      1  2     ρ       1   +    |   ∇  η   |   2       φ    (   D   (  η  )   φ   )    +     1  2     ρ    g    η  2      ,      H        1  2   ρ      1   superscript     bold-∇  η    2     φ    D  η  φ        1  2   ρ  g   superscript  η  2       H\,=\,\frac{1}{2}\,\rho\,\sqrt{1\,+\,\left|\boldsymbol{\nabla}\eta\right|^{2}}%
 \;\;\varphi\,\bigl(D(\eta)\;\varphi\bigr)\,+\,\frac{1}{2}\,\rho\,g\,\eta^{2},     where D ( η ) φ is equal to the normal derivative of ∂ Φ /∂ n at the free surface. Because of the linearity of the Laplace equation — valid in the fluid interior and depending on the boundary condition at the bed z =- h and free surface z = η — the normal derivative ∂ Φ /∂ n is a linear function of the surface potential φ , but depends non-linear on the surface elevation η . This is expressed by the Dirichlet-to-Neumann operator D ( η ), acting linearly on φ .  The Hamiltonian density can also be written as: 16        H   =      1  2     ρ    φ    [     w    (    1   +    |   ∇  η   |   2    )    -    ∇  η   ⋅   ∇  φ     ]    +     1  2     ρ    g    η  2      ,      H        1  2   ρ  φ   delimited-[]      w    1   superscript     bold-∇  η    2      normal-⋅   bold-∇  η    bold-∇  φ           1  2   ρ  g   superscript  η  2       H\,=\,\frac{1}{2}\,\rho\,\varphi\,\Bigl[w\,\left(1\,+\,\left|\boldsymbol{%
 \nabla}\eta\right|^{2}\right)-\,\boldsymbol{\nabla}\eta\cdot\boldsymbol{\nabla%
 }\,\varphi\Bigr]\,+\,\frac{1}{2}\,\rho\,g\,\eta^{2},     with w ( x , t ) = ∂ Φ /∂ z the vertical velocity at the free surface z = η . Also w is a linear function of the surface potential φ through the Laplace equation, but w depends non-linear on the surface elevation η : 17        w   =   W   (  η  )   φ    ,      w    W  η  φ     w\,=\,W(\eta)\,\varphi,     with W operating linear on φ , but being non-linear in η . As a result, the Hamiltonian is a quadratic functional of the surface potential φ . Also the potential energy part of the Hamiltonian is quadratic. The source of non-linearity in surface gravity waves is through the kinetic energy depending non-linear on the free surface shape η . 18  Further ∇ φ is not to be mistaken for the horizontal velocity ∇ Φ at the free surface:        ∇   φ    =    ∇  Φ    (  𝒙  ,   η   (  𝒙  ,  t  )    ,  t  )    =     [    ∇   Φ    +      ∂  Φ    ∂  z      ∇  η     ]    z  =   η   (  𝒙  ,  t  )       =      [   ∇  Φ   ]    z  =   η   (  𝒙  ,  t  )       +    w    ∇  η      .         bold-∇  φ      bold-∇  normal-Φ    𝒙    η   𝒙  t    t          subscript   delimited-[]     bold-∇  normal-Φ         normal-Φ     z     bold-∇  η        z    η   𝒙  t              subscript   delimited-[]   bold-∇  normal-Φ      z    η   𝒙  t        w   bold-∇  η        \boldsymbol{\nabla}\varphi\,=\,\boldsymbol{\nabla}\Phi\bigl(\boldsymbol{x},%
 \eta(\boldsymbol{x},t),t\bigr)\,=\,\left[\boldsymbol{\nabla}\Phi\,+\,\frac{%
 \partial\Phi}{\partial z}\,\boldsymbol{\nabla}\eta\right]_{z=\eta(\boldsymbol{%
 x},t)}\,=\,\Bigl[\boldsymbol{\nabla}\Phi\Bigr]_{z=\eta(\boldsymbol{x},t)}\,+\,%
 w\,\boldsymbol{\nabla}\eta.     Taking the variations of the Lagrangian    ℒ  H     subscript  ℒ  H    \mathcal{L}_{H}   with respect to the canonical variables    φ   (  𝒙  ,  t  )       φ   𝒙  t     \varphi(\boldsymbol{x},t)   and    η   (  𝒙  ,  t  )       η   𝒙  t     \eta(\boldsymbol{x},t)   gives:       ρ      ∂  η    ∂  t         ρ      η     t      \displaystyle\rho\,\frac{\partial\eta}{\partial t}     provided in the fluid interior Φ satisfies the Laplace equation, Δ Φ =0, as well as the bottom boundary condition at z =- h and Φ = φ at the free surface.  References and notes  "  Category:Fluid dynamics     ↩  ↩  ↩  Originally appeared in Zhurnal Prildadnoi Mekhaniki i Tekhnicheskoi Fiziki  9 (2): 86–94, 1968. ↩  ↩  ↩  ↩  ↩        ↩        
   Luke's variational principle      Luke's variational principle   In fluid dynamics , Luke's variational principle is a Lagrangian  variational description of the motion of surface waves on a fluid with a free surface , under the action of gravity . This principle is named after J.C. Luke, who published it in 1967. 1 This variational principle is for incompressible and inviscid  potential flows , and is used to derive approximate wave models like the so-called mild-slope equation , 2 or using the averaged Lagrangian approach for wave propagation in inhomogeneous media. 3  Luke's Lagrangian formulation can also be recast into a Hamiltonian formulation in terms of the surface elevation and velocity potential at the free surface. 4 5 6 This is often used when modelling the spectral density evolution of the free-surface in a sea state , sometimes called wave turbulence .  Both the Lagrangian and Hamiltonian formulations can be extended to include surface tension effects.  Luke's Lagrangian  Luke's Lagrangian formulation is for non-linear surface gravity waves on anâ€” incompressible , irrotational and inviscid â€” potential flow .  The relevant ingredients, needed in order to describe this flow, are:   Î¦ ( x , z , t ) is the velocity potential ,  Ï is the fluid density ,  g is the acceleration by the Earth's gravity ,  x is the horizontal coordinate vector with components x and y ,  x and y are the horizontal coordinates,  z is the vertical coordinate,  t is time, and  âˆ‡ is the horizontal gradient operator, so âˆ‡ Î¦ is the horizontal flow velocity consisting of âˆ‚ Î¦ /âˆ‚ x and âˆ‚ Î¦ /âˆ‚ y ,  V ( t ) is the time-dependent fluid domain with free surface.   The Lagrangian   â„’   â„’   \mathcal{L}   , as given by Luke, is:       â„’  =   -    âˆ«   t  0    t  1      {    âˆ­   V   (  t  )      Ï   [     âˆ‚  Î¦    âˆ‚  t    +    1  2     |   âˆ‡  Î¦   |   2    +    1  2     (    âˆ‚  Î¦    âˆ‚  z    )   2    +    g   z    ]   d   x   d   y   d   z     }   d  t      .      â„’      superscript   subscript    subscript  t  0     subscript  t  1         subscript  triple-integral    V  t      Ï   delimited-[]        normal-Î¦     t        1  2    superscript     bold-âˆ‡  normal-Î¦    2        1  2    superscript      normal-Î¦     z    2      g  z     d  x  d  y  d  z     d  t       \mathcal{L}=-\int_{t_{0}}^{t_{1}}\left\{\iiint_{V(t)}\rho\left[\frac{\partial%
 \Phi}{\partial t}+\frac{1}{2}\left|\boldsymbol{\nabla}\Phi\right|^{2}+\frac{1}%
 {2}\left(\frac{\partial\Phi}{\partial z}\right)^{2}+g\,z\right]\;\text{d}x\;%
 \text{d}y\;\text{d}z\;\right\}\;\text{d}t.     From Bernoulli's principle , this Lagrangian can be seen to be the integral of the fluid pressure over the whole time-dependent fluid domain V ( t ). This is in agreement with the variational principles for inviscid flow without a free surface, found by Harry Bateman . 7  Variation with respect to the velocity potential Î¦ ( x , z , t'') and free-moving surfaces like z = Î· ( x , t'') results in the Laplace equation for the potential in the fluid interior and all required boundary conditions : kinematic boundary conditions on all fluid boundaries and dynamic boundary conditions on free surfaces. 8 This may also include moving wavemaker walls and ship motion.  For the case of a horizontally unbounded domain with the free fluid surface at z = Î· ( x , t'') and a fixed bed at z =âˆ’ h ( x ''), Luke's variational principle results in the Lagrangian:       â„’  =   -    âˆ«   t  0    t  1     âˆ¬    {     âˆ«   -   h   (  ğ’™  )      Î·   (  ğ’™  ,  t  )       Ï    [     âˆ‚  Î¦    âˆ‚  t    +    1  2     |   âˆ‡  Î¦   |   2    +    1  2     (    âˆ‚  Î¦    âˆ‚  z    )   2     ]   d   z     +     1  2     Ï    g    Î·  2     }   d   ğ’™   d  t       .      â„’      superscript   subscript    subscript  t  0     subscript  t  1     double-integral         superscript   subscript       h  ğ’™       Î·   ğ’™  t       Ï   delimited-[]        normal-Î¦     t        1  2    superscript     bold-âˆ‡  normal-Î¦    2        1  2    superscript      normal-Î¦     z    2      d  z        1  2   Ï  g   superscript  Î·  2      d  ğ’™  d  t        \mathcal{L}=-\,\int_{t_{0}}^{t_{1}}\iint\left\{\int_{-h(\boldsymbol{x})}^{\eta%
 (\boldsymbol{x},t)}\rho\,\left[\frac{\partial\Phi}{\partial t}+\,\frac{1}{2}%
 \left|\boldsymbol{\nabla}\Phi\right|^{2}+\,\frac{1}{2}\left(\frac{\partial\Phi%
 }{\partial z}\right)^{2}\right]\;\text{d}z\;+\,\frac{1}{2}\,\rho\,g\,\eta^{2}%
 \right\}\;\text{d}\boldsymbol{x}\;\text{d}t.     The bed-level term proportional to h 2 in the potential energy has been neglected, since it is a constant and does not contribute in the variations. Below, Luke's variational principle is used to arrive at the flow equations for non-linear surface gravity waves on a potential flow.  Derivation of the flow equations resulting from Luke's variational principle  The variation     Î´  â„’   =  0        Î´  â„’   0    \delta\mathcal{L}=0   in the Lagrangian with respect to variations in the velocity potential Î¦ ( x , z , t''), as well as with respect to the surface elevation Î· ( x , t''), have to be zero. We consider both variations subsequently.  Variation with respect to the velocity potential  Consider a small variation Î´Î¦ in the velocity potential Î¦ . 9 Then the resulting variation in the Lagrangian is:       Î´  Î¦   â„’       subscript  Î´  normal-Î¦   â„’    \displaystyle\delta_{\Phi}\mathcal{L}     Using Leibniz integral rule , this becomes, in case of constant density Ï : 10        Î´  Î¦    â„’    =          subscript  Î´  normal-Î¦   â„’   absent    \displaystyle\delta_{\Phi}\mathcal{L}\,=     The first integral on the right-hand side integrates out to the boundaries, in x and t , of the integration domain and is zero since the variations Î´Î¦ are taken to be zero at these boundaries. For variations Î´Î¦ which are zero at the free surface and the bed, the second integral remains, which is only zero for arbitrary Î´Î¦ in the fluid interior if there the Laplace equation holds:         Î”   Î¦    =  0     for  -   h   (  ğ’™  )     <   z   <   Î·   (  ğ’™  ,  t  )      ,     formulae-sequence      normal-Î”  normal-Î¦   0         for    h  ğ’™    z         Î·   ğ’™  t        \Delta\Phi\,=\,0\qquad\text{ for }-h(\boldsymbol{x})\,<\,z\,<\,\eta(%
 \boldsymbol{x},t),     with Î”=âˆ‡Â·âˆ‡ + âˆ‚ 2 /âˆ‚ z 2 the Laplace operator .  If variations Î´Î¦ are considered which are only non-zero at the free surface, only the third integral remains, giving rise to the kinematic free-surface boundary condition:             âˆ‚  Î·    âˆ‚  t     +    âˆ‡  Î¦   â‹…   âˆ‡   Î·      -     âˆ‚  Î¦    âˆ‚  z      =  0.     at   z    =   Î·   (  ğ’™  ,  t  )      .     formulae-sequence            Î·     t     normal-â‹…   bold-âˆ‡  normal-Î¦    bold-âˆ‡  Î·         normal-Î¦     z     0.       at  z     Î·   ğ’™  t       \frac{\partial\eta}{\partial t}\,+\,\boldsymbol{\nabla}\Phi\cdot\boldsymbol{%
 \nabla}\eta\,-\,\frac{\partial\Phi}{\partial z}\,=\,0.\qquad\text{ at }z\,=\,%
 \eta(\boldsymbol{x},t).     Similarly, variations Î´Î¦ only non-zero at the bottom z = - h result in the kinematic bed condition:           âˆ‡  Î¦   â‹…   âˆ‡   h     +     âˆ‚  Î¦    âˆ‚  z      =  0     at   z    =   -   h   (  ğ’™  )       .     formulae-sequence       normal-â‹…   bold-âˆ‡  normal-Î¦    bold-âˆ‡  h        normal-Î¦     z     0       at  z       h  ğ’™       \boldsymbol{\nabla}\Phi\cdot\boldsymbol{\nabla}h\,+\,\frac{\partial\Phi}{%
 \partial z}\,=\,0\qquad\text{ at }z\,=\,-h(\boldsymbol{x}).     Variation with respect to the surface elevation  Considering the variation of the Lagrangian with respect to small changes Î´Î· gives:        Î´  Î·    â„’    =    â„’   (  Î¦  ,   Î·  +   Î´  Î·    )    -   â„’   (  Î¦  ,  Î·  )     =   -    âˆ«   t  0    t  1     âˆ¬      [    Ï   Î´   Î·    (     âˆ‚  Î¦    âˆ‚  t    +     1  2       |   âˆ‡  Î¦   |   2     +     1  2      (    âˆ‚  Î¦    âˆ‚  z    )   2    +    g   Î·    )    ]    z  =   Î·   (  ğ’™  ,  t  )       d   ğ’™   d   t       =  0.           subscript  Î´  Î·   â„’       â„’   normal-Î¦    Î·    Î´  Î·        â„’   normal-Î¦  Î·              superscript   subscript    subscript  t  0     subscript  t  1     double-integral     subscript   delimited-[]    Ï  Î´  Î·        normal-Î¦     t        1  2    superscript     bold-âˆ‡  normal-Î¦    2        1  2    superscript      normal-Î¦     z    2      g  Î·        z    Î·   ğ’™  t      d  ğ’™  d  t           0.     \delta_{\eta}\mathcal{L}\,=\,\mathcal{L}(\Phi,\eta+\delta\eta)\,-\,\mathcal{L}%
 (\Phi,\eta)=\,-\,\int_{t_{0}}^{t_{1}}\iint\left[\rho\,\delta\eta\,\left(\frac{%
 \partial\Phi}{\partial t}+\,\frac{1}{2}\,\left|\boldsymbol{\nabla}\Phi\right|^%
 {2}\,+\,\frac{1}{2}\,\left(\frac{\partial\Phi}{\partial z}\right)^{2}+\,g\,%
 \eta\right)\,\right]_{z=\eta(\boldsymbol{x},t)}\;\text{d}\boldsymbol{x}\;\text%
 {d}t\,=\,0.     This has to be zero for arbitrary Î´Î· , giving rise to the dynamic boundary condition at the free surface:           âˆ‚  Î¦    âˆ‚  t    +     1  2       |   âˆ‡  Î¦   |   2     +     1  2      (    âˆ‚  Î¦    âˆ‚  z    )   2    +    g    Î·     =  0     at   z    =   Î·   (  ğ’™  ,  t  )      .     formulae-sequence          normal-Î¦     t        1  2    superscript     bold-âˆ‡  normal-Î¦    2        1  2    superscript      normal-Î¦     z    2      g  Î·    0       at  z     Î·   ğ’™  t       \frac{\partial\Phi}{\partial t}+\,\frac{1}{2}\,\left|\boldsymbol{\nabla}\Phi%
 \right|^{2}\,+\,\frac{1}{2}\,\left(\frac{\partial\Phi}{\partial z}\right)^{2}+%
 \,g\,\eta\,=\,0\qquad\text{ at }z\,=\,\eta(\boldsymbol{x},t).     This is the Bernoulli equation for unsteady potential flow, applied at the free surface, and with the pressure above the free surface being a constant â€” which constant pressure is taken equal to zero for simplicity.  Hamiltonian formulation  The Hamiltonian structure of surface gravity waves on a potential flow was discovered by Vladimir E. Zakharov in 1968, and rediscovered independently by Bert Broer and John Miles : 11 12 13       Ï      âˆ‚  Î·    âˆ‚  t         Ï      Î·     t      \displaystyle\rho\,\frac{\partial\eta}{\partial t}     where the surface elevation Î· and surface potential Ï† â€” which is the potential Î¦ at the free surface z = Î· ( x , t ) â€” are the canonical variables . The Hamiltonian    â„‹   (  Ï†  ,  Î·  )       â„‹   Ï†  Î·     \mathcal{H}(\varphi,\eta)   is the sum of the kinetic and potential energy of the fluid:        â„‹   =   âˆ¬    {     âˆ«   -   h   (  ğ’™  )      Î·   (  ğ’™  ,  t  )        1  2     Ï    [      |   âˆ‡  Î¦   |   2    +    (    âˆ‚  Î¦    âˆ‚  z    )   2    ]   d   z     +     1  2     Ï    g    Î·  2     }   d  ğ’™     .      â„‹   double-integral         superscript   subscript       h  ğ’™       Î·   ğ’™  t         1  2   Ï   delimited-[]     superscript     bold-âˆ‡  normal-Î¦    2    superscript      normal-Î¦     z    2     d  z        1  2   Ï  g   superscript  Î·  2      d  ğ’™      \mathcal{H}\,=\,\iint\left\{\int_{-h(\boldsymbol{x})}^{\eta(\boldsymbol{x},t)}%
 \frac{1}{2}\,\rho\,\left[\left|\boldsymbol{\nabla}\Phi\right|^{2}\,+\,\left(%
 \frac{\partial\Phi}{\partial z}\right)^{2}\right]\,\text{d}z\,+\,\frac{1}{2}\,%
 \rho\,g\,\eta^{2}\right\}\;\text{d}\boldsymbol{x}.     The additional constraint is that the flow in the fluid domain has to satisfy Laplace's equation with appropriate boundary condition at the bottom z =- h ( x ) and that the potential at the free surface z = Î· is equal to Ï†        Î´  â„‹   /  Î´    Î¦    =  0.            Î´  â„‹   Î´   normal-Î¦   0.    \delta\mathcal{H}/\delta\Phi\,=\,0.     Relation with Lagrangian formulation  The Hamiltonian formulation can be derived from Luke's Lagrangian description by using Leibniz integral rule on the integral of âˆ‚ Î¦ /âˆ‚ t : 14        â„’  H   =    âˆ«   t  0    t  1     âˆ¬    {    Ï†   (  ğ’™  ,  t  )       âˆ‚  Î·    (  ğ’™  ,  t  )     âˆ‚  t      -   H   (  Ï†  ,  Î·  ;  ğ’™  ,  t  )     }   d   ğ’™   d  t      ,       subscript  â„’  H     superscript   subscript    subscript  t  0     subscript  t  1     double-integral         Ï†   ğ’™  t         Î·    ğ’™  t      t       H   Ï†  Î·  ğ’™  t      d  ğ’™  d  t       \mathcal{L}_{H}=\int_{t_{0}}^{t_{1}}\iint\left\{\varphi(\boldsymbol{x},t)\,%
 \frac{\partial\eta(\boldsymbol{x},t)}{\partial t}\,-\,H(\varphi,\eta;%
 \boldsymbol{x},t)\right\}\;\text{d}\boldsymbol{x}\;\text{d}t,     with     Ï†   (  ğ’™  ,  t  )    =   Î¦   (  ğ’™  ,   Î·   (  ğ’™  ,  t  )    ,  t  )          Ï†   ğ’™  t      normal-Î¦   ğ’™    Î·   ğ’™  t    t      \varphi(\boldsymbol{x},t)=\Phi(\boldsymbol{x},\eta(\boldsymbol{x},t),t)   the value of the velocity potential at the free surface, and    H   (  Ï†  ,  Î·  ;  ğ’™  ,  t  )       H   Ï†  Î·  ğ’™  t     H(\varphi,\eta;\boldsymbol{x},t)   the Hamiltonian density â€” sum of the kinetic and potential energy density â€” and related to the Hamiltonian as:        â„‹   (  Ï†  ,  Î·  )    =   âˆ¬   H   (  Ï†  ,  Î·  ;  ğ’™  ,  t  )   d  ğ’™     .        â„‹   Ï†  Î·     double-integral    H   Ï†  Î·  ğ’™  t   d  ğ’™      \mathcal{H}(\varphi,\eta)\,=\,\iint H(\varphi,\eta;\boldsymbol{x},t)\;\text{d}%
 \boldsymbol{x}.     The Hamiltonian density is written in terms of the surface potential using Green's third identity on the kinetic energy: 15        H   =      1  2     Ï       1   +    |   âˆ‡  Î·   |   2       Ï†    (   D   (  Î·  )   Ï†   )    +     1  2     Ï    g    Î·  2      ,      H        1  2   Ï      1   superscript     bold-âˆ‡  Î·    2     Ï†    D  Î·  Ï†        1  2   Ï  g   superscript  Î·  2       H\,=\,\frac{1}{2}\,\rho\,\sqrt{1\,+\,\left|\boldsymbol{\nabla}\eta\right|^{2}}%
 \;\;\varphi\,\bigl(D(\eta)\;\varphi\bigr)\,+\,\frac{1}{2}\,\rho\,g\,\eta^{2},     where D ( Î· ) Ï† is equal to the normal derivative of âˆ‚ Î¦ /âˆ‚ n at the free surface. Because of the linearity of the Laplace equation â€” valid in the fluid interior and depending on the boundary condition at the bed z =- h and free surface z = Î· â€” the normal derivative âˆ‚ Î¦ /âˆ‚ n is a linear function of the surface potential Ï† , but depends non-linear on the surface elevation Î· . This is expressed by the Dirichlet-to-Neumann operator D ( Î· ), acting linearly on Ï† .  The Hamiltonian density can also be written as: 16        H   =      1  2     Ï    Ï†    [     w    (    1   +    |   âˆ‡  Î·   |   2    )    -    âˆ‡  Î·   â‹…   âˆ‡  Ï†     ]    +     1  2     Ï    g    Î·  2      ,      H        1  2   Ï  Ï†   delimited-[]      w    1   superscript     bold-âˆ‡  Î·    2      normal-â‹…   bold-âˆ‡  Î·    bold-âˆ‡  Ï†           1  2   Ï  g   superscript  Î·  2       H\,=\,\frac{1}{2}\,\rho\,\varphi\,\Bigl[w\,\left(1\,+\,\left|\boldsymbol{%
 \nabla}\eta\right|^{2}\right)-\,\boldsymbol{\nabla}\eta\cdot\boldsymbol{\nabla%
 }\,\varphi\Bigr]\,+\,\frac{1}{2}\,\rho\,g\,\eta^{2},     with w ( x , t ) = âˆ‚ Î¦ /âˆ‚ z the vertical velocity at the free surface z = Î· . Also w is a linear function of the surface potential Ï† through the Laplace equation, but w depends non-linear on the surface elevation Î· : 17        w   =   W   (  Î·  )   Ï†    ,      w    W  Î·  Ï†     w\,=\,W(\eta)\,\varphi,     with W operating linear on Ï† , but being non-linear in Î· . As a result, the Hamiltonian is a quadratic functional of the surface potential Ï† . Also the potential energy part of the Hamiltonian is quadratic. The source of non-linearity in surface gravity waves is through the kinetic energy depending non-linear on the free surface shape Î· . 18  Further âˆ‡ Ï† is not to be mistaken for the horizontal velocity âˆ‡ Î¦ at the free surface:        âˆ‡   Ï†    =    âˆ‡  Î¦    (  ğ’™  ,   Î·   (  ğ’™  ,  t  )    ,  t  )    =     [    âˆ‡   Î¦    +      âˆ‚  Î¦    âˆ‚  z      âˆ‡  Î·     ]    z  =   Î·   (  ğ’™  ,  t  )       =      [   âˆ‡  Î¦   ]    z  =   Î·   (  ğ’™  ,  t  )       +    w    âˆ‡  Î·      .         bold-âˆ‡  Ï†      bold-âˆ‡  normal-Î¦    ğ’™    Î·   ğ’™  t    t          subscript   delimited-[]     bold-âˆ‡  normal-Î¦         normal-Î¦     z     bold-âˆ‡  Î·        z    Î·   ğ’™  t              subscript   delimited-[]   bold-âˆ‡  normal-Î¦      z    Î·   ğ’™  t        w   bold-âˆ‡  Î·        \boldsymbol{\nabla}\varphi\,=\,\boldsymbol{\nabla}\Phi\bigl(\boldsymbol{x},%
 \eta(\boldsymbol{x},t),t\bigr)\,=\,\left[\boldsymbol{\nabla}\Phi\,+\,\frac{%
 \partial\Phi}{\partial z}\,\boldsymbol{\nabla}\eta\right]_{z=\eta(\boldsymbol{%
 x},t)}\,=\,\Bigl[\boldsymbol{\nabla}\Phi\Bigr]_{z=\eta(\boldsymbol{x},t)}\,+\,%
 w\,\boldsymbol{\nabla}\eta.     Taking the variations of the Lagrangian    â„’  H     subscript  â„’  H    \mathcal{L}_{H}   with respect to the canonical variables    Ï†   (  ğ’™  ,  t  )       Ï†   ğ’™  t     \varphi(\boldsymbol{x},t)   and    Î·   (  ğ’™  ,  t  )       Î·   ğ’™  t     \eta(\boldsymbol{x},t)   gives:       Ï      âˆ‚  Î·    âˆ‚  t         Ï      Î·     t      \displaystyle\rho\,\frac{\partial\eta}{\partial t}     provided in the fluid interior Î¦ satisfies the Laplace equation, Î” Î¦ =0, as well as the bottom boundary condition at z =- h and Î¦ = Ï† at the free surface.  References and notes  "  Category:Fluid dynamics     â†©  â†©  â†©  Originally appeared in Zhurnal Prildadnoi Mekhaniki i Tekhnicheskoi Fiziki  9 (2): 86â€“94, 1968. â†©  â†©  â†©  â†©  â†©        â†©        
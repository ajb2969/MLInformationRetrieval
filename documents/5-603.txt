   Laplacian matrix      Laplacian matrix  table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
   margin: 0; padding: 0; vertical-align: baseline; border: none; }
 <style>
 table.sourceCode { width: 100%; line-height: 100%; }
 td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
 td.sourceCode { padding-left: 5px; }
 code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
 code > span.dt { color: #902000; } /* DataType */
 code > span.dv { color: #40a070; } /* DecVal */
 code > span.bn { color: #40a070; } /* BaseN */
 code > span.fl { color: #40a070; } /* Float */
 code > span.ch { color: #4070a0; } /* Char */
 code > span.st { color: #4070a0; } /* String */
 code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
 code > span.ot { color: #007020; } /* Other */
 code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
 code > span.fu { color: #06287e; } /* Function */
 code > span.er { color: #ff0000; font-weight: bold; } /* Error */
 code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
 code > span.cn { color: #880000; } /* Constant */
 code > span.sc { color: #4070a0; } /* SpecialChar */
 code > span.vs { color: #4070a0; } /* VerbatimString */
 code > span.ss { color: #bb6688; } /* SpecialString */
 code > span.im { } /* Import */
 code > span.va { color: #19177c; } /* Variable */
 code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
 code > span.op { color: #666666; } /* Operator */
 code > span.bu { } /* BuiltIn */
 code > span.ex { } /* Extension */
 code > span.pp { color: #bc7a00; } /* Preprocessor */
 code > span.at { color: #7d9029; } /* Attribute */
 code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
 code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
 code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
 code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */     In the mathematical field of graph theory , the Laplacian matrix , sometimes called admittance matrix , Kirchhoff matrix or discrete Laplacian , is a matrix representation of a graph . Together with Kirchhoff's theorem , it can be used to calculate the number of spanning trees for a given graph. The Laplacian matrix can be used to find many other properties of the graph. Cheeger's inequality from Riemannian geometry has a discrete analogue involving the Laplacian matrix; this is perhaps the most important theorem in spectral graph theory and one of the most useful facts in algorithmic applications. It approximates the sparsest cut of a graph through the second eigenvalue of its Laplacian.  Definition  Given a simple graph  G with n vertices, its Laplacian matrix    L   n  √ó  n      subscript  L    n  n     L_{n\times n}   is defined as: 1       L  =   D  -  A    ,      L    D  A     L=D-A,   where D is the degree matrix and A is the adjacency matrix of the graph. In the case of directed graphs , either the indegree or outdegree might be used, depending on the application.  The elements of   L   L   L   are given by       L   i  ,  j    :=   {      deg   (   v  i   )         if   i   =  j        -  1        if   i   ‚â†    j    and    v  i   is adjacent to   v  j         0    otherwise         assign   subscript  L   i  j     cases   degree   subscript  v  i        if  i   j     1       if  i     j  and   subscript  v  i   is adjacent to   subscript  v  j     0  otherwise     L_{i,j}:=\begin{cases}\deg(v_{i})&\mbox{if}\ i=j\\
 -1&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}\mbox{ is adjacent to }v_{j}\\
 0&\mbox{otherwise}\end{cases}     where deg( v i ) is degree of the vertex i .  The symmetric normalized Laplacian matrix is defined as: 2       L  sym   :=    D   -   1  /  2     L   D   -   1  /  2      =   I  -    D   -   1  /  2     A   D   -   1  /  2            assign   superscript  L  sym      superscript  D      1  2     L   superscript  D      1  2             I     superscript  D      1  2     A   superscript  D      1  2          L^{\text{sym}}:=D^{-1/2}LD^{-1/2}=I-D^{-1/2}AD^{-1/2}   ,  The elements of    L  sym     superscript  L  sym    L^{\text{sym}}   are given by       L   i  ,  j   sym   :=   {     1       if   i   =    j    and    deg   (   v  i   )     ‚â†  0        -    1     deg   (   v  i   )     deg   (   v  j   )              if   i   ‚â†    j    and    v  i   is adjacent to   v  j         0     otherwise  .          assign   subscript   superscript  L  sym    i  j     cases  1        if  i     j  and   degree   subscript  v  i          0        1       degree   subscript  v  i     degree   subscript  v  j            if  i     j  and   subscript  v  i   is adjacent to   subscript  v  j     0  otherwise     L^{\text{sym}}_{i,j}:=\begin{cases}1&\mbox{if}\ i=j\ \mbox{and}\ \deg(v_{i})%
 \neq 0\\
 -\frac{1}{\sqrt{\deg(v_{i})\deg(v_{j})}}&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}%
 \mbox{ is adjacent to }v_{j}\\
 0&\mbox{otherwise}.\end{cases}     The random-walk normalized Laplacian matrix is defined as:       L  rw   :=    D   -  1    L   =   I  -    D   -  1    A         assign   superscript  L  rw      superscript  D    1    L          I     superscript  D    1    A       L^{\text{rw}}:=D^{-1}L=I-D^{-1}A     The elements of    L  rw     superscript  L  rw    L^{\text{rw}}   are given by       L   i  ,  j   rw   :=   {     1       if   i   =    j    and    deg   (   v  i   )     ‚â†  0        -    1   deg   (   v  i   )            if   i   ‚â†    j    and    v  i   is adjacent to   v  j         0     otherwise  .          assign   subscript   superscript  L  rw    i  j     cases  1        if  i     j  and   degree   subscript  v  i          0        1   degree   subscript  v  i          if  i     j  and   subscript  v  i   is adjacent to   subscript  v  j     0  otherwise     L^{\text{rw}}_{i,j}:=\begin{cases}1&\mbox{if}\ i=j\ \mbox{and}\ \deg(v_{i})%
 \neq 0\\
 -\frac{1}{\deg(v_{i})}&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}\mbox{ is adjacent%
  to }v_{j}\\
 0&\mbox{otherwise}.\end{cases}     Example  Here is a simple example of a labeled graph and its Laplacian matrix.      Labeled graph   Degree matrix   Adjacency matrix   Laplacian matrix       175px       (     2    0    0    0    0    0      0    3    0    0    0    0      0    0    2    0    0    0      0    0    0    3    0    0      0    0    0    0    3    0      0    0    0    0    0    1     )      2  0  0  0  0  0    0  3  0  0  0  0    0  0  2  0  0  0    0  0  0  3  0  0    0  0  0  0  3  0    0  0  0  0  0  1     \left(\begin{array}[]{rrrrrr}2&0&0&0&0&0\\
 0&3&0&0&0&0\\
 0&0&2&0&0&0\\
 0&0&0&3&0&0\\
 0&0&0&0&3&0\\
 0&0&0&0&0&1\\
 \end{array}\right)          (     0    1    0    0    1    0      1    0    1    0    1    0      0    1    0    1    0    0      0    0    1    0    1    1      1    1    0    1    0    0      0    0    0    1    0    0     )      0  1  0  0  1  0    1  0  1  0  1  0    0  1  0  1  0  0    0  0  1  0  1  1    1  1  0  1  0  0    0  0  0  1  0  0     \left(\begin{array}[]{rrrrrr}0&1&0&0&1&0\\
 1&0&1&0&1&0\\
 0&1&0&1&0&0\\
 0&0&1&0&1&1\\
 1&1&0&1&0&0\\
 0&0&0&1&0&0\\
 \end{array}\right)          (     2     -  1     0    0     -  1     0       -  1     3     -  1     0     -  1     0      0     -  1     2     -  1     0    0      0    0     -  1     3     -  1      -  1        -  1      -  1     0     -  1     3    0      0    0    0     -  1     0    1     )      2    1   0  0    1   0      1   3    1   0    1   0    0    1   2    1   0  0    0  0    1   3    1     1       1     1   0    1   3  0    0  0  0    1   0  1     \left(\begin{array}[]{rrrrrr}2&-1&0&0&-1&0\\
 -1&3&-1&0&-1&0\\
 0&-1&2&-1&0&0\\
 0&0&-1&3&-1&-1\\
 -1&-1&0&-1&3&0\\
 0&0&0&-1&0&1\\
 \end{array}\right)        Properties  For an (undirected) graph G and its Laplacian matrix L with eigenvalues      Œª  0   ‚â§   Œª  1   ‚â§  ‚ãØ  ‚â§   Œª   n  -  1           subscript  Œª  0    subscript  Œª  1        normal-‚ãØ        subscript  Œª    n  1       \lambda_{0}\leq\lambda_{1}\leq\cdots\leq\lambda_{n-1}   :   L is symmetric.  L is positive-semidefinite (that is     Œª  i   ‚â•  0       subscript  Œª  i   0    \lambda_{i}\geq 0   for all i ). This is verified in the incidence matrix section (below). This can also be seen from the fact that the Laplacian is symmetric and diagonally dominant .  L is an M-matrix (its off-diagonal entries are nonpositive, yet the real parts of its eigenvalues are nonnegative).  Every row sum and column sum of L is zero. Indeed, in the sum, the degree of the vertex is summed with a "-1" for each neighbor.  In consequence,     Œª  0   =  0       subscript  Œª  0   0    \lambda_{0}=0   , because the vector     ùêØ  0   =   (  1  ,  1  ,  ‚Ä¶  ,  1  )        subscript  ùêØ  0    1  1  normal-‚Ä¶  1     \mathbf{v}_{0}=(1,1,\dots,1)   satisfies     L   ùêØ  0    =  0.        L   subscript  ùêØ  0    0.    L\mathbf{v}_{0}=\mathbf{0}.     The number of times 0 appears as an eigenvalue in the Laplacian is the number of connected components in the graph.  The smallest non-zero eigenvalue of L is called the spectral gap .  The second smallest eigenvalue of L is the algebraic connectivity (or Fiedler value ) of G .  The Laplacian is an operator on the n-dimensional vector space of functions f : V ‚Üí   ‚Ñù   ‚Ñù   \mathbb{R}   , where V is the vertex set of G, and n = |V|.  When G is k-regular, the normalized Laplacian is    ‚Ñí  =     1  k    L   =   I  -     1  k    A          ‚Ñí      1  k   L          I      1  k   A       \mathcal{L}=\tfrac{1}{k}L=I-\tfrac{1}{k}A   , where A is the adjacency matrix and I is an identity matrix.  For a graph with multiple connected components , L is a block diagonal matrix, where each block is the respective Laplacian matrix for each component, possibly after reordering the vertices (i.e. L is permutation-similar to a block diagonal matrix).   Incidence matrix  Define an    |  e  |      e    |e|   x    |  v  |      v    |v|   oriented incidence matrix  M with element M ev for edge e (connecting vertex i and j , with i > j ) and vertex v given by       M   e  v    =   {      1  ,        if   v   =  i         -  1   ,        if   v   =  j        0  ,      otherwise  .             subscript  M    e  v     cases    1      if  v   i       1       if  v   j     0  otherwise       M_{ev}=\left\{\begin{array}[]{rl}1,&\text{if}\,v=i\\
 -1,&\text{if}\,v=j\\
 0,&\text{otherwise}.\end{array}\right.   Then the Laplacian matrix L satisfies       L  =    M  T    M     ,      L     superscript  M  T   M     L=M^{\text{T}}M\,,   where    M  T     superscript  M  T    M^{\text{T}}   is the matrix transpose of M .  Now consider an eigendecomposition of   L   L   L   , with unit-norm eigenvectors    ùêØ  i     subscript  ùêØ  i    \mathbf{v}_{i}   and corresponding eigenvalues    Œª  i     subscript  Œª  i    \lambda_{i}   :      Œª  i     subscript  Œª  i    \displaystyle\lambda_{i}   Because    Œª  i     subscript  Œª  i    \lambda_{i}   can be written as the inner product of the vector    M   ùêØ  i       M   subscript  ùêØ  i     M\mathbf{v}_{i}   with itself, this shows that     Œª  i   ‚â•  0       subscript  Œª  i   0    \lambda_{i}\geq 0   and so the eigenvalues of   L   L   L   are all non-negative.  Deformed Laplacian  The deformed Laplacian is commonly defined as       Œî   (  s  )    =    I  -   s  A    +    s  2    (   D  -  I   )           normal-Œî  s       I    s  A       superscript  s  2     D  I       \Delta(s)=I-sA+s^{2}(D-I)     where I is the unit matrix, A is the adjacency matrix, and D is the degree matrix, and s is a (complex-valued) number. Note that the standard Laplacian is just    Œî   (  1  )       normal-Œî  1    \Delta(1)   . 3  Symmetric normalized Laplacian  The (symmetric) normalized Laplacian is defined as       L  sym   :=    D   -   1  /  2     L   D   -   1  /  2      =   I  -    D   -   1  /  2     A   D   -   1  /  2            assign   superscript  L  sym      superscript  D      1  2     L   superscript  D      1  2             I     superscript  D      1  2     A   superscript  D      1  2          L^{\text{sym}}:=D^{-1/2}LD^{-1/2}=I-D^{-1/2}AD^{-1/2}   where L is the (unnormalized) Laplacian, A is the adjacency matrix and D is the degree matrix. Since the degree matrix D is diagonal and positive, its reciprocal square root    D   -   1  /  2       superscript  D      1  2      D^{-1/2}   is just the diagonal matrix whose diagonal entries are the reciprocals of the positive square roots of the diagonal entries of D . The symmetric normalized Laplacian is a symmetric matrix.  One has     L  sym   =   S   S  *         superscript  L  sym     S   superscript  S       L^{\text{sym}}=SS^{*}   , where S is the matrix whose rows are indexed by the vertices and whose columns are indexed by the edges of G such that each column corresponding to an edge e = {u, v} has an entry    1    d   u       1   subscript    d   u     \frac{1}{\sqrt{d}_{u}}   in the row corresponding to u, an entry    -   1    d   v          1   subscript    d   v      -\frac{1}{\sqrt{d}_{v}}   in the row corresponding to v, and has 0 entries elsewhere. (Note    S  *     superscript  S     S^{*}   denotes the transpose of S).  All eigenvalues of the normalized Laplacian are real and non-negative. We can see this as follows. Since    L  sym     superscript  L  sym    L^{\text{sym}}   is symmetric, its eigenvalues are real. They are also non-negative: consider an eigenvector g of    L  sym     superscript  L  sym    L^{\text{sym}}   with eigenvalue Œª and suppose    g  =    D   1  /  2    f       g     superscript  D    1  2    f     g=D^{1/2}f   . (We can consider g and f as real functions on the vertices v.) Then:        Œª   =     ‚ü®  g  ,    L  sym   g   ‚ü©    ‚ü®  g  ,  g  ‚ü©     =     ‚ü®  g  ,    D   -   1  /  2     L   D   -   1  /  2     g   ‚ü©    ‚ü®  g  ,  g  ‚ü©     =     ‚ü®  f  ,   L  f   ‚ü©    ‚ü®    D   1  /  2    f   ,    D   1  /  2    f   ‚ü©     =      ‚àë   u  ‚àº  v      (    f   (  u  )    -   f   (  v  )     )   2      ‚àë  v    f    (  v  )   2    d  v       >  0   ,        Œª     g     superscript  L  sym   g     g  g            g     superscript  D      1  2     L   superscript  D      1  2     g     g  g            f    L  f        superscript  D    1  2    f      superscript  D    1  2    f              subscript    similar-to  u  v     superscript      f  u     f  v    2      subscript   v     f   superscript  v  2    subscript  d  v           0     \lambda\ {}=\ {}\frac{\langle g,L^{\text{sym}}g\rangle}{\langle g,g\rangle}\ {%
 }=\ {}\frac{\langle g,D^{-1/2}LD^{-1/2}g\rangle}{\langle g,g\rangle}\ {}=\ {}%
 \frac{\langle f,Lf\rangle}{\langle D^{1/2}f,D^{1/2}f\rangle}\ {}=\ {}\frac{%
 \sum_{u\sim v}(f(u)-f(v))^{2}}{\sum_{v}f(v)^{2}d_{v}}\ >\ 0,   where we use the inner product     ‚ü®  f  ,  g  ‚ü©   =    ‚àë  v    f   (  v  )   g   (  v  )          f  g     subscript   v     f  v  g  v      \langle f,g\rangle=\sum_{v}f(v)g(v)   , a sum over all vertices v, and    ‚àë   u  ‚àº  v      subscript    similar-to  u  v     \sum_{u\sim v}   denotes the sum over all unordered pairs of adjacent vertices {u,v}. The quantity     ‚àë   u  ,  v      (    f   (  u  )    -   f   (  v  )     )   2       subscript    u  v     superscript      f  u     f  v    2     \sum_{u,v}(f(u)-f(v))^{2}   is called the Dirichlet sum of f, whereas the expression     ‚ü®  g  ,    L  sym   g   ‚ü©    ‚ü®  g  ,  g  ‚ü©        g     superscript  L  sym   g     g  g     \frac{\langle g,L^{\text{sym}}g\rangle}{\langle g,g\rangle}   is called the Rayleigh quotient of g.  Let 1 be the function which assumes the value 1 on each vertex. Then     D   1  /  2    1       superscript  D    1  2    1    D^{1/2}1   is an eigenfunction of    L  sym     superscript  L  sym    L^{\text{sym}}   with eigenvalue 0. 4  In fact, the eigenvalues of the normalized symmetric Laplacian satisfy 0 = Œº 0 ‚â§...‚â§ Œº n-1 ‚â§ 2. These eigenvalues (known as the spectrum of the normalized Laplacian) relate well to other graph invariants for general graphs. 5  Random walk normalized Laplacian  The random walk normalized Laplacian is defined as       L  rw   :=    D   -  1    A      assign   superscript  L  rw      superscript  D    1    A     L^{\text{rw}}:=D^{-1}A     where A is the Adjacency matrix and D is the degree matrix. Since the degree matrix D is diagonal, its inverse    D   -  1      superscript  D    1     D^{-1}   is simply defined as a diagonal matrix, having diagonal entries which are the reciprocals of the corresponding positive diagonal entries of D . For the isolated vertices (those with degree 0), a common choice is to set the corresponding element    L   i  ,  i   rw     subscript   superscript  L  rw    i  i     L^{\text{rw}}_{i,i}   to 0. This convention results in a nice property that the multiplicity of the eigenvalue 0 is equal to the number of connected components in the graph. The matrix elements of    L  rw     superscript  L  rw    L^{\text{rw}}   are given by       L   i  ,  j   rw   :=   {     1       if   i   =    j    and    deg   (   v  i   )     ‚â†  0        -    1   deg   (   v  i   )            if   i   ‚â†    j    and    v  i   is adjacent to   v  j         0     otherwise  .          assign   subscript   superscript  L  rw    i  j     cases  1        if  i     j  and   degree   subscript  v  i          0        1   degree   subscript  v  i          if  i     j  and   subscript  v  i   is adjacent to   subscript  v  j     0  otherwise     L^{\text{rw}}_{i,j}:=\begin{cases}1&\mbox{if}\ i=j\ \mbox{and}\ \deg(v_{i})%
 \neq 0\\
 -\frac{1}{\deg(v_{i})}&\mbox{if}\ i\neq j\ \mbox{and}\ v_{i}\mbox{ is adjacent%
  to }v_{j}\\
 0&\mbox{otherwise}.\end{cases}     The name of the random-walk normalized Laplacian comes from the fact that this matrix is simply the transition matrix of a random walker on the graph. For example let    e  i     subscript  e  i    e_{i}   denote the i-th standard basis vector, then    x  =    e  i    L  rw        x     subscript  e  i    superscript  L  rw      x=e_{i}L^{\text{rw}}   is a probability vector representing the distribution of a random-walker's locations after taking a single step from vertex   i   i   i   . i.e.     x  j   =  ‚Ñô   (   v  i   ‚Üí   v  j   )      fragments   subscript  x  j    P   fragments  normal-(   subscript  v  i   normal-‚Üí   subscript  v  j   normal-)     x_{j}=\mathbb{P}(v_{i}\to v_{j})   . More generally if the vector   x   x   x   is a probability distribution of the location of a random-walker on the vertices of the graph then     x  ‚Ä≤   =   x    (   L  rw   )   t         superscript  x  normal-‚Ä≤     x   superscript   superscript  L  rw   t      x^{\prime}=x(L^{\text{rw}})^{t}   is the probability distribution of the walker after   t   t   t   steps.  One can check that       L  rw   =    D   -   1  2      (   I  -   L  sym    )    D   1  2          superscript  L  rw      superscript  D      1  2       I   superscript  L  sym     superscript  D    1  2       L^{\text{rw}}=D^{-\frac{1}{2}}\left(I-L^{\text{sym}}\right)D^{\frac{1}{2}}   ,  i.e.,    L  rw     superscript  L  rw    L^{\text{rw}}   is similar to the normalized Laplacian    L  sym     superscript  L  sym    L^{\text{sym}}   . For this reason, even if    L  rw     superscript  L  rw    L^{\text{rw}}   is in general not hermitian, it has real eigenvalues. Indeed, its eigenvalues agree with those of    L  sym     superscript  L  sym    L^{\text{sym}}   (which is hermitian) up to a reflection about 1/2.  In some of the literature, the matrix    I  -    D   -  1    A       I     superscript  D    1    A     I-D^{-1}A   is also referred to as the random-walk Laplacian since its properties approximate those of the standard discrete Laplacian from numerical analysis.  Graphs  As an aside about random walks on graphs , consider a simple undirected graph . Consider the probability that the walker is at the vertex i at time t , given the probability distribution that he was at vertex j at time t-1 (assuming a uniform chance of taking a step along any of the edges attached to a given vertex):         p  i    (  t  )    =    ‚àë  j      A   i  j     d  e  g   (   v  j   )      p  j    (   t  -  1   )      ,         subscript  p  i   t     subscript   j        subscript  A    i  j      d  e  g   subscript  v  j      subscript  p  j     t  1       p_{i}(t)=\sum_{j}\frac{A_{ij}}{deg(v_{j})}p_{j}(t-1),   or in matrix-vector notation:        p   (  t  )    =   A   D   -  1    p   (   t  -  1   )     .        p  t     A   superscript  D    1    p    t  1      p(t)=AD^{-1}p(t-1).   (Equilibrium, which sets in as    t  ‚Üí  ‚àû     normal-‚Üí  t     t\rightarrow\infty   , is defined by    p  =   A   D   -  1    p       p    A   superscript  D    1    p     p=AD^{-1}p   .)  We can rewrite this relation as       D   -   1  2     p   (  t  )        superscript  D      1  2     p  t    \displaystyle D^{-\frac{1}{2}}p(t)        A   r  e  d  u  c  e  d    ‚â°    D   -   1  2     A   D   -   1  2           subscript  A    r  e  d  u  c  e  d       superscript  D      1  2     A   superscript  D      1  2        A_{reduced}\equiv D^{-\frac{1}{2}}AD^{-\frac{1}{2}}   is a symmetric matrix called the reduced adjacency matrix . So, taking steps on this random walk requires taking powers of    A   r  e  d  u  c  e  d      subscript  A    r  e  d  u  c  e  d     A_{reduced}   , which is a simple operation because    A   r  e  d  u  c  e  d      subscript  A    r  e  d  u  c  e  d     A_{reduced}   is symmetric.  Interpretation as the discrete Laplace operator  The Laplacian matrix can be interpreted as a matrix representation of a particular case of the discrete Laplace operator . Such an interpretation allows one, e.g., to generalise the Laplacian matrix to the case of graphs with an infinite number of vertices and edges, leading to a Laplacian matrix of an infinite size.  To expand upon this, we can "describe" the change of some element    œï  i     subscript  œï  i    \phi_{i}   (with some constant k ) as        d   œï  i     d  t          d   subscript  œï  i      d  t     \displaystyle\frac{d\phi_{i}}{dt}     In matrix-vector notation,        d  œï    d  t          d  œï     d  t     \displaystyle\frac{d\phi}{dt}     which gives          d  œï    d  t     +   k  L  œï    =  0.            d  œï     d  t      k  L  œï    0.    \displaystyle\frac{d\phi}{dt}+kL\phi=0.     Notice that this equation takes the same form as the heat equation , where the matrix L is replacing the Laplacian operator    ‚àá  2     superscript  normal-‚àá  2    \nabla^{2}   ; hence, the "graph Laplacian".  To find a solution to this differential equation, apply standard techniques for solving a first-order matrix differential equation . That is, write   œï   œï   \phi   as a linear combination of eigenvectors    ùêØ  i     subscript  ùêØ  i    \mathbf{v}_{i}   of L (so that     L   ùêØ  i    =    Œª  i    ùêØ  i          L   subscript  ùêØ  i       subscript  Œª  i    subscript  ùêØ  i      L\mathbf{v}_{i}=\lambda_{i}\mathbf{v}_{i}   ), with time-dependent        œï  =     ‚àë  i      c  i    ùêØ  i      .           œï    subscript   i      subscript  c  i    subscript  ùêØ  i         \begin{aligned}\displaystyle\phi=\sum_{i}c_{i}\mathbf{v}_{i}.\end{aligned}     Plugging into the original expression (note that we will use the fact that because L is a symmetric matrix, its unit-norm eigenvectors    ùêØ  i     subscript  ùêØ  i    \mathbf{v}_{i}   are orthogonal):         d   (    ‚àë  i     c  i    ùêØ  i     )     d  t     +   k  L   (     ‚àë  i      c  i    ùêØ  i     )            d    subscript   i      subscript  c  i    subscript  ùêØ  i        d  t      k  L    subscript   i      subscript  c  i    subscript  ùêØ  i        \displaystyle\frac{d(\sum_{i}c_{i}\mathbf{v}_{i})}{dt}+kL(\sum_{i}c_{i}\mathbf%
 {v}_{i})     whose solution is         c  i    (  t  )    =    c  i    (  0  )    exp   (   -   k   Œª  i   t    )      .         subscript  c  i   t      subscript  c  i   0        k   subscript  Œª  i   t        \displaystyle c_{i}(t)=c_{i}(0)\exp(-k\lambda_{i}t).     As shown before, the eigenvalues    Œª  i     subscript  Œª  i    \lambda_{i}   of L are non-negative, showing that the solution to the diffusion equation approaches an equilibrium, because it only exponentially decays or remains constant. This also shows that given    Œª  i     subscript  Œª  i    \lambda_{i}   and the initial condition     c  i    (  0  )        subscript  c  i   0    c_{i}(0)   , the solution at any time t can be found. 6  To find     c  i    (  0  )        subscript  c  i   0    c_{i}(0)   for each   i   i   i   in terms of the overall initial condition    œï   (  0  )       œï  0    \phi(0)   , simply project    œï   (  0  )       œï  0    \phi(0)   onto the unit-norm eigenvectors    ùêØ  i     subscript  ùêØ  i    \mathbf{v}_{i}   ;        c  i    (  0  )    =   ‚ü®   œï   (  0  )    ,   ùêØ  i   ‚ü©          subscript  c  i   0      œï  0    subscript  ùêØ  i      c_{i}(0)=\langle\phi(0),\mathbf{v}_{i}\rangle   .  In the case of undirected graphs, this works because   L   L   L   is symmetric, and by the spectral theorem , its eigenvectors are all orthogonal. So the projection onto the eigenvectors of   L   L   L   is simply an orthogonal coordinate transformation of the initial condition to a set of coordinates which decay exponentially and independently of each other.  Equilibrium Behavior  To understand     lim   t  ‚Üí  ‚àû     œï   (  t  )        subscript    normal-‚Üí  t       œï  t     \lim_{t\to\infty}\phi(t)   , note that the only terms      c  i    (  t  )    =    c  i    (  0  )    exp   (   -   k   Œª  i   t    )            subscript  c  i   t      subscript  c  i   0        k   subscript  Œª  i   t        c_{i}(t)=c_{i}(0)\exp(-k\lambda_{i}t)   that remain are those where     Œª  i   =  0       subscript  Œª  i   0    \lambda_{i}=0   , since        lim   t  ‚Üí  ‚àû     exp   (   -   k   Œª  i   t    )     =   {     0    if      Œª  i   >  0       1    if      Œª  i   =  0      }         subscript    normal-‚Üí  t           k   subscript  Œª  i   t         0  if     subscript  Œª  i   0     1  if     subscript  Œª  i   0        \lim_{t\to\infty}\exp(-k\lambda_{i}t)=\left\{\begin{array}[]{rlr}0&\text{if}&%
 \lambda_{i}>0\\
 1&\text{if}&\lambda_{i}=0\end{array}\right\}     In other words, the equilibrium state of the system is determined completely by the kernel of   L   L   L   . Since by definition,      ‚àë  j    L   i  j     =  0        subscript   j    subscript  L    i  j     0    \sum_{j}L_{ij}=0   , the vector    ùêØ  1     superscript  ùêØ  1    \mathbf{v}^{1}   of all ones is in the kernel. Note also that if there are   k   k   k   disjoint connected components in the graph, then this vector of all ones can be split into the sum of   k   k   k   independent    Œª  =  0      Œª  0    \lambda=0   eigenvectors of ones and zeros, where each connected component corresponds to an eigenvector with ones at the elements in the connected component and zeros elsewhere.  The consequence of this is that for a given initial condition    c   (  0  )       c  0    c(0)   for a graph with   N   N   N   vertices        lim   t  ‚Üí  ‚àû     œï   (  t  )     =    ‚ü®   c   (  0  )    ,   ùêØ  ùüè   ‚ü©    ùêØ  ùüè          subscript    normal-‚Üí  t       œï  t         c  0    superscript  ùêØ  1     superscript  ùêØ  1      \lim_{t\to\infty}\phi(t)=\langle c(0),\mathbf{v^{1}}\rangle\mathbf{v^{1}}     where       ùêØ  ùüè   =    1   N     [  1  ,  1  ,  ‚Ä¶  ,  1  ]         superscript  ùêØ  1       1    N     1  1  normal-‚Ä¶  1      \mathbf{v^{1}}=\frac{1}{\sqrt{N}}[1,1,...,1]     For each element    œï  j     subscript  œï  j    \phi_{j}   of   œï   œï   \phi   , i.e. for each vertex   j   j   j   in the graph, it can be rewritten as        lim   t  ‚Üí  ‚àû      œï  j    (  t  )     =    1  N     ‚àë   i  =  1   N     c  i    (  0  )            subscript    normal-‚Üí  t        subscript  œï  j   t        1  N     superscript   subscript     i  1    N      subscript  c  i   0       \lim_{t\to\infty}\phi_{j}(t)=\frac{1}{N}\sum_{i=1}^{N}c_{i}(0)   .  In other words, at steady state, the value of   œï   œï   \phi   converges to the same value at each of the vertices of the graph, which is the average of the initial values at all of the vertices. Since this is the solution to the heat diffusion equation, this makes perfect sense intuitively. We expect that neighboring elements in the graph will exchange energy until that energy is spread out evenly throughout all of the elements that are connected to each other.  Example of the Operator on a Grid  (Figure)  This GIF shows the progression of diffusion, as solved by the graph laplacian technique. A graph is constructed over a grid, where each pixel in the graph is connected to its 8 bordering pixels. Values in the image then diffuse smoothly to their neighbors over time via these connections. This particular image starts off with three strong point values which spill over to their neighbors slowly. The whole system eventually settles out to the same value at equilibrium.   This section shows an example of a function   œï   œï   \phi   diffusing over time through a graph. The graph in this example is constructed on a 2D discrete grid, with points on the grid connected to their eight neighbors. Three initial points are specified to have a positive value, while the rest of the values in the grid are zero. Over time, the exponential decay acts to distribute the values at these points evenly throughout the entire grid.  The complete Matlab source code that was used to generate this animation is provided below. It shows the process of specifying initial conditions, projecting these initial conditions onto the eigenvalues of the Laplacian Matrix, and simulating the exponential decay of these projected initial conditions.  N = 20 ; %The number of pixels along a dimension of the image A = zeros(N, N); %The image Adj = zeros(N*N, N*N); %The adjacency matrix  %Use 8 neighbors, and fill in the adjacency matrix dx = [- 1 , 0 , 1 , - 1 , 1 , - 1 , 0 , 1 ];
 dy = [- 1 , - 1 , - 1 , 0 , 0 , 1 , 1 , 1 ];
 for x = 1 :N
    for y = 1 :N
        index = (x- 1 )*N + y;
        for ne = 1 :length(dx)
            newx = x + dx(ne);
            newy = y + dy(ne);
            if newx > 0 && newx <= N && newy > 0 && newy <= N
                index2 = (newx- 1 )*N + newy;
                Adj(index, index2) = 1 ;
            end
        end
    end
 end %%%BELOW IS THE KEY CODE THAT COMPUTES THE SOLUTION TO THE DIFFERENTIAL  %%%EQUATION Deg = diag(sum(Adj, 2 )); %Compute the degree matrix L = Deg - Adj; %Compute the laplacian matrix in terms of the degree and adjacency matrices [V, D] = eig(L); %Compute the eigenvalues/vectors of the laplacian matrix D = diag(D); %Initial condition (place a few large positive values around and  %make everything else zero) C0 = zeros(N, N);
 C0( 2 : 5 , 2 : 5 ) = 5 ;
 C0( 10 : 15 , 10 : 15 ) = 10 ;
 C0( 2 : 5 , 8 : 13 ) = 7 ;
 C0 = C0(:);
 
 C0V = V'*C0; %Transform the initial condition into the coordinate system  %of the eigenvectors for t = 0 : 0.05 : 5  %Loop through times and decay each initial component Phi = C0V.*exp(-D*t); %Exponential decay for each component Phi = V*Phi; %Transform from eigenvector coordinate system to original coordinate system Phi = reshape(Phi, N, N); %Display the results and write to GIF file imagesc(Phi);
    caxis([ 0 , 10 ]);
    title(sprintf( 'Diffusion t = %3f' , t));
    frame = getframe( 1 );
    im = frame2im(frame);
    [imind, cm] = rgb2ind(im, 256 );
    if t == 0 imwrite(imind, cm, 'out.gif' , 'gif' , 'Loopcount' , inf, 'DelayTime' , 0.1 ); 
    else
       imwrite(imind, cm, 'out.gif' , 'gif' , 'WriteMode' , 'append' , 'DelayTime' , 0.1 );
    end
 end  Approximation to the negative continuous Laplacian  The graph Laplacian matrix can be further viewed as a matrix form of an approximation to the (positive semi-definite) Laplacian operator obtained by the finite difference method . 7 In this interpretation, every graph vertex is treated as a grid point; the local connectivity of the vertex determines the finite difference approximation stencil at this grid point, the grid size is always one for every edge, and there are no constraints on any grid points, which corresponds to the case of the homogeneous Neumann boundary condition , i.e., free boundary.  In Directed Multigraphs  An analogue of the Laplacian matrix can be defined for directed multigraphs. 8 In this case the Laplacian matrix L is defined as      L  =   D  -  A       L    D  A     L=D-A   where D is a diagonal matrix with D i , i equal to the outdegree of vertex i and A is a matix with A i , j equal to the number of edges from i to j (including loops).  See also   Stiffness matrix  Resistance distance   References   T. Sunada, Discrete geometric analysis, Proceedings of Symposia in Pure Mathematics, (ed. by P. Exner, J. P. Keating, P. Kuchment, T. Sunada, A. Teplyaev), 77 (2008), 51-86.  B. Bolloba√°s, Modern Graph Theory , Springer-Verlag (1998, corrected ed. 2013), ISBN 0-387-98488-7, Chapters II.3 (Vector Spaces and Matrices Associated with Graphs), VIII.2 (The Adjacency Matrix and the Laplacian), IX.2 (Electrical Networks and Random Walks).   "  Category:Algebraic graph theory  Category:Matrices     ‚Ü©   "The Deformed Consensus Protocol", F. Morbidi, Automatica, vol. 49, n. 10, pp. 3049-3055, October 2013. ‚Ü©  ‚Ü©  ‚Ü©  ‚Ü©  . ‚Ü©  ‚Ü©    
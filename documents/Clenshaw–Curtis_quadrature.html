<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1277">Clenshaw–Curtis quadrature</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Clenshaw–Curtis quadrature</h1>
<hr/>

<p><strong>Clenshaw–Curtis quadrature</strong> and <strong>Fejér quadrature</strong> are methods for <a href="numerical_integration" title="wikilink">numerical integration</a>, or "quadrature", that are based on an expansion of the <a href="Integrand#Terminology_and_notation" title="wikilink">integrand</a> in terms of <a href="Chebyshev_polynomials" title="wikilink">Chebyshev polynomials</a>. Equivalently, they employ a <a href="change_of_variables" title="wikilink">change of variables</a> 

<math display="inline" id="Clenshaw–Curtis_quadrature:0">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>cos</mi>
    <mi>θ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=\cos\theta
  </annotation>
 </semantics>
</math>

 and use a <a href="discrete_cosine_transform" title="wikilink">discrete cosine transform</a> (DCT) approximation for the <a href="cosine_series" title="wikilink">cosine series</a>. Besides having fast-converging accuracy comparable to <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a> rules, Clenshaw–Curtis quadrature naturally leads to <a href="nested_quadrature_rule" title="wikilink">nested quadrature rules</a> (where different accuracy orders share points), which is important for both <a href="adaptive_quadrature" title="wikilink">adaptive quadrature</a> and multidimensional quadrature (<a class="uri" href="cubature" title="wikilink">cubature</a>).</p>

<p>Briefly, the <a href="function_(mathematics)" title="wikilink">function</a> 

<math display="inline" id="Clenshaw–Curtis_quadrature:1">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 to be integrated is evaluated at the 

<math display="inline" id="Clenshaw–Curtis_quadrature:2">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 extrema or roots of a Chebyshev polynomial and these values are used to construct a polynomial approximation for the function. This polynomial is then integrated exactly. In practice, the integration weights for the value of the function at each node are precomputed, and this computation can be performed in 

<math display="inline" id="Clenshaw–Curtis_quadrature:3">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mi>log</mi>
      <mi>N</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <log></log>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N\log N)
  </annotation>
 </semantics>
</math>

 time by means of <a href="fast_Fourier_transform" title="wikilink">fast Fourier transform</a>-related algorithms for the DCT.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="general-method">General method</h2>

<p>A simple way of understanding the algorithm is to realize that Clenshaw–Curtis quadrature (proposed by those authors in 1960)<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> amounts to integrating via a <a href="change_of_variables" title="wikilink">change of variable</a> <em>x</em> = cos(θ). The algorithm is normally expressed for integration of a function <em>f</em>(<em>x</em>) over the interval [-1,1] (any other interval can be obtained by appropriate rescaling). For this integral, we can write:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>1</mn>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>π</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>π</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-1}^{1}f(x)\,dx=\int_{0}^{\pi}f(\cos\theta)\sin(\theta)\,d\theta.
  </annotation>
 </semantics>
</math>

</p>

<p>That is, we have transformed the problem from integrating 

<math display="inline" id="Clenshaw–Curtis_quadrature:5">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 to one of integrating 

<math display="inline" id="Clenshaw–Curtis_quadrature:6">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mi>sin</mi>
    <mi>θ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
    <apply>
     <sin></sin>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)\sin\theta
  </annotation>
 </semantics>
</math>

. This can be performed if we know the <a href="cosine_series" title="wikilink">cosine series</a> for 

<math display="inline" id="Clenshaw–Curtis_quadrature:7">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>cos</mi>
      <mi>θ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mn>2</mn>
    </mfrac>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>k</mi>
      </msub>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mi>θ</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <cos></cos>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>θ</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)=\frac{a_{0}}{2}+\sum_{k=1}^{\infty}a_{k}\cos(k\theta)
  </annotation>
 </semantics>
</math>

</p>

<p>in which case the integral becomes:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>π</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>a</mi>
         <mrow>
          <mn>2</mn>
          <mi>k</mi>
         </mrow>
        </msub>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>2</mn>
           <mi>k</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>π</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\pi}f(\cos\theta)\sin(\theta)\,d\theta=a_{0}+\sum_{k=1}^{\infty}%
\frac{2a_{2k}}{1-(2k)^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Of course, in order to calculate the cosine series coefficients</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:10">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>2</mn>
     <mi>π</mi>
    </mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>π</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mi>θ</mi>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">2</cn>
      <ci>π</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <ci>π</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <cos></cos>
        <ci>θ</ci>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>θ</ci>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}=\frac{2}{\pi}\int_{0}^{\pi}f(\cos\theta)\cos(k\theta)\,d\theta
  </annotation>
 </semantics>
</math>

 one must again perform a numeric integration, so at first this may not seem to have simplified the problem. Unlike computation of arbitrary integrals, however, Fourier-series integrations for <a href="periodic_functions" title="wikilink">periodic functions</a> (like 

<math display="inline" id="Clenshaw–Curtis_quadrature:11">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)
  </annotation>
 </semantics>
</math>

, by construction), up to the <a href="Nyquist_frequency" title="wikilink">Nyquist frequency</a> 

<math display="inline" id="Clenshaw–Curtis_quadrature:12">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=N
  </annotation>
 </semantics>
</math>

, are accurately computed by the 

<math display="inline" id="Clenshaw–Curtis_quadrature:13">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N+1
  </annotation>
 </semantics>
</math>

 equally spaced and equally weighted points 

<math display="inline" id="Clenshaw–Curtis_quadrature:14">
 <semantics>
  <mrow>
   <msub>
    <mi>θ</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mi>π</mi>
    </mrow>
    <mo>/</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>θ</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>π</ci>
     </apply>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{n}=n\pi/N
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Clenshaw–Curtis_quadrature:15">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <list>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=0,\ldots,N
  </annotation>
 </semantics>
</math>

 (except the endpoints are weighted by 1/2, to avoid double-counting, equivalent to the <a href="trapezoidal_rule" title="wikilink">trapezoidal rule</a> or the <a href="Euler–Maclaurin_formula" title="wikilink">Euler–Maclaurin formula</a>).<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> That is, we approximate the cosine-series integral by the type-I <a href="discrete_cosine_transform" title="wikilink">discrete cosine transform</a> (DCT):</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:16">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>k</mi>
   </msub>
   <mo>≈</mo>
   <mrow>
    <mfrac>
     <mn>2</mn>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mn>2</mn>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mn>2</mn>
       </mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>k</mi>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>n</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mi>N</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </munderover>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>cos</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mrow>
            <mrow>
             <mi>n</mi>
             <mi>π</mi>
            </mrow>
            <mo>/</mo>
            <mi>N</mi>
           </mrow>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mi>n</mi>
            <mi>k</mi>
            <mi>π</mi>
           </mrow>
           <mo>/</mo>
           <mi>N</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">2</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>f</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>f</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <ci>N</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <cos></cos>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>n</ci>
            <ci>π</ci>
           </apply>
           <ci>N</ci>
          </apply>
         </apply>
         <apply>
          <cos></cos>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>n</ci>
            <ci>k</ci>
            <ci>π</ci>
           </apply>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}\approx\frac{2}{N}\left[\frac{f(1)}{2}+\frac{f(-1)}{2}(-1)^{k}+\sum_{n=1}%
^{N-1}f(\cos[n\pi/N])\cos(nk\pi/N)\right]
  </annotation>
 </semantics>
</math>

</p>

<p>for 

<math display="inline" id="Clenshaw–Curtis_quadrature:17">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <list>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=0,\ldots,N
  </annotation>
 </semantics>
</math>

 and then use the formula above for the integral in terms of these 

<math display="inline" id="Clenshaw–Curtis_quadrature:18">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}
  </annotation>
 </semantics>
</math>

. Because only 

<math display="inline" id="Clenshaw–Curtis_quadrature:19">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mn>2</mn>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2k}
  </annotation>
 </semantics>
</math>

 is needed, the formula simplifies further into a type-I DCT of order <em>N</em>/2, assuming <em>N</em> is an <a href="even_number" title="wikilink">even number</a>:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:20">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mn>2</mn>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>≈</mo>
   <mrow>
    <mfrac>
     <mn>2</mn>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>1</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mn>2</mn>
      </mfrac>
      <mo>+</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>k</mi>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>n</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mrow>
          <mi>N</mi>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </munderover>
       <mrow>
        <mrow>
         <mo>{</mo>
         <mrow>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>cos</mi>
             <mrow>
              <mo stretchy="false">[</mo>
              <mrow>
               <mrow>
                <mi>n</mi>
                <mi>π</mi>
               </mrow>
               <mo>/</mo>
               <mi>N</mi>
              </mrow>
              <mo stretchy="false">]</mo>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>cos</mi>
              <mrow>
               <mo stretchy="false">[</mo>
               <mrow>
                <mrow>
                 <mi>n</mi>
                 <mi>π</mi>
                </mrow>
                <mo>/</mo>
                <mi>N</mi>
               </mrow>
               <mo stretchy="false">]</mo>
              </mrow>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>}</mo>
        </mrow>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <mrow>
            <mi>n</mi>
            <mi>k</mi>
            <mi>π</mi>
           </mrow>
           <mrow>
            <mi>N</mi>
            <mo>/</mo>
            <mn>2</mn>
           </mrow>
          </mfrac>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">2</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>f</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <times></times>
          <ci>f</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <cn type="integer">0</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <divide></divide>
           <ci>N</ci>
           <cn type="integer">2</cn>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <set>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <ci>f</ci>
            <apply>
             <cos></cos>
             <apply>
              <divide></divide>
              <apply>
               <times></times>
               <ci>n</ci>
               <ci>π</ci>
              </apply>
              <ci>N</ci>
             </apply>
            </apply>
           </apply>
           <apply>
            <times></times>
            <ci>f</ci>
            <apply>
             <minus></minus>
             <apply>
              <cos></cos>
              <apply>
               <divide></divide>
               <apply>
                <times></times>
                <ci>n</ci>
                <ci>π</ci>
               </apply>
               <ci>N</ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </set>
         <apply>
          <cos></cos>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>n</ci>
            <ci>k</ci>
            <ci>π</ci>
           </apply>
           <apply>
            <divide></divide>
            <ci>N</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2k}\approx\frac{2}{N}\left[\frac{f(1)+f(-1)}{2}+f(0)(-1)^{k}+\sum_{n=1}^{N/%
2-1}\left\{f(\cos[n\pi/N])+f(-\cos[n\pi/N])\right\}\cos\left(\frac{nk\pi}{N/2}%
\right)\right]
  </annotation>
 </semantics>
</math>

</p>

<p>From this formula, it is clear that the Clenshaw–Curtis quadrature rule is symmetric, in that it weights <em>f</em>(<em>x</em>) and <em>f</em>(−<em>x</em>) equally.</p>

<p>Because of <a class="uri" href="aliasing" title="wikilink">aliasing</a>, one only computes the coefficients 

<math display="inline" id="Clenshaw–Curtis_quadrature:21">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mn>2</mn>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2k}
  </annotation>
 </semantics>
</math>

 up to <em>k</em>=<em>N</em>/2, since discrete sampling of the function makes the frequency of 2<em>k</em> indistinguishable from that of <em>N</em>–2<em>k</em>. Equivalently, the 

<math display="inline" id="Clenshaw–Curtis_quadrature:22">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mn>2</mn>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2k}
  </annotation>
 </semantics>
</math>

 are the amplitudes of the unique <a class="uri" href="bandlimited" title="wikilink">bandlimited</a> <a href="trigonometric_interpolation_polynomial" title="wikilink">trigonometric interpolation polynomial</a> passing through the <em>N</em>+1 points where <em>f</em>(cos <em>θ</em>) is evaluated, and we approximate the integral by the integral of this interpolation polynomial. There is some subtlety in how one treats the 

<math display="inline" id="Clenshaw–Curtis_quadrature:23">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{N}
  </annotation>
 </semantics>
</math>

 coefficient in the integral, however—to avoid double-counting with its alias it is included with weight 1/2 in the final approximate integral (as can also be seen by examining the interpolating polynomial):</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>π</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mrow>
         <mi>N</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </munderover>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>a</mi>
         <mrow>
          <mn>2</mn>
          <mi>k</mi>
         </mrow>
        </msub>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>2</mn>
           <mi>k</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mfrac>
      <msub>
       <mi>a</mi>
       <mi>N</mi>
      </msub>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>N</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>π</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>k</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>N</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>N</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\pi}f(\cos\theta)\sin(\theta)\,d\theta\approx a_{0}+\sum_{k=1}^{N/2-%
1}\frac{2a_{2k}}{1-(2k)^{2}}+\frac{a_{N}}{1-N^{2}}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="connection-to-chebyshev-polynomials">Connection to Chebyshev polynomials</h2>

<p>The reason that this is connected to the Chebyshev polynomials 

<math display="inline" id="Clenshaw–Curtis_quadrature:25">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <ci>k</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{k}(x)
  </annotation>
 </semantics>
</math>

 is that, by definition, 

<math display="inline" id="Clenshaw–Curtis_quadrature:26">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>cos</mi>
      <mi>θ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>cos</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>k</mi>
      <mi>θ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <cos></cos>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <cos></cos>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{k}(\cos\theta)=\cos(k\theta)
  </annotation>
 </semantics>
</math>

, and so the cosine series above is really an approximation of 

<math display="inline" id="Clenshaw–Curtis_quadrature:27">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 by Chebyshev polynomials:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <msub>
        <mi>a</mi>
        <mn>0</mn>
       </msub>
       <mn>2</mn>
      </mfrac>
      <msub>
       <mi>T</mi>
       <mn>0</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>a</mi>
        <mi>k</mi>
       </msub>
       <msub>
        <mi>T</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>T</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>T</ci>
        <ci>k</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)=\frac{a_{0}}{2}T_{0}(x)+\sum_{k=1}^{\infty}a_{k}T_{k}(x),
  </annotation>
 </semantics>
</math>

</p>

<p>and thus we are "really" integrating 

<math display="inline" id="Clenshaw–Curtis_quadrature:29">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 by integrating its approximate expansion in terms of Chebyshev polynomials. The evaluation points 

<math display="inline" id="Clenshaw–Curtis_quadrature:30">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>cos</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>n</mi>
       <mi>π</mi>
      </mrow>
      <mo>/</mo>
      <mi>N</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <cos></cos>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>π</ci>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n}=\cos(n\pi/N)
  </annotation>
 </semantics>
</math>

 correspond to the <a class="uri" href="extrema" title="wikilink">extrema</a> of the Chebyshev polynomial 

<math display="inline" id="Clenshaw–Curtis_quadrature:31">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mi>N</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <ci>N</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{N}(x)
  </annotation>
 </semantics>
</math>

.</p>

<p>The fact that such <a href="Chebyshev_approximation" title="wikilink">Chebyshev approximation</a> is just a cosine series under a change of variables is responsible for the rapid convergence of the approximation as more terms 

<math display="inline" id="Clenshaw–Curtis_quadrature:32">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <ci>k</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{k}(x)
  </annotation>
 </semantics>
</math>

 are included. A cosine series converges very rapidly for functions that are <a href="even_and_odd_functions" title="wikilink">even</a>, periodic, and sufficiently smooth. This is true here, since 

<math display="inline" id="Clenshaw–Curtis_quadrature:33">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)
  </annotation>
 </semantics>
</math>

 is even and periodic in 

<math display="inline" id="Clenshaw–Curtis_quadrature:34">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 by construction, and is <em>k</em>-times differentiable everywhere if 

<math display="inline" id="Clenshaw–Curtis_quadrature:35">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 is <em>k</em>-times differentiable on 

<math display="inline" id="Clenshaw–Curtis_quadrature:36">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mn>1</mn>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="closed">
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">1</cn>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [-1,1]
  </annotation>
 </semantics>
</math>

. (In contrast, directly applying a cosine-series expansion to 

<math display="inline" id="Clenshaw–Curtis_quadrature:37">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 instead of 

<math display="inline" id="Clenshaw–Curtis_quadrature:38">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)
  </annotation>
 </semantics>
</math>

 will usually <em>not</em> converge rapidly because the slope of the even-periodic extension would generally be discontinuous.)</p>
<h2 id="fejér-quadrature">Fejér quadrature</h2>

<p><a href="Lipót_Fejér" title="wikilink">Fejér</a> proposed two quadrature rules very similar to Clenshaw–Curtis quadrature, but much earlier (in 1933).<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>Of these two, Fejér's "second" quadrature rule is nearly identical to Clenshaw–Curtis. The only difference is that the endpoints 

<math display="inline" id="Clenshaw–Curtis_quadrature:39">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(-1)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Clenshaw–Curtis_quadrature:40">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(1)
  </annotation>
 </semantics>
</math>

 are set to zero. That is, Fejér only used the <em>interior</em> extrema of the Chebyshev polynomials, i.e. the true stationary points.</p>

<p>Fejér's "first" quadrature rule evaluates the 

<math display="inline" id="Clenshaw–Curtis_quadrature:41">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}
  </annotation>
 </semantics>
</math>

 by evaluating 

<math display="inline" id="Clenshaw–Curtis_quadrature:42">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)
  </annotation>
 </semantics>
</math>

 at a different set of equally spaced points, halfway between the extrema

<math display="block" id="Clenshaw–Curtis_quadrature:43">
 <semantics>
  <mrow>
   <msub>
    <mi>θ</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>0.5</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>π</mi>
    </mrow>
    <mo>/</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>θ</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="float">0.5</cn>
      </apply>
      <ci>π</ci>
     </apply>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{n}=(n+0.5)\pi/N
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Clenshaw–Curtis_quadrature:44">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>n</mi>
   <mo><</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>n</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq n<N
  </annotation>
 </semantics>
</math>

. These are the <em>roots</em> of 

<math display="inline" id="Clenshaw–Curtis_quadrature:45">
 <semantics>
  <mrow>
   <msub>
    <mi>T</mi>
    <mi>N</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <ci>N</ci>
    </apply>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{N}(\cos\theta)
  </annotation>
 </semantics>
</math>

, and are known as the <a href="Chebyshev_nodes" title="wikilink">Chebyshev nodes</a>. (These equally spaced midpoints are the only other choice of quadrature points that preserve both the <a href="even_and_odd_functions" title="wikilink">even symmetry</a> of the cosine transform and the translational symmetry of the periodic Fourier series.) This leads to a formula:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:46">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>k</mi>
   </msub>
   <mo>≈</mo>
   <mrow>
    <mfrac>
     <mn>2</mn>
     <mi>N</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mrow>
       <mi>N</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </munderover>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>n</mi>
             <mo>+</mo>
             <mn>0.5</mn>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi>π</mi>
          </mrow>
          <mo>/</mo>
          <mi>N</mi>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>n</mi>
            <mo>+</mo>
            <mn>0.5</mn>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mi>k</mi>
          <mi>π</mi>
         </mrow>
         <mo>/</mo>
         <mi>N</mi>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">2</cn>
      <ci>N</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <ci>N</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <cos></cos>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <apply>
           <plus></plus>
           <ci>n</ci>
           <cn type="float">0.5</cn>
          </apply>
          <ci>π</ci>
         </apply>
         <ci>N</ci>
        </apply>
       </apply>
       <apply>
        <cos></cos>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <apply>
           <plus></plus>
           <ci>n</ci>
           <cn type="float">0.5</cn>
          </apply>
          <ci>k</ci>
          <ci>π</ci>
         </apply>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{k}\approx\frac{2}{N}\sum_{n=0}^{N-1}f(\cos[(n+0.5)\pi/N])\cos[(n+0.5)k\pi/N]
  </annotation>
 </semantics>
</math>

</p>

<p>which is precisely the type-II DCT. However, Fejér's first quadrature rule is not nested: the evaluation points for 2<em>N</em> do not coincide with any of the evaluation points for <em>N</em>, unlike Clenshaw–Curtis quadrature or Fejér's second rule.</p>

<p>Despite the fact that Fejér discovered these techniques before Clenshaw and Curtis, the name "Clenshaw–Curtis quadrature" has become standard.</p>
<h2 id="comparison-to-gaussian-quadrature">Comparison to Gaussian quadrature</h2>

<p>The classic method of <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a> evaluates the integrand at 

<math display="inline" id="Clenshaw–Curtis_quadrature:47">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N+1
  </annotation>
 </semantics>
</math>

 points and is constructed to <em>exactly</em> integrate polynomials up to <a href="degree_of_a_polynomial" title="wikilink">degree</a> 

<math display="inline" id="Clenshaw–Curtis_quadrature:48">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>N</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>N</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2N+1
  </annotation>
 </semantics>
</math>

. In contrast, Clenshaw–Curtis quadrature, above, evaluates the integrand at 

<math display="inline" id="Clenshaw–Curtis_quadrature:49">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>N</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N+1
  </annotation>
 </semantics>
</math>

 points and exactly integrates polynomials only up to degree 

<math display="inline" id="Clenshaw–Curtis_quadrature:50">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. It may seem, therefore, that Clenshaw–Curtis is intrinsically worse than Gaussian quadrature, but in reality this does not seem to be the case.</p>

<p>In practice, several authors have observed that Clenshaw–Curtis can have accuracy comparable to that of Gaussian quadrature for the same number of points. This is possible because most numeric integrands are not polynomials (especially since polynomials can be integrated analytically), and approximation of many functions in terms of Chebyshev polynomials converges rapidly (see <a href="Chebyshev_approximation" title="wikilink">Chebyshev approximation</a>). In fact, recent theoretical results<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> argue that both Gaussian and Clenshaw–Curtis quadrature have error bounded by 

<math display="inline" id="Clenshaw–Curtis_quadrature:51">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mn>2</mn>
        <mi>N</mi>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
     </msup>
     <mo>/</mo>
     <mi>k</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>N</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O([2N]^{-k}/k)
  </annotation>
 </semantics>
</math>

 for a <em>k</em>-times differentiable integrand.</p>

<p>One often cited advantage of Clenshaw–Curtis quadrature is that the quadrature weights can be evaluated in 

<math display="inline" id="Clenshaw–Curtis_quadrature:52">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>N</mi>
     <mrow>
      <mi>log</mi>
      <mi>N</mi>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <times></times>
     <ci>N</ci>
     <apply>
      <log></log>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N\log N)
  </annotation>
 </semantics>
</math>

 time by <a href="fast_Fourier_transform" title="wikilink">fast Fourier transform</a> algorithms (or their analogues for the DCT), whereas most algorithms for Gaussian quadrature weights required 

<math display="inline" id="Clenshaw–Curtis_quadrature:53">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>N</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>N</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N^{2})
  </annotation>
 </semantics>
</math>

 time to compute. However, recent algorithms have attained 

<math display="inline" id="Clenshaw–Curtis_quadrature:54">
 <semantics>
  <mrow>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>N</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>O</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   O(N)
  </annotation>
 </semantics>
</math>

 complexity for Gauss–Legendre quadrature.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> As a practical matter, high-order numeric integration is rarely performed by simply evaluating a quadrature formula for very large 

<math display="inline" id="Clenshaw–Curtis_quadrature:55">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

. Instead, one usually employs an <a href="adaptive_quadrature" title="wikilink">adaptive quadrature</a> scheme that first evaluates the integral to low order, and then successively refines the accuracy by increasing the number of sample points, possibly only in regions where the integral is inaccurate. To evaluate the accuracy of the quadrature, one compares the answer with that of a quadrature rule of even lower order. Ideally, this lower-order quadrature rule evaluates the integrand at a <em>subset</em> of the original <em>N</em> points, to minimize the integrand evaluations. This is called a <a href="nested_quadrature_rule" title="wikilink">nested quadrature rule</a>, and here Clenshaw–Curtis has the advantage that the rule for order <em>N</em> uses a subset of the points from order 2<em>N</em>. In contrast, Gaussian quadrature rules are not naturally nested, and so one must employ <a href="Gauss–Kronrod_quadrature_formula" title="wikilink">Gauss–Kronrod quadrature formulas</a> or similar methods. Nested rules are also important for <a href="sparse_grid" title="wikilink">sparse grids</a> in multidimensional quadrature, and Clenshaw–Curtis quadrature is a popular method in this context.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h2 id="integration-with-weight-functions">Integration with weight functions</h2>

<p>More generally, one can pose the problem of integrating an arbitrary 

<math display="inline" id="Clenshaw–Curtis_quadrature:56">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 against a fixed <em>weight function</em> 

<math display="inline" id="Clenshaw–Curtis_quadrature:57">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

 that is known ahead of time:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:58">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>1</mn>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>π</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>w</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>π</ci>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <ci>w</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-1}^{1}f(x)w(x)\,dx=\int_{0}^{\pi}f(\cos\theta)w(\cos\theta)\sin(\theta)%
\,d\theta.
  </annotation>
 </semantics>
</math>

</p>

<p>The most common case is 

<math display="inline" id="Clenshaw–Curtis_quadrature:59">
 <semantics>
  <mrow>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)=1
  </annotation>
 </semantics>
</math>

, as above, but in certain applications a different weight function is desirable. The basic reason is that, since 

<math display="inline" id="Clenshaw–Curtis_quadrature:60">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

 can be taken into account <em>a priori</em>, the integration error can be made to depend only on the accuracy in approximating 

<math display="inline" id="Clenshaw–Curtis_quadrature:61">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

, regardless of how badly behaved the weight function might be.</p>

<p>Clenshaw–Curtis quadrature can be generalized to this case as follows. As before, it works by finding the cosine-series expansion of 

<math display="inline" id="Clenshaw–Curtis_quadrature:62">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>cos</mi>
     <mi>θ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <apply>
     <cos></cos>
     <ci>θ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(\cos\theta)
  </annotation>
 </semantics>
</math>

 via a DCT, and then integrating each term in the cosine series. Now, however, these integrals are of the form</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:63">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>W</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi>π</mi>
     </msubsup>
     <mrow>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>cos</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mi>θ</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>sin</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>W</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <ci>π</ci>
     </apply>
     <apply>
      <times></times>
      <ci>w</ci>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>θ</ci>
       </apply>
      </apply>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
      <ci>d</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{k}=\int_{0}^{\pi}w(\cos\theta)\cos(k\theta)\sin(\theta)\,d\theta.
  </annotation>
 </semantics>
</math>

</p>

<p>For most 

<math display="inline" id="Clenshaw–Curtis_quadrature:64">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

, this integral cannot be computed analytically, unlike before. Since the same weight function is generally used for many integrands 

<math display="inline" id="Clenshaw–Curtis_quadrature:65">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

, however, one can afford to compute these 

<math display="inline" id="Clenshaw–Curtis_quadrature:66">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{k}
  </annotation>
 </semantics>
</math>

 numerically to high accuracy beforehand. Moreover, since 

<math display="inline" id="Clenshaw–Curtis_quadrature:67">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

 is generally specified analytically, one can sometimes employ specialized methods to compute 

<math display="inline" id="Clenshaw–Curtis_quadrature:68">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>For example, special methods have been developed to apply Clenshaw–Curtis quadrature to integrands of the form 

<math display="inline" id="Clenshaw–Curtis_quadrature:69">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)w(x)
  </annotation>
 </semantics>
</math>

 with a weight function 

<math display="inline" id="Clenshaw–Curtis_quadrature:70">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

 that is highly oscillatory, e.g. a <a href="Sine_wave" title="wikilink">sinusoid</a> or <a href="Bessel_function" title="wikilink">Bessel function</a> (see, e.g., Evans &amp; Webster, 1999<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a>). This is useful for high-accuracy <a href="Fourier_series" title="wikilink">Fourier series</a> and <a href="Fourier–Bessel_series" title="wikilink">Fourier–Bessel series</a> computation, where simple 

<math display="inline" id="Clenshaw–Curtis_quadrature:71">
 <semantics>
  <mrow>
   <mrow>
    <mi>w</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>w</ci>
     <ci>x</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)=1
  </annotation>
 </semantics>
</math>

 quadrature methods are problematic because of the high accuracy required to resolve the contribution of rapid oscillations. Here, the rapid-oscillation part of the integrand is taken into account via specialized methods for 

<math display="inline" id="Clenshaw–Curtis_quadrature:72">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{k}
  </annotation>
 </semantics>
</math>

, whereas the unknown function 

<math display="inline" id="Clenshaw–Curtis_quadrature:73">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 is usually better behaved.</p>

<p>Another case where weight functions are especially useful is if the integrand is unknown but has a known singularity of some form, e.g. a known discontinuity or integrable divergence (such as 1/√<em>x</em>) at some point. In this case the singularity can be pulled into the weight function 

<math display="inline" id="Clenshaw–Curtis_quadrature:74">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

 and its analytical properties can be used to compute 

<math display="inline" id="Clenshaw–Curtis_quadrature:75">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{k}
  </annotation>
 </semantics>
</math>

 accurately beforehand.</p>

<p>Note that <a href="Gaussian_quadrature" title="wikilink">Gaussian quadrature</a> can also be adapted for various weight functions, but the technique is somewhat different. In Clenshaw–Curtis quadrature, the integrand is always evaluated at the same set of points regardless of 

<math display="inline" id="Clenshaw–Curtis_quadrature:76">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>w</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w(x)
  </annotation>
 </semantics>
</math>

, corresponding to the extrema or roots of a Chebyshev polynomial. In Gaussian quadrature, different weight functions lead to different <a href="orthogonal_polynomials" title="wikilink">orthogonal polynomials</a>, and thus different roots where the integrand is evaluated.</p>
<h2 id="integration-on-infinite-and-semi-infinite-intervals">Integration on infinite and semi-infinite intervals</h2>

<p>It is also possible to use Clenshaw–Curtis quadrature to compute integrals of the form 

<math display="inline" id="Clenshaw–Curtis_quadrature:77">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mn>0</mn>
    <mi mathvariant="normal">∞</mi>
   </msubsup>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <cn type="integer">0</cn>
     </apply>
     <infinity></infinity>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\infty}f(x)dx
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Clenshaw–Curtis_quadrature:78">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mrow>
     <mo>-</mo>
     <mi mathvariant="normal">∞</mi>
    </mrow>
    <mi mathvariant="normal">∞</mi>
   </msubsup>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <apply>
       <minus></minus>
       <infinity></infinity>
      </apply>
     </apply>
     <infinity></infinity>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-\infty}^{\infty}f(x)dx
  </annotation>
 </semantics>
</math>

, using a coordinate-remapping technique.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> High accuracy, even exponential convergence for smooth integrands, can be retained as long as 

<math display="inline" id="Clenshaw–Curtis_quadrature:79">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x)
  </annotation>
 </semantics>
</math>

 decays sufficiently quickly as |<em>x</em>| approaches infinity.</p>

<p>One possibility is to use a generic coordinate transformation such as <em>x</em>=<em>t</em>/(1−<em>t</em><sup>2</sup>)</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:80">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
      <mrow>
       <mo>+</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>t</mi>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <msup>
          <mi>t</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <msup>
         <mi>t</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msup>
           <mi>t</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mfrac>
      <mi>d</mi>
      <mpadded width="+2.8pt">
       <mi>t</mi>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <infinity></infinity>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <divide></divide>
       <ci>t</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>t</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-\infty}^{+\infty}f(x)dx=\int_{-1}^{+1}f\left(\frac{t}{1-t^{2}}\right)%
\frac{1+t^{2}}{(1-t^{2})^{2}}dt\;,
  </annotation>
 </semantics>
</math>

 to transform an infinite or semi-infinite interval into a finite one, as described in <a href="Numerical_integration#Integrals_over_infinite_intervals" title="wikilink">Numerical integration</a>. There are also additional techniques that have been developed specifically for Clenshaw–Curtis quadrature.</p>

<p>For example, one can use the coordinate remapping 

<math display="inline" id="Clenshaw–Curtis_quadrature:81">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <msup>
      <mi>cot</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>θ</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cot></cot>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <ci>θ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=L\cot^{2}(\theta/2)
  </annotation>
 </semantics>
</math>

, where <em>L</em> is a user-specified constant (one could simply use <em>L</em>=1; an optimal choice of <em>L</em> can speed convergence, but is problem-dependent<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a>), to transform the semi-infinite integral into:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:82">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mi>L</mi>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mi>π</mi>
      </msubsup>
      <mrow>
       <mfrac>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mi>L</mi>
           <mrow>
            <msup>
             <mi>cot</mi>
             <mn>2</mn>
            </msup>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <mi>θ</mi>
              <mo>/</mo>
              <mn>2</mn>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
        <msup>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mrow>
            <mi>cos</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>θ</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mfrac>
       <mrow>
        <mi>sin</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>θ</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mi>d</mi>
       <mi>θ</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>L</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <ci>π</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <times></times>
           <ci>L</ci>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <cot></cot>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <divide></divide>
             <ci>θ</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <apply>
            <cos></cos>
            <ci>θ</ci>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <sin></sin>
        <ci>θ</ci>
       </apply>
       <ci>d</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\infty}f(x)dx=2L\int_{0}^{\pi}\frac{f[L\cot^{2}(\theta/2)]}{[1-\cos(%
\theta)]^{2}}\sin(\theta)d\theta.
  </annotation>
 </semantics>
</math>

</p>

<p>The factor multiplying sin(θ), <em>f</em>(...)/(...)<sup>2</sup>, can then be expanded in a cosine series (approximately, using the discrete cosine transform) and integrated term-by-term, exactly as was done for <em>f</em>(cos θ) above. To eliminate the singularity at θ=0 in this integrand, one merely requires that <em>f</em>(<em>x</em>) go to zero sufficiently fast as <em>x</em> approaches infinity, and in particular <em>f</em>(<em>x</em>) must decay at least as fast as 1/<em>x</em><sup>3/2</sup>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>For a doubly infinite interval of integration, one can use the coordinate remapping 

<math display="inline" id="Clenshaw–Curtis_quadrature:83">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mi>cot</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <cot></cot>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=L\cot(\theta)
  </annotation>
 </semantics>
</math>

 (where <em>L</em> is a user-specified constant as above) to transform the integral into:<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:84">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>L</mi>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mi>π</mi>
      </msubsup>
      <mrow>
       <mfrac>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mi>L</mi>
           <mrow>
            <mi>cot</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>θ</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
        <mrow>
         <msup>
          <mi>sin</mi>
          <mn>2</mn>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>θ</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mfrac>
       <mi>d</mi>
       <mi>θ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>L</mi>
       <mi>π</mi>
      </mrow>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mi>N</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </munderover>
      <mfrac>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mi>L</mi>
          <mrow>
           <mi>cot</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mrow>
              <mi>n</mi>
              <mi>π</mi>
             </mrow>
             <mo>/</mo>
             <mi>N</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mrow>
        <msup>
         <mi>sin</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>n</mi>
           <mi>π</mi>
          </mrow>
          <mo>/</mo>
          <mi>N</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>L</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <ci>π</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>f</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <times></times>
            <ci>L</ci>
            <apply>
             <cot></cot>
             <ci>θ</ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <ci>θ</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>θ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>L</ci>
        <ci>π</ci>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>N</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <times></times>
           <ci>L</ci>
           <apply>
            <cot></cot>
            <apply>
             <divide></divide>
             <apply>
              <times></times>
              <ci>n</ci>
              <ci>π</ci>
             </apply>
             <ci>N</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <sin></sin>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>π</ci>
          </apply>
          <ci>N</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-\infty}^{\infty}f(x)dx=L\int_{0}^{\pi}\frac{f[L\cot(\theta)]}{\sin^{2}(%
\theta)}d\theta\approx\frac{L\pi}{N}\sum_{n=1}^{N-1}\frac{f[L\cot(n\pi/N)]}{%
\sin^{2}(n\pi/N)}.
  </annotation>
 </semantics>
</math>

</p>

<p>In this case, we have used the fact that the remapped integrand <em>f</em>(<em>L</em> cotθ)/sin<sup>2</sup>(θ) is already periodic and so can be directly integrated with high (even exponential) accuracy using the trapezoidal rule (assuming <em>f</em> is sufficiently smooth and rapidly decaying); there is no need to compute the cosine series as an intermediate step. Note that the quadrature rule does not include the endpoints, where we have assumed that the integrand goes to zero. The formula above requires that <em>f</em>(<em>x</em>) decay faster than 1/<em>x</em><sup>2</sup> as <em>x</em> goes to ±∞. (If <em>f</em> decays exactly as 1/<em>x</em><sup>2</sup>, then the integrand goes to a finite value at the endpoints and these limits must be included as endpoint terms in the trapezoidal rule.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a>). However, if <em>f</em> decays only polynomially quickly, then it may be necessary to use a further step of Clenshaw–Curtis quadrature to obtain exponential accuracy of the remapped integral instead of the trapezoidal rule, depending on more details of the limiting properties of <em>f</em>: the problem is that, although <em>f</em>(<em>L</em> cotθ)/sin<sup>2</sup>(θ) is indeed periodic with period π, it is not necessarily smooth at the endpoints if all the derivatives do not vanish there [e.g. the function <em>f</em>(<em>x</em>) = tanh(<em>x</em><sup>3</sup>)/<em>x</em><sup>3</sup> decays as 1/<em>x</em><sup>3</sup> but has a jump discontinuity in the slope of the remapped function at θ=0 and π].</p>

<p>Another coordinate-remapping approach was suggested for integrals of the form 

<math display="inline" id="Clenshaw–Curtis_quadrature:85">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mn>0</mn>
    <mi mathvariant="normal">∞</mi>
   </msubsup>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mi>x</mi>
     </mrow>
    </msup>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>d</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <cn type="integer">0</cn>
     </apply>
     <infinity></infinity>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>g</ci>
     <ci>x</ci>
     <ci>d</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\infty}e^{-x}g(x)dx
  </annotation>
 </semantics>
</math>

, in which case one can use the transformation 

<math display="inline" id="Clenshaw–Curtis_quadrature:86">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>ln</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mrow>
          <mi>cos</mi>
          <mi>θ</mi>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <minus></minus>
     <apply>
      <ln></ln>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <cos></cos>
         <ci>θ</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=-\ln[(1+\cos\theta)/2]
  </annotation>
 </semantics>
</math>

 to transform the integral into the form 

<math display="inline" id="Clenshaw–Curtis_quadrature:87">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∫</mo>
    <mn>0</mn>
    <mi>π</mi>
   </msubsup>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>cos</mi>
      <mi>θ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>sin</mi>
     <mrow>
      <mpadded width="+1.7pt">
       <mi>θ</mi>
      </mpadded>
      <mi>d</mi>
      <mi>θ</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <cn type="integer">0</cn>
     </apply>
     <ci>π</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <cos></cos>
      <ci>θ</ci>
     </apply>
     <apply>
      <sin></sin>
      <apply>
       <times></times>
       <ci>θ</ci>
       <ci>d</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{\pi}f(\cos\theta)\sin\theta\,d\theta
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Clenshaw–Curtis_quadrature:88">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>ln</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mi>u</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>u</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <minus></minus>
       <apply>
        <ln></ln>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <ci>u</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(u)=g(-\ln[(1+u)/2])/2
  </annotation>
 </semantics>
</math>

, at which point one can proceed identically to Clenshaw–Curtis quadrature for <em>f</em> as above.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> Because of the endpoint singularities in this coordinate remapping, however, one uses Fejér's first quadrature rule [which does not evaluate <em>f</em>(−1)] unless <em>g</em>(∞) is finite.</p>
<h2 id="precomputing-the-quadrature-weights">Precomputing the quadrature weights</h2>

<p>In practice, it is inconvenient to perform a DCT of the sampled function values <em>f</em>(cosθ) for each new integrand. Instead, one normally precomputes quadrature weights 

<math display="inline" id="Clenshaw–Curtis_quadrature:89">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{n}
  </annotation>
 </semantics>
</math>

 (for <em>n</em> from 0 to <em>N</em>/2, assuming that <em>N</em> is even) so that</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:90">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>1</mn>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mrow>
       <mi>N</mi>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </munderover>
     <mrow>
      <msub>
       <mi>w</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo>{</mo>
       <mrow>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>cos</mi>
           <mrow>
            <mo stretchy="false">[</mo>
            <mrow>
             <mrow>
              <mi>n</mi>
              <mi>π</mi>
             </mrow>
             <mo>/</mo>
             <mi>N</mi>
            </mrow>
            <mo stretchy="false">]</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>f</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>cos</mi>
            <mrow>
             <mo stretchy="false">[</mo>
             <mrow>
              <mrow>
               <mi>n</mi>
               <mi>π</mi>
              </mrow>
              <mo>/</mo>
              <mi>N</mi>
             </mrow>
             <mo stretchy="false">]</mo>
            </mrow>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>}</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>N</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <ci>n</ci>
      </apply>
      <set>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <cos></cos>
          <apply>
           <divide></divide>
           <apply>
            <times></times>
            <ci>n</ci>
            <ci>π</ci>
           </apply>
           <ci>N</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>f</ci>
         <apply>
          <minus></minus>
          <apply>
           <cos></cos>
           <apply>
            <divide></divide>
            <apply>
             <times></times>
             <ci>n</ci>
             <ci>π</ci>
            </apply>
            <ci>N</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </set>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-1}^{1}f(x)\,dx\approx\sum_{n=0}^{N/2}w_{n}\left\{f(\cos[n\pi/N])+f(-%
\cos[n\pi/N])\right\}.
  </annotation>
 </semantics>
</math>

</p>

<p>These weights 

<math display="inline" id="Clenshaw–Curtis_quadrature:91">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{n}
  </annotation>
 </semantics>
</math>

 are also computed by a DCT, as is easily seen by expressing the computation in terms of <a href="matrix_(mathematics)" title="wikilink">matrix</a> <a href="linear_algebra" title="wikilink">algebra</a>. In particular, we computed the cosine series coefficients 

<math display="inline" id="Clenshaw–Curtis_quadrature:92">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mn>2</mn>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2k}
  </annotation>
 </semantics>
</math>

 via an expression of the form:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:93">
 <semantics>
  <mrow>
   <mrow>
    <mi>c</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>0</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>2</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mn>4</mn>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>a</mi>
         <mi>N</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mn>0</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mn>2</mn>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi mathvariant="normal">⋮</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>y</mi>
          <mrow>
           <mi>N</mi>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>D</mi>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>c</ci>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">0</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">2</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <cn type="integer">4</cn>
       </apply>
      </matrixrow>
      <matrixrow>
       <ci>normal-⋮</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>N</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>D</ci>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">2</cn>
        </apply>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <apply>
          <divide></divide>
          <ci>N</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>D</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=\begin{pmatrix}a_{0}\\
a_{2}\\
a_{4}\\
\vdots\\
a_{N}\end{pmatrix}=D\begin{pmatrix}y_{0}\\
y_{1}\\
y_{2}\\
\vdots\\
y_{N/2}\end{pmatrix}=Dy,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>D</em> is the matrix form of the (<em>N</em>/2+1)-point <a href="Discrete_cosine_transform#DCT-I" title="wikilink">type-I DCT</a> from above, with entries (for <a href="Zero-based_numbering" title="wikilink">zero-based</a> indices):</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:94">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mrow>
     <mi>k</mi>
     <mi>n</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>2</mn>
      <mi>N</mi>
     </mfrac>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>n</mi>
         <mi>k</mi>
         <mi>π</mi>
        </mrow>
        <mrow>
         <mi>N</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>×</mo>
    <mrow>
     <mo>{</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="left">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mtd>
       <mtd columnalign="left">
        <mrow>
         <mi>n</mi>
         <mo>=</mo>
         <mrow>
          <mn>0</mn>
          <mo>,</mo>
          <mrow>
           <mi>N</mi>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="left">
        <mn>1</mn>
       </mtd>
       <mtd columnalign="left">
        <mi>otherwise</mi>
       </mtd>
      </mtr>
     </mtable>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">2</cn>
       <ci>N</ci>
      </apply>
      <apply>
       <cos></cos>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>k</ci>
         <ci>π</ci>
        </apply>
        <apply>
         <divide></divide>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">cases</csymbol>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <eq></eq>
       <ci>n</ci>
       <list>
        <cn type="integer">0</cn>
        <apply>
         <divide></divide>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </list>
      </apply>
      <cn type="integer">1</cn>
      <ci>otherwise</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{kn}=\frac{2}{N}\cos\left(\frac{nk\pi}{N/2}\right)\times\begin{cases}1/2&n=0%
,N/2\\
1&\mathrm{otherwise}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>and 

<math display="inline" id="Clenshaw–Curtis_quadrature:95">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n}
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:96">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>cos</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mrow>
          <mrow>
           <mi>n</mi>
           <mi>π</mi>
          </mrow>
          <mo>/</mo>
          <mi>N</mi>
         </mrow>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mrow>
            <mi>n</mi>
            <mi>π</mi>
           </mrow>
           <mo>/</mo>
           <mi>N</mi>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <cos></cos>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>π</ci>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <minus></minus>
       <apply>
        <cos></cos>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>π</ci>
         </apply>
         <ci>N</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{n}=f(\cos[n\pi/N])+f(-\cos[n\pi/N]).\!
  </annotation>
 </semantics>
</math>

</p>

<p>As discussed above, because of <a class="uri" href="aliasing" title="wikilink">aliasing</a>, there is no point in computing coefficients beyond 

<math display="inline" id="Clenshaw–Curtis_quadrature:97">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>N</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{N}
  </annotation>
 </semantics>
</math>

, so <em>D</em> is an 

<math display="inline" id="Clenshaw–Curtis_quadrature:98">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>N</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>×</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>N</mi>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <ci>N</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (N/2+1)\times(N/2+1)
  </annotation>
 </semantics>
</math>

 matrix. In terms of these coefficients <em>c</em>, the integral is approximately:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:99">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mn>1</mn>
     </msubsup>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <msub>
      <mi>a</mi>
      <mn>0</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mrow>
         <mi>N</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </munderover>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>a</mi>
         <mrow>
          <mn>2</mn>
          <mi>k</mi>
         </mrow>
        </msub>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>2</mn>
           <mi>k</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mfrac>
      <msub>
       <mi>a</mi>
       <mi>N</mi>
      </msub>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>N</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>d</mi>
      <mi>T</mi>
     </msup>
     <mi>c</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <ci>N</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>k</ci>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>N</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>T</ci>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-1}^{1}f(x)\,dx\approx a_{0}+\sum_{k=1}^{N/2-1}\frac{2a_{2k}}{1-(2k)^{2}%
}+\frac{a_{N}}{1-N^{2}}=d^{T}c,
  </annotation>
 </semantics>
</math>

</p>

<p>from above, where <em>c</em> is the vector of coefficients 

<math display="inline" id="Clenshaw–Curtis_quadrature:100">
 <semantics>
  <msub>
   <mi>a</mi>
   <mrow>
    <mn>2</mn>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{2k}
  </annotation>
 </semantics>
</math>

 above and <em>d</em> is the vector of integrals for each Fourier coefficient:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:101">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mo>=</mo>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>2</mn>
         <mo>/</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mn>4</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>2</mn>
         <mo>/</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mn>16</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>2</mn>
         <mo>/</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <msup>
            <mrow>
             <mo stretchy="false">[</mo>
             <mrow>
              <mi>N</mi>
              <mo>-</mo>
              <mn>2</mn>
             </mrow>
             <mo stretchy="false">]</mo>
            </mrow>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <msup>
            <mi>N</mi>
            <mn>2</mn>
           </msup>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">1</cn>
     </matrixrow>
     <matrixrow>
      <apply>
       <divide></divide>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <cn type="integer">4</cn>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <divide></divide>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <cn type="integer">16</cn>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <ci>normal-⋮</ci>
     </matrixrow>
     <matrixrow>
      <apply>
       <divide></divide>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <minus></minus>
           <ci>N</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>N</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=\begin{pmatrix}1\\
2/(1-4)\\
2/(1-16)\\
\vdots\\
2/(1-[N-2]^{2})\\
1/(1-N^{2})\end{pmatrix}.
  </annotation>
 </semantics>
</math>

</p>

<p>(Note, however, that these weight factors are altered if one changes the DCT matrix <em>D</em> to use a different normalization convention. For example, it is common to define the type-I DCT with additional factors of 2 or √2 factors in the first and last rows or columns, which leads to corresponding alterations in the <em>d</em> entries.) The 

<math display="inline" id="Clenshaw–Curtis_quadrature:102">
 <semantics>
  <mrow>
   <msup>
    <mi>d</mi>
    <mi>T</mi>
   </msup>
   <mi>c</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>d</ci>
     <ci>T</ci>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d^{T}c
  </annotation>
 </semantics>
</math>

 summation can be re-arranged to:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:103">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mn>1</mn>
    </msubsup>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <msup>
     <mi>d</mi>
     <mi>T</mi>
    </msup>
    <mi>c</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>d</mi>
     <mi>T</mi>
    </msup>
    <mi>D</mi>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>D</mi>
        <mi>T</mi>
       </msup>
       <mi>d</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>T</mi>
    </msup>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>w</mi>
     <mi>T</mi>
    </msup>
    <mi>y</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>T</ci>
      </apply>
      <ci>c</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <ci>T</ci>
      </apply>
      <ci>D</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>D</ci>
         <ci>T</ci>
        </apply>
        <ci>d</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <ci>T</ci>
      </apply>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{-1}^{1}f(x)\,dx\approx d^{T}c=d^{T}Dy=(D^{T}d)^{T}y=w^{T}y
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>w</em> is the vector of the desired weights 

<math display="inline" id="Clenshaw–Curtis_quadrature:104">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{n}
  </annotation>
 </semantics>
</math>

 above, with:</p>

<p>

<math display="block" id="Clenshaw–Curtis_quadrature:105">
 <semantics>
  <mrow>
   <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>D</mi>
      <mi>T</mi>
     </msup>
     <mi>d</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>w</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>D</ci>
      <ci>T</ci>
     </apply>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w=D^{T}d.\!
  </annotation>
 </semantics>
</math>

</p>

<p>Since the <a href="transpose" title="wikilink">transposed</a> matrix 

<math display="inline" id="Clenshaw–Curtis_quadrature:106">
 <semantics>
  <msup>
   <mi>D</mi>
   <mi>T</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>D</ci>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D^{T}
  </annotation>
 </semantics>
</math>

 is also a DCT (e.g., the transpose of a type-I DCT is a type-I DCT, possibly with a slightly different normalization depending on the conventions that are employed), the quadrature weights <em>w</em> can be precomputed in <em>O</em>(<em>N</em> log <em>N</em>) time for a given <em>N</em> using fast DCT algorithms.</p>

<p>The weights 

<math display="inline" id="Clenshaw–Curtis_quadrature:107">
 <semantics>
  <msub>
   <mi>w</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>w</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w_{n}
  </annotation>
 </semantics>
</math>

 are positive and their sum is equal to one.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Euler–Maclaurin_formula" title="wikilink">Euler–Maclaurin formula</a></li>
<li><a href="Gauss–Kronrod_quadrature_formula" title="wikilink">Gauss–Kronrod quadrature formula</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Numerical_integration_(quadrature)" title="wikilink">Category:Numerical integration (quadrature)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">W. Morven Gentleman, "Implementing Clenshaw-Curtis quadrature I: Methodology and experience," <em>Communications of the ACM</em> <strong>15</strong>(5), p. 337-342 (1972).<a href="#fnref1">↩</a></li>
<li id="fn2">Jörg Waldvogel, "<a href="http://www.sam.math.ethz.ch/~waldvoge/Papers/fejer.html">Fast construction of the Fejér and Clenshaw-Curtis quadrature rules</a>," <em>BIT Numerical Mathematics</em> <strong>46</strong> (1), p. 195-202 (2006).<a href="#fnref2">↩</a></li>
<li id="fn3">C. W. Clenshaw and A. R. Curtis "<a href="http://www.digizeitschriften.de/resolveppn/GDZPPN001163442">A method for numerical integration on an automatic computer</a> <em>Numerische Mathematik</em> <strong>2</strong>, 197 (1960).<a href="#fnref3">↩</a></li>
<li id="fn4">J. P. Boyd, <em>Chebychev and Fourier Spectral Methods</em>, 2nd ed. (Dover, New York, 2001).<a href="#fnref4">↩</a></li>
<li id="fn5">See, for example, S. G. Johnson, "<a href="http://math.mit.edu/~stevenj/trapezoidal.pdf">Notes on the convergence of trapezoidal-rule quadrature</a>," online MIT course notes (2008).<a href="#fnref5">↩</a></li>
<li id="fn6">Leopold Fejér, "<a href="http://projecteuclid.org/euclid.bams/1183496842">On the infinite sequences arising in the theories of harmonic analysis, of interpolation, and of mechanical quadratures</a>", <em>Bulletin of the American Mathematical Society</em> <strong>39</strong> (1933), pp. 521–534. Leopold Fejér, "<a href="http://www.digizeitschriften.de/resolveppn/GDZPPN002374498">Mechanische Quadraturen mit positiven Cotesschen Zahlen</a>, <em>Mathematische Zeitschrift</em> <strong>37</strong> , 287 (1933).<a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8">Ignace Bogaert, <em>Iteration-Free Computation of Gauss--Legendre Quadrature Nodes and Weights,</em> SIAM Journal on Scientific Computing vol. <strong>36</strong>, pp. A1008–A1026 (2014)<a href="#fnref8">↩</a></li>
<li id="fn9">Erich Novak and Klaus Ritter, "High dimensional integration of smooth functions over cubes," <em>Numerische Mathematik</em> vol. <strong>75</strong>, pp. 79–97 (1996).<a href="#fnref9">↩</a></li>
<li id="fn10">G. A. Evans and J. R. Webster, "A comparison of some methods for the evaluation of highly oscillatory integrals," <em>Journal of Computational and Applied Mathematics</em>, vol. <strong>112</strong>, p. 55-69 (1999).<a href="#fnref10">↩</a></li>
<li id="fn11">John P. Boyd, "Exponentially convergent Fourier–Chebshev [<em>sic</em>] quadrature schemes on bounded and infinite intervals," <em>J. Scientific Computing</em> <strong>2</strong> (2), p. 99-109 (1987).<a href="#fnref11">↩</a></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"></li>
<li id="fn15"></li>
<li id="fn16">Nirmal Kumar Basu and Madhav Chandra Kundu, "Some methods of numerical integration over a semi-infinite interval," <em>Applications of Mathematics</em> <strong>22</strong> (4), p. 237-243 (1977).<a href="#fnref16">↩</a></li>
<li id="fn17">J. P. Imhof, "On the Method for Numerical Integration of Clenshaw and Curtis", <em>Numerische Mathematik</em> <strong>5</strong>, p. 138-141 (1963).<a href="#fnref17">↩</a></li>
</ol>
</section>
</body>
</html>

   Vitali covering lemma      Vitali covering lemma   In mathematics , the Vitali covering lemma is a combinatorial and geometric result commonly used in measure theory of Euclidean spaces . This lemma is an intermediate step, of independent interest, in the proof of the Vitali covering theorem . The covering theorem is credited to the Italian mathematician Giuseppe Vitali . The theorem states that it is possible to cover, up to a Lebesgue-negligible set , a given subset E of R d by a disjoint family extracted from a Vitali covering of E .  Vitali covering lemma  (Figure)  On the top: a collection of balls; the green balls are on the disjoint subcollection. On the bottom: the subcollection with three times the radius covers all the balls.   Statement of the lemma   Finite version: Let     B  1   ,  …  ,   B  n       subscript  B  1   normal-…   subscript  B  n     B_{1},\ldots,B_{n}   be any finite collection of balls contained in d- dimensional  Euclidean space  R d (or, more generally, in an arbitrary metric space ). Then there exists a subcollection     B   j  1    ,   B   j  2    ,  …  ,   B   j  m        subscript  B   subscript  j  1     subscript  B   subscript  j  2    normal-…   subscript  B   subscript  j  m      B_{j_{1}},B_{j_{2}},\dots,B_{j_{m}}   of these balls which are disjoint and satisfy           B  1   ∪   B  2   ∪  …  ∪   B  n    ⊆    3   B   j  1     ∪   3   B   j  2     ∪  …  ∪   3   B   j  m             subscript  B  1    subscript  B  2   normal-…   subscript  B  n        3   subscript  B   subscript  j  1       3   subscript  B   subscript  j  2     normal-…    3   subscript  B   subscript  j  m        B_{1}\cup B_{2}\cup\ldots\cup B_{n}\subseteq 3B_{j_{1}}\cup 3B_{j_{2}}\cup%
 \ldots\cup 3B_{j_{m}}         where    3   B   j  k        3   subscript  B   subscript  j  k      3B_{j_{k}}   denotes the ball with the same center as    B   j  k      subscript  B   subscript  j  k     B_{j_{k}}   but with three times the radius.    Infinite version: Let    {   B  j   :   j  ∈  J   }     conditional-set   subscript  B  j     j  J     \{B_{j}:j\in J\}   be an arbitrary collection of balls in R d (or, more generally, in a metric space) such that          sup   {   rad   (   B  j   )    :   j  ∈  J   }    <  ∞       supremum   conditional-set    rad   subscript  B  j      j  J        \sup\,\{\mathrm{rad}(B_{j}):j\in J\}<\infty         where    rad   (   B  j   )       rad   subscript  B  j     \mathrm{rad}(B_{j})   denotes the radius of the ball B j . Then there exists a countable subcollection           {   B  j   :   j  ∈   J  ′    }   ,   J  ′    ⊂  J        conditional-set   subscript  B  j     j   superscript  J  normal-′      superscript  J  normal-′    J    \{B_{j}:j\in J^{\prime}\},\quad J^{\prime}\subset J         of balls from the original collection which are disjoint and satisfy            ⋃   j  ∈  J     B  j    ⊆    ⋃   j  ∈   J  ′       5    B  j      .        subscript     j  J     subscript  B  j      subscript     j   superscript  J  normal-′       5   subscript  B  j       \bigcup_{j\in J}B_{j}\subseteq\bigcup_{j\in J^{\prime}}5\,B_{j}.        Comments .   The balls can have the form B = { y : d ( y , c )  0.  In the infinite version , the collection of balls can be countable or uncountable .    The result may fail if the radii are not bounded: consider the family of all balls centered at 0 in R d ; any disjoint subfamily consists of only one ball B , and 5 B does not contain all the balls in this family.   Proof  Finite version  With no loss of generality, we assume that the collection of balls is not empty; that is, n > 0. Let    B   j  1      subscript  B   subscript  j  1     B_{j_{1}}   be the ball of largest radius. Inductively, assume that     B   j  1    ,  …  ,   B   j  k        subscript  B   subscript  j  1    normal-…   subscript  B   subscript  j  k      B_{j_{1}},\dots,B_{j_{k}}   have been chosen. If there is some ball in     B  1   ,  …  ,   B  n       subscript  B  1   normal-…   subscript  B  n     B_{1},\dots,B_{n}   that is disjoint from     B   j  1    ∪   B   j  2    ∪  ⋯  ∪   B   j  k         subscript  B   subscript  j  1     subscript  B   subscript  j  2    normal-⋯   subscript  B   subscript  j  k      B_{j_{1}}\cup B_{j_{2}}\cup\cdots\cup B_{j_{k}}   , let    B   j   k  +  1       subscript  B   subscript  j    k  1      B_{j_{k+1}}   be such ball with maximal radius (breaking ties arbitrarily), otherwise, we set m := k and terminate the inductive definition.  Now set    X  :=    ⋃   k  =  1   m     3    B   j  k         assign  X    superscript   subscript     k  1    m     3   subscript  B   subscript  j  k        X:=\bigcup_{k=1}^{m}3\,B_{j_{k}}   . It remains to show that     B  i   ⊂  X       subscript  B  i   X    B_{i}\subset X   for every    i  =   1  ,  2  ,  …  ,  n       i   1  2  normal-…  n     i=1,2,\dots,n   . This is clear if    i  ∈   {   j  1   ,  …  ,   j  m   }       i    subscript  j  1   normal-…   subscript  j  m      i\in\{j_{1},\dots,j_{m}\}   . Otherwise, there necessarily is some    k  ∈   {  1  ,  …  ,  m  }       k   1  normal-…  m     k\in\{1,\dots,m\}   such that B i intersects    B   j  k      subscript  B   subscript  j  k     B_{j_{k}}   and the radius of    B   j  k      subscript  B   subscript  j  k     B_{j_{k}}   is at least as large as that of B i . The triangle inequality then easily implies that     B  i   ⊂    3    B   j  k     ⊂  X         subscript  B  i     3   subscript  B   subscript  j  k          X     B_{i}\subset 3\,B_{j_{k}}\subset X   , as needed. This completes the proof of the finite version.  Infinite version  Let F denote the collection of all balls B j , j ∈ J , that are given in the statement of the covering lemma . The following result provides a certain disjoint subcollection G of F . If this subcollection G is described as    {     B  j   ,  j   ∈   J  ′    }         subscript  B  j   j    superscript  J  normal-′      \{B_{j},j\in J^{\prime}\}   , the property of G , stated below, readily proves that           ⋃   j  ∈  J     B  j    ⊆    ⋃   j  ∈   J  ′       5    B  j      .        subscript     j  J     subscript  B  j      subscript     j   superscript  J  normal-′       5   subscript  B  j       \bigcup_{j\in J}B_{j}\subseteq\bigcup_{j\in J^{\prime}}5\,B_{j}.        Precise form of the covering lemma.  Let  F  be a collection of (nondegenerate) balls in a metric space, with bounded radii. There exists a disjoint subcollection  G  of  F  with the following property:    every ball B in  F  intersects a ball C in  G  such that B ⊂ 5 C.      ( Degenerate balls only contain the center; they are excluded from this discussion.) Let R be the supremum of the radii of balls in F . Consider the partition of F into subcollections F n , n ≥ 0, consisting of balls B whose radius is in (2 − n −1 R , 2 − n R ]. A sequence G n , with G n ⊂ F n , is defined inductively as follows. First, set H 0 = F 0 and let G 0 be a maximal disjoint subcollection of H 0 . Assuming that G 0 ,..., G n have been selected, let        𝐇   n  +  1    =   {   B  ∈   𝐅   n  +  1     :     B  ∩  C   =  ∅   ,    ∀  C   ∈    𝐆  0   ∪   𝐆  1   ∪  …  ∪   𝐆  n      }    ,       subscript  𝐇    n  1     conditional-set    B   subscript  𝐅    n  1      formulae-sequence      B  C        for-all  C      subscript  𝐆  0    subscript  𝐆  1   normal-…   subscript  𝐆  n         \mathbf{H}_{n+1}=\{B\in\mathbf{F}_{n+1}:\ B\cap C=\emptyset,\ \ \forall C\in%
 \mathbf{G}_{0}\cup\mathbf{G}_{1}\cup\ldots\cup\mathbf{G}_{n}\},   and let G n +1 be a maximal disjoint subcollection of H n +1 . The subcollection        𝐆  :=    ⋃   n  =  0   ∞    𝐆  n       assign  𝐆    superscript   subscript     n  0       subscript  𝐆  n      \mathbf{G}:=\bigcup_{n=0}^{\infty}\mathbf{G}_{n}        of F satisfies the requirements: G is a disjoint collection, and every ball B ∈ F intersects a ball C ∈ G such that B ⊂ 5 C . Indeed, let n be such that B belongs to F n . Either B does not belong to H n , which implies n > 0 and means that B intersects a ball from the union of G 0 ,..., G n −1 , or B ∈ H n and by maximality of G n , B intersects a ball in G n . In any case, B intersects a ball C that belongs to the union of G 0 ,..., G n . Such a ball C has radius > 2 − n −1 R . Since the radius of B is ≤ 2 − n R , it is less than twice that of C and the conclusion B ⊂ 5 C follows from the triangle inequality as in the finite version. — Proof based on  —  Remarks   The constant 5 is not optimal. If the scale c − n , c > 1, is used instead of 2 − n for defining F n , the final value is 1 + 2 c instead of 5. Any constant larger than 3 gives a correct statement of the lemma, but not 3.  In the most general case of an arbitrary metric space, the selection of a maximal disjoint subcollection requires a form of Zorn's lemma .  Using a finer analysis, when the original collection F is a Vitali covering of a subset E of R d , one shows that the subcollection G , defined in the above proof, covers E up to a Lebesgue-negligible set (see below, " From the covering lemma to the covering theorem " ).   Applications and method of use  An application of the Vitali lemma is in proving the Hardy–Littlewood maximal inequality . As in this proof, the Vitali lemma is frequently used when we are, for instance, considering the d -dimensional Lebesgue measure ,    λ  d     subscript  λ  d    \lambda_{d}   , of a set  E ⊂ R d , which we know is contained in the union of a certain collection of balls    {   B  j   :   j  ∈  J   }     conditional-set   subscript  B  j     j  J     \{B_{j}:j\in J\}   , each of which has a measure we can more easily compute, or has a special property one would like to exploit. Hence, if we compute the measure of this union, we will have an upper bound on the measure of E . However, it is difficult to compute the measure of the union of all these balls if they overlap. By the Vitali lemma, we may choose a subcollection    {   B  j   :   j  ∈   J  ′    }     conditional-set   subscript  B  j     j   superscript  J  normal-′      \{B_{j}:j\in J^{\prime}\}   which is disjoint and such that      ⋃   j  ∈   J  ′      5   B  j     ⊃    ⋃   j  ∈  J     B  j    ⊃  E       superset-of    subscript     j   superscript  J  normal-′       5   subscript  B  j       subscript     j  J     subscript  B  j      superset-of    E     \bigcup_{j\in J^{\prime}}5B_{j}\supset\bigcup_{j\in J}B_{j}\supset E   . Therefore,         λ  d    (  E  )    ≤    λ  d    (    ⋃   j  ∈  J     B  j    )    ≤    λ  d    (    ⋃   j  ∈   J  ′      5   B  j     )    ≤    ∑   j  ∈   J  ′       λ  d    (   5   B  j    )      .           subscript  λ  d   E      subscript  λ  d     subscript     j  J     subscript  B  j             subscript  λ  d     subscript     j   superscript  J  normal-′       5   subscript  B  j             subscript     j   superscript  J  normal-′        subscript  λ  d     5   subscript  B  j         \lambda_{d}(E)\leq\lambda_{d}\Bigl(\bigcup_{j\in J}B_{j}\Bigr)\leq\lambda_{d}%
 \Bigl(\bigcup_{j\in J^{\prime}}5B_{j}\Bigr)\leq\sum_{j\in J^{\prime}}\lambda_{%
 d}(5B_{j}).     Now, since increasing the radius of a d -dimensional ball by a factor of five increases its volume by a factor of 5 d , we know that        ∑   j  ∈   J  ′       λ  d    (   5   B  j    )     =    5  d     ∑   j  ∈   J  ′       λ  d    (   B  j   )            subscript     j   superscript  J  normal-′        subscript  λ  d     5   subscript  B  j         superscript  5  d     subscript     j   superscript  J  normal-′        subscript  λ  d    subscript  B  j        \sum_{j\in J^{\prime}}\lambda_{d}(5B_{j})=5^{d}\sum_{j\in J^{\prime}}\lambda_{%
 d}(B_{j})     and thus         λ  d    (  E  )    ≤    5  d     ∑   j  ∈   J  ′       λ  d    (   B  j   )       .         subscript  λ  d   E      superscript  5  d     subscript     j   superscript  J  normal-′        subscript  λ  d    subscript  B  j        \lambda_{d}(E)\leq 5^{d}\sum_{j\in J^{\prime}}\lambda_{d}(B_{j}).     Vitali covering theorem  In the covering theorem, the aim is to cover, up to a "negligible set", a given set E ⊆ R d by a disjoint subcollection extracted from a Vitali covering for E : a Vitali class or Vitali covering    𝒱   𝒱   \mathcal{V}   for E is a collection of sets such that, for every x ∈ E and δ > 0, there is a set U in the collection   𝒱   𝒱   \mathcal{V}   such that x ∈ U and the diameter of U is non-zero and less than δ . In the classical setting of Vitali, the negligible set is a Lebesgue negligible set , but measures other than the Lebesgue measure, and spaces other than R d have also been considered, see below.  The following observation is useful: if   𝒱   𝒱   \mathcal{V}   is a Vitali covering for E and if E is contained in an open set Ω ⊆ R d , then the subcollection of sets U in   𝒱   𝒱   \mathcal{V}   that are contained in Ω is also a Vitali covering for E .  Vitali's covering theorem for the Lebesgue measure  The next covering theorem for the Lebesgue measure λ d is due to . A collection   𝒱   𝒱   \mathcal{V}   of measurable subsets of R d is a regular family (in the sense of Lebesgue ) if there exists a constant C such that       diam    (  V  )   d    ≤    C    λ  d    (  V  )          diam   superscript  V  d      C   subscript  λ  d   V     \mathrm{diam}(V)^{d}\leq C\,\lambda_{d}(V)   for every set V in the collection   𝒱   𝒱   \mathcal{V}   . The family of cubes is an example of regular family   𝒱   𝒱   \mathcal{V}   , as is the family   𝒱   𝒱   \mathcal{V}   ( m ) of rectangles in R 2 such that the ratio of sides stays between m −1 and m , for some fixed m ≥ 1. If an arbitrary norm is given on R d , the family of balls for the metric associated to the norm is another example. To the contrary, the family of all rectangles in R 2 is not regular.  Theorem. Let E ⊆ R d be a measurable set with finite Lebesgue measure, and let   𝒱   𝒱   \mathcal{V}   be a regular family of closed subsets of R d that is a Vitali covering for E . Then there exists a finite or countably infinite disjoint subcollection     {   U  j   }   ⊆  𝒱        subscript  U  j    𝒱    \{U_{j}\}\subseteq\mathcal{V}   such that        λ  d    (   E  ∖    ⋃  j    U  j     )    =  0.         subscript  λ  d     E    subscript   j    subscript  U  j      0.    \lambda_{d}\Bigl(E\setminus\bigcup_{j}U_{j}\Bigr)=0.     The original result of  is a special case of this theorem, in which d = 1 and   𝒱   𝒱   \mathcal{V}   is a collection of intervals that is a Vitali covering for a measurable subset E of the real line having finite measure. The theorem above remains true without assuming that E has finite measure. This is obtained by applying the covering result in the finite measure case, for every integer n ≥ 0, to the portion of E contained in the open annulus Ω n of points x such that n  d , a Euclidean ball B ( a , r a ) with center a and positive radius r a is assigned. Then, as in the Vitali theorem, a subcollection of these balls is selected in order to cover A in a specific way. The main differences with the Vitali covering theorem are that on one hand, the disjointness requirement of Vitali is relaxed to the fact that the number N x of the selected balls containing an arbitrary point x ∈ R d is bounded by a constant B d depending only upon the dimension d ; on the other hand, the selected balls do cover the set A of all the given centers (for Vitali, a negligible error was allowed).  Vitali's covering theorem for the Hausdorff measure  One may have a similar objective when considering Hausdorff measure instead of Lebesgue measure. The theorem below  applies in that case.  Theorem. Let H s denote s -dimensional Hausdorff measure, let E ⊆ R d be an H s - measurable set and   𝒱   𝒱   \mathcal{V}   a Vitali class of closed sets for E . Then there exists a (finite or countably infinite) disjoint subcollection     {   U  j   }   ⊆  𝒱        subscript  U  j    𝒱    \{U_{j}\}\subseteq\mathcal{V}   such that either         H  s    (   E  \    ⋃  j    U  j     )    =    0   or    ∑  j    diam    (   U  j   )   s      =  ∞   .           superscript  H  s    normal-\  E    subscript   j    subscript  U  j        0  or    subscript   j     diam   superscript   subscript  U  j   s               H^{s}\left(E\backslash\bigcup_{j}U_{j}\right)=0\ \mbox{ or }\sum_{j}\mathrm{%
 diam}(U_{j})^{s}=\infty.     Furthermore, if E has finite s -dimensional Hausdorff measure, then for any ε > 0, we may choose this subcollection { U j } such that         H  s    (  E  )    ≤     ∑  j    diam    (   U  j   )   s     +  ε    .         superscript  H  s   E       subscript   j     diam   superscript   subscript  U  j   s     ε     H^{s}(E)\leq\sum_{j}\mathrm{diam}(U_{j})^{s}+\varepsilon.     This theorem implies the result of Lebesgue given above. Indeed, when s = d , the Hausdorff measure H s on R d coincides with a multiple of the d -dimensional Lebesgue measure. If a disjoint collection    {   U  j   }      subscript  U  j     \{U_{j}\}   is regular and contained in a measurable region B with finite Lebesgue measure, then        ∑  j    diam    (   U  j   )   d     ≤   C    ∑  j     λ  d    (   U  j   )      ≤    C    λ  d    (  B  )    <   +  ∞           subscript   j     diam   superscript   subscript  U  j   d       C    subscript   j      subscript  λ  d    subscript  U  j             C   subscript  λ  d   B               \sum_{j}\mathrm{diam}(U_{j})^{d}\leq C\sum_{j}\lambda_{d}(U_{j})\leq C\,%
 \lambda_{d}(B)<+\infty     which excludes the second possibility in the first assertion of the previous theorem. It follows that E is covered, up to a Lebesgue-negligible set, by the selected disjoint subcollection.  From the covering lemma to the covering theorem  The covering lemma can be used as intermediate step in the proof of the following basic form of the Vitali covering theorem. Actually, a little more is needed, namely the precised form of the covering lemma obtained in the "proof of the infinite version" .   Theorem.  For every subset E of  R d  and every Vitali cover of E by a collection  F  of closed balls, there exists a disjoint subcollection  G  which covers E up to a Lebesgue-negligible set.    Without loss of generality, one can assume that all balls in F are nondegenerate and have radius ≤ 1. By the precised form of the covering lemma , there exists a disjoint subcollection G of F such that every ball B ∈ F intersects a ball C ∈ G for which B ⊂ 5 C . Let r > 0 be given, and let Z denote the set of points z ∈ E that are not contained in any ball from G and belong to the open ball B ( r ) of radius r , centered at 0. It is enough to show that Z is Lebesgue-negligible, for every given r .  Let G denote the subcollection of those balls in G that meet B ( r ). Consider the partition of G into sets G n , n ≥ 0, consisting of balls that have radius in (2 −n−1 , 2 −n ]. Any ball B in F that meets B ( r ) is contained in B ( r +2). It follows from the disjointness property of G that        ∑   {    λ  d    (  C  )    :   C  ∈  G   }    =    ∑   n  =  0   ∞    (   ∑   {    λ  d    (  C  )    :   C  ∈   G  n    }    )    ≤    λ  d    (   B   (   r  +  2   )    )    <   +  ∞    .           conditional-set     subscript  λ  d   C     C  G       superscript   subscript     n  0         conditional-set     subscript  λ  d   C     C   subscript  G  n               subscript  λ  d     B    r  2                 \sum\{\lambda_{d}(C):C\in G\}=\sum_{n=0}^{\infty}\Bigl(\sum\{\lambda_{d}(C):C%
 \in G_{n}\}\Bigr)\leq\lambda_{d}(B(r+2))<+\infty.     This implies that G n is a finite set for every n . Given ε > 0, we may select N such that        ∑   {    λ  d    (  C  )    :    C  ∈   G  n    ,   n  >  N    }    <  ε   .         conditional-set     subscript  λ  d   C    formulae-sequence    C   subscript  G  n      n  N      ε    \sum\{\lambda_{d}(C):C\in G_{n},\,n>N\}<\varepsilon.     Let z ∈ Z be fixed. By definition of Z , this point z does not belong to the closed set K equal to the (finite) union of balls in G k , k ≤ N . By the Vitali cover property, one can find a ball B ∈ F containing z , contained in B ( r ) and disjoint from K . By the property of G , the ball B meets C and is included in 5 C for some ball C ∈ G . One sees that C ∈ G because C intersects B ( r ), but C does not belong to any family G k , k ≤ N , since B meets C but is disjoint from K . This proves that every point z ∈ Z is contained in the union of 5 C , when C varies in G n , n > N , hence      Z  ⊂   U  N   :=   ⋃   {    5   C   :    C  ∈   G  n    ,   n  >  N    }          Z   subscript  U  N     assign       conditional-set    5  C    formulae-sequence    C   subscript  G  n      n  N         Z\subset U_{N}:=\bigcup\,\{5\,C:C\in G_{n},\,n>N\}     and         λ  d    (   U  N   )    ≤   ∑   {    λ  d    (    5   C   )    :    C  ∈   G  n    ,   n  >  N    }    =    5  d    ∑   {    λ  d    (  C  )    :    C  ∈   G  n    ,   n  >  N    }     <    5  d   ε    .           subscript  λ  d    subscript  U  N       conditional-set     subscript  λ  d     5  C     formulae-sequence    C   subscript  G  n      n  N              superscript  5  d      conditional-set     subscript  λ  d   C    formulae-sequence    C   subscript  G  n      n  N               superscript  5  d   ε      \lambda_{d}(U_{N})\leq\sum\{\lambda_{d}(5\,C):C\in G_{n},\,n>N\}=5^{d}\sum\{%
 \lambda_{d}(C):C\in G_{n},\,n>N\}<5^{d}\varepsilon.     Since ε > 0 is arbitrary, this shows that Z is negligible.  Proof based on , with some notation from .  Infinite-dimensional spaces  The Vitali covering theorem is not valid in infinite-dimensional settings. The first result in this direction was given by David Preiss in 1979: there exists a Gaussian measure  γ on an (infinite-dimensional) separable  Hilbert space  H so that the Vitali covering theorem fails for ( H , Borel( H ), γ ). This result was strengthened in 2003 by Jaroslav Tišer: the Vitali covering theorem in fact fails for every infinite-dimensional Gaussian measure on any (infinite-dimensional) separable Hilbert space.  See also   Besicovitch covering theorem   References                , (in Italian ). The paper containing the first proof of Vitali covering theorem .   "  Category:Covering lemmas  Category:Measure theory  Category:Real analysis   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1226">Total least squares</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Total least squares</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>
<figure><b>(Figure)</b>
<figcaption>200xp| The bivariate (Deming regression) case of Total Least Squares. The red lines show the error in both <em>x</em> and <em>y</em>. This is different from the traditional least squares method which measures error parallel to the <em>y</em> axis. The case shown, with deviations measured perpendicularly, arises when <em>x</em> and <em>y</em> have equal variances.</figcaption>
</figure>

<p><strong>Total least squares</strong> also known as (in a special case) <strong>orthogonal regression</strong>, is a type of <a href="errors-in-variables_regression" title="wikilink">errors-in-variables regression</a>, a <a href="least_squares" title="wikilink">least squares</a> data modeling technique in which observational errors on both dependent and independent variables are taken into account. It is a generalization of <a href="Deming_regression" title="wikilink">Deming regression</a>, and can be applied to both linear and non-linear models.</p>

<p>The total least squares approximation of the data is generically equivalent to the best, in the <a href="Frobenius_norm" title="wikilink">Frobenius norm</a>, <a href="low-rank_approximation" title="wikilink">low-rank approximation</a> of the data matrix.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="linear-model">Linear model</h2>
<h3 id="background">Background</h3>

<p>In the <a href="least_squares" title="wikilink">least squares</a> method of data modeling, the <a href="objective_function" title="wikilink">objective function</a>, <em>S</em>,</p>

<p>

<math display="block" id="Total_least_squares:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐫</mi>
      <mi>𝐓</mi>
     </msup>
     <mi>𝐖𝐫</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐫</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐖𝐫</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\mathbf{r^{T}Wr},
  </annotation>
 </semantics>
</math>

 is minimized, where <em>r</em> is the vector of <a href="errors_and_residuals_in_statistics" title="wikilink">residuals</a> and <em>W</em> is a weighting matrix. In <a href="linear_least_squares_(mathematics)" title="wikilink">linear least squares</a> the model contains equations which are linear in the parameters appearing in the parameter vector 

<math display="inline" id="Total_least_squares:1">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

, so the residuals are given by</p>

<p>

<math display="block" id="Total_least_squares:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐫</mi>
    <mo>=</mo>
    <mrow>
     <mi>𝐲</mi>
     <mo>-</mo>
     <mrow>
      <mi>𝐗</mi>
      <mi>𝜷</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐫</ci>
    <apply>
     <minus></minus>
     <ci>𝐲</ci>
     <apply>
      <times></times>
      <ci>𝐗</ci>
      <ci>𝜷</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r=y-X\boldsymbol{\beta}}.
  </annotation>
 </semantics>
</math>

 There are <em>m</em> observations in <strong>y</strong> and <em>n</em> parameters in <strong>β</strong> with <em>m</em>&gt;<em>n</em>. <strong>X</strong> is a <em>m</em>×<em>n</em> matrix whose elements are either constants or functions of the independent variables, <strong>x</strong>. The weight matrix <strong>W</strong> is, ideally, the inverse of the <a href="variance-covariance_matrix" title="wikilink">variance-covariance matrix</a> 

<math display="inline" id="Total_least_squares:3">
 <semantics>
  <msub>
   <mi>𝐌</mi>
   <mi>y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐌</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{y}
  </annotation>
 </semantics>
</math>

 of the observations <strong>y</strong>. The independent variables are assumed to be error-free. The parameter estimates are found by setting the gradient equations to zero, which results in the normal equations <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Total_least_squares:4">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐖𝐗</mi>
    <mi>𝜷</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐖𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐖𝐗</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐖𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X^{T}WX\boldsymbol{\beta}=X^{T}Wy}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="allowing-observation-errors-in-all-variables">Allowing observation errors in all variables</h3>

<p>Now, suppose that both <strong>x</strong> and <strong>y</strong> are observed subject to error, with variance-covariance matrices 

<math display="inline" id="Total_least_squares:5">
 <semantics>
  <msub>
   <mi>𝐌</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐌</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{x}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Total_least_squares:6">
 <semantics>
  <msub>
   <mi>𝐌</mi>
   <mi>y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐌</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{y}
  </annotation>
 </semantics>
</math>

 respectively. In this case the objective function can be written as</p>

<p>

<math display="block" id="Total_least_squares:7">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>𝐫</mi>
      <mi>𝐱</mi>
      <mi>𝐓</mi>
     </msubsup>
     <msubsup>
      <mi>𝐌</mi>
      <mi>𝐱</mi>
      <mrow>
       <mo>-</mo>
       <mn>𝟏</mn>
      </mrow>
     </msubsup>
     <msub>
      <mi>𝐫</mi>
      <mi>𝐱</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mi>𝐫</mi>
      <mi>𝐲</mi>
      <mi>𝐓</mi>
     </msubsup>
     <msubsup>
      <mi>𝐌</mi>
      <mi>𝐲</mi>
      <mrow>
       <mo>-</mo>
       <mn>𝟏</mn>
      </mrow>
     </msubsup>
     <msub>
      <mi>𝐫</mi>
      <mi>𝐲</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐫</ci>
        <ci>𝐱</ci>
       </apply>
       <ci>𝐓</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <ci>𝐱</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐫</ci>
       <ci>𝐱</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐫</ci>
        <ci>𝐲</ci>
       </apply>
       <ci>𝐓</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <ci>𝐲</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐫</ci>
       <ci>𝐲</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\mathbf{r_{x}^{T}M_{x}^{-1}r_{x}+r_{y}^{T}M_{y}^{-1}r_{y}}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Total_least_squares:8">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>𝐫</mi>
    <mi>x</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐫</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r}_{x}\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Total_least_squares:9">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>𝐫</mi>
    <mi>y</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐫</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{r}_{y}\,
  </annotation>
 </semantics>
</math>


 are the residuals in <strong>x</strong> and <strong>y</strong> respectively. Clearly these residuals cannot be independent of each other, but they must be constrained by some kind of relationship. Writing the model function as 

<math display="inline" id="Total_least_squares:10">
 <semantics>
  <mrow>
   <mi>𝐟</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>𝐫</mi>
     <mi>𝐱</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>𝐫</mi>
     <mi>𝐲</mi>
    </msub>
    <mo>,</mo>
    <mi>𝜷</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝐟</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐫</ci>
      <ci>𝐱</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐫</ci>
      <ci>𝐲</ci>
     </apply>
     <ci>𝜷</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{f(r_{x},r_{y},\boldsymbol{\beta})}
  </annotation>
 </semantics>
</math>

, the constraints are expressed by <em>m</em> <a href="condition_equations" title="wikilink">condition equations</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Total_least_squares:11">
 <semantics>
  <mrow>
   <mi>𝐅</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>𝚫</mi>
     <mi>𝐲</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>𝐟</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>𝐫</mi>
        <mi>𝐱</mi>
       </msub>
      </mrow>
     </mfrac>
     <msub>
      <mi>𝐫</mi>
      <mi>𝐱</mi>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>𝐟</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>𝐫</mi>
        <mi>𝐲</mi>
       </msub>
      </mrow>
     </mfrac>
     <msub>
      <mi>𝐫</mi>
      <mi>𝐲</mi>
     </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>𝐗</mi>
     <mi>𝚫</mi>
     <mi>𝜷</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>𝟎</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>𝐅</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>𝚫</ci>
       <ci>𝐲</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝐟</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐫</ci>
          <ci>𝐱</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐫</ci>
        <ci>𝐱</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝐟</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐫</ci>
          <ci>𝐲</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐫</ci>
        <ci>𝐲</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>𝐗</ci>
       <ci>𝚫</ci>
       <ci>𝜷</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F=\Delta y-\frac{\partial f}{\partial r_{x}}r_{x}-\frac{\partial f}{%
\partial r_{y}}r_{y}-X\Delta\boldsymbol{\beta}=0}
  </annotation>
 </semantics>
</math>

 Thus, the problem is to minimize the objective function subject to the <em>m</em> constraints. It is solved by the use of <a href="Lagrange_multipliers" title="wikilink">Lagrange multipliers</a>. After some algebraic manipulations,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> the result is obtained.</p>

<p>

<math display="block" id="Total_least_squares:12">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <msup>
     <mi>𝐌</mi>
     <mrow>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
    </msup>
    <mi>𝐗</mi>
    <mi>𝚫</mi>
    <mi>𝜷</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <msup>
     <mi>𝐌</mi>
     <mrow>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
    </msup>
    <mi>𝚫</mi>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐌</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>𝐗</ci>
     <ci>𝚫</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐌</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>𝚫</ci>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X^{T}M^{-1}X\Delta\boldsymbol{\beta}=X^{T}M^{-1}\Delta y}
  </annotation>
 </semantics>
</math>

, or alternatively 

<math display="inline" id="Total_least_squares:13">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <msup>
     <mi>𝐌</mi>
     <mrow>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
    </msup>
    <mi>𝐗</mi>
    <mi>𝜷</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <msup>
     <mi>𝐌</mi>
     <mrow>
      <mo>-</mo>
      <mn>𝟏</mn>
     </mrow>
    </msup>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐌</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>𝐗</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐌</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X^{T}M^{-1}X\boldsymbol{\beta}=X^{T}M^{-1}y}
  </annotation>
 </semantics>
</math>

 Where <strong>M</strong> is the variance-covariance matrix relative to both independent and dependent variables.</p>

<p>

<math display="block" id="Total_least_squares:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐌</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>𝐊</mi>
       <mi>𝐱</mi>
      </msub>
      <msub>
       <mi>𝐌</mi>
       <mi>𝐱</mi>
      </msub>
      <msubsup>
       <mi>𝐊</mi>
       <mi>𝐱</mi>
       <mi>𝐓</mi>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>𝐊</mi>
       <mi>𝐲</mi>
      </msub>
      <msub>
       <mi>𝐌</mi>
       <mi>𝐲</mi>
      </msub>
      <msubsup>
       <mi>𝐊</mi>
       <mi>𝐲</mi>
       <mi>𝐓</mi>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">;</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>𝐊</mi>
      <mi>𝐱</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>𝐟</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>𝐫</mi>
         <mi>𝐱</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo rspace="7.5pt">,</mo>
    <mrow>
     <msub>
      <mi>𝐊</mi>
      <mi>𝐲</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>𝐟</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>𝐫</mi>
         <mi>𝐲</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <ci>𝐌</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐊</ci>
        <ci>𝐱</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <ci>𝐱</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐊</ci>
         <ci>𝐱</ci>
        </apply>
        <ci>𝐓</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐊</ci>
        <ci>𝐲</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <ci>𝐲</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐊</ci>
         <ci>𝐲</ci>
        </apply>
        <ci>𝐓</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐊</ci>
       <ci>𝐱</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝐟</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐫</ci>
          <ci>𝐱</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐊</ci>
       <ci>𝐲</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>𝐟</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐫</ci>
          <ci>𝐲</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M=K_{x}M_{x}K_{x}^{T}+K_{y}M_{y}K_{y}^{T};\ K_{x}=-\frac{\partial f}{%
\partial r_{x}},\ K_{y}=-\frac{\partial f}{\partial r_{y}}}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="example">Example</h3>

<p>In practice these equations are easy to use. When the data errors are uncorrelated, all matrices <strong>M</strong> and <strong>W</strong> are diagonal. Then, take the example of straight line fitting.</p>

<p>

<math display="block" id="Total_least_squares:15">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <mi>β</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mo>+</mo>
    <mrow>
     <mi>β</mi>
     <mpadded width="-1.7pt">
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <ci>β</ci>
     </interval>
    </apply>
    <apply>
     <plus></plus>
     <ci>α</ci>
     <apply>
      <times></times>
      <ci>β</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x_{i},\beta)=\alpha+\beta x_{i}\!
  </annotation>
 </semantics>
</math>

 It is easy to show that, in this case</p>

<p>

<math display="block" id="Total_least_squares:16">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mrow>
     <mi>i</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mrow>
      <mi>y</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>β</mi>
      <mn>2</mn>
     </msup>
     <msubsup>
      <mi>σ</mi>
      <mrow>
       <mi>x</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <list>
       <ci>y</ci>
       <ci>i</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <list>
        <ci>x</ci>
        <ci>i</ci>
       </list>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{ii}=\sigma^{2}_{y,i}+\beta^{2}\sigma^{2}_{x,i}
  </annotation>
 </semantics>
</math>

 showing how the variance at the <em>i</em>th point is determined by the variances of both independent and dependent variables and by the model being used to fit the data. The expression may be generalized by noting that the parameter 

<math display="inline" id="Total_least_squares:17">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

 is the slope of the line.</p>

<p>

<math display="block" id="Total_least_squares:18">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mrow>
     <mi>i</mi>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mrow>
      <mi>y</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>y</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>x</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>i</mi>
      <mn>2</mn>
     </msubsup>
     <msubsup>
      <mi>σ</mi>
      <mrow>
       <mi>x</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>σ</ci>
       <cn type="integer">2</cn>
      </apply>
      <list>
       <ci>y</ci>
       <ci>i</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>y</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <list>
        <ci>x</ci>
        <ci>i</ci>
       </list>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{ii}=\sigma^{2}_{y,i}+\left(\frac{dy}{dx}\right)^{2}_{i}\sigma^{2}_{x,i}
  </annotation>
 </semantics>
</math>

</p>

<p>An expression of this type is used in fitting <a href="Determination_of_equilibrium_constants#Parameter_errors_and_correlation" title="wikilink">pH titration data</a> where a small error on <em>x</em> translates to a large error on y when the slope is large.</p>
<h3 id="algebraic-point-of-view">Algebraic point of view</h3>

<p>First of all it is necessary to note that the TLS problem does not have a solution in general, which was already shown in 1980.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> The following considers the simple case where a unique solution exists without making any particular assumptions.</p>

<p>The computation of the TLS using <a href="singular_value_decomposition" title="wikilink">singular value decomposition</a> is described in standard texts.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> We can solve the equation</p>

<p>

<math display="block" id="Total_least_squares:19">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mi>B</mi>
   </mrow>
   <mo>≈</mo>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>B</ci>
    </apply>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   XB\approx Y
  </annotation>
 </semantics>
</math>

 for <em>B</em> where <em>X</em> is <em>m</em>-by-<em>n</em> and <em>Y</em> is <em>m</em>-by-<em>k</em>. <a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>That is, we seek to find <em>B</em> that minimizes error matrices <em>E</em> and <em>F</em> for <em>X</em> and <em>Y</em> respectively. That is,</p>

<p>

<math display="block" id="Total_least_squares:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>argmin</mi>
      <mrow>
       <mi>E</mi>
       <mo>,</mo>
       <mi>F</mi>
      </mrow>
     </msub>
     <msub>
      <mrow>
       <mo>∥</mo>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mpadded width="+2.8pt">
          <mi>E</mi>
         </mpadded>
         <mi>F</mi>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <mo>∥</mo>
      </mrow>
      <mi>F</mi>
     </msub>
    </mrow>
    <mo rspace="22.5pt">,</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mo>+</mo>
       <mi>E</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>B</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>Y</mi>
    <mo>+</mo>
    <mi>F</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>argmin</ci>
       <list>
        <ci>E</ci>
        <ci>F</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <times></times>
          <ci>E</ci>
          <ci>F</ci>
         </apply>
        </apply>
       </apply>
       <ci>F</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>X</ci>
       <ci>E</ci>
      </apply>
      <ci>B</ci>
     </apply>
    </list>
    <apply>
     <plus></plus>
     <ci>Y</ci>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{argmin}_{E,F}\|[E\;F]\|_{F},\qquad(X+E)B=Y+F
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Total_least_squares:21">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>E</mi>
    </mpadded>
    <mi>F</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [E\;F]
  </annotation>
 </semantics>
</math>

 is the <a href="augmented_matrix" title="wikilink">augmented matrix</a> with <em>E</em> and <em>F</em> side by side and 

<math display="inline" id="Total_least_squares:22">
 <semantics>
  <mrow>
   <mo>∥</mo>
   <mo>⋅</mo>
   <msub>
    <mo>∥</mo>
    <mi>F</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="latexml">parallel-to</csymbol>
    <ci>normal-⋅</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <csymbol cd="latexml">parallel-to</csymbol>
     <ci>F</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|\cdot\|_{F}
  </annotation>
 </semantics>
</math>

 is the <a href="Frobenius_norm" title="wikilink">Frobenius norm</a>, the square root of the sum of the squares of all entries in a matrix and so equivalently the square root of the sum of squares of the lengths of the rows or columns of the matrix.</p>

<p>This can be rewritten as</p>

<p>

<math display="block" id="Total_least_squares:23">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>X</mi>
        <mo>+</mo>
        <mi>E</mi>
       </mrow>
       <mo rspace="5.3pt" stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>Y</mi>
        <mo>+</mo>
        <mi>F</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>B</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <msub>
          <mi>I</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <ci>X</ci>
        <ci>E</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>Y</ci>
        <ci>F</ci>
       </apply>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <ci>B</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [(X+E)\;(Y+F)]\begin{bmatrix}B\\
-I_{k}\end{bmatrix}=0
  </annotation>
 </semantics>
</math>

. where 

<math display="inline" id="Total_least_squares:24">
 <semantics>
  <msub>
   <mi>I</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>I</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{k}
  </annotation>
 </semantics>
</math>


 is the 

<math display="inline" id="Total_least_squares:25">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>×</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>k</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\times k
  </annotation>
 </semantics>
</math>

 identity matrix. The goal is then to find 

<math display="inline" id="Total_least_squares:26">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>E</mi>
    </mpadded>
    <mi>F</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <times></times>
     <ci>E</ci>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [E\;F]
  </annotation>
 </semantics>
</math>

 that reduces the rank of 

<math display="inline" id="Total_least_squares:27">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>X</mi>
    </mpadded>
    <mi>Y</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [X\;Y]
  </annotation>
 </semantics>
</math>

 by <em>k</em>. Define 

<math display="inline" id="Total_least_squares:28">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>U</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi mathvariant="normal">Σ</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>V</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>*</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">U</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">Σ</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">V</csymbol>
     <ci>normal-]</ci>
    </cerror>
    <times></times>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [U][\Sigma][V]*
  </annotation>
 </semantics>
</math>

 to be the singular value decomposition of the augmented matrix 

<math display="inline" id="Total_least_squares:29">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mrow>
    <mpadded width="+2.8pt">
     <mi>X</mi>
    </mpadded>
    <mi>Y</mi>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [X\;Y]
  </annotation>
 </semantics>
</math>


.</p>

<p>

<math display="block" id="Total_least_squares:30">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <mi>X</mi>
     </mpadded>
     <mi>Y</mi>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mpadded width="+2.8pt">
       <msub>
        <mi>U</mi>
        <mi>X</mi>
       </msub>
      </mpadded>
      <msub>
       <mi>U</mi>
       <mi>Y</mi>
      </msub>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mi>X</mi>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mi>Y</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>X</mi>
           <mi>X</mi>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>X</mi>
           <mi>Y</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>Y</mi>
           <mi>X</mi>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>Y</mi>
           <mi>Y</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mo>*</mo>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mpadded width="+2.8pt">
       <msub>
        <mi>U</mi>
        <mi>X</mi>
       </msub>
      </mpadded>
      <msub>
       <mi>U</mi>
       <mi>Y</mi>
      </msub>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mi>X</mi>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mi>Y</mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msubsup>
         <mi>V</mi>
         <mrow>
          <mi>X</mi>
          <mi>X</mi>
         </mrow>
         <mo>*</mo>
        </msubsup>
       </mtd>
       <mtd columnalign="center">
        <msubsup>
         <mi>V</mi>
         <mrow>
          <mi>Y</mi>
          <mi>X</mi>
         </mrow>
         <mo>*</mo>
        </msubsup>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msubsup>
         <mi>V</mi>
         <mrow>
          <mi>X</mi>
          <mi>Y</mi>
         </mrow>
         <mo>*</mo>
        </msubsup>
       </mtd>
       <mtd columnalign="center">
        <msubsup>
         <mi>V</mi>
         <mrow>
          <mi>Y</mi>
          <mi>Y</mi>
         </mrow>
         <mo>*</mo>
        </msubsup>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <ci>X</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <ci>X</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <ci>Y</ci>
        </apply>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <ci>X</ci>
        </apply>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <ci>Y</ci>
        </apply>
       </matrixrow>
      </matrix>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <matrix>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>X</ci>
           <ci>X</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>X</ci>
           <ci>Y</ci>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>Y</ci>
           <ci>X</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>Y</ci>
           <ci>Y</ci>
          </apply>
         </apply>
        </matrixrow>
       </matrix>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <ci>X</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <ci>Y</ci>
        </apply>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <ci>X</ci>
        </apply>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <ci>Y</ci>
        </apply>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>X</ci>
           <ci>X</ci>
          </apply>
         </apply>
         <times></times>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>Y</ci>
           <ci>X</ci>
          </apply>
         </apply>
         <times></times>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>X</ci>
           <ci>Y</ci>
          </apply>
         </apply>
         <times></times>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>Y</ci>
           <ci>Y</ci>
          </apply>
         </apply>
         <times></times>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [X\;Y]=[U_{X}\;U_{Y}]\begin{bmatrix}\Sigma_{X}&0\\
0&\Sigma_{Y}\end{bmatrix}\begin{bmatrix}V_{XX}&V_{XY}\\
V_{YX}&V_{YY}\end{bmatrix}^{*}=[U_{X}\;U_{Y}]\begin{bmatrix}\Sigma_{X}&0\\
0&\Sigma_{Y}\end{bmatrix}\begin{bmatrix}V_{XX}^{*}&V_{YX}^{*}\\
V_{XY}^{*}&V_{YY}^{*}\end{bmatrix}
  </annotation>
 </semantics>
</math>

 where <em>V</em> is partitioned into blocks corresponding to the shape of <em>X</em> and <em>Y</em>.</p>

<p>Using the Eckart-Young theorem, the approximation minimising the norm of the error is such that matrices 

<math display="inline" id="Total_least_squares:31">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Total_least_squares:32">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 are unchanged, while the 

<math display="inline" id="Total_least_squares:33">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

-smallest singular values are replaced with zeroes. That is, we want</p>

<p>

<math display="block" id="Total_least_squares:34">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mo>+</mo>
       <mi>E</mi>
      </mrow>
      <mo rspace="5.3pt" stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>Y</mi>
       <mo>+</mo>
       <mi>F</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mpadded width="+2.8pt">
       <msub>
        <mi>U</mi>
        <mi>X</mi>
       </msub>
      </mpadded>
      <msub>
       <mi>U</mi>
       <mi>Y</mi>
      </msub>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi mathvariant="normal">Σ</mi>
         <mi>X</mi>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <msub>
         <mn>0</mn>
         <mrow>
          <mi>k</mi>
          <mo>×</mo>
          <mi>k</mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>X</mi>
           <mi>X</mi>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>X</mi>
           <mi>Y</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>Y</mi>
           <mi>X</mi>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>Y</mi>
           <mi>Y</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <mo>*</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>X</ci>
       <ci>E</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>Y</ci>
       <ci>F</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>U</ci>
        <ci>X</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>U</ci>
        <ci>Y</ci>
       </apply>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <ci>X</ci>
       </apply>
       <cn type="integer">0</cn>
      </matrixrow>
      <matrixrow>
       <cn type="integer">0</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <cn type="integer">0</cn>
        <apply>
         <times></times>
         <ci>k</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <apply>
          <times></times>
          <ci>X</ci>
          <ci>Y</ci>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <apply>
          <times></times>
          <ci>Y</ci>
          <ci>X</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <apply>
          <times></times>
          <ci>Y</ci>
          <ci>Y</ci>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
      <times></times>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [(X+E)\;(Y+F)]=[U_{X}\;U_{Y}]\begin{bmatrix}\Sigma_{X}&0\\
0&0_{k\times k}\end{bmatrix}\begin{bmatrix}V_{XX}&V_{XY}\\
V_{YX}&V_{YY}\end{bmatrix}^{*}
  </annotation>
 </semantics>
</math>

 so by linearity,</p>

<p>

<math display="block" id="Total_least_squares:35">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <mi>E</mi>
     </mpadded>
     <mi>F</mi>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mpadded width="+2.8pt">
        <msub>
         <mi>U</mi>
         <mi>X</mi>
        </msub>
       </mpadded>
       <msub>
        <mi>U</mi>
        <mi>Y</mi>
       </msub>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mn>0</mn>
          <mrow>
           <mi>n</mi>
           <mo>×</mo>
           <mi>n</mi>
          </mrow>
         </msub>
        </mtd>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
        <mtd columnalign="center">
         <msub>
          <mi mathvariant="normal">Σ</mi>
          <mi>Y</mi>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <msup>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>X</mi>
            <mi>X</mi>
           </mrow>
          </msub>
         </mtd>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>X</mi>
            <mi>Y</mi>
           </mrow>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>Y</mi>
            <mi>X</mi>
           </mrow>
          </msub>
         </mtd>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>Y</mi>
            <mi>Y</mi>
           </mrow>
          </msub>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mo>*</mo>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <times></times>
      <ci>E</ci>
      <ci>F</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <ci>X</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>U</ci>
         <ci>Y</ci>
        </apply>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <cn type="integer">0</cn>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <cn type="integer">0</cn>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Σ</ci>
         <ci>Y</ci>
        </apply>
       </matrixrow>
      </matrix>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <matrix>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>X</ci>
           <ci>X</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>X</ci>
           <ci>Y</ci>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>Y</ci>
           <ci>X</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>Y</ci>
           <ci>Y</ci>
          </apply>
         </apply>
        </matrixrow>
       </matrix>
       <times></times>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [E\;F]=-[U_{X}\;U_{Y}]\begin{bmatrix}0_{n\times n}&0\\
0&\Sigma_{Y}\end{bmatrix}\begin{bmatrix}V_{XX}&V_{XY}\\
V_{YX}&V_{YY}\end{bmatrix}^{*}
  </annotation>
 </semantics>
</math>

. We can then remove blocks from the <em>U</em> and Σ matrices, simplifying to</p>

<p>

<math display="block" id="Total_least_squares:36">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <mi>E</mi>
     </mpadded>
     <mi>F</mi>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mi>U</mi>
      <mi>Y</mi>
     </msub>
     <msub>
      <mi mathvariant="normal">Σ</mi>
      <mi>Y</mi>
     </msub>
     <msup>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>X</mi>
            <mi>Y</mi>
           </mrow>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>Y</mi>
            <mi>Y</mi>
           </mrow>
          </msub>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mo>*</mo>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mpadded width="+2.8pt">
        <mi>X</mi>
       </mpadded>
       <mi>Y</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>X</mi>
           <mi>Y</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <msub>
          <mi>V</mi>
          <mrow>
           <mi>Y</mi>
           <mi>Y</mi>
          </mrow>
         </msub>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
     <msup>
      <mrow>
       <mo>[</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>X</mi>
            <mi>Y</mi>
           </mrow>
          </msub>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <msub>
           <mi>V</mi>
           <mrow>
            <mi>Y</mi>
            <mi>Y</mi>
           </mrow>
          </msub>
         </mtd>
        </mtr>
       </mtable>
       <mo>]</mo>
      </mrow>
      <mo>*</mo>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <ci>E</ci>
       <ci>F</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>U</ci>
        <ci>Y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Σ</ci>
        <ci>Y</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <matrix>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>V</ci>
           <apply>
            <times></times>
            <ci>X</ci>
            <ci>Y</ci>
           </apply>
          </apply>
         </matrixrow>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>V</ci>
           <apply>
            <times></times>
            <ci>Y</ci>
            <ci>Y</ci>
           </apply>
          </apply>
         </matrixrow>
        </matrix>
        <times></times>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <matrix>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>X</ci>
           <ci>Y</ci>
          </apply>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <apply>
           <times></times>
           <ci>Y</ci>
           <ci>Y</ci>
          </apply>
         </apply>
        </matrixrow>
       </matrix>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <matrix>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>V</ci>
           <apply>
            <times></times>
            <ci>X</ci>
            <ci>Y</ci>
           </apply>
          </apply>
         </matrixrow>
         <matrixrow>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>V</ci>
           <apply>
            <times></times>
            <ci>Y</ci>
            <ci>Y</ci>
           </apply>
          </apply>
         </matrixrow>
        </matrix>
        <times></times>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [E\;F]=-U_{Y}\Sigma_{Y}\begin{bmatrix}V_{XY}\\
V_{YY}\end{bmatrix}^{*}=-[X\;Y]\begin{bmatrix}V_{XY}\\
V_{YY}\end{bmatrix}\begin{bmatrix}V_{XY}\\
V_{YY}\end{bmatrix}^{*}
  </annotation>
 </semantics>
</math>

. This provides <em>E</em> and <em>F</em> so that</p>

<p>

<math display="block" id="Total_least_squares:37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>X</mi>
        <mo>+</mo>
        <mi>E</mi>
       </mrow>
       <mo rspace="5.3pt" stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>Y</mi>
        <mo>+</mo>
        <mi>F</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>V</mi>
         <mrow>
          <mi>X</mi>
          <mi>Y</mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>V</mi>
         <mrow>
          <mi>Y</mi>
          <mi>Y</mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <ci>X</ci>
        <ci>E</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>Y</ci>
        <ci>F</ci>
       </apply>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <apply>
         <times></times>
         <ci>X</ci>
         <ci>Y</ci>
        </apply>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <apply>
         <times></times>
         <ci>Y</ci>
         <ci>Y</ci>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [(X+E)\;(Y+F)]\begin{bmatrix}V_{XY}\\
V_{YY}\end{bmatrix}=0
  </annotation>
 </semantics>
</math>

. Now if 

<math display="inline" id="Total_least_squares:38">
 <semantics>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>Y</mi>
    <mi>Y</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <apply>
     <times></times>
     <ci>Y</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{YY}
  </annotation>
 </semantics>
</math>

 is nonsingular, which is not always the case (note that the behavior of TLS when 

<math display="inline" id="Total_least_squares:39">
 <semantics>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>Y</mi>
    <mi>Y</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <apply>
     <times></times>
     <ci>Y</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{YY}
  </annotation>
 </semantics>
</math>


 is singular is not well understood yet), we can then right multiply both sides by 

<math display="inline" id="Total_least_squares:40">
 <semantics>
  <mrow>
   <mo>-</mo>
   <msubsup>
    <mi>V</mi>
    <mrow>
     <mi>Y</mi>
     <mi>Y</mi>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -V_{YY}^{-1}
  </annotation>
 </semantics>
</math>

 to bring the bottom block of the right matrix to the negative identity, giving<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>

<math display="block" id="Total_least_squares:41">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>X</mi>
         <mo>+</mo>
         <mi>E</mi>
        </mrow>
        <mo rspace="5.3pt" stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>Y</mi>
         <mo>+</mo>
         <mi>F</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mrow>
           <msub>
            <mi>V</mi>
            <mrow>
             <mi>X</mi>
             <mi>Y</mi>
            </mrow>
           </msub>
           <msubsup>
            <mi>V</mi>
            <mrow>
             <mi>Y</mi>
             <mi>Y</mi>
            </mrow>
            <mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mrow>
           <msub>
            <mi>V</mi>
            <mrow>
             <mi>Y</mi>
             <mi>Y</mi>
            </mrow>
           </msub>
           <msubsup>
            <mi>V</mi>
            <mrow>
             <mi>Y</mi>
             <mi>Y</mi>
            </mrow>
            <mrow>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </msubsup>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>X</mi>
         <mo>+</mo>
         <mi>E</mi>
        </mrow>
        <mo rspace="5.3pt" stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>Y</mi>
         <mo>+</mo>
         <mi>F</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mi>B</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <msub>
           <mi>I</mi>
           <mi>k</mi>
          </msub>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <ci>X</ci>
         <ci>E</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>Y</ci>
         <ci>F</ci>
        </apply>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>V</ci>
           <apply>
            <times></times>
            <ci>X</ci>
            <ci>Y</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>V</ci>
            <apply>
             <times></times>
             <ci>Y</ci>
             <ci>Y</ci>
            </apply>
           </apply>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>V</ci>
           <apply>
            <times></times>
            <ci>Y</ci>
            <ci>Y</ci>
           </apply>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>V</ci>
            <apply>
             <times></times>
             <ci>Y</ci>
             <ci>Y</ci>
            </apply>
           </apply>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <plus></plus>
         <ci>X</ci>
         <ci>E</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>Y</ci>
         <ci>F</ci>
        </apply>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <ci>B</ci>
       </matrixrow>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [(X+E)\;(Y+F)]\begin{bmatrix}-V_{XY}V_{YY}^{-1}\\
-V_{YY}V_{YY}^{-1}\end{bmatrix}=[(X+E)\;(Y+F)]\begin{bmatrix}B\\
-I_{k}\end{bmatrix}=0,
  </annotation>
 </semantics>
</math>

 and so</p>

<p>

<math display="block" id="Total_least_squares:42">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>V</mi>
       <mrow>
        <mi>X</mi>
        <mi>Y</mi>
       </mrow>
      </msub>
      <msubsup>
       <mi>V</mi>
       <mrow>
        <mi>Y</mi>
        <mi>Y</mi>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>B</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <ci>Y</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <apply>
         <times></times>
         <ci>Y</ci>
         <ci>Y</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=-V_{XY}V_{YY}^{-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>A naive <a href="GNU_Octave" title="wikilink">GNU Octave</a> implementation of this is:</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab">function B = tls(xdata,ydata)

m       = length(ydata);       <span class="co">%number of x,y data pairs</span>
X       = [xdata];
Y       = ydata;
n       = size(X,<span class="fl">2</span>);          <span class="co">% n is the width of X (X is m by n)</span>
Z       = [X Y];              <span class="co">% Z is X augmented with Y.</span>
[U S V] = svd(Z,<span class="fl">0</span>);           <span class="co">% find the SVD of Z.</span>
VXY     = V(<span class="fl">1</span>:n,<span class="fl">1</span>+n:end);     <span class="co">% Take the block of V consisting of the first n rows and the n+1 to last column</span>
VYY     = V(<span class="fl">1</span>+n:end,<span class="fl">1</span>+n:end); <span class="co">% Take the bottom-right block of V.</span>
B       = -VXY/VYY;
end</code></pre></div>

<p>The way described above of solving the problem, which requires that the matrix 

<math display="inline" id="Total_least_squares:43">
 <semantics>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>Y</mi>
    <mi>Y</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>V</ci>
    <apply>
     <times></times>
     <ci>Y</ci>
     <ci>Y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{YY}
  </annotation>
 </semantics>
</math>

 is nonsingular, can be slightly extended by the so-called <em>classical TLS algorithm</em>.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>
<h3 id="computation">Computation</h3>

<p>The standard implementation of classical TLS algorithm is available through <a href="http://www.netlib.org/vanhuffel/index.html">Netlib</a>, see also.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> All modern implementations based, for example, on solving a sequence of ordinary least squares problems, approximate the matrix 

<math display="inline" id="Total_least_squares:44">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>


 (denoted 

<math display="inline" id="Total_least_squares:45">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 in the literature), as introduced by Van Huffel and Vandewalle. It is worth noting, that this 

<math display="inline" id="Total_least_squares:46">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>

 is, however, <em>not the TLS solution</em> in many cases.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="non-linear-model">Non-linear model</h2>

<p>For <a href="non-linear_least_squares" title="wikilink">non-linear systems</a> similar reasoning shows that the normal equations for an iteration cycle can be written as</p>

<p>

<math display="block" id="Total_least_squares:47">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>𝐉</mi>
      <mi>𝐓</mi>
     </msup>
     <msup>
      <mi>𝐌</mi>
      <mrow>
       <mo>-</mo>
       <mn>𝟏</mn>
      </mrow>
     </msup>
     <mi>𝐉</mi>
     <mi>𝚫</mi>
     <mi>𝜷</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐉</mi>
      <mi>𝐓</mi>
     </msup>
     <msup>
      <mi>𝐌</mi>
      <mrow>
       <mo>-</mo>
       <mn>𝟏</mn>
      </mrow>
     </msup>
     <mi>𝚫</mi>
     <mi>𝐲</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐉</ci>
      <ci>𝐓</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐌</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>𝐉</ci>
     <ci>𝚫</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐉</ci>
      <ci>𝐓</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐌</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>𝚫</ci>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{J^{T}M^{-1}J\Delta\boldsymbol{\beta}=J^{T}M^{-1}\Delta y}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="geometrical-interpretation">Geometrical interpretation</h2>

<p>When the independent variable is error-free a residual represents the "vertical" distance between the observed data point and the fitted curve (or surface). In total least squares a residual represents the distance between a data point and the fitted curve measured along some direction. In fact, if both variables are measured in the same units and the errors on both variables are the same, then the residual represents the <a href="distance_from_a_point_to_a_line" title="wikilink">shortest distance between the data point and the fitted curve</a>, that is, the residual vector is perpendicular to the tangent of the curve. For this reason, this type of regression is sometimes called <em>two dimensional Euclidean regression</em> (Stein, 1983)<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> or <em>orthogonal regression</em>.</p>
<h3 id="scale-invariant-methods">Scale invariant methods</h3>

<p>A serious difficulty arises if the variables are not measured in the same units. First consider measuring distance between a data point and the curve - what are the measurement units for this distance? If we consider measuring distance based on Pythagoras' Theorem then it is clear that we shall be adding quantities measured in different units, and so this leads to meaningless results. Secondly, if we rescale one of the variables e.g., measure in grams rather than kilograms, then we shall end up with different results (a different curve). To avoid this problem of incommensurability it is sometimes suggested that we convert to dimensionless variables—this may be called normalization or standardization. However there are various ways of doing this, and these lead to fitted models which are not equivalent to each other. One approach is to normalize by known (or estimated) measurement precision thereby minimizing the <a href="Mahalanobis_distance" title="wikilink">Mahalanobis distance</a> from the points to the line, providing a <a class="uri" href="maximum-likelihood" title="wikilink">maximum-likelihood</a> solution; the unknown precisions could be found via <a href="analysis_of_variance" title="wikilink">analysis of variance</a>.</p>

<p>In short, total least squares does not have the property of units-invariance—i.e. it is not <a href="scale_invariance" title="wikilink">scale invariant</a>. For a meaningful model we require this property to hold. A way forward is to realise that residuals (distances) measured in different units can be combined if multiplication is used instead of addition. Consider fitting a line: for each data point the product of the vertical and horizontal residuals equals twice the area of the triangle formed by the residual lines and the fitted line. We choose the line which minimizes the sum of these areas. Nobel laureate <a href="Paul_Samuelson" title="wikilink">Paul Samuelson</a> proved in 1942 that, in two dimensions, it is the only line expressible solely in terms of the ratios of standard deviations and the correlation coefficient which (1) fits the correct equation when the observations fall on a straight line; (2) exhibits scale invariance, and (3) exhibits invariance under interchange of variables.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> This line has been rediscovered in different disciplines and is variously known as standardised major axis (Ricker 1975, Warton et al., 2006),<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a><a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> the reduced major axis, the geometric mean functional relationship (Draper and Smith, 1998),<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> least products regression, diagonal regression, line of organic correlation, and the least areas line. Tofallis (2002)<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> has extended this approach to deal with multiple variables.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Deming_regression" title="wikilink">Deming regression</a>, a special case with two predictors and independent errors</li>
<li><a href="Errors-in-variables_model" title="wikilink">Errors-in-variables model</a></li>
<li><a href="Linear_regression" title="wikilink">Linear regression</a></li>
<li><a href="Least_squares" title="wikilink">Least squares</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<h3 id="others">Others</h3>
<ul>
<li>I. Hnětynková, M. Plešinger, D. M. Sima, Z. Strakoš, and S. Van Huffel, <em>The total least squares problem in AX ≈ B. A new classification with the relationship to the classical works.</em> SIMAX vol. 32 issue 3 (2011), pp. 748–770. Available as a <a href="ftp://ftp.sam.math.ethz.ch/pub/sam-reports/reports/reports2010/2010-38.pdf">preprint</a>.</li>
<li>M. Plešinger, <em>The Total Least Squares Problem and Reduction of Data in AX ≈ B.</em> Doctoral Thesis, TU of Liberec and Institute of Computer Science, AS CR Prague, 2008. <a href="http://www.fp.tul.cz/~plesinger/my_publications/doctoral_thesis/thesis.pdf">Ph.D. Thesis</a></li>
<li>C. C. Paige, Z. Strakoš, <em>Core problems in linear algebraic systems.</em> SIAM J. Matrix Anal. Appl. 27, 2006, pp. 861–875.</li>
<li>S. Van Huffel and P. Lemmerling, <em>Total Least Squares and Errors-in-Variables Modeling: Analysis, Algorithms and Applications</em>. Dordrecht, The Netherlands: Kluwer Academic Publishers, 2002.</li>
<li>S. Jo and S. W. Kim, <em>Consistent normalized least mean square filtering with noisy data matrix.</em> IEEE Trans. Signal Processing, vol. 53, no. 6, pp. 2112–2123, Jun. 2005.</li>
<li>R. D. DeGroat and E. M. Dowling, <em>The data least squares problem and channel equalization.</em> IEEE Trans. Signal Processing, vol. 41, no. 1, pp. 407–411, Jan. 1993.</li>
<li>S. Van Huffel and J. Vandewalle, <em>The Total Least Squares Problems: Computational Aspects and Analysis.</em> SIAM Publications, Philadelphia PA, 1991.</li>
<li>T. Abatzoglou and J. Mendel, <em>Constrained total least squares</em>, in Proc. IEEE Int. Conf. Acoust., Speech, Signal Process. (ICASSP’87), Apr. 1987, vol. 12, pp. 1485–1488.</li>
<li>P. de Groen <em>An introduction to total least squares</em>, in Nieuw Archief voor Wiskunde, Vierde serie, deel 14, 1996, pp. 237–253 <a href="http://arxiv.org/pdf/math.RA/9805076/">arxiv.org</a>.</li>
<li>G. H. Golub and C. F. Van Loan, <em>An analysis of the total least squares problem.</em> SIAM J. on Numer. Anal., 17, 1980, pp. 883–893.</li>
<li><a href="http://www.mathpages.com/home/kmath110.htm">Perpendicular Regression Of A Line</a> at MathPages</li>
<li>A. R. Amiri-Simkooei and S. Jazaeri <em>Weighted total least squares formulated by standard least squares theory</em>,in Journal of Geodetic Science, 2 (2): 113-124, 2012 <a href="http://engold.ui.ac.ir/~amiri/JGS_Amiri_Jazaeri_2012.pdf">1</a>.</li>
</ul>

<p>"</p>

<p><a href="Category:Applied_mathematics" title="wikilink">Category:Applied mathematics</a> <a href="Category:Statistical_models" title="wikilink">Category:Statistical models</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Least_squares" title="wikilink">Category:Least squares</a> <a href="Category:Multivariate_statistics" title="wikilink">Category:Multivariate statistics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">I. Markovsky and S. Van Huffel, <em>Overview of total least squares methods.</em> Signal Processing, vol. 87, pp. 2283-2302, 2007. <a href="http://eprints.ecs.soton.ac.uk/13855/1/tls_overview.pdf">preprint</a><a href="#fnref1">↩</a></li>
<li id="fn2">An alternative form is 

<math display="inline" id="Total_least_squares:48">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐖𝐗</mi>
    <mi>𝚫</mi>
    <mi>𝜷</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐗</mi>
     <mi>𝐓</mi>
    </msup>
    <mi>𝐖</mi>
    <mi>𝚫</mi>
    <mi>𝐲</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐖𝐗</ci>
     <ci>𝚫</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝐖</ci>
     <ci>𝚫</ci>
     <ci>𝐲</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X^{T}WX\boldsymbol{\Delta}\boldsymbol{\beta}=X^{T}W\boldsymbol{\Delta}y}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Total_least_squares:49">
 <semantics>
  <mrow>
   <mi>𝚫</mi>
   <mi>𝜷</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝚫</ci>
    <ci>𝜷</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Delta}\boldsymbol{\beta}
  </annotation>
 </semantics>
</math>


 is the parameter shift from some starting estimate of 

<math display="inline" id="Total_least_squares:50">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Total_least_squares:51">
 <semantics>
  <mrow>
   <mi>𝚫</mi>
   <mi>𝐲</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝚫</ci>
    <ci>𝐲</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\Delta}\mathbf{y}
  </annotation>
 </semantics>
</math>

 is the difference between <strong>y</strong> and the value calculated using the starting value of 

<math display="inline" id="Total_least_squares:52">
 <semantics>
  <mi>𝜷</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝜷</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\beta}
  </annotation>
 </semantics>
</math>

<a href="#fnref2">↩</a></li>
<li id="fn3">W.E. Deming, Statistical Adjustment of Data, Wiley, 1943<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5">G. H. Golub and C. F. Van Loan, An analysis of the total least squares problem. Numer. Anal., 17, 1980, pp. 883-893.<a href="#fnref5">↩</a></li>
<li id="fn6"> pp 596.<a href="#fnref6">↩</a></li>
<li id="fn7">The notation <em>XB</em>≈<em>Y</em> is used here to reflect the notation used in the earlier part of the article. In the computational literature the problem has been more commonly presented as <em>AX</em>≈<em>B</em>, i.e. with the letter <em>X</em> used for the <em>n</em>-by-<em>k</em> matrix of unknown regression coefficients.<a href="#fnref7">↩</a></li>
<li id="fn8">Bjõrck, Ake (1996) <em>Numerical Methods for Least Squares Problems</em>, Society for Industrial and Applied Mathematics. ISBN 978-0898713602 <a href="#fnref8">↩</a></li>
<li id="fn9">S. Van Huffel and J. Vandewalle (1991) <em>The Total Least Squares Problems: Computational Aspects and Analysis</em>. SIAM Publications, Philadelphia PA.<a href="#fnref9">↩</a></li>
<li id="fn10">S. Van Huffel, Documented Fortran 77 programs of the extended classical total least squares algorithm, the partial singular value decomposition algorithm and the partial total least squares algorithm, Internal Report ESAT-KUL 88/1, ESAT Lab., Dept. of Electrical Engineering, Katholieke Universiteit Leuven, 1988.<a href="#fnref10">↩</a></li>
<li id="fn11">S. Van Huffel, The extended classical total least squares algorithm, J. Comput. Appl. Math., 25, pp. 111-119, 1989.<a href="#fnref11">↩</a></li>
<li id="fn12">M. Plešinger, The Total Least Squares Problem and Reduction of Data in AX ≈ B. Doctoral Thesis, TU of Liberec and Institute of Computer Science, AS CR Prague, 2008. Ph.D. Thesis<a href="#fnref12">↩</a></li>
<li id="fn13">I. Hnětynková, M. Plešinger, D. M. Sima, Z. Strakoš, and S. Van Huffel, The total least squares problem in AX ≈ B. A new classification with the relationship to the classical works. SIMAX vol. 32 issue 3 (2011), pp. 748–770.<a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18">Draper, NR and Smith, H. <em>Applied Regression Analysis</em>, 3rd edition,pp.92-96. 1998<a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
</ol>
</section>
</body>


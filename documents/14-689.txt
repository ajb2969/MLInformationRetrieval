   Wiener's attack      Wiener's attack   The Wiener's attack , named after cryptologist Michael J. Wiener, is a type of cryptographic attack against RSA . The attack uses the continued fraction method to expose the private key d when d is small.  Background on RSA  Before we discuss how Wiener's attack works, we will first briefly explain how RSA works. For more details see the main entry on the RSA cryptosystem. Let Alice and Bob be two people who want to communicate securely. More specifically, Alice wants to send a message to Bob which only Bob can read. First Bob chooses two primes  p and q . Then he calculates the RSA modulus  N = pq . This RSA modulus is made public together with the encryption exponent e . N and e form the public key pair (e,N) . By making this information public, anyone can encrypt messages to Bob. The decryption exponent d satisfies     e  d   =   1  mod   φ   (  N  )           e  d    modulo  1    φ  N      ed=1\bmod\varphi(N)   , where     φ   (  N  )    =    (   p  -  1   )    (   q  -  1   )          φ  N       p  1     q  1      \varphi(N)=(p-1)(q-1)   , is Euler’s phi function (note: this is the order of the multiplicative group     ℤ  N  *     superscript   subscript  ℤ  N      \mathbb{Z}_{N}^{*}   ). The encryption exponent e and    φ   (  N  )       φ  N    \varphi(N)   also must be relatively prime so that there is a modular inverse. The factorization of N and the private key d are kept secret, so that only Bob can decrypt the message. We denote the private key pair as (d, N) . The encryption of the message M is given by    C  ≡    M  e   mod   φ   (  N  )         C   modulo   superscript  M  e     φ  N      C\equiv M^{e}\bmod\varphi(N)   and the decryption of cipher text   C   C   C   is given by     C  d   ≡    (   M  e   )   d   ≡   M   (   e  d   )    ≡   M  mod   φ   (  N  )            superscript  C  d    superscript   superscript  M  e   d         superscript  M    e  d          modulo  M    φ  N       C^{d}\equiv(M^{e})^{d}\equiv M^{(ed)}\equiv M\bmod\varphi(N)   (using Fermat's little theorem ).  Using the Euclidean algorithm , one can efficiently recover the secret key d if one knows the factorization of N. By having the secret key d , one can efficiently factor the modulus of N . 1  Small Private Key  In the RSA Cryptosystem , Bob might tend to use a small value of d , rather than a large random number to improve the RSA  decryption performance. However, Wiener’s attack shows that choosing a small value for d will result in an insecure system in which an attacker can recover all secret information, i.e., break the RSA system. This break is based on Wiener’s Theorem, which holds for small values of d . Wiener has proved that the attacker may efficiently find d when    d  <    1  3    N   1  4         d      1  3    superscript  N    1  4       d<\frac{1}{3}N^{\frac{1}{4}}   . 2  Wiener's paper also presented some countermeasures against his attack that allow fast decryption. Two techniques are described as follows.  Choosing large public key : Replace   e   e   e   by    e  ′     superscript  e  normal-′    e^{\prime}   , where      e  ′   =   e  +  k    .   φ   (  N  )       formulae-sequence     superscript  e  normal-′     e  k      φ  N     e^{\prime}=e+k.\varphi(N)   for some large of   k   k   k   . When    e  ′     superscript  e  normal-′    e^{\prime}   is large enough, i.e.     e  ′   >   N   3  2         superscript  e  normal-′    superscript  N    3  2      e^{\prime}>N^{\frac{3}{2}}   , then Wiener’s attack can not be applied regardless of how small   d   d   d   is.  Using the Chinese Remainder Theorem : Suppose one chooses d such that both     d  p   =   d  mod   (   p  -  1   )         subscript  d  p    modulo  d    p  1      d_{p}=d\bmod\ (p-1)   and     d  q   =   d  mod   (   q  -  1   )         subscript  d  q    modulo  d    q  1      d_{q}=d\bmod\ (q-1)   are small but   d   d   d   itself is not, then a fast decryption of   C   C   C   can be done as follows:  1. First compute     M  p   ≡    C   d  p    mod  p        subscript  M  p    modulo   superscript  C   subscript  d  p    p     M_{p}\equiv C^{d_{p}}\bmod\ p   and     M  q   ≡    C   d  q    mod  q        subscript  M  q    modulo   superscript  C   subscript  d  q    q     M_{q}\equiv C^{d_{q}}\bmod\ q   . 2. Use the Chinese Remainder Theorem to compute the unique value of    M  ∈   ℤ  ℕ       M   subscript  ℤ  ℕ     M\in\mathbb{Z_{N}}   which satisfies    M  ≡    M  p   mod  p       M   modulo   subscript  M  p   p     M\equiv M_{p}\bmod\ p   and    M  ≡    M  q   mod  q       M   modulo   subscript  M  q   q     M\equiv M_{q}\bmod\ q   . The result of   M   M   M   satisfies    M  ≡    C  d   mod  N       M   modulo   superscript  C  d   N     M\equiv C^{d}\bmod\ N   as needed. The point is that Wiener’s attack does not apply here because the value of    d  mod   φ   (  N  )       modulo  d    φ  N     d\bmod\ \varphi(N)   can be large. 3   How Wiener's attack works  Since       e  d   =   1  mod   lcm   (   p  -  1   ,   q  -  1   )           e  d    modulo  1   lcm    p  1     q  1       ed=1(\bmod\ \operatorname{lcm}(p-1,q-1))   ,  there exists an integer K such that       e  d   =    K  ×   lcm   (   p  -  1   ,   q  -  1   )     +  1         e  d       K   lcm    p  1     q  1     1     ed=K\times\operatorname{lcm}(p-1,q-1)+1     Define    G  =   gcd   (   p  -  1   ,   q  -  1   )        G      p  1     q  1      G=\gcd(p-1,q-1)   to be substituted in the equation above which gives:       e  d   =     K  G    (   p  -  1   )    (   q  -  1   )    +  1         e  d         K  G     p  1     q  1    1     ed=\frac{K}{G}(p-1)(q-1)+1     Defining    k  =   K   gcd   (  K  ,  G  )         k    K    K  G      k=\frac{K}{\gcd(K,G)}   and    g  =   G   gcd   (  K  ,  G  )         g    G    K  G      g=\frac{G}{\gcd(K,G)}   , and substituting into the above gives:       e  d   =     k  g    (   p  -  1   )    (   q  -  1   )    +  1         e  d         k  g     p  1     q  1    1     ed=\frac{k}{g}(p-1)(q-1)+1   . Divided by    d  p  q      d  p  q    dpq   :      e   p  q    =    k   d  g     (   1  -  δ   )          e    p  q        k    d  g      1  δ      \frac{e}{pq}=\frac{k}{dg}(1-\delta)   , where    δ  =     p  +  q   -  1  -   g  k     p  q        δ        p  q   1    g  k      p  q      \delta=\frac{p+q-1-\frac{g}{k}}{pq}   .  So,    e   p  q       e    p  q     \frac{e}{pq}   is slightly smaller than    k   d  g       k    d  g     \frac{k}{dg}   , and the former is composed entirely of public information . However, a method of checking a guess is still required. Assuming that     e  d   >   p  q         e  d     p  q     ed>pq   (a reasonable assumption unless   G   G   G   is large) the last equation above may be written as:       e  d  g   =  k   .     (   p  -  1   )    (   q  -  1   )    +  g      formulae-sequence      e  d  g   k         p  1     q  1    g     edg=k.(p-1)(q-1)+g   By using simple algebraic manipulations and identities , a guess can be checked for accuracy . 4  Wiener's theorem  Let     N   =   p  q       N    p  q     \ N=pq   with     q   <  p  <   2  q         q  p         2  q      \ q   . Let    d  <    1  3    N   1  4         d      1  3    superscript  N    1  4       d<\frac{1}{3}N^{\frac{1}{4}}   . Given    ⟨  N  ,  e  ⟩     N  e    \left\langle N,e\right\rangle   with     e  d   =   1  mod   φ   (  N  )           e  d    modulo  1    φ  N      ed=1(\bmod\ \varphi(N))   , the attacker can efficiently recover   d   d   d   . 5  Example  Suppose that the public keys are     ⟨  N  ,  e  ⟩   =   ⟨  90581  ,  17993  ⟩        N  e    90581  17993     \left\langle N,e\right\rangle=\left\langle 90581,17993\right\rangle    The attack shall determine   d   d   d   . By using Wiener's Theorem and continued fractions to approximate    d   d   d   , first we try to find the continued fractions expansion of    e  N      e  N    \frac{e}{N}   . Note that this algorithm finds fractions in their lowest terms. We know that       e  N   =   17993  90581   =   1   5  +    1   29  +  …  +    1  3         =   [  0  ,  5  ,  29  ,  4  ,  1  ,  3  ,  2  ,  4  ,  3  ]           e  N     17993  90581         continued-fraction  1    5   continued-fraction  1    29  normal-…   continued-fraction  1  3             0  5  29  4  1  3  2  4  3      \frac{e}{N}=\frac{17993}{90581}=\cfrac{1}{5+\cfrac{1}{29+\dots+\cfrac{1}{3}}}=%
 \left[0,5,29,4,1,3,2,4,3\right]     According to the continued fractions expansion of    e  N      e  N    \frac{e}{N}   , all convergents    k  d      k  d    \frac{k}{d}   are:       k  d   =   0  ,   1  5   ,   29  146   ,   117  589   ,   146  735   ,   555  2794   ,   1256  6323   ,   5579  28086   ,   17993  90581          k  d    0    1  5     29  146     117  589     146  735     555  2794     1256  6323     5579  28086     17993  90581      \frac{k}{d}=0,\frac{1}{5},\frac{29}{146},\frac{117}{589},\frac{146}{735},\frac%
 {555}{2794},\frac{1256}{6323},\frac{5579}{28086},\frac{17993}{90581}     We can verify that the first convergent does not produce a factorization of   N   N   N   . However, the convergent    1  5      1  5    \frac{1}{5}   yields       φ   (  N  )    =    e  .   d  -  1    k   =     17993  ×  5   -  1   1   =  89964          φ  N      formulae-sequence  e    d  1    k              17993  5   1   1        89964     \varphi(N)=\frac{e.d-1}{k}=\frac{17993\times 5-1}{1}=89964   Now, if we solve the equation         x  2   -    (    (   N  -   φ   (  N  )     )   +  1   )   x    +  N   =  0           superscript  x  2         N    φ  N    1   x    N   0    x^{2}-\left(\left(N-\varphi(N)\right)+1\right)x+N=0            x  2   -    (    (   90581  -  89964   )   +  1   )   x    +  90581   =  0           superscript  x  2         90581  89964   1   x    90581   0    x^{2}-\left(\left(90581-89964\right)+1\right)x+90581=0            x  2   -    (  618  )   x    +  90581   =  0           superscript  x  2     618  x    90581   0    x^{2}-\left(618\right)x+90581=0     then we find the roots which are    x  =   379  ;  239       x   379  239     x=379;239   . Therefore we have found the factorization      N  =  90581  =   379  ×  239   =   p  ×  q         N  90581         379  239          p  q      N=90581=379\times 239=p\times q   . Notice that, for the modulus    N  =  90581      N  90581    N=90581   , Wiener's Theorem will work if     d  <    N   1  4    3   ≈  5.7828        d     superscript  N    1  4    3        5.7828     d<\frac{N^{\frac{1}{4}}}{3}\approx 5.7828   .  Proof of Wiener's theorem  The proof is based on approximations using continued fractions. 6 7 Since     e  d   =   1  mod   φ   (  N  )           e  d    modulo  1    φ  N      ed=1\bmod\varphi(N)   , there exists a   k   k   \mathit{k}   such that      e  d   -   k  φ   (  N  )     =  1          e  d     k  φ  N    1    ed-k\varphi(N)=1   . Therefore       |    e   φ   (  N  )     -   k  d    |   =   1   d  φ   (  N  )               e    φ  N      k  d       1    d  φ  N      \left|\frac{e}{\varphi(N)}-\frac{k}{d}\right|=\frac{1}{d\varphi(N)}   .  Hence,    k  d      k  d    \frac{k}{d}   is an approximation of    e   φ   (  N  )        e    φ  N     \frac{e}{\varphi(N)}   . Although the attacker does not know    φ   (  N  )       φ  N    \varphi(N)   , he may use   N   N   N   to approximate it. Indeed, since       φ   (  N  )    =    N  -  p  -  q   +  1         φ  N       N  p  q   1     \varphi(N)=N-p-q+1   and      p  +  q   -  1   <   3   N            p  q   1     3    N      p+q-1<3\sqrt{N}   , we have:       |    p  +  q   -  1   |   <   3   N              p  q   1      3    N      \left|p+q-1\right|<3\sqrt{N}          |    N  +  1   -   φ   (  N  )    -  1   |   <   3   N              N  1     φ  N   1      3    N      \left|N+1-\varphi(N)-1\right|<3\sqrt{N}     Using   N   N   N   in place of    φ   (  N  )       φ  N    \varphi(N)   we obtain:       |    e  N   -   k  d    |   =   |     e  d   -   k  N     N  d    |             e  N     k  d             e  d     k  N      N  d       \left|\frac{e}{N}-\frac{k}{d}\right|=\left|\frac{ed-kN}{Nd}\right|            =   |      e  d   -   k  φ   (  N  )    -   k  N    +   k  φ   (  N  )      N  d    |       absent            e  d     k  φ  N     k  N      k  φ  N      N  d       \qquad=\left|\frac{ed-k\varphi(N)-kN+k\varphi(N)}{Nd}\right|          =   |    1  -   k   (   N  -   φ   (  N  )     )      N  d    |       absent        1    k    N    φ  N        N  d       =\left|\frac{1-k(N-\varphi(N))}{Nd}\right|          ≤   |    3  k   N     N  d    |   =    3  k   N      N    N   d    =    3  k    d   N           absent        3  k    N      N  d              3  k    N        N     N   d             3  k     d    N        \leq\left|\frac{3k\sqrt{N}}{Nd}\right|=\frac{3k\sqrt{N}}{\sqrt{N}\sqrt{N}d}=%
 \frac{3k}{d\sqrt{N}}        Now,     |    e  N   -   k  d    |   ≤   1   d   N   1  4                e  N     k  d       1    d   superscript  N    1  4        \left|\frac{e}{N}-\frac{k}{d}\right|\leq\frac{1}{dN^{\frac{1}{4}}}   , so      d  <    1  3    N   1  4      ,    2  d   <   3  d     ,     formulae-sequence    d      1  3    superscript  N    1  4          2  d     3  d      d<\frac{1}{3}N^{\frac{1}{4}},2d<3d,       k      Since     |    e  N   -   k  d    |   ≤    3  k    d   N     <   1    d  ⋅  2   d    =    1   2   d  2     ■               e  N     k  d         3  k     d    N            1     normal-⋅  d  2   d             1    2   superscript  d  2     normal-■      \left|\frac{e}{N}-\frac{k}{d}\right|\leq\frac{3k}{d\sqrt{N}}<\frac{1}{d\cdot 2%
 d}=\frac{1}{2d^{2}}\blacksquare   . Hence we obtain:   (1) $\left \vert \frac{e}{N}- \frac{k}{d} \right \vert \le \frac{1}{dN^{ \frac{1}{4}}}$    Since $d< \frac{1}{3}N^{ \frac{1}{4}},2d<3d,$ then $2d<3d , we obtain: 
 
 : 2d , so (2) \frac{1}{2d}> \frac{1}{N^{ \frac{1}{4}}}$ From (1) and (2), we can conclude that  $$\left \vert \frac{e}{N}- \frac{k}{d} \right \vert \le \frac{3k}{d \sqrt{N}}< \frac{1}{d \cdot 2d}= \frac{1}{2d^2} \blacksquare$$  References  Further reading   Coppersmith, Don (1996). Low-Exponent RSA with Related Messages. Springer-Verlag Berlin Heidelberg.  Jose, Justin (2010). Study of RSA and Proposed Variant Against Wiener's Attack. International Journal of Computer Applications.  Dujella, Andrej (2004). Continued Fractions and RSA with Small Secret Exponent.      "  Category:Asymmetric-key algorithms  Category:Cryptographic attacks     [ http://personalpages.manchester.ac.uk/postgrad/elaine.render/mathtoday.pdf . L. Render, Elaine (2007). Wiener's Attack on Short Secret Exponents.] ↩   [ http://www4.ncsu.edu/~kksivara/sfwr4c03/projects/4c03projects/XCui-Project.pdf . Cui, Xiao-lei (2005). Attack On the RSA Cryptosystem.] ↩   Boneh, Dan (1999). Twenty Years of attacks on the RSA Cryptosystem. Notices of the American Mathematical Society (AMS) 46 (2). ↩   [ http://www.scipub.org/fulltext/jcs/jcs28665-671.pdf . Khaled Salah, Imad (2006). Mathematical Attacks on RSA Cryptosystem. Journal of Computer Science 2 (8)). pp. 665-671.] ↩     
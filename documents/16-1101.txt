   Time/memory/data tradeoff attack      Time/memory/data tradeoff attack   A time/memory/data tradeoff attack is a type cryptographic attack of where an attacker tries to achieve a situation similar to the space–time tradeoff but with one more parameter data: amount of data available to the attacker at real time. An attacker balances or reduces one or two of those parameters in favor of the other one or two. This type of attack is very hard and most of the ciphers and encryption schemes were not designed to resist such type of attack. This attack is a special type of the general cryptanalytic time/memory tradeoff attack.  History  Tradeoff attacks on symmetric cryptosystems dates back to 1980 when Hellman suggested a time/memory tradeoff method to break block ciphers with   N   N   N   possible keys in time   T   T   T   and memory   M   M   M   related by the tradeoff curve     T   M  2    =   N  2         T   superscript  M  2     superscript  N  2     T{M^{2}}={N^{2}}   where    1  ≤  T  ≤  N        1  T       N     1\leq T\leq N   . 1 Later, Babbage and Golic devised a different tradeoff attack for stream ciphers with a new bound such that     T  M   =  N        T  M   N    TM=N   for    1  ≤  T  ≤  D        1  T       D     1\leq T\leq D   and   D   D   D    is the output data available to the cryptanalyst at real time . 2 3  Attack Mechanics  This attack is a special type of the general cryptanalytic time/memory tradeoff attack . A general time/memory tradeoff attack has two main phases:   Preprocessing:     During this phase, the attacker explores the structure of the cryptosystem and is allowed to record his findings in large tables. This can take long time.      Realtime:     In this phase, the cryptanalyst is granted real data obtained from a specific unknown key. He tries to use the precomputed table from the preprocessing phase to find the particular in as little time as possible.     Any time/memory/data tradeoff attack has the following parameters:     N   N   N   search space size     P   P   P   time required for the preprocessing phase     T   T   T   time required for the realtime phase     M   M   M   amount of memory available to the attacker     D   D   D   amount of realtime data available to the attacker  Hellman 's tradeoff attack on block ciphers  4  For block ciphers,   N   N   N   is the total number of possible keys and also assume the number of possible plaintexts and ciphertexts to be   N   N   N   . Also let the given data be a single ciphertext block of a specific plaintext counterpart. If we consider the mapping from the key   x   x   x   to the ciphertext   y   y   y   as a random permutation function   f   f   f   over an   N   N   N   point space, and if this function   f   f   f   is invertible; we need to find the inverse of this function      f   -  1     (  y  )    =  x         superscript  f    1    y   x    {f}^{-1}(y)=x   . Hellman's technique to invert this function:   During the preprocessing stage   Try to cover the   N   N   N   point space by an    m  ×  t      m  t    m\times t   rectangular matrix that is constructed by iterating the function   f   f   f   on   m   m   m   random starting points in   N   N   N   for   t   t   t   times. The start points are the leftmost column in the matrix and the end points are the rightmost column. Then store the pairs of start and end points in increasing order of end points values.   (Figure)  Hellman's Matrix    Now, only one matrix will not be able to cover the whole   N   N   N   space. But if we add more rows to the matrix we will end up with a huge matrix that includes recovered points more than once. So we find the critical value of   m   m   m   at which the matrix contains exactly   m   m   m   different points. Consider the first   m   m   m   paths from start points to end points are all disjoint with    m  t      m  t    mt   points, such that the next path which has at least one common point with one of those previous paths and includes exactly   t   t   t   points. Those two sets of    m  t      m  t    mt   and   t   t   t   points are disjoint by the birthday paradox if we make sure that     t   \sdot   m  t   ≤  N        t  \sdot  m  t   N    t\sdot mt\leq N   . We achieve this by enforcing the matrix stopping rule:      m   t  2    =  N        m   superscript  t  2    N    m{t}^{2}=N   .  Nevertheless, an    m  ×  t      m  t    m\times t   matrix with     m   t  2    =  N        m   superscript  t  2    N    m{t}^{2}=N   covers a portion      m  t   /  N   =   1  /  t           m  t   N     1  t     mt/N=1/t   of the whole space. To generate   t   t   t   to cover the whole space, we use a variant of   f   f   f   defined      f  i    (  x  )    =    h  i    (   f   (  x  )    )           subscript  f  i   x      subscript  h  i     f  x      {f}_{i}(x)={h}_{i}(f(x))   and    h  i     subscript  h  i    {h}_{i}   is simple out manipulation such as reordering of bits of    f   (  x  )       f  x    f(x)    5 (refer to the original paper for more details). And one can see that the total preprocessing time is    P  ≈  N      P  N    P\approx N   . Also    M  =   m  t       M    m  t     M=mt   since we only need to store the pairs of start and end points and we have   t   t   t   matrices each of   m   m   m   pairs.    During the real time phase   The total computation required to find     f   -  1     (  y  )        superscript  f    1    y    f^{-1}(y)   is    T  =   t  2       T   superscript  t  2     T=t^{2}   because we need to do   t   t   t   inversion attempts as it is likely to be covered by one matrix and each of the attempts takes   t   t   t   evaluations of some    f  i     subscript  f  i    f_{i}   . The optimum tradeoff curve is obtained by using the matrix stopping rule     m   t  2    =  N        m   superscript  t  2    N    m{t}^{2}=N    and we get      T   M  2    =   N  2    ,    P  =  N   ,   D  =  1       formulae-sequence      T   superscript  M  2     superscript  N  2     formulae-sequence    P  N     D  1      T{M^{2}}={N^{2}},P=N,D=1   and choice of   T   T   T   and   M   M   M   depends on the cost of each resource.   According to Hellman, if the block cipher at hand has the property that the mapping from its key to cipher text is a random permutation function   f   f   f   over an   N   N   N   point space, and if this   f   f   f   is invertible, the tradeoff relationship becomes ways better     T  M   =  N        T  M   N    TM=N   .  Babbage-and-Golic tradeoff attack on stream ciphers  6 7  For stream ciphers,   N   N   N   is specified by the number of internal states of the bit generator - probably different from the number of keys.   D   D   D   is the count of the first pseudorandom bits produced from the generator. Finally, the attacker goal is to find one of the actual internal states of the bit generator to be able to run the generator from this point on to generate the rest of the key. Associate each of the possible   N   N   N   internal states of the bit generator with the corresponding string that consists of the first    l  o  g   (  N  )       l  o  g  N    log(N)   bits obtained by running the generator from that state by the mapping     f   (  x  )    =  y        f  x   y    f(x)=y   from states   x   x   x   to output prefixes   y   y   y   . This previous mapping is considered a random function over the   N   N   N   points common space. To invert this function, an attacker establishes the following.   During the preprocessing phase, pick   M   M   M   random    x  i     subscript  x  i    {x}_{i}   states and compute their corresponding    y  i     subscript  y  i    {y}_{i}   output prefixes.  Store the pairs    (   x  i   ,   y  i   )      subscript  x  i    subscript  y  i     ({x}_{i},{y}_{i})   in increasing order of    y  i     subscript  y  i    {y}_{i}   in a large table.  During the realtime phase, you have     D  +   l  o  g   (  N  )     -  1        D    l  o  g  N    1    D+log(N)-1   generated bits. Calculate from them all   D   D   D   possible combinations of      y  1   ,   y  2   ,  …  ,   y  D    ,      subscript  y  1    subscript  y  2   normal-…   subscript  y  D     {y}_{1},{y}_{2},...,{y}_{D},   of consecutive bits with length    l  o  g   (  N  )       l  o  g  N    log(N)   .  Search for each    y  i     subscript  y  i    {y}_{i}   in the generated table which takes log time.  If you have a hit, this    y  i     subscript  y  i    {y}_{i}   corresponds to an internal state    x  i     subscript  x  i    {x}_{i}   of the bit generator from which you can forward run the generator to obtain the rest of the key.  By the Birthday Paradox , you are guaranteed that two subsets of a space with   N   N   N   points have an intersection if their sizes product is greater than   N   N   N   .   This result from the Birthday attack gives the condition     D  M   =  N        D  M   N    DM=N   with attack time    T  =  D      T  D    T=D   and preprocessing time    P  =  M      P  M    P=M   which is just a particular point on the tradeoff curve     T  M   =  N        T  M   N    TM=N   . We can generalize this relation if we ignore some of the available data at real time and we are able to reduce   T   T   T   from    T  =  D      T  D    T=D   to   1   1   1   and the general tradeoff curve eventually becomes     T  M   =  N        T  M   N    TM=N   with    1  ≤  T  ≤  D        1  T       D     1\leq T\leq D   and    P  =  M      P  M    P=M   .  Time/Memory/Data Tradeoff attack by A. Shamir and A. Biryukov on stream ciphers  8  This novel idea introduced in 2000 combines both techniques: Hellman tradeoff 9 and Babbage-and-Golic tradeoff 10 11 attacks to achieve a new tradeoff curve with better bounds for stream ciphers cryptoanalysis. You can apply Hellman's block cipher technique to stream cipher by using the same idea of covering the   N   N   N   points space through matrices obtained from multiple variants    f  i     subscript  f  i    f_{i}   of the function   f   f   f   which is the mapping of internal states to output prefixes. Recall that this tradeoff attack on stream cipher is successful if any of the given   D   D   D   output prefixes is found in any of the matrices covering   N   N   N   . Therefore, we can cut the number of covered points by the matrices from   N   N   N   to    N  /  D      N  D    N/D   points. This is done by reducing the number of matrices from   t   t   t   to    t  /  D      t  D    t/D   while keeping   m   m   m   as large as possible (but this requires    t  ≥  D      t  D    t\geq D   to have at least one table). For this new attack, we have    M  =    m  t   /  D       M      m  t   D     M=mt/D   because we reduced the number of matrices to    t  /  D      t  D    t/D   and the same for the preprocessing time    P  =   N  /  D       P    N  D     P=N/D   . The realtime required for the attack is    T  =    (   t  /  D   )    \sdot   t   \sdot   D   =   t  2         T      t  D   \sdot  t  \sdot  D         superscript  t  2      T=(t/D)\sdot t\sdot D=t^{2}   which is the product of the number of matrices, length of each iteration and number of available data points at attack time.  Eventually, we again use the matrix stopping rule to obtain the tradeoff curve     T   M  2    D  2    =    t  2    \sdot    (     m  2    t  2    /   D  2    )    \sdot    D  2    =    m  2    t  4    =   N  2           T   superscript  M  2    superscript  D  2       superscript  t  2   \sdot       superscript  m  2    superscript  t  2     superscript  D  2    \sdot   superscript  D  2            superscript  m  2    superscript  t  4          superscript  N  2      TM^{2}D^{2}=t^{2}\sdot(m^{2}t^{2}/D^{2})\sdot D^{2}=m^{2}t^{4}=N^{2}   for     D  2   ≤  T  ≤  N         superscript  D  2   T       N     D^{2}\leq T\leq N   (because    t  ≥  D      t  D    t\geq D   ).  Tradeoff attacks on stream ciphers with low sampling resistance 12 13  This attack was invented by Biryukov , Shamir , Wagner . The idea relies on the following feature of various stream ciphers: the bit generator undergoes only few changes in its internal state before producing the next output bit. Therefore, we can enumerate those special states that generate   k   k   k   zero bits for small values of   k   k   k   at low cost. But when forcing large number of output bits to take specific values, this enumeration process become very expensive and difficult. Now, we can define the sampling resistance of a stream cipher to be    R  =   2   -  k        R   superscript  2    k      R=2^{-k}   with   k   k   k   the maximum value which makes such enumeration feasible.  Let the stream cipher be of    N  =   2  n       N   superscript  2  n     N=2^{n}   states each has a full name of   n   n   n   bits and a corresponding output name which is the first   n   n   n   bits in the output sequence of bits. If this stream cipher has sampling resistance    R  =   2   -  k        R   superscript  2    k      R=2^{-k}   , then an efficient enumeration can use a short name of    n  -  k      n  k    n-k   bits to define the special states of the generator. Each special state with    n  -  k      n  k    n-k    short name has a corresponding short output name of    n  -  k      n  k    n-k   bits which is the output sequence of the special state after removing the first   k   k   k   leading bits. Now, we are able to define a new mapping over a reduced space of     N  R   =   2   n  -  k          N  R    superscript  2    n  k      NR=2^{n-k}   points and this mapping is equivalent to the original mapping. If we let     D  R   ≥  1        D  R   1    DR\geq 1   , the realtime data available to the attacker is guaranteed to have at least one output of those special states. Otherwise, we relax the definition of special states to include more points. If we substitute for   D   D   D   by    D  R      D  R    DR   and   N   N   N   by    N  R      N  R    NR   in the new time/memory/data tradeoff attack by Shamir and Biryukov, we obtain the same tradeoff curve     T   M  2    D  2    =   N  2         T   superscript  M  2    superscript  D  2     superscript  N  2     TM^{2}D^{2}=N^{2}   but with      (   D  R   )   2   ≤  T  ≤   N  R          superscript    D  R   2   T         N  R      (DR)^{2}\leq T\leq NR   . This is actually an improvement since we could relax the lower bound on   T   T   T   since     (   D  R   )   2     superscript    D  R   2    (DR)^{2}   can be small up to   1   1   1   which means that our attack can be made faster. Another advantage of this technique is that we reduced the number of expensive disk access operations from   t   t   t   to    t  R      t  R    tR   since we will be accessing only the special    D  R      D  R    DR   points. And this also can greatly make our attack faster because of the reduced number of expensive disk operations.  References  "  Cryptographic attacks     Hellman, M.E., [ http://ieeexplore.ieee.org/stamp/stamp.jsp?tp =&arnumber;=1056220&isnumber;=22715&tag;=1 "A cryptanalytic time-memory trade-off,"] Information Theory, IEEE Transactions on , vol.26, no.4, pp.401,406, Jul 1980 ↩  Babbage, S. H., [ http://ieeexplore.ieee.org/stamp/stamp.jsp?tp =&arnumber;=491713&isnumber;=10615 "Improved “exhaustive search” attacks on stream ciphers,"] Security and Detection, 1995., European Convention on , vol., no., pp.161-166, 16–18 May 1995 ↩  Golic, J., [ http://download.springer.com/static/pdf/148/bok%253A978-3-540-69053-5.pdf?auth66=1401110566_72da97c839c322d7c836aef0143383ef&ext; ;=.pdf "Cryptanalysis of Alleged A5 Stream Cipher"] Lecture Notes in Computer Science, Advances in Cryptology — EUROCRYPT ’97, LNCS 1233, pp.239-255, Springer-Verlag 1997 ↩      Biryukov A., Shamir A., [ http://download.springer.com/static/pdf/172/bok%253A978-3-540-44448-0.pdf?auth66=1401110102_dc9d0e992866dc89d3e0ce609a8be048&ext; ;=.pdf "Cryptanalytic Time/Memory/Data Tradeoffs for Stream Ciphers"] Lecture Notes in Computer Science, Advances in Cryptology — ASIACRYPT 2000, LNCS 1976, pp.1-13, Springer-Verlag Berlin Heidelberg 2000 ↩      Biryukov A., Shamir A., Wagner D., [ http://download.springer.com/static/pdf/727/chp%253A10.1007%252F3-540-44706-7_1.pdf?auth66=1401140883_a1cfca3494421690d3d980db71300870&ext; ;=.pdf "Real Time Cryptanalysis of A5/1 on a PC"] Fast Software Encryption 2000, pp.1-18, Springer-Verlag 2000 ↩     
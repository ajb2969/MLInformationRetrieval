   Hidden Field Equations      Hidden Field Equations   Hidden Fields Equations (HFE) is a public key  cryptosystem which was introduced at Eurocrypt in 1996 and proposed by Jacques Patarin following the idea of the Matsumoto and Imai system. HFE is also known as HFE trapdoor function. It is based on polynomials over finite fields     ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   of different size to disguise the relationship between the private key and public key . HFE is in fact a family which consists of basic HFE and combinatorial versions of HFE. The HFE family of cryptosystems is based on the hardness of the problem of finding solutions to a system of multivariate quadratic equations (the so-called MQ problem) since it uses private affine transformations to hide the extension field and the private polynomials . Hidden Field Equations also have been used to construct digital signature schemes, e.g. Quartz and Sflash. 1  Mathematical background  One of the central notions to understand how Hidden Field Equations work is to see that for two extension fields    ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}       ğ”½   q  m      subscript  ğ”½   superscript  q  m     \mathbb{F}_{q^{m}}   over the same base field    ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   one can interpret a system of   m   m   m   multivariate polynomials in   n   n   n   variables over    ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   as a function     ğ”½   q  n    â†’   ğ”½   q  m       normal-â†’   subscript  ğ”½   superscript  q  n     subscript  ğ”½   superscript  q  m      \mathbb{F}_{q^{n}}\to\mathbb{F}_{q^{m}}   by using a suitable basis of    ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   over    ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   . In almost all applications the polynomials are quadratic, i.e. they have degree 2. 2 We start with the simplest kind of polynomials, namely monomials, and show how they lead to quadratic systems of equations.  Let us consider a finite field     ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   , where   q   q   q   is a power of 2, and an extension field   K   K   K   . Let     Î²  1   ,  â€¦  ,   Î²  n       subscript  Î²  1   normal-â€¦   subscript  Î²  n     \beta_{1},...,\beta_{n}   to be a basis of   K   K   K   as an    ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}    vector space . Let   Î¸   Î¸   \theta   for some     (  h  ,    q  n   -  1   )   =  1       h     superscript  q  n   1    1    (h,q^{n}-1)=1   and gcd     u  âˆˆ   ğ”½   q  n        u   subscript  ğ”½   superscript  q  n      u\in\mathbb{F}_{q^{n}}   and take a random element   u   u   u   . We represent    u  =   (   u  1   ,  â€¦  ,   u  n   )       u    subscript  u  1   normal-â€¦   subscript  u  n      u=(u_{1},...,u_{n})   with respect to the basis as    v  âˆˆ   ğ”½   q  n        v   subscript  ğ”½   superscript  q  n      v\in\mathbb{F}_{q^{n}}   . Define    v  =     u   q  Î¸    u    (  1  )        v      superscript  u   superscript  q  Î¸    u   1     v=u^{q^{\theta}}u\ \ \ \ (1)   by       (  h  ,    q  n   -  1   )   =  1       h     superscript  q  n   1    1    (h,q^{n}-1)=1     The condition gcd     u  â†’   u  h      normal-â†’  u   superscript  u  h     u\to u^{h}   is equivalent to requiring that the map   K   K   K   on    u  â†’   u   h  â€²       normal-â†’  u   superscript  u   superscript  h  normal-â€²      u\to u^{h^{\prime}}   is one to one and its inverse is the map    h  â€²     superscript  h  normal-â€²    h^{\prime}   where     h   mod    q  n   -  1      modulo  h     superscript  q  n   1     h\ \bmod q^{n}-1   is the multiplicative inverse of    n  Ã—  n      n  n    n\times n   . Choose two secret affine transformation, i.e. two invertible    S  =   {   S   i  j    }       S    subscript  S    i  j       S=\{S_{ij}\}   matrices    T  =   {   T   i  j    }       T    subscript  T    i  j       T=\{T_{ij}\}   and    ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   with entries in    c  =   (   c  1   ,  â€¦  ,   c  n   )       c    subscript  c  1   normal-â€¦   subscript  c  n      c=(c_{1},...,c_{n})   and two vectors    d  =   (   d  1   ,  â€¦  ,   d  n   )       d    subscript  d  1   normal-â€¦   subscript  d  n      d=(d_{1},...,d_{n})   and   n   n   n   of length    ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   over   x   x   x   and define   y   y   y   and     u  =    S  x   +  c     v  =     T  y   +  d    (  2  )        formulae-sequence    u      S  x   c      v       T  y   d   2      u=Sx+c\ \ \ \ v=Ty+d\ \ \ \ (2)   via:       A   (  k  )    =   a   i  j    (  k  )         superscript  A  k    superscript   subscript  a    i  j    k     A^{(k)}={a_{ij}^{(k)}}     Let     Î²  1   ,  â€¦  ,   Î²  n       subscript  Î²  1   normal-â€¦   subscript  Î²  n     \beta_{1},...,\beta_{n}   be the matrix of linear transformation in the basis      Î²  i   q  k    =    âˆ‘   j  =  1   n     a   i  j   k    Î²  j      ,    a   i  j   k   âˆˆ   ğ”½  q       formulae-sequence     superscript   subscript  Î²  i    superscript  q  k      superscript   subscript     j  1    n      superscript   subscript  a    i  j    k    subscript  Î²  j         superscript   subscript  a    i  j    k    subscript  ğ”½  q      \beta_{i}^{q^{k}}=\sum_{j=1}^{n}a_{ij}^{k}\beta_{j},\ \ a_{ij}^{k}\in\mathbb{F%
 }_{q}   such that       1  â‰¤  i   ,   k  â‰¤  n      formulae-sequence    1  i     k  n     1\leq i,k\leq n     for       Î²  i    Î²  j    =    âˆ‘   l  =  1   n     m   i  j  l     Î²  l      ,    m   i  j  l    âˆˆ   ğ”½  q       formulae-sequence       subscript  Î²  i    subscript  Î²  j      superscript   subscript     l  1    n      subscript  m    i  j  l     subscript  Î²  l         subscript  m    i  j  l     subscript  ğ”½  q      \beta_{i}\beta_{j}=\sum_{l=1}^{n}m_{ijl}\beta_{l},\ \ m_{ijl}\in\mathbb{F}_{q}   . Write all products of basis elements in terms of the basis, i.e.:       1  â‰¤  i   ,   j  â‰¤  n      formulae-sequence    1  i     j  n     1\leq i,j\leq n     for each   n   n   n   . The system of    v  i     subscript  v  i    v_{i}   equations which is explicit in the    u  j     subscript  u  j    u_{j}   and quadratic in the    Î²  i     subscript  Î²  i    \beta_{i}   can be obtain by expanding (1) and equating to zero the coefficients of the     u  j   ,   v  i       subscript  u  j    subscript  v  i     u_{j},v_{i}   . By using the affine relations in (2) to replace the     x  k   ,   y  l       subscript  x  k    subscript  y  l     x_{k},y_{l}   with   n   n   n   , the system of    y  l     subscript  y  l    y_{l}   equations is linear in the    x  k     subscript  x  k    x_{k}   and of degree 2 in the   n   n   n   . Applying linear algebra it will give    y  l     subscript  y  l    y_{l}   explicit equations, one for each    x  k     subscript  x  k    x_{k}   as polynomials of degree 2 in the   P   P   P   . 3  Multivariate cryptosystem  The basic idea of the HFE family of using this as a multivariate cryptosystem is to build the secret key starting from a polynomial    x   x   x   in one unknown    ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   over some finite field     q  =  2      q  2    q=2   (normally value    ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   is used). This polynomial can be easily inverted over     P   (  x  )    =  y        P  x   y    P(x)=y   , i.e. it is feasible to find any solutions to the equation   P   P   P   when such solution exist. The secret transformation either decryption and/or signature is based on this inversion. As explained above   n   n   n   can be identified with a system of    (   p  1   ,  â€¦  ,   p  n   )      subscript  p  1   normal-â€¦   subscript  p  n     (p_{1},...,p_{n})   equations    (   p  1   ,  â€¦  ,   p  n   )      subscript  p  1   normal-â€¦   subscript  p  n     (p_{1},...,p_{n})   using a fixed basis. To build a cryptosystem the polynomial     ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   must be transformed so that the public information hides the original structure and prevents inversion. This is done by viewing the finite fields     ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   as a vector space over   S   S   S   and by choosing two linear affine transformations    T   T   T   and    (  S  ,  P  ,  T  )     S  P  T    (S,P,T)   . The triplet   P   P   P   constitute the private key. The private polynomial     ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   is defined over    (   p  1   ,  â€¦  ,   p  n   )      subscript  p  1   normal-â€¦   subscript  p  n     (p_{1},...,p_{n})   . 4 5 The public key is    (  S  ,  P  ,  T  )     S  P  T    (S,P,T)   . Below is the diagram for MQ-trapdoor     input  x   â†’  x  =    (   x  1   ,  â€¦  ,   x  n   )    â†’   secret  :  S     x  â€²    â†’   secret  :  P     y  â€²    â†’   secret  :  T    output  y        normal-â†’    input  x   x           subscript  x  1   normal-â€¦   subscript  x  n      normal-:  secret  S   normal-â†’    superscript  x  normal-â€²     normal-:  secret  P   normal-â†’    superscript  y  normal-â€²     normal-:  secret  T   normal-â†’   output  y      \text{input}x\to x=(x_{1},...,x_{n})\overset{\text{secret}:S}{\to}x^{\prime}%
 \overset{\text{secret}:P}{\to}y^{\prime}\overset{\text{secret}:T}{\to}\text{%
 output}y   in HFE     P   P   P     HFE polynomial  The private polynomial    d   d   d   with degree    ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   over     ğ”½   q  n     [  x  ]        subscript  ğ”½   superscript  q  n     delimited-[]  x     \mathbb{F}_{q^{n}}[x]   is an element of   P   P   P   . If the terms of polynomial     ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   have at most quadratic terms over   P   P   P   then it will keep the public polynomial small. 6 The case that    x    q   s  i    +   q   t  i        superscript  x     superscript  q   subscript  s  i     superscript  q   subscript  t  i       x^{q^{s_{i}}+q^{t_{i}}}   consists of monomials of the form   q   q   q   , i.e. with 2 powers of   P   P   P   in the exponent is the basic version of HFE , i.e.     P   (  x  )    =   âˆ‘    c  i    x    q   s  i    +   q   t  i              P  x        subscript  c  i    superscript  x     superscript  q   subscript  s  i     superscript  q   subscript  t  i          P(x)=\sum c_{i}x^{q^{s_{i}}+q^{t_{i}}}   is chosen as     d   d   d     The degree   d   d   d   of the polynomial is also known as security parameter and the bigger its value the better for security since the resulting set of quadratic equations resembles a randomly chosen set of quadratic equations. On the other side large   P   P   P   slows down the deciphering. Since   d   d   d   is a polynomial of degree at most   P   P   P   the inverse of    P   -  1      superscript  P    1     P^{-1}   , denoted by     d  2     (   ln  d   )    O   (  1  )      n  2    ğ”½  q        superscript  d  2    superscript    d     O  1     superscript  n  2    subscript  ğ”½  q     d^{2}(\ln d)^{O(1)}n^{2}\mathbb{F}_{q}   can be computed in   n   n   n   operations. 7  Encryption and decryption  The public key is given by the    (   p  1   ,  â€¦  ,   p  n   )      subscript  p  1   normal-â€¦   subscript  p  n     (p_{1},...,p_{n})   multivariate polynomials    ğ”½  q     subscript  ğ”½  q    \mathbb{F}_{q}   over   M   M   M   . It is thus necessary to transfer the message     ğ”½   q  n    â†’   ğ”½  q  n      normal-â†’   subscript  ğ”½   superscript  q  n     superscript   subscript  ğ”½  q   n     \mathbb{F}_{q^{n}}\to\mathbb{F}_{q}^{n}   from   M   M   M   in order to encrypt it, i.e. we assume that     (   x  1   ,  â€¦  ,   x  n   )   âˆˆ   ğ”½  q  n         subscript  x  1   normal-â€¦   subscript  x  n     superscript   subscript  ğ”½  q   n     (x_{1},...,x_{n})\in\mathbb{F}_{q}^{n}   is a vector   M   M   M   . To encrypt message    p  i     subscript  p  i    p_{i}   we evaluate each    (   x  1   ,  â€¦  ,   x  n   )      subscript  x  1   normal-â€¦   subscript  x  n     (x_{1},...,x_{n})   at     (    p  1    (   x  1   ,  â€¦  ,   x  n   )    ,    p  2    (   x  1   ,  â€¦  ,   x  n   )    ,  â€¦  ,    p  n    (   x  1   ,  â€¦  ,   x  n   )    )   âˆˆ   ğ”½  q  n           subscript  p  1     subscript  x  1   normal-â€¦   subscript  x  n        subscript  p  2     subscript  x  1   normal-â€¦   subscript  x  n     normal-â€¦     subscript  p  n     subscript  x  1   normal-â€¦   subscript  x  n       superscript   subscript  ğ”½  q   n     (p_{1}(x_{1},...,x_{n}),p_{2}(x_{1},...,x_{n}),...,p_{n}(x_{1},...,x_{n}))\in%
 \mathbb{F}_{q}^{n}   . The ciphertext is    S  ,  T  ,  P     S  T  P    S,T,P   .  To understand decryption let us express encryption in terms of    p  i     subscript  p  i    p_{i}   . Note that these are not available to the sender. By evaluating the   S   S   S   at the message we first apply    x  â€²     superscript  x  normal-â€²    x^{\prime}   , resulting in    x  â€²     superscript  x  normal-â€²    x^{\prime}   . At this point     ğ”½   q  n    â†’   ğ”½   q  n       normal-â†’    ğ”½   superscript  q  n     subscript  ğ”½   superscript  q  n      \mathbb{F}{q^{n}}\to\mathbb{F}_{q^{n}}   is transferred from   P   P   P   so we can apply the private polynomial    ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   which is over     y  â€²   âˆˆ   ğ”½   q  n         superscript  y  normal-â€²    subscript  ğ”½   superscript  q  n      y^{\prime}\in\mathbb{F}_{q^{n}}   and this result is denoted by    y  â€²     superscript  y  normal-â€²    y^{\prime}   . Once again,    (   y  1  â€²   ,  â€¦  ,   y  n  â€²   )      superscript   subscript  y  1   normal-â€²   normal-â€¦   superscript   subscript  y  n   normal-â€²     (y_{1}^{\prime},...,y_{n}^{\prime})   is transferred to the vector   T   T   T   and the transformation    y  âˆˆ   ğ”½   q  n        y   subscript  ğ”½   superscript  q  n      y\in\mathbb{F}_{q^{n}}   is applied and the final output     (   y  1   ,  â€¦  ,   y  n   )   âˆˆ   ğ”½  q  n         subscript  y  1   normal-â€¦   subscript  y  n     superscript   subscript  ğ”½  q   n     (y_{1},...,y_{n})\in\mathbb{F}_{q}^{n}   is produced from   y   y   y   .  To decrypt    (  S  ,  P  ,  T  )     S  P  T    (S,P,T)   , the above steps are done in reverse order. This is possible if the private key   S   S   S   is known. The crucial step in the deciphering is not the inversion of   T   T   T   and     P   (   x  â€²   )    =   y  â€²         P   superscript  x  normal-â€²     superscript  y  normal-â€²     P(x^{\prime})=y^{\prime}   but rather the computations of the solution of   P   P   P   . Since     X  â€²   =   (   x  1  â€²   ,  â€¦  ,   x  d  â€²   )   âˆˆ   ğ”½   q  n           superscript  X  normal-â€²     superscript   subscript  x  1   normal-â€²   normal-â€¦   superscript   subscript  x  d   normal-â€²          subscript  ğ”½   superscript  q  n       X^{\prime}=(x_{1}^{\prime},...,x_{d}^{\prime})\in\mathbb{F}_{q^{n}}   is not necessary a bijection, one may find more than one solution to this inversion (there exist at most d different solutions   P   P   P   since   r   r   r   is a polynomial of degree d). The redundancy denoted as   M   M   M   is added at the first step to the message   M   M   M   in order to select the right    X  â€²     superscript  X  normal-â€²    X^{\prime}   from the set of solutions    M   â†’   +  r    x   â†’   secret  :  S     x  â€²    â†’   secret  :  P     y  â€²    â†’   secret  :  T    y      M     r   normal-â†’   x    normal-:  secret  S   normal-â†’    superscript  x  normal-â€²     normal-:  secret  P   normal-â†’    superscript  y  normal-â€²     normal-:  secret  T   normal-â†’   y    M\overset{+r}{\to}x\overset{\text{secret}:S}{\to}x^{\prime}\overset{\text{%
 secret}:P}{\to}y^{\prime}\overset{\text{secret}:T}{\to}y   . 8 9 10 The diagram below shows the basic HFE for encryption.     f   f   f     HFE variations  Hidden Field Equations has four basic variations namely +,-,v and f and it is possible to combine them in various way. The basic principle is the following:   01. The + sign consists of linearity mixing of the public equations with some random equations.  02. The - sign is due to Adi Shamir and intends to remove the redundancy 'r' of the public equations.  03. The f sign consists of fixing some    ğ”½   q  n      subscript  ğ”½   superscript  q  n     \mathbb{F}_{q^{n}}   input variables of the public key.  04. The v sign is defined as a construction and sometimes quite complex such that the inverse of the function can be found only if some v of the variables called vinegar variables are fixed. This idea is due to Jacques Patarin.   The operations above preserve to some extent the trapdoor solvability of the function.  HFE- and HFEv are very useful in signature schemes as they prevent from slowing down the signature generation and also enhance the overall security of HFE whereas for encryption both HFE- and HFEv will lead to a rather slow decryption process so neither too many equations can be removed (HFE-) nor too many variables should be added (HFEv). Both HFE- and HFEv were used to obtain Quartz.  For encryption, the situation is better with HFE+ since the decryption process takes the same amount of time, however the public key has more equations than variables. 11 12  HFE attacks  There are two famous recent attacks on HFE:  Recover the Private Key (Shamir-Kipnis): The key point of this attack is to recover the private key as sparse univariate polynomials over the extension field $\mathbb{F}_{q^n}$ . The attack only works for basic HFE and fails for all its variations.  Fast GrÃ¶bner Bases (Faugere): The idea of Faugere's attacks is to use fast algorithm to compute a GrÃ¶bner basis of the system of polynomial equations. Faugere broke the HFE challenge 1 in 96 hours in 2002 and in 2003 Faugere and Joux worked together on the security of HFE. 13  References   Nicolas T. Courtouis, Magnus Daum and Patrick Felke, On the Security of HFE, HFEv- and Quartz  Andrey Sidorenko, Hidden Field Equations, EIDMA Seminar 2004 Technische Universiteit Eindhoven  Yvo G. Desmet, Public Key Cryptography-PKC 2003, ISBN 3-540-00324-X   "  Category:Public-key encryption schemes  Category:Finite fields  Category:Multivariate cryptography     Christopher Wolf and Bart Preneel, Asymmetric Cryptography: Hidden Field Equations â†©  Nicolas T. Courtois On Multivariate Signature-only public key cryptosystems â†©  Ilia Toli Hidden Polynomial Cryptosystems â†©   Jean Charles Faugere and Antoine Joux, Algebraic Cryptanalysis of Hidden Field Equations (HFE) Cryptosystems Using Grobner Bases â†©   Nicolas T. Courtois, "The Security of Hidden Field Equations" â†©    Jacques Patarin, Hidden Field Equations (HFE) and Isomorphic Polynomial (IP): two new families of asymmetric algorithm â†©        
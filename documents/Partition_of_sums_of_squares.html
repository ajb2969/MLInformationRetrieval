<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="364">Partition of sums of squares</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Partition of sums of squares</h1>
<hr/>

<p>The <strong>partition of sums of squares</strong> is a concept that permeates much of <a href="inferential_statistics" title="wikilink">inferential statistics</a> and <a href="descriptive_statistics" title="wikilink">descriptive statistics</a>. More properly, it is the <strong>partitioning of sums of <a href="squared_deviations" title="wikilink">squared deviations</a> or errors</strong>. Mathematically, the sum of squared deviations is an unscaled, or unadjusted measure of <a href="statistical_dispersion" title="wikilink">dispersion</a> (also called <a href="statistical_variability" title="wikilink">variability</a>). When scaled for the number of <a href="Degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a>, it estimates the <a class="uri" href="variance" title="wikilink">variance</a>, or spread of the observations about their mean value. Partitioning of the sum of squared deviations into various components allows the overall variability in a dataset to be ascribed to different types or sources of variability, with the relative importance of each being quantified by the size of each component of the overall sum of squares.</p>
<h2 id="background">Background</h2>

<p>The distance from any point in a collection of data, to the mean of the data, is the deviation. This can be written as 

<math display="inline" id="Partition_of_sums_of_squares:0">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo>-</mo>
   <mover accent="true">
    <mi>y</mi>
    <mo>¯</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <ci>normal-¯</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}-\overline{y}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Partition_of_sums_of_squares:1">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}
  </annotation>
 </semantics>
</math>

 is the ith data point, and 

<math display="inline" id="Partition_of_sums_of_squares:2">
 <semantics>
  <mover accent="true">
   <mi>y</mi>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{y}
  </annotation>
 </semantics>
</math>

 is the estimate of the mean. If all such deviations are squared, then summed, as in 

<math display="inline" id="Partition_of_sums_of_squares:3">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </msubsup>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <mpadded width="+1.7pt">
       <mover accent="true">
        <mi>y</mi>
        <mo>¯</mo>
       </mover>
      </mpadded>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <ci>y</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}\left(y_{i}-\overline{y}\,\right)^{2}
  </annotation>
 </semantics>
</math>


, this gives the "sum of squares" for these data.</p>

<p>When more data are added to the collection the sum of squares will increase, except in unlikely cases such as the new data being equal to the mean. So usually, the sum of squares will grow with the size of the data collection. That is a manifestation of the fact that it is unscaled.</p>

<p>In many cases, the number of <a href="degrees_of_freedom_(statistics)" title="wikilink">degrees of freedom</a> is simply the number of data in the collection, minus one. We write this as <em>n</em> − 1, where <em>n</em> is the number of data.</p>

<p>Scaling (also known as normalizing) means adjusting the sum of squares so that it does not grow as the size of the data collection grows. This is important when we want to compare samples of different sizes, such as a sample of 100 people compared to a sample of 20 people. If the sum of squares was not normalized, its value would always be larger for the sample of 100 people than for the sample of 20 people. To scale the sum of squares, we divide it by the degrees of freedom, i.e., calculate the sum of squares per degree of freedom, or variance. <a href="Standard_deviation" title="wikilink">Standard deviation</a>, in turn, is the square root of the variance.</p>

<p>The above information is how sum of squares is used in descriptive statistics; see the article on <a href="total_sum_of_squares" title="wikilink">total sum of squares</a> for an application of this broad principle to <a href="inferential_statistics" title="wikilink">inferential statistics</a>.</p>
<h2 id="partitioning-the-sum-of-squares-in-linear-regression">Partitioning the sum of squares in linear regression</h2>

<p><strong>Theorem.</strong> Given a linear regression model 

<math display="inline" id="Partition_of_sums_of_squares:4">
 <semantics>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>β</mi>
     <mn>0</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>i</mi>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>β</mi>
      <mi>p</mi>
     </msub>
     <msub>
      <mi>x</mi>
      <mrow>
       <mi>i</mi>
       <mi>p</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>ε</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>β</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>β</ci>
       <ci>p</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ε</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}=\beta_{0}+\beta_{1}x_{i1}+\cdots+\beta_{p}x_{ip}+\varepsilon_{i}
  </annotation>
 </semantics>
</math>

 <em>including a constant</em> based on a sample 

<math display="inline" id="Partition_of_sums_of_squares:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>i</mi>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>x</mi>
       <mrow>
        <mi>i</mi>
        <mi>p</mi>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo rspace="4.2pt">,</mo>
     <mi>i</mi>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <list>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>p</ci>
        </apply>
       </apply>
      </vector>
      <ci>i</ci>
     </list>
     <cn type="integer">1</cn>
    </apply>
    <list>
     <ci>normal-…</ci>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (y_{i},x_{i1},\ldots,x_{ip}),\,i=1,\ldots,n
  </annotation>
 </semantics>
</math>

 containing <em>n</em> observations, the Total Sum of Squares 

<math display="inline" id="Partition_of_sums_of_squares:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>S</mi>
    <mi>S</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <mover accent="true">
        <mi>y</mi>
        <mo stretchy="false">¯</mo>
       </mover>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>S</ci>
     <ci>S</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <ci>normal-¯</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   TSS=\sum_{i=1}^{n}(y_{i}-\bar{y})^{2}
  </annotation>
 </semantics>
</math>

 can be partitioned as follows into the <a href="explained_sum_of_squares" title="wikilink">explained sum of squares</a> (ESS) and the <a href="residual_sum_of_squares" title="wikilink">residual sum of squares</a> (RSS):</p>

<p>

<math display="block" id="Partition_of_sums_of_squares:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>TSS</mi>
    <mo>=</mo>
    <mrow>
     <mi>ESS</mi>
     <mo>+</mo>
     <mi>RSS</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>TSS</ci>
    <apply>
     <plus></plus>
     <ci>ESS</ci>
     <ci>RSS</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{TSS}=\mathrm{ESS}+\mathrm{RSS},
  </annotation>
 </semantics>
</math>

 where this equation is equivalent to each of the following forms:</p>

<p>

<math display="inline" id="Partition_of_sums_of_squares:8">
 <semantics>
  <msup>
   <mrow>
    <mo>∥</mo>
    <mrow>
     <mi>y</mi>
     <mo>-</mo>
     <mrow>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mn>𝟏</mn>
     </mrow>
    </mrow>
    <mo>∥</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <apply>
      <minus></minus>
      <ci>y</ci>
      <apply>
       <times></times>
       <apply>
        <ci>normal-¯</ci>
        <ci>y</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\left\|y-\bar{y}\mathbf{1}\right\|^{2}
  </annotation>
 </semantics>
</math>


</p>
<h3 id="proof">Proof</h3>

<p>

<math display="inline" id="Partition_of_sums_of_squares:9">
 <semantics>
  <mrow>
   <mstyle displaystyle="true">
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
   </mstyle>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <mover accent="true">
       <mi>y</mi>
       <mo>¯</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <ci>y</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\sum_{i=1}^{n}(y_{i}-\overline{y})^{2}
  </annotation>
 </semantics>
</math>


</p>

<p>The requirement that the model includes a constant or equivalently that the design matrix contains a column of ones ensures that 

<math display="inline" id="Partition_of_sums_of_squares:10">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <msub>
     <mover accent="true">
      <mi>ε</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-^</ci>
       <ci>ε</ci>
      </apply>
      <ci>i</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=1}^{n}\hat{\varepsilon}_{i}=0
  </annotation>
 </semantics>
</math>

.</p>

<p>Some readers may find the following version of the proof, set in vector form, more enlightening:</p>

<p>

<math display="inline" id="Partition_of_sums_of_squares:11">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mrow>
       <mi>S</mi>
       <msub>
        <mi>S</mi>
        <mtext>total</mtext>
       </msub>
      </mrow>
      <mo>=</mo>
      <msup>
       <mrow>
        <mo>∥</mo>
        <mrow>
         <mi>𝐲</mi>
         <mo>-</mo>
         <mover accent="true">
          <mi>𝐲</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo>∥</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <msup>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mrow>
           <mrow>
            <mi>𝐲</mi>
            <mo>-</mo>
            <mover accent="true">
             <mi>𝐲</mi>
             <mo stretchy="false">¯</mo>
            </mover>
           </mrow>
           <mo>+</mo>
           <mover accent="true">
            <mi>𝐲</mi>
            <mo stretchy="false">^</mo>
           </mover>
          </mrow>
          <mo>-</mo>
          <mover accent="true">
           <mi>𝐲</mi>
           <mo stretchy="false">^</mo>
          </mover>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <msup>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mover accent="true">
             <mi>𝐲</mi>
             <mo stretchy="false">^</mo>
            </mover>
            <mo>-</mo>
            <mover accent="true">
             <mi>𝐲</mi>
             <mo stretchy="false">¯</mo>
            </mover>
           </mrow>
           <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mi>𝐲</mi>
            <mo>-</mo>
            <mover accent="true">
             <mi>𝐲</mi>
             <mo stretchy="false">^</mo>
            </mover>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <mrow>
        <msup>
         <mrow>
          <mo>∥</mo>
          <mrow>
           <mover accent="true">
            <mi>𝐲</mi>
            <mo stretchy="false">^</mo>
           </mover>
           <mo>-</mo>
           <mover accent="true">
            <mi>𝐲</mi>
            <mo stretchy="false">¯</mo>
           </mover>
          </mrow>
          <mo>∥</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mrow>
          <mo>∥</mo>
          <mover accent="true">
           <mi>ε</mi>
           <mo stretchy="false">^</mo>
          </mover>
          <mo>∥</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <msup>
          <mover accent="true">
           <mi>ε</mi>
           <mo stretchy="false">^</mo>
          </mover>
          <mi>T</mi>
         </msup>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mover accent="true">
            <mi>𝐲</mi>
            <mo stretchy="false">^</mo>
           </mover>
           <mo>-</mo>
           <mover accent="true">
            <mi>𝐲</mi>
            <mo stretchy="false">¯</mo>
           </mover>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <mrow>
        <mrow>
         <mi>S</mi>
         <msub>
          <mi>S</mi>
          <mtext>regression</mtext>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>S</mi>
         <msub>
          <mi>S</mi>
          <mtext>error</mtext>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <msup>
          <mover accent="true">
           <mi>ε</mi>
           <mo stretchy="false">^</mo>
          </mover>
          <mi>T</mi>
         </msup>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mrow>
            <mi>X</mi>
            <mover accent="true">
             <mi>β</mi>
             <mo stretchy="false">^</mo>
            </mover>
           </mrow>
           <mo>-</mo>
           <mover accent="true">
            <mi>𝐲</mi>
            <mo stretchy="false">¯</mo>
           </mover>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <mrow>
        <mrow>
         <mrow>
          <mi>S</mi>
          <msub>
           <mi>S</mi>
           <mtext>regression</mtext>
          </msub>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mi>S</mi>
          <msub>
           <mi>S</mi>
           <mtext>error</mtext>
          </msub>
         </mrow>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msup>
             <mover accent="true">
              <mi>ε</mi>
              <mo stretchy="false">^</mo>
             </mover>
             <mi>T</mi>
            </msup>
            <mi>X</mi>
           </mrow>
           <mo>)</mo>
          </mrow>
          <mover accent="true">
           <mi>β</mi>
           <mo stretchy="false">^</mo>
          </mover>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <msup>
          <mover accent="true">
           <mi>ε</mi>
           <mo stretchy="false">^</mo>
          </mover>
          <mi>T</mi>
         </msup>
         <mover accent="true">
          <mi>𝐲</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
       </mrow>
      </mrow>
      <mo>,</mo>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi></mi>
       <mo>=</mo>
       <mrow>
        <mrow>
         <mi>S</mi>
         <msub>
          <mi>S</mi>
          <mtext>regression</mtext>
         </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>S</mi>
         <msub>
          <mi>S</mi>
          <mtext>error</mtext>
         </msub>
        </mrow>
       </mrow>
      </mrow>
      <mo>.</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <times></times>
       <ci>S</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <mtext>total</mtext>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>𝐲</ci>
         <apply>
          <ci>normal-¯</ci>
          <ci>𝐲</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <ci>𝐲</ci>
           <apply>
            <ci>normal-¯</ci>
            <ci>𝐲</ci>
           </apply>
          </apply>
          <apply>
           <ci>normal-^</ci>
           <ci>𝐲</ci>
          </apply>
         </apply>
         <apply>
          <ci>normal-^</ci>
          <ci>𝐲</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-^</ci>
           <ci>𝐲</ci>
          </apply>
          <apply>
           <ci>normal-¯</ci>
           <ci>𝐲</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <ci>𝐲</ci>
          <apply>
           <ci>normal-^</ci>
           <ci>𝐲</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <ci>normal-^</ci>
           <ci>𝐲</ci>
          </apply>
          <apply>
           <ci>normal-¯</ci>
           <ci>𝐲</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>ε</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>ε</ci>
         </apply>
         <ci>T</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <ci>normal-^</ci>
          <ci>𝐲</ci>
         </apply>
         <apply>
          <ci>normal-¯</ci>
          <ci>𝐲</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <mtext>regression</mtext>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <mtext>error</mtext>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>ε</ci>
         </apply>
         <ci>T</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>X</ci>
          <apply>
           <ci>normal-^</ci>
           <ci>β</ci>
          </apply>
         </apply>
         <apply>
          <ci>normal-¯</ci>
          <ci>𝐲</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>S</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>S</ci>
          <mtext>regression</mtext>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>S</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>S</ci>
          <mtext>error</mtext>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <ci>normal-^</ci>
            <ci>ε</ci>
           </apply>
           <ci>T</ci>
          </apply>
          <ci>X</ci>
         </apply>
         <apply>
          <ci>normal-^</ci>
          <ci>β</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <ci>normal-^</ci>
          <ci>ε</ci>
         </apply>
         <ci>T</ci>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>𝐲</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <apply>
      <eq></eq>
      <csymbol cd="latexml">absent</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <mtext>regression</mtext>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>S</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <mtext>error</mtext>
        </apply>
       </apply>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{aligned}\displaystyle SS_{{\text{total}}}=\|{{\mathbf{y}}-\bar{\mathbf{%
y}}}\|^{2}&\displaystyle=\|{{\mathbf{y}}-\bar{\mathbf{y}}+{\mathbf{\hat{y}}}-{%
\mathbf{\hat{y}}}}\|^{2},\\
&\displaystyle=\|{\left({{\mathbf{\hat{y}}}-\bar{\mathbf{y}}}\right)+\left({{%
\mathbf{y}}-{\mathbf{\hat{y}}}}\right)}\|^{2},\\
&\displaystyle=\|{{\mathbf{\hat{y}}}-\bar{\mathbf{y}}}\|^{2}+\|{\hat{%
\varepsilon}}\|^{2}+2{\hat{\varepsilon}}^{T}\left({{\mathbf{\hat{y}}}-\bar{%
\mathbf{y}}}\right),\\
&\displaystyle=SS_{{\text{regression}}}+SS_{{\text{error}}}+2{\hat{\varepsilon%
}}^{T}\left({X{\hat{\beta}}-\bar{\mathbf{y}}}\right),\\
&\displaystyle=SS_{{\text{regression}}}+SS_{{\text{error}}}+2\left({\hat{%
\varepsilon}^{T}X}\right){\hat{\beta}-}2{\hat{\varepsilon}}^{T}{\bar{\mathbf{y%
}}},\\
&\displaystyle=SS_{{\text{regression}}}+SS_{{\text{error}}}.\\
\end{aligned}
  </annotation>
 </semantics>
</math>

</p>

<p>The elimination of terms in the last line, used the fact that</p>

<p>

<math display="block" id="Partition_of_sums_of_squares:12">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mover accent="true">
      <mi>ε</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mi>T</mi>
    </msup>
    <mi>X</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>𝐲</mi>
       <mo>-</mo>
       <mover accent="true">
        <mi>𝐲</mi>
        <mo stretchy="false">^</mo>
       </mover>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>T</mi>
    </msup>
    <mi>X</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐲</mi>
     <mi>T</mi>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>I</mi>
      <mo>-</mo>
      <mrow>
       <mi>X</mi>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msup>
           <mi>X</mi>
           <mi>T</mi>
          </msup>
          <mi>X</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <msup>
        <mi>X</mi>
        <mi>T</mi>
       </msup>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>X</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐲</mi>
     <mi>T</mi>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>X</mi>
      <mo>-</mo>
      <mi>X</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-^</ci>
        <ci>ε</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <ci>X</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐲</ci>
        <apply>
         <ci>normal-^</ci>
         <ci>𝐲</ci>
        </apply>
       </apply>
       <ci>T</ci>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐲</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>I</ci>
       <apply>
        <times></times>
        <ci>X</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>X</ci>
           <ci>T</ci>
          </apply>
          <ci>X</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <ci>T</ci>
        </apply>
       </apply>
      </apply>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐲</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>X</ci>
       <ci>X</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\varepsilon}^{T}X=\left({\mathbf{y}}-{\mathbf{\hat{y}}}\right)^{T}X={%
\mathbf{y}}^{T}\left({I-X\left({X^{T}X}\right)^{-1}X^{T}}\right)X={\mathbf{y}}%
^{T}\left(X-X\right)={\mathbf{0}}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="further-partitioning">Further partitioning</h3>

<p>Note that the residual sum of squares can be further partitioned as the <a href="lack-of-fit_sum_of_squares" title="wikilink">lack-of-fit sum of squares</a> plus the sum of squares due to pure error.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Inner-product_space" title="wikilink">Inner-product space</a>
<ul>
<li><a href="Hilbert_space" title="wikilink">Hilbert space</a>
<ul>
<li><a href="Euclidean_space" title="wikilink">Euclidean space</a></li>
</ul></li>
<li><a class="uri" href="Orthogonality" title="wikilink">Orthogonality</a></li>
<li><a href="Orthonormal_basis" title="wikilink">Orthonormal basis</a>
<ul>
<li><a href="Orthogonal_complement" title="wikilink">Orthogonal complement</a>, the closed subspace orthogonal to a set (especially a subspace)</li>
<li><a href="Orthomodular_lattice" title="wikilink">Orthomodular lattice</a> of the subspaces of an inner-product space</li>
<li><a href="Orthogonal_projection" title="wikilink">Orthogonal projection</a></li>
</ul></li>
<li><a href="Pythagorean_theorem" title="wikilink">Pythagorean theorem</a> that the sum of the squared norms of orthogonal summands equals the squared norm of the sum.</li>
</ul></li>
<li><a href="Least_squares" title="wikilink">Least squares</a></li>
<li><a href="Mean_squared_error" title="wikilink">Mean squared error</a></li>
<li><a href="Squared_deviations" title="wikilink">Squared deviations</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>

<p>Pre-publication chapters are available on-line.</p></li>
<li></li>
<li>
<dl>
<dd>Republished as: 
</dd>
</dl></li>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Analysis_of_variance" title="wikilink">Category:Analysis of variance</a> <a href="Category:Regression_analysis" title="wikilink">Category:Regression analysis</a> <a href="Category:Least_squares" title="wikilink">Category:Least squares</a></p>
</body>
</html>

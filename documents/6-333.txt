   Recurrence quantification analysis      Recurrence quantification analysis   Recurrence quantification analysis (RQA) is a method of nonlinear  data analysis (cf. chaos theory ) for the investigation of dynamical systems . It quantifies the number and duration of recurrences of a dynamical system presented by its phase space trajectory.  Background  The recurrence quantification analysis was developed in order to quantify differently appearing recurrence plots (RPs) based on the small-scale structures therein. Recurrence plots are tools which visualise the recurrence behaviour of the phase space trajectory of dynamical systems . They mostly contain single dots and lines which are parallel to the mean diagonal ( line of identity , LOI) or which are vertical/horizontal. Lines parallel to the LOI are referred to as diagonal lines and the vertical structures as vertical lines . Because an RP is usually symmetric, horizontal and vertical lines correspond to each other, and, hence, only vertical lines are considered. The lines correspond to a typical behaviour of the phase space trajectory: whereas the diagonal lines represent such segments of the phase space trajectory which run parallel for some time, the vertical lines represent segments which remain in the same phase space region for some time.  If only a time series is available, the phase space can be reconstructed by using a time delay embedding (see Takens' theorem ):       x  ‚Üí    (  i  )   =   (  u   (  i  )   ,  u   (  i  +  œÑ  )   ,  ‚Ä¶  ,  u   (  i  +  œÑ   (  m  -  1  )   )   ,      fragments   normal-‚Üí  x    fragments  normal-(  i  normal-)     fragments  normal-(  u   fragments  normal-(  i  normal-)   normal-,  u   fragments  normal-(  i   œÑ  normal-)   normal-,  normal-‚Ä¶  normal-,  u   fragments  normal-(  i   œÑ   fragments  normal-(  m   1  normal-)   normal-)   normal-,     \vec{x}(i)=(u(i),u(i+\tau),\ldots,u(i+\tau(m-1)),     where    u   (  i  )       u  i    u(i)   is the time series,   m   m   m   the embedding dimension and   œÑ   œÑ   \tau   the time delay.  The RQA quantifies the small-scale structures of recurrence plots, which present the number and duration of the recurrences of a dynamical system. The measures introduced for the RQA were developed heuristically between 1992 and 2002 (Zbilut & Webber 1992; Webber & Zbilut 1994; Marwan et al. 2002). They are actually measures of complexity . The main advantage of the recurrence quantification analysis is that it can provide useful information even for short and non-stationary data, where other methods fail.  RQA can be applied to almost every kind of data. It is widely used in physiology , but was also successfully applied on problems from engineering , chemistry , Earth sciences etc.  RQA measures  The simplest measure is the recurrence rate , which is the density of recurrence points in a recurrence plot:       RR  =    1   N  2      ‚àë    i  ,  j   =  1   N    ùêë   (  i  ,  j  )       .      RR      1   superscript  N  2      superscript   subscript      i  j   1    N     ùêë   i  j        \text{RR}=\frac{1}{N^{2}}\sum_{i,j=1}^{N}\mathbf{R}(i,j).     The recurrence rate corresponds with the probability that a specific state will recur. It is almost equal with the definition of the correlation sum , where the LOI is excluded from the computation.  The next measure is the percentage of recurrence points which form diagonal lines in the recurrence plot of minimal length    ‚Ñì  min     subscript  normal-‚Ñì     \ell_{\min}   :       DET  =     ‚àë   ‚Ñì  =   ‚Ñì  min    N     ‚Ñì   P   (  ‚Ñì  )       ‚àë    i  ,  j   =  1   N    R   (  i  ,  j  )       ,      DET      superscript   subscript     normal-‚Ñì   subscript  normal-‚Ñì      N     normal-‚Ñì  P  normal-‚Ñì      superscript   subscript      i  j   1    N     R   i  j        \text{DET}=\frac{\sum_{\ell=\ell_{\min}}^{N}\ell\,P(\ell)}{\sum_{i,j=1}^{N}R(i%
 ,j)},     where    P   (  ‚Ñì  )       P  normal-‚Ñì    P(\ell)   is the frequency distribution of the lengths   ‚Ñì   normal-‚Ñì   \ell   of the diagonal lines. This measure is called determinism and is related with the predictability of the dynamical system , because white noise has a recurrence plot with almost only single dots and very few diagonal lines, whereas a deterministic process has a recurrence plot with very few single dots but many long diagonal lines.  The amount of recurrence points which form vertical lines can be quantified in the same way:       LAM  =     ‚àë   v  =   v  min    N    v  P   (  v  )       ‚àë   v  =  1   N    v  P   (  v  )       ,      LAM      superscript   subscript     v   subscript  v      N     v  P  v      superscript   subscript     v  1    N     v  P  v       \text{LAM}=\frac{\sum_{v=v_{\min}}^{N}vP(v)}{\sum_{v=1}^{N}vP(v)},     where    P   (  v  )       P  v    P(v)   is the frequency distribution of the lengths   v   v   v   of the vertical lines, which have at least a length of    v  min     subscript  v     v_{\min}   . This measure is called laminarity and is related with the amount of laminar phases in the system ( intermittency ).  The lengths of the diagonal and vertical lines can be measured as well. The averaged diagonal line length      L  =     ‚àë   ‚Ñì  =   ‚Ñì  min    N     ‚Ñì   P   (  ‚Ñì  )       ‚àë   ‚Ñì  =   ‚Ñì  min    N    P   (  ‚Ñì  )          L      superscript   subscript     normal-‚Ñì   subscript  normal-‚Ñì      N     normal-‚Ñì  P  normal-‚Ñì      superscript   subscript     normal-‚Ñì   subscript  normal-‚Ñì      N     P  normal-‚Ñì       \text{L}=\frac{\sum_{\ell=\ell_{\min}}^{N}\ell\,P(\ell)}{\sum_{\ell=\ell_{\min%
 }}^{N}P(\ell)}     is related with the predictability time of the dynamical system and the trapping time , measuring the average length of the vertical lines,       T  T   =     ‚àë   v  =   v  min    N    v  P   (  v  )       ‚àë   v  =   v  min    N    P   (  v  )            T  T       superscript   subscript     v   subscript  v      N     v  P  v      superscript   subscript     v   subscript  v      N     P  v       TT=\frac{\sum_{v=v_{\min}}^{N}vP(v)}{\sum_{v=v_{\min}}^{N}P(v)}     is related with the laminarity time of the dynamical system, i.e. how long the system remains in a specific state.  Because the length of the diagonal lines is related on the time how long segments of the phase space trajectory run parallel, i.e. on the divergence behaviour of the trajectories, it was sometimes stated that the reciprocal of the maximal length of the diagonal lines (without LOI) would be an estimator for the positive maximal Lyapunov exponent of the dynamical system. Therefore, the maximal diagonal line length     L  max     subscript  L     L_{\max}   or the divergence       D  I  V   =   1   L  max          D  I  V     1   subscript  L       DIV=\frac{1}{L_{\max}}     are also measures of the RQA. However, the relationship between these measures with the positive maximal Lyapunov exponent is not as easy as stated, but even more complex (to calculate the Lyapunov exponent from an RP, the whole frequency distribution of the diagonal lines has to be considered). The divergence can have the trend of the positive maximal Lyapunov exponent, but not more. Moreover, also RPs of white noise processes can have a really long diagonal line, although very seldom, just by a finite probability. It is obvious that therefore the divergence cannot reflect the maximal Lyapunov exponent.  The probability     p   (  ‚Ñì  )       p  normal-‚Ñì    p(\ell)   that a diagonal line has exactly length   ‚Ñì   normal-‚Ñì   \ell   can be estimated from the frequency distribution    P   (  ‚Ñì  )       P  normal-‚Ñì    P(\ell)   with     p   (  ‚Ñì  )    =    P   (  ‚Ñì  )       ‚àë   ‚Ñì  =   l  min    N     P   (  ‚Ñì  )            p  normal-‚Ñì       P  normal-‚Ñì     superscript   subscript     normal-‚Ñì   subscript  l      N     P  normal-‚Ñì       p(\ell)=\frac{P(\ell)}{\sum_{\ell=l_{\min}}^{N}P(\ell)}   . The Shannon entropy of this probability,       ENTR  =   -    ‚àë   ‚Ñì  =   ‚Ñì  min    N    p   (  ‚Ñì  )    ln  p    (  ‚Ñì  )       ,      ENTR      superscript   subscript     normal-‚Ñì   subscript  normal-‚Ñì      N     p  normal-‚Ñì    p   normal-‚Ñì       \text{ENTR}=-\sum_{\ell=\ell_{\min}}^{N}p(\ell)\ln p(\ell),     reflects the complexity of the deterministic structure in the system. However, this entropy depends sensitively on the bin number and, thus, may differ for different realisations of the same process, as well as for different data preparations.  The last measure of the RQA quantifies the thinning-out of the recurrence plot. The trend is the regression coefficient of a linear relationship between the density of recurrence points in a line parallel to the LOI and its distance to the LOI. More exactly, let us consider the recurrence rate in a diagonal line parallel to LOI of distance k ( diagonal-wise recurrence rate ):        RR  k   =    1   N  -  k      ‚àë    j  -  i   =  k    N  -  k     ùêë   (  i  ,  j  )       ,       subscript  RR  k       1    N  k      superscript   subscript       j  i   k      N  k      ùêë   i  j        \text{RR}_{k}=\frac{1}{N-k}\sum_{j-i=k}^{N-k}\mathbf{R}(i,j),     then the trend is defined by       TREND  =     ‚àë   i  =  1    N  ~      (   i  -    N  ~   /  2    )    (    R   R  i    -   ‚ü®   R   R  i    ‚ü©    )       ‚àë   i  =  1    N  ~      (   i  -    N  ~   /  2    )   2      ,      TREND      superscript   subscript     i  1     normal-~  N        i     normal-~  N   2        R   subscript  R  i     delimited-‚ü®‚ü©    R   subscript  R  i          superscript   subscript     i  1     normal-~  N     superscript    i     normal-~  N   2    2       \text{TREND}=\frac{\sum_{i=1}^{\tilde{N}}(i-\tilde{N}/2)(RR_{i}-\langle RR_{i}%
 \rangle)}{\sum_{i=1}^{\tilde{N}}(i-\tilde{N}/2)^{2}},     with    ‚ü®  ‚ãÖ  ‚ü©     delimited-‚ü®‚ü©  normal-‚ãÖ    \langle\cdot\rangle   as the average value and     N  ~   <  N       normal-~  N   N    \tilde{N}   . This latter relation should ensure to avoid the edge effects of too low recurrence point densities in the edges of the recurrence plot. The measure trend provides information about the stationarity of the system.  Similar to the diagonal-wise defined recurrence rate, the other measures based on the diagonal lines (DET, L, ENTR) can be defined diagonal-wise. These definitions are useful to study interrelations or synchronisation between different systems (using recurrence plots or cross recurrence plots ).  Time-dependent RQA  Instead of computing the RQA measures of the entire recurrence plot, they can be computed in small windows moving over the recurrence plot along the LOI. This provides time-dependent RQA measures which allow detecting, e.g., chaos-chaos transitions (Marwan et al. 2002). Note: the choice of the size of the window can strongly influence the measure trend .  Example  (Figure)  Bifurcation diagram for the Logistic map.     See also   Recurrence plot , a powerful visualisation tool of recurrences in dynamical (and other) systems.  Approximate entropy   References          External links   http://www.recurrence-plot.tk/  http://www.scitopics.com/Recurrence_Quantification_Analysis.html   "  Category:Signal processing  Category:Dynamical systems  Category:Chaos theory  Category:Nonlinear time series analysis   
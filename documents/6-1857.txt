   Adjunction formula      Adjunction formula   In mathematics , especially in algebraic geometry and the theory of complex manifolds , the adjunction formula relates the canonical bundle of a variety and a hypersurface inside that variety. It is often used to deduce facts about varieties embedded in well-behaved spaces such as projective space or to prove theorems by induction.  Adjunction for smooth varieties  Formula for a smooth subvariety  Let X be a smooth algebraic variety or smooth complex manifold and Y be a smooth subvariety of X . Denote the inclusion map  by i and the ideal sheaf of Y in X by   â„   â„   \mathcal{I}   . The conormal exact sequence for i is       0  â†’   â„  /   â„  2    â†’    i  *    Î©  X    â†’   Î©  Y   â†’  0   ,       normal-â†’  0    â„   superscript  â„  2      normal-â†’       superscript  i     subscript  normal-Î©  X      normal-â†’     subscript  normal-Î©  Y     normal-â†’    0     0\to\mathcal{I}/\mathcal{I}^{2}\to i^{*}\Omega_{X}\to\Omega_{Y}\to 0,   where Î© denotes a cotangent bundle . The determinant of this exact sequence is a natural isomorphism       Ï‰  Y   =   i  *    Ï‰  X   âŠ—  det    (  â„  /   â„  2   )   âˆ¨   ,     fragments   subscript  Ï‰  Y     superscript  i     subscript  Ï‰  X   tensor-product  det   superscript   fragments  normal-(  I    superscript  â„  2   normal-)     normal-,    \omega_{Y}=i^{*}\omega_{X}\otimes\operatorname{det}(\mathcal{I}/\mathcal{I}^{2%
 })^{\vee},   where   âˆ¨     \vee   denotes the dual of a line bundle.  The particular case of a smooth divisor  Suppose that D is a smooth divisor on X . Its normal bundle extends to a line bundle     ğ’ª   (  D  )       ğ’ª  D    \mathcal{O}(D)   on X , and the ideal sheaf of D corresponds to its dual    ğ’ª   (   -  D   )       ğ’ª    D     \mathcal{O}(-D)   . The conormal bundle    â„  /   â„  2       â„   superscript  â„  2     \mathcal{I}/\mathcal{I}^{2}   is     i  *   ğ’ª   (   -  D   )        superscript  i    ğ’ª    D     i^{*}\mathcal{O}(-D)   , which, combined with the formula above, gives       Ï‰  D   =    i  *    (     Ï‰  X   âŠ—  ğ’ª    (  D  )    )         subscript  Ï‰  D      superscript  i       tensor-product   subscript  Ï‰  X   ğ’ª   D      \omega_{D}=i^{*}(\omega_{X}\otimes\mathcal{O}(D))   In terms of canonical classes, this says that       K  D   =     (    K  X   +  D   )   |   D        subscript  K  D    evaluated-at     subscript  K  X   D   D     K_{D}=(K_{X}+D)|_{D}   Both of these two formulas are called the adjunction formula .  PoincarÃ© residue  The restriction map       Ï‰  X   âŠ—  ğ’ª    (  D  )    â†’   Ï‰  D      normal-â†’     tensor-product   subscript  Ï‰  X   ğ’ª   D    subscript  Ï‰  D     \omega_{X}\otimes\mathcal{O}(D)\to\omega_{D}   is called the PoincarÃ© residue . Suppose that X is a complex manifold. Then on sections, the PoincarÃ© residue can be expressed as follows. Fix an open set U on which D is given by the vanishing of a function f . Any section over U of    ğ’ª   (  D  )       ğ’ª  D    \mathcal{O}(D)   can be written as s / f , where s is a holomorphic function on U . Let Î· be a section over U of Ï‰ X . The PoincarÃ© residue is the map        Î·  âŠ—   s  f    â†¦     s    âˆ‚  Î·    âˆ‚  f     |    f  =  0     ,     maps-to   tensor-product  Î·    s  f     evaluated-at    s      Î·     f       f  0      \eta\otimes\frac{s}{f}\mapsto s\frac{\partial\eta}{\partial f}\bigg|_{f=0},   that is, it is formed by applying the vector field âˆ‚/âˆ‚ f to the volume form Î·, then multiplying by the holomorphic function s . If U admits local coordinates z 1 , ..., z n such that for some i , âˆ‚ f /âˆ‚ z i â‰  0, then this can also be expressed as          g   (  z  )   d   z  1    âˆ§  â‹¯  âˆ§   d   z  n      f   (  z  )     â†¦       (   -  1   )    i  -  1       g   (  z  )   d   z  1    âˆ§  â‹¯  âˆ§    d   z  i    ^   âˆ§  â‹¯  âˆ§   d   z  n       âˆ‚  f   /   âˆ‚   z  i       |    f  =  0     .     maps-to        g  z  d   subscript  z  1    normal-â‹¯    d   subscript  z  n       f  z     evaluated-at     superscript    1     i  1          g  z  d   subscript  z  1    normal-â‹¯   normal-^    d   subscript  z  i     normal-â‹¯    d   subscript  z  n         f      subscript  z  i         f  0      \frac{g(z)\,dz_{1}\wedge\cdots\wedge dz_{n}}{f(z)}\mapsto(-1)^{i-1}\frac{g(z)%
 \,dz_{1}\wedge\cdots\wedge\widehat{dz_{i}}\wedge\cdots\wedge dz_{n}}{\partial f%
 /\partial z_{i}}\bigg|_{f=0}.     Another way of viewing PoincarÃ© residue first reinterprets the adjunction formula as an isomorphism          Ï‰  D   âŠ—   i  *    ğ’ª   (   -  D   )    =    i  *    Ï‰  X     .         tensor-product   subscript  Ï‰  D    superscript  i     ğ’ª    D       superscript  i     subscript  Ï‰  X      \omega_{D}\otimes i^{*}\mathcal{O}(-D)=i^{*}\omega_{X}.   On an open set U as before, a section of     i  *   ğ’ª   (   -  D   )        superscript  i    ğ’ª    D     i^{*}\mathcal{O}(-D)   is the product of a holomorphic function s with the form . The PoincarÃ© residue is the map that takes the wedge product of a section of Ï‰ D and a section of     i  *   ğ’ª   (   -  D   )        superscript  i    ğ’ª    D     i^{*}\mathcal{O}(-D)   .  Inversion of adjunction  The adjunction formula is false when the conormal exact sequence is not a short exact sequence. However, it is possible to use this failure to relate the singularities of X with the singularities of D . Theorems of this type are called inversion of adjunction . They are an important tool in modern birational geometry.  Applications to curves   The genus-degree formula for plane curves can be deduced from the adjunction formula. 1 Let C âŠ‚ P 2 be a smooth plane curve of degree d and genus g . Let H be the class of a hypersurface in P 2 , that is, the class of a line. The canonical class of P 2 is âˆ’3 H . Consequently, the adjunction formula says that the restriction of  to C equals the canonical class of C . This restriction is the same as the intersection product  restricted to C , and so the degree of the canonical class of C is . By the Riemannâ€“Roch theorem , g âˆ’ 1 = ( d âˆ’ 3) d âˆ’ g + 1, which implies the formula     g  =     (   d  -  1   )    (   d  -  2   )    /  2.       g        d  1     d  2    2.     g=(d-1)(d-2)/2.     Similarly, 2 if C is a smooth curve on the quadric surface P 1 Ã— P 1 with bidegree ( d 1 , d 2 ) (meaning d 1 , d 2 are its intersection degrees with a fiber of each projection to P 1 ), since the canonical class of P 1 Ã— P 1 has bidegree (âˆ’2,âˆ’2), the adjunction formula shows that the canonical class of C is the intersection product of divisors of bidegrees ( d 1 , d 2 ) and ( d 1 âˆ’2, d 2 âˆ’2). The intersection form on P 1 Ã— P 1 is     (   (   d  1   ,   d  2   )   ,   (   e  1   ,   e  2   )   )   â†¦     d  1    e  2    +    d  2    e  1        maps-to     subscript  d  1    subscript  d  2      subscript  e  1    subscript  e  2          subscript  d  1    subscript  e  2       subscript  d  2    subscript  e  1       ((d_{1},d_{2}),(e_{1},e_{2}))\mapsto d_{1}e_{2}+d_{2}e_{1}   by definition of the bidegree and by bilinearity, so applying Riemannâ€“Roch gives      2  g   -  2   =     d  1    (    d  2   -  2   )    +    d  2    (    d  1   -  2   )             2  g   2        subscript  d  1      subscript  d  2   2       subscript  d  2      subscript  d  1   2       2g-2=d_{1}(d_{2}-2)+d_{2}(d_{1}-2)   or     g  =      d  1    d  2    -   d  1   -   d  2    +  1       g         subscript  d  1    subscript  d  2     subscript  d  1    subscript  d  2    1     g=d_{1}d_{2}-d_{1}-d_{2}+1     The genus of a curve C which is the complete intersection of two surfaces D and E in P 3 can also be computed using the adjunction formula. Suppose that d and e are the degrees of D and E , respectively. Applying the adjunction formula to D shows that its canonical divisor is , which is the intersection product of  and D . Doing this again with E , which is possible because C is a complete intersection, shows that the canonical divisor C is the product , that is, it has degree . By the Riemannâ€“Roch theorem, this implies that the genus of C is     g  =     d  e   (    d  +  e   -  4   )    /  2   +  1.       g        d  e      d  e   4    2   1.     g=de(d+e-4)/2+1.      See also  Logarithmic form  References    Intersection theory 2nd edition, William Fulton, Springer, ISBN 0-387-98549-2, Example 3.2.12.  Principles of algebraic geometry , Griffiths and Harris, Wiley classics library, ISBN 0-471-05059-8 pp 146â€“147.  Algebraic geometry , Robin Hartshorne , Springer GTM 52, ISBN 0-387-90244-9, Proposition II.8.20.   "  Category:Algebraic geometry     Hartshorne, chapter V, example 1.5.1 â†©  Hartshorne, chapter V, example 1.5.2 â†©     
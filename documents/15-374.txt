


Geodesics on an ellipsoid




Geodesics on an ellipsoid

 The study of geodesics on an ellipsoid arose in connection with geodesy specifically with the solution of triangulation networks. The figure of the Earth is well approximated by an oblate ellipsoid, a slightly flattened sphere. A geodesic is the shortest path between two points on a curved surface, i.e., the analogue of a straight line on a plane surface. The solution of a triangulation network on an ellipsoid is therefore a set of exercises in spheroidal trigonometry .
  If the Earth is treated as a sphere, the geodesics are great circles (all of which are closed) and the problems reduce to ones in spherical trigonometry. However,  showed that the effect of the rotation of the Earth results in its resembling a slightly oblate ellipsoid and, in this case, the equator and the meridians are the only closed geodesics. Furthermore, the shortest path between two points on the equator does not necessarily run along the equator. Finally, if the ellipsoid is further perturbed to become a triaxial ellipsoid (with three distinct semi-axes), then only three geodesics are closed and one of these is unstable.
The problems in geodesy are usually reduced to two main cases: the direct problem, given a starting point and an initial heading, find the position after traveling a certain distance along the geodesic; and the inverse problem, given two points on the ellipsoid find the connecting geodesic and hence the shortest distance between them. Because the flattening of the Earth is small, the geodesic distance between two points on the Earth is well approximated by the great-circle distance using the mean Earth radius—the relative error is less than 1%. However, the course of the geodesic can differ dramatically from that of the great circle. As an extreme example, consider two points on the equator with a longitude difference of 179°59′; while the connecting great circle follows the equator, the shortest geodesics pass within 180 km of either pole (the flattening makes two symmetric paths passing close to the poles shorter than the route along the equator).
Aside from their use in geodesy and related fields such as navigation, terrestrial geodesics arise in the study of the propagation of signals which are confined (approximately) to the surface of the Earth, for example, sound waves in the ocean  and the radio signals from lightning . Geodesics are used to define some maritime boundaries, which in turn determine the allocation of valuable resources as such oil and mineral rights. Ellipsoidal geodesics also arise in other applications; for example, the propagation of radio waves along the fuselage of an aircraft, which can be roughly modeled as a prolate (elongated) ellipsoid .
Geodesics are an important intrinsic characteristic of curved surfaces. The sequence of progressively more complex surfaces, the sphere, an ellipsoid of revolution, and a triaxial ellipsoid, provide a useful family of surfaces for investigating the general theory of surfaces. Indeed, Gauss's work on the survey of Hanover, which involved geodesics on an oblate ellipsoid, was a key motivation for his study of surfaces . Similarly, the existence of three closed geodesics on a triaxial ellipsoid turns out to be a general property of closed, simply connected surfaces; this was conjectured by  and proved by  .
Geodesics on an ellipsoid of revolution
There are several ways of defining geodesics . A simple definition is as the shortest path between two points on a surface. However, it is frequently more useful to define them as paths with zero geodesic curvature—i.e., the analogue of straight lines on a curved surface. This definition encompasses geodesics traveling so far across the ellipsoid's surface (somewhat less than half the circumference) that other distinct routes require less distance. Locally, these geodesics are still identical to the shortest distance between two points.
By the end of the 18th century, an ellipsoid of revolution (the term spheroid is also used) was a well-accepted approximation to the figure of the Earth. The adjustment of triangulation networks entailed reducing all the measurements to a reference ellipsoid and solving the resulting two-dimensional problem as an exercise in spheroidal trigonometry .
 It is possible to reduce the various geodesic problems into one of two types. Consider two points: A at latitude φ1 and longitude λ1 and B at latitude φ2 and longitude λ2 (see Fig. 1). The connecting geodesic (from A to B) is AB, of length s12, which has azimuths α1 and α2 at the two endpoints. The two geodesic problems usually considered are:

the direct geodesic problem or first geodesic problem, given A, α1, and s12, determine B and α2;
the inverse geodesic problem or second geodesic problem, given A and B, determine s12, α1, and α2.

As can be seen from Fig. 1, these problems involve solving the triangle NAB given one angle, α1 for the direct problem and λ12 = λ2 − λ1 for the inverse problem, and its two adjacent sides. In the course of the 18th century these problems were elevated (especially in literature in the German language) to the principal geodesic problems .
For a sphere the solutions to these problems are simple exercises in spherical trigonometry, whose solution is given by formulas for solving a spherical triangle. (See the article on great-circle navigation.)
  For an ellipsoid of revolution, the characteristic constant defining the geodesic was found by . A systematic solution for the paths of geodesics was given by  and  (and subsequent papers in Oriani|1808}}|1808 and Oriani|1810}}|1810). The full solution for the direct problem (complete with computational tables and a worked out example) is given by .
Much of the early work on these problems was carried out by mathematicians—for example, Legendre, Bessel, and Gauss—who were also heavily involved in the practical aspects of surveying. Beginning in about 1830, the disciplines diverged: those with an interest in geodesy concentrated on the practical aspects such as approximations suitable for field work, while mathematicians pursued the solution of geodesics on a triaxial ellipsoid, the analysis of the stability of closed geodesics, etc.
During the 18th century geodesics were typically referred to as "shortest lines". The term "geodesic line" was coined by :

Nous désignerons cette ligne sous le nom de ligne géodésique [We will call this line the geodesic line].

This terminology was introduced into English either as "geodesic line" or as "geodetic line", for example ,

A line traced in the manner we have now been describing, or deduced from trigonometrical measures, by the means we have indicated, is called a geodetic or geodesic line: it has the property of being the shortest which can be drawn between its two extremities on the surface of the Earth; and it is therefore the proper itinerary measure of the distance between those two points.

In its adoption by other fields "geodesic line", frequently shortened, to "geodesic", was preferred.
This section treats the problem on an ellipsoid of revolution (both oblate and prolate). The problem on a triaxial ellipsoid is covered in the next section.
When determining distances on the earth, various approximate methods are frequently used; some of these are described in the article on geographical distance.
Equations for a geodesic
 
Here the equations for a geodesic are developed; these allow the geodesics of any length to be computed accurately. The following derivation closely follows that of . , , , and  also provide derivations of these equations.
Consider an ellipsoid of revolution with equatorial radius a and polar semi-axis b. Define the flattening f = (a − b)/a, the eccentricity e2 = f(2 − f), and the second eccentricity e′ = e/(1 − f). (In most applications in geodesy, the ellipsoid is taken to be oblate, a > b; however, the theory applies without change to prolate ellipsoids, a 2, and e′2 are negative.)
Let an elementary segment of a path on the ellipsoid have length ds. From Figs. 2 and 3, we see that if its azimuth is α, then ds is related to dφ and dλ by

(1)

\cos\alpha\,ds = \rho\,d\phi = - dR/\sin\phi, \quad \sin\alpha\,ds = R\,d\lambda, where ρ is the meridional radius of curvature, R = ν cosφ is the radius of the circle of latitude φ, and ν is the normal radius of curvature. The elementary segment is therefore given by


 
  or


 
 
  where φ′ = dφ/dλ and L depends on φ through ρ(φ) and R(φ). The length of an arbitrary path between (φ1, λ1) and (φ2, λ2) is given by


 
  where φ is a function of λ satisfying φ(λ1) = φ1 and φ(λ2) = φ2. The shortest path or geodesic entails finding that function φ(λ) which minimizes s12. This is an exercise in the calculus of variations and the minimizing condition is given by the Beltrami identity,


 
   Substituting for L and using Eqs. (1) gives


 
   first found this relation, using a geometrical construction; a similar derivation is presented by . Differentiating this relation and manipulating the result gives 


 
  This, together with Eqs. (1), leads to a system of ordinary differential equations for a geodesic 

(2)

\frac{d\phi}{ds} = \frac{\cos\alpha}{\rho};\quad \frac{d\lambda}{ds} = \frac{\sin\alpha}{\nu\cos\phi};\quad \frac{d\alpha}{ds} = \frac{\tan\phi\sin\alpha}{\nu}. We can express R in terms of the parametric latitude, β, using


 
  (see Fig. 4 for the geometrical construction), and Clairaut's relation then becomes


 
   This is the sine rule of spherical trigonometry relating two sides of the triangle NAB (see Fig. 5), NA = ½π − β1, and NB = ½π − β2 and their opposite angles B = π − α2 and A = α1.
In order to find the relation for the third side AB = σ12, the spherical arc length, and included angle N = ω12, the spherical longitude, it is useful to consider the triangle NEP representing a geodesic starting at the equator; see Fig. 6. In this figure, the variables referred to the auxiliary sphere are shown with the corresponding quantities for the ellipsoid shown in parentheses. Quantities without subscripts refer to the arbitrary point P; E, the point at which the geodesic crosses the equator in the northward direction, is used as the origin for σ, s and ω.
 If the side EP is extended by moving P infinitesimally (see Fig. 7), we obtain

(3)

\cos\alpha\,d\sigma = d\beta, \quad \sin\alpha\,d\sigma = \cos\beta\,d\omega. Combining Eqs. (1) and (3) gives differential equations for s and λ



Up to this point, we have not made use of the specific equations for an ellipsoid, and indeed the derivation applies to an arbitrary surface of revolution. Bessel now specializes to an ellipsoid in which R and Z are related by


 
  where Z is the height above the equator (see Fig. 4). Differentiating this and setting dR/dZ = −sinφ/cosφ gives


 
  eliminating Z from these equations, we obtain


 
  This relation between β and φ can be written as


 
  which is the normal definition of the parametric latitude on an ellipsoid. Furthermore, we have


 
  so that the differential equations for the geodesic become



The last step is to use σ as the independent parameter in both of these differential equations and thereby to express s and λ as integrals. Applying the sine rule to the vertices E and G in the spherical triangle EGP in Fig. 6 gives


 
  where α0 is the azimuth at E. Substituting this into the equation for ds/dσ and integrating the result gives

(4)

\begin{align} \frac sb &= \int_0^\sigma \frac{\sqrt{1 - e^2 \cos^2\beta(\sigma';\alpha_0)}}{1-f}\,d\sigma'\\ &= \int_0^\sigma \sqrt{1 + k^2 \sin^2\sigma'}\,d\sigma', \end{align}  where


 
  and the limits on the integral are chosen so that s(σ = 0) = 0.  pointed out that the equation for s is the same as the equation for the arc on an ellipse with semi-axes b(1 + e′2 cos2α0)1/2 and b. In order to express the equation for λ in terms of σ, we write


 
  which follows from Eq. (3) and Clairaut's relation. This yields

(5)

\begin{align} \lambda - \lambda_0 &= (1-f) \sin\alpha_0 \int_0^\sigma\frac {\sqrt{1 + k^2\sin^2\sigma'}} {1 - \cos^2\alpha_0\sin^2\sigma'}\,d\sigma'\\ &= \omega - \sin\alpha_0 \int_0^\sigma\frac {e^2}{1 + \sqrt{1 - e^2\cos^2\beta(\sigma';\alpha_0)}}\,d\sigma'\\ &= \omega - f\sin\alpha_0 \int_0^\sigma\frac {2-f}{1 + (1-f)\sqrt{1 + k^2\sin^2\sigma'}} \,d\sigma', \end{align} and the limits on the integrals are chosen so that λ = λ0 at the equator crossing, σ = 0.
In using these integral relations, we allow σ to increase continuously (not restricting it to a range [−π, π], for example) as the great circle, resp. geodesic, encircles the auxiliary sphere, resp. ellipsoid. The quantities ω, λ, and s are likewise allowed to increase without limit. Once the problem is solved, λ can be reduced to the conventional range.
This completes the solution of the path of a geodesic using the auxiliary sphere. By this device a great circle can be mapped exactly to a geodesic on an ellipsoid of revolution. However, because the equations for s and λ in terms of the spherical quantities depend on α0, the mapping is not a consistent mapping of the surface of the sphere to the ellipsoid or vice versa; instead, it should be viewed merely as a convenient tool for solving for a particular geodesic.
There are also several ways of approximating geodesics on an ellipsoid which usually apply for sufficiently short lines ; however, these are typically comparable in complexity to the method for the exact solution given above .
Behavior of geodesics
  Before solving for the geodesics, it is worth reviewing their behavior. Fig. 8 shows the simple closed geodesics which consist of the meridians (green) and the equator (red). (Here the qualification "simple" means that the geodesic closes on itself without an intervening self-intersection.) This follows from the equations for the geodesics given in the previous section.
For meridians, we have α0 = 0 and Eq. (5) becomes λ = ω + λ0, i.e., the longitude will vary the same way as for a sphere, jumping by π each time the geodesic crosses the pole. The distance, Eq. (4), reduces to the length of an arc of an ellipse with semi-axes a and b (as expected), expressed in terms of parametric latitude, β.
The equator (β = 0
on the auxiliary sphere, φ = 0 on the ellipsoid) corresponds to α0 = ½π. The distance reduces to the arc of a circle of radius b (and not a), s = bσ, while the longitude simplifies to λ = (1 − f)σ + λ0. A geodesic that is nearly equatorial will intersect the equator at intervals of πb. As a consequence, the maximum length of a equatorial geodesic which is also a shortest path is πb on an oblate ellipsoid (on a prolate ellipsoid, the maximum length is πa).
All other geodesics are typified by Figs. 9 to 11. Figure 9 shows latitude as a function of longitude for a geodesic starting on the equator with α0 = 45°. A full cycle of the geodesic, from one northward crossing of the equator to the next, is shown. The equatorial crossings are called nodes and the points of maximum or minimum latitude are called vertices; the vertex latitudes are given by |β| = ±(½π − |α0|). The latitude is an odd, resp. even, function of the longitude about the nodes, resp. vertices. The geodesic completes one full oscillation in latitude before the longitude has increased by 360°. Thus, on each successive northward crossing of the equator (see Fig. 10), λ falls short of a full circuit of the equator by approximately 2π f sinα0 (for a prolate ellipsoid, this quantity is negative and λ completes more that a full circuit; see Fig. 12). For nearly all values of α0, the geodesic will fill that portion of the ellipsoid between the two vertex latitudes (see Fig. 11).
If the ellipsoid is sufficiently oblate, i.e., b/a 0, for the green (resp. blue) geodesic is chosen to be 53.175° (resp. 75.192°), so that the geodesic completes 2 (resp. 3) complete oscillations about the equator on one circuit of the ellipsoid.
Evaluation of the integrals
Solving the geodesic problems entails evaluating the integrals for the distance, s, and the longitude, λ, Eqs. (4) and (5). In geodetic applications, where f is small, the integrals are typically evaluated as a series; for this purpose, the second form of the longitude integral is preferred (since it avoids the near singular behavior of the first form when geodesics pass close to a pole). In both integrals, the integrand is an even periodic function of period π. Furthermore, the term dependent on σ is multiplied by a small quantity k2 = O(f). As a consequence, the integrals can both be written in the form


 
  where B0 = 1 + O(f) and Bj = O(f j). Series expansions for Bj can readily be found and the result truncated so that only terms which are O(f J) and larger are retained. (Because the longitude integral is multiplied by f, it is typically only necessary to retain terms up to O(f J−1) in that integral.) This prescription is followed by many authors      .  uses J = 3 which provides an accuracy of about 0.1 mm for the WGS84 ellipsoid.  gives expansions carried out for J = 6 which suffices to provide full double precision accuracy for |f| ≤ 1/50. Trigonometric series of this type can be conveniently summed using Clenshaw summation.
In order to solve the direct geodesic problem, it is necessary to find σ given s. Since the integrand in the distance integral is positive, this problem has a unique root, which may be found using Newton's method, noting that the required derivative is just the integrand of the distance integral.  instead uses series reversion so that σ can be found without iteration;  gives a similar series. The reverted series converges somewhat slower that the direct series and, if |f| > 1/100,  supplements the reverted series with one step of Newton's method to maintain accuracy.  instead relies on a simpler (but slower) function iteration to solve for σ.
It is also possible to evaluate the integrals (4) and (5) by numerical quadrature    or to apply numerical techniques for the solution of the ordinary differential equations, Eqs. (2)   . Such techniques can be used for arbitrary flattening f. However, if f is small, e.g., |f| ≤ 1/50, they do not offer the speed and accuracy of the series expansions described above. Furthermore, for arbitrary f, the evaluation of the integrals in terms of elliptic integrals (see below) also provides a fast and accurate solution. On the other hand,  has tackled the more complex problem of geodesics on the surface at a constant altitude, h, above the ellipsoid by solving the corresponding ordinary differential equations, Eqs. (2) with [ρ, ν] replaced by [ρ + h, ν + h].
  Geodesics on an ellipsoid was an early application of elliptic integrals. In particular,  writes the integrals, Eqs. (4) and (5), as

(6)

\displaystyle
 \frac sb = E(\sigma, ik),


(7)

\begin{align}
 \lambda &= (1 - f) \sin\alpha_0  G(\sigma, \cos^2\alpha_0, ik) \\
         &= \chi
          - \frac{e'^2}{\sqrt{1+e'^2}}\sin\alpha_0 H(\sigma, -e'^2, ik), \\
\end{align}  where


 
  and


 
 
  and F(φ, k), E(φ, k), and Π(φ, α2, k), are incomplete elliptic integrals in the notation of . The first formula for the longitude in Eq. (7) follows directly from the first form of Eq. (5). The second formula in Eq. (7), due to , is more convenient for calculation since the elliptic integral appears in a small term. The equivalence of the two forms follows from . Fast algorithms for computing elliptic integrals are given by  in terms of symmetric elliptic integrals. Equation (6) is conveniently inverted using Newton's method. The use of elliptic integrals provides a good method of solving the geodesic problem for |f| > 1/50.
Solution of the direct problem
The basic strategy for solving the geodesic problems on the ellipsoid is to map the problem onto the auxiliary sphere by converting φ, λ, and s, to β, ω and σ, to solve the corresponding great-circle problem on the sphere, and to transfer the results back to the ellipsoid.
In implementing this program, we will frequently need to solve the "elementary" spherical triangle for NEP in Fig. 6 with P replaced by either A (subscript 1) or B (subscript 2). For this purpose, we can apply  Napier's rules for quadrantal triangles to the triangle NEP on the auxiliary sphere which give


 
 
  We can also stipulate that cosβ ≥ 0 and cosα0 ≥ 0. Implementing this plan for the direct problem is straightforward. We are given φ1, α1, and s12. From φ1 we obtain β1 (using the formula for the parametric latitude). We now solve the triangle problem with P = A and β1 and α1 given to find α0, σ1, and ω1. Use the distance and longitude equations, Eqs. (4) and (5), together with the known value of λ1, to find s1 and λ0. Determine s2 = s1 + s12 and invert the distance equation to find σ2. Solve the triangle problem with P = B and α0 and σ2 given to find β2, ω2, and α2. Convert β2 to φ2 and substitute σ2 and ω2 into the longitude equation to give λ2.
The overall method follows the procedure for solving the direct problem on a sphere. It is essentially the program laid out by , , and most subsequent authors.
Intermediate points, way-points, on a geodesic can be found by holding φ1 and α1 fixed and solving the direct problem for several values of s12. Once the first waypoint is found, only the last portion of the solution (starting with the determination of s2) needs to be repeated for each new value of s12.
Solution of the inverse problem
The ease with which the direct problem can be solved results from the fact that given φ1 and α1, we can immediately find α0, the parameter in the distance and longitude integrals, Eqs. (4) and (5). In the case of the inverse problem, we are given λ12, but we cannot easily relate this to the equivalent spherical angle ω12 because α0 is unknown. Thus, the solution of the problem requires that α0 be found iteratively. Before tackling this, it is worth understanding better the behavior of geodesics, this time, keeping the starting point fixed and varying the azimuth.
Suppose point A in the inverse problem has φ1 = −30° and λ1 = 0°. Fig. 15 shows geodesics (in blue) emanating A with α1 a multiple of 15° up to the point at which they cease to be shortest paths. (The flattening has been increased to 1/10 in order to accentuate the ellipsoidal effects.) Also shown (in green) are curves of constant s12, which are the geodesic circles centered A.  showed that, on any surface, geodesics and geodesic circle intersect at right angles. The red line is the cut locus, the locus of points which have multiple (two in this case) shortest geodesics from A. On a sphere, the cut locus is a point. On an oblate ellipsoid (shown here), it is a segment of the circle of latitude centered on the point antipodal to A, φ = −φ1. The longitudinal extent of cut locus is approximately λ12 ∈ [π − f π cosφ1, π + f π cosφ1]. If A lies on the equator, φ1 = 0, this relation is exact and as a consequence the equator is only a shortest geodesic if |λ12| ≤ (1 − f)π. For a prolate ellipsoid, the cut locus is a segment of the anti-meridian centered on the point antipodal to A, λ12 = π, and this means that meridional geodesics stop being shortest paths before the antipodal point is reached.
The solution of the inverse problem involves determining, for a given point B with latitude φ2 and longitude λ2 which blue and green curves it lies on; this determines α1 and s12 respectively. In Fig. 16, the ellipsoid has been "rolled out" onto a plate carrée projection. Suppose φ2 = 20°, the green line in the figure. Then as α1 is varied between 0° and 180°, the longitude at which the geodesic intersects φ = φ2 varies between 0° and 180° (see Fig. 17). This behavior holds provided that |φ2| ≤ |φ1| (otherwise the geodesic does not reach φ2 for some values of α1). Thus, the inverse problem may be solved by determining the value α1 which results in the given value of λ12 when the geodesic intersects the circle φ = φ2.
This suggests the following strategy for solving the inverse problem . Assume that the points A and B satisfy

(8)

\phi_1 \le 0, \quad \left|\phi_2\right| \le \left|\phi_1\right|, \quad 0 \le \lambda_{12} \le \pi.  (There is no loss of generality in this assumption, since the symmetries of the problem can be used to generate any configuration of points from such configurations.)

First treat the "easy" cases, geodesics which lie on a meridian or the equator. Otherwise...
Guess a value of α1.
Solve the so-called hybrid geodesic problem, given φ1, φ2, and α1 find λ12, s12, and α2, corresponding to the first intersection of the geodesic with the circle φ = φ2.
Compare the resulting λ12 with the desired value and adjust α1 until the two values agree. This completes the solution.

Each of these steps requires some discussion.
1. For an oblate ellipsoid, the shortest geodesic lies on a meridian if either point lies on a pole or if λ12 = 0 or ±π. The shortest geodesic follows the equator if φ1 = φ2 = 0 and |λ12| ≤ (1 − f)π. For a prolate ellipsoid, the meridian is no longer the shortest geodesic if λ12 = ±π and the points are close to antipodal (this will be discussed in the next section). There is no longitudinal restriction on equatorial geodesics.
2. In most cases a suitable starting value of α1 is found by solving  the spherical inverse problem


 
  with ω12 = λ12. This may be a bad approximation if A and B are nearly antipodal (both the numerator and denominator in the formula above become small); however, this may not matter (depending on how step 4 is handled).
3. The solution of the hybrid geodesic problem is as follows. It starts the same way as the solution of the direct problem, solving the triangle NEP with P = A to find α0, σ1, ω1, and λ0. Now find α2 from sinα2 = sinα0/cosβ2, taking cosα2 ≥ 0 (corresponding to the first, northward, crossing of the circle φ = φ2). Next, σ2 is given by tanσ2 = tanβ2/cosα2 and ω2 by tanω2 = tanσ2/sinα0. Finally, use the distance and longitude equations, Eqs. (4) and (5), to find s12 and λ12.
4. In order to discuss how α1 is updated, let us define the root-finding problem in more detail. The curve in Fig. 17 shows λ12(α1; φ1, φ2) where we regard φ1 and φ2 as parameters and α1 as the independent variable. We seek the value of α1 which is the root of


 
  where g(0) ≤ 0 and g(π) ≥ 0. In fact, there is a unique root in the interval α1 ∈ [0, π]. Any of a number of root-finding algorithms can be used to solve such an equation.  uses Newton's method, which requires a good starting guess; however it may be supplemented by a fail-safe method, such as the bisection method, to guarantee convergence.
 An alternative method for solving the inverse problem is given by . Let us rewrite the Eq. (5) as



Helmert's method entails assuming that ω12 = λ12, solving the resulting problem on auxiliary sphere, and obtaining an updated estimate of ω12 using


 
  This fixed point iteration is repeated until convergence.  advocates this method and  adopted it in his solution of the inverse problem. The drawbacks of this method are that convergence is slower than obtained using Newton's method (as described above) and, more seriously, that the process fails to converge at all for nearly antipodal points. In a subsequent report,  attempts to cure this defect; but he is only partially successful—the  implementation still includes Vincenty's fix still fails to converge in some cases.  has compared 17 methods for solving the inverse problem against the method given by .
The shortest distance returned by the solution of the inverse problem is (obviously) uniquely defined. However, if B lies on the cut locus of A there are multiple azimuths which yield the same shortest distance. Here is a catalog of those cases:

φ1 = −φ2 (with neither point at a pole). If α1 = α2, the geodesic is unique. Otherwise there are two geodesics and the second one is obtained by interchanging α1 and α2. (This occurs when λ12 ≈ ±π for oblate ellipsoids.)
λ12 = ±π (with neither point at a pole). If α1 = 0 or ±π, the geodesic is unique. Otherwise there are two geodesics and the second one is obtained by negating α1 and α2. (This occurs when φ1 + φ2 ≈ 0 for prolate ellipsoids.)
A and B are at opposite poles. There are infinitely many geodesics which can be generated by varying the azimuths so as to keep α1 + α2 constant. (For spheres, this prescription applies when A and B are antipodal.)

Differential behavior of geodesics
  Various problems involving geodesics require knowing their behavior when they are perturbed. This is useful in trigonometric adjustments , determining the physical properties of signals which follow geodesics, etc. Consider a reference geodesic, parameterized by s the length from the northward equator crossing, and a second geodesic a small distance t(s) away from it.  showed that t(s) obeys the  Gauss-Jacobi equation

(9)

\displaystyle\frac{d^2t(s)}{ds^2} = K(s) t(s),   where K(s) is the Gaussian curvature at s. The solution may be expressed as the sum of two independent solutions


 
  where


 
 
  We shall abbreviate m(s1, s2) = m12, the so-called reduced length, and M(s1, s2) = M12, the geodesic scale. Their basic definitions are illustrated in Fig. 18.  made an extensive study of their properties. The reduced length obeys a reciprocity relation,


 
  Their derivatives are


 
 
  Assuming that points 1, 2, and 3, lie on the same geodesic, then the following addition rules apply ,


 
 
  The reduced length and the geodesic scale are components of the Jacobi field.
The Gaussian curvature for an ellipsoid of revolution is


 
   solved the Gauss-Jacobi equation for this case obtaining


 
 
  where



As we see from Fig. 18 (top sub-figure), the separation of two geodesics starting at the same point with azimuths differing by dα1 is m12 dα1. On a closed surface such as an ellipsoid, we expect m12 to oscillate about zero. Indeed, if the starting point of a geodesic is a pole, φ1 = ½π, then the reduced length is the radius of the circle of latitude, m12 = a cosβ2 = a sinσ12. Similarly, for a meridional geodesic starting on the equator, φ1 = α1 = 0, we have M12 = cosσ12. In the typical case, these quantities oscillate with a period of about 2π in σ12 and grow linearly with distance at a rate proportional to f. In trigonometric adjustments over small areas, it may be possible to approximate K(s) in Eq. (9) by a constant K. In this limit, the solutions for m12 and M12 are the same as for a sphere of radius 1/√K, namely,



To simplify the discussion of shortest paths in this paragraph we consider only geodesics with s12 > 0. The point at which m12 becomes zero is the point conjugate to the starting point. In order for a geodesic between A and B, of length s12, to be a shortest path it must satisfy the Jacobi condition    , that there is no point conjugate to A between A and B. If this condition is not satisfied, then there is a nearby path (not necessarily a geodesic) which is shorter. Thus, the Jacobi condition is a local property of the geodesic and is only a necessary condition for the geodesic being a global shortest path. Necessary and sufficient conditions for a geodesic being the shortest path are:

for an oblate ellipsoid, |σ12| ≤ π;
for a prolate ellipsoid, |λ12| ≤ π, if α0 ≠ 0; if α0 = 0, the supplemental condition m12 ≥ 0 is required if |λ12| = π.

The latter condition above can be used to determine whether the shortest path is a meridian in the case of a prolate ellipsoid with |λ12| = π. The derivative required to solve the inverse method using Newton's method, ∂λ12(α1; φ1, φ2) / ∂α1, is given in terms of the reduced length .
Geodesic map projections
Two map projections are defined in terms of geodesics. They are based on polar and rectangular geodesic coordinates on the surface . The polar coordinate system (r, θ) is centered on some point A. The coordinates of another point B are given by r = s12 and θ = ½π − α1 and these coordinates are used to find the projected coordinates on a plane map, x = r cosθ and y = r sinθ. The result is the familiar azimuthal equidistant projection; in the field of the differential geometry of surfaces, it is called the exponential map. Due to the basic properties of geodesics , lines of constant r and lines of constant θ intersect at right angles on the surface. The scale of the projection in the radial direction is unity, while the scale in the azimuthal direction is s12/m12.
The rectangular coordinate system (x, y) uses a reference geodesic defined by A and α1 as the x axis. The point (x, y) is found by traveling a distance s13 = x from A along the reference geodesic to an intermediate point C and then turning ½π counter-clockwise and traveling along a geodesic a distance s32 = y. If A is on the equator and α1 = ½π, this gives the equidistant cylindrical projection. If α1 = 0, this gives the Cassini-Soldner projection. Cassini's map of France placed A at the Paris Observatory. Due to the basic properties of geodesics , lines of constant x and lines of constant y intersect at right angles on the surface. The scale of the projection in the y direction is unity, while the scale in the x direction is 1/M32.
The gnomonic projection is a projection of the sphere where all geodesics (i.e., great circles) map to straight lines (making it a convenient aid to navigation). Such a projection is only possible for surfaces of constant Gaussian curvature . Thus a projection in which geodesics map to straight lines is not possible for an ellipsoid. However, it is possible to construct an ellipsoidal gnomonic projection in which this property approximately holds . On the sphere, the gnomonic projection is the limit of a doubly azimuthal projection, a projection preserving the azimuths from two points A and B, as B approaches A. Carrying out this limit in the case of a general surface yields an azimuthal projection in which the distance from the center of projection is given by ρ = m12/M12. Even though geodesics are only approximately straight in this projection, all geodesics through the center of projection are straight. The projection can then be used to give an iterative but rapidly converging method of solving some problems involving geodesics, in particular, finding the intersection of two geodesics and finding the shortest path from a point to a geodesic.
The Hammer retroazimuthal projection is a variation of the azimuthal equidistant projection . A geodesic is constructed from a central point A to some other point B. The polar coordinates of the projection of B are r = s12 and θ = ½π − α2 (which depends on the azimuth at B, instead of at A). This can be used to determine the direction from an arbitrary point to some fixed center.  suggested another application: if the central point A is a beacon, such as the Rugby Clock, then at an unknown location B the range and the bearing to A can be measured and the projection can be used to estimate the location of B.
Envelope of geodesics
The geodesics from a particular point A if continued past the cut locus form an envelope illustrated in Fig. 19. Here the geodesics for which α1 is a multiple of 3° are shown in light blue. (The geodesics are only shown for their first passage close to the antipodal point, not for subsequent ones.) Some geodesic circles are shown in green; these form cusps on the envelope. The cut locus is shown in red. The envelope is the locus of points which are conjugate to A; points on the envelope may be computed by finding the point at which m12 = 0 on a geodesic (and Newton's method can be used to find this point).  calls this star-like figure produced by the envelope an astroid.
Outside the astroid two geodesics intersect at each point; thus there are two geodesics (with a length approximately half the circumference of the ellipsoid) between A and these points. This corresponds to the situation on the sphere where there are "short" and "long" routes on a great circle between two points. Inside the astroid four geodesics intersect at each point. Four such geodesics are shown in Fig. 20 where the geodesics are numbered in order of increasing length. (This figure uses the same position for A as Fig. 15 and is drawn in the same projection.) The two shorter geodesics are stable, i.e., m12 > 0, so that there is no nearby path connecting the two points which is shorter; the other two are unstable. Only the shortest line (the first one) has σ12 ≤ π. All the geodesics are tangent to the envelope which is shown in green in the figure. A similar set of geodesics for the WGS84 ellipsoid is given in this table :




Geodesics for φ1 = −30°, φ2 = 29.9°, λ12 = 179.8° (WGS84)



No.



1



2



3



4



The approximate shape of the astroid is given by


 
  or, in parametric form,


 
  The astroid is also the envelope of the family of lines


 
  where γ is a parameter. (These are generated by the rod of the trammel of Archimedes.) This aids in finding a good starting guess for α1 for Newton's method for in inverse problem in the case of nearly antipodal points .
The astroid is the (exterior) evolute of the geodesic circles centered at A. Likewise, the geodesic circles are involutes of the astroid.
Area of a geodesic polygon
A geodesic polygon is a polygon whose sides are geodesics. The area of such a polygon may be found by first computing the area between a geodesic segment and the equator, i.e., the area of the quadrilateral AFHB in Fig. 1 . Once this area is known, the area of a polygon may be computed by summing the contributions from all the edges of the polygon.
Here we develop the formula for the area S12 of AFHB following . The area of any closed region of the ellipsoid is


 
  where dT is an element of surface area and K is the Gaussian curvature. Now the Gauss–Bonnet theorem applied to a geodesic polygon states


 
  where


 
  is the geodesic excess and θj is the exterior angle at vertex j. Multiplying the equation for Γ by R22, where R2 is the authalic radius, and subtracting this from the equation for T gives


 
 
  where the value of K for an ellipsoid has been substituted. Applying this formula to the quadrilateral AFHB, noting that Γ = α2 − α1, and performing the integral over φ gives


 
  where the integral is over the geodesic line (so that φ is implicitly a function of λ). Converting this into an integral over σ, we obtain


 
  where


 
  and the notation E12 = α2 − α1 is used for the geodesic excess. The integral can be expressed as a series valid for small f  .
The area of a geodesic polygon is given by summing S12 over its edges. This result holds provided that the polygon does not include a pole; if it does 2π R22 must be added to the sum. If the edges are specified by their vertices, then a convenient expression for E12 is


 
  This result follows from one of Napier's analogies.
Software implementations
An implementation of Vincenty's algorithm in Fortran is provided by . Version 3.0 includes Vincenty's treatment of nearly antipodal points . Vincenty's original formulas are used in many geographic information systems. Except for nearly antipodal points (where the inverse method fails to converge), this method is accurate to about 0.1 mm for the WGS84 ellipsoid .
The algorithms given in  are included in GeographicLib . These are accurate to about 15 nanometers for the WGS84 ellipsoid. Implementations in several languages (C++, C, Fortran, Java, JavaScript, Python, Matlab, and Maxima) are provided. In addition to solving the basic geodesic problem, this library can return m12, M12, M21, and S12. The library includes a command-line utility, GeodSolve, for geodesic calculations. As of version 4.9.1, the PROJ.4 library for cartographic projections uses the C implementation for geodesic calculations. This is exposed in the command-line utility, geod, and in the library itself.
The solution of the geodesic problems in terms of elliptic integrals is included in GeographicLib (in C++ only), e.g., via the -E option to GeodSolve. This method of solution is about 2–3 times slower than using series expansions; however it provides accurate solutions for ellipsoids of revolution with b/a ∈ [0.01, 100] .
Geodesics on a triaxial ellipsoid
Solving the geodesic problem for an ellipsoid of revolution is, from the mathematical point of view, relatively simple: because of symmetry, geodesics have a constant of the motion, given by Clairaut's relation allowing the problem to be reduced to quadrature. By the early 19th century (with the work of Legendre, Oriani, Bessel, et al.), there was a complete understanding of the properties of geodesics on an ellipsoid of revolution.
On the other hand, geodesics on a triaxial ellipsoid (with 3 unequal axes) have no obvious constant of the motion and thus represented a challenging "unsolved" problem in the first half of the 19th century. In a remarkable paper,  discovered a constant of the motion allowing this problem to be reduced to quadrature also .
Triaxial coordinate systems
  The key to the solution is expressing the problem in the "right" coordinate system. Consider the ellipsoid defined by


 
  where (X,Y,Z) are Cartesian coordinates centered on the ellipsoid and, without loss of generality, a ≥ b ≥ c > 0. A point on the surface is specified by a latitude and longitude. The geographical latitude and longitude (φ, λ) are defined by


 
  The parametric latitude and longitude (φ′, λ′) are defined by


 
 
   employed the ellipsoidal latitude and longitude (β, ω) defined by 


 
 
  In the limit b → a, β becomes the parametric latitude for an oblate ellipsoid, so the use of the symbol β is consistent with the previous sections. However, ω is different from the spherical longitude defined above.
Grid lines of constant β (in blue) and ω (in green) are given in Fig. 21. In contrast to (φ, λ) and (φ′, λ′), (β, ω) is an orthogonal coordinate system: the grid lines intersect at right angles. The principal sections of the ellipsoid, defined by X = 0 and Z = 0 are shown in red. The third principal section, Y = 0, is covered by the lines β = ±90° and ω = 0° or ±180°. These lines meet at four umbilical points (two of which are visible in this figure) where the principal radii of curvature are equal. Here and in the other figures in this section the parameters of the ellipsoid are a:b:c = 1.01:1:0.8, and it is viewed in an orthographic projection from a point above φ = 40°, λ = 30°.
The grid lines of the ellipsoidal coordinates may be interpreted in three different ways

They are "lines of curvature" on the ellipsoid, i.e., they are parallel to the directions of principal curvature .
They are also intersections of the ellipsoid with confocal systems of hyperboloids of one and two sheets .
Finally they are geodesic ellipses and hyperbolas defined using two adjacent umbilical points . For example, the lines of constant β in Fig. 21 can be generated with the familiar string construction for ellipses with the ends of the string pinned to the two umbilical points.

Conversions between these three types of latitudes and longitudes and the Cartesian coordinates are simple algebraic exercises.
The element of length on the ellipsoid in ellipsoidal coordinates is given by


 
 
  and the differential equations for a geodesic are



Jacobi's solution
   Jacobi showed that the geodesic equations, expressed in ellipsoidal coordinates, are separable. Here is how he recounted his discovery to his friend and neighbor Bessel ,

The day before yesterday, I reduced to quadrature the problem of geodesic lines on an ellipsoid with three unequal axes. They are the simplest formulas in the world, Abelian integrals, which become the well known elliptic integrals if 2 axes are set equal.
Königsberg, 28th Dec. '38. 

The solution given by Jacobi   is


 
 
  As Jacobi notes "a function of the angle β equals a function of the angle ω. These two functions are just Abelian integrals..." Two constants δ and γ appear in the solution. Typically δ is zero if the lower limits of the integrals are taken to be the starting point of the geodesic and the direction of the geodesics is determined by γ. However, for geodesics that start at an umbilical points, we have γ = 0 and δ determines the direction at the umbilical point. The constant γ may be expressed as


 
  where α is the angle the geodesic makes with lines of constant ω. In the limit b → a, this reduces to sinα cosβ = const., the familiar Clairaut relation. A nice derivation of Jacobi's result is given by  where he gives the solution found by  for general quadratic surfaces. In this formulation, the distance along the geodesic, s, is found using


 
 
  An alternative expression for the distance is



Survey of triaxial geodesics
On a triaxial ellipsoid, there are only 3 simple closed geodesics, the three principal sections of the ellipsoid given by X = 0, Y = 0, and Z = 0. To survey the other geodesics, it is convenient to consider geodesics which intersect the middle principal section, Y = 0, at right angles. Such geodesics are shown in Figs. 22–26, which use the same ellipsoid parameters and the same viewing direction as Fig. 21. In addition, the three principal ellipses are shown in red in each of these figures.
If the starting point is β1 ∈ (−90°, 90°), ω1 = 0, and α1 = 90°, then γ > 0 and the geodesic encircles the ellipsoid in a "circumpolar" sense. The geodesic oscillates north and south of the equator; on each oscillation it completes slightly less that a full circuit around the ellipsoid resulting, in the typical case, in the geodesic filling the area bounded by the two latitude lines β = ±β1. Two examples are given in Figs. 22 and 23. Figure 22 shows practically the same behavior as for an oblate ellipsoid of revolution (because a ≈ b); compare to Fig. 11. However, if the starting point is at a higher latitude (Fig. 22) the distortions resulting from a ≠ b are evident. All tangents to a circumpolar geodesic touch the confocal single-sheeted hyperboloid which intersects the ellipsoid at β = β1  .
If the starting point is β1 = 90°, ω1 ∈ (0°, 180°), and α1 = 180°, then γ 1 and ω = 180° − ω1. If a = b, all meridians are geodesics; the effect of a ≠ b causes such geodesics to oscillate east and west. Two examples are given in Figs. 24 and 25. The constriction of the geodesic near the pole disappears in the limit b → c; in this case, the ellipsoid becomes a prolate ellipsoid and Fig. 24 would resemble Fig. 12 (rotated on its side). All tangents to a transpolar geodesic touch the confocal double-sheeted hyperboloid which intersects the ellipsoid at ω = ω1.
 If the starting point is β1 = 90°, ω1 = 0° (an umbilical point), and α1 = 135° (the geodesic leaves the ellipse Y = 0 at right angles), then γ = 0 and the geodesic repeatedly intersects the opposite umbilical point and returns to its starting point. However, on each circuit the angle at which it intersects Y = 0 becomes closer to 0° or 180° so that asymptotically the geodesic lies on the ellipse Y = 0  . This is shown in Fig. 26. Note that a single geodesic does not fill an area on the ellipsoid. All tangents to umbilical geodesics touch the confocal hyperbola which intersects the ellipsoid at the umbilic points.
Umbilical geodesic enjoy several interesting properties.

Through any point on the ellipsoid, there are two umbilical geodesics.
The geodesic distance between opposite umbilical points is the same regardless of the initial direction of the geodesic.
Whereas the closed geodesics on the ellipses X = 0 and Z = 0 are stable (an geodesic initially close to and nearly parallel to the ellipse remains close to the ellipse), the closed geodesic on the ellipse Y = 0, which goes through all 4 umbilical points, is exponentially unstable. If it is perturbed, it will swing out of the plane Y = 0 and flip around before returning to close to the plane. (This behavior may repeat depending on the nature of the initial perturbation.)

If the starting point A of a geodesic is not an umbilical point, then its envelope is an astroid with two cusps lying on β = −β1 and the other two on ω = ω1 + π . The cut locus for A is the portion of the line β = −β1 between the cusps .
gives a method for solving the inverse problem for a triaxial ellipsoid by directly integrating the system of ordinary differential equations for a geodesic. (Thus, it does not utilize Jacobi's solution.)
Applications
  The direct and inverse geodesic problems no longer play the central role in geodesy that they once did. Instead of solving adjustment of geodetic networks as a two-dimensional problem in spheroidal trigonometry, these problem are now solved by three-dimensional methods . Nevertheless, terrestrial geodesics still play an important role in several areas:

for measuring distances and areas in geographic information systems;
the definition of maritime boundaries ;
in the rules of the Federal Aviation Administration for area navigation ;
the method of measuring distances in the FAI Sporting Code .

By the principle of least action, many problems in physics can be formulated as a variational problem similar to that for geodesics. Indeed, the geodesic problem is equivalent to the motion of a particle constrained to move on the surface, but otherwise subject to no forces  . For this reason, geodesics on simple surfaces such as ellipsoids of revolution or triaxial ellipsoids are frequently used as "test cases" for exploring new methods. Examples include:

the development of elliptic integrals  and elliptic functions ;
the development of differential geometry  ;
methods for solving systems of differential equations by a change of independent variables ;
the study of caustics ;
investigations into the number and stability of periodic orbits ;
in the limit c → 0, geodesics on a triaxial ellipsoid reduce to a case of dynamical billiards;
extensions to an arbitrary number of dimensions ;
geodesic flow on a surface .

See also

Geographical distance
Great-circle navigation
Geodesics
Geodesy
Meridian arc
Rhumb line
Vincenty's formulae

Notes
References
































































































External links

Online geodesic bibliography, approximately 180 books and articles on geodesics on ellipsoids together with links to online copies.
Implementations of  for oblate ellipsoids:
 
NGS implementation, includes modifications described in .
NGS online tools.
Online calculator from Geoscience Australia.
Javascript implementations of solutions to direct problem and inverse problem.

Implementation of  for ellipsoids of revolution in Geographiclib :
 
GeographicLib web site for downloading library and documentation.
GeodSolve(1), man page for a utility for geodesic calculations.
An online version of GeodSolve.
Planimeter(1), man page for a utility for calculating the area of geodesic polygons.
An online version of Planimeter.
geod(1), man page for the PROJ.4 utility for geodesic calculations.
Javascript utility for direct and inverse problems and area calculations.
Drawing geodesics on Google Maps.
Matlab implementation of the geodesic routines (used for the figures for geodesics on ellipsoids of revolution in this article).
The first description of the geodesic algorithms from .

Geodesics on a triaxial ellipsoid:
 
Additional notes about Jacobi's solution.
Caustics on an ellipsoid.


"
Category:Geodesy Category:Geodesic (mathematics) Category:Differential geometry Category:Calculus of variations



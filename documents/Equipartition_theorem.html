<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1411">Equipartition theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Equipartition theorem</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption><strong>Thermal motion</strong> of an <a href="alpha_helix" title="wikilink">α-helical</a> <a class="uri" href="peptide" title="wikilink">peptide</a>. The jittery motion is random and complex, and the energy of any particular atom can fluctuate wildly. Nevertheless, the equipartition theorem allows the <em>average</em> <a href="kinetic_energy" title="wikilink">kinetic energy</a> of each atom to be computed, as well as the average potential energies of many vibrational modes. The grey, red and blue spheres represent <a href="atom" title="wikilink">atoms</a> of <a class="uri" href="carbon" title="wikilink">carbon</a>, <a class="uri" href="oxygen" title="wikilink">oxygen</a> and <a class="uri" href="nitrogen" title="wikilink">nitrogen</a>, respectively; the smaller white spheres represent atoms of <a class="uri" href="hydrogen" title="wikilink">hydrogen</a>.</figcaption>
</figure>

<p>In <a href="classical_physics" title="wikilink">classical</a> <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>, the <strong>equipartition theorem</strong> is a general formula that relates the <a class="uri" href="temperature" title="wikilink">temperature</a> of a system with its average <a href="energy" title="wikilink">energies</a>. The equipartition theorem is also known as the <strong>law of equipartition</strong>, <strong>equipartition of energy</strong>, or simply <strong>equipartition</strong>. The original idea of equipartition was that, in <a href="thermal_equilibrium" title="wikilink">thermal equilibrium</a>, energy is shared equally among all of its various forms; for example, the average <a href="kinetic_energy" title="wikilink">kinetic energy</a> per <a href="Degrees_of_freedom_(physics_and_chemistry)" title="wikilink">degree of freedom</a> in the <a href="translation_(physics)" title="wikilink">translational motion</a> of a molecule should equal that of its <a href="rotational_motion" title="wikilink">rotational motions</a>.</p>

<p>The equipartition theorem makes quantitative predictions. Like the <a href="virial_theorem" title="wikilink">virial theorem</a>, it gives the total average kinetic and potential energies for a system at a given temperature, from which the system's <a href="heat_capacity" title="wikilink">heat capacity</a> can be computed. However, equipartition also gives the average values of individual components of the energy, such as the kinetic energy of a particular particle or the potential energy of a single <a href="spring_(device)" title="wikilink">spring</a>. For example, it predicts that every atom in a <a class="uri" href="monatomic" title="wikilink">monatomic</a> <a href="ideal_gas" title="wikilink">ideal gas</a> has an average kinetic energy of (3/2)<em>k</em><sub>B</sub><em>T</em> in thermal equilibrium, where <em>k</em><sub>B</sub> is the <a href="Boltzmann_constant" title="wikilink">Boltzmann constant</a> and <em>T</em> is the <a href="Thermodynamic_temperature" title="wikilink">(thermodynamic) temperature</a>. More generally, it can be applied to any <a href="classical_physics" title="wikilink">classical system</a> in <a href="thermal_equilibrium" title="wikilink">thermal equilibrium</a>, no matter how complicated. The equipartition theorem can be used to derive the <a href="ideal_gas_law" title="wikilink">ideal gas law</a>, and the <a href="Dulong–Petit_law" title="wikilink">Dulong–Petit law</a> for the <a href="specific_heat_capacity" title="wikilink">specific heat capacities</a> of solids. It can also be used to predict the properties of <a href="star" title="wikilink">stars</a>, even <a href="white_dwarf" title="wikilink">white dwarfs</a> and <a href="neutron_star" title="wikilink">neutron stars</a>, since it holds even when <a href="special_relativity" title="wikilink">relativistic</a> effects are considered.</p>

<p>Although the equipartition theorem makes very accurate predictions in certain conditions, it becomes inaccurate when <a href="quantum_physics" title="wikilink">quantum effects</a> are significant, such as at low temperatures. When the <a href="thermal_energy" title="wikilink">thermal energy</a> <em>k</em><sub>B</sub><em>T</em> is smaller than the quantum energy spacing in a particular <a href="degrees_of_freedom_(physics_and_chemistry)" title="wikilink">degree of freedom</a>, the average energy and heat capacity of this degree of freedom are less than the values predicted by equipartition. Such a degree of freedom is said to be "frozen out" when the thermal energy is much smaller than this spacing. For example, the heat capacity of a solid decreases at low temperatures as various types of motion become frozen out, rather than remaining constant as predicted by equipartition. Such decreases in heat capacity were among the first signs to physicists of the 19th century that classical physics was incorrect and that a new, more subtle, scientific model was required. Along with other evidence, equipartition's failure to model <a href="black-body_radiation" title="wikilink">black-body radiation</a>—also known as the <a href="ultraviolet_catastrophe" title="wikilink">ultraviolet catastrophe</a>—led <a href="Max_Planck" title="wikilink">Max Planck</a> to suggest that energy in the oscillators in an object, which emit light, were quantized, a revolutionary hypothesis that spurred the development of <a href="quantum_mechanics" title="wikilink">quantum mechanics</a> and <a href="quantum_field_theory" title="wikilink">quantum field theory</a>.</p>
<h2 id="basic-concept-and-simple-examples">Basic concept and simple examples</h2>
<figure><b>(Figure)</b>
<figcaption>Figure 2. Probability density functions of the molecular speed for four <a href="noble_gas" title="wikilink">noble gases</a> at a <a class="uri" href="temperature" title="wikilink">temperature</a> of 298.15 <a href="Kelvin" title="wikilink">K</a> (25 <a href="Celsius" title="wikilink">°C</a>). The four gases are <a class="uri" href="helium" title="wikilink">helium</a> (<sup>4</sup>He), <a class="uri" href="neon" title="wikilink">neon</a> (<sup>20</sup>Ne), <a class="uri" href="argon" title="wikilink">argon</a> (<sup>40</sup>Ar) and <a class="uri" href="xenon" title="wikilink">xenon</a> (<sup>132</sup>Xe); the superscripts indicate their <a href="mass_number" title="wikilink">mass numbers</a>. These probability density functions have <a href="dimensional_analysis" title="wikilink">dimensions</a> of probability times inverse speed; since probability is dimensionless, they can be expressed in units of seconds per meter.</figcaption>
</figure>

<p>The name "equipartition" means "equal division," as derived from the <a class="uri" href="Latin" title="wikilink">Latin</a> <em>equi</em> from the antecedent, æquus ("equal or even"), and partition from the noun, <em>partitio</em> ("division, portion").<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The original concept of equipartition was that the total <a href="kinetic_energy" title="wikilink">kinetic energy</a> of a system is shared equally among all of its independent parts, <em>on the average</em>, once the system has reached thermal equilibrium. Equipartition also makes quantitative predictions for these energies. For example, it predicts that every atom of a <a href="noble_gas" title="wikilink">noble gas</a>, in thermal equilibrium at temperature <em>T</em>, has an average translational kinetic energy of (3/2)<em>k</em><sub>B</sub><em>T</em>, where <em>k</em><sub>B</sub> is the <a href="Boltzmann_constant" title="wikilink">Boltzmann constant</a>. As a consequence, since kinetic energy is equal to 1/2(mass)(velocity)<sup>2</sup>, the heavier atoms of <a class="uri" href="xenon" title="wikilink">xenon</a> have a lower average speed than do the lighter atoms of <a class="uri" href="helium" title="wikilink">helium</a> at the same temperature. Figure 2 shows the <a href="Maxwell–Boltzmann_distribution" title="wikilink">Maxwell–Boltzmann distribution</a> for the speeds of the atoms in four noble gases.</p>

<p>In this example, the key point is that the kinetic energy is quadratic in the velocity. The equipartition theorem shows that in thermal equilibrium, any <a href="degrees_of_freedom_(physics_and_chemistry)" title="wikilink">degree of freedom</a> (such as a component of the position or velocity of a particle) which appears only quadratically in the energy has an average energy of 

<math display="inline" id="Equipartition_theorem:0">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1}/{2}
  </annotation>
 </semantics>
</math>

<em>k</em><sub>B</sub><em>T</em> and therefore contributes 

<math display="inline" id="Equipartition_theorem:1">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1}/{2}
  </annotation>
 </semantics>
</math>

<em>k</em><sub>B</sub> to the system's <a href="heat_capacity" title="wikilink">heat capacity</a>. This has many applications.</p>
<h3 id="translational-energy-and-ideal-gases">Translational energy and ideal gases</h3>

<p>The (Newtonian) kinetic energy of a particle of mass <em>m</em>, velocity <strong>v</strong> is given by</p>

<p>

<math display="block" id="Equipartition_theorem:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mtext>kin</mtext>
    </msub>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mi>m</mi>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>𝐯</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mi>m</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>v</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>v</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>v</mi>
        <mi>z</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <mtext>kin</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>m</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <ci>𝐯</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>m</ci>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>x</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>y</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>v</ci>
         <ci>z</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\text{kin}}=\tfrac{1}{2}m|\mathbf{v}|^{2}=\tfrac{1}{2}m\left(v_{x}^{2}+v_{y%
}^{2}+v_{z}^{2}\right),
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>v<sub>x</sub></em>, <em>v<sub>y</sub></em> and <em>v<sub>z</sub></em> are the Cartesian components of the velocity <strong>v</strong>. Here, <em>H</em> is short for <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a>, and used henceforth as a symbol for energy because the <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian formalism</a> plays a central role in the most <a href="#General_formulation_of_the_equipartition_theorem" title="wikilink">general form</a> of the equipartition theorem.</p>

<p>Since the kinetic energy is quadratic in the components of the velocity, by equipartition these three components each contribute 

<math display="inline" id="Equipartition_theorem:3">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1}/{2}
  </annotation>
 </semantics>
</math>

<em>k</em><sub>B</sub><em>T</em> to the average kinetic energy in thermal equilibrium. Thus the average kinetic energy of the particle is (3/2)<em>k</em><sub>B</sub><em>T</em>, as in the example of noble gases above.</p>

<p>More generally, in an ideal gas, the total energy consists purely of (translational) kinetic energy: by assumption, the particles have no internal degrees of freedom and move independently of one another. Equipartition therefore predicts that the average total energy of an ideal gas of <em>N</em> particles is (3/2) <em>N k</em><sub>B</sub> <em>T</em>.</p>

<p>It follows that the <a href="heat_capacity" title="wikilink">heat capacity</a> of the gas is (3/2) <em>N k</em><sub>B</sub> and hence, in particular, the heat capacity of a <a href="mole_(unit)" title="wikilink">mole</a> of such gas particles is (3/2)<em>N</em><sub>A</sub><em>k</em><sub>B</sub> = (3/2)<em>R</em>, where <em>N</em><sub>A</sub> is the <a href="Avogadro_constant" title="wikilink">Avogadro constant</a> and <em>R</em> is the <a href="gas_constant" title="wikilink">gas constant</a>. Since <em>R</em> ≈ 2 <a href="calorie" title="wikilink">cal</a>/(<a href="mole_(unit)" title="wikilink">mol</a>·<a href="Kelvin" title="wikilink">K</a>), equipartition predicts that the <a href="molar_heat_capacity" title="wikilink">molar heat capacity</a> of an ideal gas is roughly 3 cal/(mol·K). This prediction is confirmed by experiment.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>The mean kinetic energy also allows the <a href="root_mean_square_speed" title="wikilink">root mean square speed</a> <em>v</em><sub>rms</sub> of the gas particles to be calculated:</p>

<p>

<math display="block" id="Equipartition_theorem:4">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>v</mi>
     <mtext>rms</mtext>
    </msub>
    <mo>=</mo>
    <msqrt>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </msqrt>
    <mo>=</mo>
    <msqrt>
     <mfrac>
      <mrow>
       <mn>3</mn>
       <msub>
        <mi>k</mi>
        <mi>B</mi>
       </msub>
       <mi>T</mi>
      </mrow>
      <mi>m</mi>
     </mfrac>
    </msqrt>
    <mo>=</mo>
    <msqrt>
     <mfrac>
      <mrow>
       <mn>3</mn>
       <mi>R</mi>
       <mi>T</mi>
      </mrow>
      <mi>M</mi>
     </mfrac>
    </msqrt>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <mtext>rms</mtext>
     </apply>
     <apply>
      <root></root>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>B</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>R</ci>
        <ci>T</ci>
       </apply>
       <ci>M</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{\text{rms}}=\sqrt{\langle v^{2}\rangle}=\sqrt{\frac{3k_{B}T}{m}}=\sqrt{%
\frac{3RT}{M}},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>M</em> = <em>N</em><sub>A</sub><em>m</em> is the mass of a mole of gas particles. This result is useful for many applications such as <a href="Graham's_law" title="wikilink">Graham's law</a> of <a class="uri" href="effusion" title="wikilink">effusion</a>, which provides a method for <a href="enriched_uranium" title="wikilink">enriching</a> <a class="uri" href="uranium" title="wikilink">uranium</a>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h3 id="rotational-energy-and-molecular-tumbling-in-solution">Rotational energy and molecular tumbling in solution</h3>

<p>A similar example is provided by a rotating molecule with <a href="principal_moments_of_inertia" title="wikilink">principal moments of inertia</a> <em>I</em><sub>1</sub>, <em>I</em><sub>2</sub> and <em>I</em><sub>3</sub>. The rotational energy of such a molecule is given by</p>

<p>

<math display="block" id="Equipartition_theorem:5">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>rot</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>I</mi>
         <mn>1</mn>
        </msub>
        <msubsup>
         <mi>ω</mi>
         <mn>1</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>I</mi>
         <mn>2</mn>
        </msub>
        <msubsup>
         <mi>ω</mi>
         <mn>2</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msub>
         <mi>I</mi>
         <mn>3</mn>
        </msub>
        <msubsup>
         <mi>ω</mi>
         <mn>3</mn>
         <mn>2</mn>
        </msubsup>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>rot</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ω</ci>
         <cn type="integer">1</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ω</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ω</ci>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathrm{rot}}=\tfrac{1}{2}(I_{1}\omega_{1}^{2}+I_{2}\omega_{2}^{2}+I_{3}%
\omega_{3}^{2}),
  </annotation>
 </semantics>
</math>

 where <em>ω</em><sub>1</sub>, <em>ω</em><sub>2</sub>, and <em>ω</em><sub>3</sub> are the principal components of the <a href="angular_velocity" title="wikilink">angular velocity</a>. By exactly the same reasoning as in the translational case, equipartition implies that in thermal equilibrium the average rotational energy of each particle is (3/2)<em>k</em><sub>B</sub><em>T</em>. Similarly, the equipartition theorem allows the average (more precisely, the root mean square) angular speed of the molecules to be calculated.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>The tumbling of rigid molecules—that is, the random rotations of molecules in solution—plays a key role in the <a href="relaxation_(NMR)" title="wikilink">relaxations</a> observed by <a href="nuclear_magnetic_resonance" title="wikilink">nuclear magnetic resonance</a>, particularly <a href="protein_nuclear_magnetic_resonance_spectroscopy" title="wikilink">protein NMR</a> and <a href="residual_dipolar_coupling" title="wikilink">residual dipolar couplings</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Rotational diffusion can also be observed by other biophysical probes such as <a href="fluorescence_anisotropy" title="wikilink">fluorescence anisotropy</a>, <a href="flow_birefringence" title="wikilink">flow birefringence</a> and <a href="dielectric_spectroscopy" title="wikilink">dielectric spectroscopy</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h3 id="potential-energy-and-harmonic-oscillators">Potential energy and harmonic oscillators</h3>

<p>Equipartition applies to <a href="potential_energy" title="wikilink">potential energies</a> as well as kinetic energies: important examples include <a href="harmonic_oscillator" title="wikilink">harmonic oscillators</a> such as a <a href="spring_(device)" title="wikilink">spring</a>, which has a quadratic potential energy</p>

<p>

<math display="block" id="Equipartition_theorem:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mtext>pot</mtext>
    </msub>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <mi>a</mi>
     <msup>
      <mi>q</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <mtext>pot</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\text{pot}}=\tfrac{1}{2}aq^{2},\,
  </annotation>
 </semantics>
</math>

</p>

<p>where the constant <em>a</em> describes the stiffness of the spring and <em>q</em> is the deviation from equilibrium. If such a one-dimensional system has mass <em>m</em>, then its kinetic energy <em>H</em><sub>kin</sub> is</p>

<p>

<math display="block" id="Equipartition_theorem:7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mtext>kin</mtext>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>m</mi>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mn>2</mn>
      <mi>m</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <mtext>kin</mtext>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>m</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\text{kin}}=\frac{1}{2}mv^{2}=\frac{p^{2}}{2m},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>v</em> and <em>p</em> = <em>mv</em> denote the velocity and momentum of the oscillator. Combining these terms yields the total energy<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>

<math display="block" id="Equipartition_theorem:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mtext>kin</mtext>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>H</mi>
      <mtext>pot</mtext>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>a</mi>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>H</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <mtext>kin</mtext>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <mtext>pot</mtext>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>a</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>q</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=H_{\text{kin}}+H_{\text{pot}}=\frac{p^{2}}{2m}+\frac{1}{2}aq^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Equipartition therefore implies that in thermal equilibrium, the oscillator has average energy</p>

<p>

<math display="block" id="Equipartition_theorem:9">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>H</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msub>
       <mi>H</mi>
       <mtext>kin</mtext>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msub>
       <mi>H</mi>
       <mtext>pot</mtext>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <msub>
       <mi>k</mi>
       <mi>B</mi>
      </msub>
      <mi>T</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <msub>
       <mi>k</mi>
       <mi>B</mi>
      </msub>
      <mi>T</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>H</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <mtext>kin</mtext>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <mtext>pot</mtext>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>B</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>B</ci>
       </apply>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H\rangle=\langle H_{\text{kin}}\rangle+\langle H_{\text{pot}}\rangle=%
\tfrac{1}{2}k_{B}T+\tfrac{1}{2}k_{B}T=k_{B}T,
  </annotation>
 </semantics>
</math>

</p>

<p>where the angular brackets 

<math display="inline" id="Equipartition_theorem:10">
 <semantics>
  <mrow>
   <mo>⟨</mo>
   <mi mathvariant="normal">…</mi>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>normal-…</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\ldots\right\rangle
  </annotation>
 </semantics>
</math>

 denote the average of the enclosed quantity,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>This result is valid for any type of harmonic oscillator, such as a <a class="uri" href="pendulum" title="wikilink">pendulum</a>, a vibrating molecule or a passive <a href="electronic_oscillator" title="wikilink">electronic oscillator</a>. Systems of such oscillators arise in many situations; by equipartition, each such oscillator receives an average total energy <em>k</em><sub>B</sub><em>T</em> and hence contributes <em>k</em><sub>B</sub> to the system's <a href="heat_capacity" title="wikilink">heat capacity</a>. This can be used to derive the formula for <a href="Johnson–Nyquist_noise" title="wikilink">Johnson–Nyquist noise</a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> and the <a href="Dulong–Petit_law" title="wikilink">Dulong–Petit law</a> of solid heat capacities. The latter application was particularly significant in the history of equipartition.</p>
<figure><b>(Figure)</b>
<figcaption>Figure 3. Atoms in a crystal can vibrate about their equilibrium positions in the <a href="crystal_structure" title="wikilink">lattice</a>. Such vibrations account largely for the <a href="heat_capacity" title="wikilink">heat capacity</a> of crystalline <a href="dielectric" title="wikilink">dielectrics</a>; with <a href="metal" title="wikilink">metals</a>, <a href="electron" title="wikilink">electrons</a> also contribute to the heat capacity.</figcaption>
</figure>
<h3 id="specific-heat-capacity-of-solids">Specific heat capacity of solids</h3>
<dl>
<dd><dl>
<dd><em>For more details on the molar specific heat capacities of <a href="solid" title="wikilink">solids</a>, see <a href="Einstein_solid" title="wikilink">Einstein solid</a> and <a href="Debye_model" title="wikilink">Debye model</a>.</em>
</dd>
</dl>
</dd>
</dl>

<p>An important application of the equipartition theorem is to the specific heat capacity of a crystalline solid. Each atom in such a solid can oscillate in three independent directions, so the solid can be viewed as a system of 3<em>N</em> independent <a href="simple_harmonic_oscillator" title="wikilink">simple harmonic oscillators</a>, where <em>N</em> denotes the number of atoms in the lattice. Since each harmonic oscillator has average energy <em>k</em><sub>B</sub><em>T</em>, the average total energy of the solid is 3<em>Nk</em><sub>B</sub><em>T</em>, and its heat capacity is 3<em>Nk</em><sub>B</sub>.</p>

<p>By taking <em>N</em> to be the <a href="Avogadro_constant" title="wikilink">Avogadro constant</a> <em>N</em><sub>A</sub>, and using the relation <em>R</em> = <em>N</em><sub>A</sub><em>k</em><sub>B</sub> between the <a href="gas_constant" title="wikilink">gas constant</a> <em>R</em> and the Boltzmann constant <em>k</em><sub>B</sub>, this provides an explanation for the <a href="Dulong–Petit_law" title="wikilink">Dulong–Petit law</a> of <a href="specific_heat_capacity" title="wikilink">specific heat capacities</a> of solids, which stated that the specific heat capacity (per unit mass) of a solid element is inversely proportional to its <a href="atomic_weight" title="wikilink">atomic weight</a>. A modern version is that the molar heat capacity of a solid is <em>3R</em> ≈ 6 cal/(mol·K).</p>

<p>However, this law is inaccurate at lower temperatures, due to quantum effects; it is also inconsistent with the experimentally derived <a href="third_law_of_thermodynamics" title="wikilink">third law of thermodynamics</a>, according to which the molar heat capacity of any substance must go to zero as the temperature goes to absolute zero.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> A more accurate theory, incorporating quantum effects, was developed by <a href="Albert_Einstein" title="wikilink">Albert Einstein</a> (1907) and <a href="Peter_Debye" title="wikilink">Peter Debye</a> (1911).<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>Many other physical systems can be modeled as sets of <a href="oscillation#Coupled_oscillations" title="wikilink">coupled oscillators</a>. The motions of such oscillators can be decomposed into <a href="normal_mode" title="wikilink">normal modes</a>, like the vibrational modes of a <a href="piano_string" title="wikilink">piano string</a> or the <a href="resonance" title="wikilink">resonances</a> of an <a href="organ_pipe" title="wikilink">organ pipe</a>. On the other hand, equipartition often breaks down for such systems, because there is no exchange of energy between the normal modes. In an extreme situation, the modes are independent and so their energies are independently conserved. This shows that some sort of mixing of energies, formally called <em>ergodicity</em>, is important for the law of equipartition to hold.</p>
<h3 id="sedimentation-of-particles">Sedimentation of particles</h3>

<p>Potential energies are not always quadratic in the position. However, the equipartition theorem also shows that if a degree of freedom <em>x</em> contributes only a multiple of <em>x</em><sup>s</sup> (for a fixed real number <em>s</em>) to the energy, then in thermal equilibrium the average energy of that part is <em>k</em><sub>B</sub><em>T</em>/<em>s</em>.</p>

<p>There is a simple application of this extension to the <a class="uri" href="sedimentation" title="wikilink">sedimentation</a> of particles under <a href="gravitation" title="wikilink">gravity</a>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> For example, the haze sometimes seen in <a class="uri" href="beer" title="wikilink">beer</a> can be caused by clumps of <a href="protein" title="wikilink">proteins</a> that <a href="Rayleigh_scattering" title="wikilink">scatter</a> light.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> Over time, these clumps settle downwards under the influence of gravity, causing more haze near the bottom of a bottle than near its top. However, in a process working in the opposite direction, the particles also <a href="diffusion" title="wikilink">diffuse</a> back up towards the top of the bottle. Once equilibrium has been reached, the equipartition theorem may be used to determine the average position of a particular clump of <a href="buoyant_mass" title="wikilink">buoyant mass</a> <em>m</em><sub>b</sub>. For an infinitely tall bottle of beer, the gravitational <a href="potential_energy" title="wikilink">potential energy</a> is given by</p>

<p>

<math display="block" id="Equipartition_theorem:11">
 <semantics>
  <mrow>
   <msup>
    <mi>H</mi>
    <mi>grav</mi>
   </msup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>m</mi>
     <mi mathvariant="normal">b</mi>
    </msub>
    <mi>g</mi>
    <mpadded width="+1.7pt">
     <mi>z</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>H</ci>
     <ci>grav</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <ci>normal-b</ci>
     </apply>
     <ci>g</ci>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H^{\mathrm{grav}}=m_{\rm b}gz\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>z</em> is the height of the protein clump in the bottle and <em><a href="Earth's_gravity" title="wikilink">g</a></em> is the <a class="uri" href="acceleration" title="wikilink">acceleration</a> due to gravity. Since <em>s</em> = 1, the average potential energy of a protein clump equals <em>k</em><sub>B</sub><em>T</em>. Hence, a protein clump with a buoyant mass of 10 <a href="Dalton_(unit)" title="wikilink">MDa</a> (roughly the size of a <a class="uri" href="virus" title="wikilink">virus</a>) would produce a haze with an average height of about 2 cm at equilibrium. The process of such sedimentation to equilibrium is described by the <a href="Mason–Weaver_equation" title="wikilink">Mason–Weaver equation</a>.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="history">History</h2>
<dl>
<dd><dl>
<dd>''This article uses the non-<a href="International_System_of_Units" title="wikilink">SI</a> unit of <em><a href="calorie" title="wikilink">cal</a>/(<a href="mole_(unit)" title="wikilink">mol</a>·<a href="Kelvin" title="wikilink">K</a>)</em> for heat capacity, because it offers greater accuracy for single digits.<br/>
For an approximate conversion to the corresponding SI unit of <em>J/(mol·K)</em>, such values should be multiplied by 4.2'' <a href="Joule" title="wikilink">J</a>/cal.
</dd>
</dl>
</dd>
</dl>

<p>The equipartition of kinetic energy was proposed initially in 1843, and more correctly in 1845, by <a href="John_James_Waterston" title="wikilink">John James Waterston</a>.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> In 1859, <a href="James_Clerk_Maxwell" title="wikilink">James Clerk Maxwell</a> argued that the kinetic heat energy of a gas is equally divided between linear and rotational energy.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> In 1876, <a href="Ludwig_Boltzmann" title="wikilink">Ludwig Boltzmann</a> expanded on this principle by showing that the average energy was divided equally among all the independent components of motion in a system.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a><a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> Boltzmann applied the equipartition theorem to provide a theoretical explanation of the <a href="Dulong–Petit_law" title="wikilink">Dulong–Petit law</a> for the <a href="specific_heat" title="wikilink">specific heat capacities</a> of solids.</p>
<figure><b>(Figure)</b>
<figcaption>Figure 4. Idealized plot of the <a href="specific_heat_capacity" title="wikilink">molar specific heat</a> of a diatomic gas against temperature. It agrees with the value (7/2)<em>R</em> predicted by equipartition at high temperatures (where <em>R</em> is the <a href="gas_constant" title="wikilink">gas constant</a>), but decreases to (5/2)<em>R</em> and then (3/2)<em>R</em> at lower temperatures, as the vibrational and rotational modes of motion are "frozen out". The failure of the equipartition theorem led to a paradox that was only resolved by <a href="quantum_mechanics" title="wikilink">quantum mechanics</a>. For most molecules, the transitional temperature T<sub>rot</sub> is much less than room temperature, whereas <em>T</em><sub>vib</sub> can be ten times larger or more. A typical example is <a href="carbon_monoxide" title="wikilink">carbon monoxide</a>, CO, for which <em>T</em><sub>rot</sub> ≈ 2.8 <a href="Kelvin" title="wikilink">K</a> and <em>T</em><sub>vib</sub> ≈ 3103 <a href="Kelvin" title="wikilink">K</a>. For molecules with very large or weakly bound atoms, <em>T</em><sub>vib</sub> can be close to room temperature (about 300 K); for example, <em>T</em><sub>vib</sub> ≈ 308 K for <a class="uri" href="iodine" title="wikilink">iodine</a> gas, I<sub>2</sub>.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></figcaption>
</figure>

<p>The history of the equipartition theorem is intertwined with that of <a href="specific_heat_capacity" title="wikilink">specific heat capacity</a>, both of which were studied in the 19th century. In 1819, the French physicists <a href="Pierre_Louis_Dulong" title="wikilink">Pierre Louis Dulong</a> and <a href="Alexis_Thérèse_Petit" title="wikilink">Alexis Thérèse Petit</a> discovered that the specific heat capacities of solid elements at room temperature were inversely proportional to the atomic weight of the element.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> Their law was used for many years as a technique for measuring atomic weights.<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> However, subsequent studies by <a href="James_Dewar" title="wikilink">James Dewar</a> and <a href="Heinrich_Friedrich_Weber" title="wikilink">Heinrich Friedrich Weber</a> showed that this <a href="Dulong–Petit_law" title="wikilink">Dulong–Petit law</a> holds only at high <a href="temperature" title="wikilink">temperatures</a>;<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a> at lower temperatures, or for exceptionally hard solids such as <a class="uri" href="diamond" title="wikilink">diamond</a>, the specific heat capacity was lower.<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>

<p>Experimental observations of the specific heat capacities of gases also raised concerns about the validity of the equipartition theorem. The theorem predicts that the molar heat capacity of simple monatomic gases should be roughly 3 cal/(mol·K), whereas that of diatomic gases should be roughly 7 cal/(mol·K). Experiments confirmed the former prediction,<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a> but found that molar heat capacities of diatomic gases were typically about 5 cal/(mol·K),<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> and fell to about 3 cal/(mol·K) at very low temperatures.<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a> <a href="James_Clerk_Maxwell" title="wikilink">Maxwell</a> noted in 1875 that the disagreement between experiment and the equipartition theorem was much worse than even these numbers suggest;<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> since atoms have internal parts, heat energy should go into the motion of these internal parts, making the predicted specific heats of monatomic and diatomic gases much higher than 3 cal/(mol·K) and 7 cal/(mol·K), respectively.</p>

<p>A third discrepancy concerned the specific heat of metals.<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> According to the classical <a href="Drude_model" title="wikilink">Drude model</a>, metallic electrons act as a nearly ideal gas, and so they should contribute (3/2) <em>N</em><sub>e</sub><em>k</em><sub>B</sub> to the heat capacity by the equipartition theorem, where <em>N</em><sub>e</sub> is the number of electrons. Experimentally, however, electrons contribute little to the heat capacity: the molar heat capacities of many conductors and insulators are nearly the same.<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a></p>

<p>Several explanations of equipartition's failure to account for molar heat capacities were proposed. <a href="Ludwig_Boltzmann" title="wikilink">Boltzmann</a> defended the derivation of his equipartition theorem as correct, but suggested that gases might not be in <a href="thermal_equilibrium" title="wikilink">thermal equilibrium</a> because of their interactions with the <a href="luminiferous_aether" title="wikilink">aether</a>.<a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a> <a href="William_Thomson,_1st_Baron_Kelvin" title="wikilink">Lord Kelvin</a> suggested that the derivation of the equipartition theorem must be incorrect, since it disagreed with experiment, but was unable to show how.<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a> In 1900 <a href="John_Strutt,_3rd_Baron_Rayleigh" title="wikilink">Lord Rayleigh</a> instead put forward a more radical view that the equipartition theorem and the experimental assumption of thermal equilibrium were <em>both</em> correct; to reconcile them, he noted the need for a new principle that would provide an "escape from the destructive simplicity" of the equipartition theorem.<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a> <a href="Albert_Einstein" title="wikilink">Albert Einstein</a> provided that escape, by showing in 1906 that these anomalies in the specific heat were due to quantum effects, specifically the quantization of energy in the elastic modes of the solid.<a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a> Einstein used the failure of equipartition to argue for the need of a new quantum theory of matter.<a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a> <a href="Walther_Nernst" title="wikilink">Nernst's</a> 1910 measurements of specific heats at low temperatures<a class="footnoteRef" href="#fn36" id="fnref36"><sup>36</sup></a> supported Einstein's theory, and led to the widespread acceptance of <a href="Quantum_mechanics" title="wikilink">quantum theory</a> among physicists.<a class="footnoteRef" href="#fn37" id="fnref37"><sup>37</sup></a></p>
<h2 id="general-formulation-of-the-equipartition-theorem">General formulation of the equipartition theorem</h2>

<p>The most general form of the equipartition theorem states that under suitable assumptions (discussed below), for a physical system with <a href="Hamiltonian_function" title="wikilink">Hamiltonian</a> energy function <em>H</em> and degrees of freedom <em>x<sub>n</sub></em>, the following equipartition formula holds in thermal equilibrium for all indices <em>m</em> and <em>n</em>:<a class="footnoteRef" href="#fn38" id="fnref38"><sup>38</sup></a><a class="footnoteRef" href="#fn39" id="fnref39"><sup>39</sup></a><a class="footnoteRef" href="#fn40" id="fnref40"><sup>40</sup></a></p>

<p>

<math display="block" id="Equipartition_theorem:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo lspace="0.8pt" maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>m</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>H</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>δ</ci>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>B</ci>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \!\Bigl\langle x_{m}\frac{\partial H}{\partial x_{n}}\Bigr\rangle=\delta_{mn}k%
_{B}T.
  </annotation>
 </semantics>
</math>

</p>

<p>Here <em>δ<sub>mn</sub></em> is the <a href="Kronecker_delta" title="wikilink">Kronecker delta</a>, which is equal to one if <em>m</em> = <em>n</em> and is zero otherwise. The averaging brackets 

<math display="inline" id="Equipartition_theorem:13">
 <semantics>
  <mrow>
   <mo>⟨</mo>
   <mi mathvariant="normal">…</mi>
   <mo>⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>normal-…</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\ldots\right\rangle
  </annotation>
 </semantics>
</math>

 is assumed to be an <a href="ensemble_average" title="wikilink">ensemble average</a> over phase space or, under an assumption of <a href="ergodic" title="wikilink">ergodicity</a>, a time average of a single system.</p>

<p>The general equipartition theorem holds in both the <a href="microcanonical_ensemble" title="wikilink">microcanonical ensemble</a>,<a class="footnoteRef" href="#fn41" id="fnref41"><sup>41</sup></a> when the total energy of the system is constant, and also in the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>,<a class="footnoteRef" href="#fn42" id="fnref42"><sup>42</sup></a><a class="footnoteRef" href="#fn43" id="fnref43"><sup>43</sup></a> when the system is coupled to a <a href="heat_bath" title="wikilink">heat bath</a> with which it can exchange energy. Derivations of the general formula are given <a href="#Derivations" title="wikilink">later in the article</a>.</p>

<p>The general formula is equivalent to the following two:</p>
<ol>
<li>

<math display="inline" id="Equipartition_theorem:14">
 <semantics>
  <mrow>
   <mrow>
    <mo maxsize="160%" minsize="160%">⟨</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo maxsize="160%" minsize="160%">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mrow>
     <mtext>for all</mtext>
     <mi>n</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>H</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <times></times>
      <mtext>for all</mtext>
      <ci>n</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle x_{n}\frac{\partial H}{\partial x_{n}}\Bigr\rangle=k_{B}T\quad%
\mbox{for all }n
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Equipartition_theorem:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo maxsize="160%" minsize="160%">⟨</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>m</mi>
       </msub>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>H</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
      <mo maxsize="160%" minsize="160%">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mrow>
     <mrow>
      <mtext>for all</mtext>
      <mi>m</mi>
     </mrow>
     <mo>≠</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <neq></neq>
     <apply>
      <times></times>
      <mtext>for all</mtext>
      <ci>m</ci>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle x_{m}\frac{\partial H}{\partial x_{n}}\Bigr\rangle=0\quad\mbox{%
for all }m\neq n.
  </annotation>
 </semantics>
</math>


</li>
</ol>

<p>If a degree of freedom <em>x<sub>n</sub></em> appears only as a quadratic term <em>a<sub>n</sub>x<sub>n</sub></em><sup>2</sup> in the Hamiltonian <em>H</em>, then the first of these formulae implies that</p>

<p>

<math display="block" id="Equipartition_theorem:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <msub>
        <mi>a</mi>
        <mi>n</mi>
       </msub>
       <msubsup>
        <mi>x</mi>
        <mi>n</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{B}T=\Bigl\langle x_{n}\frac{\partial H}{\partial x_{n}}\Bigr\rangle=2%
\langle a_{n}x_{n}^{2}\rangle,
  </annotation>
 </semantics>
</math>

 which is twice the contribution that this degree of freedom makes to the average energy 

<math display="inline" id="Equipartition_theorem:17">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>H</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H\rangle
  </annotation>
 </semantics>
</math>

. Thus the equipartition theorem for systems with quadratic energies follows easily from the general formula. A similar argument, with 2 replaced by <em>s</em>, applies to energies of the form <em>a<sub>n</sub>x<sub>n</sub><sup>s</sup></em>.</p>

<p>The degrees of freedom ''x<sub>n''</sub> are coordinates on the <a href="phase_space" title="wikilink">phase space</a> of the system and are therefore commonly subdivided into <a href="canonical_coordinates" title="wikilink">generalized position</a> coordinates <em>q<sub>k</sub></em> and <a href="generalized_momentum" title="wikilink">generalized momentum</a> coordinates <em>p<sub>k</sub></em>, where <em>p<sub>k</sub></em> is the <a href="conjugate_momentum" title="wikilink">conjugate momentum</a> to <em>q<sub>k</sub></em>. In this situation, formula 1 means that for all <em>k</em>,</p>

<p>

<math display="block" id="Equipartition_theorem:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>p</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>q</mi>
       <mi>k</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>q</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle p_{k}\frac{\partial H}{\partial p_{k}}\Bigr\rangle=\Bigl\langle q%
_{k}\frac{\partial H}{\partial q_{k}}\Bigr\rangle=k_{\rm B}T.
  </annotation>
 </semantics>
</math>

</p>

<p>Using the equations of <a href="Hamiltonian_mechanics" title="wikilink">Hamiltonian mechanics</a>,<a class="footnoteRef" href="#fn44" id="fnref44"><sup>44</sup></a> these formulae may also be written</p>

<p>

<math display="block" id="Equipartition_theorem:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>k</mi>
      </msub>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>q</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo maxsize="160%" minsize="160%">⟨</mo>
      <mrow>
       <msub>
        <mi>q</mi>
        <mi>k</mi>
       </msub>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>p</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>t</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo maxsize="160%" minsize="160%">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle p_{k}\frac{dq_{k}}{dt}\Bigr\rangle=-\Bigl\langle q_{k}\frac{dp_{k%
}}{dt}\Bigr\rangle=k_{\rm B}T.
  </annotation>
 </semantics>
</math>

</p>

<p>Similarly, one can show using formula 2 that</p>

<p>

<math display="block" id="Equipartition_theorem:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>q</mi>
       <mi>j</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>p</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>j</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>q</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <mtext>for all</mtext>
     </mpadded>
     <mi>j</mi>
    </mrow>
    <mo>,</mo>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <list>
     <apply>
      <times></times>
      <mtext>for all</mtext>
      <ci>j</ci>
     </apply>
     <ci>k</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle q_{j}\frac{\partial H}{\partial p_{k}}\Bigr\rangle=\Bigl\langle p%
_{j}\frac{\partial H}{\partial q_{k}}\Bigr\rangle=0\quad\mbox{ for all }\,j,k
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Equipartition_theorem:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo maxsize="160%" minsize="160%">⟨</mo>
      <mrow>
       <msub>
        <mi>q</mi>
        <mi>j</mi>
       </msub>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>H</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>q</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
      <mo maxsize="160%" minsize="160%">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mo maxsize="160%" minsize="160%">⟨</mo>
      <mrow>
       <msub>
        <mi>p</mi>
        <mi>j</mi>
       </msub>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>H</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>p</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
      <mo maxsize="160%" minsize="160%">⟩</mo>
     </mrow>
     <mo>=</mo>
     <mn>0</mn>
    </mrow>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mtext>for all</mtext>
      </mpadded>
      <mi>j</mi>
     </mrow>
     <mo>≠</mo>
     <mi>k</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <and></and>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>j</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <neq></neq>
     <apply>
      <times></times>
      <mtext>for all</mtext>
      <ci>j</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle q_{j}\frac{\partial H}{\partial q_{k}}\Bigr\rangle=\Bigl\langle p%
_{j}\frac{\partial H}{\partial p_{k}}\Bigr\rangle=0\quad\mbox{ for all }\,j%
\neq k.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="relation-to-the-virial-theorem">Relation to the virial theorem</h3>

<p>The general equipartition theorem is an extension of the <a href="virial_theorem" title="wikilink">virial theorem</a> (proposed in 1870<a class="footnoteRef" href="#fn45" id="fnref45"><sup>45</sup></a>), which states that</p>

<p>

<math display="block" id="Equipartition_theorem:22">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>k</mi>
      </munder>
      <mrow>
       <msub>
        <mi>q</mi>
        <mi>k</mi>
       </msub>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>H</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>q</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>k</mi>
      </munder>
      <mrow>
       <msub>
        <mi>p</mi>
        <mi>k</mi>
       </msub>
       <mfrac>
        <mrow>
         <mo>∂</mo>
         <mi>H</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <msub>
          <mi>p</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>k</mi>
      </munder>
      <mrow>
       <msub>
        <mi>p</mi>
        <mi>k</mi>
       </msub>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>q</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>t</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo maxsize="160%" minsize="160%">⟨</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mi>k</mi>
       </munder>
       <mrow>
        <msub>
         <mi>q</mi>
         <mi>k</mi>
        </msub>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>p</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo maxsize="160%" minsize="160%">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>p</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>q</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <ci>k</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>q</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>p</ci>
            <ci>k</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle\sum_{k}q_{k}\frac{\partial H}{\partial q_{k}}\Bigr\rangle=\Bigl%
\langle\sum_{k}p_{k}\frac{\partial H}{\partial p_{k}}\Bigr\rangle=\Bigl\langle%
\sum_{k}p_{k}\frac{dq_{k}}{dt}\Bigr\rangle=-\Bigl\langle\sum_{k}q_{k}\frac{dp_%
{k}}{dt}\Bigr\rangle,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>t</em> denotes <a class="uri" href="time" title="wikilink">time</a>.<a class="footnoteRef" href="#fn46" id="fnref46"><sup>46</sup></a> Two key differences are that the virial theorem relates <em>summed</em> rather than <em>individual</em> averages to each other, and it does not connect them to the <a class="uri" href="temperature" title="wikilink">temperature</a> <em>T</em>. Another difference is that traditional derivations of the virial theorem use averages over time, whereas those of the equipartition theorem use averages over <a href="phase_space" title="wikilink">phase space</a>.</p>
<h2 id="applications">Applications</h2>
<h3 id="ideal-gas-law">Ideal gas law</h3>

<p><a href="Ideal_gas" title="wikilink">Ideal gases</a> provide an important application of the equipartition theorem. As well as providing the formula</p>

<p>

<math display="inline" id="Equipartition_theorem:23">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <msup>
    <mi>H</mi>
    <mi>kin</mi>
   </msup>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>H</ci>
     <ci>kin</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\langle H^{\mathrm{kin}}\rangle
  </annotation>
 </semantics>
</math>


 for the average kinetic energy per particle, the equipartition theorem can be used to derive the <a href="ideal_gas_law" title="wikilink">ideal gas law</a> from classical mechanics.<a class="footnoteRef" href="#fn47" id="fnref47"><sup>47</sup></a> If <strong>q</strong> = (<em>q<sub>x</sub></em>, <em>q<sub>y</sub></em>, <em>q<sub>z</sub></em>) and <strong>p</strong> = (<em>p<sub>x</sub></em>, <em>p<sub>y</sub></em>, <em>p<sub>z</sub></em>) denote the position vector and momentum of a particle in the gas, and <strong>F</strong> is the net force on that particle, then</p>

<p>

<math display="inline" id="Equipartition_theorem:24">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mrow>
    <mi>𝐪</mi>
    <mo>⋅</mo>
    <mi>𝐅</mi>
   </mrow>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <apply>
     <ci>normal-⋅</ci>
     <ci>𝐪</ci>
     <ci>𝐅</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\langle\mathbf{q}\cdot\mathbf{F}\rangle
  </annotation>
 </semantics>
</math>


 where the first equality is <a href="Newton's_second_law" title="wikilink">Newton's second law</a>, and the second line uses <a href="Hamilton's_equations" title="wikilink">Hamilton's equations</a> and the equipartition formula. Summing over a system of <em>N</em> particles yields</p>

<p>

<math display="block" id="Equipartition_theorem:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>3</mn>
     <mi>N</mi>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo maxsize="210%" minsize="210%">⟨</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>𝐪</mi>
         <mi>k</mi>
        </msub>
        <mo>⋅</mo>
        <msub>
         <mi>𝐅</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
      <mo maxsize="210%" minsize="210%">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>B</ci>
     </apply>
     <ci>T</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐪</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐅</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3Nk_{B}T=-\biggl\langle\sum_{k=1}^{N}\mathbf{q}_{k}\cdot\mathbf{F}_{k}\biggr\rangle.
  </annotation>
 </semantics>
</math>

</p>
<figure><b>(Figure)</b>
<figcaption>Figure 5. The kinetic energy of a particular molecule can <a href="thermal_fluctuations" title="wikilink">fluctuate wildly</a>, but the equipartition theorem allows its <em>average</em> energy to be calculated at any temperature. Equipartition also provides a derivation of the <a href="ideal_gas_law" title="wikilink">ideal gas law</a>, an equation that relates the <a class="uri" href="pressure" title="wikilink">pressure</a>, <a class="uri" href="volume" title="wikilink">volume</a> and <a class="uri" href="temperature" title="wikilink">temperature</a> of the gas. (In this diagram five of the molecules have been colored red to track their motion; this coloration has no other significance.)</figcaption>
</figure>

<p>By <a href="Newton's_third_law" title="wikilink">Newton's third law</a> and the ideal gas assumption, the net force on the system is the force applied by the walls of their container, and this force is given by the pressure <em>P</em> of the gas. Hence</p>

<p>

<math display="block" id="Equipartition_theorem:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo maxsize="210%" minsize="210%">⟨</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>𝐪</mi>
         <mi>k</mi>
        </msub>
        <mo>⋅</mo>
        <msub>
         <mi>𝐅</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
      <mo maxsize="210%" minsize="210%">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>P</mi>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∮</mo>
       <mi>surface</mi>
      </msub>
      <mrow>
       <mi>𝐪</mi>
       <mo>⋅</mo>
       <mi>𝐝𝐒</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐪</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐅</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">contour-integral</csymbol>
       <ci>surface</ci>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐪</ci>
       <ci>𝐝𝐒</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\biggl\langle\sum_{k=1}^{N}\mathbf{q}_{k}\cdot\mathbf{F}_{k}\biggr\rangle=P%
\oint_{\mathrm{surface}}\mathbf{q}\cdot\mathbf{dS},
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>d<em>S</em></strong> is the infinitesimal area element along the walls of the container. Since the <a class="uri" href="divergence" title="wikilink">divergence</a> of the position vector <strong>q</strong> is</p>

<p>

<math display="block" id="Equipartition_theorem:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo mathvariant="bold">∇</mo>
     <mo>⋅</mo>
     <mi>𝐪</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mi>x</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mi>x</mi>
       </msub>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mi>y</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mi>y</mi>
       </msub>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mi>z</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>q</mi>
        <mi>z</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mn>3</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-⋅</ci>
      <ci>bold-∇</ci>
      <ci>𝐪</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>x</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>y</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>q</ci>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\nabla}\cdot\mathbf{q}=\frac{\partial q_{x}}{\partial q_{x}}+\frac%
{\partial q_{y}}{\partial q_{y}}+\frac{\partial q_{z}}{\partial q_{z}}=3,
  </annotation>
 </semantics>
</math>

</p>

<p>the <a href="divergence_theorem" title="wikilink">divergence theorem</a> implies that</p>

<p>

<math display="block" id="Equipartition_theorem:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∮</mo>
       <mi>surface</mi>
      </msub>
      <mrow>
       <mi>𝐪</mi>
       <mo>⋅</mo>
       <mi>𝐝𝐒</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>P</mi>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mi>volume</mi>
      </msub>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mo mathvariant="bold">∇</mo>
         <mo>⋅</mo>
         <mi>𝐪</mi>
        </mrow>
        <mo rspace="4.2pt">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>V</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>3</mn>
     <mi>P</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>P</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">contour-integral</csymbol>
        <ci>surface</ci>
       </apply>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐪</ci>
        <ci>𝐝𝐒</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>P</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <ci>volume</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>bold-∇</ci>
         <ci>𝐪</ci>
        </apply>
        <ci>d</ci>
        <ci>V</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>P</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\oint_{\mathrm{surface}}\mathbf{q}\cdot\mathbf{dS}=P\int_{\mathrm{volume}}%
\left(\boldsymbol{\nabla}\cdot\mathbf{q}\right)\,dV=3PV,
  </annotation>
 </semantics>
</math>

</p>

<p>where d<em>V</em> is an infinitesimal volume within the container and <em>V</em> is the total volume of the container.</p>

<p>Putting these equalities together yields</p>

<p>

<math display="block" id="Equipartition_theorem:29">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>3</mn>
     <mi>N</mi>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mo maxsize="210%" minsize="210%">⟨</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>𝐪</mi>
         <mi>k</mi>
        </msub>
        <mo>⋅</mo>
        <msub>
         <mi>𝐅</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
      <mo maxsize="210%" minsize="210%">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>3</mn>
     <mi>P</mi>
     <mi>V</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐪</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐅</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>P</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3Nk_{B}T=-\biggl\langle\sum_{k=1}^{N}\mathbf{q}_{k}\cdot\mathbf{F}_{k}\biggr%
\rangle=3PV,
  </annotation>
 </semantics>
</math>

</p>

<p>which immediately implies the <a href="ideal_gas_law" title="wikilink">ideal gas law</a> for <em>N</em> particles:</p>

<p>

<math display="block" id="Equipartition_theorem:30">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mi>V</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>N</mi>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>n</mi>
     <mi>R</mi>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>V</ci>
     </apply>
     <apply>
      <times></times>
      <ci>N</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>R</ci>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   PV=Nk_{B}T=nRT,\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>n</em> = <em>N</em>/<em>N</em><sub>A</sub> is the number of moles of gas and <em>R</em> = <em>N</em><sub>A</sub><em>k</em><sub>B</sub> is the <a href="gas_constant" title="wikilink">gas constant</a>. Although equipartition provides a simple derivation of the ideal-gas law and the internal energy, the same results can be obtained by an alternative method using the <a href="partition_function_(statistical_mechanics)" title="wikilink">partition function</a>.<a class="footnoteRef" href="#fn48" id="fnref48"><sup>48</sup></a></p>
<h3 id="diatomic-gases">Diatomic gases</h3>

<p>A diatomic gas can be modelled as two masses, <em>m</em><sub>1</sub> and <em>m</em><sub>2</sub>, joined by a <a href="spring_(device)" title="wikilink">spring</a> of <a href="Hooke's_law" title="wikilink">stiffness</a> <em>a</em>, which is called the <em>rigid rotor-harmonic oscillator approximation</em>.<a class="footnoteRef" href="#fn49" id="fnref49"><sup>49</sup></a> The classical energy of this system is</p>

<p>

<math display="block" id="Equipartition_theorem:31">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <msup>
       <mrow>
        <mo>|</mo>
        <msub>
         <mi>𝐩</mi>
         <mn>1</mn>
        </msub>
        <mo>|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>m</mi>
        <mn>1</mn>
       </msub>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mrow>
        <mo>|</mo>
        <msub>
         <mi>𝐩</mi>
         <mn>2</mn>
        </msub>
        <mo>|</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>m</mi>
        <mn>2</mn>
       </msub>
      </mrow>
     </mfrac>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>a</mi>
      <msup>
       <mi>q</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐩</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐩</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\frac{\left|\mathbf{p}_{1}\right|^{2}}{2m_{1}}+\frac{\left|\mathbf{p}_{2}%
\right|^{2}}{2m_{2}}+\frac{1}{2}aq^{2},
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>p</strong><sub>1</sub> and <strong>p</strong><sub>2</sub> are the momenta of the two atoms, and <em>q</em> is the deviation of the inter-atomic separation from its equilibrium value. Every degree of freedom in the energy is quadratic and, thus, should contribute 

<math display="inline" id="Equipartition_theorem:32">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1}/{2}
  </annotation>
 </semantics>
</math>

<em>k</em><sub>B</sub><em>T</em> to the total average energy, and 

<math display="inline" id="Equipartition_theorem:33">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1}/{2}
  </annotation>
 </semantics>
</math>

<em>k</em><sub>B</sub> to the heat capacity. Therefore, the heat capacity of a gas of <em>N</em> diatomic molecules is predicted to be 7<em>N</em>·

<math display="inline" id="Equipartition_theorem:34">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1}/{2}
  </annotation>
 </semantics>
</math>

<em>k</em><sub>B</sub>: the momenta <strong>p</strong><sub>1</sub> and <strong>p</strong><sub>2</sub> contribute three degrees of freedom each, and the extension <em>q</em> contributes the seventh. It follows that the heat capacity of a mole of diatomic molecules with no other degrees of freedom should be (7/2)<em>N</em><sub>A</sub><em>k</em><sub>B</sub> = (7/2)<em>R</em> and, thus, the predicted molar heat capacity should be roughly 7 cal/(mol·K). However, the experimental values for molar heat capacities of diatomic gases are typically about 5 cal/(mol·K)<a class="footnoteRef" href="#fn50" id="fnref50"><sup>50</sup></a> and fall to 3 cal/(mol·K) at very low temperatures.<a class="footnoteRef" href="#fn51" id="fnref51"><sup>51</sup></a> This disagreement between the equipartition prediction and the experimental value of the molar heat capacity cannot be explained by using a more complex model of the molecule, since adding more degrees of freedom can only <em>increase</em> the predicted specific heat, not decrease it.<a class="footnoteRef" href="#fn52" id="fnref52"><sup>52</sup></a> This discrepancy was a key piece of evidence showing the need for a <a href="Quantum_mechanics" title="wikilink">quantum theory</a> of matter.</p>
<figure><b>(Figure)</b>
<figcaption>Figure 6. A combined X-ray and optical image of the <a href="Crab_Nebula" title="wikilink">Crab Nebula</a>. At the heart of this nebula there is a rapidly rotating <a href="neutron_star" title="wikilink">neutron star</a> which has about one and a half times the mass of the <a class="uri" href="Sun" title="wikilink">Sun</a> but is only 25 km across (roughly the size of <a class="uri" href="Madrid" title="wikilink">Madrid</a>). The equipartition theorem is useful in predicting the properties of such neutron stars.</figcaption>
</figure>
<h3 id="extreme-relativistic-ideal-gases">Extreme relativistic ideal gases</h3>

<p>Equipartition was used above to derive the classical <a href="ideal_gas_law" title="wikilink">ideal gas law</a> from <a href="Newtonian_mechanics" title="wikilink">Newtonian mechanics</a>. However, <a href="special_relativity" title="wikilink">relativistic effects</a> become dominant in some systems, such as <a href="white_dwarf" title="wikilink">white dwarfs</a> and <a href="neutron_star" title="wikilink">neutron stars</a>,<a class="footnoteRef" href="#fn53" id="fnref53"><sup>53</sup></a> and the ideal gas equations must be modified. The equipartition theorem provides a convenient way to derive the corresponding laws for an extreme relativistic <a href="ideal_gas" title="wikilink">ideal gas</a>.<a class="footnoteRef" href="#fn54" id="fnref54"><sup>54</sup></a> In such cases, the kinetic energy of a <a href="relativistic_particle" title="wikilink">single particle</a> is given by the formula</p>

<p>

<math display="block" id="Equipartition_theorem:35">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>kin</mi>
    </msub>
    <mo>≈</mo>
    <mrow>
     <mi>c</mi>
     <mi>p</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>c</mi>
     <msqrt>
      <mrow>
       <msubsup>
        <mi>p</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>p</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>p</mi>
        <mi>z</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>kin</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>y</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>z</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathrm{kin}}\approx cp=c\sqrt{p_{x}^{2}+p_{y}^{2}+p_{z}^{2}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Taking the derivative of <em>H</em> with respect to the <em>p<sub>x</sub></em> momentum component gives the formula</p>

<p>

<math display="block" id="Equipartition_theorem:36">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>x</mi>
    </msub>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>H</mi>
       <mi>kin</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>p</mi>
       <mi>x</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>c</mi>
    <mfrac>
     <msubsup>
      <mi>p</mi>
      <mi>x</mi>
      <mn>2</mn>
     </msubsup>
     <msqrt>
      <mrow>
       <msubsup>
        <mi>p</mi>
        <mi>x</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>p</mi>
        <mi>y</mi>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>p</mi>
        <mi>z</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>kin</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>x</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>y</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <ci>z</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{x}\frac{\partial H_{\mathrm{kin}}}{\partial p_{x}}=c\frac{p_{x}^{2}}{\sqrt{%
p_{x}^{2}+p_{y}^{2}+p_{z}^{2}}}
  </annotation>
 </semantics>
</math>

</p>

<p>and similarly for the <em>p<sub>y</sub></em> and <em>p<sub>z</sub></em> components. Adding the three components together gives</p>

<p>

<math display="inline" id="Equipartition_theorem:37">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <msub>
    <mi>H</mi>
    <mi>kin</mi>
   </msub>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>kin</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\langle H_{\mathrm{kin}}\rangle
  </annotation>
 </semantics>
</math>


 where the last equality follows from the equipartition formula. Thus, the average total energy of an extreme relativistic gas is twice that of the non-relativistic case: for <em>N</em> particles, it is 3 <em>Nk</em><sub>B</sub><em>T</em>.</p>
<h3 id="non-ideal-gases">Non-ideal gases</h3>

<p>In an ideal gas the particles are assumed to interact only through collisions. The equipartition theorem may also be used to derive the energy and pressure of "non-ideal gases" in which the particles also interact with one another through <a href="conservative_force" title="wikilink">conservative forces</a> whose potential <em>U</em>(<em>r</em>) depends only on the distance <em>r</em> between the particles.<a class="footnoteRef" href="#fn55" id="fnref55"><sup>55</sup></a> This situation can be described by first restricting attention to a single gas particle, and approximating the rest of the gas by a <a href="spherical_symmetry" title="wikilink">spherically symmetric</a> distribution. It is then customary to introduce a <a href="radial_distribution_function" title="wikilink">radial distribution function</a> <em>g</em>(<em>r</em>) such that the <a href="probability_density_function" title="wikilink">probability density</a> of finding another particle at a distance <em>r</em> from the given particle is equal to 4π<em>r</em><sup>2</sup><em>ρg</em>(<em>r</em>), where <em>ρ</em> = <em>N</em>/<em>V</em> is the mean <a class="uri" href="density" title="wikilink">density</a> of the gas.<a class="footnoteRef" href="#fn56" id="fnref56"><sup>56</sup></a> It follows that the mean potential energy associated to the interaction of the given particle with the rest of the gas is</p>

<p>

<math display="block" id="Equipartition_theorem:38">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msub>
      <mi>h</mi>
      <mi>pot</mi>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <mn>4</mn>
      <mi>π</mi>
      <msup>
       <mi>r</mi>
       <mn>2</mn>
      </msup>
      <mi>ρ</mi>
      <mi>U</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>r</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>r</mi>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>r</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <ci>pot</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <ci>π</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>ρ</ci>
      <ci>U</ci>
      <ci>r</ci>
      <ci>g</ci>
      <ci>r</ci>
      <ci>d</ci>
      <ci>r</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle h_{\mathrm{pot}}\rangle=\int_{0}^{\infty}4\pi r^{2}\rho U(r)g(r)\,dr.
  </annotation>
 </semantics>
</math>

</p>

<p>The total mean potential energy of the gas is therefore 

<math display="inline" id="Equipartition_theorem:39">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <msub>
     <mi>H</mi>
     <mrow>
      <mi>p</mi>
      <mi>o</mi>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>N</mi>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msub>
      <mi>h</mi>
      <mi>pot</mi>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <apply>
       <times></times>
       <ci>p</ci>
       <ci>o</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>N</ci>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <ci>pot</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H_{pot}\rangle=\tfrac{1}{2}N\langle h_{\mathrm{pot}}\rangle
  </annotation>
 </semantics>
</math>

, where <em>N</em> is the number of particles in the gas, and the factor 

<math display="inline" id="Equipartition_theorem:40">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {1}/{2}
  </annotation>
 </semantics>
</math>

 is needed because summation over all the particles counts each interaction twice. Adding kinetic and potential energies, then applying equipartition, yields the <em>energy equation</em></p>

<p>

<math display="block" id="Equipartition_theorem:41">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msub>
       <mi>H</mi>
       <mi>kin</mi>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msub>
       <mi>H</mi>
       <mi>pot</mi>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>3</mn>
       <mn>2</mn>
      </mfrac>
      <mi>N</mi>
      <msub>
       <mi>k</mi>
       <mi>B</mi>
      </msub>
      <mi>T</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
      <mi>N</mi>
      <mi>ρ</mi>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mn>0</mn>
        <mi mathvariant="normal">∞</mi>
       </msubsup>
       <mrow>
        <msup>
         <mi>r</mi>
         <mn>2</mn>
        </msup>
        <mi>U</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>r</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>r</mi>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mi>d</mi>
        <mi>r</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>H</ci>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>kin</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>pot</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">3</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>N</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>B</ci>
       </apply>
       <ci>T</ci>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
       <ci>N</ci>
       <ci>ρ</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <int></int>
          <cn type="integer">0</cn>
         </apply>
         <infinity></infinity>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>U</ci>
         <ci>r</ci>
         <ci>g</ci>
         <ci>r</ci>
         <ci>d</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=\langle H_{\mathrm{kin}}\rangle+\langle H_{\mathrm{pot}}\rangle=\frac{3}{2}%
Nk_{B}T+2\pi N\rho\int_{0}^{\infty}r^{2}U(r)g(r)\,dr.
  </annotation>
 </semantics>
</math>

</p>

<p>A similar argument,<a class="footnoteRef" href="#fn57" id="fnref57"><sup>57</sup></a> can be used to derive the <em>pressure equation</em></p>

<p>

<math display="block" id="Equipartition_theorem:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>3</mn>
     <mi>N</mi>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>3</mn>
      <mi>P</mi>
      <mi>V</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
      <mi>N</mi>
      <mi>ρ</mi>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∫</mo>
        <mn>0</mn>
        <mi mathvariant="normal">∞</mi>
       </msubsup>
       <mrow>
        <msup>
         <mi>r</mi>
         <mn>3</mn>
        </msup>
        <msup>
         <mi>U</mi>
         <mo>′</mo>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>r</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>r</mi>
         <mo rspace="4.2pt" stretchy="false">)</mo>
        </mrow>
        <mi>d</mi>
        <mi>r</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>normal-B</ci>
     </apply>
     <ci>T</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>P</ci>
      <ci>V</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
      <ci>N</ci>
      <ci>ρ</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>U</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>r</ci>
        <ci>g</ci>
        <ci>r</ci>
        <ci>d</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3Nk_{\rm B}T=3PV+2\pi N\rho\int_{0}^{\infty}r^{3}U^{\prime}(r)g(r)\,dr.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="anharmonic-oscillators">Anharmonic oscillators</h3>

<p>An anharmonic oscillator (in contrast to a simple harmonic oscillator) is one in which the potential energy is not quadratic in the extension <em>q</em> (the <a href="canonical_coordinate" title="wikilink">generalized position</a> which measures the deviation of the system from equilibrium). Such oscillators provide a complementary point of view on the equipartition theorem.<a class="footnoteRef" href="#fn58" id="fnref58"><sup>58</sup></a><a class="footnoteRef" href="#fn59" id="fnref59"><sup>59</sup></a> Simple examples are provided by potential energy functions of the form</p>

<p>

<math display="block" id="Equipartition_theorem:43">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>pot</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>C</mi>
     <msup>
      <mi>q</mi>
      <mi>s</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>pot</ci>
    </apply>
    <apply>
     <times></times>
     <ci>C</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>q</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathrm{pot}}=Cq^{s},\,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>C</em> and <em>s</em> are arbitrary <a href="real_number" title="wikilink">real constants</a>. In these cases, the law of equipartition predicts that</p>

<p>

<math display="block" id="Equipartition_theorem:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <mi>q</mi>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>H</mi>
         <mi>pot</mi>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>q</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mrow>
       <mi>q</mi>
       <mo>⋅</mo>
       <mi>s</mi>
      </mrow>
      <mi>C</mi>
      <msup>
       <mi>q</mi>
       <mrow>
        <mi>s</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mi>s</mi>
      <mi>C</mi>
      <msup>
       <mi>q</mi>
       <mi>s</mi>
      </msup>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>s</mi>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msub>
       <mi>H</mi>
       <mi>pot</mi>
      </msub>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <ci>q</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <ci>pot</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>q</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <ci>q</ci>
        <ci>s</ci>
       </apply>
       <ci>C</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>q</ci>
        <apply>
         <minus></minus>
         <ci>s</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>C</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>q</ci>
        <ci>s</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>s</ci>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>pot</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{\rm B}T=\Bigl\langle q\frac{\partial H_{\mathrm{pot}}}{\partial q}\Bigr%
\rangle=\langle q\cdot sCq^{s-1}\rangle=\langle sCq^{s}\rangle=s\langle H_{%
\mathrm{pot}}\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, the average potential energy equals <em>k</em><sub>B</sub><em>T</em>/<em>s</em>, not <em>k</em><sub>B</sub><em>T</em>/2 as for the quadratic harmonic oscillator (where <em>s</em> = 2).</p>

<p>More generally, a typical energy function of a one-dimensional system has a <a href="Taylor_expansion" title="wikilink">Taylor expansion</a> in the extension <em>q</em>:</p>

<p>

<math display="block" id="Equipartition_theorem:45">
 <semantics>
  <mrow>
   <msub>
    <mi>H</mi>
    <mi>pot</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>=</mo>
      <mn>2</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>C</mi>
      <mi>n</mi>
     </msub>
     <msup>
      <mi>q</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>pot</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathrm{pot}}=\sum_{n=2}^{\infty}C_{n}q^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>for non-negative <a href="integer" title="wikilink">integers</a> <em>n</em>. There is no <em>n</em> = 1 term, because at the equilibrium point, there is no net force and so the first derivative of the energy is zero. The <em>n</em> = 0 term need not be included, since the energy at the equilibrium position may be set to zero by convention. In this case, the law of equipartition predicts that<a class="footnoteRef" href="#fn60" id="fnref60"><sup>60</sup></a></p>

<p>

<math display="block" id="Equipartition_theorem:46">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <mi>q</mi>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>H</mi>
         <mi>pot</mi>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>q</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>2</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <mrow>
        <mi>q</mi>
        <mo>⋅</mo>
        <mi>n</mi>
       </mrow>
       <msub>
        <mi>C</mi>
        <mi>n</mi>
       </msub>
       <msup>
        <mi>q</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>2</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mi>n</mi>
      <msub>
       <mi>C</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msup>
        <mi>q</mi>
        <mi>n</mi>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <ci>q</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <ci>pot</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>q</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <ci>q</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>C</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{B}T=\Bigl\langle q\frac{\partial H_{\mathrm{pot}}}{\partial q}\Bigr\rangle=%
\sum_{n=2}^{\infty}\langle q\cdot nC_{n}q^{n-1}\rangle=\sum_{n=2}^{\infty}nC_{%
n}\langle q^{n}\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>In contrast to the other examples cited here, the equipartition formula</p>

<p>

<math display="block" id="Equipartition_theorem:47">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <msub>
     <mi>H</mi>
     <mi>pot</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>3</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>2</mn>
        </mrow>
        <mn>2</mn>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <msub>
       <mi>C</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msup>
        <mi>q</mi>
        <mi>n</mi>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>pot</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>q</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H_{\mathrm{pot}}\rangle=\frac{1}{2}k_{\rm B}T-\sum_{n=3}^{\infty}\left%
(\frac{n-2}{2}\right)C_{n}\langle q^{n}\rangle
  </annotation>
 </semantics>
</math>

 does <em>not</em> allow the average potential energy to be written in terms of known constants.</p>
<h3 id="brownian-motion">Brownian motion</h3>

<p> </p>

<p>The equipartition theorem can be used to derive the <a href="Brownian_motion" title="wikilink">Brownian motion</a> of a particle from the <a href="Langevin_equation" title="wikilink">Langevin equation</a>.<a class="footnoteRef" href="#fn61" id="fnref61"><sup>61</sup></a> According to that equation, the motion of a particle of mass <em>m</em> with velocity <strong>v</strong> is governed by <a href="Newton's_laws_of_motion" title="wikilink">Newton's second law</a></p>

<p>

<math display="block" id="Equipartition_theorem:48">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>𝐯</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <mi>𝐅</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mfrac>
       <mi>𝐯</mi>
       <mi>τ</mi>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>m</mi>
      </mfrac>
      <msub>
       <mi>𝐅</mi>
       <mi>rnd</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>𝐯</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>m</ci>
      </apply>
      <ci>𝐅</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>𝐯</ci>
        <ci>τ</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐅</ci>
        <ci>rnd</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d\mathbf{v}}{dt}=\frac{1}{m}\mathbf{F}=-\frac{\mathbf{v}}{\tau}+\frac{1}%
{m}\mathbf{F}_{\mathrm{rnd}},
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>F</strong><sub>rnd</sub> is a random force representing the random collisions of the particle and the surrounding molecules, and where the <a href="time_constant" title="wikilink">time constant</a> τ reflects the <a href="drag_(physics)" title="wikilink">drag force</a> that opposes the particle's motion through the solution. The drag force is often written <strong>F</strong><sub>drag</sub> = −γ<strong>v</strong>; therefore, the time constant τ equals <em>m</em>/γ.</p>

<p>The dot product of this equation with the position vector <strong>r</strong>, after averaging, yields the equation</p>

<p>

<math display="block" id="Equipartition_theorem:49">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <mi>𝐫</mi>
      <mo>⋅</mo>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>𝐯</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>τ</mi>
     </mfrac>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mrow>
       <mi>𝐫</mi>
       <mo>⋅</mo>
       <mi>𝐯</mi>
      </mrow>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐫</ci>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>𝐯</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>τ</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <ci>normal-⋅</ci>
        <ci>𝐫</ci>
        <ci>𝐯</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle\mathbf{r}\cdot\frac{d\mathbf{v}}{dt}\Bigr\rangle+\frac{1}{\tau}%
\langle\mathbf{r}\cdot\mathbf{v}\rangle=0
  </annotation>
 </semantics>
</math>

</p>

<p>for Brownian motion (since the random force <strong>F</strong><sub>rnd</sub> is uncorrelated with the position <strong>r</strong>). Using the mathematical identities</p>

<p>

<math display="block" id="Equipartition_theorem:50">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mi>d</mi>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>𝐫</mi>
      <mo>⋅</mo>
      <mi>𝐫</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mi>d</mi>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>𝐫</mi>
      <mo>⋅</mo>
      <mi>𝐯</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐫</ci>
       <ci>𝐫</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <ci>normal-⋅</ci>
       <ci>𝐫</ci>
       <ci>𝐯</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d}{dt}\left(\mathbf{r}\cdot\mathbf{r}\right)=\frac{d}{dt}\left(r^{2}%
\right)=2\left(\mathbf{r}\cdot\mathbf{v}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="block" id="Equipartition_theorem:51">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mi>d</mi>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>𝐫</mi>
       <mo>⋅</mo>
       <mi>𝐯</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <mrow>
      <mi>𝐫</mi>
      <mo>⋅</mo>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>𝐯</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>d</ci>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐫</ci>
      <ci>𝐯</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>𝐫</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>𝐯</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d}{dt}\left(\mathbf{r}\cdot\mathbf{v}\right)=v^{2}+\mathbf{r}\cdot\frac{%
d\mathbf{v}}{dt},
  </annotation>
 </semantics>
</math>

</p>

<p>the basic equation for Brownian motion can be transformed into</p>

<p>

<math display="block" id="Equipartition_theorem:52">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <msup>
        <mi>d</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>t</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>τ</mi>
      </mfrac>
      <mfrac>
       <mi>d</mi>
       <mrow>
        <mi>d</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mo stretchy="false">⟨</mo>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">⟩</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">⟩</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>6</mn>
      <mi>m</mi>
     </mfrac>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>t</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>τ</ci>
       </apply>
       <apply>
        <divide></divide>
        <ci>d</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-⟨⟩</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">6</cn>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d^{2}}{dt^{2}}\langle r^{2}\rangle+\frac{1}{\tau}\frac{d}{dt}\langle r^{%
2}\rangle=2\langle v^{2}\rangle=\frac{6}{m}k_{\rm B}T,
  </annotation>
 </semantics>
</math>

</p>

<p>where the last equality follows from the equipartition theorem for translational kinetic energy:</p>

<p>

<math display="block" id="Equipartition_theorem:53">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msub>
      <mi>H</mi>
      <mi>kin</mi>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mfrac>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
      </mrow>
     </mfrac>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mi>m</mi>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>3</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>kin</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H_{\mathrm{kin}}\rangle=\Bigl\langle\frac{p^{2}}{2m}\Bigr\rangle=%
\langle\tfrac{1}{2}mv^{2}\rangle=\tfrac{3}{2}k_{\rm B}T.
  </annotation>
 </semantics>
</math>

</p>

<p>The above <a href="differential_equation" title="wikilink">differential equation</a> for 

<math display="inline" id="Equipartition_theorem:54">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <msup>
    <mi>r</mi>
    <mn>2</mn>
   </msup>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle r^{2}\rangle
  </annotation>
 </semantics>
</math>

 (with suitable initial conditions) may be solved exactly:</p>

<p>

<math display="block" id="Equipartition_theorem:55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mn>6</mn>
       <msub>
        <mi>k</mi>
        <mi mathvariant="normal">B</mi>
       </msub>
       <mi>T</mi>
       <msup>
        <mi>τ</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mi>m</mi>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>e</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>t</mi>
           <mo>/</mo>
           <mi>τ</mi>
          </mrow>
         </mrow>
        </msup>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <mi>t</mi>
        <mi>τ</mi>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">6</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>normal-B</ci>
       </apply>
       <ci>T</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>τ</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <ci>t</ci>
          <ci>τ</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <divide></divide>
       <ci>t</ci>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle r^{2}\rangle=\frac{6k_{\rm B}T\tau^{2}}{m}\left(e^{-t/\tau}-1+\frac{t}%
{\tau}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>On small time scales, with <em>t</em>  \langle r^{2} \rangle \approx \frac{3k_{\rm B} T}{m} t^{2} = \langle v^{2} \rangle t^{2}. </p>

<p>However, on long time scales, with <em>t</em> &gt;&gt; <em>τ</em>, the exponential and constant terms are negligible, and the squared distance grows only <em>linearly</em>:</p>

<p>

<math display="block" id="Equipartition_theorem:56">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mn>6</mn>
       <msub>
        <mi>k</mi>
        <mi>B</mi>
       </msub>
       <mi>T</mi>
       <mi>τ</mi>
      </mrow>
      <mi>m</mi>
     </mfrac>
     <mi>t</mi>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mn>6</mn>
      <msub>
       <mi>k</mi>
       <mi>B</mi>
      </msub>
      <mi>T</mi>
      <mi>t</mi>
     </mrow>
     <mi>γ</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">6</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>B</ci>
        </apply>
        <ci>T</ci>
        <ci>τ</ci>
       </apply>
       <ci>m</ci>
      </apply>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">6</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>B</ci>
       </apply>
       <ci>T</ci>
       <ci>t</ci>
      </apply>
      <ci>γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle r^{2}\rangle\approx\frac{6k_{B}T\tau}{m}t=\frac{6k_{B}Tt}{\gamma}.
  </annotation>
 </semantics>
</math>

</p>

<p>This describes the <a class="uri" href="diffusion" title="wikilink">diffusion</a> of the particle over time. An analogous equation for the rotational diffusion of a rigid molecule can be derived in a similar way.</p>
<h3 id="stellar-physics">Stellar physics</h3>

<p>The equipartition theorem and the related <a href="virial_theorem" title="wikilink">virial theorem</a> have long been used as a tool in <a class="uri" href="astrophysics" title="wikilink">astrophysics</a>.<a class="footnoteRef" href="#fn62" id="fnref62"><sup>62</sup></a> As examples, the virial theorem may be used to estimate stellar temperatures or the <a href="Chandrasekhar_limit" title="wikilink">Chandrasekhar limit</a> on the mass of <a href="white_dwarf" title="wikilink">white dwarf</a> stars.<a class="footnoteRef" href="#fn63" id="fnref63"><sup>63</sup></a><a class="footnoteRef" href="#fn64" id="fnref64"><sup>64</sup></a></p>

<p>The average temperature of a star can be estimated from the equipartition theorem.<a class="footnoteRef" href="#fn65" id="fnref65"><sup>65</sup></a> Since most stars are spherically symmetric, the total <a href="Newton's_law_of_universal_gravitation" title="wikilink">gravitational</a> <a href="Potential_energy#Gravitational_potential_energy" title="wikilink">potential energy</a> can be estimated by integration</p>

<p>

<math display="block" id="Equipartition_theorem:57">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>grav</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mi>R</mi>
      </msubsup>
      <mrow>
       <mfrac>
        <mrow>
         <mn>4</mn>
         <mi>π</mi>
         <msup>
          <mi>r</mi>
          <mn>2</mn>
         </msup>
         <mi>G</mi>
        </mrow>
        <mi>r</mi>
       </mfrac>
       <mi>M</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>r</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>ρ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>r</mi>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>r</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>grav</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <ci>R</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">4</cn>
         <ci>π</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>G</ci>
        </apply>
        <ci>r</ci>
       </apply>
       <ci>M</ci>
       <ci>r</ci>
       <ci>ρ</ci>
       <ci>r</ci>
       <ci>d</ci>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathrm{grav}}=-\int_{0}^{R}\frac{4\pi r^{2}G}{r}M(r)\,\rho(r)\,dr,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>M</em>(<em>r</em>) is the mass within a radius <em>r</em> and <em>ρ</em>(<em>r</em>) is the stellar density at radius <em>r</em>; <em>G</em> represents the <a href="gravitational_constant" title="wikilink">gravitational constant</a> and <em>R</em> the total radius of the star. Assuming a constant density throughout the star, this integration yields the formula</p>

<p>

<math display="block" id="Equipartition_theorem:58">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>grav</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mn>3</mn>
       <mi>G</mi>
       <msup>
        <mi>M</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mrow>
       <mn>5</mn>
       <mi>R</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>H</ci>
     <ci>grav</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>G</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">5</cn>
       <ci>R</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{\mathrm{grav}}=-\frac{3GM^{2}}{5R},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>M</em> is the star's total mass. Hence, the average potential energy of a single particle is</p>

<p>

<math display="block" id="Equipartition_theorem:59">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msub>
      <mi>H</mi>
      <mi>grav</mi>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msub>
      <mi>H</mi>
      <mi>grav</mi>
     </msub>
     <mi>N</mi>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mn>3</mn>
       <mi>G</mi>
       <msup>
        <mi>M</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mrow>
       <mn>5</mn>
       <mi>R</mi>
       <mi>N</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>grav</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>grav</ci>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>M</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">5</cn>
        <ci>R</ci>
        <ci>N</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H_{\mathrm{grav}}\rangle=\frac{H_{\mathrm{grav}}}{N}=-\frac{3GM^{2}}{5%
RN},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>N</em> is the number of particles in the star. Since most <a href="star" title="wikilink">stars</a> are composed mainly of <a href="ion" title="wikilink">ionized</a> <a class="uri" href="hydrogen" title="wikilink">hydrogen</a>, <em>N</em> equals roughly <em>M</em>/<em>m</em><sub>p</sub>, where <em>m</em><sub>p</sub> is the mass of one proton. Application of the equipartition theorem gives an estimate of the star's temperature</p>

<p>

<math display="block" id="Equipartition_theorem:60">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <mi>r</mi>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>H</mi>
         <mi>grav</mi>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>r</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mo>-</mo>
      <msub>
       <mi>H</mi>
       <mi>grav</mi>
      </msub>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mn>3</mn>
      <mi>G</mi>
      <msup>
       <mi>M</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mn>5</mn>
      <mi>R</mi>
      <mi>N</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <ci>r</ci>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <ci>grav</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>H</ci>
        <ci>grav</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>G</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>M</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">5</cn>
       <ci>R</ci>
       <ci>N</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle r\frac{\partial H_{\mathrm{grav}}}{\partial r}\Bigr\rangle=%
\langle-H_{\mathrm{grav}}\rangle=k_{B}T=\frac{3GM^{2}}{5RN}.
  </annotation>
 </semantics>
</math>

</p>

<p>Substitution of the mass and radius of the <a class="uri" href="Sun" title="wikilink">Sun</a> yields an estimated solar temperature of <em>T</em> = 14 million kelvins, very close to its core temperature of 15 million kelvins. However, the Sun is much more complex than assumed by this model—both its temperature and density vary strongly with radius—and such excellent agreement (≈7% <a href="approximation_error" title="wikilink">relative error</a>) is partly fortuitous.<a class="footnoteRef" href="#fn66" id="fnref66"><sup>66</sup></a></p>
<h3 id="star-formation">Star formation</h3>

<p>The same formulae may be applied to determining the conditions for <a href="star_formation" title="wikilink">star formation</a> in giant <a href="molecular_cloud" title="wikilink">molecular clouds</a>.<a class="footnoteRef" href="#fn67" id="fnref67"><sup>67</sup></a> A local fluctuation in the density of such a cloud can lead to a runaway condition in which the cloud collapses inwards under its own gravity. Such a collapse occurs when the equipartition theorem—or, equivalently, the <a href="virial_theorem" title="wikilink">virial theorem</a>—is no longer valid, i.e., when the gravitational potential energy exceeds twice the kinetic energy</p>

<p>

<math display="block" id="Equipartition_theorem:61">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mn>3</mn>
      <mi>G</mi>
      <msup>
       <mi>M</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mn>5</mn>
      <mi>R</mi>
     </mrow>
    </mfrac>
    <mo>></mo>
    <mrow>
     <mn>3</mn>
     <mi>N</mi>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>M</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">5</cn>
      <ci>R</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">3</cn>
     <ci>N</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>B</ci>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{3GM^{2}}{5R}>3Nk_{B}T.
  </annotation>
 </semantics>
</math>

</p>

<p>Assuming a constant density ρ for the cloud</p>

<p>

<math display="block" id="Equipartition_theorem:62">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>4</mn>
     <mn>3</mn>
    </mfrac>
    <mi>π</mi>
    <msup>
     <mi>R</mi>
     <mn>3</mn>
    </msup>
    <mi>ρ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>M</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">4</cn>
      <cn type="integer">3</cn>
     </apply>
     <ci>π</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>ρ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M=\frac{4}{3}\pi R^{3}\rho
  </annotation>
 </semantics>
</math>

</p>

<p>yields a minimum mass for stellar contraction, the Jeans mass <em>M</em><sub>J</sub></p>

<p>

<math display="block" id="Equipartition_theorem:63">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>M</mi>
     <mi mathvariant="normal">J</mi>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mn>5</mn>
         <msub>
          <mi>k</mi>
          <mi>B</mi>
         </msub>
         <mi>T</mi>
        </mrow>
        <mrow>
         <mi>G</mi>
         <msub>
          <mi>m</mi>
          <mi>p</mi>
         </msub>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mn>3</mn>
       <mrow>
        <mn>4</mn>
        <mi>π</mi>
        <mi>ρ</mi>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>normal-J</ci>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">5</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>B</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <apply>
        <times></times>
        <ci>G</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <ci>p</ci>
        </apply>
       </apply>
      </apply>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">3</cn>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>π</ci>
       <ci>ρ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{\rm J}^{2}=\left(\frac{5k_{B}T}{Gm_{p}}\right)^{3}\left(\frac{3}{4\pi\rho}%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>Substituting the values typically observed in such clouds (<em>T</em> = 150 K, ρ = 2

<math display="inline" id="Equipartition_theorem:64">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>×</mo>
   <mrow>
    <msup>
     <mn>10</mn>
     <mi mathvariant="normal">−</mi>
    </msup>
    <mn>16</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <csymbol cd="latexml">absent</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">10</cn>
      <ci>normal-−</ci>
     </apply>
     <cn type="integer">16</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \times 10^{−}16
  </annotation>
 </semantics>
</math>

 g/cm<sup>3</sup>) gives an estimated minimum mass of 17 solar masses, which is consistent with observed star formation. This effect is also known as the <a href="Jeans_instability" title="wikilink">Jeans instability</a>, after the British physicist <a href="James_Hopwood_Jeans" title="wikilink">James Hopwood Jeans</a> who published it in 1902.<a class="footnoteRef" href="#fn68" id="fnref68"><sup>68</sup></a></p>
<h2 id="derivations">Derivations</h2>
<h3 id="kinetic-energies-and-the-maxwellboltzmann-distribution">Kinetic energies and the Maxwell–Boltzmann distribution</h3>

<p>The original formulation of the equipartition theorem states that, in any physical system in <a href="thermal_equilibrium" title="wikilink">thermal equilibrium</a>, every particle has exactly the same average <a href="kinetic_energy" title="wikilink">kinetic energy</a>, (3/2)<em>k</em><sub>B</sub><em>T</em>.<a class="footnoteRef" href="#fn69" id="fnref69"><sup>69</sup></a> This may be shown using the <a href="Maxwell–Boltzmann_distribution" title="wikilink">Maxwell–Boltzmann distribution</a> (see Figure 2), which is the probability distribution</p>

<p>

<math display="block" id="Equipartition_theorem:65">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>4</mn>
    <mi>π</mi>
    <mpadded width="-3.4pt">
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mi>m</mi>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
         <msub>
          <mi>k</mi>
          <mi mathvariant="normal">B</mi>
         </msub>
         <mi>T</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>3</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mpadded>
    <msup>
     <mi>v</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo maxsize="160%" minsize="160%">(</mo>
      <mfrac>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>m</mi>
         <msup>
          <mi>v</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mrow>
        <mn>2</mn>
        <msub>
         <mi>k</mi>
         <mi mathvariant="normal">B</mi>
        </msub>
        <mi>T</mi>
       </mrow>
      </mfrac>
      <mo maxsize="160%" minsize="160%">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>v</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">4</cn>
     <ci>π</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <ci>m</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>π</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>normal-B</ci>
        </apply>
        <ci>T</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>v</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>m</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>v</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>normal-B</ci>
        </apply>
        <ci>T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(v)=4\pi\left(\frac{m}{2\pi k_{\rm B}T}\right)^{3/2}\!\!v^{2}\exp\Bigl(\frac{%
-mv^{2}}{2k_{\rm B}T}\Bigr)
  </annotation>
 </semantics>
</math>

</p>

<p>for the speed of a particle of mass <em>m</em> in the system, where the speed <em>v</em> is the magnitude 

<math display="inline" id="Equipartition_theorem:66">
 <semantics>
  <msqrt>
   <mrow>
    <msubsup>
     <mi>v</mi>
     <mi>x</mi>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>v</mi>
     <mi>y</mi>
     <mn>2</mn>
    </msubsup>
    <mo>+</mo>
    <msubsup>
     <mi>v</mi>
     <mi>z</mi>
     <mn>2</mn>
    </msubsup>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <ci>x</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <ci>y</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <ci>z</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{v_{x}^{2}+v_{y}^{2}+v_{z}^{2}}
  </annotation>
 </semantics>
</math>


 of the <a class="uri" href="velocity" title="wikilink">velocity</a> <a href="Vector_(geometric)" title="wikilink">vector</a> 

<math display="inline" id="Equipartition_theorem:67">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐯</mi>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>v</mi>
      <mi>x</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>v</mi>
      <mi>y</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>v</mi>
      <mi>z</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐯</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>v</ci>
      <ci>z</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{v}=(v_{x},v_{y},v_{z}).
  </annotation>
 </semantics>
</math>

</p>

<p>The Maxwell–Boltzmann distribution applies to any system composed of atoms, and assumes only a <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>, specifically, that the kinetic energies are distributed according to their <a href="Boltzmann_factor" title="wikilink">Boltzmann factor</a> at a temperature <em>T</em>.<a class="footnoteRef" href="#fn70" id="fnref70"><sup>70</sup></a> The average kinetic energy for a particle of mass <em>m</em> is then given by the integral formula</p>

<p>

<math display="block" id="Equipartition_theorem:68">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <msub>
      <mi>H</mi>
      <mi>kin</mi>
     </msub>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mi>m</mi>
      <msup>
       <mi>v</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mn>0</mn>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <mstyle displaystyle="false">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mstyle>
      <mi>m</mi>
      <mpadded width="+5pt">
       <msup>
        <mi>v</mi>
        <mn>2</mn>
       </msup>
      </mpadded>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>v</mi>
       <mo rspace="7.5pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <mi>v</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>3</mn>
       <mn>2</mn>
      </mfrac>
     </mstyle>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>kin</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>m</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>f</ci>
       <ci>v</ci>
       <ci>d</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H_{\mathrm{kin}}\rangle=\langle\tfrac{1}{2}mv^{2}\rangle=\int_{0}^{%
\infty}\tfrac{1}{2}mv^{2}\ f(v)\ dv=\tfrac{3}{2}k_{\rm B}T,
  </annotation>
 </semantics>
</math>

</p>

<p>as stated by the equipartition theorem. The same result can also be obtained by averaging the particle energy using the probability of finding the particle in certain quantum energy state.<a class="footnoteRef" href="#fn71" id="fnref71"><sup>71</sup></a></p>
<h3 id="quadratic-energies-and-the-partition-function">Quadratic energies and the partition function</h3>

<p>More generally, the equipartition theorem states that any <a href="degrees_of_freedom_(physics_and_chemistry)" title="wikilink">degree of freedom</a> <em>x</em> which appears in the total energy <em>H</em> only as a simple quadratic term <em>Ax</em><sup>2</sup>, where <em>A</em> is a constant, has an average energy of ½<em>k</em><sub>B</sub><em>T</em> in thermal equilibrium. In this case the equipartition theorem may be derived from the <a href="Partition_function_(statistical_mechanics)" title="wikilink">partition function</a> <em>Z</em>(<em>β</em>), where <em>β</em> = 1/(<em>k</em><sub>B</sub><em>T</em>) is the canonical <a href="inverse_temperature" title="wikilink">inverse temperature</a>.<a class="footnoteRef" href="#fn72" id="fnref72"><sup>72</sup></a> Integration over the variable <em>x</em> yields a factor</p>

<p>

<math display="block" id="Equipartition_theorem:69">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Z</mi>
     <mi>x</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mo>-</mo>
       <mi mathvariant="normal">∞</mi>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </msubsup>
     <mrow>
      <mi>d</mi>
      <mpadded width="+5pt">
       <mi>x</mi>
      </mpadded>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mi>A</mi>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msqrt>
     <mfrac>
      <mi>π</mi>
      <mrow>
       <mi>β</mi>
       <mi>A</mi>
      </mrow>
     </mfrac>
    </msqrt>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Z</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <ci>A</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <ci>π</ci>
       <apply>
        <times></times>
        <ci>β</ci>
        <ci>A</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z_{x}=\int_{-\infty}^{\infty}dx\ e^{-\beta Ax^{2}}=\sqrt{\frac{\pi}{\beta A}},
  </annotation>
 </semantics>
</math>

</p>

<p>in the formula for <em>Z</em>. The mean energy associated with this factor is given by</p>

<p>

<math display="block" id="Equipartition_theorem:70">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <msub>
     <mi>H</mi>
     <mi>x</mi>
    </msub>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo>∂</mo>
       <mi>log</mi>
      </mrow>
      <msub>
       <mi>Z</mi>
       <mi>x</mi>
      </msub>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>β</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mn>2</mn>
     <mi>β</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msub>
     <mi>k</mi>
     <mi mathvariant="normal">B</mi>
    </msub>
    <mi>T</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <partialdiff></partialdiff>
         <log></log>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Z</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>β</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H_{x}\rangle=-\frac{\partial\log Z_{x}}{\partial\beta}=\frac{1}{2\beta%
}=\frac{1}{2}k_{\rm B}T
  </annotation>
 </semantics>
</math>

</p>

<p>as stated by the equipartition theorem.</p>
<h3 id="general-proofs">General proofs</h3>

<p>General derivations of the equipartition theorem can be found in many <a href="statistical_mechanics" title="wikilink">statistical mechanics</a> textbooks, both for the <a href="microcanonical_ensemble" title="wikilink">microcanonical ensemble</a><a class="footnoteRef" href="#fn73" id="fnref73"><sup>73</sup></a><a class="footnoteRef" href="#fn74" id="fnref74"><sup>74</sup></a> and for the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>.<a class="footnoteRef" href="#fn75" id="fnref75"><sup>75</sup></a><a class="footnoteRef" href="#fn76" id="fnref76"><sup>76</sup></a> They involve taking averages over the <a href="phase_space" title="wikilink">phase space</a> of the system, which is a <a href="symplectic_manifold" title="wikilink">symplectic manifold</a>.</p>

<p>To explain these derivations, the following notation is introduced. First, the phase space is described in terms of <a href="canonical_coordinates" title="wikilink">generalized position coordinates</a> <em>q</em><sub><em>j</em></sub> together with their <a href="conjugate_momentum" title="wikilink">conjugate momenta</a> <em>p</em><sub><em>j</em></sub>. The quantities <em>q</em><sub><em>j</em></sub> completely describe the <a href="configuration_space" title="wikilink">configuration</a> of the system, while the quantities (<em>q</em><sub><em>j</em></sub>,<em>p</em><sub><em>j</em></sub>) together completely describe its <a href="Classical_mechanics" title="wikilink">state</a>.</p>

<p>Secondly, the infinitesimal volume</p>

<p>

<math display="block" id="Equipartition_theorem:71">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mi mathvariant="normal">Γ</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mi>i</mi>
    </munder>
    <mrow>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>q</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
     <mi>d</mi>
     <mpadded width="+1.7pt">
      <msub>
       <mi>p</mi>
       <mi>i</mi>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>normal-Γ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <ci>i</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>i</ci>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\Gamma=\prod_{i}dq_{i}\,dp_{i}\,
  </annotation>
 </semantics>
</math>

</p>

<p>of the phase space is introduced and used to define the volume Γ(<em>E</em>, Δ<em>E</em>) of the portion of phase space where the energy <em>H</em> of the system lies between two limits, <em>E</em> and <em>E</em> + Δ<em>E</em>:</p>

<p>

<math display="block" id="Equipartition_theorem:72">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Γ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>E</mi>
      <mo>,</mo>
      <mrow>
       <mi mathvariant="normal">Δ</mi>
       <mi>E</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>H</mi>
       <mo>∈</mo>
       <mrow>
        <mo>[</mo>
        <mi>E</mi>
        <mo>,</mo>
        <mrow>
         <mi>E</mi>
         <mo>+</mo>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <mi>E</mi>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
      </mrow>
     </msub>
     <mrow>
      <mi>d</mi>
      <mi mathvariant="normal">Γ</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Γ</ci>
     <interval closure="open">
      <ci>E</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>E</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <apply>
       <in></in>
       <ci>H</ci>
       <interval closure="closed">
        <ci>E</ci>
        <apply>
         <plus></plus>
         <ci>E</ci>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>E</ci>
         </apply>
        </apply>
       </interval>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>normal-Γ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma(E,\Delta E)=\int_{H\in\left[E,E+\Delta E\right]}d\Gamma.
  </annotation>
 </semantics>
</math>

 In this expression, Δ<em>E</em> is assumed to be very small, Δ<em>E</em>  \Sigma (E) = \int_{H </p>

<p>Since Δ<em>E</em> is very small, the following integrations are equivalent</p>

<p>

<math display="block" id="Equipartition_theorem:73">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mi>H</mi>
       <mo>∈</mo>
       <mrow>
        <mo>[</mo>
        <mi>E</mi>
        <mo>,</mo>
        <mrow>
         <mi>E</mi>
         <mo>+</mo>
         <mrow>
          <mi mathvariant="normal">Δ</mi>
          <mi>E</mi>
         </mrow>
        </mrow>
        <mo>]</mo>
       </mrow>
      </mrow>
     </msub>
     <mrow>
      <mi mathvariant="normal">…</mi>
      <mi>d</mi>
      <mi mathvariant="normal">Γ</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>E</mi>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>E</mi>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mi>H</mi>
        <mo><</mo>
        <mi>E</mi>
       </mrow>
      </msub>
      <mrow>
       <mi mathvariant="normal">…</mi>
       <mi>d</mi>
       <mi mathvariant="normal">Γ</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <int></int>
      <apply>
       <in></in>
       <ci>H</ci>
       <interval closure="closed">
        <ci>E</ci>
        <apply>
         <plus></plus>
         <ci>E</ci>
         <apply>
          <times></times>
          <ci>normal-Δ</ci>
          <ci>E</ci>
         </apply>
        </apply>
       </interval>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>normal-…</ci>
      <ci>d</ci>
      <ci>normal-Γ</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>E</ci>
     <apply>
      <divide></divide>
      <partialdiff></partialdiff>
      <apply>
       <partialdiff></partialdiff>
       <ci>E</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <apply>
        <lt></lt>
        <ci>H</ci>
        <ci>E</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>normal-…</ci>
       <ci>d</ci>
       <ci>normal-Γ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{H\in\left[E,E+\Delta E\right]}\ldots d\Gamma=\Delta E\frac{\partial}{%
\partial E}\int_{H<E}\ldots d\Gamma,
  </annotation>
 </semantics>
</math>

</p>

<p>where the ellipses represent the integrand. From this, it follows that Γ is proportional to Δ<em>E</em></p>

<p>

<math display="block" id="Equipartition_theorem:74">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Γ</mi>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+5pt">
      <mi>E</mi>
     </mpadded>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi mathvariant="normal">Σ</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>E</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mpadded width="+5pt">
      <mi>E</mi>
     </mpadded>
     <mi>ρ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>E</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>normal-Γ</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>E</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Σ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>E</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>E</ci>
      <ci>ρ</ci>
      <ci>E</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Gamma=\Delta E\ \frac{\partial\Sigma}{\partial E}=\Delta E\ \rho(E),
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>ρ</em>(<em>E</em>) is the <a href="density_of_states" title="wikilink">density of states</a>. By the usual definitions of <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>, the <a class="uri" href="entropy" title="wikilink">entropy</a> <em>S</em> equals <em>k</em><sub>B</sub> log <em>Σ(</em>E''), and the <a class="uri" href="temperature" title="wikilink">temperature</a> <em>T</em> is defined by</p>

<p>

<math display="block" id="Equipartition_theorem:75">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>T</mi>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>S</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>E</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mfrac>
      <mrow>
       <mrow>
        <mo>∂</mo>
        <mi>log</mi>
       </mrow>
       <mi mathvariant="normal">Σ</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>E</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi mathvariant="normal">B</mi>
     </msub>
     <mpadded width="+1.7pt">
      <mfrac>
       <mn>1</mn>
       <mi mathvariant="normal">Σ</mi>
      </mfrac>
     </mpadded>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi mathvariant="normal">Σ</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>E</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>T</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>S</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>E</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <partialdiff></partialdiff>
         <log></log>
        </apply>
        <ci>normal-Σ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>E</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>normal-B</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>normal-Σ</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>normal-Σ</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>E</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{T}=\frac{\partial S}{\partial E}=k_{\rm B}\frac{\partial\log\Sigma}{%
\partial E}=k_{\rm B}\frac{1}{\Sigma}\,\frac{\partial\Sigma}{\partial E}.
  </annotation>
 </semantics>
</math>

</p>
<h4 id="the-canonical-ensemble">The canonical ensemble</h4>

<p>In the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>, the system is in <a href="thermal_equilibrium" title="wikilink">thermal equilibrium</a> with an infinite heat bath at <a class="uri" href="temperature" title="wikilink">temperature</a> <em>T</em> (in kelvins).<a class="footnoteRef" href="#fn77" id="fnref77"><sup>77</sup></a><a class="footnoteRef" href="#fn78" id="fnref78"><sup>78</sup></a> The probability of each state in <a href="phase_space" title="wikilink">phase space</a> is given by its <a href="Boltzmann_factor" title="wikilink">Boltzmann factor</a> times a <a href="normalization_factor" title="wikilink">normalization factor</a> 

<math display="inline" id="Equipartition_theorem:76">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒩</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒩</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}
  </annotation>
 </semantics>
</math>

, which is chosen so that the probabilities sum to one</p>

<p>

<math display="block" id="Equipartition_theorem:77">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">𝒩</mi>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>β</mi>
          <mi>H</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>p</mi>
           <mo>,</mo>
           <mi>q</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </msup>
       <mi>d</mi>
       <mi mathvariant="normal">Γ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝒩</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <ci>H</ci>
          <interval closure="open">
           <ci>p</ci>
           <ci>q</ci>
          </interval>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>normal-Γ</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}\int e^{-\beta H(p,q)}d\Gamma=1,
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>β</em> = 1/<em>k</em><sub>B</sub><em>T</em>. <a href="Integration_by_parts" title="wikilink">Integration by parts</a> for a phase-space variable <em>x<sub>k</sub></em> (which could be either <em>q<sub>k</sub></em> or <em>p<sub>k</sub></em>) between two limits <em>a</em> and <em>b</em> yields the equation</p>

<p>

<math display="block" id="Equipartition_theorem:78">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒩</mi>
      <mrow>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <msubsup>
         <mrow>
          <mo>[</mo>
          <mrow>
           <msup>
            <mi>e</mi>
            <mrow>
             <mo>-</mo>
             <mrow>
              <mi>β</mi>
              <mi>H</mi>
              <mrow>
               <mo stretchy="false">(</mo>
               <mi>p</mi>
               <mo>,</mo>
               <mi>q</mi>
               <mo stretchy="false">)</mo>
              </mrow>
             </mrow>
            </mrow>
           </msup>
           <msub>
            <mi>x</mi>
            <mi>k</mi>
           </msub>
          </mrow>
          <mo>]</mo>
         </mrow>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
          <mo>=</mo>
          <mi>a</mi>
         </mrow>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
          <mo>=</mo>
          <mi>b</mi>
         </mrow>
        </msubsup>
        <mi>d</mi>
        <msub>
         <mi mathvariant="normal">Γ</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒩</mi>
      <mrow>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <msup>
         <mi>e</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>β</mi>
           <mi>H</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>p</mi>
            <mo>,</mo>
            <mi>q</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
         </mrow>
        </msup>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
        <mi>β</mi>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>H</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
         </mrow>
        </mfrac>
        <mi>d</mi>
        <mi mathvariant="normal">Γ</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>𝒩</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>e</ci>
             <apply>
              <minus></minus>
              <apply>
               <times></times>
               <ci>β</ci>
               <ci>H</ci>
               <interval closure="open">
                <ci>p</ci>
                <ci>q</ci>
               </interval>
              </apply>
             </apply>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>x</ci>
             <ci>k</ci>
            </apply>
           </apply>
          </apply>
          <apply>
           <eq></eq>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>k</ci>
           </apply>
           <ci>a</ci>
          </apply>
         </apply>
         <apply>
          <eq></eq>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>k</ci>
          </apply>
          <ci>b</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-Γ</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>𝒩</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>β</ci>
           <ci>H</ci>
           <interval closure="open">
            <ci>p</ci>
            <ci>q</ci>
           </interval>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>β</ci>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>normal-Γ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}\int\left[e^{-\beta H(p,q)}x_{k}\right]_{x_{k}=a}^{x_{k}=b}d\Gamma_%
{k}+\mathcal{N}\int e^{-\beta H(p,q)}x_{k}\beta\frac{\partial H}{\partial x_{k%
}}d\Gamma=1,
  </annotation>
 </semantics>
</math>

</p>

<p>where d<em>Γ<sub>k</sub></em> = d<em>Γ</em>/d<em>x<sub>k</sub></em>, i.e., the first integration is not carried out over <em>x<sub>k</sub></em>. The first term is usually zero, either because <em>x<sub>k</sub></em> is zero at the limits, or because the energy goes to infinity at those limits. In that case, the equipartition theorem for the canonical ensemble follows immediately</p>

<p>

<math display="block" id="Equipartition_theorem:79">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi class="ltx_font_mathcaligraphic">𝒩</mi>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>β</mi>
          <mi>H</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>p</mi>
           <mo>,</mo>
           <mi>q</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </msup>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>H</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
         </mrow>
        </mfrac>
       </mpadded>
       <mi>d</mi>
       <mi mathvariant="normal">Γ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>β</mi>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>𝒩</ci>
      <apply>
       <int></int>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>β</ci>
           <ci>H</ci>
           <interval closure="open">
            <ci>p</ci>
            <ci>q</ci>
           </interval>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>H</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>normal-Γ</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>β</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}\int e^{-\beta H(p,q)}x_{k}\frac{\partial H}{\partial x_{k}}\,d%
\Gamma=\Bigl\langle x_{k}\frac{\partial H}{\partial x_{k}}\Bigr\rangle=\frac{1%
}{\beta}=k_{B}T.
  </annotation>
 </semantics>
</math>

</p>

<p>Here, the averaging symbolized by 

<math display="inline" id="Equipartition_theorem:80">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi mathvariant="normal">…</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>normal-…</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\ldots\rangle
  </annotation>
 </semantics>
</math>

 is the <a href="ensemble_average" title="wikilink">ensemble average</a> taken over the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>.</p>
<h4 id="the-microcanonical-ensemble">The microcanonical ensemble</h4>

<p>In the microcanonical ensemble, the system is isolated from the rest of the world, or at least very weakly coupled to it.<a class="footnoteRef" href="#fn79" id="fnref79"><sup>79</sup></a> Hence, its total energy is effectively constant; to be definite, we say that the total energy <em>H</em> is confined between <em>E</em> and <em>E</em>+d<em>E</em>. For a given energy <em>E</em> and spread d<em>E</em>, there is a region of <a href="phase_space" title="wikilink">phase space</a> Γ in which the system has that energy, and the probability of each state in that region of <a href="phase_space" title="wikilink">phase space</a> is equal, by the definition of the microcanonical ensemble. Given these definitions, the equipartition average of phase-space variables <em>x<sub>m</sub></em> (which could be either <em>q<sub>k</sub></em>or <em>p<sub>k</sub></em>) and <em>x<sub>n</sub></em> is given by</p>

<p>

<math display="inline" id="Equipartition_theorem:81">
 <semantics>
  <mrow>
   <mo maxsize="160%" minsize="160%">⟨</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>m</mi>
    </msub>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mi>H</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </mfrac>
    </mstyle>
   </mrow>
   <mo maxsize="160%" minsize="160%">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>m</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>H</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\Bigl\langle x_{m}\frac{\partial H}{\partial x_{n}}\Bigr\rangle
  </annotation>
 </semantics>
</math>


</p>

<p>where the last equality follows because <em>E</em> is a constant that does not depend on <em>x<sub>n</sub></em>. <a href="Integration_by_parts" title="wikilink">Integrating by parts</a> yields the relation</p>

<p>

<math display="inline" id="Equipartition_theorem:82">
 <semantics>
  <mrow>
   <mstyle displaystyle="true">
    <msub>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>H</mi>
      <mo><</mo>
      <mi>E</mi>
     </mrow>
    </msub>
   </mstyle>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>m</mi>
    </msub>
    <mpadded width="+1.7pt">
     <mstyle displaystyle="true">
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>H</mi>
          <mo>-</mo>
          <mi>E</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mstyle>
    </mpadded>
    <mi>d</mi>
    <mi mathvariant="normal">Γ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <int></int>
     <apply>
      <lt></lt>
      <ci>H</ci>
      <ci>E</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>m</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <minus></minus>
        <ci>H</ci>
        <ci>E</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>d</ci>
     <ci>normal-Γ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\int_{H<E}x_{m}\frac{\partial(H-E)}{\partial x_{n}}\,d\Gamma
  </annotation>
 </semantics>
</math>


 since the first term on the right hand side of the first line is zero (it can be rewritten as an integral of <em>H</em> − <em>E</em> on the <a class="uri" href="hypersurface" title="wikilink">hypersurface</a> where <em>H</em> = <em>E</em>).</p>

<p>Substitution of this result into the previous equation yields</p>

<p>

<math display="block" id="Equipartition_theorem:83">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>m</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <mpadded width="+1.7pt">
      <mfrac>
       <mn>1</mn>
       <mi>ρ</mi>
      </mfrac>
     </mpadded>
     <mfrac>
      <mo>∂</mo>
      <mrow>
       <mo>∂</mo>
       <mi>E</mi>
      </mrow>
     </mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mi>H</mi>
        <mo><</mo>
        <mi>E</mi>
       </mrow>
      </msub>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>E</mi>
         <mo>-</mo>
         <mi>H</mi>
        </mrow>
        <mo rspace="4.2pt">)</mo>
       </mrow>
       <mi>d</mi>
       <mi mathvariant="normal">Γ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <mpadded width="+1.7pt">
      <mfrac>
       <mn>1</mn>
       <mi>ρ</mi>
      </mfrac>
     </mpadded>
     <mrow>
      <mpadded width="+1.7pt">
       <msub>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <mi>H</mi>
         <mo><</mo>
         <mi>E</mi>
        </mrow>
       </msub>
      </mpadded>
      <mrow>
       <mi>d</mi>
       <mi mathvariant="normal">Γ</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <mfrac>
      <mi mathvariant="normal">Σ</mi>
      <mi>ρ</mi>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>ρ</ci>
      </apply>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>E</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <lt></lt>
         <ci>H</ci>
         <ci>E</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>E</ci>
         <ci>H</ci>
        </apply>
        <ci>d</ci>
        <ci>normal-Γ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>ρ</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <lt></lt>
         <ci>H</ci>
         <ci>E</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>normal-Γ</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>normal-Σ</ci>
       <ci>ρ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle x_{m}\frac{\partial H}{\partial x_{n}}\Bigr\rangle=\delta_{mn}%
\frac{1}{\rho}\,\frac{\partial}{\partial E}\int_{H<E}\left(E-H\right)\,d\Gamma%
=\delta_{mn}\frac{1}{\rho}\,\int_{H<E}\,d\Gamma=\delta_{mn}\frac{\Sigma}{\rho}.
  </annotation>
 </semantics>
</math>

</p>

<p>Since 

<math display="inline" id="Equipartition_theorem:84">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi mathvariant="normal">Σ</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>E</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ρ</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>normal-Σ</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>E</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho=\frac{\partial\Sigma}{\partial E}
  </annotation>
 </semantics>
</math>

 the equipartition theorem follows:</p>

<p>

<math display="block" id="Equipartition_theorem:85">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>m</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <msup>
      <mrow>
       <mo maxsize="160%" minsize="160%">(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mi mathvariant="normal">Σ</mi>
        </mfrac>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi mathvariant="normal">Σ</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <mi>E</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo maxsize="160%" minsize="160%">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <msup>
      <mrow>
       <mo maxsize="160%" minsize="160%">(</mo>
       <mfrac>
        <mrow>
         <mrow>
          <mo>∂</mo>
          <mi>log</mi>
         </mrow>
         <mi mathvariant="normal">Σ</mi>
        </mrow>
        <mrow>
         <mo>∂</mo>
         <mi>E</mi>
        </mrow>
       </mfrac>
       <mo maxsize="160%" minsize="160%">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>H</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <ci>normal-Σ</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <partialdiff></partialdiff>
          <ci>normal-Σ</ci>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <ci>E</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <partialdiff></partialdiff>
          <log></log>
         </apply>
         <ci>normal-Σ</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>E</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>δ</ci>
       <apply>
        <times></times>
        <ci>m</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>B</ci>
      </apply>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl\langle x_{m}\frac{\partial H}{\partial x_{n}}\Bigr\rangle=\delta_{mn}%
\Bigl(\frac{1}{\Sigma}\frac{\partial\Sigma}{\partial E}\Bigr)^{-1}=\delta_{mn}%
\Bigl(\frac{\partial\log\Sigma}{\partial E}\Bigr)^{-1}=\delta_{mn}k_{B}T.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, we have derived the <a href="#General_formulation_for_all_energies" title="wikilink">general formulation of the equipartition theorem</a></p>
<div style="border:2px solid black; padding:3px; margin-left: 0em; width: 250px;
text-align:left">

<p>

<math display="block" id="Equipartition_theorem:86">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo lspace="0.8pt" maxsize="160%" minsize="160%">⟨</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>m</mi>
      </msub>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>H</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo maxsize="160%" minsize="160%">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>δ</mi>
      <mrow>
       <mi>m</mi>
       <mi>n</mi>
      </mrow>
     </msub>
     <msub>
      <mi>k</mi>
      <mi>B</mi>
     </msub>
     <mi>T</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>H</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>δ</ci>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <ci>B</ci>
     </apply>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \!\Bigl\langle x_{m}\frac{\partial H}{\partial x_{n}}\Bigr\rangle=\delta_{mn}k%
_{B}T,
  </annotation>
 </semantics>
</math>

</p>
</div>

<p>which was so useful in the <a href="#Applications" title="wikilink">applications</a> described above.</p>
<h2 id="limitations">Limitations</h2>
<figure><b>(Figure)</b>
<figcaption>Figure 9. Energy is <em>not</em> shared among the various <a href="normal_modes" title="wikilink">normal modes</a> in an isolated system of ideal coupled <a href="harmonic_oscillator" title="wikilink">oscillators</a>; the energy in each mode is constant and independent of the energy in the other modes. Hence, the equipartition theorem does <em>not</em> hold for such a system in the <a href="microcanonical_ensemble" title="wikilink">microcanonical ensemble</a> (when isolated), although it does hold in the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a> (when coupled to a heat bath). However, by adding a sufficiently strong nonlinear coupling between the modes, energy will be shared and equipartition holds in both ensembles.</figcaption>
</figure>
<h3 id="requirement-of-ergodicity">Requirement of ergodicity</h3>

<p>The law of equipartition holds only for <a href="ergodic_hypothesis" title="wikilink">ergodic</a> systems in <a href="thermal_equilibrium" title="wikilink">thermal equilibrium</a>, which implies that all states with the same energy must be equally likely to be populated.<a class="footnoteRef" href="#fn80" id="fnref80"><sup>80</sup></a> Consequently, it must be possible to exchange energy among all its various forms within the system, or with an external <a href="heat_bath" title="wikilink">heat bath</a> in the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a>. The number of physical systems that have been rigorously proven to be ergodic is small; a famous example is the <a href="dynamical_billiards" title="wikilink">hard-sphere system</a> of <a href="Yakov_G._Sinai" title="wikilink">Yakov Sinai</a>.<a class="footnoteRef" href="#fn81" id="fnref81"><sup>81</sup></a> The requirements for isolated systems to ensure <a href="ergodic_theory" title="wikilink">ergodicity</a>—and, thus equipartition—have been studied, and provided motivation for the modern <a href="chaos_theory" title="wikilink">chaos theory</a> of <a href="dynamical_system" title="wikilink">dynamical systems</a>. A chaotic <a href="Hamiltonian_system" title="wikilink">Hamiltonian system</a> need not be ergodic, although that is usually a good assumption.<a class="footnoteRef" href="#fn82" id="fnref82"><sup>82</sup></a></p>

<p>A commonly cited counter-example where energy is <em>not</em> shared among its various forms and where equipartition does <em>not</em> hold in the microcanonical ensemble is a system of coupled harmonic oscillators.<a class="footnoteRef" href="#fn83" id="fnref83"><sup>83</sup></a> If the system is isolated from the rest of the world, the energy in each <a href="normal_mode" title="wikilink">normal mode</a> is constant; energy is not transferred from one mode to another. Hence, equipartition does not hold for such a system; the amount of energy in each normal mode is fixed at its initial value. If sufficiently strong nonlinear terms are present in the <a class="uri" href="energy" title="wikilink">energy</a> function, energy may be transferred between the normal modes, leading to ergodicity and rendering the law of equipartition valid. However, the <a href="Kolmogorov–Arnold–Moser_theorem" title="wikilink">Kolmogorov–Arnold–Moser theorem</a> states that energy will not be exchanged unless the nonlinear perturbations are strong enough; if they are too small, the energy will remain trapped in at least some of the modes.</p>

<p>Another way ergodicity can be broken is by the existence of nonlinear <a class="uri" href="soliton" title="wikilink">soliton</a> symmetries. In 1953, <a href="Enrico_Fermi" title="wikilink">Fermi</a>, <a href="John_Pasta" title="wikilink">Pasta</a>, <a href="Stanislaw_Ulam" title="wikilink">Ulam</a> and Mary Tsingou conducted <a href="Fermi–Pasta–Ulam_problem" title="wikilink">computer simulations</a> of a vibrating string that included a non-linear term (quadratic in one test, cubic in another, and a piecewise linear approximation to a cubic in a third). They found that the behavior of the system was quite different from what intuition based on equipartition would have led them to expect. Instead of the energies in the modes becoming equally shared, the system exhibited a very complicated quasi-periodic behavior. This puzzling result was eventually explained by Kruskal and Zabusky in 1965 in a paper which, by connecting the simulated system to the <a href="Korteweg–de_Vries_equation" title="wikilink">Korteweg–de Vries equation</a> led to the development of soliton mathematics.</p>
<h3 id="failure-due-to-quantum-effects">Failure due to quantum effects</h3>

<p>The law of equipartition breaks down when the thermal energy <em>k<sub>B</sub>T</em> is significantly smaller than the spacing between energy levels. Equipartition no longer holds because it is a poor approximation to assume that the energy levels form a smooth <a href="continuum_(theory)" title="wikilink">continuum</a>, which is required in the <a href="#Derivations" title="wikilink">derivations of the equipartition theorem above</a>.<a class="footnoteRef" href="#fn84" id="fnref84"><sup>84</sup></a><a class="footnoteRef" href="#fn85" id="fnref85"><sup>85</sup></a> Historically, the failures of the classical equipartition theorem to explain <a href="specific_heats" title="wikilink">specific heats</a> and <a href="blackbody_radiation" title="wikilink">blackbody radiation</a> were critical in showing the need for a new theory of matter and radiation, namely, <a href="quantum_mechanics" title="wikilink">quantum mechanics</a> and <a href="quantum_field_theory" title="wikilink">quantum field theory</a>.<a class="footnoteRef" href="#fn86" id="fnref86"><sup>86</sup></a></p>
<figure><b>(Figure)</b>
<figcaption>Figure 10. Log–log plot of the average energy of a quantum mechanical oscillator (shown in red) as a function of temperature. For comparison, the value predicted by the equipartition theorem is shown in black. At high temperatures, the two agree nearly perfectly, but at low temperatures when <em>k<sub>B</sub>T &gt; k<sub>B</sub>T</em>) is almost zero.</figcaption>
</figure>

<p>To illustrate the breakdown of equipartition, consider the average energy in a single (quantum) harmonic oscillator, which was discussed above for the classical case. Neglecting the irrelevant <a href="zero-point_energy" title="wikilink">zero-point energy</a> term, its quantum energy levels are given by <em>E<sub>n</sub> = nhν</em>, where <em>h</em> is the <a href="Planck_constant" title="wikilink">Planck constant</a>, <em>ν</em> is the <a href="fundamental_frequency" title="wikilink">fundamental frequency</a> of the oscillator, and <em>n</em> is an integer. The probability of a given energy level being populated in the <a href="canonical_ensemble" title="wikilink">canonical ensemble</a> is given by its <a href="Boltzmann_factor" title="wikilink">Boltzmann factor</a></p>

<p>

<math display="block" id="Equipartition_theorem:87">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>E</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mi>β</mi>
        <mi>h</mi>
        <mi>ν</mi>
       </mrow>
      </mrow>
     </msup>
     <mi>Z</mi>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>P</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>β</ci>
        <ci>h</ci>
        <ci>ν</ci>
       </apply>
      </apply>
     </apply>
     <ci>Z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(E_{n})=\frac{e^{-n\beta h\nu}}{Z},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>β</em> = 1/<em>k</em><sub>B</sub><em>T</em> and the denominator <em>Z</em> is the <a href="partition_function_(statistical_mechanics)" title="wikilink">partition function</a>, here a <a href="geometric_series" title="wikilink">geometric series</a></p>

<p>

<math display="block" id="Equipartition_theorem:88">
 <semantics>
  <mrow>
   <mrow>
    <mi>Z</mi>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>n</mi>
        <mi>β</mi>
        <mi>h</mi>
        <mi>ν</mi>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mi>h</mi>
         <mi>ν</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>Z</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>n</ci>
         <ci>β</ci>
         <ci>h</ci>
         <ci>ν</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <ci>h</ci>
          <ci>ν</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z=\sum_{n=0}^{\infty}e^{-n\beta h\nu}=\frac{1}{1-e^{-\beta h\nu}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Its average energy is given by</p>

<p>

<math display="block" id="Equipartition_theorem:89">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>H</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>E</mi>
       <mi>n</mi>
      </msub>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>E</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>Z</mi>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mrow>
       <mi>n</mi>
       <mi>h</mi>
       <mpadded width="+5pt">
        <mi>ν</mi>
       </mpadded>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>n</mi>
          <mi>β</mi>
          <mi>h</mi>
          <mi>ν</mi>
         </mrow>
        </mrow>
       </msup>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>Z</mi>
      </mfrac>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>Z</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>β</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mrow>
        <mo>∂</mo>
        <mi>log</mi>
       </mrow>
       <mi>Z</mi>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mi>β</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>H</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>n</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
       <ci>P</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>Z</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>n</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>h</ci>
        <ci>ν</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <ci>n</ci>
           <ci>β</ci>
           <ci>h</ci>
           <ci>ν</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>Z</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>Z</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>β</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <apply>
         <partialdiff></partialdiff>
         <log></log>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H\rangle=\sum_{n=0}^{\infty}E_{n}P(E_{n})=\frac{1}{Z}\sum_{n=0}^{%
\infty}nh\nu\ e^{-n\beta h\nu}=-\frac{1}{Z}\frac{\partial Z}{\partial\beta}=-%
\frac{\partial\log Z}{\partial\beta}.
  </annotation>
 </semantics>
</math>

</p>

<p>Substituting the formula for <em>Z</em> gives the final result<a class="footnoteRef" href="#fn87" id="fnref87"><sup>87</sup></a></p>

<p>

<math display="block" id="Equipartition_theorem:90">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>H</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>h</mi>
     <mi>ν</mi>
     <mfrac>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>β</mi>
         <mi>h</mi>
         <mi>ν</mi>
        </mrow>
       </mrow>
      </msup>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>β</mi>
          <mi>h</mi>
          <mi>ν</mi>
         </mrow>
        </mrow>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>H</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>ν</ci>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>β</ci>
         <ci>h</ci>
         <ci>ν</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>β</ci>
          <ci>h</ci>
          <ci>ν</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle H\rangle=h\nu\frac{e^{-\beta h\nu}}{1-e^{-\beta h\nu}}.
  </annotation>
 </semantics>
</math>

</p>

<p>At high temperatures, when the thermal energy <em>k</em><sub>B</sub><em>T</em> is much greater than the spacing <em>hν</em> between energy levels, the exponential argument <em>βhν</em> is much less than one and the average energy becomes <em>k</em><sub>B</sub><em>T</em>, in agreement with the equipartition theorem (Figure 10). However, at low temperatures, when <em>hν</em> &gt;&gt; <em>k</em><sub>B</sub><em>T</em>, the average energy goes to zero—the higher-frequency energy levels are "frozen out" (Figure 10). As another example, the internal excited electronic states of a hydrogen atom do not contribute to its specific heat as a gas at room temperature, since the thermal energy <em>k</em><sub>B</sub><em>T</em> (roughly 0.025 <a href="electronvolt" title="wikilink">eV</a>) is much smaller than the spacing between the lowest and next higher electronic energy levels (roughly 10 eV).</p>

<p>Similar considerations apply whenever the energy level spacing is much larger than the thermal energy. For example, this reasoning was used by <a href="Max_Planck" title="wikilink">Max Planck</a> and <a href="Albert_Einstein" title="wikilink">Albert Einstein</a> to resolve the <a href="ultraviolet_catastrophe" title="wikilink">ultraviolet catastrophe</a> of <a href="blackbody_radiation" title="wikilink">blackbody radiation</a>.<a class="footnoteRef" href="#fn88" id="fnref88"><sup>88</sup></a> The paradox arises because there are an infinite number of independent modes of the <a href="electromagnetic_field" title="wikilink">electromagnetic field</a> in a closed container, each of which may be treated as a harmonic oscillator. If each electromagnetic mode were to have an average energy <em>k</em><sub>B</sub><em>T</em>, there would be an infinite amount of energy in the container.<a class="footnoteRef" href="#fn89" id="fnref89"><sup>89</sup></a><a class="footnoteRef" href="#fn90" id="fnref90"><sup>90</sup></a> However, by the reasoning above, the average energy in the higher-frequency modes goes to zero as <em>ν</em> goes to infinity; moreover, <a href="Planck's_law_of_black_body_radiation" title="wikilink">Planck's law of black body radiation</a>, which describes the experimental distribution of energy in the modes, follows from the same reasoning.<a class="footnoteRef" href="#fn91" id="fnref91"><sup>91</sup></a></p>

<p>Other, more subtle quantum effects can lead to corrections to equipartition, such as <a href="identical_particles" title="wikilink">identical particles</a> and <a href="symmetry" title="wikilink">continuous symmetries</a>. The effects of identical particles can be dominant at very high densities and low temperatures. For example, the <a href="valence_electron" title="wikilink">valence electrons</a> in a metal can have a mean kinetic energy of a few <a href="electronvolt" title="wikilink">electronvolts</a>, which would normally correspond to a temperature of tens of thousands of kelvins. Such a state, in which the density is high enough that the <a href="Pauli_exclusion_principle" title="wikilink">Pauli exclusion principle</a> invalidates the classical approach, is called a <a href="degenerate_matter" title="wikilink">degenerate fermion gas</a>. Such gases are important for the structure of <a href="white_dwarf" title="wikilink">white dwarf</a> and <a href="neutron_star" title="wikilink">neutron stars</a>. At low temperatures, a <a href="fermionic_condensate" title="wikilink">fermionic analogue</a> of the <a href="Bose–Einstein_condensate" title="wikilink">Bose–Einstein condensate</a> (in which a large number of identical particles occupy the lowest-energy state) can form; such <a class="uri" href="superfluid" title="wikilink">superfluid</a> electrons are responsible for <a class="uri" href="superconductivity" title="wikilink">superconductivity</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Kinetic_theory" title="wikilink">Kinetic theory</a></li>
<li><a href="Quantum_statistical_mechanics" title="wikilink">Quantum statistical mechanics</a></li>
</ul>
<h2 id="notes-and-references">Notes and references</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>

<p>ASIN B00085D6OO</p></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://webphysics.davidson.edu/physlet_resources/thermo_paper/thermo/examples/ex20_4.html">Applet demonstrating equipartition in real time for a mixture of monatomic and diatomic gases</a></li>
<li><a href="http://www.sciencebits.com/StellarEquipartition">The equipartition theorem in stellar physics</a>, written by Nir J. Shaviv, an associate professor at <a href="the_Racah_Institute_of_Physics" title="wikilink">the Racah Institute of Physics</a> in the <a href="Hebrew_University_of_Jerusalem" title="wikilink">Hebrew University of Jerusalem</a>.</li>
</ul>

<p>"</p>

<p><a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a> <a href="Category:Laws_of_thermodynamics" title="wikilink">Category:Laws of thermodynamics</a> <a href="Category:Statistical_mechanics_theorems" title="wikilink">Category:Statistical mechanics theorems</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">.<a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="http://www.nrc.gov/reading-rm/doc-collections/fact-sheets/enrichment.html">Fact Sheet on Uranium Enrichment</a> U.S. Nuclear Regulatory Commission. Accessed 30 April 2007<a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9"></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><br/>
<br/>
 (abstract only). Published in full  Reprinted <br/>
 (reprinted in his <em>Papers</em>, <strong>3</strong>, 167, 183.)<br/>
 Waterston's key paper was written and submitted in 1845 to the <a href="Royal_Society" title="wikilink">Royal Society</a>. After refusing to publish his work, the Society also refused to return his manuscript and stored it among its files. The manuscript was discovered in 1891 by <a href="John_Strutt,_3rd_Baron_Rayleigh" title="wikilink">Lord Rayleigh</a>, who criticized the original reviewer for failing to recognize the significance of Waterston's work. Waterston managed to publish his ideas in 1851, and therefore has priority over Maxwell for enunciating the first version of the equipartition theorem.<a href="#fnref16">↩</a></li>
<li id="fn17"> Read by Prof. Maxwell at a Meeting of the British Association at Aberdeen on 21 September 1859.<a href="#fnref17">↩</a></li>
<li id="fn18"> In this preliminary work, Boltzmann showed that the average total kinetic energy equals the average total potential energy when a system is acted upon by external harmonic forces.<a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><br/>
<br/>
<a href="#fnref23">↩</a></li>
<li id="fn24"><br/>
 Read at l'Académie des Sciences on 11 January 1841.<br/>
<a href="#fnref24">↩</a></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
<li id="fn28"> A lecture delivered by Prof. Maxwell at the Chemical Society on 18 February 1875.<a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"></li>
<li id="fn31"><a href="#fnref31">↩</a></li>
<li id="fn32"> Re-issued in 1987 by MIT Press as <em>Kelvin's Baltimore Lectures and Modern Theoretical Physics: Historical and Philosophical Perspectives</em> (Robert Kargon and Peter Achinstein, editors). ISBN 978-0-262-11117-1<a href="#fnref32">↩</a></li>
<li id="fn33"><a href="#fnref33">↩</a></li>
<li id="fn34"><br/>
<br/>
<br/>
<br/>
<a href="#fnref34">↩</a></li>
<li id="fn35"></li>
<li id="fn36"><a href="#fnref36">↩</a></li>
<li id="fn37"><a href="#fnref37">↩</a></li>
<li id="fn38"></li>
<li id="fn39"></li>
<li id="fn40"><a href="#fnref40">↩</a></li>
<li id="fn41"><a href="#fnref41">↩</a></li>
<li id="fn42"><a href="#fnref42">↩</a></li>
<li id="fn43"><a href="#fnref43">↩</a></li>
<li id="fn44"><a href="#fnref44">↩</a></li>
<li id="fn45"><br/>
<a href="#fnref45">↩</a></li>
<li id="fn46"></li>
<li id="fn47"></li>
<li id="fn48">L. Vu-Quoc, <a href="http://clesm.mae.ufl.edu/wiki.pub/index.php/Configuration_integral_%28statistical_mechanics%29">Configuration integral (statistical mechanics)</a>, 2008.<a href="#fnref48">↩</a></li>
<li id="fn49"><a href="#fnref49">↩</a></li>
<li id="fn50"></li>
<li id="fn51"></li>
<li id="fn52"></li>
<li id="fn53"></li>
<li id="fn54"></li>
<li id="fn55"></li>
<li id="fn56"><a href="#fnref56">↩</a></li>
<li id="fn57"></li>
<li id="fn58"><a href="#fnref58">↩</a></li>
<li id="fn59"><a href="#fnref59">↩</a></li>
<li id="fn60"></li>
<li id="fn61"></li>
<li id="fn62"><a href="#fnref62">↩</a></li>
<li id="fn63"><a href="#fnref63">↩</a></li>
<li id="fn64"><a href="#fnref64">↩</a></li>
<li id="fn65"><a href="#fnref65">↩</a></li>
<li id="fn66"><a href="#fnref66">↩</a></li>
<li id="fn67"><a href="#fnref67">↩</a></li>
<li id="fn68"><a href="#fnref68">↩</a></li>
<li id="fn69"><a href="#fnref69">↩</a></li>
<li id="fn70"></li>
<li id="fn71"></li>
<li id="fn72"><a href="#fnref72">↩</a></li>
<li id="fn73"></li>
<li id="fn74"></li>
<li id="fn75"></li>
<li id="fn76"></li>
<li id="fn77"></li>
<li id="fn78"></li>
<li id="fn79"></li>
<li id="fn80"></li>
<li id="fn81"><a href="#fnref81">↩</a></li>
<li id="fn82"></li>
<li id="fn83"><a href="#fnref83">↩</a></li>
<li id="fn84"></li>
<li id="fn85"></li>
<li id="fn86"></li>
<li id="fn87"></li>
<li id="fn88">. An <a href="s:A_Heuristic_Model_of_the_Creation_and_Transformation_of_Light" title="wikilink">English translation</a> is available from <a class="uri" href="Wikisource" title="wikilink">Wikisource</a>.<a href="#fnref88">↩</a></li>
<li id="fn89"></li>
<li id="fn90"><a href="#fnref90">↩</a></li>
<li id="fn91"></li>
</ol>
</section>
</body>
</html>

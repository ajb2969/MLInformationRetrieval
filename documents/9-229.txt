   Stirling numbers and exponential generating functions in symbolic combinatorics      Stirling numbers and exponential generating functions in symbolic combinatorics   The use of exponential generating functions (EGFs) to study the properties of Stirling numbers is a classical exercise in combinatorial mathematics and possibly the canonical example of how symbolic combinatorics is used. It also illustrates the parallels in the construction of these two types of numbers, lending support to the binomial-style notation that is used for them.  This article uses the coefficient extraction operator    [   z  n   ]     delimited-[]   superscript  z  n     [z^{n}]   for formal power series , as well as the (labelled) operators   â„­   â„­   \mathfrak{C}   (for cycles) and   ğ”“   ğ”“   \mathfrak{P}   (for sets) on combinatorial classes, which are explained on the page for symbolic combinatorics . Given a combinatorial class, the cycle operator creates the class obtained by placing objects from the source class along a cycle of some length, where cyclical symmetries are taken into account, and the set operator creates the class obtained by placing objects from the source class in a set (symmetries from the symmetric group, i.e. an "unstructured bag".) The two combinatorial classes (shown without additional markers) are   permutations (for unsigned Stirling numbers of the first kind):          ğ’«  =   ğ”“   (   â„­   (  ğ’µ  )    )     ,      ğ’«    ğ”“    â„­  ğ’µ      \mathcal{P}=\mathfrak{P}(\mathfrak{C}(\mathcal{Z})),        and   set partitions into non-empty subsets (for Stirling numbers of the second kind):          â„¬  =   ğ”“   (    ğ”“    â‰¥  1     (  ğ’µ  )    )     ,      â„¬    ğ”“     subscript  ğ”“    absent  1    ğ’µ      \mathcal{B}=\mathfrak{P}(\mathfrak{P}_{\geq 1}(\mathcal{Z})),        where   ğ’µ   ğ’µ   \mathcal{Z}   is the singleton class.  Warning : The notation used here for the Stirling numbers is not that of the Wikipedia articles on Stirling numbers; square brackets denote the signed Stirling numbers here.  Stirling numbers of the first kind  The unsigned Stirling numbers of the first kind count the number of permutations of [ n ] with k cycles. A permutation is a set of cycles, and hence the set    ğ’«    ğ’«   \mathcal{P}\,   of permutations is given by       ğ’«  =   ğ”“   (   ğ’°  â„­   (  ğ’µ  )    )     ,      ğ’«    ğ”“    ğ’°  â„­  ğ’µ      \mathcal{P}=\mathfrak{P}(\mathcal{U}\mathfrak{C}(\mathcal{Z})),\,     where the singleton   ğ’°   ğ’°   \mathcal{U}   marks cycles. This decomposition is examined in some detail on the page on the statistics of random permutations .  Translating to generating functions we obtain the mixed generating function of the unsigned Stirling numbers of the first kind:        G   (  z  ,  u  )    =   exp   (   u   log   1   1  -  z      )    =    (   1   1  -  z    )   u   =    âˆ‘   n  =  0   âˆ     âˆ‘   k  =  0   n     |   [     n      k     ]   |     u  k      z  n    n  !        .          G   z  u        u      1    1  z             superscript    1    1  z    u          superscript   subscript     n  0        superscript   subscript     k  0    n        delimited-[]    n    k       superscript  u  k      superscript  z  n     n          G(z,u)=\exp\left(u\log\frac{1}{1-z}\right)=\left(\frac{1}{1-z}\right)^{u}=\sum%
 _{n=0}^{\infty}\sum_{k=0}^{n}\left|\left[\begin{matrix}n\\
 k\end{matrix}\right]\right|u^{k}\,\frac{z^{n}}{n!}.     Now the signed Stirling numbers of the first kind are obtained from the unsigned ones through the relation        [     n      k     ]   =     (   -  1   )    n  -  k     |   [     n      k     ]   |     .       delimited-[]    n    k        superscript    1     n  k       delimited-[]    n    k         \left[\begin{matrix}n\\
 k\end{matrix}\right]=(-1)^{n-k}\left|\left[\begin{matrix}n\\
 k\end{matrix}\right]\right|.   Hence the generating function    H   (  z  ,  u  )       H   z  u     H(z,u)   of these numbers is        H   (  z  ,  u  )    =   G   (   -  z   ,   -  u   )    =    (   1   1  +  z    )    -  u    =    (   1  +  z   )   u   =    âˆ‘   n  =  0   âˆ     âˆ‘   k  =  0   n     [     n      k     ]     u  k      z  n    n  !        .          H   z  u      G     z     u           superscript    1    1  z      u          superscript    1  z   u          superscript   subscript     n  0        superscript   subscript     k  0    n      delimited-[]    n    k      superscript  u  k      superscript  z  n     n          H(z,u)=G(-z,-u)=\left(\frac{1}{1+z}\right)^{-u}=(1+z)^{u}=\sum_{n=0}^{\infty}%
 \sum_{k=0}^{n}\left[\begin{matrix}n\\
 k\end{matrix}\right]u^{k}\,\frac{z^{n}}{n!}.     A variety of identities may be derived by manipulating this generating function :         (   1  +  z   )   u   =    âˆ‘   n  =  0   âˆ     (     u      n     )    z  n     =    âˆ‘   n  =  0   âˆ      z  n    n  !      âˆ‘   k  =  0   n     [     n      k     ]    u  k       =    âˆ‘   k  =  0   âˆ     u  k     âˆ‘   n  =  k   âˆ      z  n    n  !     [     n      k     ]       =   e   u   log   (   1  +  z   )       .         superscript    1  z   u     superscript   subscript     n  0         binomial  u  n    superscript  z  n            superscript   subscript     n  0           superscript  z  n     n      superscript   subscript     k  0    n      delimited-[]    n    k      superscript  u  k              superscript   subscript     k  0         superscript  u  k     superscript   subscript     n  k           superscript  z  n     n     delimited-[]    n    k               superscript  e    u      1  z         (1+z)^{u}=\sum_{n=0}^{\infty}{u\choose n}z^{n}=\sum_{n=0}^{\infty}\frac{z^{n}}%
 {n!}\sum_{k=0}^{n}\left[\begin{matrix}n\\
 k\end{matrix}\right]u^{k}=\sum_{k=0}^{\infty}u^{k}\sum_{n=k}^{\infty}\frac{z^{%
 n}}{n!}\left[\begin{matrix}n\\
 k\end{matrix}\right]=e^{u\log(1+z)}.     In particular, the order of summation may be exchanged, and derivatives taken, and then z or u may be fixed.  Finite sums  A simple sum is         âˆ‘   k  =  0   n      (   -  1   )   k    [     n      k     ]     =     (   -  1   )   n    n  !     .        superscript   subscript     k  0    n      superscript    1   k    delimited-[]    n    k          superscript    1   n     n      \sum_{k=0}^{n}(-1)^{k}\left[\begin{matrix}n\\
 k\end{matrix}\right]=(-1)^{n}n!.     This formula holds because the exponential generating function of the sum is         H   (  z  ,   -  1   )    =    1   1  +  z    and hence       n  !    [   z  n   ]   H   (  z  ,   -  1   )    =     (   -  1   )   n    n  !      .     formulae-sequence      H   z    1        1    1  z    and hence          n    delimited-[]   superscript  z  n    H   z    1        superscript    1   n     n       H(z,-1)=\frac{1}{1+z}\par
 \quad\mbox{and hence}\quad\par
  n![z^{n}]H(z,-1)=(-1%
 )^{n}n!.     Infinite sums  Some infinite sums include        âˆ‘   n  =  k   âˆ     [     n      k     ]     z  n    n  !      =     (   log   (   1  +  z   )    )   k    k  !          superscript   subscript     n  k         delimited-[]    n    k        superscript  z  n     n         superscript      1  z    k     k      \sum_{n=k}^{\infty}\left[\begin{matrix}n\\
 k\end{matrix}\right]\frac{z^{n}}{n!}=\frac{\left(\log(1+z)\right)^{k}}{k!}     where     |  z  |   <  1        z   1    |z|<1   (the singularity nearest to    z  =  0      z  0    z=0   of    log   (   1  +  z   )         1  z     \log(1+z)   is at    z  =   -  1.       z    1.     z=-1.   )  This relation holds because         [   u  k   ]   H   (  z  ,  u  )    =    [   u  k   ]    exp   (   u   log   (   1  +  z   )     )     =     (   log   (   1  +  z   )    )   k    k  !     .           delimited-[]   superscript  u  k    H   z  u       delimited-[]   superscript  u  k        u      1  z               superscript      1  z    k     k       [u^{k}]H(z,u)=[u^{k}]\exp\left(u\log(1+z)\right)=\frac{\left(\log(1+z)\right)^%
 {k}}{k!}.     Stirling numbers of the second kind  These numbers count the number of partitions of [ n ] into k nonempty subsets. First consider the total number of partitions, i.e. B n where        B  n   =    âˆ‘   k  =  1   n     {     n      k     }   and   B  0     =  1   ,         subscript  B  n     superscript   subscript     k  1    n        n    k     and   subscript  B  0          1     B_{n}=\sum_{k=1}^{n}\left\{\begin{matrix}n\\
 k\end{matrix}\right\}\mbox{ and }B_{0}=1,     i.e. the Bell numbers . The Symbolic combinatorics#The Flajoletâ€“Sedgewick fundamental theorem applies (labelled case). The set    â„¬    â„¬   \mathcal{B}\,   of partitions into non-empty subsets is given by ("set of non-empty sets of singletons")       â„¬  =   ğ”“   (    ğ”“    â‰¥  1     (  ğ’µ  )    )     .      â„¬    ğ”“     subscript  ğ”“    absent  1    ğ’µ      \mathcal{B}=\mathfrak{P}(\mathfrak{P}_{\geq 1}(\mathcal{Z})).     This decomposition is entirely analogous to the construction of the set    ğ’«    ğ’«   \mathcal{P}\,   of permutations from cycles, which is given by       ğ’«  =   ğ”“   (   â„­   (  ğ’µ  )    )     .      ğ’«    ğ”“    â„­  ğ’µ      \mathcal{P}=\mathfrak{P}(\mathfrak{C}(\mathcal{Z})).     and yields the Stirling numbers of the first kind. Hence the name "Stirling numbers of the second kind."  The decomposition is equivalent to the EGF        B   (  z  )    =   exp   (    exp  z   -  1   )     .        B  z         z   1      B(z)=\exp\left(\exp z-1\right).     Differentiate to obtain         d   d  z    B   (  z  )    =    exp   (    exp  z   -  1   )     exp  z    =   B   (  z  )    exp  z     ,            d    d  z    B  z           z   1      z           B  z    z       \frac{d}{dz}B(z)=\exp\left(\exp z-1\right)\exp z=B(z)\exp z,     which implies that        B   n  +  1    =    âˆ‘   k  =  0   n     (     n      k     )    B  k      ,       subscript  B    n  1      superscript   subscript     k  0    n      binomial  n  k    subscript  B  k       B_{n+1}=\sum_{k=0}^{n}{n\choose k}B_{k},     by convolution of exponential generating functions and because differentiating an EGF drops the first coefficient and shifts B n +1 to z  n / n !.  The EGF of the Stirling numbers of the second kind is obtained by marking every subset that goes into the partition with the term    ğ’°    ğ’°   \mathcal{U}\,   , giving       â„¬  =   ğ”“   (    ğ’°    ğ”“    â‰¥  1     (  ğ’µ  )    )     .      â„¬    ğ”“    ğ’°   subscript  ğ”“    absent  1    ğ’µ      \mathcal{B}=\mathfrak{P}(\mathcal{U}\;\mathfrak{P}_{\geq 1}(\mathcal{Z})).     Translating to generating functions, we obtain        B   (  z  ,  u  )    =   exp   (   u   (    exp  z   -  1   )    )     .        B   z  u        u      z   1       B(z,u)=\exp\left(u\left(\exp z-1\right)\right).     This EGF yields the formula for the Stirling numbers of the second kind:       {     n      k     }   =    n  !    [   u  k   ]    [   z  n   ]   B   (  z  ,  u  )    =    n  !    [   z  n   ]      (    exp  z   -  1   )   k    k  !              n    k         n    delimited-[]   superscript  u  k     delimited-[]   superscript  z  n    B   z  u             n    delimited-[]   superscript  z  n       superscript      z   1   k     k        \left\{\begin{matrix}n\\
 k\end{matrix}\right\}=n![u^{k}][z^{n}]B(z,u)=n![z^{n}]\frac{(\exp z-1)^{k}}{k!}     or       n  !    [   z  n   ]    1   k  !      âˆ‘   j  =  0   k     (     k      j     )    exp   (   j  z   )      (   -  1   )    k  -  j            n    delimited-[]   superscript  z  n      1    k      superscript   subscript     j  0    k      binomial  k  j       j  z     superscript    1     k  j        n![z^{n}]\frac{1}{k!}\sum_{j=0}^{k}{k\choose j}\exp(jz)(-1)^{k-j}     which simplifies to          n  !    k  !      âˆ‘   j  =  0   k     (     k      j     )     (   -  1   )    k  -  j      j  n    n  !       =    1   k  !      âˆ‘   j  =  0   k     (     k      j     )     (   -  1   )    k  -  j     j  n       .            n     k      superscript   subscript     j  0    k      binomial  k  j    superscript    1     k  j       superscript  j  n     n           1    k      superscript   subscript     j  0    k      binomial  k  j    superscript    1     k  j     superscript  j  n        \frac{n!}{k!}\sum_{j=0}^{k}{k\choose j}(-1)^{k-j}\frac{j^{n}}{n!}=\frac{1}{k!}%
 \sum_{j=0}^{k}{k\choose j}(-1)^{k-j}j^{n}.     External links   Philippe Flajolet and Robert Sedgewick, Analytic combinatorics â€“ Symbolic combinatorics.   References   Ronald Graham , Donald Knuth , Oren Patashnik (1989): Concrete Mathematics , Addisonâ€“Wesley, ISBN 0-201-14236-8  D. S. Mitrinovic, Sur une classe de nombre relies aux nombres de Stirling , C. R. Acad. Sci. Paris 252 (1961), 2354â€“2356.  A. C. R. Belton, The monotone Poisson process , in: Quantum Probability (M. Bozejko, W. Mlotkowski and J. Wysoczanski, eds.), Banach Center Publications 73, Polish Academy of Sciences, Warsaw, 2006  Milton Abramowitz and Irene A. Stegun, Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables , USGPO, 1964, Washington DC, ISBN 0-486-61272-4   "  Category:Enumerative combinatorics   
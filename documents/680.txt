   Coarea formula      Coarea formula   In the mathematical field of geometric measure theory , the coarea formula expresses the integral of a function over an open set in Euclidean space in terms of the integral of the level sets of another function. A special case is Fubini's theorem , which says under suitable hypotheses that the integral of a function over the region enclosed by a rectangular box can be written as the iterated integral over the level sets of the coordinate functions. Another special case is integration in spherical coordinates , in which the integral of a function on R n is related to the integral of the function over spherical shells: level sets of the radial function. The formula plays a decisive role in the modern study of isoperimetric problems .  For smooth functions the formula is a result in multivariate calculus which follows from a simple change of variables . More general forms of the formula for Lipschitz functions were first established by Herbert Federer , and for     B  V      B  V    BV    functions by .  A precise statement of the formula is as follows. Suppose that Ω is an open set in R n , and u is a real-valued Lipschitz function on Ω. Then, for an L 1 function g ,        ∫  Ω    g   (  x  )    |    ∇  u    (  x  )    |   d  x    =    ∫   -  ∞   ∞     (    ∫    u   -  1     (  t  )      g   (  x  )   d   H   n  -  1     (  x  )     )   d  t          subscript   normal-Ω     g  x       normal-∇  u   x    d  x      superscript   subscript              subscript      superscript  u    1    t      g  x  d   subscript  H    n  1    x    d  t      \int_{\Omega}g(x)|\nabla u(x)|\,dx=\int_{-\infty}^{\infty}\left(\int_{u^{-1}(t%
 )}g(x)\,dH_{n-1}(x)\right)\,dt     where H n − 1 is the ( n − 1)-dimensional Hausdorff measure . In particular, by taking g to be one, this implies         ∫  Ω    |   ∇  u   |    =    ∫   -  ∞   ∞     H   n  -  1     (    u   -  1     (  t  )    )   d  t     ,        subscript   normal-Ω      normal-∇  u       superscript   subscript             subscript  H    n  1       superscript  u    1    t   d  t      \int_{\Omega}|\nabla u|=\int_{-\infty}^{\infty}H_{n-1}(u^{-1}(t))\,dt,     and conversely the latter equality implies the former by standard techniques in Lebesgue integration .  More generally, the coarea formula can be applied to Lipschitz functions u defined in Ω ⊂ R n , taking on values in R k where k \int_\Omega g(x) |J_k u(x)|\, dx = \int_{\mathbb{R}^k} \left(\int_{u^{-1}(t)}g(x)\,dH_{n-k}(x)\right)\,dt  where J k u is the k -dimensional Jacobian of u .  Applications   Taking u ( x ) = | x − x 0 | gives the formula for integration in spherical coordinates of an integrable function ƒ:            ∫   ℝ  n      f   d  x    =    ∫  0  ∞     {    ∫    ∂  B    (   x  0   ;  r  )       f   d  S    }   d  r     .        subscript    superscript  ℝ  n      f  d  x      superscript   subscript   0          subscript       B     subscript  x  0   r       f  d  S     d  r      \int_{\mathbb{R}^{n}}f\,dx=\int_{0}^{\infty}\left\{\int_{\partial B(x_{0};r)}f%
 \,dS\right\}\,dr.         Combining the coarea formula with the isoperimetric inequality gives a proof of the Sobolev inequality for W 1,1 with best constant:           (    ∫   ℝ  n      |  u  |    n  /   (   n  -  1   )      )     n  -  1   n    ≤    n   -  1     ω  n   -   1  /  n       ∫   ℝ  n     |   ∇  u   |          superscript    subscript    superscript  ℝ  n     superscript    u     n    n  1          n  1   n       superscript  n    1     superscript   subscript  ω  n       1  n       subscript    superscript  ℝ  n       normal-∇  u        \left(\int_{\mathbb{R}^{n}}|u|^{n/(n-1)}\right)^{\frac{n-1}{n}}\leq n^{-1}%
 \omega_{n}^{-1/n}\int_{\mathbb{R}^{n}}|\nabla u|       where ω n is the volume of the unit ball in R n .   See also   Sard's theorem  Smooth coarea formula   References    .   .    .   "  Category:Measure theory   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1209">Blum Blum Shub</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Blum Blum Shub</h1>
<hr/>

<p><strong>Blum Blum Shub</strong> (<strong>B.B.S.</strong>) is a <a href="pseudorandom_number_generator" title="wikilink">pseudorandom number generator</a> proposed in 1986 by <a href="Lenore_Blum" title="wikilink">Lenore Blum</a>, <a href="Manuel_Blum" title="wikilink">Manuel Blum</a> and <a href="Michael_Shub" title="wikilink">Michael Shub</a> <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> that is derived from <a href="Michael_O._Rabin" title="wikilink">Michael O. Rabin</a>'s <a href="oblivious_transfer" title="wikilink">oblivious transfer</a> mapping.</p>

<p>Blum Blum Shub takes the form</p>

<p>

<math display="block" id="Blum_Blum_Shub:0">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mi>n</mi>
     <mn>2</mn>
    </msubsup>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>M</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{n+1}=x_{n}^{2}\bmod M
  </annotation>
 </semantics>
</math>

,</p>

<p>where <em>M</em> = <em>pq</em> is the product of two large <a href="prime_number" title="wikilink">primes</a> <em>p</em> and <em>q</em>. At each step of the algorithm, some output is derived from <em>x</em><sub><em>n</em>+1</sub>; the output is commonly either the <a href="parity_bit" title="wikilink">bit parity</a> of <em>x</em><sub><em>n</em>+1</sub> or one or more of the least significant bits of <em>x</em><sub><em>n</em>+1''</sub>.</p>

<p>The <a href="random_seed" title="wikilink">seed</a> <em>x</em><sub>0</sub> should be an integer that is co-prime to <em>M</em> (i.e. <em>p</em> and <em>q</em> are not factors of <em>x</em><sub>0</sub>) and not 1 or 0.</p>

<p>The two primes, <em>p</em> and <em>q</em>, should both be <a href="Congruence_relation" title="wikilink">congruent</a> to 3 (mod 4) (this guarantees that each <a href="quadratic_residue" title="wikilink">quadratic residue</a> has one <a href="square_root" title="wikilink">square root</a> which is also a quadratic residue) and <a href="greatest_common_divisor" title="wikilink">gcd</a>(<a href="Euler's_totient_function" title="wikilink"><em>φ</em></a>(<em>p</em> − 1), <em>φ</em>(<em>q</em> − 1)) should be small (this makes the cycle length large).</p>

<p>An interesting characteristic of the Blum Blum Shub generator is the possibility to calculate any <em>x</em><sub><em>i</em></sub> value directly (via <a href="Euler's_Theorem" title="wikilink">Euler's Theorem</a>):</p>

<p>

<math display="block" id="Blum_Blum_Shub:1">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <msubsup>
      <mi>x</mi>
      <mn>0</mn>
      <mrow>
       <msup>
        <mn>2</mn>
        <mi>i</mi>
       </msup>
       <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
       <mrow>
        <mi>λ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>M</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </msubsup>
     <mo>)</mo>
    </mrow>
    <mo lspace="2.5pt" rspace="2.5pt">mod</mo>
    <mi>M</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">modulo</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">modulo</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <ci>λ</ci>
        <ci>M</ci>
       </apply>
      </apply>
     </apply>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}=\left(x_{0}^{2^{i}\bmod\lambda(M)}\right)\bmod M
  </annotation>
 </semantics>
</math>

,</p>

<p>where 

<math display="inline" id="Blum_Blum_Shub:2">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 is the <a href="Carmichael_function" title="wikilink">Carmichael function</a>. (Here we have 

<math display="inline" id="Blum_Blum_Shub:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>λ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>M</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>⋅</mo>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>lcm</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>q</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>λ</ci>
      <ci>M</ci>
     </apply>
     <apply>
      <times></times>
      <ci>λ</ci>
      <apply>
       <ci>normal-⋅</ci>
       <ci>p</ci>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>lcm</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>q</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda(M)=\lambda(p\cdot q)=\operatorname{lcm}(p-1,q-1)
  </annotation>
 </semantics>
</math>

).</p>
<h2 id="security">Security</h2>

<p>There is a proof reducing its security to the <a href="Computational_complexity_theory" title="wikilink">computational difficulty</a> of solving the <a href="Quadratic_residuosity_problem" title="wikilink">Quadratic residuosity problem</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> When the primes are chosen appropriately, and <a href="big_O_notation" title="wikilink">O</a>(<a href="logarithm" title="wikilink">log</a> log <em>M</em>) lower-order bits of each <em>x<sub>n</sub></em> are output, then in the limit as <em>M</em> grows large, distinguishing the output bits from random should be at least as difficult as solving the Quadratic residuosity problem modulo <em>M</em>.</p>
<h2 id="example">Example</h2>

<p>Let 

<math display="inline" id="Blum_Blum_Shub:4">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mn>11</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <cn type="integer">11</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=11
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Blum_Blum_Shub:5">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mn>19</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <cn type="integer">19</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=19
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Blum_Blum_Shub:6">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>=</mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>s</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s=3
  </annotation>
 </semantics>
</math>

 (where 

<math display="inline" id="Blum_Blum_Shub:7">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

 is the seed). We can expect to get a large cycle length for those small numbers, because 

<math display="inline" id="Blum_Blum_Shub:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>gcd</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>φ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>q</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>gcd</ci>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>φ</ci>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>φ</ci>
       <apply>
        <minus></minus>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </interval>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm gcd}(\varphi(p-1),\varphi(q-1))=2
  </annotation>
 </semantics>
</math>

. The generator starts to evaluate 

<math display="inline" id="Blum_Blum_Shub:9">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}
  </annotation>
 </semantics>
</math>

 by using 

<math display="inline" id="Blum_Blum_Shub:10">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mi>s</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{-1}=s
  </annotation>
 </semantics>
</math>

 and creates the sequence 

<math display="inline" id="Blum_Blum_Shub:11">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{0}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Blum_Blum_Shub:12">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Blum_Blum_Shub:13">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Blum_Blum_Shub:14">
 <semantics>
  <mi mathvariant="normal">…</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-…</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ldots
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Blum_Blum_Shub:15">
 <semantics>
  <msub>
   <mi>x</mi>
   <mn>5</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{5}
  </annotation>
 </semantics>
</math>

 = 9, 81, 82, 36, 42, 92. The following table shows the output (in bits) for the different bit selection methods used to determine the output.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p><a href="Even_parity" title="wikilink">Even parity</a> bit</p></th>
<th style="text-align: left;">
<p><a href="Odd_parity" title="wikilink">Odd parity</a> bit</p></th>
<th style="text-align: left;">
<p><a href="Least_significant_bit" title="wikilink">Least significant bit</a></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>0 1 1 0 1 0</p></td>
<td style="text-align: left;">
<p>1 0 0 1 0 1</p></td>
<td style="text-align: left;">
<p>1 1 0 0 0 0</p></td>
</tr>
</tbody>
</table>
<h2 id="references">References</h2>
<dl>
<dt>General</dt>
</dl>
<ul>
<li></li>
<li>

<p>available as <a href="http://www.daimi.au.dk/~mg/mamian/random-bits.pdf">PDF</a> and <a href="http://daimi.au.dk/~mg/mamian/random-bits.ps.gz">Gzipped Postscript</a></p></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://moanlisa.org/gmpbbs/">GMPBBS</a> , a <a href="GNU_General_Public_License" title="wikilink">GPL</a>'ed <a href="GNU_Multi-Precision_Library" title="wikilink">GMP</a>-based implementation of Blum Blum Shub in C by Maria Morisot with implementations in Java and PHP also.</li>
<li><a href="http://code.google.com/p/javarng/">An implementation in Java</a></li>
<li><a href="http://www.ciphersbyritter.com/NEWS2/TESTSBBS.HTM">Randomness tests</a></li>
</ul>

<p>"</p>

<p><a href="Category:Pseudorandom_number_generators" title="wikilink">Category:Pseudorandom number generators</a> <a href="Category:Cryptographically_secure_pseudorandom_number_generators" title="wikilink">Category:Cryptographically secure pseudorandom number generators</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
</ol>
</section>
</body>
</html>

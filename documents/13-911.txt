   Yahalom (protocol)      Yahalom (protocol)   Yahalom is an authentication and secure key-sharing protocol designed for use on an insecure network such as the Internet. Yahalom uses a trusted arbitrator to distribute a shared key between two people. This protocol can be considered as an improved version of Wide Mouth Frog protocol (with additional protection against man-in-the-middle attack ), but less secure than Needham-Schroeder .  Protocol description  If Alice (A) initiates the communication to Bob (B) with S is a server trusted by both parties, the protocol can be specified as follows using security protocol notation :   A and B are identities of Alice and Bob respectively      K   A  S      subscript  K    A  S     K_{AS}   is a symmetric key known only to A and S      K   B  S      subscript  K    B  S     K_{BS}   is a symmetric key known only to B and S      N  A     subscript  N  A    N_{A}   and    N  B     subscript  N  B    N_{B}   are nonces generated by A and B respectively      K   A  B      subscript  K    A  B     K_{AB}   is a symmetric, generated key, which will be the session key of the session between A and B        A  →  B   :   A  ,   N  A       normal-:   normal-→  A  B    A   subscript  N  A      A\rightarrow B:A,N_{A}      Alice sends a message to Bob requesting communication.        B  →  S   :   B  ,    {  A  ,   N  A   ,   N  B   }    K   B  S         normal-:   normal-→  B  S    B   subscript   A   subscript  N  A    subscript  N  B     subscript  K    B  S        B\rightarrow S:B,\{A,N_{A},N_{B}\}_{K_{BS}}      Bob sends a message to the Server encrypted under    K   B  S      subscript  K    B  S     K_{BS}   .        S  →  A   :     {  B  ,   K   A  B    ,   N  A   ,   N  B   }    K   A  S     ,    {  A  ,   K   A  B    }    K   B  S         normal-:   normal-→  S  A     subscript   B   subscript  K    A  B     subscript  N  A    subscript  N  B     subscript  K    A  S      subscript   A   subscript  K    A  B      subscript  K    B  S        S\rightarrow A:\{B,K_{AB},N_{A},N_{B}\}_{K_{AS}},\{A,K_{AB}\}_{K_{BS}}      The Server sends to Alice a message containing the generated session key    K   A  B      subscript  K    A  B     K_{AB}   and a message to be forwarded to Bob.        A  →  B   :     {  A  ,   K   A  B    }    K   B  S     ,    {   N  B   }    K   A  B         normal-:   normal-→  A  B     subscript   A   subscript  K    A  B      subscript  K    B  S      subscript    subscript  N  B     subscript  K    A  B        A\rightarrow B:\{A,K_{AB}\}_{K_{BS}},\{N_{B}\}_{K_{AB}}      Alice forwards the message to Bob and verifies    N  A     subscript  N  A    N_{A}   has not changed. Bob will verify    N  B     subscript  N  B    N_{B}   has not changed when he receives the message.   See also   Kerberos  Otway–Rees  Neuman–Stubblebine   References    M. Burrows, M. Abadi, R. Needham A Logic of Authentication , Research Report 39, Digital Equipment Corp. Systems Research Center, Feb. 1989  M. Burrows, M. Abadi, R. Needham A Logic of Authentication . ACM Transactions on Computer Systems, v. 8, n. 1, Feb. 1990, pp. 18—36     "  Category:Cryptographic protocols  Category:Computer access control protocols   
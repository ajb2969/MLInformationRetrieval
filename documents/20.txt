   Matrix function      Matrix function   In mathematics , a matrix function is a function which maps a matrix to another matrix.  Extending scalar function to matrix functions  There are several techniques for lifting a real function to a square matrix function such that interesting properties are maintained. All of the following techniques yield the same matrix function, but the domains on which the function are defined may differ.  Power series  If the real function   f   f   f   has the Taylor expansion       f   (  x  )    =    f   (  0  )    +     f  ′    (  0  )    ⋅  x   +     f  ′′    (  0  )    ⋅    x  2    2  !     +  ⋯         f  x       f  0    normal-⋅     superscript  f  normal-′   0   x    normal-⋅     superscript  f  ′′   0      superscript  x  2     2     normal-⋯     f(x)=f(0)+f^{\prime}(0)\cdot x+f^{\prime\prime}(0)\cdot\frac{x^{2}}{2!}+\cdots     then a matrix function can be defined by substituting   x   x   x   by a matrix: the powers become matrix powers , the additions become matrix sums and the multiplications become scaling operations. If the real series converges for     |  x  |   <  r        x   r    |x|   , then the corresponding matrix series will converge for matrix argument A if     ∥  A  ∥   <  r       norm  A   r    \|A\|   for some matrix norm     ∥  ⋅  ∥     fragments  parallel-to  normal-⋅  parallel-to    \|\cdot\|   which satisfies     ∥   A  B   ∥   ≤    ∥  A  ∥   ⋅   ∥  B  ∥         norm    A  B     normal-⋅   norm  A    norm  B      \|AB\|\leq\|A\|\cdot\|B\|   .  Jordan decomposition  If the matrix A is diagonalizable , then we can find a matrix P and a diagonal matrix  D such that    A  =   P  ⋅  D  ⋅   P   -  1         A   normal-⋅  P  D   superscript  P    1       A=P\cdot D\cdot P^{-1}   . Applying the power series definition to this decomposition, we find that    f   (  A  )       f  A    f(A)   is defined by        f   (  A  )    =   P   [      f   (   d  1   )      …    0      ⋮    ⋱    ⋮      0    …     f   (   d  n   )       ]    P   -  1      ,        f  A     P      f   subscript  d  1    normal-…  0    normal-⋮  normal-⋱  normal-⋮    0  normal-…    f   subscript  d  n       superscript  P    1       f(A)=P\begin{bmatrix}f(d_{1})&\dots&0\\
 \vdots&\ddots&\vdots\\
 0&\dots&f(d_{n})\end{bmatrix}P^{-1},   where     d  1   ,  …  ,   d  n       subscript  d  1   normal-…   subscript  d  n     d_{1},\dots,d_{n}   denote the diagonal entries of D .  All matrices, whether they are diagonalizable or not, have a Jordan normal form     A  =   P  ⋅  J  ⋅   P   -  1         A   normal-⋅  P  J   superscript  P    1       A=P\cdot J\cdot P^{-1}   , where the matrix J consists of Jordan blocks . Consider these blocks separately and apply the power series to a Jordan block:        f   (   [     λ    1    0    …    0      0    λ    1    ⋮    ⋮      0    0    ⋱    ⋱    ⋮      ⋮    …    ⋱    λ    1      0    …    …    0    λ     ]   )    =   [        f   (  λ  )     0  !           f  ′    (  λ  )     1  !           f  ′′    (  λ  )     2  !       …        f   (  n  )     (  λ  )     n  !         0       f   (  λ  )     0  !           f  ′    (  λ  )     1  !       ⋮        f   (   n  -  1   )     (  λ  )      (   n  -  1   )   !         0    0    ⋱    ⋱    ⋮      ⋮    …    ⋱       f   (  λ  )     0  !           f  ′    (  λ  )     1  !         0    …    …    0       f   (  λ  )     0  !        ]    .        f    λ  1  0  normal-…  0    0  λ  1  normal-⋮  normal-⋮    0  0  normal-⋱  normal-⋱  normal-⋮    normal-⋮  normal-…  normal-⋱  λ  1    0  normal-…  normal-…  0  λ           f  λ     0         superscript  f  normal-′   λ     1         superscript  f  ′′   λ     2    normal-…       superscript  f  n   λ     n      0      f  λ     0         superscript  f  normal-′   λ     1    normal-⋮       superscript  f    n  1    λ       n  1       0  0  normal-⋱  normal-⋱  normal-⋮    normal-⋮  normal-…  normal-⋱      f  λ     0         superscript  f  normal-′   λ     1      0  normal-…  normal-…  0      f  λ     0        f\left(\begin{bmatrix}\lambda&1&0&\ldots&0\\
 0&\lambda&1&\vdots&\vdots\\
 0&0&\ddots&\ddots&\vdots\\
 \vdots&\ldots&\ddots&\lambda&1\\
 0&\ldots&\ldots&0&\lambda\end{bmatrix}\right)=\par
 \begin{bmatrix}\frac{f(%
 \lambda)}{0!}&\frac{f^{\prime}(\lambda)}{1!}&\frac{f^{\prime\prime}(\lambda)}{%
 2!}&\ldots&\frac{f^{(n)}(\lambda)}{n!}\\
 0&\frac{f(\lambda)}{0!}&\frac{f^{\prime}(\lambda)}{1!}&\vdots&\frac{f^{(n-1)}(%
 \lambda)}{(n-1)!}\\
 0&0&\ddots&\ddots&\vdots\\
 \vdots&\ldots&\ddots&\frac{f(\lambda)}{0!}&\frac{f^{\prime}(\lambda)}{1!}\\
 0&\ldots&\ldots&0&\frac{f(\lambda)}{0!}\end{bmatrix}.     This definition can be used to extend the domain of the matrix function beyond the set of matrices with spectral radius smaller than the radius of convergence of the power series. Note that there is also a connection to divided differences .  A related notion is the Jordan–Chevalley decomposition which expresses a matrix as a sum of a diagonalizable and a nilpotent part.  Hermitian matrices  A Hermitian matrix has all real eigenvalues and can always be diagonalized by a unitary matrix P, according to the spectral theorem . In this case, the Jordan definition is natural. Moreover, this definition allows one to extend standard inequalities for real functions:  If     f   (  a  )    ≤   g   (  a  )          f  a     g  a     f(a)\leq g(a)   for all eigenvalues of   A   A   A   , then     f   (  A  )    ⪯   g   (  A  )       precedes-or-equals    f  A     g  A     f(A)\preceq g(A)   . (As a convention,     X  ⪯  Y   ⇔   Y  -  X      normal-⇔   precedes-or-equals  X  Y     Y  X     X\preceq Y\Leftrightarrow Y-X   is a positive-semidefinite matrix .) The proof follows directly from the definition.  Cauchy integral  Cauchy's integral formula from complex analysis can also be used to generalize scalar functions to matrix functions. Cauchy's integral formula states that for any analytic function  f defined on a set D ⊂ℂ, it holds       f   (  x  )    =    1   2  π  i      ∮  C       f   (  z  )     z  -  x     d  z           f  x       1    2  π  i      subscript  contour-integral  C         f  z     z  x    normal-d  z       f(x)=\frac{1}{2\pi i}\oint_{C}{\frac{f(z)}{z-x}}\,\mathrm{d}z   ,  where C is a closed curve inside the domain D enclosing x . Now replace x by a matrix A and consider a path C inside D that encloses all eigenvalues of A . One possibility to achieve this is to let C be a circle around the origin with radius larger than    ∥  A  ∥     norm  A    \scriptstyle\|A\|   for an arbitrary matrix norm     ∥  ⋅  ∥     fragments  parallel-to  normal-⋅  parallel-to    \scriptstyle\|\cdot\|   . Then,    f   (  A  )       f  A    f(A)   is defined by        f   (  A  )    =    1   2  π  i      ∮  C    f   (  z  )      (    z  I   -  A   )    -  1     d  z      .        f  A       1    2  π  i      subscript  contour-integral  C     f  z   superscript      z  I   A     1    normal-d  z       f(A)=\frac{1}{2\pi i}\oint_{C}{f(z)(zI-A)^{-1}}\,\mathrm{d}z.     This integral can readily be evaluated numerically using the trapezium rule , which converges exponentially in this case. That means that the precision of the result doubles when the number of nodes is doubled.  This idea applied to bounded linear operators on a Banach space , which can be seen as infinite matrices, leads to the holomorphic functional calculus .  Matrix perturbations  The above Taylor power series allows the scalar   x   x   x   to be replaced by the matrix. This is not true in general when expanding in terms of     A   (  η  )    =   A  +   η  B          A  η     A    η  B      A(\eta)=A+\eta B   about    η  =  0      η  0    \eta=0   unless     [  A  ,  B  ]   =  0       A  B   0    [A,B]=0   . A counter example is     f   (  x  )    =   x  3         f  x    superscript  x  3     f(x)=x^{3}   , which has a finite length Taylor series. We compute this in two ways,   Brute force :        f   (   A  +   η  B    )    =    (   A  +   η  B    )   3   =    A  3   +   η   (     A  2   B   +   A  B  A   +   B   A  2     )    +    η  2    (    A   B  2    +   B  A  B   +    B  2   A    )    +    η  3    B  3             f    A    η  B      superscript    A    η  B    3           superscript  A  3     η       superscript  A  2   B     A  B  A     B   superscript  A  2         superscript  η  2       A   superscript  B  2      B  A  B      superscript  B  2   A        superscript  η  3    superscript  B  3        f(A+\eta B)=(A+\eta B)^{3}=A^{3}+\eta(A^{2}B+ABA+BA^{2})+\eta^{2}(AB^{2}+BAB+B%
 ^{2}A)+\eta^{3}B^{3}      Using scalar Taylor expansion for    f   (   a  +   η  b    )       f    a    η  b      f(a+\eta b)   and replacing scalars with matrices at the end :        f   (   a  +   η  b    )    =    f   (  a  )    +    f  ′    (  a  )     η  b    1  !     +    f  ′′    (  a  )      (   η  b   )   2    2  !     +    f  ′′′    (  a  )      (   η  b   )   3    3  !      =    a  3   +   3   a  2    (   η  b   )    +   3  a    (   η  b   )   2    +    (   η  b   )   3    →    A  3   +   3   A  2    (   η  B   )    +   3  A    (   η  B   )   2    +    (   η  B   )   3            f    a    η  b         f  a      superscript  f  normal-′   a      η  b     1        superscript  f  ′′   a     superscript    η  b   2     2        superscript  f  ′′′   a     superscript    η  b   3     3              superscript  a  3     3   superscript  a  2     η  b      3  a   superscript    η  b   2     superscript    η  b   3      normal-→       superscript  A  3     3   superscript  A  2     η  B      3  A   superscript    η  B   2     superscript    η  B   3       f(a+\eta b)=f(a)+f^{\prime}(a)\frac{\eta b}{1!}+f^{\prime\prime}(a)\frac{(\eta
 b%
 )^{2}}{2!}+f^{\prime\prime\prime}(a)\frac{(\eta b)^{3}}{3!}=a^{3}+3a^{2}(\eta b%
 )+3a(\eta b)^{2}+(\eta b)^{3}\to A^{3}+3A^{2}(\eta B)+3A(\eta B)^{2}+(\eta B)^%
 {3}     The scalar expression assumes commutativity while the matrix expression does not and thus they cannot be equated directly unless     [  A  ,  B  ]   =  0       A  B   0    [A,B]=0   . For some f(x) this can be dealt with using the same method as scalar Taylor series. For example,     f   (  x  )    =   1  x         f  x     1  x     f(x)=\frac{1}{x}   . If    A   -  1      superscript  A    1     A^{-1}   exists then     f   (   A  +   η  B    )    =   f   (   𝕀  +   η   A   -  1    B    )   f   (  A  )          f    A    η  B       f    𝕀    η   superscript  A    1    B    f  A     f(A+\eta B)=f(\mathbb{I}+\eta A^{-1}B)f(A)   . The expansion of the first term then follows the power series given above,       f   (   𝕀  +   η   A   -  1    B    )    =    𝕀  -   η   A   -  1    B    +    (   -   η   A   -  1    B    )   2   +  …   =    ∑   n  =  0   ∞     (   -   η   A   -  1    B    )   n            f    𝕀    η   superscript  A    1    B         𝕀    η   superscript  A    1    B     superscript      η   superscript  A    1    B    2   normal-…          superscript   subscript     n  0       superscript      η   superscript  A    1    B    n       f(\mathbb{I}+\eta A^{-1}B)=\mathbb{I}-\eta A^{-1}B+(-\eta A^{-1}B)^{2}+\ldots=%
 \sum_{n=0}^{\infty}(-\eta A^{-1}B)^{n}     The convergence criteria of the power series then apply, requiring    ∥   η   A   -  1    B   ∥     norm    η   superscript  A    1    B     \|\eta A^{-1}B\|   to be sufficiently small under the appropriate matrix norm. For more general problems, which cannot be rewritten in such a way that the two matrices commute, the ordering of matrix products produced by repeated application of the Leibniz rule must be tracked.  Examples   Algebraic Riccati equation  Matrix polynomial  Matrix root  Matrix logarithm  Matrix exponential   Classes of matrix functions  Using the semidefinite ordering (     X  ⪯  Y   ⇔   Y  -  X      normal-⇔   precedes-or-equals  X  Y     Y  X     X\preceq Y\Leftrightarrow Y-X   is positive-semidefinite and     X  ≺  Y   ⇔   Y  -  X      normal-⇔   precedes  X  Y     Y  X     X\prec Y\Leftrightarrow Y-X   is positive definite ), some of the classes of scalar functions can be extended to matrix functions of Hermitian matrices . 1  Operator monotone  A function   f   f   f   is called operator monotone if and only if          0  ≺  A  ⪯  H  ⇒   f   (  A  )    ⪯   f   (  H  )         precedes  0  A    precedes-or-equals    H    normal-⇒      f  A     precedes-or-equals      f  H      0\prec A\preceq H\Rightarrow f(A)\preceq f(H)   for all self-adjoint matrices    A  ,  H     A  H    A,H   with spectra in the domain of f. This is analogous to monotone function in the scalar case.  Operator concave/convex  A function   f   f   f   is called operator concave if and only if        τ  f   (  A  )    +    (   1  -  τ   )   f   (  H  )     ⪯   f   (    τ  A   +    (   1  -  τ   )   H    )       precedes-or-equals      τ  f  A       1  τ   f  H      f      τ  A       1  τ   H       \tau f(A)+(1-\tau)f(H)\preceq f\left(\tau A+(1-\tau)H\right)   for all self-adjoint matrices    A  ,  H     A  H    A,H   with spectra in the domain of f and    τ  ∈   [  0  ,  1  ]       τ   0  1     \tau\in[0,1]   . This definition is analogous to a concave scalar function . An operator convex function can be defined be switching   ⪯   precedes-or-equals   \preceq   to   ⪰   succeeds-or-equals   \succeq   in the definition above.  Examples  The matrix log is both operator monotone and operator concave. The matrix square is operator convex. The matrix exponential is none of these. Loewner's Theorem states that a function on an open interval is operator monotone if and only if it has an analytic extension to the upper and lower complex half planes so that the upper half plane is mapped to itself. 2  See also   Sylvester's formula  Matrix calculus  Trace inequalities   Notes  References     "  Category:Matrix theory     ↩      
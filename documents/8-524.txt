   Godunov's scheme      Godunov's scheme   In numerical analysis and computational fluid dynamics , Godunov's scheme is a conservative  numerical scheme , suggested by S. K. Godunov in 1959, for solving partial differential equations . One can think of this method as a conservative finite-volume method which solves exact, or approximate Riemann problems at each inter-cell boundary. In its basic form, Godunov's method is first order accurate in both space, and time, yet can be used as a base scheme for developing higher-order methods.  Basic scheme  Following the classical Finite-volume method framework, we seek to track a finite set of discrete unknowns,       Q  i  n   =    1   Δ  x      ∫   x   i  -   1  /  2      x   i  +   1  /  2       q   (   t  n   ,  x  )   d  x          subscript   superscript  Q  n   i       1    normal-Δ  x      superscript   subscript    subscript  x    i    1  2       subscript  x    i    1  2        q    superscript  t  n   x   d  x       Q^{n}_{i}=\frac{1}{\Delta x}\int_{x_{i-1/2}}^{x_{i+1/2}}q(t^{n},x)\,dx     where the     x  i   =    x  low   +    (   i  -   1  /  2    )   Δ  x         subscript  x  i      subscript  x  low       i    1  2    normal-Δ  x      x_{i}=x_{\text{low}}+\left(i-1/2\right)\Delta x   and     t  n   =   n  Δ  t        superscript  t  n     n  normal-Δ  t     t^{n}=n\Delta t   form a discrete set of points for the hyperbolic problem:        q  t   +    (   f   (  q  )    )   x    =  0.         subscript  q  t    subscript    f  q   x    0.    q_{t}+(f(q))_{x}=0.     If we integrate the hyperbolic problem over a control volume     [   x   i  -   1  /  2     ,   x   i  +   1  /  2     ]   ,      subscript  x    i    1  2      subscript  x    i    1  2       [x_{i-1/2},x_{i+1/2}],   we obtain a Method of lines (MOL) formulation for the spatial cell averages:         ∂   ∂  t     Q  i    (  t  )    =   -    1   Δ  x     (    f   (   q   (  t  ,   x   i  +   1  /  2     )    )    -   f   (   q   (  t  ,   x   i  -   1  /  2     )    )     )      ,             t     subscript  Q  i   t         1    normal-Δ  x        f    q   t   subscript  x    i    1  2          f    q   t   subscript  x    i    1  2             \frac{\partial}{\partial t}Q_{i}(t)=-\frac{1}{\Delta x}\left(f(q(t,x_{i+1/2}))%
 -f(q(t,x_{i-1/2}))\right),     which is a classical description of the first order, upwinded finite volume method. (c.f. Leveque - Finite Volume Methods for Hyperbolic Problems )  Exact time integration of the above formula from time    t  =   t  n       t   superscript  t  n     t=t^{n}   to time    t  =   t   n  +  1        t   superscript  t    n  1      t=t^{n+1}   yields the exact update formula:        Q  i   n  +  1    =    Q  i  n   -    1   Δ  x      ∫   t  n    t   n  +  1       (    f   (   q   (  t  ,   x   i  +   1  /  2     )    )    -   f   (   q   (  t  ,   x   i  -   1  /  2     )    )     )   d  t       .       subscript   superscript  Q    n  1    i      subscript   superscript  Q  n   i       1    normal-Δ  x      superscript   subscript    superscript  t  n     superscript  t    n  1           f    q   t   subscript  x    i    1  2          f    q   t   subscript  x    i    1  2         d  t        Q^{n+1}_{i}=Q^{n}_{i}-\frac{1}{\Delta x}\int_{t^{n}}^{t^{n+1}}\left(f(q(t,x_{i%
 +1/2}))-f(q(t,x_{i-1/2}))\right)\,dt.     Godunov's method replaces the time integral of each       ∫   t  n    t   n  +  1      f   (   q   (  t  ,   x   i  -   1  /  2     )    )   d  t       superscript   subscript    superscript  t  n     superscript  t    n  1       f    q   t   subscript  x    i    1  2       d  t     \int_{t^{n}}^{t^{n+1}}f(q(t,x_{i-1/2}))\,dt     with a Forward Euler method which yields a fully discrete update formula for each of the unknowns    Q  i  n     subscript   superscript  Q  n   i    Q^{n}_{i}   . That is, we approximate the integrals with         ∫   t  n    t   n  +  1      f   (   q   (  t  ,   x   i  -   1  /  2     )    )   d  t    ≈   Δ  t   f  ↓    (   Q   i  -  1   n   ,   Q  i  n   )     ,        superscript   subscript    superscript  t  n     superscript  t    n  1       f    q   t   subscript  x    i    1  2       d  t      normal-Δ  t   superscript  f  normal-↓     subscript   superscript  Q  n     i  1     subscript   superscript  Q  n   i       \int_{t^{n}}^{t^{n+1}}f(q(t,x_{i-1/2}))\,dt\approx\Delta tf^{\downarrow}\left(%
 Q^{n}_{i-1},Q^{n}_{i}\right),     where     f  ↓    (   q  l   ,   q  r   )        superscript  f  normal-↓     subscript  q  l    subscript  q  r      f^{\downarrow}\left(q_{l},q_{r}\right)   is an approximation to the exact solution of the Riemann problem. For consistency, one assumes that          f  ↓    (   q  l   ,   q  r   )    =    f   (   q  l   )    if      q  l   =   q  r     ,     formulae-sequence       superscript  f  normal-↓     subscript  q  l    subscript  q  r        f   subscript  q  l    if       subscript  q  l    subscript  q  r      f^{\downarrow}(q_{l},q_{r})=f(q_{l})\quad\text{ if }\quad q_{l}=q_{r},     and that    f  ↓     superscript  f  normal-↓    f^{\downarrow}   is increasing in the first argument, and decreasing in the second argument. For scalar problems where      f  ′    (  q  )    >  0         superscript  f  normal-′   q   0    f^{\prime}(q)>0   , one can use the simple Upwind scheme , which defines      f  ↓    (   q  l   ,   q  r   )    =   f   (   q  l   )           superscript  f  normal-↓     subscript  q  l    subscript  q  r       f   subscript  q  l      f^{\downarrow}(q_{l},q_{r})=f(q_{l})   .  The full Godunov scheme requires the definition of an approximate, or an exact Riemann solver , but in its most basic form, is given by:        Q  i   n  +  1    =    Q  i  n   -   λ   (     f  ^    i  +   1  /  2    n   -    f  ^    i  -   1  /  2    n    )      ,    λ  =    Δ  t    Δ  x     ,     f  ^    i  -   1  /  2    n   =    f  ↓    (   Q   i  -  1   n   ,   Q  i  n   )         formulae-sequence     subscript   superscript  Q    n  1    i      subscript   superscript  Q  n   i     λ     subscript   superscript   normal-^  f   n     i    1  2      subscript   superscript   normal-^  f   n     i    1  2          formulae-sequence    λ      normal-Δ  t     normal-Δ  x        subscript   superscript   normal-^  f   n     i    1  2        superscript  f  normal-↓     subscript   superscript  Q  n     i  1     subscript   superscript  Q  n   i         Q^{n+1}_{i}=Q^{n}_{i}-\lambda\left(\hat{f}^{n}_{i+1/2}-\hat{f}^{n}_{i-1/2}%
 \right),\quad\lambda=\frac{\Delta t}{\Delta x},\quad\hat{f}^{n}_{i-1/2}=f^{%
 \downarrow}\left(Q^{n}_{i-1},Q^{n}_{i}\right)     Linear problem  In the case of a linear problem, where     f   (  q  )    =   a  q         f  q     a  q     f(q)=aq   , and without loss of generality, we'll assume that    a  >  0      a  0    a>0   , the upwinded Godunov method yields:         Q  i   n  +  1    =    Q  i  n   -   ν   (    Q  i  n   -   Q   i  -  1   n    )      ,   ν  =   a    Δ  t    Δ  x       ,     formulae-sequence     subscript   superscript  Q    n  1    i      subscript   superscript  Q  n   i     ν     subscript   superscript  Q  n   i    subscript   superscript  Q  n     i  1          ν    a      normal-Δ  t     normal-Δ  x        Q^{n+1}_{i}=Q^{n}_{i}-\nu\left(Q^{n}_{i}-Q^{n}_{i-1}\right),\quad\nu=a\frac{%
 \Delta t}{\Delta x},     which yields the classical first-order, upwinded Finite Volume scheme whose stability requires    ν  =   |   a    Δ  t    Δ  x     |   ≤  1        ν      a      normal-Δ  t     normal-Δ  x           1     \nu=\left|a\frac{\Delta t}{\Delta x}\right|\leq 1   .  Three-step algorithm  Following Hirsch , the scheme involves three distinct steps to obtain the solution at    t  =    (   n  +  1   )   Δ   t        t      n  1   normal-Δ  t     t=(n+1)\Delta t\,   from the known solution at    t  =   n  Δ   t        t    n  normal-Δ  t     {t=n\Delta t}\,   , as follows:  Step 1 Define piecewise constant approximation of the solution at    t  =    (   n  +  1   )   Δ   t        t      n  1   normal-Δ  t     {t=(n+1)\Delta t}\,   . Since the piecewise constant approximation is an average of the solution over the cell of size    Δ   x       normal-Δ  x    {\Delta x}\,   , the spatial error is of order    Δ   x       normal-Δ  x    {\Delta x}\,   , and hence the resulting scheme will be first-order accurate in space. Note that this approximation corresponds to a finite volume method representation whereby the discrete values represent averages of the state variables over the cells. Exact relations for the averaged cell values can be obtained from the integral conservation laws.  Step 2 Obtain the solution for the local Riemann problem at the cell interfaces. This is the only physical step of the whole procedure. The discontinuities at the interfaces are resolved in a superposition of waves satisfying locally the conservation equations. The original Godunov method is based upon the exact solution of the Riemann problems. However, approximate solutions can be applied as an alternative.  Step 3 Average the state variables after a time interval    Δ   t       normal-Δ  t    {\Delta t}\,   . The state variables obtained after Step 2 are averaged over each cell defining a new piecewise constant approximation resulting from the wave propagation during the time interval    Δ   t       normal-Δ  t    {\Delta t}\,   . To be consistent, the time interval    Δ   t       normal-Δ  t    {\Delta t}\,   should be limited such that the waves emanating from an interface do not interact with waves created at the adjacent interfaces. Otherwise the situation inside a cell would be influenced by interacting Riemann problems. This leads to the CFL condition      |   a  max   |   Δ  t   <    Δ  x   /   2             subscript  a     normal-Δ  t       normal-Δ  x   2     |a_{\max}|\Delta t<\Delta x/2\,   where    |   a  max   |       subscript  a      |a_{\max}|\,   is the maximum wave speed obtained from the cell eigenvalue(s) of the local Jacobian matrix .  The first and third steps are solely of a numerical nature and can be considered as a projection stage , independent of the second, physical step, the evolution stage . Therefore, they can be modified without influencing the physical input, for instance by replacing the piecewise constant approximation by a piecewise linear variation inside each cell, leading to the definition of second-order space-accurate schemes, such as the MUSCL scheme .  See also   Godunov's theorem  High-resolution scheme  Lax–Friedrichs method  MUSCL scheme  Sergei K. Godunov  Total variation diminishing  Lax–Wendroff theorem  AUSM   References   Godunov, S. K. (1959), "A Difference Scheme for Numerical Solution of Discontinuous Solution of Hydrodynamic Equations", Math. Sbornik , 47 , 271–306, translated US Joint Publ. Res. Service, JPRS 7226, 1969.  Hirsch, C. (1990), Numerical Computation of Internal and External Flows , vol 2, Wiley.  Leveque, Randy J. (2002), "Finite Volume Methods for Hyperbolic Problems", Cambridge University Press.   Further reading   Laney, Culbert B. (1998), Computational Gas Dynamics , Cambridge University Press.  Toro, E. F. (1999), Riemann Solvers and Numerical Methods for Fluid Dynamics , Springer-Verlag.  Tannehill, John C., et al., (1997), Computational Fluid mechanics and Heat Transfer , 2nd Ed., Taylor and Francis.  Wesseling, Pieter (2001), Principles of Computational Fluid Dynamics , Springer-Verlag.   "  Category:Computational fluid dynamics  Category:Conservation equations  Category:Numerical differential equations   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="934">XTR</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>XTR</h1>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a>, <strong>XTR</strong> is an <a class="uri" href="algorithm" title="wikilink">algorithm</a> for <a href="Public-key_cryptography" title="wikilink">public-key encryption</a>. XTR stands for ‘ECSTR’, which is an abbreviation for Efficient and Compact Subgroup Trace Representation. It is a method to represent elements of a subgroup of a multiplicative <a href="Group_(mathematics)" title="wikilink">group</a> of a <a href="finite_field" title="wikilink">finite field</a>. To do so, it uses the <a href="Field_trace" title="wikilink">trace</a> over 

<math display="inline" id="XTR:0">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 to represent elements of a subgroup of 

<math display="inline" id="XTR:1">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})^{*}
  </annotation>
 </semantics>
</math>

.</p>

<p>From a security point of view, XTR relies on the difficulty of solving <a href="discrete_logarithm" title="wikilink">Discrete Logarithm</a> related problems in the full multiplicative group of a finite field. Unlike many cryptographic protocols that are based on the generator of the full multiplicative group of a finite field, XTR uses the generator 

<math display="inline" id="XTR:2">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 of a relatively small subgroup of some prime order 

<math display="inline" id="XTR:3">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 of a subgroup of 

<math display="inline" id="XTR:4">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})^{*}
  </annotation>
 </semantics>
</math>

. With the right choice of 

<math display="inline" id="XTR:5">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

, computing Discrete Logarithms in the group, generated by 

<math display="inline" id="XTR:6">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

, is, in general, as hard as it is in 

<math display="inline" id="XTR:7">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})^{*}
  </annotation>
 </semantics>
</math>

 and thus cryptographic applications of XTR use 

<math display="inline" id="XTR:8">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 arithmetics while achieving full 

<math display="inline" id="XTR:9">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 security leading to substantial savings both in communication and <a href="overhead_(computing)" title="wikilink">computational overhead</a> without compromising security. Some other advantages of XTR are its fast key generation, small key sizes and speed.</p>
<h2 id="fundamentals-of-xtr">Fundamentals of XTR</h2>

<p>XTR uses a <a class="uri" href="subgroup" title="wikilink">subgroup</a>, commonly referred to as <em>XTR subgroup</em> or just <em>XTR group</em>, of a subgroup called <em>XTR supergroup</em>, of the multiplicative group of a <a href="finite_field" title="wikilink">finite field</a> 

<math display="inline" id="XTR:10">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="XTR:11">
 <semantics>
  <msup>
   <mi>p</mi>
   <mn>6</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>p</ci>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{6}
  </annotation>
 </semantics>
</math>

 elements. The XTR supergroup is of order 

<math display="inline" id="XTR:12">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

, where <em>p</em> is a prime such that a sufficiently large prime <em>q</em> divides 

<math display="inline" id="XTR:13">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

. The XTR subgroup has now order <em>q</em> and is, as a subgroup of 

<math display="inline" id="XTR:14">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})^{*}
  </annotation>
 </semantics>
</math>

, a <a href="cyclic_group" title="wikilink">cyclic group</a> 

<math display="inline" id="XTR:15">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

 with <a href="Group_generator" title="wikilink">generator</a> <em>g</em>. The following three paragraphs will describe how elements of the XTR supergroup can be represented using an element of 

<math display="inline" id="XTR:16">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 instead of an element of 

<math display="inline" id="XTR:17">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 and how arithmetic operations take place in 

<math display="inline" id="XTR:18">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 instead of in 

<math display="inline" id="XTR:19">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="arithmetic-operations-in-gfp2">Arithmetic operations in 

<math display="inline" id="XTR:20">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

</h3>

<p>Let <em>p</em> be a prime such that <em>p</em>  <em>2</em> mod <em>3</em> and <em>p<sup>2</sup> - p + 1</em> has a sufficiently large prime factor <em>q</em>. Since <em>p<sup>2</sup></em>  <em>1</em> mod <em>3</em> we see that <em>p</em> generates 

<math display="inline" id="XTR:21">
 <semantics>
  <msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mi>ℤ</mi>
      <mo>/</mo>
      <mn>3</mn>
     </mrow>
     <mi>ℤ</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>*</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>ℤ</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>ℤ</ci>
    </apply>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbb{Z}/3\mathbb{Z})^{*}
  </annotation>
 </semantics>
</math>

 and thus the third <a href="cyclotomic_polynomial" title="wikilink">cyclotomic polynomial</a> 

<math display="inline" id="XTR:22">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Φ</mi>
     <mn>3</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>x</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <mi>x</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Φ</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi_{3}(x)=x^{2}+x+1
  </annotation>
 </semantics>
</math>

 is <a href="Irreducibility_(mathematics)" title="wikilink">irreducible</a> over 

<math display="inline" id="XTR:23">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

. It follows that the <a href="Root_of_a_function" title="wikilink">roots</a> 

<math display="inline" id="XTR:24">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:25">
 <semantics>
  <msup>
   <mi>α</mi>
   <mi>p</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>α</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha^{p}
  </annotation>
 </semantics>
</math>

 form an optimal <a href="normal_basis" title="wikilink">normal basis</a> for 

<math display="inline" id="XTR:26">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="XTR:27">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="XTR:28">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mi>F</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≅</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mi>α</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
       <msup>
        <mi>α</mi>
        <mi>p</mi>
       </msup>
      </mrow>
     </mrow>
     <mo>:</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>∈</mo>
      <mrow>
       <mi>G</mi>
       <mi>F</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>p</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>α</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>α</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <in></in>
      <list>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </list>
      <apply>
       <times></times>
       <ci>G</ci>
       <ci>F</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})\cong\{x_{1}\alpha+x_{2}\alpha^{p}:x_{1},x_{2}\in GF(p)\}.
  </annotation>
 </semantics>
</math>

 Considering that <em>p</em> <em>2</em> mod <em>3</em> we can reduce the exponents modulo <em>3</em> to get</p>

<p>

<math display="block" id="XTR:29">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mi>F</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≅</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mi>α</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <msup>
        <mi>α</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>:</mo>
     <mrow>
      <mrow>
       <mrow>
        <msup>
         <mi>α</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mi>α</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo>=</mo>
       <mrow>
        <mn>0</mn>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mn>2</mn>
       </msub>
       <mo>∈</mo>
       <mrow>
        <mi>G</mi>
        <mi>F</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>p</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>α</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>α</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>α</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>α</ci>
        <cn type="integer">1</cn>
       </apply>
       <list>
        <cn type="integer">0</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
       </list>
      </apply>
      <apply>
       <in></in>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>G</ci>
        <ci>F</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})\cong\{y_{1}\alpha+y_{2}\alpha^{2}:\alpha^{2}+\alpha+1=0,y_{1},y_{2}%
\in GF(p)\}.
  </annotation>
 </semantics>
</math>

</p>

<p>The cost of arithmetic operations is now given in the following Lemma labeled Lemma 2.21 in <em>"An overview of the XTR public key system"</em>:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p><strong>Lemma</strong></p>
<ul>
<li>Computing <em>x</em><sup><em>p</em></sup> is done without using multiplication</li>
<li>Computing <em>x</em><sup><em>2</em></sup> takes two multiplications in 

<math display="inline" id="XTR:30">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

</li>
<li>Computing <em>xy</em> takes three multiplications in 

<math display="inline" id="XTR:31">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

</li>
<li>Computing <em>xz-yz<sup><em>p</em></sup></em> takes four multiplications in 

<math display="inline" id="XTR:32">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

.</li>
</ul>
<h3 id="traces-over-gfp2">Traces over 

<math display="inline" id="XTR:33">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

</h3>

<p>The <a href="Field_trace" title="wikilink">trace</a> in XTR is always considered over 

<math display="inline" id="XTR:34">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

. In other words, the <a href="Conjugate_element_(field_theory)" title="wikilink">conjugates</a> of 

<math display="inline" id="XTR:35">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>h</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h\in GF(p^{6})
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="XTR:36">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 are 

<math display="inline" id="XTR:37">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>,</mo>
   <msup>
    <mi>h</mi>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>h</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h,h^{p^{2}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:38">
 <semantics>
  <msup>
   <mi>h</mi>
   <msup>
    <mi>p</mi>
    <mn>4</mn>
   </msup>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>h</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{p^{4}}
  </annotation>
 </semantics>
</math>

 and the trace of 

<math display="inline" id="XTR:39">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 is their sum:</p>

<p>

<math display="block" id="XTR:40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>h</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>h</mi>
     <mo>+</mo>
     <msup>
      <mi>h</mi>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>h</mi>
      <msup>
       <mi>p</mi>
       <mn>4</mn>
      </msup>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>h</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(h)=h+h^{p^{2}}+h^{p^{4}}.
  </annotation>
 </semantics>
</math>

 Note that 

<math display="inline" id="XTR:41">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>h</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>h</ci>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(h)\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 since</p>

<p>

<math display="inline" id="XTR:42">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>h</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle Tr(h)^{p^{2}}
  </annotation>
 </semantics>
</math>


</p>

<p>Consider now the generator 

<math display="inline" id="XTR:43">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 of the XTR subgroup of a prime order 

<math display="inline" id="XTR:44">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

. Remember that 

<math display="inline" id="XTR:45">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

 is a subgroup of the XTR supergroup of order 

<math display="inline" id="XTR:46">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

, so 

<math display="inline" id="XTR:47">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>∣</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>p</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">p</csymbol>
    <plus></plus>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\mid p^{2}-p+1
  </annotation>
 </semantics>
</math>

. In the <a href="XTR#Finite_field_and_subgroup_size_selection" title="wikilink">following section</a> we will see how to choose 

<math display="inline" id="XTR:48">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:49">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

, but for now it is sufficient to assume that 

<math display="inline" id="XTR:50">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>></mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>q</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q>3
  </annotation>
 </semantics>
</math>

. To compute the trace of 

<math display="inline" id="XTR:51">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 note that modulo 

<math display="inline" id="XTR:52">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

 we have</p>

<p>

<math display="block" id="XTR:53">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}=p-1
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="XTR:54">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mn>4</mn>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <mi>p</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">4</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>p</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{4}=(p-1)^{2}=p^{2}-2p+1=-p
  </annotation>
 </semantics>
</math>

 and thus</p>

<p>

<math display="inline" id="XTR:55">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle Tr(g)
  </annotation>
 </semantics>
</math>


 Note also that the product of the conjugates of 

<math display="inline" id="XTR:56">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 equals 

<math display="inline" id="XTR:57">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

, i.e., that 

<math display="inline" id="XTR:58">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 has <a href="field_norm" title="wikilink">norm</a> 1.</p>

<p>The crucial observation in XTR is that the <a href="Minimal_polynomial_(field_theory)" title="wikilink">minimal polynomial</a> of 

<math display="inline" id="XTR:59">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="XTR:60">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="XTR:61">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <mi>g</mi>
    </mrow>
    <mo rspace="5.8pt" stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>p</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>x</mi>
     <mo>-</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mo>-</mo>
       <mi>p</mi>
      </mrow>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <minus></minus>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x-g)\!\ (x-g^{p-1})(x-g^{-p})
  </annotation>
 </semantics>
</math>

 simplifies to</p>

<p>

<math display="block" id="XTR:62">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mi>T</mi>
      <mi>r</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>g</mi>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>g</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
     </msup>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <ci>g</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>p</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{3}-Tr(g)\!\ x^{2}+Tr(g)^{p}x-1
  </annotation>
 </semantics>
</math>

 which is fully determined by 

<math display="inline" id="XTR:63">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)
  </annotation>
 </semantics>
</math>

. Consequently, conjugates of 

<math display="inline" id="XTR:64">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

, as roots of the minimal polynomial of 

<math display="inline" id="XTR:65">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 over 

<math display="inline" id="XTR:66">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

, are completely determined by the trace of 

<math display="inline" id="XTR:67">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

. The same is true for any power of 

<math display="inline" id="XTR:68">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

: conjugates of 

<math display="inline" id="XTR:69">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{n}
  </annotation>
 </semantics>
</math>

 are roots of polynomial</p>

<p>

<math display="block" id="XTR:70">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mi>T</mi>
      <mi>r</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>g</mi>
        <mi>n</mi>
       </msup>
       <mo rspace="5.8pt" stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>g</mi>
        <mi>n</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
     </msup>
     <mi>x</mi>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>r</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>n</ci>
       </apply>
       <ci>p</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{3}-Tr(g^{n})\!\ x^{2}+Tr(g^{n})^{p}x-1
  </annotation>
 </semantics>
</math>

 and this polynomial is completely determined by 

<math display="inline" id="XTR:71">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{n})
  </annotation>
 </semantics>
</math>

.</p>

<p>The idea behind using traces is to replace 

<math display="inline" id="XTR:72">
 <semantics>
  <mrow>
   <msup>
    <mi>g</mi>
    <mi>n</mi>
   </msup>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{n}\in GF(p^{6})
  </annotation>
 </semantics>
</math>

 in cryptographic protocols, e.g. the <a href="Diffie-Hellman_key_exchange" title="wikilink">Diffie-Hellman key exchange</a> by 

<math display="inline" id="XTR:73">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{n})\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 and thus obtaining a factor of 3 reduction in representation size. This is, however, only useful if there is a quick way to obtain 

<math display="inline" id="XTR:74">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{n})
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="XTR:75">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)
  </annotation>
 </semantics>
</math>

. The next paragraph gives an algorithm for the efficient computation of 

<math display="inline" id="XTR:76">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{n})
  </annotation>
 </semantics>
</math>

. In addition, computing 

<math display="inline" id="XTR:77">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{n})
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="XTR:78">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)
  </annotation>
 </semantics>
</math>

 turns out to be quicker than computing 

<math display="inline" id="XTR:79">
 <semantics>
  <msup>
   <mi>g</mi>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>g</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g^{n}
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="XTR:80">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h3 id="algorithm-for-the-quick-computation-of-trgn-given-trg">Algorithm for the quick computation of 

<math display="inline" id="XTR:81">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{n})
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="XTR:82">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)
  </annotation>
 </semantics>
</math>

</h3>

<p>A. Lenstra and E. Verheul give this algorithm in their paper titled <em>The XTR public key system</em> in.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> All the definitions and lemmas necessary for the algorithm and the algorithm itself presented here, are taken from that paper.</p>

<p><strong>Definition</strong> For c in 

<math display="inline" id="XTR:83">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 define</p>

<p>

<math display="block" id="XTR:84">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>F</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>c</mi>
      <mo>,</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>X</mi>
        <mn>3</mn>
       </msup>
       <mo>-</mo>
       <mrow>
        <mi>c</mi>
        <msup>
         <mi>X</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msup>
        <mi>c</mi>
        <mi>p</mi>
       </msup>
       <mi>X</mi>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>∈</mo>
    <mrow>
     <mi>G</mi>
     <mi>F</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>X</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>F</ci>
      <interval closure="open">
       <ci>c</ci>
       <ci>X</ci>
      </interval>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <times></times>
         <ci>c</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <ci>p</ci>
        </apply>
        <ci>X</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>X</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,X)=X^{3}-cX^{2}+c^{p}X-1\in GF(p^{2})[X].
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Definition</strong> Let 

<math display="inline" id="XTR:85">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mn>0</mn>
   </msub>
   <mo rspace="5.8pt">,</mo>
   <msub>
    <mi>h</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{0},\!\ h_{1},h_{2}
  </annotation>
 </semantics>
</math>

 denote the, not necessarily distinct, roots of 

<math display="inline" id="XTR:86">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo>,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,X)
  </annotation>
 </semantics>
</math>

 in 

<math display="inline" id="XTR:87">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 and let 

<math display="inline" id="XTR:88">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 be in 

<math display="inline" id="XTR:89">
 <semantics>
  <mi>ℤ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℤ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbb{Z}
  </annotation>
 </semantics>
</math>

. Define</p>

<p>

<math display="block" id="XTR:90">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>h</mi>
      <mn>0</mn>
      <mi>n</mi>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>h</mi>
      <mn>1</mn>
      <mi>n</mi>
     </msubsup>
     <mo>+</mo>
     <msubsup>
      <mi>h</mi>
      <mn>2</mn>
      <mi>n</mi>
     </msubsup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}=h_{0}^{n}+h_{1}^{n}+h_{2}^{n}.
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Properties of 

<math display="inline" id="XTR:91">
 <semantics>
  <msub>
   <mi>c</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:92">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo>,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,X)
  </annotation>
 </semantics>
</math>

</strong></p>
<ol>
<li>

<math display="inline" id="XTR:93">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <msub>
    <mi>c</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=c_{1}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="XTR:94">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mrow>
     <mo>-</mo>
     <mi>n</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>c</mi>
    <mrow>
     <mi>n</mi>
     <mi>p</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msubsup>
    <mi>c</mi>
    <mi>n</mi>
    <mi>p</mi>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <apply>
       <times></times>
       <ci>n</ci>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{-n}=c_{np}=c_{n}^{p}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="XTR:95">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mtext>for</mtext>
    <mi>n</mi>
   </mrow>
   <mo>∈</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <mtext>for</mtext>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <ci>ℤ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n}\in GF(p^{2})\text{ for }n\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="XTR:96">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>u</mi>
      <mo>+</mo>
      <mi>v</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mi>c</mi>
        <mi>u</mi>
       </msub>
       <msub>
        <mi>c</mi>
        <mi>v</mi>
       </msub>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msubsup>
        <mi>c</mi>
        <mi>v</mi>
        <mi>p</mi>
       </msubsup>
       <msub>
        <mi>c</mi>
        <mrow>
         <mi>u</mi>
         <mo>-</mo>
         <mi>v</mi>
        </mrow>
       </msub>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>u</mi>
        <mo>-</mo>
        <mrow>
         <mn>2</mn>
         <mi>v</mi>
        </mrow>
       </mrow>
      </msub>
      <mtext>for</mtext>
      <mi>u</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>v</mi>
    <mo>∈</mo>
    <mi>ℤ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <apply>
       <plus></plus>
       <ci>u</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>c</ci>
          <ci>v</ci>
         </apply>
         <ci>p</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <apply>
          <minus></minus>
          <ci>u</ci>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <apply>
         <minus></minus>
         <ci>u</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
       <mtext>for</mtext>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <ci>v</ci>
     <ci>ℤ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{u+v}=c_{u}c_{v}-c_{v}^{p}c_{u-v}+c_{u-2v}\text{ for }u,v\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

</li>
<li>Either all 

<math display="inline" id="XTR:97">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{j}
  </annotation>
 </semantics>
</math>

 have order dividing 

<math display="inline" id="XTR:98">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:99">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>></mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <csymbol cd="latexml">absent</csymbol>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   >3
  </annotation>
 </semantics>
</math>

 or all 

<math display="inline" id="XTR:100">
 <semantics>
  <msub>
   <mi>h</mi>
   <mi>j</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>h</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{j}
  </annotation>
 </semantics>
</math>

 are in 

<math display="inline" id="XTR:101">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

. In particular, 

<math display="inline" id="XTR:102">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo>,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,X)
  </annotation>
 </semantics>
</math>

 is irreducible if and only if its roots have order diving 

<math display="inline" id="XTR:103">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:104">
 <semantics>
  <mrow>
   <mi></mi>
   <mo>></mo>
   <mn>3</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <csymbol cd="latexml">absent</csymbol>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   >3
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="XTR:105">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo>,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,X)
  </annotation>
 </semantics>
</math>

 is reducible over 

<math display="inline" id="XTR:106">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 if and only if 

<math display="inline" id="XTR:107">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mrow>
     <mi>p</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <plus></plus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{p+1}\in GF(p)
  </annotation>
 </semantics>
</math>

</li>
</ol>

<p><strong>Lemma</strong> Let 

<math display="inline" id="XTR:108">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo rspace="5.8pt">,</mo>
   <msub>
    <mi>c</mi>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>c</mi>
    <mi>n</mi>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>c</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>c</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c,\!\ c_{n-1},c_{n},c_{n+1}
  </annotation>
 </semantics>
</math>

 be given.</p>
<ol>
<li>Computing 

<math display="inline" id="XTR:109">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mrow>
     <mn>2</mn>
     <mi>n</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>c</mi>
     <mi>n</mi>
     <mn>2</mn>
    </msubsup>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msubsup>
      <mi>c</mi>
      <mi>n</mi>
      <mi>p</mi>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{2n}=c_{n}^{2}-2c_{n}^{p}
  </annotation>
 </semantics>
</math>

 takes two multiplication in 

<math display="inline" id="XTR:110">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

.</li>
<li>Computing 

<math display="inline" id="XTR:111">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>⋅</mo>
      <mi>c</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi>c</mi>
       <mi>p</mi>
      </msup>
      <mo>⋅</mo>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n+2}=c_{n+1}\cdot c-c^{p}\cdot c_{n}+c_{n-1}
  </annotation>
 </semantics>
</math>

 takes four multiplication in 

<math display="inline" id="XTR:112">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

.</li>
<li>Computing 

<math display="inline" id="XTR:113">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>⋅</mo>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi>c</mi>
       <mi>p</mi>
      </msup>
      <mo>⋅</mo>
      <msubsup>
       <mi>c</mi>
       <mi>n</mi>
       <mi>p</mi>
      </msubsup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msubsup>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mi>p</mi>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>n</ci>
        </apply>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{2n-1}=c_{n-1}\cdot c_{n}-c^{p}\cdot c_{n}^{p}+c_{n+1}^{p}
  </annotation>
 </semantics>
</math>

 takes four multiplication in 

<math display="inline" id="XTR:114">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

.</li>
<li>Computing 

<math display="inline" id="XTR:115">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>⋅</mo>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>c</mi>
      <mo>⋅</mo>
      <msubsup>
       <mi>c</mi>
       <mi>n</mi>
       <mi>p</mi>
      </msubsup>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msubsup>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>p</mi>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <ci>c</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>c</ci>
         <ci>n</ci>
        </apply>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>p</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{2n+1}=c_{n+1}\cdot c_{n}-c\cdot c_{n}^{p}+c_{n-1}^{p}
  </annotation>
 </semantics>
</math>

 takes four multiplication in 

<math display="inline" id="XTR:116">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p><strong>Definition</strong> Let 

<math display="inline" id="XTR:117">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>n</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>c</mi>
     <mi>n</mi>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>n</ci>
      </apply>
      <ci>c</ci>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>c</ci>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{n}(c)=(c_{n-1},c_{n},c_{n+1})\in GF(p^{2})^{3}
  </annotation>
 </semantics>
</math>

.</p>

<p><strong>Algorithm 1 for computation of 

<math display="inline" id="XTR:118">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>n</ci>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{n}(c)
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="XTR:119">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:120">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

</strong></p>
<ul>
<li>If 

<math display="inline" id="XTR:121">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <ci>n</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n<0
  </annotation>
 </semantics>
</math>

 apply this algorithm to 

<math display="inline" id="XTR:122">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -n
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:123">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

, and apply Property 2 to the resulting value.</li>
<li>If 

<math display="inline" id="XTR:124">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=0
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="XTR:125">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>c</mi>
     <mi>p</mi>
    </msup>
    <mo>,</mo>
    <mn>3</mn>
    <mo>,</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>c</ci>
    </apply>
    <vector>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>p</ci>
     </apply>
     <cn type="integer">3</cn>
     <ci>c</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{0}(c)\!\ =(c^{p},3,c)
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="XTR:126">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=1
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="XTR:127">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo rspace="5.8pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>3</mn>
    <mo>,</mo>
    <mi>c</mi>
    <mo>,</mo>
    <mrow>
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>c</mi>
       <mi>p</mi>
      </msup>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>c</ci>
    </apply>
    <vector>
     <cn type="integer">3</cn>
     <ci>c</ci>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>c</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{1}(c)\!\ =(3,c,c^{2}-2c^{p})
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="XTR:128">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=2
  </annotation>
 </semantics>
</math>

, use the computation of 

<math display="inline" id="XTR:129">
 <semantics>
  <mrow>
   <msub>
    <mi>c</mi>
    <mrow>
     <mi>n</mi>
     <mo>+</mo>
     <mn>2</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>c</mi>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mo>⋅</mo>
      <mi>c</mi>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msup>
       <mi>c</mi>
       <mi>p</mi>
      </msup>
      <mo>⋅</mo>
      <msub>
       <mi>c</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>c</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>c</ci>
        <ci>p</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>c</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{n+2}=c_{n+1}\cdot c-c^{p}\cdot c_{n}+c_{n-1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:130">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{1}(c)
  </annotation>
 </semantics>
</math>

 to find 

<math display="inline" id="XTR:131">
 <semantics>
  <msub>
   <mi>c</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>c</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c_{3}
  </annotation>
 </semantics>
</math>

 and thereby 

<math display="inline" id="XTR:132">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{2}(c)
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="XTR:133">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>></mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n>2
  </annotation>
 </semantics>
</math>

, to compute 

<math display="inline" id="XTR:134">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>n</ci>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{n}(c)
  </annotation>
 </semantics>
</math>

 define</li>
</ul>
<dl>
<dd><dl>
<dd>

<math display="inline" id="XTR:135">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>S</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mi>i</mi>
      </mrow>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>S</ci>
      </apply>
      <ci>i</ci>
     </apply>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>i</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{S}_{i}(c)=S_{2i+1}(c)
  </annotation>
 </semantics>
</math>


</dd>
</dl>
</dd>
<dd><dl>
<dd>and 

<math display="inline" id="XTR:136">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>m</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>m</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{m}=n
  </annotation>
 </semantics>
</math>

 if n is odd and 

<math display="inline" id="XTR:137">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>m</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mi>n</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>m</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{m}=n-1
  </annotation>
 </semantics>
</math>

 otherwise. Let 

<math display="inline" id="XTR:138">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>m</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>m</mi>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>k</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-¯</ci>
      <ci>m</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{m}=2m+1,k=1
  </annotation>
 </semantics>
</math>

 and compute 

<math display="inline" id="XTR:139">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>S</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>S</mi>
     <mn>3</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>S</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{S}_{k}(c)=S_{3}(c)
  </annotation>
 </semantics>
</math>

 using the Lemma above and 

<math display="inline" id="XTR:140">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{2}(c)
  </annotation>
 </semantics>
</math>

. Let further

<p>

<math display="block" id="XTR:141">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>r</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>m</mi>
      <mi>j</mi>
     </msub>
     <msup>
      <mn>2</mn>
      <mi>j</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>r</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>j</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <cn type="integer">2</cn>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=\sum_{j=0}^{r}m_{j}2^{j}
  </annotation>
 </semantics>
</math>

</p>
</dd>
<dd>with 

<math display="inline" id="XTR:142">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mi>j</mi>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>j</ci>
    </apply>
    <list>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{j}\in{0,1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:143">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mi>r</mi>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>r</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{r}=1
  </annotation>
 </semantics>
</math>

. For 

<math display="inline" id="XTR:144">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>r</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>r</mi>
     <mo>-</mo>
     <mn>2</mn>
    </mrow>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mn>0</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>j</ci>
    <list>
     <apply>
      <minus></minus>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <cn type="integer">0</cn>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j=r-1,r-2,...,0
  </annotation>
 </semantics>
</math>

 in succession, do the following:
<ul>
<li>If 

<math display="inline" id="XTR:145">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>j</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{j}=0
  </annotation>
 </semantics>
</math>

, use 

<math display="inline" id="XTR:146">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>S</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>S</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{S}_{k}(c)
  </annotation>
 </semantics>
</math>

 to compute 

<math display="inline" id="XTR:147">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>S</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mrow>
     <mn>2</mn>
     <mi>k</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>k</ci>
     </apply>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{S}_{2k}(c)
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="XTR:148">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mi>j</mi>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>j</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{j}=1
  </annotation>
 </semantics>
</math>

, use 

<math display="inline" id="XTR:149">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>S</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>S</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{S}_{k}(c)
  </annotation>
 </semantics>
</math>

 to compute 

<math display="inline" id="XTR:150">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>S</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>k</mi>
     </mrow>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>k</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{S}_{2k+1}(c)
  </annotation>
 </semantics>
</math>

.</li>
<li>Replace 

<math display="inline" id="XTR:151">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="XTR:152">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mi>k</mi>
   </mrow>
   <mo>+</mo>
   <msub>
    <mi>m</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2k+m_{j}
  </annotation>
 </semantics>
</math>

.</li>
</ul>
</dd>
</dl>
</dd>
</dl>

<p>When these iterations finish, 

<math display="inline" id="XTR:153">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mi>m</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <ci>m</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=m
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:154">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mover accent="true">
      <mi>m</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>S</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>m</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>S</ci>
      </apply>
      <ci>m</ci>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{\bar{m}}(c)=\bar{S}_{m}(c)
  </annotation>
 </semantics>
</math>

. If n is even use 

<math display="inline" id="XTR:155">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mover accent="true">
     <mi>m</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{\bar{m}}(c)
  </annotation>
 </semantics>
</math>

 to compute 

<math display="inline" id="XTR:156">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>S</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mrow>
     <mi>m</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>S</ci>
     </apply>
     <apply>
      <plus></plus>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{S}_{m+1}(c)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="parameter-selection">Parameter selection</h2>
<h3 id="finite-field-and-subgroup-size-selection">Finite field and subgroup size selection</h3>

<p>In order to take advantage of the above described representations of elements with their traces and furthermore ensure sufficient security, that will be discussed <a href="XTR#Security" title="wikilink">below</a>, we need to find primes 

<math display="inline" id="XTR:157">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:158">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="XTR:159">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 denotes the <a href="characteristic_(algebra)" title="wikilink">characteristic</a> of the field 

<math display="inline" id="XTR:160">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="XTR:161">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>2</mn>
    </mpadded>
    <mtext>mod</mtext>
    <mn>3</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>p</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <mtext>mod</mtext>
     <cn type="float">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\equiv 2\ \text{mod}\ 3
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:162">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 is the size of the subgroup, such that 

<math display="inline" id="XTR:163">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="XTR:164">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

.</p>

<p>We denote with 

<math display="inline" id="XTR:165">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:166">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 the sizes of 

<math display="inline" id="XTR:167">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:168">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 in bits. To achieve security comparable to 1024-bit <a href="RSA_(algorithm)" title="wikilink">RSA</a>, we should choose 

<math display="inline" id="XTR:169">
 <semantics>
  <mrow>
   <mn>6</mn>
   <mi>P</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">6</cn>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   6P
  </annotation>
 </semantics>
</math>

 about 1024, i.e. 

<math display="inline" id="XTR:170">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>≈</mo>
   <mn>170</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>P</ci>
    <cn type="integer">170</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\approx 170
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:171">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 can be around 160.</p>

<p>A first easy algorithm to compute such primes 

<math display="inline" id="XTR:172">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:173">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 is the next Algorithm A:</p>

<p><strong>Algorithm A</strong></p>
<ol>
<li>Find 

<math display="inline" id="XTR:174">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>∈</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>r</ci>
    <ci>ℤ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="XTR:175">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mi>r</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>r</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=r^{2}-r+1
  </annotation>
 </semantics>
</math>

 is a 

<math display="inline" id="XTR:176">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

-bit prime.</li>
<li>Find 

<math display="inline" id="XTR:177">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>∈</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>k</ci>
    <ci>ℤ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="XTR:178">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <mi>r</mi>
    <mo>+</mo>
    <mrow>
     <mi>k</mi>
     <mo>⋅</mo>
     <mi>q</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <ci>r</ci>
     <apply>
      <ci>normal-⋅</ci>
      <ci>k</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=r+k\cdot q
  </annotation>
 </semantics>
</math>

 is a 

<math display="inline" id="XTR:179">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

-bit prime with 

<math display="inline" id="XTR:180">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>2</mn>
    </mpadded>
    <mtext>mod</mtext>
    <mn>3</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>p</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <mtext>mod</mtext>
     <cn type="float">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\equiv 2\ \text{mod}\ 3
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<dl>
<dd><em>Correctness of Algorithm A:</em>
</dd>
</dl>
<dl>
<dd>It remains to check that 

<math display="inline" id="XTR:181">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>∣</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>p</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">p</csymbol>
    <plus></plus>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\mid p^{2}-p+1
  </annotation>
 </semantics>
</math>

 because all the other necessary properties are obviously satisfied per definition of 

<math display="inline" id="XTR:182">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:183">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

. We easily see that 

<math display="inline" id="XTR:184">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mi>p</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>r</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mi>r</mi>
       <mi>k</mi>
       <mi>q</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
       <msup>
        <mi>q</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mi>r</mi>
     <mo>-</mo>
     <mrow>
      <mi>k</mi>
      <mi>q</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mi>r</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <mi>q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>r</mi>
         <mi>k</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>k</mi>
          <mn>2</mn>
         </msup>
         <mi>q</mi>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mn>2</mn>
        <mi>r</mi>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>k</mi>
         <mn>2</mn>
        </msup>
        <mi>q</mi>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>k</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>p</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>r</ci>
         <ci>k</ci>
         <ci>q</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>q</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <ci>r</ci>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>r</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>r</ci>
      </apply>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>q</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>r</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>q</ci>
         </apply>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>q</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>r</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>q</ci>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1=r^{2}+2rkq+k^{2}q^{2}-r-kq+1=r^{2}-r+1+q(2rk+k^{2}q-k)=q(1+2rk+k^{2}%
q-k)
  </annotation>
 </semantics>
</math>

 which implies that 

<math display="inline" id="XTR:185">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>∣</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>p</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">p</csymbol>
    <plus></plus>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\mid p^{2}-p+1
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>

<p>Algorithm A is very fast and can be used to find primes 

<math display="inline" id="XTR:186">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 that satisfy a degree-two polynomial with small coefficients. Such 

<math display="inline" id="XTR:187">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 lead to fast arithmetic operations in 

<math display="inline" id="XTR:188">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

. In particular if the search for 

<math display="inline" id="XTR:189">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is restricted to 

<math display="inline" id="XTR:190">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=1
  </annotation>
 </semantics>
</math>

, which means looking for an 

<math display="inline" id="XTR:191">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 such that both 

<math display="inline" id="XTR:192">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>r</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>r</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mn>1</mn>
    <mtext>and</mtext>
    <msup>
     <mi>r</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>r</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <mtext>and</mtext>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{2}-r+1\text{ and }r^{2}+1
  </annotation>
 </semantics>
</math>

 are prime and such that 

<math display="inline" id="XTR:193">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>r</mi>
     <mn>2</mn>
    </msup>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>≡</mo>
   <mrow>
    <mn>2</mn>
    <mtext>mod</mtext>
    <mn>3</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <mtext>mod</mtext>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{2}+1\equiv 2\text{ mod }3
  </annotation>
 </semantics>
</math>

, the primes 

<math display="inline" id="XTR:194">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 have this nice form. Note that in this case 

<math display="inline" id="XTR:195">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 must be even and 

<math display="inline" id="XTR:196">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>≡</mo>
   <mrow>
    <mn>1</mn>
    <mtext>mod</mtext>
    <mn>4</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>r</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <mtext>mod</mtext>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\equiv 1\text{ mod }4
  </annotation>
 </semantics>
</math>

.</p>

<p>On the other hand such 

<math display="inline" id="XTR:197">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 may be undesirable from a security point of view because they may make an attack with the <a href="Discrete_Logarithm" title="wikilink">Discrete Logarithm</a> variant of the <a href="Number_Field_Sieve" title="wikilink">Number Field Sieve</a> easier.</p>

<p>The following Algorithm B doesn't have this disadvantage, but it also doesn't have the fast arithmetic modulo 

<math display="inline" id="XTR:198">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 Algorithm A has in that case.</p>

<p><strong>Algorithm B</strong></p>
<ol>
<li>Select a 

<math display="inline" id="XTR:199">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

-bit prime 

<math display="inline" id="XTR:200">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 so that 

<math display="inline" id="XTR:201">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>7</mn>
    </mpadded>
    <mtext>mod</mtext>
    <mn>12</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>q</ci>
    <apply>
     <times></times>
     <cn type="integer">7</cn>
     <mtext>mod</mtext>
     <cn type="float">12</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\equiv 7\ \text{mod}\ 12
  </annotation>
 </semantics>
</math>

.</li>
<li>Find the roots 

<math display="inline" id="XTR:202">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:203">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{2}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="XTR:204">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>X</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>X</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>1</mn>
    </mpadded>
    <mpadded width="+5pt">
     <mtext>mod</mtext>
    </mpadded>
    <mi>q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <mtext>mod</mtext>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{2}-X+1\ \text{mod}\ q
  </annotation>
 </semantics>
</math>

.</li>
<li>Find a 

<math display="inline" id="XTR:205">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>∈</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>k</ci>
    <ci>ℤ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="XTR:206">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>r</mi>
     <mi>i</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>k</mi>
     <mo>⋅</mo>
     <mi>q</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>p</ci>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>k</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p=r_{i}+k\cdot q
  </annotation>
 </semantics>
</math>

 is a 

<math display="inline" id="XTR:207">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

-bit prime with 

<math display="inline" id="XTR:208">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>2</mn>
    </mpadded>
    <mtext>mod</mtext>
    <mn>3</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>p</ci>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <mtext>mod</mtext>
     <cn type="float">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\equiv 2\ \text{mod}\ 3
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="XTR:209">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>i</ci>
    <set>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\in\{1,2\}
  </annotation>
 </semantics>
</math>

</li>
</ol>
<dl>
<dd><em>Correctness of Algorithm B:</em>
</dd>
<dd>Since we chose 

<math display="inline" id="XTR:210">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>7</mn>
    </mpadded>
    <mtext>mod</mtext>
    <mn>12</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>q</ci>
    <apply>
     <times></times>
     <cn type="integer">7</cn>
     <mtext>mod</mtext>
     <cn type="float">12</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\equiv 7\ \text{mod}\ 12
  </annotation>
 </semantics>
</math>

 it follows immediately that 

<math display="inline" id="XTR:211">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>1</mn>
    </mpadded>
    <mtext>mod</mtext>
    <mn>3</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>q</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <mtext>mod</mtext>
     <cn type="float">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\equiv 1\ \text{mod}\ 3
  </annotation>
 </semantics>
</math>

 (because 

<math display="inline" id="XTR:212">
 <semantics>
  <mrow>
   <mn>7</mn>
   <mo>≡</mo>
   <mrow>
    <mpadded width="+5pt">
     <mn>1</mn>
    </mpadded>
    <mtext>mod</mtext>
    <mn>3</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <cn type="integer">7</cn>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <mtext>mod</mtext>
     <cn type="float">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   7\equiv 1\ \text{mod}\ 3
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:213">
 <semantics>
  <mrow>
   <mn>3</mn>
   <mo>∣</mo>
   <mn>12</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cn type="integer">3</cn>
    <ci>normal-∣</ci>
    <cn type="integer">12</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   3\mid 12
  </annotation>
 </semantics>
</math>

). From that and <a href="quadratic_reciprocity" title="wikilink">quadratic reciprocity</a> we can deduce that 

<math display="inline" id="XTR:214">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:215">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{2}
  </annotation>
 </semantics>
</math>

 exist.
</dd>
<dd>To check that 

<math display="inline" id="XTR:216">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>∣</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>p</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">p</csymbol>
    <plus></plus>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\mid p^{2}-p+1
  </annotation>
 </semantics>
</math>

 we consider again 

<math display="inline" id="XTR:217">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="XTR:218">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>i</mi>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>i</ci>
    </apply>
    <set>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{i}\in\{1,2\}
  </annotation>
 </semantics>
</math>

 and get that 

<math display="inline" id="XTR:219">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo>-</mo>
     <mi>p</mi>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msubsup>
       <mi>r</mi>
       <mi>i</mi>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>r</mi>
        <mi>i</mi>
       </msub>
       <mi>k</mi>
       <mi>q</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
       <msup>
        <mi>q</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>-</mo>
     <msub>
      <mi>r</mi>
      <mi>i</mi>
     </msub>
     <mo>-</mo>
     <mrow>
      <mi>k</mi>
      <mi>q</mi>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msubsup>
      <mi>r</mi>
      <mi>i</mi>
      <mn>2</mn>
     </msubsup>
     <mo>-</mo>
     <msub>
      <mi>r</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <mi>q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>r</mi>
         <mi>k</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>k</mi>
          <mn>2</mn>
         </msup>
         <mi>q</mi>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>r</mi>
        <mi>k</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>k</mi>
         <mn>2</mn>
        </msup>
        <mi>q</mi>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>k</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>p</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <ci>i</ci>
         </apply>
         <ci>k</ci>
         <ci>q</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>q</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <times></times>
        <ci>k</ci>
        <ci>q</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>q</ci>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>r</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>k</ci>
           <cn type="integer">2</cn>
          </apply>
          <ci>q</ci>
         </apply>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>q</ci>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>r</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>k</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>q</ci>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1=r_{i}^{2}+2r_{i}kq+k^{2}q^{2}-r_{i}-kq+1=r_{i}^{2}-r_{i}+1+q(2rk+k^{%
2}q-k)=q(2rk+k^{2}q-k)
  </annotation>
 </semantics>
</math>

, since 

<math display="inline" id="XTR:220">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:221">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{2}
  </annotation>
 </semantics>
</math>

 are roots of 

<math display="inline" id="XTR:222">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>X</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>X</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>X</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X^{2}-X+1
  </annotation>
 </semantics>
</math>

 and hence 

<math display="inline" id="XTR:223">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>∣</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>p</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">p</csymbol>
    <plus></plus>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\mid p^{2}-p+1
  </annotation>
 </semantics>
</math>

.
</dd>
</dl>
<h3 id="subgroup-selection">Subgroup selection</h3>

<p>In the last paragraph we have chosen the sizes 

<math display="inline" id="XTR:224">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:225">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 of the finite field 

<math display="inline" id="XTR:226">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 and the multiplicative subgroup of 

<math display="inline" id="XTR:227">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})^{*}
  </annotation>
 </semantics>
</math>

, now we have to find a subgroup 

<math display="inline" id="XTR:228">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="XTR:229">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mpadded width="+3.3pt">
    <mi>F</mi>
   </mpadded>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF\!\ (p^{6})^{*}
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="XTR:230">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\in GF(p^{6})
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="XTR:231">
 <semantics>
  <mrow>
   <mrow>
    <mo rspace="0pt">∣</mo>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>g</mi>
     <mo rspace="0pt" stretchy="false">⟩</mo>
    </mrow>
    <mo>∣</mo>
   </mrow>
   <mo>=</mo>
   <mi>q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-∣∣</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>g</ci>
     </apply>
    </apply>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mid\!\!\langle g\rangle\!\!\mid=q
  </annotation>
 </semantics>
</math>

.</p>

<p>However, we do not need to find an explicit 

<math display="inline" id="XTR:232">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\in GF(p^{6})
  </annotation>
 </semantics>
</math>

, it suffices to find an element 

<math display="inline" id="XTR:233">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>c</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="XTR:234">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=Tr(g)
  </annotation>
 </semantics>
</math>

 for an element 

<math display="inline" id="XTR:235">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\in GF(p^{6})
  </annotation>
 </semantics>
</math>

 of order 

<math display="inline" id="XTR:236">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

. But, given 

<math display="inline" id="XTR:237">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)
  </annotation>
 </semantics>
</math>

, a generator 

<math display="inline" id="XTR:238">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 of the XTR (sub)group can be found by determining any root of 

<math display="inline" id="XTR:239">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>g</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo rspace="7.5pt">,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>r</ci>
      <ci>g</ci>
     </apply>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(Tr(g),\ X)
  </annotation>
 </semantics>
</math>

 which has been defined <a href="XTR#Algorithm_for_quick_computation_of_Tr.28gn.29_given_Tr.28g.29" title="wikilink">above</a>. To find such a 

<math display="inline" id="XTR:240">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 we can take a look at property 5 of 

<math display="inline" id="XTR:241">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo rspace="7.5pt">,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,\ X)
  </annotation>
 </semantics>
</math>

 <a href="XTR#Algorithm_for_quick_computation_of_Tr.28gn.29_given_Tr.28g.29" title="wikilink">here</a> stating that the roots of 

<math display="inline" id="XTR:242">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo rspace="7.5pt">,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,\ X)
  </annotation>
 </semantics>
</math>

 have an order dividing 

<math display="inline" id="XTR:243">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

 if and only if 

<math display="inline" id="XTR:244">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo rspace="7.5pt">,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,\ X)
  </annotation>
 </semantics>
</math>

 is <a href="Irreducibility_(mathematics)" title="wikilink">irreducible</a>. After finding such 

<math display="inline" id="XTR:245">
 <semantics>
  <mi>c</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>c</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c
  </annotation>
 </semantics>
</math>

 we need to check if it really is of order 

<math display="inline" id="XTR:246">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

, but first we focus on how to select 

<math display="inline" id="XTR:247">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>c</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="XTR:248">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo rspace="7.5pt">,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,\ X)
  </annotation>
 </semantics>
</math>

 is irreducible.</p>

<p>An initial approach is to select 

<math display="inline" id="XTR:249">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∈</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>G</mi>
      <mi>F</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>p</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>\</mo>
     <mi>G</mi>
    </mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>c</ci>
    <apply>
     <times></times>
     <apply>
      <ci>normal-\</ci>
      <apply>
       <times></times>
       <ci>G</ci>
       <ci>F</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>G</ci>
     </apply>
     <ci>F</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\in GF(p^{2})\backslash GF(p)
  </annotation>
 </semantics>
</math>

 randomly which is justified by the next lemma.</p>

<p><strong>Lemma:</strong> <em>For a randomly selected 

<math display="inline" id="XTR:250">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>c</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 the probability that 

<math display="inline" id="XTR:251">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>c</mi>
     <mo rspace="7.5pt">,</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <msup>
       <mi>X</mi>
       <mn>3</mn>
      </msup>
      <mo>-</mo>
      <mrow>
       <mi>c</mi>
       <msup>
        <mi>X</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>c</mi>
       <mi>p</mi>
      </msup>
      <mi>X</mi>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>X</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>F</ci>
      <interval closure="open">
       <ci>c</ci>
       <ci>X</ci>
      </interval>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>X</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <times></times>
         <ci>c</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>X</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>c</ci>
         <ci>p</ci>
        </apply>
        <ci>X</ci>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>X</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,\ X)=X^{3}-cX^{2}+c^{p}X-1\in GF(p^{2})[X]
  </annotation>
 </semantics>
</math>

 is irreducible is about one third.</em></p>

<p>Now the basic algorithm to find a suitable 

<math display="inline" id="XTR:252">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)
  </annotation>
 </semantics>
</math>

 is as follows:</p>

<p><strong>Outline of the algorithm</strong></p>
<ol>
<li>Pick a random 

<math display="inline" id="XTR:253">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>∈</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>G</mi>
      <mi>F</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>p</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>\</mo>
     <mi>G</mi>
    </mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>c</ci>
    <apply>
     <times></times>
     <apply>
      <ci>normal-\</ci>
      <apply>
       <times></times>
       <ci>G</ci>
       <ci>F</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>G</ci>
     </apply>
     <ci>F</ci>
     <ci>p</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\in GF(p^{2})\backslash GF(p)
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="XTR:254">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>c</mi>
    <mo rspace="7.5pt">,</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <interval closure="open">
     <ci>c</ci>
     <ci>X</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(c,\ X)
  </annotation>
 </semantics>
</math>

 is reducible, then return to Step 1.</li>
<li>Use Algorithm 1 to compute 

<math display="inline" id="XTR:255">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <msub>
    <mi>c</mi>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>p</mi>
         <mn>2</mn>
        </msup>
        <mo>-</mo>
        <mi>p</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>/</mo>
     <mi>q</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>c</ci>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>p</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=c_{(p^{2}-p+1)/q}
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="XTR:256">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 is not of order 

<math display="inline" id="XTR:257">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

, return to Step 1.</li>
<li>Let 

<math display="inline" id="XTR:258">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>d</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>g</ci>
    </apply>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)=d
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p>It turns out that this algorithm indeed computes an element of 

<math display="inline" id="XTR:259">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 that equals 

<math display="inline" id="XTR:260">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>g</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="XTR:261">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>6</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>g</ci>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g\in GF(p^{6})
  </annotation>
 </semantics>
</math>

 of order 

<math display="inline" id="XTR:262">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

.</p>

<p>More details to the algorithm, its correctness, runtime and the proof of the Lemma can be found in <em>"An overview of the XTR public key system"</em> in.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="cryptographic-schemes">Cryptographic schemes</h2>

<p>In this section it is explained how the concepts above using traces of elements can be applied to cryptography. In general, XTR can be used in any cryptosystem that relies on the (subgroup) Discrete Logarithm problem. Two important applications of XTR are the <a href="Diffie-Hellman_key_agreement" title="wikilink">Diffie-Hellman key agreement</a> and the <a href="ElGamal_encryption" title="wikilink">ElGamal encryption</a>. We will start first with Diffie-Hellman.</p>
<h3 id="xtr-dh-key-agreement">XTR-DH key agreement</h3>

<p>We suppose that both <a href="Alice_and_Bob" title="wikilink">Alice and Bob</a> have access to the XTR <a href="public_key" title="wikilink">public key</a> data 

<math display="inline" id="XTR:263">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>p</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>p</ci>
    <ci>q</ci>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>g</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(p,q,Tr(g)\right)
  </annotation>
 </semantics>
</math>

 and intend to agree on a <a href="shared_secret" title="wikilink">shared secret</a> <a href="secret_key" title="wikilink">key</a> 

<math display="inline" id="XTR:264">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

. They can do this by using the following XTR version of the Diffie-Hellman key exchange:</p>
<ol>
<li>Alice picks 

<math display="inline" id="XTR:265">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>∈</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>a</ci>
    <ci>ℤ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

 randomly with 

<math display="inline" id="XTR:266">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>a</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{a})\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 and sends 

<math display="inline" id="XTR:267">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>a</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{a})
  </annotation>
 </semantics>
</math>

 to Bob.</li>
<li>Bob receives 

<math display="inline" id="XTR:268">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>∈</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>b</ci>
    <ci>ℤ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

 from Alice, selects at random 

<math display="inline" id="XTR:269">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>b</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>b</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{b})\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="XTR:270">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>b</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{b})
  </annotation>
 </semantics>
</math>

 and sends 

<math display="inline" id="XTR:271">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>a</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>T</mi>
      <mi>r</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>g</mi>
        <mi>b</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>a</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>b</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>a</mi>
        <mi>b</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>a</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>b</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
     <vector>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <ci>a</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>b</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>b</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <apply>
          <plus></plus>
          <ci>a</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>b</ci>
        </apply>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{a}(Tr(g^{b}))=\left(Tr(g^{(a-1)b}),Tr(g^{ab}),Tr(g^{(a+1)b})\right)\in GF(p%
^{2})^{3}
  </annotation>
 </semantics>
</math>

 to Alice.</li>
<li>Alice receives 

<math display="inline" id="XTR:272">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 from Bob, computes with Algorithm 1 

<math display="inline" id="XTR:273">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{ab})\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 and determines 

<math display="inline" id="XTR:274">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>b</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>T</mi>
      <mi>r</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>g</mi>
        <mi>a</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>a</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>b</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>a</mi>
        <mi>b</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>a</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>b</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>b</ci>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
      </apply>
     </apply>
     <vector>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <apply>
          <minus></minus>
          <ci>b</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <ci>b</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>a</ci>
         <apply>
          <plus></plus>
          <ci>b</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{b}(Tr(g^{a}))=\left(Tr(g^{a(b-1)}),Tr(g^{ab}),Tr(g^{a(b+1)})\right)\in GF(p%
^{2})^{3}
  </annotation>
 </semantics>
</math>

 based on 

<math display="inline" id="XTR:275">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

.</li>
<li>Bob analogously applies Algorithm 1 to compute 

<math display="inline" id="XTR:276">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>a</mi>
       <mi>b</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{ab})\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 and also determines 

<math display="inline" id="XTR:277">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>p</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>p</ci>
    <ci>q</ci>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>g</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p,q,Tr(g))
  </annotation>
 </semantics>
</math>

 based on 

<math display="inline" id="XTR:278">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<h3 id="xtr-elgamal-encryption">XTR ElGamal encryption</h3>

<p>For the ElGamal encryption we suppose now that Alice is the owner of the XTR public key data 

<math display="inline" id="XTR:279">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>k</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{k})
  </annotation>
 </semantics>
</math>

 and that she has selected a secret <a class="uri" href="integer" title="wikilink">integer</a> 

<math display="inline" id="XTR:280">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mi>p</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>p</ci>
    <ci>q</ci>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(p,q,Tr(g),Tr(g^{k})\right)
  </annotation>
 </semantics>
</math>

, computed 

<math display="inline" id="XTR:281">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 and published the result. Given Alice's XTR public key data 

<math display="inline" id="XTR:282">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>∈</mo>
   <mi>ℤ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>b</ci>
    <ci>ℤ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b\in\mathbb{Z}
  </annotation>
 </semantics>
</math>

, Bob can encrypt a message 

<math display="inline" id="XTR:283">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>b</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>T</mi>
      <mi>r</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>g</mi>
        <mi>k</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>b</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>k</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>b</mi>
        <mi>k</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>b</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>k</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>b</ci>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <vector>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <ci>b</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>b</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <apply>
          <plus></plus>
          <ci>b</ci>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{b}(Tr(g^{k}))=\left(Tr(g^{(b-1)k}),Tr(g^{bk}),Tr(g^{(b+1)k})\right)\in GF(p%
^{2})^{3}
  </annotation>
 </semantics>
</math>

, intended for Alice, using the following XTR version of the ElGamal encryption:</p>
<ol>
<li>Bob selects randomly a 

<math display="inline" id="XTR:284">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="XTR:285">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>b</mi>
       <mi>k</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{bk})\in GF(p^{2})
  </annotation>
 </semantics>
</math>

.</li>
<li>Bob next applies Algorithm 1 to compute 

<math display="inline" id="XTR:286">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

.</li>
<li>Bob determines a symmetric encryption key 

<math display="inline" id="XTR:287">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 based on 

<math display="inline" id="XTR:288">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

.</li>
<li>Bob uses an agreed upon symmetric encryption method with key 

<math display="inline" id="XTR:289">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>b</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">,</mo>
   <mi>E</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>b</ci>
     </apply>
    </apply>
    <ci>E</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Tr(g^{b}),\ E)
  </annotation>
 </semantics>
</math>

 to encrypt his message 

<math display="inline" id="XTR:290">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>b</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo rspace="7.5pt">,</mo>
   <mi>E</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>b</ci>
     </apply>
    </apply>
    <ci>E</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Tr(g^{b}),\ E)
  </annotation>
 </semantics>
</math>

, resulting in the encryption 

<math display="inline" id="XTR:291">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>T</mi>
      <mi>r</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>g</mi>
        <mi>b</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>b</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>b</mi>
        <mi>k</mi>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>T</mi>
     <mi>r</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>g</mi>
       <mrow>
        <mi>b</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>3</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
     <vector>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>b</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>b</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>T</ci>
       <ci>r</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <ci>b</ci>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{k}(Tr(g^{b}))=\left(Tr(g^{b(k-1)}),Tr(g^{bk}),Tr(g^{b(k+1)})\right)\in GF(p%
^{2})^{3}
  </annotation>
 </semantics>
</math>

.</li>
<li>Bob sends 

<math display="inline" id="XTR:292">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 to Alice.</li>
</ol>

<p>Upon receipt of 

<math display="inline" id="XTR:293">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mrow>
       <mi>b</mi>
       <mi>k</mi>
      </mrow>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <ci>b</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>F</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{bk})\in GF(p^{2})
  </annotation>
 </semantics>
</math>

, Alice decrypts the message in the following way:</p>
<ol>
<li>Alice computes 

<math display="inline" id="XTR:294">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

.</li>
<li>Alice determines the symmetric key 

<math display="inline" id="XTR:295">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 based on 

<math display="inline" id="XTR:296">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

.</li>
<li>Alice uses the agreed upon symmetric encryption method with key 

<math display="inline" id="XTR:297">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 to decrypt 

<math display="inline" id="XTR:298">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

, resulting in the original message 

<math display="inline" id="XTR:299">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo rspace="7.5pt" stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>∀</mo>
     <mi>p</mi>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>p</mi>
       <mn>6</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>*</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <in></in>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>r</ci>
      <ci>g</ci>
     </apply>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>p</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">6</cn>
       </apply>
       <times></times>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g)\in GF(p^{2})\ \forall p\in GF(p^{6})^{*}
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p>The here described encryption scheme is based on a common <a href="hybrid_cryptosystem" title="wikilink">hybrid</a> version of the ElGamal encryption, where the secret key 

<math display="inline" id="XTR:300">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

 is obtained by an <a href="asymmetric_key" title="wikilink">asymmetric public key</a> system and then the message is encrypted with a <a href="symmetric_key" title="wikilink">symmetric key</a> encryption method Alice and Bob agreed to.</p>

<p>In the more traditional ElGamal encryption the message is restricted to the key space, which would here be 

<math display="inline" id="XTR:301">
 <semantics>
  <msup>
   <mpadded width="+3.3pt">
    <mi>M</mi>
   </mpadded>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>M</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\!\ ^{\prime}
  </annotation>
 </semantics>
</math>

, because 

<math display="inline" id="XTR:302">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

. The encryption in this case is the multiplication of the message with the key, which is an invertible operation in the key space 

<math display="inline" id="XTR:303">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

.</p>

<p>Concretely this means if Bob wants to encrypt a message 

<math display="inline" id="XTR:304">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

, first he has to convert it into an element 

<math display="inline" id="XTR:305">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mi>K</mi>
    <mo>⋅</mo>
    <mi>M</mi>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mn>2</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>E</ci>
     <apply>
      <ci>normal-⋅</ci>
      <ci>K</ci>
      <ci>M</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=K\cdot M\in GF(p^{2})
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="XTR:306">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>

 and then compute the encrypted message 

<math display="inline" id="XTR:307">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 as 

<math display="inline" id="XTR:308">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>=</mo>
   <mrow>
    <mi>E</mi>
    <mo>⋅</mo>
    <msup>
     <mi>K</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>M</ci>
    <apply>
     <ci>normal-⋅</ci>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>K</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M=E\cdot K^{-1}
  </annotation>
 </semantics>
</math>

. Upon receipt of the encrypted message 

<math display="inline" id="XTR:309">
 <semantics>
  <msup>
   <mi>K</mi>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>K</ci>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K^{-1}
  </annotation>
 </semantics>
</math>

 Alice can recover the original message 

<math display="inline" id="XTR:310">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 by computing 

<math display="inline" id="XTR:311">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="XTR:312">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>p</mi>
     <mi>t</mi>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF\left(p^{t}\right)
  </annotation>
 </semantics>
</math>

 is the inverse of 

<math display="inline" id="XTR:313">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 in 

<math display="inline" id="XTR:314">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="security">Security</h2>

<p>In order to say something about the security properties of the <a href="XTR#Cryptographic_schemes" title="wikilink">above</a> explained XTR encryption scheme, first it is important to check the security of the XTR group, which means how hard it is to solve the <a href="discrete_logarithm" title="wikilink">Discrete Logarithm problem</a> there. The next part will then state the equivalency between the Discrete Logarithm problem in the XTR group and the XTR version of the discrete logarithm problem, using only the traces of elements.</p>
<h3 id="discrete-logarithms-in-a-general-gfleftptright">Discrete logarithms in a general 

<math display="inline" id="XTR:315">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

</h3>

<p>Let now 

<math display="inline" id="XTR:316">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>γ</mi>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
    </msup>
    <mtext>given</mtext>
    <mi>γ</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>γ</mi>
     <mi>x</mi>
    </msup>
    <mtext>and</mtext>
    <msup>
     <mi>γ</mi>
     <mi>y</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>γ</ci>
      <apply>
       <times></times>
       <ci>x</ci>
       <ci>y</ci>
      </apply>
     </apply>
     <mtext>given</mtext>
     <ci>γ</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>γ</ci>
      <ci>x</ci>
     </apply>
     <mtext>and</mtext>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>γ</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma^{xy}\text{ given }\gamma,\gamma^{x}\text{ and }\gamma^{y}
  </annotation>
 </semantics>
</math>

 be a multiplicative group of order 

<math display="inline" id="XTR:317">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>γ</mi>
      <mi>x</mi>
     </msup>
     <mo rspace="7.5pt">,</mo>
     <msup>
      <mi>γ</mi>
      <mi>y</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>γ</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>H</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>γ</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>γ</ci>
       <ci>y</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>γ</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   DH(\gamma^{x},\ \gamma^{y})=\gamma^{xy}
  </annotation>
 </semantics>
</math>

. The security of the <a href="Diffie-Hellman" title="wikilink">Diffie-Hellman protocol</a> in 

<math display="inline" id="XTR:318">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>a</mi>
     <mo>,</mo>
     <mi>b</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>c</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>H</ci>
     <interval closure="open">
      <ci>a</ci>
      <ci>b</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c=DH(a,b)
  </annotation>
 </semantics>
</math>

 relies on the <a href="Diffie-Hellman_problem" title="wikilink"><em>Diffie-Hellman</em> (DH) problem</a> of computing 

<math display="inline" id="XTR:319">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo>,</mo>
    <mi>c</mi>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>γ</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>a</ci>
     <ci>b</ci>
     <ci>c</ci>
    </list>
    <apply>
     <csymbol cd="latexml">delimited-⟨⟩</csymbol>
     <ci>γ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,b,c\in\langle\gamma\rangle
  </annotation>
 </semantics>
</math>

. We write 

<math display="inline" id="XTR:320">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>a</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>L</ci>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=DL(a)
  </annotation>
 </semantics>
</math>

. There are two other problems related to the DH problem. The first one is the <a href="Decisional_Diffie–Hellman_assumption" title="wikilink"><em>Diffie-Hellman Decision</em> (DHD) problem</a> to determine if 

<math display="inline" id="XTR:321">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>=</mo>
   <msup>
    <mi>γ</mi>
    <mi>x</mi>
   </msup>
   <mo>∈</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">⟨</mo>
     <mi>γ</mi>
     <mo stretchy="false">⟩</mo>
    </mrow>
    <mtext>with</mtext>
    <mn>0</mn>
   </mrow>
   <mo>≤</mo>
   <mi>x</mi>
   <mo><</mo>
   <mi>ω</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>a</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>γ</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-⟨⟩</csymbol>
       <ci>γ</ci>
      </apply>
      <mtext>with</mtext>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <ci>x</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <ci>ω</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a=\gamma^{x}\in\langle\gamma\rangle\text{ with }0\leq x<\omega
  </annotation>
 </semantics>
</math>

 for given 

<math display="inline" id="XTR:322">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 and the second one is the <a href="discrete_logarithm_problem" title="wikilink"><em>Discrete Logarithm</em> (DL) problem</a> to find 

<math display="inline" id="XTR:323">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 for a given 

<math display="inline" id="XTR:324">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

.</p>

<p>The DL problem is at least as difficult as the DH problem and it is generally assumed that if the DL problem in 

<math display="inline" id="XTR:325">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 is intractable, then so are the other two.</p>

<p>Given the <a href="prime_factorization" title="wikilink">prime factorization</a> of 

<math display="inline" id="XTR:326">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 the DL problem in 

<math display="inline" id="XTR:327">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 can be reduced to the DL problem in all subgroups of 

<math display="inline" id="XTR:328">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

 with prime order due to the <a href="Pohlig-Hellman_algorithm" title="wikilink">Pohlig-Hellman algorithm</a>. Hence 

<math display="inline" id="XTR:329">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <msup>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>p</mi>
      <mi>t</mi>
     </msup>
     <mo>)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <ci>t</ci>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF\left(p^{t}\right)^{*}
  </annotation>
 </semantics>
</math>

 can safely be assumed to be prime.</p>

<p>For a subgroup 

<math display="inline" id="XTR:330">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mi>t</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{t})
  </annotation>
 </semantics>
</math>

 of prime order 

<math display="inline" id="XTR:331">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p)
  </annotation>
 </semantics>
</math>

 of the multiplicative group 

<math display="inline" id="XTR:332">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 of an extension field 

<math display="inline" id="XTR:333">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒪</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msqrt>
     <mi>ω</mi>
    </msqrt>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝒪</ci>
    <apply>
     <root></root>
     <ci>ω</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(\sqrt{\omega})
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="XTR:334">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="XTR:335">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

, there are now two possible ways to attack the system. One can either focus on the whole multiplicative group or on the subgroup. To attack the multiplicative group the best known method is the Discrete Logarithm variant of the <a href="Number_Field_Sieve" title="wikilink">Number Field Sieve</a> or alternatively in the subgroup one can use one of several methods that take 

<math display="inline" id="XTR:336">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 operations in 

<math display="inline" id="XTR:337">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

, such as <a href="Pollard's_rho_algorithm" title="wikilink">Pollard's rho method</a>.</p>

<p>For both approaches the difficulty of the DL problem in 

<math display="inline" id="XTR:338">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>p</mi>
     <mi>t</mi>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF\left(p^{t}\right)
  </annotation>
 </semantics>
</math>

 depends on the size of the minimal surrounding subfield of 

<math display="inline" id="XTR:339">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 and on the size of its prime order 

<math display="inline" id="XTR:340">
 <semantics>
  <mi>ω</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ω</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega
  </annotation>
 </semantics>
</math>

. If 

<math display="inline" id="XTR:341">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>γ</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>γ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle\gamma\rangle
  </annotation>
 </semantics>
</math>

 itself is the minimal surrounding subfield of 

<math display="inline" id="XTR:342">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>p</mi>
     <mi>t</mi>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF\left(p^{t}\right)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:343">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is sufficiently large, then the DL problem in 

<math display="inline" id="XTR:344">
 <semantics>
  <mi>q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q
  </annotation>
 </semantics>
</math>

 is as hard as the general DL problem in 

<math display="inline" id="XTR:345">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

.</p>

<p>The XTR parameters are now chosen in such a way that 

<math display="inline" id="XTR:346">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 is not small, 

<math display="inline" id="XTR:347">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>∣</mo>
   <msup>
    <mi>p</mi>
    <mn>2</mn>
   </msup>
   <mo>-</mo>
   <mi>p</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">q</csymbol>
    <ci>normal-∣</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
    <minus></minus>
    <csymbol cd="unknown">p</csymbol>
    <plus></plus>
    <cn type="integer">1</cn>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\mid p^{2}-p+1
  </annotation>
 </semantics>
</math>

 is sufficiently large and 

<math display="inline" id="XTR:348">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo>-</mo>
    <mi>p</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>p</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{2}-p+1
  </annotation>
 </semantics>
</math>

 cannot be embedded in a true subfield of 

<math display="inline" id="XTR:349">
 <semantics>
  <mrow>
   <mrow>
    <mo rspace="0.8pt">∣</mo>
    <mrow>
     <mi>G</mi>
     <mi>F</mi>
     <mpadded width="-1.7pt">
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msup>
         <mi>p</mi>
         <mn>6</mn>
        </msup>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>*</mo>
      </msup>
     </mpadded>
    </mrow>
    <mo>∣</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-∣∣</csymbol>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>F</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>p</ci>
        <cn type="integer">6</cn>
       </apply>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <cn type="integer">6</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mid\!GF(p^{6})^{*}\!\mid=p^{6}-1
  </annotation>
 </semantics>
</math>

, since 

<math display="inline" id="XTR:350">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>p</mi>
     <mi>s</mi>
    </msup>
    <mo>-</mo>
    <mrow>
     <mn>1</mn>
     <mtext>for</mtext>
     <mi>s</mi>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mn>3</mn>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <ci>s</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">1</cn>
      <mtext>for</mtext>
      <ci>s</ci>
     </apply>
    </apply>
    <set>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <cn type="integer">3</cn>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{s}-1\text{ for }s\in\{1,2,3\}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:351">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

 is a divisor of 

<math display="inline" id="XTR:352">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mpadded width="+3.3pt">
    <mi>F</mi>
   </mpadded>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>p</mi>
      <mi>s</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>p</ci>
      <ci>s</ci>
     </apply>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF\!\ (p^{s})^{*}
  </annotation>
 </semantics>
</math>

, but it does not divide 

<math display="inline" id="XTR:353">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>∈</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mn>3</mn>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>s</ci>
    <set>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <cn type="integer">3</cn>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\in\{1,2,3\}
  </annotation>
 </semantics>
</math>

 and thus 

<math display="inline" id="XTR:354">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

 cannot be a subgroup of 

<math display="inline" id="XTR:355">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{xy})
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="XTR:356">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>x</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{x})
  </annotation>
 </semantics>
</math>

. It follows that the DL problem in the XTR group may be assumed as hard as the DL problem in 

<math display="inline" id="XTR:357">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>g</mi>
     <mi>y</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>r</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Tr(g^{y})
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="security-of-xtr">Security of XTR</h3>

<p>Cryptographic protocols that are based on Discrete Logarithms can use many different types of subgroups like groups of points of <a href="elliptic_curves" title="wikilink">elliptic curves</a> or subgroups of the multiplicative group of a finite field like the XTR group. As we have seen above the XTR versions of the Diffie-Hellman and ElGamal encryption protocol replace using elements of the XTR group by using their traces. This means that the security of the XTR versions of these encryption schemes is no longer based on the original DH, DHD or DL problems. Therefore the XTR versions of those problems need to be defined and we will see that they are equivalent (in the sense of the next definition) to the original problems.</p>

<p><strong>Definitions:</strong></p>
<ul>
<li><em>We define the <strong>XTR-DH</strong> problem as the problem of computing 

<math display="inline" id="XTR:358">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mi>D</mi>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>g</mi>
      <mi>x</mi>
     </msup>
     <mo rspace="7.5pt">,</mo>
     <msup>
      <mi>g</mi>
      <mi>y</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mi>g</mi>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>D</ci>
     <ci>H</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>y</ci>
      </apply>
     </interval>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   XDH(g^{x},\ g^{y})=g^{xy}
  </annotation>
 </semantics>
</math>

 given 

<math display="inline" id="XTR:359">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mi>D</mi>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>a</mi>
     <mo>,</mo>
     <mi>b</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>c</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>D</ci>
     <ci>H</ci>
     <interval closure="open">
      <ci>a</ci>
      <ci>b</ci>
     </interval>
    </apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   XDH(a,b)=c
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="XTR:360">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo>,</mo>
    <mi>c</mi>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>g</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>a</ci>
     <ci>b</ci>
     <ci>c</ci>
    </list>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,b,c\in Tr(\langle g\rangle)
  </annotation>
 </semantics>
</math>

 and we write 

<math display="inline" id="XTR:361">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>∈</mo>
   <mrow>
    <mi>T</mi>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo stretchy="false">⟨</mo>
      <mi>g</mi>
      <mo stretchy="false">⟩</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>a</ci>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>r</ci>
     <apply>
      <csymbol cd="latexml">delimited-⟨⟩</csymbol>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\in Tr(\langle g\rangle)
  </annotation>
 </semantics>
</math>

.</em></li>
<li><em>The <strong>XTR-DHD</strong> problem is the problem of determining whether 

<math display="inline" id="XTR:362">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>X</mi>
    <mi>D</mi>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>a</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>X</ci>
     <ci>D</ci>
     <ci>L</ci>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=XDL(a)
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="XTR:363">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

.</em></li>
<li><em>Given 

<math display="inline" id="XTR:364">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℬ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℬ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{B}
  </annotation>
 </semantics>
</math>

, the <strong>XTR-DL</strong> problem is to find 

<math display="inline" id="XTR:365">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

, i.e. 

<math display="inline" id="XTR:366">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℬ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℬ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{B}
  </annotation>
 </semantics>
</math>

.</em></li>
<li>'' We say that problem 

<math display="inline" id="XTR:367">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ℬ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ℬ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{B}
  </annotation>
 </semantics>
</math>

 is (a,b)-equivalent to problem 

<math display="inline" id="XTR:368">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒜</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒜</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{A}
  </annotation>
 </semantics>
</math>

, if any instance of problem 

<math display="inline" id="XTR:369">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

 (or 

<math display="inline" id="XTR:370">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

) can be solved by at most a (or b) calls to an algorithm solving problem 

<math display="inline" id="XTR:371">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

 (or 

<math display="inline" id="XTR:372">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{2})
  </annotation>
 </semantics>
</math>

).''</li>
</ul>

<p>After introducing the XTR versions of these problems the next theorem is an important result telling us the connection between the XTR and the non-XTR problems, which are in fact equivalent. This implies that the XTR representation of elements with their traces is, as can be seen above, faster by a factor of 3 than the usual representation without compromising security.</p>

<p><strong>Theorem</strong> <em>The following equivalencies hold:</em></p>
<dl>
<dd><em>i. The <strong>XTR-DL</strong> problem is (1,1)-equivalent to the <strong>DL</strong> problem in 

<math display="inline" id="XTR:373">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mi>F</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>p</mi>
     <mn>6</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>F</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <cn type="integer">6</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   GF(p^{6})
  </annotation>
 </semantics>
</math>

.</em>
</dd>
<dd><em>ii. The <strong>XTR-DH</strong> problem is (1,2)-equivalent to the <strong>DH</strong> problem in 

<math display="inline" id="XTR:374">
 <semantics>
  <mrow>
   <mo stretchy="false">⟨</mo>
   <mi>g</mi>
   <mo stretchy="false">⟩</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-⟨⟩</csymbol>
    <ci>g</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle g\rangle
  </annotation>
 </semantics>
</math>

.</em>
</dd>
<dd><em>iii. The <strong>XTR-DHD</strong> problem is (3,2)-equivalent to the <strong>DHD</strong> problem in <span class="LaTeX">$\langle g\rangle$</span>.</em>
</dd>
</dl>

<p>This means that an algorithm solving either XTR-DL, XTR-DH or XTR-DHD with non-negligible probability can be transformed into an algorithm solving the corresponding non-XTR problem DL, DH or DHD with non-negligible probability and vice versa. In particular part <em>ii.</em> implies that determining the small XTR-DH key (being an element of <span class="LaTeX">$GF(p^2)$</span>) is as hard as determining the whole DH key (being an element of <span class="LaTeX">$GF(p^6)$</span> ) in the representation group <span class="LaTeX">$\langle g \rangle$</span>.</p>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Asymmetric-key_algorithms" title="wikilink">Category:Asymmetric-key algorithms</a> <a href="Category:Finite_fields" title="wikilink">Category:Finite fields</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"></li>
</ol>
</section>
</body>
</html>

   Bilinear transform      Bilinear transform   The bilinear transform (also known as Tustin 's method ) is used in digital signal processing and discrete-time control theory to transform continuous-time system representations to discrete-time and vice versa.  The bilinear transform is a special case of a conformal mapping (namely, the Möbius transformation ), often used to convert a transfer function      H  a    (  s  )        subscript  H  a   s    H_{a}(s)   of a linear , time-invariant ( LTI ) filter in the continuous -time domain (often called an analog filter ) to a transfer function     H  d    (  z  )        subscript  H  d   z    H_{d}(z)   of a linear, shift-invariant filter in the discrete -time domain (often called a digital filter although there are analog filters constructed with switched capacitors that are discrete-time filters). It maps positions on the    j  ω      j  ω    j\omega   axis,     R  e   [  s  ]    =  0        R  e   delimited-[]  s    0    Re[s]=0   , in the s-plane to the unit circle ,     |  z  |   =  1        z   1    |z|=1   , in the z-plane . Other bilinear transforms can be used to warp the frequency response of any discrete-time linear system (for example to approximate the non-linear frequency resolution of the human auditory system) and are implementable in the discrete domain by replacing a system's unit delays    (   z   -  1    )     superscript  z    1     \left(z^{-1}\right)   with first order all-pass filters .  The transform preserves stability and maps every point of the frequency response of the continuous-time filter,     H  a    (   j   ω  a    )        subscript  H  a     j   subscript  ω  a      H_{a}(j\omega_{a})   to a corresponding point in the frequency response of the discrete-time filter,     H  d    (   e   j   ω  d   T    )        subscript  H  d    superscript  e    j   subscript  ω  d   T      H_{d}(e^{j\omega_{d}T})   although to a somewhat different frequency, as shown in the Frequency warping section below. This means that for every feature that one sees in the frequency response of the analog filter, there is a corresponding feature, with identical gain and phase shift, in the frequency response of the digital filter but, perhaps, at a somewhat different frequency. This is barely noticeable at low frequencies but is quite evident at frequencies close to the Nyquist frequency .  Discrete-time approximation  The bilinear transform is a first-order approximation of the natural logarithm function that is an exact mapping of the z -plane to the s -plane. When the Laplace transform is performed on a discrete-time signal (with each element of the discrete-time sequence attached to a correspondingly delayed unit impulse ), the result is precisely the Z transform of the discrete-time sequence with the substitution of     z   z   \displaystyle z     where   T   T   T   is the numerical integration step size of the trapezoidal rule used in the bilinear transform derivation; 1 or, in other words, the sampling period. The above bilinear approximation can be solved for   s   s   s   or a similar approximation for    s  =    (   1  /  T   )    ln   (  z  )         s      1  T     z      s=(1/T)\ln(z)\   can be performed.  The inverse of this mapping (and its first-order bilinear approximation) is     s   s   \displaystyle s     The bilinear transform essentially uses this first order approximation and substitutes into the continuous-time transfer function,     H  a    (  s  )        subscript  H  a   s    H_{a}(s)          s  ←    2  T     z  -  1    z  +  1      .     normal-←  s      2  T       z  1     z  1       s\leftarrow\frac{2}{T}\frac{z-1}{z+1}.     That is         H  d    (  z  )    =      H  a    (  s  )    |    s  =    2  T     z  -  1    z  +  1       =    H  a    (    2  T     z  -  1    z  +  1     )     .           subscript  H  d   z    evaluated-at     subscript  H  a   s     s      2  T       z  1     z  1               subscript  H  a       2  T       z  1     z  1         H_{d}(z)=H_{a}(s)\bigg|_{s=\frac{2}{T}\frac{z-1}{z+1}}=H_{a}\left(\frac{2}{T}%
 \frac{z-1}{z+1}\right).     Stability and minimum-phase property preserved  A continuous-time causal filter is stable if the poles of its transfer function fall in the left half of the complex  s-plane . A discrete-time causal filter is stable if the poles of its transfer function fall inside the unit circle in the complex z-plane . The bilinear transform maps the left half of the complex s-plane to the interior of the unit circle in the z-plane. Thus filters designed in the continuous-time domain that are stable are converted to filters in the discrete-time domain that preserve that stability.  Likewise, a continuous-time filter is minimum-phase if the zeros of its transfer function fall in the left half of the complex s-plane. A discrete-time filter is minimum-phase if the zeros of its transfer function fall inside the unit circle in the complex z-plane. Then the same mapping property assures that continuous-time filters that are minimum-phase are converted to discrete-time filters that preserve that property of being minimum-phase.  Example  As an example take a simple low-pass  RC filter . This continuous-time filter has a transfer function       H  a    (  s  )        subscript  H  a   s    \displaystyle H_{a}(s)     If we wish to implement this filter as a digital filter, we can apply the bilinear transform by substituting for   s   s   s   the formula above; after some reworking, we get the following filter representation:             H  d    (  z  )        subscript  H  d   z    H_{d}(z)           =    H  a    (    2  T     z  -  1    z  +  1     )        absent     subscript  H  a       2  T       z  1     z  1        =H_{a}\left(\frac{2}{T}\frac{z-1}{z+1}\right)              =   1   1  +   R  C   (    2  T     z  -  1    z  +  1     )          absent    1    1    R  C      2  T       z  1     z  1          =\frac{1}{1+RC\left(\frac{2}{T}\frac{z-1}{z+1}\right)}              =    1  +  z     (   1  -    2  R  C   /  T    )   +    (   1  +    2  R  C   /  T    )   z         absent      1  z       1      2  R  C   T        1      2  R  C   T    z       =\frac{1+z}{(1-2RC/T)+(1+2RC/T)z}               =    1  +   z   -  1       (   1  +    2  R  C   /  T    )   +    (   1  -    2  R  C   /  T    )    z   -  1        .      absent      1   superscript  z    1         1      2  R  C   T        1      2  R  C   T     superscript  z    1         =\frac{1+z^{-1}}{(1+2RC/T)+(1-2RC/T)z^{-1}}.          The coefficients of the denominator are the 'feed-backward' coefficients and the coefficients of the numerator are the 'feed-forward' coefficients used to implement a real-time digital filter .  General second-order biquad transformation  It is possible to relate the coefficients of a continuous-time, analog filter with those of a similar discrete-time digital filter created through the bilinear transform process. Transforming a general, second-order continuous-time filter with the given transfer function        H  a    (  s  )    =      b  0    s  2    +    b  1   s   +   b  2       a  0    s  2    +    a  1   s   +   a  2     =     b  0   +    b  1    s   -  1     +    b  2    s   -  2        a  0   +    a  1    s   -  1     +    a  2    s   -  2                subscript  H  a   s          subscript  b  0    superscript  s  2       subscript  b  1   s    subscript  b  2         subscript  a  0    superscript  s  2       subscript  a  1   s    subscript  a  2               subscript  b  0      subscript  b  1    superscript  s    1        subscript  b  2    superscript  s    2         subscript  a  0      subscript  a  1    superscript  s    1        subscript  a  2    superscript  s    2          H_{a}(s)=\frac{b_{0}s^{2}+b_{1}s+b_{2}}{a_{0}s^{2}+a_{1}s+a_{2}}=\frac{b_{0}+b%
 _{1}s^{-1}+b_{2}s^{-2}}{a_{0}+a_{1}s^{-1}+a_{2}s^{-2}}     using the bilinear transform (without prewarping any frequency specification) requires the substitution of      s  ←   K    1  -   z   -  1      1  +   z   -  1          normal-←  s    K      1   superscript  z    1       1   superscript  z    1         s\leftarrow K\frac{1-z^{-1}}{1+z^{-1}}     where    K  ≜   2  T      normal-≜  K    2  T     K\triangleq\frac{2}{T}   .  This results in a discrete-time digital biquad filter with coefficients expressed in terms of the coefficients of the original continuous time filter:        H  d    (  z  )    =     (     b  0    K  2    +    b  1   K   +   b  2    )   +    (    2   b  2    -   2   b  0    K  2     )    z   -  1     +    (      b  0    K  2    -    b  1   K    +   b  2    )    z   -  2        (     a  0    K  2    +    a  1   K   +   a  2    )   +    (    2   a  2    -   2   a  0    K  2     )    z   -  1     +    (      a  0    K  2    -    a  1   K    +   a  2    )    z   -  2              subscript  H  d   z            subscript  b  0    superscript  K  2       subscript  b  1   K    subscript  b  2          2   subscript  b  2      2   subscript  b  0    superscript  K  2      superscript  z    1              subscript  b  0    superscript  K  2       subscript  b  1   K     subscript  b  2     superscript  z    2             subscript  a  0    superscript  K  2       subscript  a  1   K    subscript  a  2          2   subscript  a  2      2   subscript  a  0    superscript  K  2      superscript  z    1              subscript  a  0    superscript  K  2       subscript  a  1   K     subscript  a  2     superscript  z    2         H_{d}(z)=\frac{(b_{0}K^{2}+b_{1}K+b_{2})+(2b_{2}-2b_{0}K^{2})z^{-1}+(b_{0}K^{2%
 }-b_{1}K+b_{2})z^{-2}}{(a_{0}K^{2}+a_{1}K+a_{2})+(2a_{2}-2a_{0}K^{2})z^{-1}+(a%
 _{0}K^{2}-a_{1}K+a_{2})z^{-2}}     Normally the constant term in the denominator must be normalized to 1 before deriving the corresponding difference equation . This results in         H  d    (  z  )    =        b  0    K  2    +    b  1   K   +   b  2       a  0    K  2    +    a  1   K   +   a  2     +      2   b  2    -   2   b  0    K  2        a  0    K  2    +    a  1   K   +   a  2      z   -  1     +        b  0    K  2    -    b  1   K    +   b  2       a  0    K  2    +    a  1   K   +   a  2      z   -  2       1  +      2   a  2    -   2   a  0    K  2        a  0    K  2    +    a  1   K   +   a  2      z   -  1     +        a  0    K  2    -    a  1   K    +   a  2       a  0    K  2    +    a  1   K   +   a  2      z   -  2        .         subscript  H  d   z              subscript  b  0    superscript  K  2       subscript  b  1   K    subscript  b  2         subscript  a  0    superscript  K  2       subscript  a  1   K    subscript  a  2             2   subscript  b  2      2   subscript  b  0    superscript  K  2          subscript  a  0    superscript  K  2       subscript  a  1   K    subscript  a  2      superscript  z    1                subscript  b  0    superscript  K  2       subscript  b  1   K     subscript  b  2         subscript  a  0    superscript  K  2       subscript  a  1   K    subscript  a  2      superscript  z    2        1          2   subscript  a  2      2   subscript  a  0    superscript  K  2          subscript  a  0    superscript  K  2       subscript  a  1   K    subscript  a  2      superscript  z    1                subscript  a  0    superscript  K  2       subscript  a  1   K     subscript  a  2         subscript  a  0    superscript  K  2       subscript  a  1   K    subscript  a  2      superscript  z    2         H_{d}(z)=\frac{\frac{b_{0}K^{2}+b_{1}K+b_{2}}{a_{0}K^{2}+a_{1}K+a_{2}}+\frac{2%
 b_{2}-2b_{0}K^{2}}{a_{0}K^{2}+a_{1}K+a_{2}}z^{-1}+\frac{b_{0}K^{2}-b_{1}K+b_{2%
 }}{a_{0}K^{2}+a_{1}K+a_{2}}z^{-2}}{1+\frac{2a_{2}-2a_{0}K^{2}}{a_{0}K^{2}+a_{1%
 }K+a_{2}}z^{-1}+\frac{a_{0}K^{2}-a_{1}K+a_{2}}{a_{0}K^{2}+a_{1}K+a_{2}}z^{-2}}.     The difference equation (using the Direct Form I ) is       y   [  n  ]    =         y   delimited-[]  n    absent    \displaystyle y[n]=     Frequency warping  To determine the frequency response of a continuous-time filter, the transfer function      H  a    (  s  )        subscript  H  a   s    H_{a}(s)   is evaluated at    s  =   j  ω       s    j  ω     s=j\omega   which is on the    j  ω      j  ω    j\omega   axis. Likewise, to determine the frequency response of a discrete-time filter, the transfer function     H  d    (  z  )        subscript  H  d   z    H_{d}(z)   is evaluated at     z  =   e   j  ω  T        z   superscript  e    j  ω  T      z=e^{j\omega T}    which is on the unit circle,     |  z  |   =  1        z   1    |z|=1   . When the actual frequency of   ω   ω   \omega   is input to the discrete-time filter designed by use of the bilinear transform, it is desired to know at what frequency,    ω  a     subscript  ω  a    \omega_{a}   , for the continuous-time filter that this   ω   ω   \omega   is mapped to.        H  d    (  z  )    =    H  a    (    2  T     z  -  1    z  +  1     )           subscript  H  d   z      subscript  H  a       2  T       z  1     z  1        H_{d}(z)=H_{a}\left(\frac{2}{T}\frac{z-1}{z+1}\right)                H  d    (   e   j  ω  T    )        subscript  H  d    superscript  e    j  ω  T      H_{d}(e^{j\omega T})           =    H  a    (    2  T      e   j  ω  T    -  1     e   j  ω  T    +  1     )        absent     subscript  H  a       2  T        superscript  e    j  ω  T    1      superscript  e    j  ω  T    1        =H_{a}\left(\frac{2}{T}\frac{e^{j\omega T}-1}{e^{j\omega T}+1}\right)              =    H  a    (    2  T   ⋅     e    j  ω  T   /  2     (    e    j  ω  T   /  2    -   e   -    j  ω  T   /  2      )      e    j  ω  T   /  2     (    e    j  ω  T   /  2    +   e   -    j  ω  T   /  2      )      )        absent     subscript  H  a    normal-⋅    2  T        superscript  e      j  ω  T   2       superscript  e      j  ω  T   2     superscript  e        j  ω  T   2          superscript  e      j  ω  T   2       superscript  e      j  ω  T   2     superscript  e        j  ω  T   2            =H_{a}\left(\frac{2}{T}\cdot\frac{e^{j\omega T/2}\left(e^{j\omega T/2}-e^{-j%
 \omega T/2}\right)}{e^{j\omega T/2}\left(e^{j\omega T/2}+e^{-j\omega T/2}%
 \right)}\right)              =    H  a    (    2  T   ⋅    (    e    j  ω  T   /  2    -   e   -    j  ω  T   /  2      )    (    e    j  ω  T   /  2    +   e   -    j  ω  T   /  2      )     )        absent     subscript  H  a    normal-⋅    2  T        superscript  e      j  ω  T   2     superscript  e        j  ω  T   2         superscript  e      j  ω  T   2     superscript  e        j  ω  T   2           =H_{a}\left(\frac{2}{T}\cdot\frac{\left(e^{j\omega T/2}-e^{-j\omega T/2}\right%
 )}{\left(e^{j\omega T/2}+e^{-j\omega T/2}\right)}\right)              =    H  a    (    j   2  T    ⋅     (    e    j  ω  T   /  2    -   e   -    j  ω  T   /  2      )   /   (   2  j   )      (    e    j  ω  T   /  2    +   e   -    j  ω  T   /  2      )   /  2     )        absent     subscript  H  a    normal-⋅    j    2  T           superscript  e      j  ω  T   2     superscript  e        j  ω  T   2        2  j         superscript  e      j  ω  T   2     superscript  e        j  ω  T   2      2        =H_{a}\left(j\frac{2}{T}\cdot\frac{\left(e^{j\omega T/2}-e^{-j\omega T/2}%
 \right)/(2j)}{\left(e^{j\omega T/2}+e^{-j\omega T/2}\right)/2}\right)              =    H  a    (    j   2  T    ⋅    sin   (    ω  T   /  2   )     cos   (    ω  T   /  2   )      )        absent     subscript  H  a    normal-⋅    j    2  T            ω  T   2          ω  T   2         =H_{a}\left(j\frac{2}{T}\cdot\frac{\sin(\omega T/2)}{\cos(\omega T/2)}\right)              =    H  a    (    j   2  T    ⋅   tan   (    ω  T   /  2   )     )        absent     subscript  H  a    normal-⋅    j    2  T          ω  T   2        =H_{a}\left(j\frac{2}{T}\cdot\tan\left(\omega T/2\right)\right)          This shows that every point on the unit circle in the discrete-time filter z-plane,     z  =   e   j  ω  T        z   superscript  e    j  ω  T      z=e^{j\omega T}    is mapped to a point on the    j  ω      j  ω    j\omega   axis on the continuous-time filter s-plane,    s  =   j   ω  a        s    j   subscript  ω  a      s=j\omega_{a}   . That is, the discrete-time to continuous-time frequency mapping of the bilinear transform is       ω  a   =    2  T    tan   (   ω   T  2    )          subscript  ω  a       2  T       ω    T  2        \omega_{a}=\frac{2}{T}\tan\left(\omega\frac{T}{2}\right)     and the inverse mapping is       ω  =    2  T    arctan   (    ω  a    T  2    )      .      ω      2  T        subscript  ω  a     T  2        \omega=\frac{2}{T}\arctan\left(\omega_{a}\frac{T}{2}\right).     The discrete-time filter behaves at frequency   ω   ω   \omega   the same way that the continuous-time filter behaves at frequency     (   2  /  T   )    tan   (    ω  T   /  2   )          2  T         ω  T   2      (2/T)\tan(\omega T/2)   . Specifically, the gain and phase shift that the discrete-time filter has at frequency   ω   ω   \omega   is the same gain and phase shift that the continuous-time filter has at frequency     (   2  /  T   )    tan   (    ω  T   /  2   )          2  T         ω  T   2      (2/T)\tan(\omega T/2)   . This means that every feature, every "bump" that is visible in the frequency response of the continuous-time filter is also visible in the discrete-time filter, but at a different frequency. For low frequencies (that is, when    ω  ≪   2  /  T      much-less-than  ω    2  T     \omega\ll 2/T   or     ω  a   ≪   2  /  T      much-less-than   subscript  ω  a     2  T     \omega_{a}\ll 2/T   ),    ω  ≈   ω  a       ω   subscript  ω  a     \omega\approx\omega_{a}   .  One can see that the entire continuous frequency range       -  ∞   <   ω  a   <   +  ∞              subscript  ω  a               -\infty<\omega_{a}<+\infty     is mapped onto the fundamental frequency interval        -   π  T    <  ω  <   +   π  T     .            π  T    ω           π  T       -\frac{\pi}{T}<\omega<+\frac{\pi}{T}.     The continuous-time filter frequency     ω  a   =  0       subscript  ω  a   0    \omega_{a}=0   corresponds to the discrete-time filter frequency    ω  =  0      ω  0    \omega=0   and the continuous-time filter frequency     ω  a   =   ±  ∞        subscript  ω  a    plus-or-minus      \omega_{a}=\pm\infty   correspond to the discrete-time filter frequency     ω  =   ±   π  /  T     .      ω   plus-or-minus    π  T      \omega=\pm\pi/T.     One can also see that there is a nonlinear relationship between    ω  a     subscript  ω  a    \omega_{a}   and    ω  .    ω   \omega.   This effect of the bilinear transform is called frequency warping . The continuous-time filter can be designed to compensate for this frequency warping by setting     ω  a   =    2  T    tan   (   ω   T  2    )          subscript  ω  a       2  T       ω    T  2        \omega_{a}=\frac{2}{T}\tan\left(\omega\frac{T}{2}\right)   for every frequency specification that the designer has control over (such as corner frequency or center frequency). This is called pre-warping the filter design.  When designing a digital filter as an approximation of a continuous time filter, the frequency response (both amplitude and phase) of the digital filter can be made to match the frequency response of the continuous filter at frequency    ω  0     subscript  ω  0    \omega_{0}   if the following transform is substituted into the continuous filter transfer function. 2 This is a modified version of Tustin's transform shown above. However, note that this transform becomes the above transform as     ω  0   →  0     normal-→   subscript  ω  0   0    \omega_{0}\to 0   . That is to say, the above transform causes the digital filter response to match the analog filter response at DC.       s  ←     ω  0    tan   (     ω  0   T   2   )       z  -  1    z  +  1      .     normal-←  s       subscript  ω  0          subscript  ω  0   T   2         z  1     z  1       s\leftarrow\frac{\omega_{0}}{\tan(\frac{\omega_{0}T}{2})}\frac{z-1}{z+1}.     The main advantage of the warping phenomenon is the absence of aliasing distortion of the frequency response characteristic, such as observed with Impulse invariance . It is necessary, however, to compensate for the frequency warping by pre-warping the given frequency specifications of the continuous-time system. These pre-warped specifications may then be used in the bilinear transform to obtain the desired discrete-time system.  See also   Impulse invariance  Matched Z-transform method   References  "  Category:Digital signal processing  Category:Transforms  Category:Control theory     ↩  Astrom, Karl J. Computer Controlled Systems, Theory and Design Second Edition. ISBN 0131686003. Prentice-Hall, 1990, pp 212 ↩     
   Constant Q transform      Constant Q transform   In mathematics and signal processing , the Constant Q Transform transforms a data series to the frequency domain. It is related to the Fourier Transform , 1 and very closely related to the complex Morlet wavelet transform. 2  The transform can be thought of as a series of logarithmically spaced filters, with the k -th filter having a spectral width some multiple of the previous filter's width, i.e.         δ   f  k        =     2   1  n    *  δ    f   k  -  1             =      (   2   1  n    )   k   *  δ    f  min             δ   subscript  f  k      absent       superscript  2    1  n    δ    subscript  f    k  1         missing-subexpression     absent       superscript   superscript  2    1  n    k   δ    subscript  f  min        \begin{aligned}\displaystyle\delta f_{k}&\displaystyle=2^{\frac{1}{n}}*\delta f%
 _{k-1}\\
 &\displaystyle=\left({2^{\frac{1}{n}}}\right)^{k}*\delta f_{\mathrm{min}}\end{aligned}     where δ f k is the bandwidth of the kth filter, f min is the centre frequency of the lowest filter, and n is the number of filters per octave .  Calculation of the Transform  The short-time Fourier Transform of x [ n ] for a frame shifted to sample m is calculated as follows:       X   [  k  ,  m  ]    =    ∑   n  =  0    N  -  1     W   [   n  -  m   ]   x   [  n  ]    e    -   j  2  π  k  n    N            X   k  m      superscript   subscript     n  0      N  1      W   delimited-[]    n  m    x   delimited-[]  n    superscript  e        j  2  π  k  n    N        X[k,m]=\sum_{n=0}^{N-1}W[n-m]x[n]e^{\frac{-j2\pi kn}{N}}     Given a data series, sampled at f s = 1/ T , T being the sampling period of our data, for each frequency bin we can define the following:   Filter width, δ f k    Q , the "quality factor". This is shown below to be the integer number of cycles processed at a center frequency f k . As such, this somewhat defines the time complexity of the transform.         Q  =    f  k    δ   f  k         Q     subscript  f  k     δ   subscript  f  k       Q=\frac{f_{k}}{\delta f_{k}}         Window length for the k -th bin          N   [  k  ]    =   (    f  s    δ   f  k     )   =    (   S   f  k    )   Q           N   delimited-[]  k       subscript  f  s     δ   subscript  f  k              S   subscript  f  k    Q      N[k]=\left(\frac{f_{s}}{\delta f_{k}}\right)=\left(\frac{S}{f_{k}}\right)Q         As S / f k is the number of samples processed per cycle at frequency f k , Q is the number of integer cycles processed at this center frequency.   The equivalent transform kernel can be found by using the following substitutions:   The window length of each bin is now a function of the bin number:         N  =   N   [  k  ]    =   Q    f  s    f  k           N    N   delimited-[]  k           Q     subscript  f  s    subscript  f  k        N=N[k]=Q\frac{f_{s}}{f_{k}}         The relative power of each bin will decrease with higher frequencies, as these sum over fewer terms. To compensate for this, we normalize by N [ k ].    Any windowing function will be a function of window length, and likewise a function of window number. For example, the equivalent Hamming window would be,           W   [  k  ,  n  ]    =   α  -    (   1  -  α   )    cos   (    2  π  n    N   [  k  ]     )       ,    α  =   25  /  46    ,   0  ⩽  n  ⩽    N   [  k  ]    -  1        formulae-sequence      W   k  n      α      1  α         2  π  n     N   delimited-[]  k          formulae-sequence    α    25  46        0  n           N   delimited-[]  k    1        W[k,n]=\alpha-\left(1-\alpha\right)\cos\left(\frac{2\pi n}{N[k]}\right),\alpha%
 =25/46,0\leqslant n\leqslant N[k]-1         Our digital frequency,     2  π  k   N        2  π  k   N    \frac{2\pi k}{N}   , becomes     2  π  Q    N   [  k  ]          2  π  Q     N   delimited-[]  k      \frac{2\pi Q}{N[k]}      After these modifications, we are left with:       X   [  k  ]    =    1   N   [  k  ]       ∑   n  =  0     N   [  k  ]    -  1     W   [  k  ,  n  ]   x   [  n  ]    e    -   j  2  π  Q  n     N   [  k  ]               X   delimited-[]  k        1    N   delimited-[]  k       superscript   subscript     n  0        N   delimited-[]  k    1      W   k  n   x   delimited-[]  n    superscript  e        j  2  π  Q  n      N   delimited-[]  k           X[k]=\frac{1}{N[k]}\sum_{n=0}^{N[k]-1}W[k,n]x[n]e^{\frac{-j2\pi Qn}{N[k]}}     Fast calculation using FFT  The direct calculation of the Constant Q transform is slow when compared against the Fast Fourier Transform (FFT). However, the FFT can itself be employed, in conjunction with the use of a kernel , to perform the equivalent calculation but much faster. 3  Comparison with the Fourier Transform  In general, the transform is well suited to musical data, and this can be seen in some of its advantages compared to the Fast Fourier Transform. As the output of the transform is effectively amplitude/phase against log frequency, fewer frequency bins are required to cover a given range effectively, and this proves useful where frequencies span several octaves. As the range of human hearing covers approximately ten octaves from 20 Hz to around 20 kHz, this reduction in output data is significant.  The transform exhibits a reduction in frequency resolution with higher frequency bins—which is desirable for auditory applications. The transform mirrors the human auditory system, whereby at lower frequencies spectral resolution is better, whereas temporal resolution improves at higher frequencies. At the bottom of the piano scale (about 30 Hz), a difference of 1 semitone is a difference of approximately 1.5 Hz, whereas at the top of the musical scale (about 5 kHz), a difference of 1 semitone is a difference of approximately 200 Hz. 4 So for musical data the exponential frequency resolution of Constant Q is ideal.  In addition, the harmonics of musical notes form a pattern characteristic of the timbre of the instrument in this transform. Assuming the same relative strengths of each harmonic, as the fundamental frequency changes, the relative position of these harmonics remains constant. This can make identification of instruments much easier.  Relative to the Fourier Transform, implementation of this transform is more tricky. This is due to the varying number of samples used in the calculation of each frequency bin, which also affects the length of any windowing function implemented.  Also note that because the frequency scale is logarithmic, there is no true zero-frequency / DC term present, perhaps limiting possible utility of the transform.  References    "  Category:Integral transforms  Category:Harmonic analysis     Judith C. Brown, Calculation of a constant Q spectral transform , J. Acoust. Soc. Am. , 89(1):425–434, 1991. ↩  Continuous Wavelet Transform "When the mother wavelet can be interpreted as a windowed sinusoid (such as the Morlet wavelet), the wavelet transform can be interpreted as a constant-Q Fourier transform. Before the theory of wavelets, constant-Q Fourier transforms (such as obtained from a classic third-octave filter bank) were not easy to invert, because the basis signals were not orthogonal." ↩  Judith C. Brown and Miller S. Puckette, An efficient algorithm for the calculation of a constant Q transform , J. Acoust. Soc. Am. , 92(5):2698–2701, 1992. ↩  http://newt.phys.unsw.edu.au/jw/graphics/notes.GIF ↩     
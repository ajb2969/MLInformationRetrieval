   Multisymplectic integrator      Multisymplectic integrator   In mathematics , a multisymplectic integrator is a numerical method for the solution of a certain class of partial differential equations , that are said to be multisymplectic. Multisymplectic integrators are geometric integrators , meaning that they preserve the geometry of the problems; in particular, the numerical method preserves energy and momentum in some sense, similar to the partial differential equation itself. Examples of multisymplectic integrators include the Euler box scheme and the Preissman box scheme.  Multisymplectic equations  A partial differential equation (PDE) is said to be a multisymplectic equation if it can be written in the form         K   z  t    +   L   z  x     =    ∇  S    (  z  )     ,          K   subscript  z  t      L   subscript  z  x        normal-∇  S   z     Kz_{t}+Lz_{x}=\nabla S(z),   where    z   (  t  ,  x  )       z   t  x     z(t,x)   is the unknown,   K   K   K   and   L   L   L   are (constant) skew-symmetric matrices and    ∇  S     normal-∇  S    \nabla S   denotes the gradient of   S   S   S   . 1 This is a natural generalization of     J   z  t    =    ∇  H    (  z  )          J   subscript  z  t       normal-∇  H   z     Jz_{t}=\nabla H(z)   , the form of a Hamiltonian ODE . 2  Examples of multisymplectic PDEs include the nonlinear Klein–Gordon equation       u   t  t    -   u   x  x     =    V  ′    (  u  )           subscript  u    t  t     subscript  u    x  x        superscript  V  normal-′   u     u_{tt}-u_{xx}=V^{\prime}(u)   , or more generally the nonlinear wave equation     u   t  t    =      ∂  x    σ  ′     (   u  x   )    -    f  ′    (  u  )          subscript  u    t  t          subscript   x    superscript  σ  normal-′     subscript  u  x       superscript  f  normal-′   u      u_{tt}=\partial_{x}\sigma^{\prime}(u_{x})-f^{\prime}(u)   , 3 and the KdV equation       u  t   +   u   u  x    +   u   x  x  x     =  0         subscript  u  t     u   subscript  u  x     subscript  u    x  x  x     0    u_{t}+uu_{x}+u_{xxx}=0   . 4  Define the 2-forms    ω   ω   \omega   and   κ   κ   \kappa   by        ω   (  u  ,  v  )    =    ⟨   K  u   ,  v  ⟩   and      κ   (  u  ,  v  )    =   ⟨   L  u   ,  v  ⟩       formulae-sequence      ω   u  v        K  u   v   and        κ   u  v       L  u   v      \omega(u,v)=\langle Ku,v\rangle\quad\text{and}\quad\kappa(u,v)=\langle Lu,v\rangle   where    ⟨  ⋅  ,  ⋅  ⟩     normal-⋅  normal-⋅    \langle\,\cdot\,,\,\cdot\,\rangle   denotes the dot product . The differential equation preserves symplecticity in the sense that         ∂  t   ω   +    ∂  x   κ    =  0.          subscript   t   ω     subscript   x   κ    0.    \partial_{t}\omega+\partial_{x}\kappa=0.    5 Taking the dot product of the PDE with    u  t     subscript  u  t    u_{t}   yields the local conservation law for energy:            ∂  t   E    (  u  )    +     ∂  x   F    (  u  )     =   0  where       E   (  u  )    =    S   (  u  )    -     1  2    κ   (   u  x   ,  u  )      ,    F   (  u  )    =     1  2    κ   (   u  t   ,  u  )       .     formulae-sequence          subscript   t   E   u       subscript   x   F   u     0  where     formulae-sequence      E  u       S  u       1  2   κ    subscript  u  x   u          F  u       1  2   κ    subscript  u  t   u        \partial_{t}E(u)+\partial_{x}F(u)=0\quad\text{where}\quad E(u)=S(u)-\tfrac{1}{%
 2}\kappa(u_{x},u),\,F(u)=\tfrac{1}{2}\kappa(u_{t},u).    6 The local conservation law for momentum is derived similarly:            ∂  t   I    (  u  )    +     ∂  x   G    (  u  )     =   0  where       I   (  u  )    =     1  2    ω   (   u  x   ,  u  )     ,    G   (  u  )    =    S   (  u  )    -     1  2    ω   (   u  t   ,  u  )        .     formulae-sequence          subscript   t   I   u       subscript   x   G   u     0  where     formulae-sequence      I  u       1  2   ω    subscript  u  x   u         G  u       S  u       1  2   ω    subscript  u  t   u         \partial_{t}I(u)+\partial_{x}G(u)=0\quad\text{where}\quad I(u)=\tfrac{1}{2}%
 \omega(u_{x},u),\,G(u)=S(u)-\tfrac{1}{2}\omega(u_{t},u).    7  The Euler box scheme  A multisymplectic integrator is a numerical method for solving multisymplectic PDEs whose numerical solution conserves a discrete form of symplecticity. 8 One example is the Euler box scheme, which is derived by applying the symplectic Euler method to each independent variable. 9  The Euler box scheme uses a splitting of the skewsymmetric matrices   K   K   K   and   L   L   L   of the form:     K   K   \displaystyle K   For instance, one can take    K  +     subscript  K     K_{+}   and    L  +     subscript  L     L_{+}   to be the upper triangular part of   K   K   K   and   L   L   L   , respectively. 10  Now introduce a uniform grid and let    u   n  ,  i      subscript  u   n  i     u_{n,i}   denote the approximation to    u   (   n  Δ  t   ,   i  Δ  x   )       u     n  normal-Δ  t     i  normal-Δ  x      u(n\Delta{t},i\Delta{x})   where    Δ  t      normal-Δ  t    \Delta{t}   and    Δ  x      normal-Δ  x    \Delta{x}   are the grid spacing in the time- and space-direction. Then the Euler box scheme is         K  +     ∂  t  +    u   n  ,  i      +    K  -     ∂  t  -    u   n  ,  i      +    L  +     ∂  x  +    u   n  ,  i      +    L  -     ∂  x  -    u   n  ,  i       =    ∇  S    (   u   n  ,  i    )             subscript  K      superscript   subscript   t      subscript  u   n  i         subscript  K      superscript   subscript   t      subscript  u   n  i         subscript  L      superscript   subscript   x      subscript  u   n  i         subscript  L      superscript   subscript   x      subscript  u   n  i          normal-∇  S    subscript  u   n  i       K_{+}\partial_{t}^{+}u_{n,i}+K_{-}\partial_{t}^{-}u_{n,i}+L_{+}\partial_{x}^{+%
 }u_{n,i}+L_{-}\partial_{x}^{-}u_{n,i}=\nabla{S}(u_{n,i})   where the finite difference operators are defined by       ∂  t  +    u   n  ,  i        superscript   subscript   t      subscript  u   n  i      \displaystyle\partial_{t}^{+}u_{n,i}    11 The Euler box scheme is a first-order method, 12 which satisfies the discrete conservation law           ∂  t  +    ω   n  ,  i     +    ∂  x  +    κ   n  ,  i      =   0  where       ω   n  ,  i    =     d   u   n  ,   i  -  1      ∧     K  +    d   u   n  ,  i      and      κ   n  ,  i    =    d   u    n  -  1   ,  i     ∧     L  +    d   u   n  ,  i         .     formulae-sequence        superscript   subscript   t      subscript  ω   n  i       superscript   subscript   x      subscript  κ   n  i       0  where     formulae-sequence     subscript  ω   n  i         normal-d   subscript  u   n    i  1         subscript  K    normal-d   subscript  u   n  i      and       subscript  κ   n  i        normal-d   subscript  u     n  1   i        subscript  L    normal-d   subscript  u   n  i          \partial_{t}^{+}\omega_{n,i}+\partial_{x}^{+}\kappa_{n,i}=0\quad\text{where}%
 \quad\omega_{n,i}=\mathrm{d}u_{n,i-1}\wedge K_{+}\,\mathrm{d}u_{n,i}\quad\text%
 {and}\quad\kappa_{n,i}=\mathrm{d}u_{n-1,i}\wedge L_{+}\,\mathrm{d}u_{n,i}.    13  Preissman box scheme  Another multisymplectic integrator is the Preissman box scheme, which was introduced by Preissman in the context of hyperbolic PDEs. 14 It is also known as the centred cell scheme. 15 The Preissman box scheme can be derived by applying the Implicit midpoint rule , which is a symplectic integrator, to each of the independent variables. 16 This leads to the scheme         K    ∂  t  +    u   n  ,   i  +   1  /  2        +   L    ∂  x  +    u    n  +   1  /  2    ,  i       =    ∇  S    (   u    n  +   1  /  2    ,   i  +   1  /  2      )     ,          K    superscript   subscript   t      subscript  u   n    i    1  2          L    superscript   subscript   x      subscript  u     n    1  2    i          normal-∇  S    subscript  u     n    1  2      i    1  2         K\partial_{t}^{+}u_{n,i+1/2}+L\partial_{x}^{+}u_{n+1/2,i}=\nabla{S}(u_{n+1/2,i%
 +1/2}),   where the finite difference operators    ∂  t  +     superscript   subscript   t      \partial_{t}^{+}   and    ∂  x  +     superscript   subscript   x      \partial_{x}^{+}   are defined as above and the values at the half-integers are defined by         u   n  ,   i  +   1  /  2      =     u   n  ,  i    +   u   n  ,   i  +  1      2    ,     u    n  +   1  /  2    ,  i    =     u   n  ,  i    +   u    n  +  1   ,  i     2    ,    u    n  +   1  /  2    ,   i  +   1  /  2      =     u   n  ,  i    +   u   n  ,   i  +  1     +   u    n  +  1   ,  i    +   u    n  +  1   ,   i  +  1      4      .     formulae-sequence     subscript  u   n    i    1  2           subscript  u   n  i     subscript  u   n    i  1      2     formulae-sequence     subscript  u     n    1  2    i         subscript  u   n  i     subscript  u     n  1   i     2       subscript  u     n    1  2      i    1  2           subscript  u   n  i     subscript  u   n    i  1      subscript  u     n  1   i     subscript  u     n  1     i  1      4       u_{n,i+1/2}=\frac{u_{n,i}+u_{n,i+1}}{2},\quad u_{n+1/2,i}=\frac{u_{n,i}+u_{n+1%
 ,i}}{2},u_{n+1/2,i+1/2}=\frac{u_{n,i}+u_{n,i+1}+u_{n+1,i}+u_{n+1,i+1}}{4}.    17 The Preissman box scheme is a second-order multisymplectic integrator which satisfies the discrete conservation law           ∂  t  +    ω   n  ,  i     +    ∂  x  +    κ   n  ,  i      =   0  where       ω   n  ,  i    =     d   u   n  ,   i  +   1  /  2       ∧    K   d   u   n  ,   i  +   1  /  2        and      κ   n  ,  i    =    d   u    n  +   1  /  2    ,  i     ∧    L   d   u    n  +   1  /  2    ,  i         .     formulae-sequence        superscript   subscript   t      subscript  ω   n  i       superscript   subscript   x      subscript  κ   n  i       0  where     formulae-sequence     subscript  ω   n  i         normal-d   subscript  u   n    i    1  2         K  normal-d   subscript  u   n    i    1  2        and       subscript  κ   n  i        normal-d   subscript  u     n    1  2    i       L  normal-d   subscript  u     n    1  2    i          \partial_{t}^{+}\omega_{n,i}+\partial_{x}^{+}\kappa_{n,i}=0\quad\text{where}%
 \quad\omega_{n,i}=\mathrm{d}u_{n,i+1/2}\wedge K\,\mathrm{d}u_{n,i+1/2}\quad%
 \text{and}\quad\kappa_{n,i}=\mathrm{d}u_{n+1/2,i}\wedge L\,\mathrm{d}u_{n+1/2,%
 i}.    18  Notes  References    .   .   .   .   .   .   "  Category:Numerical differential equations     , p. 1374; , p. 335–336. ↩  , p. 186. ↩  , p. 335. ↩  , p. 339–340. ↩  , p. 186; , p. 336. ↩  , p. 187; , p. 337–338. ↩   ; . ↩  . ↩  ; . ↩  ; . ↩   ; . ↩  refers to  for the work by Preissman. ↩  . ↩  ; . ↩   ; . ↩     
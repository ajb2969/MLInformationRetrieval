   Jacobian matrix and determinant      Jacobian matrix and determinant   In vector calculus , the Jacobian matrix (, ) is the matrix of all first-order partial derivatives of a vector-valued function . Specifically, suppose is a function which takes as input the vector and produces as output the vector . Then the Jacobian matrix   𝐉   𝐉   \mathbf{J}   of   𝐟   𝐟   \mathbf{f}   is an    m  ×  n      m  normal-×  n    m×n   matrix, usually defined and arranged as follows:      𝐉  =    d  𝐟    d  𝐱    =   [       ∂  𝐟    ∂   x  1       ⋯      ∂  𝐟    ∂   x  n        ]   =   [       ∂   f  1     ∂   x  1       ⋯      ∂   f  1     ∂   x  n         ⋮    ⋱    ⋮        ∂   f  m     ∂   x  1       ⋯      ∂   f  m     ∂   x  n        ]         𝐉      d  𝐟     d  𝐱               𝐟      subscript  x  1     normal-⋯      𝐟      subscript  x  n                   subscript  f  1       subscript  x  1     normal-⋯       subscript  f  1       subscript  x  n       normal-⋮  normal-⋱  normal-⋮         subscript  f  m       subscript  x  1     normal-⋯       subscript  f  m       subscript  x  n          \mathbf{J}=\frac{d\mathbf{f}}{d\mathbf{x}}=\begin{bmatrix}\dfrac{\partial%
 \mathbf{f}}{\partial x_{1}}&\cdots&\dfrac{\partial\mathbf{f}}{\partial x_{n}}%
 \end{bmatrix}=\begin{bmatrix}\dfrac{\partial f_{1}}{\partial x_{1}}&\cdots&%
 \dfrac{\partial f_{1}}{\partial x_{n}}\\
 \vdots&\ddots&\vdots\\
 \dfrac{\partial f_{m}}{\partial x_{1}}&\cdots&\dfrac{\partial f_{m}}{\partial x%
 _{n}}\end{bmatrix}     or, component-wise:        𝐉   i  ,  j    =    ∂   f  i     ∂   x  j      .       subscript  𝐉   i  j         subscript  f  i       subscript  x  j       \mathbf{J}_{i,j}=\frac{\partial f_{i}}{\partial x_{j}}.     This matrix, whose entries are functions of   𝐱   𝐱   \mathbf{x}   , is also denoted by    D  𝐟      D  𝐟    D\mathbf{f}   , , and . (Note that some literature defines the Jacobian as the transpose of the matrix given above.)  The Jacobian matrix is important because if the function   𝐟   𝐟   \mathbf{f}   is differentiable at a point   𝐱   𝐱   \mathbf{x}   (this is a slightly stronger condition than merely requiring that all partial derivatives exist there), then the Jacobian matrix defines a linear map  , which is the best linear approximation of the function   𝐟   𝐟   \mathbf{f}   near the point   𝐱   𝐱   \mathbf{x}   . This linear map is thus the generalization of the usual notion of derivative, and is called the derivative or the differential of   𝐟   𝐟   \mathbf{f}   at   𝐱   𝐱   \mathbf{x}   .  If   m   m   m   =   n   n   n   , the Jacobian matrix is a square matrix, and its determinant , a function of , is the Jacobian determinant of   𝐟   𝐟   \mathbf{f}   . It carries important information about the local behavior of   𝐟   𝐟   \mathbf{f}   . In particular, the function   𝐟   𝐟   \mathbf{f}   has locally in the neighborhood of a point   𝐱   𝐱   \mathbf{x}   an inverse function that is differentiable if and only if the Jacobian determinant is nonzero at   𝐱   𝐱   \mathbf{x}   (see Jacobian conjecture ). The Jacobian determinant occurs also when changing the variables in multi-variable integrals (see substitution rule for multiple variables ).  If   m   m   m   = 1,   𝐟   𝐟   \mathbf{f}   is a scalar field and the Jacobian matrix is reduced to a row vector of partial derivatives of   𝐟   𝐟   \mathbf{f}   —i.e. the gradient of   𝐟   𝐟   \mathbf{f}   .  These concepts are named after the mathematician  Carl Gustav Jacob Jacobi (1804–1851).  Jacobian matrix  The Jacobian generalizes the gradient of a scalar -valued function of multiple variables, which itself generalizes the derivative of a scalar-valued function of a single variable. In other words, the Jacobian for a scalar-valued multivariable function is the gradient and that of a scalar-valued function of single variable is simply its derivative. The Jacobian can also be thought of as describing the amount of "stretching", "rotating" or "transforming" that a transformation imposes locally. For example, if     (   x  ′   ,   y  ′   )   =   𝐟   (  x  ,  y  )           x  normal-′     y  normal-′      𝐟   x  y      (x′,y′)=\mathbf{f}(x,y)   is used to transform an image, the Jacobian , describes how the image in the neighborhood of    (  x  ,  y  )     x  y    (x,y)   is transformed.  If a function is differentiable at a point, its derivative is given in coordinates by the Jacobian, but a function doesn't need to be differentiable for the Jacobian to be defined, since only the partial derivatives are required to exist.  If   𝐩   𝐩   \mathbf{p}   is a point in and   𝐟   𝐟   \mathbf{f}   is differentiable at   𝐩   𝐩   \mathbf{p}   , then its derivative is given by . In this case, the linear map described by is the best linear approximation of   𝐟   𝐟   \mathbf{f}   near the point   𝐩   𝐩   \mathbf{p}   , in the sense that       𝐟   (  𝐱  )    =    𝐟   (  𝐩  )    +    𝐉  𝐟    (  𝐩  )    (   𝐱  -  𝐩   )    +   o   (   ∥   𝐱  -  𝐩   ∥   )           𝐟  𝐱       𝐟  𝐩      subscript  𝐉  𝐟   𝐩    𝐱  𝐩      o   norm    𝐱  𝐩        \mathbf{f}(\mathbf{x})=\mathbf{f}(\mathbf{p})+\mathbf{J}_{\mathbf{f}}(\mathbf{%
 p})(\mathbf{x}-\mathbf{p})+o(\|\mathbf{x}-\mathbf{p}\|)     for   𝐱   𝐱   \mathbf{x}   close to   𝐩   𝐩   \mathbf{p}   and where   o   o   o   is the little o-notation (for    𝐱  →  𝐩      𝐱  normal-→  𝐩    \mathbf{x}→\mathbf{p}   ) and    ‖  𝐱  −  𝐩  ‖      normal-‖  𝐱  normal-−  𝐩  normal-‖    ‖\mathbf{x}−\mathbf{p}‖   is the distance between   𝐱   𝐱   \mathbf{x}   and   𝐩   𝐩   \mathbf{p}   .  Compare this to a Taylor series for a scalar function of a scalar argument, truncated to first order:        f   (  x  )    =    f   (  p  )    +    f  ′    (  p  )    (   x  -  p   )    +   o   (   x  -  p   )      .        f  x       f  p      superscript  f  normal-′   p    x  p      o    x  p       f(x)=f(p)+f^{\prime}(p)(x-p)+o(x-p).     In a sense, both the gradient and Jacobian are " first derivatives "—the former the first derivative of a scalar function of several variables, the latter the first derivative of a vector function of several variables.  The Jacobian of the gradient of a scalar function of several variables has a special name: the Hessian matrix , which in a sense is the " second derivative " of the function in question.  Jacobian determinant  (Figure)  A nonlinear map f : R 2 → R 2 sends a small square to a distorted parallelepiped close to the image of the square under the best linear approximation of f near the point.   If   m   m   m   =   n   n   n   , then   𝐟   𝐟   \mathbf{f}   is a function from to itself and the Jacobian matrix is a square matrix . We can then form its determinant , known as the Jacobian determinant . The Jacobian determinant is occasionally referred to as "the Jacobian".  The Jacobian determinant at a given point gives important information about the behavior of   𝐟   𝐟   \mathbf{f}   near that point. For instance, the continuously differentiable function    𝐟   𝐟   \mathbf{f}   is invertible near a point if the Jacobian determinant at   𝐩   𝐩   \mathbf{p}   is non-zero. This is the inverse function theorem . Furthermore, if the Jacobian determinant at   𝐩   𝐩   \mathbf{p}   is positive , then   𝐟   𝐟   \mathbf{f}   preserves orientation near   𝐩   𝐩   \mathbf{p}   ; if it is negative ,   𝐟   𝐟   \mathbf{f}   reverses orientation. The absolute value of the Jacobian determinant at   𝐩   𝐩   \mathbf{p}   gives us the factor by which the function   𝐟   𝐟   \mathbf{f}   expands or shrinks volumes near   𝐩   𝐩   \mathbf{p}   ; this is why it occurs in the general substitution rule .  The Jacobian determinant is used when making a change of variables when evaluating a multiple integral of a function over a region within its domain. To accommodate for the change of coordinates the magnitude of the Jacobian determinant arises as a multiplicative factor within the integral. This is because the   n   n   n   -dimensional    d  V      d  V    dV   element is in general a parallelepiped in the new coordinate system, and the   n   n   n   -volume of a parallelepiped is the determinant of its edge vectors.  The Jacobian can also be used to solve systems of differential equations at an equilibrium point or approximate solutions near an equilibrium point.  Inverse  According to the inverse function theorem , the matrix inverse of the Jacobian matrix of an invertible function is the Jacobian matrix of the inverse function. That is, if the Jacobian of the function is continuous and nonsingular at the point   𝐩   𝐩   \mathbf{p}   in , then   𝐟   𝐟   \mathbf{f}   is invertible when restricted to some neighborhood of   𝐩   𝐩   \mathbf{p}   and         𝐉   𝐟   -  1     ∘  𝐟   =   𝐉  𝐟     -  1     .         subscript  𝐉   superscript  𝐟    1     𝐟    superscript   subscript  𝐉  𝐟     1      \mathbf{J}_{\mathbf{f}^{-1}}\circ\mathbf{f}={\mathbf{J}_{\mathbf{f}}}^{-1}.     Conversely, if the Jacobian determinant is not zero at a point, then the function is locally invertible near this point, that is there is neighbourhood of this point, in which the function is invertible.  The (unproved) Jacobian conjecture is related to global invertibility in the case of a polynomial functions, that is a function defined by n  polynomials in n variables. It asserts that, if the Jacobian determinant is a non-zero constant (or, equivalently, that it does not have any complex zero), then the function is invertible and its inverse is a polynomial function.  Critical points  If is a differentiable function , a critical point of   𝐟   𝐟   \mathbf{f}   is a point where the rank of the Jacobian matrix is not maximal. This means that the rank at the critical point is lower than the rank at some neighbour point. In other words, let   k   k   k   be the maximal dimension of the open balls contained in the image of   𝐟   𝐟   \mathbf{f}   ; then a point is critical if all minors of rank   k   k   k   of   𝐟   𝐟   \mathbf{f}   are zero.  In the case where 1 =   m   m   m   =   n   n   n   =   k   k   k   , a point is critical if the Jacobian determinant is zero.  Examples  Example 1  Consider the function given by        𝐟   (  x  ,  y  )    =   [       x  2   y         5  x   +   sin  y       ]    .        𝐟   x  y         superscript  x  2   y         5  x     y        \mathbf{f}(x,y)=\begin{bmatrix}x^{2}y\\
 5x+\sin y\end{bmatrix}.   Then we have        f  1    (  x  ,  y  )    =    x  2   y          subscript  f  1    x  y       superscript  x  2   y     f_{1}(x,y)=x^{2}y   and        f  2    (  x  ,  y  )    =    5  x   +   sin  y           subscript  f  2    x  y        5  x     y      f_{2}(x,y)=5x+\sin y   and the Jacobian matrix of   𝐅   𝐅   \mathbf{F}   is        𝐉  𝐟    (  x  ,  y  )    =   [       ∂   f  1     ∂  x        ∂   f  1     ∂  y          ∂   f  2     ∂  x        ∂   f  2     ∂  y       ]   =   [      2  x  y      x  2       5     cos  y      ]            subscript  𝐉  𝐟    x  y           subscript  f  1      x         subscript  f  1      y           subscript  f  2      x         subscript  f  2      y               2  x  y    superscript  x  2     5    y        \mathbf{J}_{\mathbf{f}}(x,y)=\begin{bmatrix}\dfrac{\partial f_{1}}{\partial x}%
 &\dfrac{\partial f_{1}}{\partial y}\\
 \dfrac{\partial f_{2}}{\partial x}&\dfrac{\partial f_{2}}{\partial y}\end{%
 bmatrix}=\begin{bmatrix}2xy&x^{2}\\
 5&\cos y\end{bmatrix}   and the Jacobian determinant is        det   (    𝐉  𝐟    (  x  ,  y  )    )    =    2  x  y   cos  y    -   5   x  2      .           subscript  𝐉  𝐟    x  y         2  x  y    y      5   superscript  x  2       \det(\mathbf{J}_{\mathbf{f}}(x,y))=2xy\cos y-5x^{2}.     Example 2: polar-Cartesian transformation  The transformation from polar coordinates     (  r  ,  φ  )     r  φ    (r,φ)   to Cartesian coordinates ( x , y ), is given by the function with components:     x   x   \displaystyle x          𝐉   (  r  ,  φ  )    =   [       ∂  x    ∂  r        ∂  x    ∂  φ          ∂  y    ∂  r        ∂  y    ∂  φ       ]   =   [      cos  φ      -   r   sin  φ          sin  φ      r   cos  φ       ]           𝐉   r  φ          x     r        x     φ          y     r        y     φ               φ       r    φ         φ     r    φ         \mathbf{J}(r,\varphi)=\begin{bmatrix}\dfrac{\partial x}{\partial r}&\dfrac{%
 \partial x}{\partial\varphi}\\
 \dfrac{\partial y}{\partial r}&\dfrac{\partial y}{\partial\varphi}\end{bmatrix%
 }=\begin{bmatrix}\cos\varphi&-r\sin\varphi\\
 \sin\varphi&r\cos\varphi\end{bmatrix}     The Jacobian determinant is equal to   r   r   r   . This can be used to transform integrals between the two coordinate systems:         ∬  A    f   (  x  ,  y  )   d   x   d  y    =    ∬  A    f   (   r   cos  ϕ    ,   r   sin  ϕ    )    r   d   r   d  ϕ     .        subscript  double-integral  A     f   x  y   d  x  d  y      subscript  double-integral  A     f     r    ϕ      r    ϕ     r  d  r  d  ϕ      \iint_{A}f(x,y)\,dx\,dy=\iint_{A}f(r\cos\phi,r\sin\phi)\,r\,dr\,d\phi.     Example 3: spherical-Cartesian transformation  The transformation from spherical coordinates     (  r  ,  θ  ,  φ  )     r  θ  φ    (r,θ,φ)   to Cartesian coordinates ( x , y , z ), is given by the function with components:     x   x   \displaystyle x     The Jacobian matrix for this coordinate change is         𝐉  𝐅    (  r  ,  θ  ,  φ  )    =   [       ∂  x    ∂  r        ∂  x    ∂  θ        ∂  x    ∂  φ          ∂  y    ∂  r        ∂  y    ∂  θ        ∂  y    ∂  φ          ∂  z    ∂  r        ∂  z    ∂  θ        ∂  z    ∂  φ       ]   =   [       sin  θ    cos  φ       r   cos  θ    cos  φ       -   r   sin  θ    sin  φ           sin  θ    sin  φ       r   cos  θ    sin  φ       r   sin  θ    cos  φ         cos  θ      -   r   sin  θ       0     ]    .           subscript  𝐉  𝐅    r  θ  φ          x     r        x     θ        x     φ          y     r        y     θ        y     φ          z     r        z     θ        z     φ                 θ     φ      r    θ     φ        r    θ     φ           θ     φ      r    θ     φ      r    θ     φ        θ       r    θ     0       \mathbf{J}_{\mathbf{F}}(r,\theta,\varphi)=\begin{bmatrix}\dfrac{\partial x}{%
 \partial r}&\dfrac{\partial x}{\partial\theta}&\dfrac{\partial x}{\partial%
 \varphi}\\
 \dfrac{\partial y}{\partial r}&\dfrac{\partial y}{\partial\theta}&\dfrac{%
 \partial y}{\partial\varphi}\\
 \dfrac{\partial z}{\partial r}&\dfrac{\partial z}{\partial\theta}&\dfrac{%
 \partial z}{\partial\varphi}\end{bmatrix}=\begin{bmatrix}\sin\theta\cos\varphi%
 &r\cos\theta\cos\varphi&-r\sin\theta\sin\varphi\\
 \sin\theta\sin\varphi&r\cos\theta\sin\varphi&r\sin\theta\cos\varphi\\
 \cos\theta&-r\sin\theta&0\end{bmatrix}.     The determinant is . As an example, since  dx 1  dx 2  dx 3 }} this determinant implies that the differential volume element   r 2 sin θ  dr  dθ  dφ }} . Nevertheless this determinant varies with coordinates.  Example 4  The Jacobian matrix of the function with components      y  1     subscript  y  1    \displaystyle y_{1}     is         𝐉  𝐅    (   x  1   ,   x  2   ,   x  3   )    =   [       ∂   y  1     ∂   x  1         ∂   y  1     ∂   x  2         ∂   y  1     ∂   x  3           ∂   y  2     ∂   x  1         ∂   y  2     ∂   x  2         ∂   y  2     ∂   x  3           ∂   y  3     ∂   x  1         ∂   y  3     ∂   x  2         ∂   y  3     ∂   x  3           ∂   y  4     ∂   x  1         ∂   y  4     ∂   x  2         ∂   y  4     ∂   x  3        ]   =   [     1    0    0      0    0    5      0     8   x  2       -  2         x  3    cos   x  1       0     sin   x  1       ]    .           subscript  𝐉  𝐅     subscript  x  1    subscript  x  2    subscript  x  3            subscript  y  1       subscript  x  1          subscript  y  1       subscript  x  2          subscript  y  1       subscript  x  3            subscript  y  2       subscript  x  1          subscript  y  2       subscript  x  2          subscript  y  2       subscript  x  3            subscript  y  3       subscript  x  1          subscript  y  3       subscript  x  2          subscript  y  3       subscript  x  3            subscript  y  4       subscript  x  1          subscript  y  4       subscript  x  2          subscript  y  4       subscript  x  3              1  0  0    0  0  5    0    8   subscript  x  2      2        subscript  x  3      subscript  x  1     0     subscript  x  1         \mathbf{J}_{\mathbf{F}}(x_{1},x_{2},x_{3})=\begin{bmatrix}\dfrac{\partial y_{1%
 }}{\partial x_{1}}&\dfrac{\partial y_{1}}{\partial x_{2}}&\dfrac{\partial y_{1%
 }}{\partial x_{3}}\\
 \dfrac{\partial y_{2}}{\partial x_{1}}&\dfrac{\partial y_{2}}{\partial x_{2}}&%
 \dfrac{\partial y_{2}}{\partial x_{3}}\\
 \dfrac{\partial y_{3}}{\partial x_{1}}&\dfrac{\partial y_{3}}{\partial x_{2}}&%
 \dfrac{\partial y_{3}}{\partial x_{3}}\\
 \dfrac{\partial y_{4}}{\partial x_{1}}&\dfrac{\partial y_{4}}{\partial x_{2}}&%
 \dfrac{\partial y_{4}}{\partial x_{3}}\end{bmatrix}=\begin{bmatrix}1&0&0\\
 0&0&5\\
 0&8x_{2}&-2\\
 x_{3}\cos x_{1}&0&\sin x_{1}\end{bmatrix}.     This example shows that the Jacobian need not be a square matrix.  Example 5  The Jacobian determinant of the function with components      y  1     subscript  y  1    \displaystyle y_{1}     is        |     0    5    0       8   x  1       -   2   x  3    cos   (    x  2    x  3    )         -   2   x  2    cos   (    x  2    x  3    )          0     x  3      x  2      |   =   -   8   x  1    |     5    0       x  3      x  2      |     =   -   40   x  1    x  2      .            0  5  0      8   subscript  x  1        2   subscript  x  3        subscript  x  2    subscript  x  3           2   subscript  x  2        subscript  x  2    subscript  x  3         0   subscript  x  3    subscript  x  2          8   subscript  x  1       5  0     subscript  x  3    subscript  x  2                 40   subscript  x  1    subscript  x  2        \begin{vmatrix}0&5&0\\
 8x_{1}&-2x_{3}\cos(x_{2}x_{3})&-2x_{2}\cos(x_{2}x_{3})\\
 0&x_{3}&x_{2}\end{vmatrix}=-8x_{1}\begin{vmatrix}5&0\\
 x_{3}&x_{2}\end{vmatrix}=-40x_{1}x_{2}.     From this we see that   𝐅   𝐅   \mathbf{F}   reverses orientation near those points where and have the same sign; the function is locally invertible everywhere except near points where 0}} or 0}} . Intuitively, if one starts with a tiny object around the point    (  1  ,  2  ,  3  )     1  2  3    (1,2,3)   and apply   𝐅   𝐅   \mathbf{F}   to that object, one will get a resulting object with approximately     40  ×  1  ×  2   =  80        40  normal-×  1  normal-×  2   80    40×1×2=80   times the volume of the original one.  Other uses  The Jacobian serves as a linearized design matrix in statistical regression and curve fitting ; see non-linear least squares .  Dynamical systems  Consider a dynamical system of the form     𝐱  ′   =   𝐅   (  𝐱  )          𝐱  normal-′     𝐅  𝐱     \mathbf{x}′=\mathbf{F}(\mathbf{x})   , where    𝐱  ′      𝐱  normal-′    \mathbf{x}′   is the (component-wise) time derivative of   𝐱   𝐱   \mathbf{x}   , and is differentiable. If 0}} , then is a stationary point (also called a critical point; this is not to be confused with fixed points). The behavior of the system near a stationary point is related to the eigenvalues of , the Jacobian of   𝐅   𝐅   \mathbf{F}   at the stationary point. 1 Specifically, if the eigenvalues all have real parts that are negative, then the system is stable near the stationary point, if any eigenvalue has a real part that is positive, then the point is unstable. If the largest real part of the eigenvalues is zero, the Jacobian matrix does not allow for an evaluation of the stability.  Newton's method  A system of coupled nonlinear equations can be solved iteratively by Newton's method . This method uses the Jacobian matrix of the system of equations.  See also   Hessian matrix  Pushforward (differential)   References  Further reading     External links    Mathworld A more technical explanation of Jacobians   "  Category:Multivariable calculus  Category:Differential calculus  Category:Generalizations of the derivative  Category:Determinants  Category:Matrices     ↩     
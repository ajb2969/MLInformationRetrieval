<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1895">Five color theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Five color theorem</h1>
<hr/>

<p>The <strong>five color theorem</strong> is a result from <a href="graph_theory" title="wikilink">graph theory</a> that given a plane separated into regions, such as a <a href="political_map" title="wikilink">political map</a> of the counties of a state, the regions may be colored using no more than five colors in such a way that no two adjacent regions receive the same color.</p>

<p>The five color theorem is implied by the stronger <a href="four_color_theorem" title="wikilink">four color theorem</a>, but is considerably easier to prove. It was based on a failed attempt at the four color proof by <a href="Alfred_Kempe" title="wikilink">Alfred Kempe</a> in 1879. <a href="Percy_John_Heawood" title="wikilink">Percy John Heawood</a> found an error 11 years later, and proved the five color theorem based on Kempe's work. The four color theorem was finally proven by <a href="Kenneth_Appel" title="wikilink">Kenneth Appel</a> and <a href="Wolfgang_Haken" title="wikilink">Wolfgang Haken</a> at the <a href="University_of_Illinois_at_Urbana_Champaign" title="wikilink">University of Illinois</a>, with the <a href="computer-assisted_proof" title="wikilink">aid of a computer</a>. They were assisted in some algorithmic work by <a href="John_A._Koch" title="wikilink">John A. Koch</a>.</p>
<h2 id="outline-of-the-proof-by-contradiction">Outline of the proof by contradiction</h2>

<p>First of all, one associates a simple planar <a href="graph_(mathematics)" title="wikilink">graph</a> 

<math display="inline" id="Five_color_theorem:0">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 to the given map, namely one puts a vertex in each region of the map, then connects two vertices with an edge if and only if the corresponding regions share a common border. The problem is then translated into a graph coloring problem: one has to paint the vertices of the graph so that no edge has endpoints of the same color.</p>

<p>Because 

<math display="inline" id="Five_color_theorem:1">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 is a simple <a href="planar_graph" title="wikilink">planar</a>, i.e. it may be embedded in the plane without intersecting edges, and it does not have two vertices sharing more than one edge, and it doesn't have loops, it can be shown (using the <a href="Euler_characteristic" title="wikilink">Euler characteristic</a> of the plane) that it must have a vertex shared by at most five edges. (Note: This is the only place where the five-color condition is used in the proof. If this technique is used to prove the four-color theorem, it will fail on this step. In fact, an <a href="icosahedral_graph" title="wikilink">icosahedral graph</a> is 5-regular and planar, and thus does not have a vertex shared by at most four edges.) Find such a vertex, and call it 

<math display="inline" id="Five_color_theorem:2">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

.</p>

<p>Now remove 

<math display="inline" id="Five_color_theorem:3">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 from 

<math display="inline" id="Five_color_theorem:4">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

. The graph 

<math display="inline" id="Five_color_theorem:5">
 <semantics>
  <msup>
   <mi>G</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>G</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G^{\prime}
  </annotation>
 </semantics>
</math>

 obtained this way has one fewer vertex than 

<math display="inline" id="Five_color_theorem:6">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

, so we can assume by <a href="Mathematical_induction" title="wikilink">induction</a> that it can be colored with only five colors. 

<math display="inline" id="Five_color_theorem:7">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 must be connected to five other vertices, since if not it can be colored in 

<math display="inline" id="Five_color_theorem:8">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 with a color not used by them. So now look at those five vertices 

<math display="inline" id="Five_color_theorem:9">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:10">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{2}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:11">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{3}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:12">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{4}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:13">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>5</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{5}
  </annotation>
 </semantics>
</math>

 that were adjacent to 

<math display="inline" id="Five_color_theorem:14">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 in cyclic order (which depends on how we write G). If we did not use all the five colors on them, then obviously we can paint 

<math display="inline" id="Five_color_theorem:15">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 in a consistent way to render our graph 5-colored.</p>

<p>So we can assume that 

<math display="inline" id="Five_color_theorem:16">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{1}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:17">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{2}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:18">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{3}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:19">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{4}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Five_color_theorem:20">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>5</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">5</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{5}
  </annotation>
 </semantics>
</math>

 are colored with colors 1, 2, 3, 4, 5 respectively.</p>

<p>Now consider the subgraph 

<math display="inline" id="Five_color_theorem:21">
 <semantics>
  <msub>
   <mi>G</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{13}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Five_color_theorem:22">
 <semantics>
  <msup>
   <mi>G</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>G</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G^{\prime}
  </annotation>
 </semantics>
</math>

 consisting of the vertices that are colored with colors 1 and 3 only, and edges connecting two of them. If 

<math display="inline" id="Five_color_theorem:23">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Five_color_theorem:24">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{3}
  </annotation>
 </semantics>
</math>

 lie in different connected components of 

<math display="inline" id="Five_color_theorem:25">
 <semantics>
  <msub>
   <mi>G</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{13}
  </annotation>
 </semantics>
</math>

, we can reverse the coloration on the component containing 

<math display="inline" id="Five_color_theorem:26">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{1}
  </annotation>
 </semantics>
</math>

, thus assigning color number 1 to 

<math display="inline" id="Five_color_theorem:27">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 and completing the task.</p>

<p>If on the contrary 

<math display="inline" id="Five_color_theorem:28">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Five_color_theorem:29">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{3}
  </annotation>
 </semantics>
</math>

 lie in the same connected component of 

<math display="inline" id="Five_color_theorem:30">
 <semantics>
  <msub>
   <mi>G</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{13}
  </annotation>
 </semantics>
</math>

, we can find a path in 

<math display="inline" id="Five_color_theorem:31">
 <semantics>
  <msub>
   <mi>G</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{13}
  </annotation>
 </semantics>
</math>

 joining them, that is a sequence of edges and vertices painted only with colors 1 and 3.</p>

<p>Now turn to the subgraph 

<math display="inline" id="Five_color_theorem:32">
 <semantics>
  <msub>
   <mi>G</mi>
   <mn>24</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <cn type="integer">24</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{24}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Five_color_theorem:33">
 <semantics>
  <msup>
   <mi>G</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>G</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G^{\prime}
  </annotation>
 </semantics>
</math>

 consisting of the vertices that are colored with colors 2 and 4 only, and edges connecting two of them, and apply the same arguments as before. Then either we are able to reverse a coloration on a subgraph of 

<math display="inline" id="Five_color_theorem:34">
 <semantics>
  <msub>
   <mi>G</mi>
   <mn>24</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <cn type="integer">24</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{24}
  </annotation>
 </semantics>
</math>

 and paint 

<math display="inline" id="Five_color_theorem:35">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

 with, say, color number 2, or we can connect 

<math display="inline" id="Five_color_theorem:36">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{2}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Five_color_theorem:37">
 <semantics>
  <msub>
   <mi>v</mi>
   <mn>4</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>v</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v_{4}
  </annotation>
 </semantics>
</math>

 with a path containing vertices colored only with colors 2 and 4. The latter possibility is clearly absurd, as such a path would intersect the path we constructed in 

<math display="inline" id="Five_color_theorem:38">
 <semantics>
  <msub>
   <mi>G</mi>
   <mn>13</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>G</ci>
    <cn type="integer">13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{13}
  </annotation>
 </semantics>
</math>

.</p>

<p>So 

<math display="inline" id="Five_color_theorem:39">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 can in fact be five-colored, contrary to the initial presumption.</p>
<h2 id="linear-time-five-coloring-algorithm">Linear time five-coloring algorithm</h2>

<p>In 1996, Robertson, Sanders, Seymour, and Thomas described a quadratic four-coloring algorithm in their "Efficiently four-coloring planar graphs".<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In the same paper they briefly describe a linear-time five-coloring algorithm, which is <a href="asymptotically_optimal" title="wikilink">asymptotically optimal</a>. The algorithm as described here operates on multigraphs and relies on the ability to have multiple copies of edges between a single pair of vertices. It is based on <a href="Discharging_method_(discrete_mathematics)#An_easy_example" title="wikilink">Wernicke's theorem</a>, which states the following:</p>
<dl>
<dd><strong>Wernicke's Theorem</strong>: Assume <strong>G</strong> is planar, nonempty, has no faces bounded by two edges, and has minimum <a href="Degree_(graph_theory)" title="wikilink">degree</a> 5. Then <strong>G</strong> has a vertex of degree 5 which is adjacent to a vertex of degree at most 6.
</dd>
</dl>

<p>We will use a representation of the graph in which each vertex maintains a circular linked list of adjacent vertices, in clockwise planar order.</p>

<p>In concept, the algorithm is recursive, reducing the graph to a smaller graph with one less vertex, five-coloring that graph, and then using that coloring to determine a coloring for the larger graph in constant time. In practice, rather than maintain an explicit graph representation for each reduced graph, we will remove vertices from the graph as we go, adding them to a stack, then color them as we pop them back off the stack at the end. We will maintain three stacks:</p>
<ul>
<li>S<sub>4</sub>: Contains all remaining vertices with either degree at most four, or degree five and at most four distinct adjacent vertices (due to multiple edges).</li>
<li>S<sub>5</sub>: Contains all remaining vertices that have degree five, five distinct adjacent vertices, and at least one adjacent vertex with degree at most six.</li>
<li>S<sub>d</sub>: Contains all vertices deleted from the graph so far, in the order that they were deleted.</li>
</ul>

<p>The algorithm works as follows:</p>
<ol>
<li>In the first step, we collapse all multiple edges to single edges, so that the graph is simple. Next, we iterate over the vertices of the graph, pushing any vertex matching the conditions for S<sub>4</sub> or S<sub>5</sub> onto the appropriate stack.</li>
<li>Next, as long as S<sub>4</sub> is non-empty, we pop <em>v</em> from S<sub>4</sub> and delete <em>v</em> from the graph, pushing it onto S<sub>d</sub>, along with a list of its neighbors at this point in time. We check each former neighbor of <em>v</em>, pushing it onto S<sub>4</sub> or S<sub>5</sub> if it now meets the necessary conditions.</li>
<li>When S<sub>4</sub> becomes empty, we know that our graph has minimum degree five. If the graph is empty, we go to the final step 5 below. Otherwise, Wernicke's Theorem tells us that S<sub>5</sub> is nonempty. Pop <em>v</em> off S<sub>5</sub>, delete it from the graph, and let <em>v</em><sub>1</sub>, <em>v</em><sub>2</sub>, <em>v</em><sub>3</sub>, <em>v</em><sub>4</sub>, <em>v</em><sub>5</sub> be the former neighbors of <em>v</em> in clockwise planar order, where <em>v</em><sub>1</sub> is the neighbor of degree at most 6. We check if <em>v</em><sub>1</sub> is adjacent to <em>v</em><sub>3</sub> (which we can do in constant time due to the degree of <em>v</em><sub>1</sub>). There are two cases:
<ol>
<li>If <em>v</em><sub>1</sub> is not adjacent to <em>v</em><sub>3</sub>, we can merge these two vertices into a single vertex. To do this, we remove <em>v</em> from both circular adjacency lists, and then splice the two lists together into one list at the point where <em>v</em> was formerly found. Provided that <em>v</em> maintains a reference to its position in each list, this can be done in constant time. It's possible that this might create faces bounded by two edges at the two points where the lists are spliced together; we delete one edge from any such faces. After doing this, we push <em>v</em><sub>3</sub> onto S<sub>d</sub>, along with a note that <em>v</em><sub>1</sub> is the vertex that it was merged with. Any vertices affected by the merge are added or removed from the stacks as appropriate.</li>
<li>Otherwise, <em>v</em><sub>2</sub> lies inside the face outlined by <em>v</em>, <em>v</em><sub>1</sub>, and <em>v</em><sub>3</sub>. Consequently, <em>v</em><sub>2</sub> cannot be adjacent to <em>v</em><sub>4</sub>, which lies outside this face. We merge <em>v</em><sub>2</sub> and <em>v</em><sub>4</sub> in the same manner as <em>v</em><sub>1</sub> and <em>v</em><sub>3</sub> above.</li>
</ol></li>
<li>Go to step 2.</li>
<li>At this point S<sub>4</sub>, S<sub>5</sub>, and the graph are empty. We pop vertices off S<sub>d</sub>. If the vertex were merged with another vertex in step 3, the vertex that it was merged with will already have been colored, and we assign it the same color. This is valid because we only merged vertices that were not adjacent in the original graph. If we had removed it in step 2 because it had at most 4 adjacent vertices, all of its neighbors at the time of its removal will have already been colored, and we can simply assign it a color that none of its neighbors is using.</li>
</ol>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Four_color_theorem" title="wikilink">Four color theorem</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://mapa-kodow-pocztowych.pl/">Postal code map</a> - five color theorem in practice</li>
</ul>

<p>"</p>

<p><a href="Category:Graph_coloring" title="wikilink">Category:Graph coloring</a> <a href="Category:Theorems_in_graph_theory" title="wikilink">Category:Theorems in graph theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">.<a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

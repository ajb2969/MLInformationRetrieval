<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="767">Modified nodal analysis</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Modified nodal analysis</h1>
<hr>In [[Electrical Engineering]] '''Modified Nodal Analysis'''<ref>{{cite conference |author=Ho, Ruehli, and Brennan |title=The Modified Nodal Approach to Network Analy
<p>sis |booktitle=Proc. 1974 Int. Symposium on Circuits and Systems, San Francisco |date=April 1974 |pages=505‚Äì509 |url=<a class="uri" href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1084079">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1084079</a>}} or MNA is an extension of <a href="nodal_analysis" title="wikilink">nodal analysis</a> which not only determines the circuit's node voltages (as in classical nodal analysis), but also <em>some</em> branch currents. Modified nodal analysis was developed as a formalism to mitigate the difficulty of representing voltage-defined components in nodal analysis (e.g. voltage-controlled voltage sources). It is one such formalism. Others, such as sparse tableau formulation,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> are equally general and related via matrix transformations.</p>
<h2 id="method">Method</h2>

<p>The <strong>MNA</strong> uses the element's <em>Branch Constitutive Equations</em> or BCE, i.e., their <a class="uri" href="voltage" title="wikilink">voltage</a> - <a href="Electric_current" title="wikilink">current</a> characteristic and the <a href="Kirchhoff's_circuit_laws" title="wikilink">Kirchhoff's circuit laws</a>. The method is often done in four steps,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> but it can be reduced to three:</p>

<p><strong>Step 1</strong></p>

<p>Write the <a href="Kirchhoff's_current_law" title="wikilink">KCL</a> of the circuit. At each node of an <a href="electric_circuit" title="wikilink">electric circuit</a> one writes the currents coming in and out of the node. Take care however in the <strong>MNA</strong> the current of the independent voltage sources is taken from the "plus" to the "minus". See Figure 1. Also note that the right hand side of each equation is <em>always</em> equal to zero. So that the branch currents that come into the node are given a negative sign, whereas the branch currents coming out are given a positive sign.</p>

<p>'''Step 2 '''</p>

<p>Use the BCE in terms of the node voltages of the circuit to eliminate as many branch currents as possible. Writing the BCE's in terms of the node voltages saves one step. If the BCE's were written in terms of the branch voltages, one more step, i.e., replacing the branches voltages for the node ones, would be necessary. In this article the letter "e" is used to name the node voltages, while the letter "v" is used to name the branch voltages.</p>

<p><strong>Step 3</strong></p>

<p>Finally, write down the unused equations.</p>
<h2 id="example">Example</h2>

<p>The figure shows a RC series circuit and the table shows the BCE of a linear resistor and a linear Capacitor. Note that in the case of the resistor the <a class="uri" href="admittance" title="wikilink">admittance</a> 

<math display="inline" id="Modified_nodal_analysis:0">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

 i, 

<math display="inline" id="Modified_nodal_analysis:1">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>R</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G=1/R
  </annotation>
 </semantics>
</math>

, is used instead of 

<math display="inline" id="Modified_nodal_analysis:2">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

. We now proceed as explained above.</p>
<figure><b>(Figure)</b>
<figcaption>RC Circuit</figcaption>
</figure>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Element</p></th>
<th style="text-align: left;">
<p>Branch equation</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Resistor</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Modified_nodal_analysis:3">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mi>R</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>G</mi>
    <msub>
     <mi>V</mi>
     <mi>R</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <ci>R</ci>
    </apply>
    <apply>
     <times></times>
     <ci>G</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <ci>R</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{R}=GV_{R}
  </annotation>
 </semantics>
</math>


</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Capacitor</p></td>
<td style="text-align: left;">
<p>

<math display="inline" id="Modified_nodal_analysis:4">
 <semantics>
  <mrow>
   <msub>
    <mi>I</mi>
    <mi>C</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>C</mi>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>V</mi>
       <mi>C</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>I</ci>
     <ci>C</ci>
    </apply>
    <apply>
     <times></times>
     <ci>C</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <ci>C</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{C}=C\frac{dV_{C}}{dt}
  </annotation>
 </semantics>
</math>

</p></td>
</tr>
</tbody>
</table>

<p><strong>Step 1</strong></p>

<p>In this case there are two nodes, 

<math display="inline" id="Modified_nodal_analysis:5">
 <semantics>
  <msub>
   <mi>e</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{1}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Modified_nodal_analysis:6">
 <semantics>
  <msub>
   <mi>e</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{2}
  </annotation>
 </semantics>
</math>

. Also there are <em>three</em> currents

<math display="block" id="Modified_nodal_analysis:7">
 <semantics>
  <msub>
   <mi>i</mi>
   <msub>
    <mi>V</mi>
    <mi>s</mi>
   </msub>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>i</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{V_{s}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Modified_nodal_analysis:8">
 <semantics>
  <msub>
   <mi>i</mi>
   <mi>R</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>i</ci>
    <ci>R</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{R}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Modified_nodal_analysis:9">
 <semantics>
  <msub>
   <mi>i</mi>
   <mi>C</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>i</ci>
    <ci>C</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{C}
  </annotation>
 </semantics>
</math>

.</p>

<p>At node <em>e1</em> the KCL yields:</p>

<p>

<math display="inline" id="Modified_nodal_analysis:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>i</mi>
     <msub>
      <mi>V</mi>
      <mi>s</mi>
     </msub>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>i</mi>
     <mi>R</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>i</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>i</ci>
      <ci>R</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i_{V_{s}}+i_{R}=0
  </annotation>
 </semantics>
</math>

</p>

<p>and at node <em>e2</em>:</p>

<p>

<math display="inline" id="Modified_nodal_analysis:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <msub>
      <mi>i</mi>
      <mi>R</mi>
     </msub>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>i</mi>
     <mi>C</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>i</ci>
       <ci>R</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>i</ci>
      <ci>C</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -i_{R}+i_{C}=0
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Step 2</strong></p>

<p>With the provided BCEs in the table and observing that:</p>

<p>

<math display="inline" id="Modified_nodal_analysis:12">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>e</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{s}=e_{1}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Modified_nodal_analysis:13">
 <semantics>
  <mrow>
   <msub>
    <mi>V</mi>
    <mi>R</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>e</mi>
     <mn>1</mn>
    </msub>
    <mo>-</mo>
    <msub>
     <mi>e</mi>
     <mn>2</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>R</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{R}=e_{1}-e_{2}
  </annotation>
 </semantics>
</math>


 

<math display="inline" id="Modified_nodal_analysis:14">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>V</mi>
     <mi>C</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>e</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>C</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V_{C}=e_{2},
  </annotation>
 </semantics>
</math>

</p>

<p>the following equations are the result:</p>

<p>

<math display="inline" id="Modified_nodal_analysis:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>e</mi>
        <mn>1</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>e</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>i</mi>
     <msub>
      <mi>V</mi>
      <mi>S</mi>
     </msub>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>G</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>i</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <ci>S</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(e_{1}-e_{2})+i_{V_{S}}=0
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Modified_nodal_analysis:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>C</mi>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <msub>
        <mi>e</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>e</mi>
        <mn>2</mn>
       </msub>
       <mo>-</mo>
       <msub>
        <mi>e</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>C</ci>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>e</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>G</ci>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C\frac{de_{2}}{dt}+G(e_{2}-e_{1})=0
  </annotation>
 </semantics>
</math>

</p>

<p><strong>Step 3</strong></p>

<p>Note that at this point there are two equations but three unknowns. The missing equation comes from the fact that</p>

<p>

<math display="inline" id="Modified_nodal_analysis:17">
 <semantics>
  <mrow>
   <msub>
    <mi>e</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>V</mi>
    <mi>s</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{1}=V_{s}
  </annotation>
 </semantics>
</math>

</p>

<p>and so finally we have three equations and three unknowns, that leads to a solvable linear system.</p>
<h3 id="modified-nodal-analysis-and-daes">Modified Nodal Analysis and DAEs</h3>

<p>If the vector 

<math display="inline" id="Modified_nodal_analysis:18">
 <semantics>
  <mrow>
   <mi>ùê±</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <msub>
         <mi>e</mi>
         <mn>1</mn>
        </msub>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>e</mi>
         <msub>
          <mo>;</mo>
          <mn>2</mn>
         </msub>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>i</mi>
         <msub>
          <mo>;</mo>
          <msub>
           <mi>V</mi>
           <mi>S</mi>
          </msub>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>ùê±</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <cn type="integer">1</cn>
       </apply>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">e</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-;</ci>
         <cn type="integer">2</cn>
        </apply>
       </cerror>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">i</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-;</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <ci>S</ci>
         </apply>
        </apply>
       </cerror>
      </matrixrow>
     </matrix>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{x}=\begin{pmatrix}e_{1}&e;_{2}&i;_{V_{S}}\end{pmatrix}^{T}
  </annotation>
 </semantics>
</math>


 is defined, then the above equations can be put in the form 

<math display="inline" id="Modified_nodal_analysis:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>E</mi>
      <msup>
       <mi>x</mi>
       <mo>‚Ä≤</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>A</mi>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi>f</mi>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>normal-‚Ä≤</ci>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>x</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Ex^{\prime}(t)+Ax(t)=f,
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Modified_nodal_analysis:20">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mi>G</mi>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mi>G</mi>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mi>G</mi>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mi>G</mi>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <matrix>
     <matrixrow>
      <ci>G</ci>
      <apply>
       <minus></minus>
       <ci>G</ci>
      </apply>
      <cn type="integer">1</cn>
     </matrixrow>
     <matrixrow>
      <apply>
       <minus></minus>
       <ci>G</ci>
      </apply>
      <ci>G</ci>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\begin{pmatrix}G&-G&1\\
-G&G&0\\
1&0&0\end{pmatrix}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Modified_nodal_analysis:21">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mi>C</mi>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>E</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <ci>C</ci>
      <cn type="integer">0</cn>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E=\begin{pmatrix}0&0&0\\
0&C&0\\
0&0&0\end{pmatrix}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Modified_nodal_analysis:22">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mtable>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mi>V</mi>
         <msub>
          <mo>;</mo>
          <mi>s</mi>
         </msub>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>f</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <cn type="integer">0</cn>
       <cn type="integer">0</cn>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">V</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>normal-;</ci>
         <ci>s</ci>
        </apply>
       </cerror>
      </matrixrow>
     </matrix>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f=\begin{pmatrix}0&0&V;_{s}\end{pmatrix}^{T}
  </annotation>
 </semantics>
</math>

.</p>

<p>This is a linear <a href="differential_algebraic_equation" title="wikilink">differential algebraic equation</a> (DAE), since 

<math display="inline" id="Modified_nodal_analysis:23">
 <semantics>
  <mi>E</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>E</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E
  </annotation>
 </semantics>
</math>


 is singular. It can be proved that such a DAE coming from the Modified Nodal Analysis will have <a href="differentiation_index" title="wikilink">differentiation index</a> less or equal than two as long as only passive RLC components are used.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> When using active components, such as <a href="operational_amplifiers" title="wikilink">operational amplifiers</a>, the differentiation index can be arbitrarily high.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="non-smooth-analysis">Non-smooth analysis</h2>

<p>DAEs assume <a href="smooth_function" title="wikilink">smooth</a> characteristics for individual components; for example, a <a class="uri" href="diode" title="wikilink">diode</a> can be modeled/represented in a MNA with DAEs via the <a href="Diode#Shockley_diode_equation" title="wikilink">Shockley equation</a>, but one cannot use an apparently simpler (more ideal) model where the <a href=":File:Diode_current_wiki.png" title="wikilink">sharply exponential forward and breakdown conduction regions of the curve</a> are just straight vertical lines. Circuit analysis (including MNA) with the latter kind of equations is actually more involved (than using DAEs) and is the topic of <a href="non-smooth_dynamical_system" title="wikilink">non-smooth dynamical systems</a> (NSDS) analysis, which relies on the theory of <a href="differential_inclusion" title="wikilink">differential inclusions</a>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Electronic_circuits" title="wikilink">Category:Electronic circuits</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2">Cheng, Chung-Kuan. Lecture Notes for CSE245: Computer-Aided Circuit Simulation and Verification. Spring 2006. Lecture 1.<a href="#fnref2">‚Ü©</a></li>
<li id="fn3">Tischendorf C. Topological index of DAEs in the Circuit Simulation.<a href="#fnref3">‚Ü©</a></li>
<li id="fn4"><a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
<li id="fn6"><a href="#fnref6">‚Ü©</a></li>
</ol>
</section>
</ref></hr></body>
</html>

   Ensemble Kalman filter      Ensemble Kalman filter   The ensemble Kalman filter (EnKF) is a recursive filter suitable for problems with a large number of variables, such as discretizations of partial differential equations in geophysical models. The EnKF originated as a version of the Kalman filter for large problems (essentially, the covariance matrix is replaced by the sample covariance ), and it is now an important data assimilation component of ensemble forecasting . EnKF is related to the particle filter (in this context, a particle is the same thing as ensemble member) but the EnKF makes the assumption that all probability distributions involved are Gaussian ; when it is applicable, it is much more efficient than the particle filter .  Introduction  The Ensemble Kalman Filter (EnKF) is a Monte Carlo implementation of the Bayesian update problem: given a probability density function (pdf) of the state of the modeled system (the prior , called often the forecast in geosciences) and the data likelihood, the Bayes theorem is used to obtain the pdf after the data likelihood has been taken into account (the posterior , often called the analysis). This is called a Bayesian update. The Bayesian update is combined with advancing the model in time, incorporating new data from time to time. The original Kalman Filter R. E. Kalman, A new approach to linear filtering and prediction problems , Transactions of the ASME -- Journal of Basic Engineering, Series D, 82 (1960), pp. 35--45.  assumes that all pdfs are Gaussian (the Gaussian assumption) and provides algebraic formulas for the change of the mean and the covariance matrix by the Bayesian update, as well as a formula for advancing the covariance matrix in time provided the system is linear. However, maintaining the covariance matrix is not feasible computationally for high-dimensional systems. For this reason, EnKFs were developed. G. Evensen, Sequential data assimilation with nonlinear quasi-geostrophic model using Monte Carlo methods to forecast error statistics , Journal of Geophysical Research, 99 (C5) (1994), pp. 143--162.  P. Houtekamer and H. L. Mitchell, Data assimilation using an ensemble Kalman filter technique , Monthly Weather Review, 126 (1998), pp. 796--811.  EnKFs represent the distribution of the system state using a collection of state vectors, called an ensemble , and replace the covariance matrix by the sample covariance computed from the ensemble. The ensemble is operated with as if it were a random sample , but the ensemble members are really not independent - the EnKF ties them together. One advantage of EnKFs is that advancing the pdf in time is achieved by simply advancing each member of the ensemble. For a survey of EnKF and related data assimilation techniques, see G. Evensen. 1  A derivation of the EnKF  The Kalman Filter  Let us review first the Kalman filter . Let   ğ±   ğ±   \mathbf{x}   denote the   n   n   n   -dimensional state vector of a model, and assume that it has Gaussian probability distribution with mean   Î¼   Î¼   \mathbf{\mu}   and covariance   Q   Q   Q   , i.e., its pdf is        p   (  ğ±  )    âˆ   exp   (   -    1  2     (   ğ±  -  Î¼   )   T    Q   -  1     (   ğ±  -  Î¼   )     )     .     proportional-to    p  ğ±           1  2    superscript    ğ±  Î¼   normal-T    superscript  Q    1      ğ±  Î¼        p(\mathbf{x})\propto\exp\left(-\frac{1}{2}(\mathbf{x}-\mathbf{\mu})^{\mathrm{T%
 }}Q^{-1}(\mathbf{x}-\mathbf{\mu})\right).     Here and below,   âˆ   proportional-to   \propto   means proportional; a pdf is always scaled so that its integral over the whole space is one. This    p   (  ğ±  )       p  ğ±    p(\mathbf{x})   , called the prior , was evolved in time by running the model and now is to be updated to account for new data. It is natural to assume that the error distribution of the data is known; data have to come with an error estimate, otherwise they are meaningless. Here, the data   ğ   ğ   \mathbf{d}   is assumed to have Gaussian pdf with covariance   R   R   R   and mean    H  ğ±      H  ğ±    H\mathbf{x}   , where   H   H   H   is the so-called observation matrix . The covariance matrix   R   R   R   describes the estimate of the error of the data; if the random errors in the entries of the data vector   ğ   ğ   \mathbf{d}   are independent,   R   R   R   is diagonal and its diagonal entries are the squares of the standard deviation (â€œerror sizeâ€) of the error of the corresponding entries of the data vector   ğ   ğ   \mathbf{d}   . The value    H  ğ±      H  ğ±    H\mathbf{x}   is what the value of the data would be for the state   ğ±   ğ±   \mathbf{x}   in the absence of data errors. Then the probability density    p   (  ğ  |  ğ±  )      fragments  p   fragments  normal-(  d  normal-|  x  normal-)     p(\mathbf{d}|\mathbf{x})   of the data   ğ   ğ   \mathbf{d}   conditional of the system state   ğ±   ğ±   \mathbf{x}   , called the data likelihood , is      p   (  ğ  |  ğ±  )   âˆ  exp   (  -   1  2     (  ğ  -  H  ğ±  )   T    R   -  1     (  ğ  -  H  ğ±  )   )   .     fragments  p   fragments  normal-(  d  normal-|  x  normal-)   proportional-to    fragments  normal-(     1  2    superscript   fragments  normal-(  d   H  x  normal-)   normal-T    superscript  R    1     fragments  normal-(  d   H  x  normal-)   normal-)   normal-.    p\left(\mathbf{d}|\mathbf{x}\right)\propto\exp\left(-\frac{1}{2}(\mathbf{d}-H%
 \mathbf{x})^{\mathrm{T}}R^{-1}(\mathbf{d}-H\mathbf{x})\right).     The pdf of the state and the data likelihood are combined to give the new probability density of the system state   ğ±   ğ±   \mathbf{x}   conditional on the value of the data   ğ   ğ   \mathbf{d}   (the '' posterior'' ) by the Bayes theorem ,      p   (  ğ±  |  ğ  )   âˆ  p   (  ğ  |  ğ±  )   p   (  ğ±  )   .     fragments  p   fragments  normal-(  x  normal-|  d  normal-)   proportional-to  p   fragments  normal-(  d  normal-|  x  normal-)   p   fragments  normal-(  x  normal-)   normal-.    p\left(\mathbf{x}|\mathbf{d}\right)\propto p\left(\mathbf{d}|\mathbf{x}\right)%
 p(\mathbf{x}).     The data   ğ   ğ   \mathbf{d}   is fixed once it is received, so denote the posterior state by    ğ±  ^     normal-^  ğ±    \mathbf{\hat{x}}   instead of    ğ±  |  ğ     fragments  x  normal-|  d    \mathbf{x}|\mathbf{d}   and the posterior pdf by    p   (   ğ±  ^   )       p   normal-^  ğ±     p\left(\mathbf{\hat{x}}\right)   . It can be shown by algebraic manipulations B. D. O. Anderson and J. B. Moore, Optimal filtering , Prentice-Hall, Englewood Cliffs, N.J., 1979.  that the posterior pdf is also Gaussian,        p   (   ğ±  ^   )    âˆ   exp   (   -    1  2     (    ğ±  ^   -   Î¼  ^    )   T     Q  ^    -  1     (    ğ±  ^   -   Î¼  ^    )     )     ,     proportional-to    p   normal-^  ğ±            1  2    superscript     normal-^  ğ±    normal-^  Î¼    normal-T    superscript   normal-^  Q     1       normal-^  ğ±    normal-^  Î¼         p\left(\mathbf{\hat{x}}\right)\propto\exp\left(-\frac{1}{2}(\mathbf{\hat{x}}-%
 \mathbf{\hat{\mu}})^{\mathrm{T}}\hat{Q}^{-1}(\mathbf{\hat{x}}-\mathbf{\hat{\mu%
 }})\right),     with the posterior mean    Î¼  ^     normal-^  Î¼    \mathbf{\hat{\mu}}   and covariance    Q  ^     normal-^  Q    \hat{Q}   given by the Kalman update formulas         Î¼  ^   =   Î¼  +   K   (   ğ  -   H  Î¼    )      ,    Q  ^   =    (   I  -   K  H    )   Q     ,     formulae-sequence     normal-^  Î¼     Î¼    K    ğ    H  Î¼          normal-^  Q       I    K  H    Q      \mathbf{\hat{\mu}}=\mathbf{\mu}+K\left(\mathbf{d}-H\mathbf{\mu}\right),\quad%
 \hat{Q}=\left(I-KH\right)Q,     where      K  =   Q   H  T     (    H  Q   H  T    +  R   )    -  1         K    Q   superscript  H  normal-T    superscript      H  Q   superscript  H  normal-T    R     1       K=QH^{\mathrm{T}}\left(HQH^{\mathrm{T}}+R\right)^{-1}     is the so-called Kalman gain matrix.  The Ensemble Kalman Filter  The EnKF is a Monte Carlo approximation of the Kalman filter, which avoids evolving the covariance matrix of the pdf of the state vector   ğ±   ğ±   \mathbf{x}   . Instead, the pdf is represented by an ensemble       X  =   [   ğ±  1   ,  â€¦  ,   ğ±  N   ]   =   [   ğ±  i   ]    .        X    subscript  ğ±  1   normal-â€¦   subscript  ğ±  N          delimited-[]   subscript  ğ±  i       X=\left[\mathbf{x}_{1},\ldots,\mathbf{x}_{N}\right]=\left[\mathbf{x}_{i}\right].      X   X   X   is an    n  Ã—  N      n  N    n\times N   matrix whose columns are the ensemble members, and it is called the prior ensemble . Ideally, ensemble members would form a sample from the prior distribution. However, the ensemble members are not in general independent except in the initial ensemble, since every EnKF step ties them together. They are deemed to be approximately independent, and all calculations proceed as if they actually were independent.  Replicate the data   ğ   ğ   \mathbf{d}   into an    m  Ã—  N      m  N    m\times N   matrix        D  =   [   ğ  1   ,  â€¦  ,   ğ  N   ]   =   [   ğ  i   ]    ,     ğ  i   =   ğ  +   Ïµ  ğ¢     ,    Ïµ  ğ¢   =   N   (  0  ,  R  )       ,     formulae-sequence      D    subscript  ğ  1   normal-â€¦   subscript  ğ  N          delimited-[]   subscript  ğ  i       formulae-sequence     subscript  ğ  i     ğ   subscript  Ïµ  ğ¢        subscript  Ïµ  ğ¢     N   0  R        D=\left[\mathbf{d}_{1},\ldots,\mathbf{d}_{N}\right]=\left[\mathbf{d}_{i}\right%
 ],\quad\mathbf{d}_{i}=\mathbf{d}+\mathbf{\epsilon_{i}},\quad\mathbf{\epsilon_{%
 i}}=N(0,R),     so that each column    ğ  i     subscript  ğ  i    \mathbf{d}_{i}   consists of the data vector   ğ   ğ   \mathbf{d}   plus a random vector from the   m   m   m   -dimensional normal distribution    N   (  0  ,  R  )       N   0  R     N(0,R)   . If, in addition, the columns of   X   X   X   are a sample from the prior probability distribution, then the columns of       X  ^   =   X  +   K   (   D  -   H  X    )          normal-^  X     X    K    D    H  X        \hat{X}=X+K(D-HX)     form a sample from the posterior probability distribution. [To see this in the scalar case with    H  =  1      H  1    H=1   : Let      x  i   =   Î¼  +   Î¾  i     ,    Î¾  i   âˆ¼   N   (  0  ,   Ïƒ  x  2   )        formulae-sequence     subscript  x  i     Î¼   subscript  Î¾  i      similar-to   subscript  Î¾  i     N   0   superscript   subscript  Ïƒ  x   2        x_{i}=\mu+\xi_{i},\;\xi_{i}\sim N(0,\sigma_{x}^{2})   , and       d  i   =   d  +   Ïµ  i     ,    Ïµ  i   âˆ¼   N   (  0  ,   Ïƒ  d  2   )      .     formulae-sequence     subscript  d  i     d   subscript  Ïµ  i      similar-to   subscript  Ïµ  i     N   0   superscript   subscript  Ïƒ  d   2        d_{i}=d+\epsilon_{i},\;\epsilon_{i}\sim N(0,\sigma_{d}^{2}).   Then      x  ^   i   =    (      1  /   Ïƒ  x  2      1  /   Ïƒ  x  2    +   1  /   Ïƒ  d  2      Î¼   +     1  /   Ïƒ  d  2      1  /   Ïƒ  x  2    +   1  /   Ïƒ  d  2      d    )   +   (      1  /   Ïƒ  x  2      1  /   Ïƒ  x  2    +   1  /   Ïƒ  d  2       Î¾  i    +     1  /   Ïƒ  d  2      1  /   Ïƒ  x  2    +   1  /   Ïƒ  d  2       Ïµ  i     )         subscript   normal-^  x   i             1   superscript   subscript  Ïƒ  x   2        1   superscript   subscript  Ïƒ  x   2      1   superscript   subscript  Ïƒ  d   2      Î¼         1   superscript   subscript  Ïƒ  d   2        1   superscript   subscript  Ïƒ  x   2      1   superscript   subscript  Ïƒ  d   2      d            1   superscript   subscript  Ïƒ  x   2        1   superscript   subscript  Ïƒ  x   2      1   superscript   subscript  Ïƒ  d   2       subscript  Î¾  i          1   superscript   subscript  Ïƒ  d   2        1   superscript   subscript  Ïƒ  x   2      1   superscript   subscript  Ïƒ  d   2       subscript  Ïµ  i        \hat{x}_{i}=\left(\frac{1/\sigma_{x}^{2}}{1/\sigma_{x}^{2}+1/\sigma_{d}^{2}}%
 \mu+\frac{1/\sigma_{d}^{2}}{1/\sigma_{x}^{2}+1/\sigma_{d}^{2}}d\right)+\left(%
 \frac{1/\sigma_{x}^{2}}{1/\sigma_{x}^{2}+1/\sigma_{d}^{2}}\xi_{i}+\frac{1/%
 \sigma_{d}^{2}}{1/\sigma_{x}^{2}+1/\sigma_{d}^{2}}\epsilon_{i}\right)   . The first sum is the posterior mean, and the second sum, in view of the independence, has a variance        (    1  /   Ïƒ  x  2      1  /   Ïƒ  x  2    +   1  /   Ïƒ  d  2      )   2    Ïƒ  x  2    +     (    1  /   Ïƒ  d  2      1  /   Ïƒ  x  2    +   1  /   Ïƒ  d  2      )   2    Ïƒ  d  2     =   1    1  /   Ïƒ  x  2    +   1  /   Ïƒ  d  2               superscript      1   superscript   subscript  Ïƒ  x   2        1   superscript   subscript  Ïƒ  x   2      1   superscript   subscript  Ïƒ  d   2      2    superscript   subscript  Ïƒ  x   2       superscript      1   superscript   subscript  Ïƒ  d   2        1   superscript   subscript  Ïƒ  x   2      1   superscript   subscript  Ïƒ  d   2      2    superscript   subscript  Ïƒ  d   2       1      1   superscript   subscript  Ïƒ  x   2      1   superscript   subscript  Ïƒ  d   2        \left(\frac{1/\sigma_{x}^{2}}{1/\sigma_{x}^{2}+1/\sigma_{d}^{2}}\right)^{2}%
 \sigma_{x}^{2}+\left(\frac{1/\sigma_{d}^{2}}{1/\sigma_{x}^{2}+1/\sigma_{d}^{2}%
 }\right)^{2}\sigma_{d}^{2}=\frac{1}{1/\sigma_{x}^{2}+1/\sigma_{d}^{2}}   , which is the posterior variance. ]  The EnKF is now obtained C. J. Johns and J. Mandel, A two-stage ensemble Kalman filter for smooth data assimilation . Environmental and Ecological Statistics, in print. Special issue, Conference on New Developments of Statistical Analysis in Wildlife, Fisheries, and Ecological Research, Oct 13-16, 2004, Columbia, MI. CCM Report 221, University of Colorado at Denver and Health Sciences Center, 2005. report  simply by replacing the state covariance   Q   Q   Q   in Kalman gain matrix   K   K   K   by the sample covariance   C   C   C   computed from the ensemble members (called the ensemble covariance ). That is    K  =   C   H  T     (    H  C   H  T    +  R   )    -  1         K    C   superscript  H  normal-T    superscript      H  C   superscript  H  normal-T    R     1       K=CH^{\mathrm{T}}\left(HCH^{\mathrm{T}}+R\right)^{-1}     Implementation  Basic formulation  Here we follow. G. Burgers, P. J. van Leeuwen, and G. Evensen, Analysis scheme in the ensemble Kalman filter , Monthly Weather Review, 126 (1998), pp. 1719--1724.  G. Evensen, The ensemble Kalman filter: Theoretical formulation and practical implementation , Ocean Dynamics, 53 (2003), pp. 343--367.  Suppose the ensemble matrix   X   X   X   and the data matrix   D   D   D   are as above. The ensemble mean and the covariance are         E   (  X  )    =    1  N     âˆ‘   k  =  1   N    ğ±  k      ,   C  =    A   A  T     N  -  1      ,     formulae-sequence      E  X       1  N     superscript   subscript     k  1    N    subscript  ğ±  k        C      A   superscript  A  T      N  1       E\left(X\right)=\frac{1}{N}\sum_{k=1}^{N}\mathbf{x}_{k},\quad C=\frac{AA^{T}}{%
 N-1},     where       A  =   X  -   E   (  X  )    ğ   1  Ã—  N      =   X  -    1  N    (   X   ğ   N  Ã—  1     )    ğ   1  Ã—  N       ,        A    X    E  X   subscript  ğ    1  N             X      1  N     X   subscript  ğ    N  1      subscript  ğ    1  N         A=X-E\left(X\right)\mathbf{e}_{1\times N}=X-\frac{1}{N}\left(X\mathbf{e}_{N%
 \times 1}\right)\mathbf{e}_{1\times N},     and   ğ   ğ   \mathbf{e}   denotes the matrix of all ones of the indicated size.  The posterior ensemble    X  p     superscript  X  p    X^{p}   is then given by        X  p   =   X  +   C   H  T     (    H  C   H  T    +  R   )    -  1     (   D  -   H  X    )      ,       superscript  X  p     X    C   superscript  H  T    superscript      H  C   superscript  H  T    R     1      D    H  X        X^{p}=X+CH^{T}\left(HCH^{T}+R\right)^{-1}(D-HX),     where the perturbed data matrix   D   D   D   is as above.  Note that since   R   R   R   is a covariance matrix, it is always positive semidefinite and usually positive definite , so the inverse above exists and the formula can be implemented by the Cholesky decomposition . J. Mandel, Efficient implementation of the ensemble Kalman filter . CCM Report 231, University of Colorado at Denver and Health Sciences Center. link , June 2006.  In, 2 3    R   R   R   is replaced by the sample covariance      D  ~     D  ~   T    /   (   N  -  1   )          normal-~  D    superscript   normal-~  D   T      N  1     \tilde{D}\tilde{D}^{T}/\left(N-1\right)   where     D  ~   =   D  -    1  N    d    ğ   1  Ã—  N           normal-~  D     D      1  N   d   subscript  ğ    1  N        \tilde{D}=D-\frac{1}{N}d\,\mathbf{e}_{1\times N}   and the inverse is replaced by a pseudoinverse , computed using the Singular Value Decomposition (SVD) .  Since these formulas are matrix operations with dominant Level 3 operations, G. H. Golub and C. F. V. Loan, Matrix Computations , Johns Hopkins Univ. Press, 1989. Second Edition.  they are suitable for efficient implementation using software packages such as LAPACK (on serial and shared memory computers) and ScaLAPACK (on distributed memory computers). 4 Instead of computing the inverse of a matrix and multiplying by it, it is much better (several times cheaper and also more accurate) to compute the Cholesky decomposition of the matrix and treat the multiplication by the inverse as solution of a linear system with many simultaneous right-hand sides. 5  Observation matrix-free implementation  Since we have replaced the covariance matrix with ensemble covariance, this leads to a simpler formula where ensemble observations are directly used without explicitly specifying the matrix   H   H   H   . More specifically, define a function    h   (  ğ±  )       h  ğ±    h(\mathbf{x})   of the form        h   (  ğ±  )    =   H  ğ±    .        h  ğ±     H  ğ±     h(\mathbf{x})=H\mathbf{x}.     The function   h   h   h   is called the observation function or, in the inverse problems context, the forward operator . The value of    h   (  ğ±  )       h  ğ±    h(\mathbf{x})   is what the value of the data would be for the state   ğ±   ğ±   \mathbf{x}   assuming the measurement is exact. Then the posterior ensemble can be rewritten as       X  p   =   X  +    1   N  -  1    A    (   H  A   )   T    P   -  1     (   D  -   H  X    )          superscript  X  p     X      1    N  1    A   superscript    H  A   T    superscript  P    1      D    H  X        X^{p}=X+\frac{1}{N-1}A\left(HA\right)^{T}P^{-1}(D-HX)     where        H  A   =    H  X   -    1  N    (    (   H  X   )    ğ   N  Ã—  1     )    ğ   1  Ã—  N       ,        H  A       H  X       1  N       H  X    subscript  ğ    N  1      subscript  ğ    1  N        HA=HX-\frac{1}{N}\left(\left(HX\right)\mathbf{e}_{N\times 1}\right)\mathbf{e}_%
 {1\times N},     and       P  =     1   N  -  1    H  A    (   H  A   )   T    +  R    ,      P        1    N  1    H  A   superscript    H  A   T    R     P=\frac{1}{N-1}HA\left(HA\right)^{T}+R,     with         [   H  A   ]   i   =    H   ğ±  i    -   H   1  N     âˆ‘   j  =  1   N     ğ±  j       =    h   (   ğ±  i   )    -    1  N     âˆ‘   j  =  1   N    h   (   ğ±  j   )        .         subscript   delimited-[]    H  A    i       H   subscript  ğ±  i      H    1  N     superscript   subscript     j  1    N    subscript  ğ±  j               h   subscript  ğ±  i        1  N     superscript   subscript     j  1    N     h   subscript  ğ±  j          \left[HA\right]_{i}=H\mathbf{x}_{i}-H\frac{1}{N}\sum_{j=1}^{N}\mathbf{x}_{j}\ %
 =h\left(\mathbf{x}_{i}\right)-\frac{1}{N}\sum_{j=1}^{N}h\left(\mathbf{x}_{j}%
 \right).     Consequently, the ensemble update can be computed by evaluating the observation function   h   h   h   on each ensemble member once and the matrix   H   H   H   does not need to be known explicitly. This formula holds also 6 for an observation function     h   (  ğ±  )    =    H  ğ±   +  ğŸ         h  ğ±       H  ğ±   ğŸ     h(\mathbf{x})=H\mathbf{x+f}   with a fixed offset   ğŸ   ğŸ   \mathbf{f}   , which also does not need to be known explicitly. The above formula has been commonly used for a nonlinear observation function   h   h   h   , such as the position of a hurricane  vortex . Y. Chen and C. Snyder, Assimilating vortex position with an ensemble Kalman filter . Monthly Weather Review, to appear, 2006. preprint .  In that case, the observation function is essentially approximated by a linear function from its values at ensemble members.  Implementation for a large number of data points  For a large number   m   m   m   of data points, the multiplication by    P   -  1      superscript  P    1     P^{-1}   becomes a bottleneck. The following alternative formula is advantageous when the number of data points   m   m   m   is large (such as when assimilating gridded or pixel data) and the data error covariance matrix    R   R   R   is diagonal (which is the case when the data errors are uncorrelated), or cheap to decompose (such as banded due to limited covariance distance). Using the Shermanâ€“Morrisonâ€“Woodbury formula W. W. Hager, Updating the inverse of a matrix , SIAM Rev., 31 (1989), pp. 221--239.          (   R  +   U   V  T     )    -  1    =    R   -  1    -    R   -  1    U    (   I  +    V  T    R   -  1    U    )    -  1     V  T    R   -  1       ,       superscript    R    U   superscript  V  T       1       superscript  R    1       superscript  R    1    U   superscript    I     superscript  V  T    superscript  R    1    U      1     superscript  V  T    superscript  R    1        (R+UV^{T})^{-1}=R^{-1}-R^{-1}U(I+V^{T}R^{-1}U)^{-1}V^{T}R^{-1},     with        U  =    1   N  -  1    H  A    ,   V  =   H  A     ,     formulae-sequence    U      1    N  1    H  A      V    H  A      U=\frac{1}{N-1}HA,\quad V=HA,     gives      P   -  1      superscript  P    1     \displaystyle P^{-1}     which requires only the solution of systems with the matrix   R   R   R   (assumed to be cheap) and of a system of size   N   N   N   with   m   m   m   right-hand sides. See 7 for operation counts.  Further extensions  The EnKF version described here involves randomization of data. For filters without randomization of data, see. J. L. Anderson, An ensemble adjustment Kalman filter for data assimilation , Monthly Weather Review, 129 (2001), pp. 2884--2903.  G. Evensen, Sampling strategies and square root analysis schemes for the EnKF , Ocean Dynamics, 54 (2004), pp. 539--560.  M. K. Tippett, J. L. Anderson, C. H. Bishop, T. M. Hamill, and J. S. Whitaker, Ensemble square root filters , Monthly Weather Review, 131 (2003), pp. 1485--1490.   Since the ensemble covariance is rank deficient (there are many more state variables, typically millions, than the ensemble members, typically less than a hundred), it has large terms for pairs of points that are spatially distant. Since in reality the values of physical fields at distant locations are not that much correlated , the covariance matrix is tapered off artificially based on the distance, which gives rise to localized EnKF algorithms. 8 9 These methods modify the covariance matrix used in the computations and, consequently, the posterior ensemble is no longer made only of linear combinations of the prior ensemble.  For nonlinear problems, EnKF can create posterior ensemble with non-physical states. This can be alleviated by regularization , such as penalization of states with large spatial gradients . 10  For problems with coherent features , such as hurricanes , thunderstorms , firelines , squall lines , and rain fronts , there is a need to adjust the numerical model state by deforming the state in space (its grid) as well as by correcting the state amplitudes additively. In Data Assimilation by Field Alignment, 11 Ravela et al. introduce the joint position-amplitude adjustment model using ensembles, and systematically derive a sequential approximation which can be applied to both EnKF and other formulations. Their method does not make the assumption that amplitudes and position errors are independent or jointly Gaussian, as others do. The morphing EnKF J. D. Beezley and J. Mandel, Morphing ensemble Kalman filters . Tellus (2008) 60A, 131-140. report .  J. Mandel and J. D. Beezley, Predictor-corrector and morphing ensemble filters for the assimilation of sparse data into high dimensional nonlinear systems . CCM Report 239, University of Colorado at Denver and Health Sciences Center. report , November 2006. 11th Symposium on Integrated Observing and Assimilation Systems for the Atmosphere, Oceans, and Land Surface (IOAS-AOLS), CD-ROM, Paper 4.12, 87th American Meteorological Society Annual Meeting, San Antonio, TX, January 2007, link .  employs intermediate states, obtained by techniques borrowed from image registration and morphing , instead of linear combinations of states.  EnKFs rely on the Gaussian assumption, though they are of course used in practice for nonlinear problems, where the Gaussian assumption may not be satisfied. Related filters attempting to relax the Gaussian assumption in EnKF while preserving its advantages include filters that fit the state pdf with multiple Gaussian kernels, J. L. Anderson and S. L. Anderson, A Monte Carlo implementation of the nonlinear filtering problem to produce ensemble assimilations and forecasts , Monthly Weather Review, 127 (1999), pp. 2741--2758.  filters that approximate the state pdf by Gaussian mixtures , T. Bengtsson, C. Snyder, and D. Nychka, Toward a nonlinear ensemble filter for high dimensional systems , Journal of Geophysical Research - Atmospheres, 108(D24) (2003), pp. STS 2--1--10. preprint .  a variant of the particle filter with computation of particle weights by density estimation , 12 and a variant of the particle filter with thick tailed data pdf to alleviate particle filter degeneracy . 13  See also   Data assimilation  Kalman filter  Numerical weather prediction#Ensembles  Particle filter  Recursive Bayesian estimation   References  External links   EnKF webpage  TOPAZ, real-time forecasting of the North Atlantic ocean and Arctic sea-ice with the EnKF  EnKF-C, a light-weight framework for data assimilation into large-scale layered geophysical models with the EnKF  PDAF, an open-source framework for data assimilation providing different variants of the EnKF   "  Category:Linear filters  Category:Nonlinear filters  Category:Bayesian statistics  Category:Estimation theory  Category:Monte Carlo methods     G. Evensen, ''Data assimilation : The ensemble Kalman filter, Springer, Berlin, 2007. â†©        J. L. Anderson, A local least squares framework for ensemble filtering , Monthly Weather Review, 131 (2003), pp. 634--642. â†©  E. Ott, B. R. Hunt, I. Szunyogh, A. V. Zimin, E. J. Kostelich, M. Corazza, E. Kalnay, D. Patil, and J. A. Yorke, A local ensemble Kalman filter for atmospheric data assimilation , Tellus A, 56 (2004), pp. 415--428. â†©   S. Ravela, K. Emanuel and D. McLaughlin, "Data Assimilation by Field Alignment". Physica(D), Volume 230, Issues 1â€“2, June 2007, Pages 127â€“145 â†©   P. van Leeuwen, A variance-minimizing filter for large-scale applications , Monthly Weather Review, 131 (2003), pp. 2071--2084. â†©     
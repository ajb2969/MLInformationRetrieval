<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1906">KASUMI</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>KASUMI</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p><strong>KASUMI</strong> is a <a href="block_cipher" title="wikilink">block cipher</a> used in <a class="uri" href="UMTS" title="wikilink">UMTS</a>, <a class="uri" href="GSM" title="wikilink">GSM</a>, and <a class="uri" href="GPRS" title="wikilink">GPRS</a> <a href="mobile_phone" title="wikilink">mobile communications</a> systems. In UMTS, KASUMI is used in the <a class="uri" href="confidentiality" title="wikilink">confidentiality</a> (<em>f8</em>) and <a href="Data_integrity" title="wikilink">integrity</a> algorithms (<em>f9</em>) with names UEA1 and UIA1, respectively.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> In GSM, KASUMI is used in the <strong>A5/3</strong> key stream generator and in GPRS in the <strong>GEA3</strong> key stream generator.</p>

<p>KASUMI was designed for <a class="uri" href="3GPP" title="wikilink">3GPP</a> to be used in UMTS security system by the <a href="Security_Algorithms_Group_of_Experts" title="wikilink">Security Algorithms Group of Experts</a> (SAGE), a part of the European standards body <a class="uri" href="ETSI" title="wikilink">ETSI</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> Because of schedule pressures in 3GPP standardization, instead of developing a new cipher, SAGE agreed with 3GPP technical specification group (TSG) for system aspects of 3G security (SA3) to base the development on an existing algorithm that had already undergone some evaluation.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> They chose the cipher algorithm <a class="uri" href="MISTY1" title="wikilink">MISTY1</a> developed<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> and patented<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> by <a href="Mitsubishi_Electric_Corporation" title="wikilink">Mitsubishi Electric Corporation</a>. The original algorithm was slightly modified for easier hardware implementation and to meet other requirements set for 3G mobile communications security.</p>

<p>KASUMI is named after the original algorithm <a class="uri" href="MISTY1" title="wikilink">MISTY1</a> — <a href="wikt:en:霞み#Japanese" title="wikilink">霞み</a> (hiragana <a href="wikt:en:かすみ#Japanese" title="wikilink">かすみ</a>, romaji <em><a href="wikt:en:kasumi#Japanese" title="wikilink">kasumi</a></em>) is the <a href="Japanese_language" title="wikilink">Japanese</a> word for "mist".</p>

<p>In January 2010, Orr Dunkelman, Nathan Keller and Adi Shamir released a paper showing that they could break Kasumi with a <a href="related_key_attack" title="wikilink">related key attack</a> and very modest computational resources. Interestingly, the attack is ineffective against <a class="uri" href="MISTY1" title="wikilink">MISTY1</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="description">Description</h2>

<p>KASUMI algorithm is specified in a 3GPP technical specification.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> KASUMI is a block cipher with 128-bit key and 64-bit input and output. The core of KASUMI is an eight-round <a href="Feistel_network" title="wikilink">Feistel network</a>. The round functions in the main Feistel network are irreversible Feistel-like network transformations. In each round the round function uses a round key which consists of eight 16-bit sub keys derived from the original 128-bit key using a fixed key schedule.</p>
<h3 id="key-schedule">Key schedule</h3>

<p>The 128-bit key <em>K</em> is divided into eight 16-bit sub keys <em>K<sub>i</sub></em>:</p>

<p>

<math display="inline" id="KASUMI:0">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>=</mo>
   <msub>
    <mi>K</mi>
    <mn>1</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>K</mi>
    <mn>2</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>K</mi>
    <mn>3</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>K</mi>
    <mn>4</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>K</mi>
    <mn>5</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>K</mi>
    <mn>6</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>K</mi>
    <mn>7</mn>
   </msub>
   <mo>∥</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>K</mi>
     <mn>8</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">K</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">1</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">2</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">3</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">4</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">5</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">6</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">7</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <cn type="integer">8</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K=K_{1}\|K_{2}\|K_{3}\|K_{4}\|K_{5}\|K_{6}\|K_{7}\|K_{8}\,
  </annotation>
 </semantics>
</math>

</p>

<p>Additionally a modified key <em>K</em>', similarly divided into 16-bit sub keys <em>K'<sub>i</sub></em>, is used. The modified key is derived from the original key by XORing with 0x123456789ABCDEFFEDCBA9876543210 (chosen as a <a href="Nothing_up_my_sleeve_number" title="wikilink">"nothing up my sleeve" number</a>).</p>

<p>Round keys are either derived from the sub keys by bitwise rotation to left by a given amount and from the modified sub keys (unchanged).</p>

<p>The round keys are as follows:</p>

<p>

<math display="inline" id="KASUMI:1">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>ROL</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>K</mi>
        <mi>i</mi>
       </msub>
       <mo>,</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>L</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <msubsup>
      <mi>K</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>2</mn>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>O</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>ROL</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>K</mi>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo>,</mo>
       <mn>5</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>O</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>ROL</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>K</mi>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>5</mn>
        </mrow>
       </msub>
       <mo>,</mo>
       <mn>8</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>O</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>3</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>ROL</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>K</mi>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>6</mn>
        </mrow>
       </msub>
       <mo>,</mo>
       <mn>13</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>I</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <msubsup>
      <mi>K</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>4</mn>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>I</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <msubsup>
      <mi>K</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>3</mn>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>I</mi>
       <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mn>3</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <msubsup>
      <mi>K</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>7</mn>
      </mrow>
      <mo>′</mo>
     </msubsup>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ROL</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">1</cn>
      </interval>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">2</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>K</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ROL</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">5</cn>
      </interval>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">2</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ROL</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">5</cn>
        </apply>
       </apply>
       <cn type="integer">8</cn>
      </interval>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">3</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>ROL</ci>
      <interval closure="open">
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>K</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
       <cn type="integer">13</cn>
      </interval>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>K</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">2</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>K</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <list>
        <ci>i</ci>
        <cn type="integer">3</cn>
       </list>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>K</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">7</cn>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}KL_{i,1}&=&{\rm ROL}(K_{i},1)\\
KL_{i,2}&=&K^{\prime}_{i+2}\\
KO_{i,1}&=&{\rm ROL}(K_{i+1},5)\\
KO_{i,2}&=&{\rm ROL}(K_{i+5},8)\\
KO_{i,3}&=&{\rm ROL}(K_{i+6},13)\\
KI_{i,1}&=&K^{\prime}_{i+4}\\
KI_{i,2}&=&K^{\prime}_{i+3}\\
KI_{i,3}&=&K^{\prime}_{i+7}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Sub key index additions are cyclic so that if <em>i+j</em> is greater than 8 one has to subtract 8 from the result to get the actual sub key index.</p>
<h3 id="the-algorithm">The algorithm</h3>

<p>KASUMI algorithm processes the 64-bit word in two 32-bit halves, left (

<math display="inline" id="KASUMI:2">
 <semantics>
  <msub>
   <mi>L</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>L</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L_{i}
  </annotation>
 </semantics>
</math>

) and right (

<math display="inline" id="KASUMI:3">
 <semantics>
  <msub>
   <mi>R</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{i}
  </annotation>
 </semantics>
</math>

). The input word is concatenation of the left and right halves of the first round:</p>

<p>

<math display="inline" id="KASUMI:4">
 <semantics>
  <mrow>
   <mi>input</mi>
   <mo>=</mo>
   <msub>
    <mi>R</mi>
    <mn>0</mn>
   </msub>
   <mo>∥</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>L</mi>
     <mn>0</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">input</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">0</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <cn type="integer">0</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm input}=R_{0}\|L_{0}\,
  </annotation>
 </semantics>
</math>


.</p>

<p>In each round the right half is XOR'ed with the output of the round function after which the halves are swapped:</p>

<p>

<math display="inline" id="KASUMI:5">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="right">
     <msub>
      <mi>L</mi>
      <mi>i</mi>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <msub>
        <mi>F</mi>
        <mi>i</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>K</mi>
         <msub>
          <mi>L</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>K</mi>
         <msub>
          <mi>O</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mi>K</mi>
         <msub>
          <mi>I</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>,</mo>
        <msub>
         <mi>L</mi>
         <mrow>
          <mi>i</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⊕</mo>
      <msub>
       <mi>R</mi>
       <mrow>
        <mi>i</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="right">
     <msub>
      <mi>R</mi>
      <mi>i</mi>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>i</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">direct-sum</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>F</ci>
        <ci>i</ci>
       </apply>
       <vector>
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>O</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </vector>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>i</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <apply>
       <minus></minus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}L_{i}&=&F_{i}(KL_{i},KO_{i},KI_{i},L_{i-1})\oplus R_{i-1}%
\\
R_{i}&=&L_{i-1}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>KL<sub>i</sub></em>, <em>KO<sub>i</sub></em>, <em>KI<sub>i</sub></em> are round keys for the <em>i</em><sup>th</sup> round.</p>

<p>The round functions for even and odd rounds are slightly different. In each case the round function is a composition of two functions <em>FL<sub>i</sub></em> and <em>FO<sub>i</sub></em>. For an odd round</p>

<p>

<math display="inline" id="KASUMI:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>F</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>K</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>F</mi>
    <mi>O</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>O</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>I</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>F</mi>
      <mi>L</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>K</mi>
        <msub>
         <mi>L</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>,</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>i</ci>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>F</ci>
     <ci>O</ci>
     <vector>
      <apply>
       <times></times>
       <ci>K</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>O</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>K</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>F</ci>
       <ci>L</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </interval>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{i}(K_{i},L_{i-1})=FO(KO_{i},KI_{i},FL(KL_{i},L_{i-1}))\,
  </annotation>
 </semantics>
</math>

</p>

<p>and for an even round</p>

<p>

<math display="inline" id="KASUMI:7">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>F</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>K</mi>
      <mi>i</mi>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>L</mi>
      <mrow>
       <mi>i</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>F</mi>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>K</mi>
      <msub>
       <mi>L</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>F</mi>
      <mi>O</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>K</mi>
        <msub>
         <mi>O</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>K</mi>
        <msub>
         <mi>I</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>,</mo>
       <msub>
        <mi>L</mi>
        <mrow>
         <mi>i</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>i</ci>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>K</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <apply>
        <minus></minus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </interval>
    </apply>
    <apply>
     <times></times>
     <ci>F</ci>
     <ci>L</ci>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>K</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>F</ci>
       <ci>O</ci>
       <vector>
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>O</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <apply>
          <minus></minus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </vector>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{i}(K_{i},L_{i-1})=FL(KL_{i},FO(KO_{i},KI_{i},L_{i-1}))\,
  </annotation>
 </semantics>
</math>

.</p>

<p>The output is the concatenation of the outputs of the last round.</p>

<p>

<math display="inline" id="KASUMI:8">
 <semantics>
  <mrow>
   <mi>output</mi>
   <mo>=</mo>
   <msub>
    <mi>R</mi>
    <mn>8</mn>
   </msub>
   <mo>∥</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>L</mi>
     <mn>8</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">output</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <cn type="integer">8</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <cn type="integer">8</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\rm output}=R_{8}\|L_{8}\,
  </annotation>
 </semantics>
</math>

.</p>

<p>Both <em>FL</em> and <em>FO</em> functions divide the 32-bit input data to two 16-bit halves. The <em>FL</em> function is an irreversible bit manipulation while the <em>FO</em> function is an irreversible three round Feistel-like network.</p>
<h4 id="function-fl">Function FL</h4>

<p>The 32-bit input <em>x</em> of 

<math display="inline" id="KASUMI:9">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mi>L</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>K</mi>
     <msub>
      <mi>L</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <ci>L</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <ci>x</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   FL(KL_{i},x)
  </annotation>
 </semantics>
</math>


 is divided to two 16-bit halves 

<math display="inline" id="KASUMI:10">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mi>l</mi>
   <mo>∥</mo>
   <mi>r</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">x</csymbol>
    <eq></eq>
    <csymbol cd="unknown">l</csymbol>
    <csymbol cd="latexml">parallel-to</csymbol>
    <csymbol cd="unknown">r</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=l\|r
  </annotation>
 </semantics>
</math>

. First the left half of the input 

<math display="inline" id="KASUMI:11">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 is ANDed bitwise with round key 

<math display="inline" id="KASUMI:12">
 <semantics>
  <mrow>
   <mi>K</mi>
   <msub>
    <mi>L</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <list>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   KL_{i,1}
  </annotation>
 </semantics>
</math>

 and rotated left by one bit. The result of that is XOR'ed to the right half of the input 

<math display="inline" id="KASUMI:13">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 to get the right half of the output 

<math display="inline" id="KASUMI:14">
 <semantics>
  <msup>
   <mi>r</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>r</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{\prime}
  </annotation>
 </semantics>
</math>


.</p>

<p>

<math display="inline" id="KASUMI:15">
 <semantics>
  <mrow>
   <msup>
    <mi>r</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>ROL</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>l</mi>
       <mo>∧</mo>
       <mrow>
        <mi>K</mi>
        <msub>
         <mi>L</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⊕</mo>
    <mi>r</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <times></times>
      <ci>ROL</ci>
      <interval closure="open">
       <apply>
        <and></and>
        <ci>l</ci>
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <list>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </list>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </interval>
     </apply>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{\prime}={\rm ROL}(l\wedge KL_{i,1},1)\oplus r
  </annotation>
 </semantics>
</math>

</p>

<p>Then the right half of the output 

<math display="inline" id="KASUMI:16">
 <semantics>
  <msup>
   <mi>r</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>r</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r^{\prime}
  </annotation>
 </semantics>
</math>

 is ORed bitwise with the round key 

<math display="inline" id="KASUMI:17">
 <semantics>
  <mrow>
   <mi>K</mi>
   <msub>
    <mi>L</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mn>2</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>L</ci>
     <list>
      <ci>i</ci>
      <cn type="integer">2</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   KL_{i,2}
  </annotation>
 </semantics>
</math>

 and rotated left by one bit. The result of that is XOR'ed to the left half of the input 

<math display="inline" id="KASUMI:18">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 to get the left half of the output 

<math display="inline" id="KASUMI:19">
 <semantics>
  <msup>
   <mi>l</mi>
   <mo>′</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>l</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l^{\prime}
  </annotation>
 </semantics>
</math>


.</p>

<p>

<math display="inline" id="KASUMI:20">
 <semantics>
  <mrow>
   <msup>
    <mi>l</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>ROL</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>r</mi>
        <mo>′</mo>
       </msup>
       <mo>∨</mo>
       <mrow>
        <mi>K</mi>
        <msub>
         <mi>L</mi>
         <mrow>
          <mi>i</mi>
          <mo>,</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mo>,</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⊕</mo>
    <mi>l</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>l</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <times></times>
      <ci>ROL</ci>
      <interval closure="open">
       <apply>
        <or></or>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>r</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>L</ci>
          <list>
           <ci>i</ci>
           <cn type="integer">2</cn>
          </list>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </interval>
     </apply>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l^{\prime}={\rm ROL}(r^{\prime}\vee KL_{i,2},1)\oplus l
  </annotation>
 </semantics>
</math>

</p>

<p>Output of the function is concatenation of the left and right halves 

<math display="inline" id="KASUMI:21">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <msup>
    <mi>l</mi>
    <mo>′</mo>
   </msup>
   <mo>∥</mo>
   <msup>
    <mi>r</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>l</ci>
     <ci>normal-′</ci>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>r</ci>
     <ci>normal-′</ci>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}=l^{\prime}\|r^{\prime}
  </annotation>
 </semantics>
</math>

.</p>
<h4 id="function-fo">Function FO</h4>

<p>The 32-bit input <em>x</em> of 

<math display="inline" id="KASUMI:22">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mi>O</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>K</mi>
     <msub>
      <mi>O</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>K</mi>
     <msub>
      <mi>I</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <ci>O</ci>
    <vector>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>O</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>K</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <ci>x</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   FO(KO_{i},KI_{i},x)
  </annotation>
 </semantics>
</math>

 is divided into two 16-bit halves 

<math display="inline" id="KASUMI:23">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <msub>
    <mi>l</mi>
    <mn>0</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>r</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">x</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">0</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">0</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=l_{0}\|r_{0}
  </annotation>
 </semantics>
</math>

, and passed through three rounds of a Feistel network.</p>

<p>In each of the three rounds (indexed by <em>j</em> that takes values 1, 2, and 3) the left half is modified to get the new right half and the right half is made the left half of the next round.</p>

<p>

<math display="inline" id="KASUMI:24">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>r</mi>
      <mi>j</mi>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mi>F</mi>
       <mi>I</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>K</mi>
         <msub>
          <mi>I</mi>
          <mrow>
           <mi>i</mi>
           <mo>,</mo>
           <mi>j</mi>
          </mrow>
         </msub>
        </mrow>
        <mo>,</mo>
        <mrow>
         <msub>
          <mi>l</mi>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
         <mo>⊕</mo>
         <mrow>
          <mi>K</mi>
          <msub>
           <mi>O</mi>
           <mrow>
            <mi>i</mi>
            <mo>,</mo>
            <mi>j</mi>
           </mrow>
          </msub>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⊕</mo>
      <msub>
       <mi>r</mi>
       <mrow>
        <mi>j</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd columnalign="left">
     <msub>
      <mi>l</mi>
      <mi>j</mi>
     </msub>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <msub>
      <mi>r</mi>
      <mrow>
       <mi>j</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>j</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">direct-sum</csymbol>
      <apply>
       <times></times>
       <ci>F</ci>
       <ci>I</ci>
       <interval closure="open">
        <apply>
         <times></times>
         <ci>K</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>I</ci>
          <list>
           <ci>i</ci>
           <ci>j</ci>
          </list>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">direct-sum</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>l</ci>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>K</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>O</ci>
           <list>
            <ci>i</ci>
            <ci>j</ci>
           </list>
          </apply>
         </apply>
        </apply>
       </interval>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <apply>
        <minus></minus>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>l</ci>
      <ci>j</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <apply>
       <minus></minus>
       <ci>j</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{lcl}r_{j}&=&FI(KI_{i,j},l_{j-1}\oplus KO_{i,j})\oplus r_{j-1}%
\\
l_{j}&=&r_{j-1}\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>The output of the function is 

<math display="inline" id="KASUMI:25">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <msub>
    <mi>l</mi>
    <mn>3</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>r</mi>
    <mn>3</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">3</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">3</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}=l_{3}\|r_{3}
  </annotation>
 </semantics>
</math>

.</p>
<h4 id="function-fi">Function FI</h4>

<p>The function <em>FI</em> is an irregular Feistel-like network.</p>

<p>The 16-bit input 

<math display="inline" id="KASUMI:26">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 of the function 

<math display="inline" id="KASUMI:27">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mi>I</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>K</mi>
     <mi>i</mi>
    </mrow>
    <mo>,</mo>
    <mi>x</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <ci>I</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>K</ci>
      <ci>i</ci>
     </apply>
     <ci>x</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   FI(Ki,x)
  </annotation>
 </semantics>
</math>

 is divided to two halves 

<math display="inline" id="KASUMI:28">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <msub>
    <mi>l</mi>
    <mn>0</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>r</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">x</csymbol>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">0</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">0</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=l_{0}\|r_{0}
  </annotation>
 </semantics>
</math>

 of which 

<math display="inline" id="KASUMI:29">
 <semantics>
  <msub>
   <mi>l</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{0}
  </annotation>
 </semantics>
</math>

 is 9 bits wide and 

<math display="inline" id="KASUMI:30">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{0}
  </annotation>
 </semantics>
</math>

 is 7 bits wide.</p>

<p>Bits in the left half 

<math display="inline" id="KASUMI:31">
 <semantics>
  <msub>
   <mi>l</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{0}
  </annotation>
 </semantics>
</math>

 are first shuffled by 9-bit <a href="substitution_box" title="wikilink">substitution box</a> (S-box) <em>S9</em> and the result is XOR'ed with the zero-extended right half 

<math display="inline" id="KASUMI:32">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{0}
  </annotation>
 </semantics>
</math>

 to get the new 9-bit right half 

<math display="inline" id="KASUMI:33">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1}
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="inline" id="KASUMI:34">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mi>S</mi>
   <mn>9</mn>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>l</mi>
     <mn>0</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>⊕</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>00</mn>
    <mo>∥</mo>
    <msub>
     <mi>r</mi>
     <mn>0</mn>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">S</csymbol>
    <cn type="integer">9</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>l</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">direct-sum</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="integer">00</cn>
     <csymbol cd="latexml">parallel-to</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1}=S9(l_{0})\oplus(00\|r_{0})\,
  </annotation>
 </semantics>
</math>

</p>

<p>Bits of the right half 

<math display="inline" id="KASUMI:35">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{0}
  </annotation>
 </semantics>
</math>

 are shuffled by 7-bit S-box <em>S7</em> and the result is XOR'ed with the seven least significant bits (<em>LS7</em>) of the new right half 

<math display="inline" id="KASUMI:36">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1}
  </annotation>
 </semantics>
</math>

 to get the new 7-bit left half 

<math display="inline" id="KASUMI:37">
 <semantics>
  <msub>
   <mi>l</mi>
   <mn>1</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{1}
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="inline" id="KASUMI:38">
 <semantics>
  <mrow>
   <msub>
    <mi>l</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mn>7</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>r</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⊕</mo>
    <mrow>
     <mi>L</mi>
     <mi>S</mi>
     <mn>7</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>r</mi>
       <mn>1</mn>
      </msub>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <times></times>
      <ci>S</ci>
      <cn type="integer">7</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>L</ci>
      <ci>S</ci>
      <cn type="integer">7</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{1}=S7(r_{0})\oplus LS7(r_{1})\,
  </annotation>
 </semantics>
</math>

</p>

<p>The intermediate word 

<math display="inline" id="KASUMI:39">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>l</mi>
    <mn>1</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">1</cn>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">1</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{1}=l_{1}\|r_{1}
  </annotation>
 </semantics>
</math>

 is XORed with the round key KI to get 

<math display="inline" id="KASUMI:40">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>l</mi>
    <mn>2</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>r</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">2</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">2</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}=l_{2}\|r_{2}
  </annotation>
 </semantics>
</math>

 of which 

<math display="inline" id="KASUMI:41">
 <semantics>
  <msub>
   <mi>l</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{2}
  </annotation>
 </semantics>
</math>

 is 7 bits wide and 

<math display="inline" id="KASUMI:42">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{2}
  </annotation>
 </semantics>
</math>

 is 9 bits wide.</p>

<p>

<math display="inline" id="KASUMI:43">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>K</mi>
     <mi>I</mi>
    </mrow>
    <mo>⊕</mo>
    <msub>
     <mi>x</mi>
     <mn>1</mn>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <times></times>
      <ci>K</ci>
      <ci>I</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{2}=KI\oplus x_{1}
  </annotation>
 </semantics>
</math>

</p>

<p>Bits in the right half 

<math display="inline" id="KASUMI:44">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{2}
  </annotation>
 </semantics>
</math>

 are then shuffled by 9-bit S-box <em>S9</em> and the result is XOR'ed with the zero-extended left half 

<math display="inline" id="KASUMI:45">
 <semantics>
  <msub>
   <mi>l</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{2}
  </annotation>
 </semantics>
</math>

 to get the new 9-bit right half of the output 

<math display="inline" id="KASUMI:46">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{3}
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="inline" id="KASUMI:47">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mi>S</mi>
   <mn>9</mn>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>r</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>⊕</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>00</mn>
    <mo>∥</mo>
    <msub>
     <mi>l</mi>
     <mn>2</mn>
    </msub>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">3</cn>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">S</csymbol>
    <cn type="integer">9</cn>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">direct-sum</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <cn type="integer">00</cn>
     <csymbol cd="latexml">parallel-to</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>l</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{3}=S9(r_{2})\oplus(00\|l_{2})\,
  </annotation>
 </semantics>
</math>

</p>

<p>Finally the bits of the left half 

<math display="inline" id="KASUMI:48">
 <semantics>
  <msub>
   <mi>l</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{2}
  </annotation>
 </semantics>
</math>

 are shuffled by 7-bit S-box <em>S7</em> and the result is XOR'ed with the seven least significant bits (<em>LS7</em>) of the right half of the output 

<math display="inline" id="KASUMI:49">
 <semantics>
  <msub>
   <mi>r</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{3}
  </annotation>
 </semantics>
</math>

 to get the 7-bit left half 

<math display="inline" id="KASUMI:50">
 <semantics>
  <msub>
   <mi>l</mi>
   <mn>3</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>l</ci>
    <cn type="integer">3</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{3}
  </annotation>
 </semantics>
</math>

 of the output.</p>

<p>

<math display="inline" id="KASUMI:51">
 <semantics>
  <mrow>
   <msub>
    <mi>l</mi>
    <mn>3</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>S</mi>
     <mn>7</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>l</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⊕</mo>
    <mrow>
     <mi>L</mi>
     <mi>S</mi>
     <mn>7</mn>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>r</mi>
       <mn>3</mn>
      </msub>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">3</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <times></times>
      <ci>S</ci>
      <cn type="integer">7</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>l</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>L</ci>
      <ci>S</ci>
      <cn type="integer">7</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l_{3}=S7(l_{2})\oplus LS7(r_{3})\,
  </annotation>
 </semantics>
</math>

</p>

<p>The output is the concatenation of the final left and right halves 

<math display="inline" id="KASUMI:52">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <msub>
    <mi>l</mi>
    <mn>3</mn>
   </msub>
   <mo>∥</mo>
   <msub>
    <mi>r</mi>
    <mn>3</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>l</ci>
     <cn type="integer">3</cn>
    </apply>
    <csymbol cd="latexml">parallel-to</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">3</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}=l_{3}\|r_{3}
  </annotation>
 </semantics>
</math>

.</p>
<h4 id="substitution-boxes">Substitution boxes</h4>

<p>The <a href="substitution_box" title="wikilink">substitution boxes</a> (S-boxes) S7 and S9 are defined by both bit-wise AND-XOR expressions and look-up tables in the specification. The bit-wise expressions are intended to hardware implementation but nowadays it is customary to use the look-up tables even in the HW design.</p>

<p>S7 is defined by the following array:</p>
<div class="sourceCode"><pre class="sourceCode C"><code class="sourceCode c"><span class="dt">int</span> S7[<span class="dv">128</span>] = {
   <span class="dv">54</span>, <span class="dv">50</span>, <span class="dv">62</span>, <span class="dv">56</span>, <span class="dv">22</span>, <span class="dv">34</span>, <span class="dv">94</span>, <span class="dv">96</span>, <span class="dv">38</span>,  <span class="dv">6</span>, <span class="dv">63</span>, <span class="dv">93</span>,  <span class="dv">2</span>, <span class="dv">18</span>,<span class="dv">123</span>, <span class="dv">33</span>,
   <span class="dv">55</span>,<span class="dv">113</span>, <span class="dv">39</span>,<span class="dv">114</span>, <span class="dv">21</span>, <span class="dv">67</span>, <span class="dv">65</span>, <span class="dv">12</span>, <span class="dv">47</span>, <span class="dv">73</span>, <span class="dv">46</span>, <span class="dv">27</span>, <span class="dv">25</span>,<span class="dv">111</span>,<span class="dv">124</span>, <span class="dv">81</span>,
   <span class="dv">53</span>,  <span class="dv">9</span>,<span class="dv">121</span>, <span class="dv">79</span>, <span class="dv">52</span>, <span class="dv">60</span>, <span class="dv">58</span>, <span class="dv">48</span>,<span class="dv">101</span>,<span class="dv">127</span>, <span class="dv">40</span>,<span class="dv">120</span>,<span class="dv">104</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">43</span>,
   <span class="dv">20</span>,<span class="dv">122</span>, <span class="dv">72</span>, <span class="dv">61</span>, <span class="dv">23</span>,<span class="dv">109</span>, <span class="dv">13</span>,<span class="dv">100</span>, <span class="dv">77</span>,  <span class="dv">1</span>, <span class="dv">16</span>,  <span class="dv">7</span>, <span class="dv">82</span>, <span class="dv">10</span>,<span class="dv">105</span>, <span class="dv">98</span>,
  <span class="dv">117</span>,<span class="dv">116</span>, <span class="dv">76</span>, <span class="dv">11</span>, <span class="dv">89</span>,<span class="dv">106</span>,  <span class="dv">0</span>,<span class="dv">125</span>,<span class="dv">118</span>, <span class="dv">99</span>, <span class="dv">86</span>, <span class="dv">69</span>, <span class="dv">30</span>, <span class="dv">57</span>,<span class="dv">126</span>, <span class="dv">87</span>,
  <span class="dv">112</span>, <span class="dv">51</span>, <span class="dv">17</span>,  <span class="dv">5</span>, <span class="dv">95</span>, <span class="dv">14</span>, <span class="dv">90</span>, <span class="dv">84</span>, <span class="dv">91</span>,  <span class="dv">8</span>, <span class="dv">35</span>,<span class="dv">103</span>, <span class="dv">32</span>, <span class="dv">97</span>, <span class="dv">28</span>, <span class="dv">66</span>,
  <span class="dv">102</span>, <span class="dv">31</span>, <span class="dv">26</span>, <span class="dv">45</span>, <span class="dv">75</span>,  <span class="dv">4</span>, <span class="dv">85</span>, <span class="dv">92</span>, <span class="dv">37</span>, <span class="dv">74</span>, <span class="dv">80</span>, <span class="dv">49</span>, <span class="dv">68</span>, <span class="dv">29</span>,<span class="dv">115</span>, <span class="dv">44</span>,
   <span class="dv">64</span>,<span class="dv">107</span>,<span class="dv">108</span>, <span class="dv">24</span>,<span class="dv">110</span>, <span class="dv">83</span>, <span class="dv">36</span>, <span class="dv">78</span>, <span class="dv">42</span>, <span class="dv">19</span>, <span class="dv">15</span>, <span class="dv">41</span>, <span class="dv">88</span>,<span class="dv">119</span>, <span class="dv">59</span>,  <span class="dv">3</span>
};</code></pre></div>

<p>S9 is defined by the following array:</p>
<div class="sourceCode"><pre class="sourceCode C"><code class="sourceCode c"><span class="dt">int</span> S9[<span class="dv">512</span>] = {
  <span class="dv">167</span>,<span class="dv">239</span>,<span class="dv">161</span>,<span class="dv">379</span>,<span class="dv">391</span>,<span class="dv">334</span>,  <span class="dv">9</span>,<span class="dv">338</span>, <span class="dv">38</span>,<span class="dv">226</span>, <span class="dv">48</span>,<span class="dv">358</span>,<span class="dv">452</span>,<span class="dv">385</span>, <span class="dv">90</span>,<span class="dv">397</span>,
  <span class="dv">183</span>,<span class="dv">253</span>,<span class="dv">147</span>,<span class="dv">331</span>,<span class="dv">415</span>,<span class="dv">340</span>, <span class="dv">51</span>,<span class="dv">362</span>,<span class="dv">306</span>,<span class="dv">500</span>,<span class="dv">262</span>, <span class="dv">82</span>,<span class="dv">216</span>,<span class="dv">159</span>,<span class="dv">356</span>,<span class="dv">177</span>,
  <span class="dv">175</span>,<span class="dv">241</span>,<span class="dv">489</span>, <span class="dv">37</span>,<span class="dv">206</span>, <span class="dv">17</span>,  <span class="dv">0</span>,<span class="dv">333</span>, <span class="dv">44</span>,<span class="dv">254</span>,<span class="dv">378</span>, <span class="dv">58</span>,<span class="dv">143</span>,<span class="dv">220</span>, <span class="dv">81</span>,<span class="dv">400</span>,
   <span class="dv">95</span>,  <span class="dv">3</span>,<span class="dv">315</span>,<span class="dv">245</span>, <span class="dv">54</span>,<span class="dv">235</span>,<span class="dv">218</span>,<span class="dv">405</span>,<span class="dv">472</span>,<span class="dv">264</span>,<span class="dv">172</span>,<span class="dv">494</span>,<span class="dv">371</span>,<span class="dv">290</span>,<span class="dv">399</span>, <span class="dv">76</span>,
  <span class="dv">165</span>,<span class="dv">197</span>,<span class="dv">395</span>,<span class="dv">121</span>,<span class="dv">257</span>,<span class="dv">480</span>,<span class="dv">423</span>,<span class="dv">212</span>,<span class="dv">240</span>, <span class="dv">28</span>,<span class="dv">462</span>,<span class="dv">176</span>,<span class="dv">406</span>,<span class="dv">507</span>,<span class="dv">288</span>,<span class="dv">223</span>,
  <span class="dv">501</span>,<span class="dv">407</span>,<span class="dv">249</span>,<span class="dv">265</span>, <span class="dv">89</span>,<span class="dv">186</span>,<span class="dv">221</span>,<span class="dv">428</span>,<span class="dv">164</span>, <span class="dv">74</span>,<span class="dv">440</span>,<span class="dv">196</span>,<span class="dv">458</span>,<span class="dv">421</span>,<span class="dv">350</span>,<span class="dv">163</span>,
  <span class="dv">232</span>,<span class="dv">158</span>,<span class="dv">134</span>,<span class="dv">354</span>, <span class="dv">13</span>,<span class="dv">250</span>,<span class="dv">491</span>,<span class="dv">142</span>,<span class="dv">191</span>, <span class="dv">69</span>,<span class="dv">193</span>,<span class="dv">425</span>,<span class="dv">152</span>,<span class="dv">227</span>,<span class="dv">366</span>,<span class="dv">135</span>,
  <span class="dv">344</span>,<span class="dv">300</span>,<span class="dv">276</span>,<span class="dv">242</span>,<span class="dv">437</span>,<span class="dv">320</span>,<span class="dv">113</span>,<span class="dv">278</span>, <span class="dv">11</span>,<span class="dv">243</span>, <span class="dv">87</span>,<span class="dv">317</span>, <span class="dv">36</span>, <span class="dv">93</span>,<span class="dv">496</span>, <span class="dv">27</span>,
  
  <span class="dv">487</span>,<span class="dv">446</span>,<span class="dv">482</span>, <span class="dv">41</span>, <span class="dv">68</span>,<span class="dv">156</span>,<span class="dv">457</span>,<span class="dv">131</span>,<span class="dv">326</span>,<span class="dv">403</span>,<span class="dv">339</span>, <span class="dv">20</span>, <span class="dv">39</span>,<span class="dv">115</span>,<span class="dv">442</span>,<span class="dv">124</span>,
  <span class="dv">475</span>,<span class="dv">384</span>,<span class="dv">508</span>, <span class="dv">53</span>,<span class="dv">112</span>,<span class="dv">170</span>,<span class="dv">479</span>,<span class="dv">151</span>,<span class="dv">126</span>,<span class="dv">169</span>, <span class="dv">73</span>,<span class="dv">268</span>,<span class="dv">279</span>,<span class="dv">321</span>,<span class="dv">168</span>,<span class="dv">364</span>,
  <span class="dv">363</span>,<span class="dv">292</span>, <span class="dv">46</span>,<span class="dv">499</span>,<span class="dv">393</span>,<span class="dv">327</span>,<span class="dv">324</span>, <span class="dv">24</span>,<span class="dv">456</span>,<span class="dv">267</span>,<span class="dv">157</span>,<span class="dv">460</span>,<span class="dv">488</span>,<span class="dv">426</span>,<span class="dv">309</span>,<span class="dv">229</span>,
  <span class="dv">439</span>,<span class="dv">506</span>,<span class="dv">208</span>,<span class="dv">271</span>,<span class="dv">349</span>,<span class="dv">401</span>,<span class="dv">434</span>,<span class="dv">236</span>, <span class="dv">16</span>,<span class="dv">209</span>,<span class="dv">359</span>, <span class="dv">52</span>, <span class="dv">56</span>,<span class="dv">120</span>,<span class="dv">199</span>,<span class="dv">277</span>,
  <span class="dv">465</span>,<span class="dv">416</span>,<span class="dv">252</span>,<span class="dv">287</span>,<span class="dv">246</span>,  <span class="dv">6</span>, <span class="dv">83</span>,<span class="dv">305</span>,<span class="dv">420</span>,<span class="dv">345</span>,<span class="dv">153</span>,<span class="dv">502</span>, <span class="dv">65</span>, <span class="dv">61</span>,<span class="dv">244</span>,<span class="dv">282</span>,
  <span class="dv">173</span>,<span class="dv">222</span>,<span class="dv">418</span>, <span class="dv">67</span>,<span class="dv">386</span>,<span class="dv">368</span>,<span class="dv">261</span>,<span class="dv">101</span>,<span class="dv">476</span>,<span class="dv">291</span>,<span class="dv">195</span>,<span class="dv">430</span>, <span class="dv">49</span>, <span class="dv">79</span>,<span class="dv">166</span>,<span class="dv">330</span>,
  <span class="dv">280</span>,<span class="dv">383</span>,<span class="dv">373</span>,<span class="dv">128</span>,<span class="dv">382</span>,<span class="dv">408</span>,<span class="dv">155</span>,<span class="dv">495</span>,<span class="dv">367</span>,<span class="dv">388</span>,<span class="dv">274</span>,<span class="dv">107</span>,<span class="dv">459</span>,<span class="dv">417</span>, <span class="dv">62</span>,<span class="dv">454</span>,
  <span class="dv">132</span>,<span class="dv">225</span>,<span class="dv">203</span>,<span class="dv">316</span>,<span class="dv">234</span>, <span class="dv">14</span>,<span class="dv">301</span>, <span class="dv">91</span>,<span class="dv">503</span>,<span class="dv">286</span>,<span class="dv">424</span>,<span class="dv">211</span>,<span class="dv">347</span>,<span class="dv">307</span>,<span class="dv">140</span>,<span class="dv">374</span>,
  
   <span class="dv">35</span>,<span class="dv">103</span>,<span class="dv">125</span>,<span class="dv">427</span>, <span class="dv">19</span>,<span class="dv">214</span>,<span class="dv">453</span>,<span class="dv">146</span>,<span class="dv">498</span>,<span class="dv">314</span>,<span class="dv">444</span>,<span class="dv">230</span>,<span class="dv">256</span>,<span class="dv">329</span>,<span class="dv">198</span>,<span class="dv">285</span>,
   <span class="dv">50</span>,<span class="dv">116</span>, <span class="dv">78</span>,<span class="dv">410</span>, <span class="dv">10</span>,<span class="dv">205</span>,<span class="dv">510</span>,<span class="dv">171</span>,<span class="dv">231</span>, <span class="dv">45</span>,<span class="dv">139</span>,<span class="dv">467</span>, <span class="dv">29</span>, <span class="dv">86</span>,<span class="dv">505</span>, <span class="dv">32</span>,
   <span class="dv">72</span>, <span class="dv">26</span>,<span class="dv">342</span>,<span class="dv">150</span>,<span class="dv">313</span>,<span class="dv">490</span>,<span class="dv">431</span>,<span class="dv">238</span>,<span class="dv">411</span>,<span class="dv">325</span>,<span class="dv">149</span>,<span class="dv">473</span>, <span class="dv">40</span>,<span class="dv">119</span>,<span class="dv">174</span>,<span class="dv">355</span>,
  <span class="dv">185</span>,<span class="dv">233</span>,<span class="dv">389</span>, <span class="dv">71</span>,<span class="dv">448</span>,<span class="dv">273</span>,<span class="dv">372</span>, <span class="dv">55</span>,<span class="dv">110</span>,<span class="dv">178</span>,<span class="dv">322</span>, <span class="dv">12</span>,<span class="dv">469</span>,<span class="dv">392</span>,<span class="dv">369</span>,<span class="dv">190</span>,
    <span class="dv">1</span>,<span class="dv">109</span>,<span class="dv">375</span>,<span class="dv">137</span>,<span class="dv">181</span>, <span class="dv">88</span>, <span class="dv">75</span>,<span class="dv">308</span>,<span class="dv">260</span>,<span class="dv">484</span>, <span class="dv">98</span>,<span class="dv">272</span>,<span class="dv">370</span>,<span class="dv">275</span>,<span class="dv">412</span>,<span class="dv">111</span>,
  <span class="dv">336</span>,<span class="dv">318</span>,  <span class="dv">4</span>,<span class="dv">504</span>,<span class="dv">492</span>,<span class="dv">259</span>,<span class="dv">304</span>, <span class="dv">77</span>,<span class="dv">337</span>,<span class="dv">435</span>, <span class="dv">21</span>,<span class="dv">357</span>,<span class="dv">303</span>,<span class="dv">332</span>,<span class="dv">483</span>, <span class="dv">18</span>,
   <span class="dv">47</span>, <span class="dv">85</span>, <span class="dv">25</span>,<span class="dv">497</span>,<span class="dv">474</span>,<span class="dv">289</span>,<span class="dv">100</span>,<span class="dv">269</span>,<span class="dv">296</span>,<span class="dv">478</span>,<span class="dv">270</span>,<span class="dv">106</span>, <span class="dv">31</span>,<span class="dv">104</span>,<span class="dv">433</span>, <span class="dv">84</span>,
  <span class="dv">414</span>,<span class="dv">486</span>,<span class="dv">394</span>, <span class="dv">96</span>, <span class="dv">99</span>,<span class="dv">154</span>,<span class="dv">511</span>,<span class="dv">148</span>,<span class="dv">413</span>,<span class="dv">361</span>,<span class="dv">409</span>,<span class="dv">255</span>,<span class="dv">162</span>,<span class="dv">215</span>,<span class="dv">302</span>,<span class="dv">201</span>,
  
  <span class="dv">266</span>,<span class="dv">351</span>,<span class="dv">343</span>,<span class="dv">144</span>,<span class="dv">441</span>,<span class="dv">365</span>,<span class="dv">108</span>,<span class="dv">298</span>,<span class="dv">251</span>, <span class="dv">34</span>,<span class="dv">182</span>,<span class="dv">509</span>,<span class="dv">138</span>,<span class="dv">210</span>,<span class="dv">335</span>,<span class="dv">133</span>,
  <span class="dv">311</span>,<span class="dv">352</span>,<span class="dv">328</span>,<span class="dv">141</span>,<span class="dv">396</span>,<span class="dv">346</span>,<span class="dv">123</span>,<span class="dv">319</span>,<span class="dv">450</span>,<span class="dv">281</span>,<span class="dv">429</span>,<span class="dv">228</span>,<span class="dv">443</span>,<span class="dv">481</span>, <span class="dv">92</span>,<span class="dv">404</span>,
  <span class="dv">485</span>,<span class="dv">422</span>,<span class="dv">248</span>,<span class="dv">297</span>, <span class="dv">23</span>,<span class="dv">213</span>,<span class="dv">130</span>,<span class="dv">466</span>, <span class="dv">22</span>,<span class="dv">217</span>,<span class="dv">283</span>, <span class="dv">70</span>,<span class="dv">294</span>,<span class="dv">360</span>,<span class="dv">419</span>,<span class="dv">127</span>,
  <span class="dv">312</span>,<span class="dv">377</span>,  <span class="dv">7</span>,<span class="dv">468</span>,<span class="dv">194</span>,  <span class="dv">2</span>,<span class="dv">117</span>,<span class="dv">295</span>,<span class="dv">463</span>,<span class="dv">258</span>,<span class="dv">224</span>,<span class="dv">447</span>,<span class="dv">247</span>,<span class="dv">187</span>, <span class="dv">80</span>,<span class="dv">398</span>,
  <span class="dv">284</span>,<span class="dv">353</span>,<span class="dv">105</span>,<span class="dv">390</span>,<span class="dv">299</span>,<span class="dv">471</span>,<span class="dv">470</span>,<span class="dv">184</span>, <span class="dv">57</span>,<span class="dv">200</span>,<span class="dv">348</span>, <span class="dv">63</span>,<span class="dv">204</span>,<span class="dv">188</span>, <span class="dv">33</span>,<span class="dv">451</span>,
   <span class="dv">97</span>, <span class="dv">30</span>,<span class="dv">310</span>,<span class="dv">219</span>, <span class="dv">94</span>,<span class="dv">160</span>,<span class="dv">129</span>,<span class="dv">493</span>, <span class="dv">64</span>,<span class="dv">179</span>,<span class="dv">263</span>,<span class="dv">102</span>,<span class="dv">189</span>,<span class="dv">207</span>,<span class="dv">114</span>,<span class="dv">402</span>,
  <span class="dv">438</span>,<span class="dv">477</span>,<span class="dv">387</span>,<span class="dv">122</span>,<span class="dv">192</span>, <span class="dv">42</span>,<span class="dv">381</span>,  <span class="dv">5</span>,<span class="dv">145</span>,<span class="dv">118</span>,<span class="dv">180</span>,<span class="dv">449</span>,<span class="dv">293</span>,<span class="dv">323</span>,<span class="dv">136</span>,<span class="dv">380</span>,
   <span class="dv">43</span>, <span class="dv">66</span>, <span class="dv">60</span>,<span class="dv">455</span>,<span class="dv">341</span>,<span class="dv">445</span>,<span class="dv">202</span>,<span class="dv">432</span>,  <span class="dv">8</span>,<span class="dv">237</span>, <span class="dv">15</span>,<span class="dv">376</span>,<span class="dv">436</span>,<span class="dv">464</span>, <span class="dv">59</span>,<span class="dv">461</span>
};</code></pre></div>
<h2 id="cryptanalysis">Cryptanalysis</h2>

<p>In 2001, an <a href="impossible_differential_cryptanalysis" title="wikilink">impossible differential attack</a> on six rounds of KASUMI was presented by Kühn (2001).<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>In 2003 Elad Barkan, <a href="Eli_Biham" title="wikilink">Eli Biham</a> and Nathan Keller demonstrated <a href="man-in-the-middle_attack" title="wikilink">man-in-the-middle attacks</a> against the <a class="uri" href="GSM" title="wikilink">GSM</a> protocol which avoided the A5/3 cipher and thus breaking the protocol. This approach does not attack the A5/3 cipher, however.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> The full version of their paper was published later in 2006.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>In 2005, Israeli researchers <a href="Eli_Biham" title="wikilink">Eli Biham</a>, Orr Dunkelman and Nathan Keller published a <a href="related-key_attack" title="wikilink">related-key</a> <a href="boomerang_attack" title="wikilink">rectangle (boomerang) attack</a> on KASUMI that can break all 8 rounds faster than exhaustive search.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> The attack requires 2<sup>54.6</sup> chosen plaintexts, each of which has been encrypted under one of four related keys, and has a time complexity equivalent to 2<sup>76.1</sup> KASUMI encryptions. While this is not a practical attack, it invalidates some proofs about the security of the 3GPP protocols that had relied on the presumed strength of KASUMI.</p>

<p>In 2010, Dunkelman, Keller and Shamir published a new attack that allows an adversary to recover a full A5/3 key by <a href="related-key_attack" title="wikilink">related-key attack</a>.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> The time and space complexities of the attack are low enough that the authors carried out the attack in two hours on an <a href="Intel_Core_2_Duo" title="wikilink">Intel Core 2 Duo</a> desktop computer even using the unoptimized reference KASUMI implementation. The authors note that this attack may not be applicable to the way A5/3 is used in 3G systems; their main purpose was to discredit 3GPP's assurances that their changes to MISTY wouldn't significantly impact the security of the algorithm.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a class="uri" href="A5/1" title="wikilink">A5/1</a> and <a class="uri" href="A5/2" title="wikilink">A5/2</a></li>
<li><a class="uri" href="MISTY1" title="wikilink">MISTY1</a></li>
<li><a class="uri" href="SNOW" title="wikilink">SNOW</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.ma.huji.ac.il/~nkeller">Nathan Keller's homepage</a></li>
</ul>

<p>"</p>

<p><a href="Category:Feistel_ciphers" title="wikilink">Category:Feistel ciphers</a> <a href="Category:Broken_block_ciphers" title="wikilink">Category:Broken block ciphers</a> <a href="Category:3GPP_standards" title="wikilink">Category:3GPP standards</a> <a href="Category:Mitsubishi_Electric_products,_services_and_standards" title="wikilink">Category:Mitsubishi Electric products, services and standards</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"></li>
</ol>
</section>
</body>


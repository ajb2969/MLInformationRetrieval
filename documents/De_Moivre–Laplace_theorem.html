<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title offset="1232">De Moivre–Laplace theorem</title>
   <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js">
    </script>
</head>
<body>
<h1>De Moivre–Laplace theorem</h1>
<hr/>
<p> In <a href="probability_theory" title="wikilink">probability theory</a>, the <strong>de Moivre–Laplace theorem</strong> is a <a href="normal_distribution" title="wikilink">normal</a> approximation to the <a href="binomial_distribution" title="wikilink">binomial distribution</a>. It is a special case of the <a href="central_limit_theorem" title="wikilink">central limit theorem</a>. It states that the <a href="binomial_distribution" title="wikilink">binomial distribution</a> of the number of "successes" in <em>n</em> <a href="statistical_independence" title="wikilink">independent</a> <a href="Bernoulli_trial" title="wikilink">Bernoulli trials</a> with probability <em>p</em> of success on each trial is approximately a <a href="normal_distribution" title="wikilink">normal distribution</a> with mean <em>np</em> and standard deviation <span class="LaTeX">$$</span>, if <em>n</em> is very large and some conditions are satisfied.</p>
<p>The theorem appeared in the second edition of <em><a href="The_Doctrine_of_Chances" title="wikilink">The Doctrine of Chances</a></em> by <a href="Abraham_de_Moivre" title="wikilink">Abraham de Moivre</a>, published in 1738. The "Bernoulli trials" were not so-called in that book, but rather de Moivre wrote about the <a href="probability_distribution" title="wikilink">probability distribution</a> of the number of times "heads" appears when a coin is tossed 3600 times.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<p>This is one derivation of the particular <a href="Gaussian_function" title="wikilink">Gaussian function</a> used in the <a href="normal_distribution" title="wikilink">normal distribution</a>, though there are other ways of deriving it.</p>
<h2 id="theorem">Theorem</h2>
<p>As <em>n</em> grows large, for <em>k</em> in the <a href="neighborhood_(mathematics)" title="wikilink">neighborhood</a> of <em>np</em> we can approximate<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<p><span class="LaTeX">$${n \choose k}\, p^k q^{n-k} \simeq \frac{1}{\sqrt{2 \pi npq}}\,e^{-\frac{(k-np)^2}{2npq}}, \qquad p+q=1,\ p, q > 0$$</span> in the sense that the ratio of the left-hand side to the right-hand side converges to 1 as <em>n</em> → ∞.</p>
<h3 id="proof">Proof</h3>
<p>Note that <em>k</em> cannot be fixed or it would quickly fall outside the range of interest as <em>n</em> → ∞. What is needed is to let <em>k</em> vary but always be a fixed number of standard deviations from the mean, so that it is always associated with the same point on the <a href="Normal_Distribution" title="wikilink">standard normal distribution</a>. We can do this by defining</p>
<p><span class="LaTeX">$$k=np+x\sqrt{npq}$$</span></p>
<p>for some fixed <em>x</em>. Then, for example, when <em>x</em> = 1, <em>k</em> will always be 1 standard deviation from the mean. From this definition we have the approximations <em>k</em>→<em>np</em> and <span class="LaTeX">$\tfrac{k}{n} \to p$</span> as <em>n</em> → ∞.</p>
<p>However, the left-hand side requires that <em>k</em> be an integer. Keeping the notation but assuming that <em>k</em> is the nearest integer given by the definition, this is seen to be inconsequential in the limit by noting that as <em>n</em> → ∞ the change in <em>x</em> required to make <em>k</em> an integer becomes small and successive integer values of <em>k</em> produce converging values on the right-hand side:</p>
<p><span class="LaTeX">$$\frac{\frac{1}{\sqrt{2\pi npq}}e^\frac{-(k+1-np)^2}{2npq}}{\frac{1}{\sqrt{2\pi npq}}e^\frac{-(k-np)^2}{2npq}}=e^\frac{2np-2k-1}{2npq}\simeq e^\frac{-x}{2\sqrt{npq}}\simeq e^0= 1\qquad \text{as } n\to \infty.$$</span></p>
<p>The proof consists of transforming the left-hand side to the right-hand side by three approximations.</p>
<p>First, according to <a href="Stirling's_formula" title="wikilink">Stirling's formula</a>, we can replace the factorial of a large number <em>n</em> with the approximation:</p>
<p><span class="LaTeX">$$n! \simeq  n^n e^{-n}\sqrt{2 \pi n}\qquad \text{as } n \to \infty.$$</span></p>
<p>Thus</p>
<p><span class="LaTeX">$$\begin{align}{n \choose k} p^k q^{n-k} & = \frac{n!}{k!(n-k)!} p^k q^{n-k} \\& \simeq \frac{n^n e^{-n}\sqrt{2\pi n} }{k^ke^{-k}\sqrt{2\pi k}  (n-k)^{n-k}e^{-(n-k)}\sqrt{2\pi (n-k)}} p^k q^{n-k}\\&=\sqrt{\frac{n}{2\pi k\left(n-k\right)}}\frac{n^n}{k^k\left(n-k\right)^{n-k}}p^kq^{n-k}\\&=\sqrt{\frac{n}{2\pi k\left(n-k\right)}}\left(\frac{np}{k}\right)^k\left(\frac{nq}{n-k}\right)^{n-k}\end{align}$$</span></p>
<p>Next, use the approximation <span class="LaTeX">$\tfrac{k}{n} \to p$</span> to match the root above to the desired root on the right-hand side.</p>
<p><span class="LaTeX">$$\begin{align}{n \choose k} p^k q^{n-k} & \simeq \sqrt{\frac{1}{2\pi n\frac{k}{n}\left(1-\frac{k}{n}\right)}}\left(\frac{np}{k}\right)^{k} \left(\frac{nq}{n-k}\right)^{n-k}\\&\simeq\frac{1}{\sqrt {2\pi npq}}\left(\frac{np}{k}\right)^{k} \left(\frac{nq}{n-k}\right)^{n-k} \qquad p+q=1\\ \end{align}$$</span></p>
<p>Finally, rewrite the expression as an exponential and use the Taylor Series approximation for ln(1+x):</p>
<p><span class="LaTeX">$$\ln\left(1+x\right)\simeq x-\frac{x^2}{2}+\frac{x^3}{3}-...$$</span></p>
<p>Then</p>
<p><span class="LaTeX">$$\begin{align}{n \choose k} p^k q^{n-k} &\simeq \frac{1}{\sqrt {2\pi npq}}\exp\left\{\ln\left(\frac{np}{k}\right)^{k}+\ln \left(\frac{nq}{n-k}\right)^{n-k}\right\}\\ &=\frac{1}{\sqrt {2\pi npq}}\exp\left\{-k\ln\left(\frac{k}{np}\right)+(k-n)\ln \left(\frac{n-k}{nq}\right)\right\}\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{-k\ln\left(\frac{np+x\sqrt{npq}}{np}\right)+(k-n)\ln \left(\frac{n-np-x\sqrt{npq}}{nq}\right)\right\}\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{-k\ln\left({1+x\sqrt\frac{q}{np}}\right)+(k-n)\ln \left({1-x\sqrt\frac{p}{nq}}\right)\right\}\qquad p+q=1\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{-k\left({x\sqrt\frac{q}{np}}-\frac{x^2q}{2np}+...\right)+(k-n) \left({-x\sqrt\frac{p}{nq}-\frac{x^2p}{2nq}}-...\right)\right\}\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{\left(-np-x\sqrt{npq}\right)\left({x\sqrt\frac{q}{np}}-\frac{x^2q}{2np}+...\right)+\left(np+x\sqrt{npq}-n\right) \left(-x\sqrt\frac{p}{nq}-\frac{x^2p}{2nq}-...\right)\right\}\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{\left(-np-x\sqrt{npq}\right)\left(x\sqrt\frac{q}{np}-\frac{x^2q}{2np}+...\right)-\left(nq-x\sqrt{npq}\right) \left(-x\sqrt\frac{p}{nq}-\frac{x^2p}{2nq}-...\right)\right\}\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{\left(-x\sqrt{npq}+\frac{1}{2}x^2q-x^2q+...\right)+\left(x\sqrt{npq}+\frac{1}{2}x^2p-x^2p-...\right) \right\}\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{-\frac{1}{2}x^2q-\frac{1}{2}x^2p-...\right\}\\&=\frac{1}{\sqrt {2\pi npq}}\exp\left\{-\frac{1}{2}x^2(p+q)-...\right\}\\&\simeq\frac{1}{\sqrt {2\pi npq}}\exp\left\{-\frac{1}{2}x^2\right\}\\&=\frac{1}{\sqrt {2\pi npq}}e^\frac{-(k-np)^2}{2npq}\\ \end{align}$$</span></p>
<h2 id="notes">Notes</h2>
<p>"</p>
<p><a href="Category:Central_limit_theorem" title="wikilink">Category:Central limit theorem</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Papoulis, Pillai, "Probability, Random Variables, and Stochastic Processes", 4th Edition<a href="#fnref2">↩</a></li>
<li id="fn3">Feller, W. (1968) <em>An Introduction to Probability Theory and Its Applications (Volume 1)</em>. Wiley. ISBN 0-471-25708-7. Section VII.3<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1121">Least squares adjustment</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Least squares adjustment</h1>
<hr/>

<p><strong>Least squares adjustment</strong> is a model for the solution of an <a href="overdetermined_system" title="wikilink">overdetermined system</a> of equations based on the principle of <a href="least_squares" title="wikilink">least squares</a> of <a href="observation_residuals" title="wikilink">observation residuals</a>. It is used extensively in the disciplines of <a class="uri" href="surveying" title="wikilink">surveying</a>, <a class="uri" href="geodesy" title="wikilink">geodesy</a>, and <a class="uri" href="photogrammetry" title="wikilink">photogrammetry</a>—the field of <a class="uri" href="geomatics" title="wikilink">geomatics</a>, collectively.</p>
<h2 id="formulation">Formulation</h2>

<p>There are three forms of least squares adjustment: <em>parametric</em>, <em>conditional</em>, and <em>combined</em>. In <strong>parametric adjustment</strong>, one can find an observation equation <em>h(X)=Y</em> relating observations <em>Y</em> explicitly in terms of parameters <em>X</em> (leading to the A-model below). In <strong>conditional adjustment</strong>, there exists a condition equation <em>g(Y)=0</em> involving only observations <em>Y</em> (leading to the B-model below) — with no parameters <em>X</em> at all. Finally, in a <strong>combined adjustment</strong>, both parameters <em>X</em> and observations <em>Y</em> are involved implicitly in a mixed-model equation <em>f(X,Y)=0</em>. Clearly, parametric and conditional adjustments correspond to the more general combined case when <em>f(X,Y)=h(X)-Y</em> and <em>f(X,Y)=g(Y)</em>, respectively. Yet the special cases warrant simpler solutions, as detailed below. Often in the literature, <em>Y</em> may be denoted <em>L</em>.</p>
<h2 id="solution">Solution</h2>

<p>The equalities above only hold for the estimated parameters 

<math display="inline" id="Least_squares_adjustment:0">
 <semantics>
  <mover accent="true">
   <mi>X</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{X}
  </annotation>
 </semantics>
</math>

 and observations 

<math display="inline" id="Least_squares_adjustment:1">
 <semantics>
  <mover accent="true">
   <mi>Y</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{Y}
  </annotation>
 </semantics>
</math>

, thus 

<math display="inline" id="Least_squares_adjustment:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mover accent="true">
      <mi>X</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>,</mo>
     <mover accent="true">
      <mi>Y</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <ci>normal-^</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <ci>normal-^</ci>
       <ci>Y</ci>
      </apply>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\left(\hat{X},\hat{Y}\right)=0
  </annotation>
 </semantics>
</math>

. In contrast, measured observations 

<math display="inline" id="Least_squares_adjustment:3">
 <semantics>
  <mover accent="true">
   <mi>Y</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{Y}
  </annotation>
 </semantics>
</math>


 and approximate parameters 

<math display="inline" id="Least_squares_adjustment:4">
 <semantics>
  <mover accent="true">
   <mi>X</mi>
   <mo stretchy="false">~</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{X}
  </annotation>
 </semantics>
</math>

 produce a nonzero <em>misclosure</em>:</p>

<p>

<math display="block" id="Least_squares_adjustment:5">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>w</mi>
     <mo stretchy="false">~</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo>(</mo>
      <mover accent="true">
       <mi>X</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mo>,</mo>
      <mover accent="true">
       <mi>Y</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-~</ci>
     <ci>w</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <interval closure="open">
      <apply>
       <ci>normal-~</ci>
       <ci>X</ci>
      </apply>
      <apply>
       <ci>normal-~</ci>
       <ci>Y</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{w}=f\left(\tilde{X},\tilde{Y}\right).
  </annotation>
 </semantics>
</math>

 One can proceed to <a href="Taylor_series_expansion" title="wikilink">Taylor series expansion</a> of the equations, which results in the <a href="Jacobian_matrix_and_determinant" title="wikilink">Jacobians</a> or <a href="design_matrix" title="wikilink">design matrices</a>: the first one,</p>

<p>

<math display="block" id="Least_squares_adjustment:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <mi>f</mi>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>∂</mo>
      <mi>X</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>;</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>f</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\partial{f}/\partial{X};
  </annotation>
 </semantics>
</math>

 and the second one,</p>

<p>

<math display="block" id="Least_squares_adjustment:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>∂</mo>
      <mi>f</mi>
     </mrow>
     <mo>/</mo>
     <mrow>
      <mo>∂</mo>
      <mi>Y</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>B</ci>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>f</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=\partial{f}/\partial{Y}.
  </annotation>
 </semantics>
</math>

 The linearized model then reads:</p>

<p>

<math display="block" id="Least_squares_adjustment:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mover accent="true">
      <mi>w</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mo>+</mo>
     <mrow>
      <mi>A</mi>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>B</mi>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">^</mo>
      </mover>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-~</ci>
      <ci>w</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>B</ci>
      <apply>
       <ci>normal-^</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{w}+A\hat{x}+B\hat{y}=0,
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Least_squares_adjustment:9">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>X</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>-</mo>
    <mover accent="true">
     <mi>X</mi>
     <mo stretchy="false">~</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-^</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <ci>normal-~</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{x}=\hat{X}-\tilde{X}
  </annotation>
 </semantics>
</math>

 are estimated <em>parameter corrections</em> to the <em>a priori</em> values, and 

<math display="inline" id="Least_squares_adjustment:10">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>Y</mi>
     <mo stretchy="false">^</mo>
    </mover>
    <mo>-</mo>
    <mover accent="true">
     <mi>Y</mi>
     <mo stretchy="false">~</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-^</ci>
      <ci>Y</ci>
     </apply>
     <apply>
      <ci>normal-~</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{y}=\hat{Y}-\tilde{Y}
  </annotation>
 </semantics>
</math>

 are post-fit <em>observation <a href="Errors_and_residuals_in_statistics" title="wikilink">residuals</a></em>. In the parametric adjustment, the second design matrix is an identity, <em>B=-I</em>, and the misclosure vector can be interpreted as the pre-fit residuals, 

<math display="inline" id="Least_squares_adjustment:11">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>=</mo>
   <mover accent="true">
    <mi>w</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mover accent="true">
       <mi>X</mi>
       <mo stretchy="false">~</mo>
      </mover>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mover accent="true">
     <mi>Y</mi>
     <mo stretchy="false">~</mo>
    </mover>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-~</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <ci>normal-~</ci>
      <ci>w</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>h</ci>
       <apply>
        <ci>normal-~</ci>
        <ci>X</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-~</ci>
       <ci>Y</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{y}=\tilde{w}=h(\tilde{X})-\tilde{Y}
  </annotation>
 </semantics>
</math>

, so the system simplifies to:</p>

<p>

<math display="block" id="Least_squares_adjustment:12">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">^</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mo>-</mo>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">~</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <ci>normal-^</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <ci>normal-^</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <ci>normal-~</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\hat{x}=\hat{y}-\tilde{y},
  </annotation>
 </semantics>
</math>

 which is in the form of <a href="ordinary_least_squares" title="wikilink">ordinary least squares</a>. For the more general cases, <a href="Lagrange_multipliers" title="wikilink">Lagrange multipliers</a> are introduced to relate the two Jacobian matrices and transform the <a href="Constraint_(mathematics)" title="wikilink">constrained</a> least squares problem into an unconstrained one (albeit a larger one). In any case, their manipulation leads to the 

<math display="inline" id="Least_squares_adjustment:13">
 <semantics>
  <mover accent="true">
   <mi>X</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{X}
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Least_squares_adjustment:14">
 <semantics>
  <mover accent="true">
   <mi>Y</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{Y}
  </annotation>
 </semantics>
</math>

 vectors as well as the respective parameters and observations <em>a posteriori</em> covariance matrices.</p>
<h3 id="computation">Computation</h3>

<p>Given the matrices and vectors above, their solution is found via standard least-squares methods; e.g., forming the <a href="normal_matrix" title="wikilink">normal matrix</a> and applying <a href="Cholesky_decomposition" title="wikilink">Cholesky decomposition</a>, applying the <a href="QR_factorization" title="wikilink">QR factorization</a> directly to the Jacobian matrix, <a href="iterative_methods" title="wikilink">iterative methods</a> for very large systems, etc.</p>
<h2 id="worked-out-examples">Worked-out examples</h2>
<h2 id="applications">Applications</h2>
<ul>
<li><a class="uri" href="Leveling" title="wikilink">Leveling</a>, <a href="Traverse_(surveying)" title="wikilink">traverse</a>, and <a href="control_networks" title="wikilink">control networks</a></li>
<li><a href="Bundle_adjustment" title="wikilink">Bundle adjustment</a></li>
<li><a class="uri" href="Triangulation" title="wikilink">Triangulation</a>, <a class="uri" href="Trilateration" title="wikilink">Trilateration</a>, <a href="wikt:Triangulateration" title="wikilink">Triangulateration</a></li>
<li><a class="uri" href="GPS" title="wikilink">GPS</a>/<a href="GNSS_positioning" title="wikilink">GNSS positioning</a></li>
</ul>
<h2 id="related-concepts">Related concepts</h2>
<ul>
<li>Parametric adjustment is similar to most of <a href="regression_analysis" title="wikilink">regression analysis</a> and coincides with the <a href="Gauss-Markov_model" title="wikilink">Gauss-Markov model</a></li>
<li>Combined adjustment, also known as the <a href="Gauss-Helmert_model" title="wikilink">Gauss-Helmert model</a>, is an instance of the <a href="errors-in-variables_models" title="wikilink">errors-in-variables models</a></li>
<li>The use of <em>a priori</em> parameter covariance matrix is akin to <a href="Tikhonov_regularization" title="wikilink">Tikhonov regularization</a></li>
</ul>
<h2 id="extensions">Extensions</h2>

<p>If <a href="rank_deficiency" title="wikilink">rank deficiency</a> is encountered, it can often be rectified by the inclusion of additional equations imposing constraints on the parameters and/or observations, leading to <a href="constrained_least_squares" title="wikilink">constrained least squares</a>.</p>
<h2 id="bibliography">Bibliography</h2>

<p><strong>Lecture notes and Technical reports</strong>:</p>
<ul>
<li>Nico Sneeuw and Friedhelm Krum, <a href="http://www.uni-stuttgart.de/gi/education/BSC/19820_Ausgleichungsrechnung/skript_prelim.pdf">"Adjustment theory"</a>, Geodätisches Institut, <a href="Universität_Stuttgart" title="wikilink">Universität Stuttgart</a>, 2014</li>
<li>Krakiwsky, <a href="http://www2.unb.ca/gge/Pubs/LN42.pdf">"A synthesis of recent advances in the method of least squares"</a>, Lecture Notes #42, Department of Geodesy and Geomatics Engineering, <a href="University_of_New_Brunswick" title="wikilink">University of New Brunswick</a>, 1975</li>
<li>Cross, P.A. <a href="ftp://stella.ncl.ac.uk/pub/Fugro/Working%20Paper%20No6%20-%20P%20A%20Cross.pdf">"Advanced least squares applied to position-fixing"</a>, <a href="University_of_East_London" title="wikilink">University of East London</a>, School of Surveying, Working Paper No. 6, ISSN 0260-9142, January 1994. First edition April 1983, Reprinted with corrections January 1990. (Original Working Papers, <a href="North_East_London_Polytechnic" title="wikilink">North East London Polytechnic</a>, Dept. of Surveying, 205 pp., 1983.)</li>
<li>Snow, Kyle B., <a href="http://www.geology.osu.edu/~jekeli.1/OSUReports/reports/report_465.pdf">Applications of Parameter Estimation and Hypothesis Testing to GPS Network Adjustments</a>, Division of Geodetic Science, <a href="Ohio_State_University" title="wikilink">Ohio State University</a>, 2002</li>
</ul>

<p><strong>Books</strong>:</p>
<ul>
<li><a href="Reino_Antero_Hirvonen" title="wikilink">Reino Antero Hirvonen</a>, "Adjustments by least squares in geodesy and photogrammetry", Ungar, New York. 261 p., ISBN 0804443971, ISBN 978-0804443975, 1971.</li>
<li>Edward M. Mikhail, Friedrich E. Ackermann, "Observations and least squares", University Press of America, 1982</li>
<li></li>
<li><a href="Peter_Vaníček" title="wikilink">Peter Vaníček</a> and E.J. Krakiwsky, "Geodesy: The Concepts." Amsterdam: Elsevier. (third ed.): ISBN 0-444-87777-0, ISBN 978-0-444-87777-2; chap. 12, "Least-squares solution of overdetermined models", p. 202-213, 1986.</li>
<li><a href="Gilbert_Strang" title="wikilink">Gilbert Strang</a> and Kai Borre, "Linear Algebra, Geodesy, and GPS", SIAM, 624 pages, 1997.</li>
<li>Paul Wolf and Bon DeWitt, "Elements of Photogrammetry with Applications in GIS", McGraw-Hill, 2000</li>
<li>Karl-Rudolf Koch, "Parameter Estimation and Hypothesis Testing in Linear Models", 2a ed., Springer, 2000</li>
<li>P.J.G. Teunissen, "Adjustment theory, an introduction", Delft Academic Press, 2000</li>
<li>Edward M. Mikhail, James S. Bethel, J. Chris McGlone, "Introduction to Modern Photogrammetry", Wiley, 2001</li>
<li>Harvey, Bruce R., "Practical least squares and statistics for surveyors", Monograph 13, Third Edition, School of Surveying and Spatial Information Systems, University of New South Wales, 2006</li>
<li>Huaan Fan, "Theory of Errors and Least Squares Adjustment", Royal Institute of Technology (KTH), Division of Geodesy and Geoinformatics, Stockholm, Sweden, 2010, ISBN 91-7170-200-8.</li>
<li></li>
<li>Charles D. Ghilani, "Adjustment Computations: Spatial Data Analysis", John Wiley &amp; Sons, 2011</li>
<li>Charles D. Ghilani and Paul R. Wolf, "Elementary Surveying: An Introduction to Geomatics", 13th Edition, Prentice Hall, 2011</li>
<li>Erik Grafarend and Joseph Awange, "Applications of Linear and Nonlinear Models: Fixed Effects, Random Effects, and Total Least Squares", Springer, 2012</li>
<li>Alfred Leick, Lev Rapoport, and Dmitry Tatarnikov, "GPS Satellite Surveying", 4th Edition, John Wiley &amp; Sons, ISBN 9781119018612; Chapter 2, "Least-Squares Adjustments", pp. 11–79, <a class="uri" href="doi:10.1002/9781119018612.ch2">doi:10.1002/9781119018612.ch2</a></li>
</ul>

<p>"</p>

<p><a href="Category:Least_squares" title="wikilink">Category:Least squares</a> <a class="uri" href="Category:Geodesy" title="wikilink">Category:Geodesy</a> <a class="uri" href="Category:Surveying" title="wikilink">Category:Surveying</a> <a class="uri" href="Category:Photogrammetry" title="wikilink">Category:Photogrammetry</a></p>
</body>
</html>

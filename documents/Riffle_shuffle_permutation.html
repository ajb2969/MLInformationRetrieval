<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="364">Riffle shuffle permutation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Riffle shuffle permutation</h1>
<hr/>

<p>In the mathematics of <a href="permutation" title="wikilink">permutations</a> and the study of <a class="uri" href="shuffling" title="wikilink">shuffling</a> <a href="playing_card" title="wikilink">playing cards</a>, a <strong>riffle shuffle permutation</strong> is one of the <a href="permutation" title="wikilink">permutations</a> of a set of <em>n</em> items that can be obtained by a single <a href="shuffling" title="wikilink">riffle shuffle</a>, in which a sorted deck of <em>n</em> cards is cut into two packets and then the two packets are interleaved (e.g. by moving cards one at a time from the bottom of one or the other of the packets to the top of the sorted deck).</p>

<p>As a special case of this, a (<em>p</em>,<em>q</em>)-<strong>shuffle</strong>, for numbers <em>p</em> and <em>q</em> with <em>p</em> + <em>q</em> = <em>n</em>, is a riffle in which the first packet has <em>p</em> cards and the second packet has <em>q</em> cards.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="combinatorial-enumeration">Combinatorial enumeration</h2>

<p>Since a (<em>p</em>,<em>q</em>)-shuffle is completely determined by how its first <em>p</em> elements are mapped, the number of (<em>p</em>,<em>q</em>)-shuffles is</p>

<p>

<math display="block" id="Riffle_shuffle_permutation:0">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mrow>
        <mi>p</mi>
        <mo>+</mo>
        <mi>q</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>p</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <apply>
     <plus></plus>
     <ci>p</ci>
     <ci>q</ci>
    </apply>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{p+q}\atop{p}}\right)}.
  </annotation>
 </semantics>
</math>

 The <a href="wedge_product" title="wikilink">wedge product</a> of a <em>p</em>-form and a <em>q</em>-form can be defined as a sum over (<em>p</em>,<em>q</em>)-shuffles.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>However, the number of distinct riffles is not quite the sum of this formula over all choices of <em>p</em> and <em>q</em> adding to <em>n</em> (which would be <em>2</em><sup><em>n</em></sup>), because the <a href="identity_permutation" title="wikilink">identity permutation</a> can be represented in multiple ways as a (<em>p</em>,<em>q</em>)-shuffle for different values of <em>p</em> and <em>q</em>. Instead, the number of distinct riffle shuffle permutations of a deck of <em>n</em> cards, for <em>n</em> = 1, 2, 3, ..., is</p>
<dl>
<dd>1, 2, 5, 12, 27, 58, 121, 248, 503, 1014, ... 
</dd>
</dl>

<p>More generally, the formula for this number is 2<sup><em>n</em></sup> − <em>n</em>; for instance, there are 4503599627370444 riffle shuffle permutations of a 52-card deck.</p>

<p>The number of permutations that are both a riffle shuffle permutation and the inverse permutation of a riffle shuffle is<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>

<math display="block" id="Riffle_shuffle_permutation:1">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mn>3</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>+</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">3</cn>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {\left({{n+1}\atop{3}}\right)}+1.
  </annotation>
 </semantics>
</math>

 For <em>n</em> = 1, 2, 3, ..., this is</p>
<dl>
<dd>1, 2, 5, 11, 21, 36, 57, 85, 121, 166, 221, ... 
</dd>
</dl>

<p>and for <em>n</em> = 52 there are exactly 23427 invertible shuffles.</p>
<h2 id="random-distribution">Random distribution</h2>

<p>The <a href="Gilbert–Shannon–Reeds_model" title="wikilink">Gilbert–Shannon–Reeds model</a> describes a random <a href="probability_distribution" title="wikilink">probability distribution</a> on riffle shuffles that is a good match for observed human shuffles.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> In this model, the <a href="identity_permutation" title="wikilink">identity permutation</a> has probability (<em>n</em> + 1)/2<sup><em>n</em></sup> of being generated, and all other riffle permutations have equal probability 1/2<sup><em>n</em></sup> of being generated. Based on their analysis of this model, mathematicians have recommended that a deck of 52 cards be given seven riffles in order to thoroughly randomize it.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="permutation-patterns">Permutation patterns</h2>

<p>A <a href="permutation_pattern" title="wikilink">pattern</a> in a permutation is a smaller permutation formed from a subsequence of some <em>k</em> values in the permutation by reducing these values to the range from 1 to <em>k</em> while preserving their order. Several important families of permutations can be characterized by a finite set of forbidden patterns, and this is true also of the riffle shuffle permutations: they are exactly the permutations that do not have 321, 2143, and 2413 as patterns.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> Thus, for instance, they are a subclass of the <a href="vexillary_permutation" title="wikilink">vexillary permutations</a>, which have 2143 as their only minimal forbidden pattern.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>
<h2 id="perfect-shuffles">Perfect shuffles</h2>

<p>A <em>perfect shuffle</em> is a riffle in which the deck is split into two equal-sized packets, and in which the interleaving between these two packets strictly alternates between the two. There are two types of perfect shuffle, an <a href="in_shuffle" title="wikilink">in shuffle</a> and an <a href="out_shuffle" title="wikilink">out shuffle</a>, both of which can be performed consistently by some well-trained people. When a deck is repeatedly shuffled using these permutations, it remains much less random than with typical riffle shuffles, and it will return to its initial state after only a small number of perfect shuffles. In particular, a deck of 52 playing cards will be returned to its original ordering after 52 in shuffles or 8 out shuffles. This fact forms the basis of several magic tricks.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Gilbreath_shuffle" title="wikilink">Gilbreath permutations</a>, the permutations formed by reversing one of the two packets of cards before riffling them</li>
</ul>
<h2 id="references">References</h2>

<p>"</p>

<p><a href="Category:Card_shuffling" title="wikilink">Category:Card shuffling</a> <a href="Category:Permutation_patterns" title="wikilink">Category:Permutation patterns</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Weibel, Charles (1994). <em>An Introduction to Homological Algebra</em>, p. 181. Cambridge University Press, Cambridge.<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">.<a href="#fnref3">↩</a></li>
<li id="fn4">.<a href="#fnref4">↩</a></li>
<li id="fn5">.<a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7">.<a href="#fnref7">↩</a></li>
<li id="fn8">.<a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>

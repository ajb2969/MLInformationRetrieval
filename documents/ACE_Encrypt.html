<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="896">ACE Encrypt</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>ACE Encrypt</h1>
<hr/>

<p><strong>ACE</strong> (<em>Advanced Cryptographic Engine</em>) — the collection of units, implementing both a public key encryption scheme and a digital signature scheme. Corresponding names for these schemes — «ACE Encrypt» and «ACE Sign». Schemes are based on Cramer-Shoup public key encryption scheme and Cramer-Shoup signature scheme. Introduced variants of these schemes are intended to achieve a good balance between performance and security of the whole encryption system.</p>
<h2 id="authors">Authors</h2>

<p>All the algorithms, implemented in ACE are based on algorithms developed by Victor Shoup and Ronald Cramer. The full algorithms specification is written by Victor Shoup. Implementation of algorithms is done by Thomas Schweinberger and Mehdi Nassehi, its supporting and maintaining is done by Victor Shoup. Thomas Schweinberger participated in construction of ACE specification document and also wrote a user manual.</p>

<p>Ronald Cramer currently stays in the university of Aarhus, <a class="uri" href="Denmark" title="wikilink">Denmark</a>. He worked on the project of ACE Encrypt while his staying in ETH in <a class="uri" href="Zürich" title="wikilink">Zürich</a>, <a class="uri" href="Switzerland" title="wikilink">Switzerland</a>.</p>

<p>Mehdi Nassehi and Thomas Schweinberger worked on ACE project in the IBM research lab in <a class="uri" href="Zürich" title="wikilink">Zürich</a>, <a class="uri" href="Switzerland" title="wikilink">Switzerland</a>.<br/>
Victor Shoup works in the IBM research lab in <a class="uri" href="Zürich" title="wikilink">Zürich</a>, <a class="uri" href="Switzerland" title="wikilink">Switzerland</a>.</p>
<h2 id="security">Security</h2>

<p>The encryption scheme in ACE can be proven secure under reasonable and natural intractability assumptions. These four assumptions are:</p>
<ul>
<li>The Decisional Diffie-Hellman (DDH) assumption</li>
<li>Strong RSA assumption</li>
<li>SHA-1 second preimage collision resistance</li>
<li>MARS sum/counter mode pseudo-randomness</li>
</ul>
<h2 id="basic-terminology-and-notation">Basic Terminology and Notation</h2>

<p>Here we introduce some notations, being used in this article.</p>
<h3 id="basic-mathematical-notation">Basic mathematical notation</h3>

<p>

<math display="inline" id="ACE_Encrypt:0">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>Z</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z\,
  </annotation>
 </semantics>
</math>

 — The set of integers.<br/>


<math display="inline" id="ACE_Encrypt:1">
 <semantics>
  <mrow>
   <msub>
    <mi>F</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>T</mi>
    <mo rspace="4.2pt" stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>F</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{2}[T]\,
  </annotation>
 </semantics>
</math>

 — The set of univariate polynomials with coefficients in the finite field 

<math display="inline" id="ACE_Encrypt:2">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>F</mi>
    <mn>2</mn>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>F</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F_{2}\,
  </annotation>
 </semantics>
</math>

 of cardinality 2.<br/>


<math display="inline" id="ACE_Encrypt:3">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mi>r</mi>
   <mi>e</mi>
   <mi>m</mi>
   <mpadded width="+1.7pt">
    <mi>n</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>A</ci>
    <ci>r</ci>
    <ci>e</ci>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Aremn\,
  </annotation>
 </semantics>
</math>

 — integer 

<math display="inline" id="ACE_Encrypt:4">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>r</ci>
    <set>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\in\left\{0,...,n-1\right\}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="ACE_Encrypt:5">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>≡</mo>
   <mrow>
    <mi>r</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>m</mi>
      <mi>o</mi>
      <mi>d</mi>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>A</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\equiv r(modn)
  </annotation>
 </semantics>
</math>

 for integer 

<math display="inline" id="ACE_Encrypt:6">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>n</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n>0\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:7">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <mi>Z</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>A</ci>
    <ci>Z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\in Z\,
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:8">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mi>r</mi>
   <mi>e</mi>
   <mi>m</mi>
   <mpadded width="+1.7pt">
    <mi>f</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>A</ci>
    <ci>r</ci>
    <ci>e</ci>
    <ci>m</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Aremf\,
  </annotation>
 </semantics>
</math>

 — polynomial 

<math display="inline" id="ACE_Encrypt:9">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>∈</mo>
   <mrow>
    <msub>
     <mi>F</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>T</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>r</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\in F_{2}[T]
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="ACE_Encrypt:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mo>,</mo>
     <mi>f</mi>
    </mrow>
    <mo>∈</mo>
    <mrow>
     <msub>
      <mi>F</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>T</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>f</mi>
    <mo>≠</mo>
    <mpadded width="+1.7pt">
     <mn>0</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <in></in>
     <list>
      <ci>A</ci>
      <ci>f</ci>
     </list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>T</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <neq></neq>
     <ci>f</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A,f\in F_{2}[T],f\neq 0\,
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="ACE_Encrypt:11">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>A</mi>
    <mo>∗</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>normal-∗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{\ast}\,
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="basic-string-notation">Basic string notation</h3>

<p>

<math display="inline" id="ACE_Encrypt:12">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>A</mi>
    <mi>n</mi>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>A</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A^{n}\,
  </annotation>
 </semantics>
</math>

 — The set of all strings.<br/>


<math display="inline" id="ACE_Encrypt:13">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>A</mi>
     <mo>∗</mo>
    </msup>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <ci>normal-∗</ci>
     </apply>
     <ci>L</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in A^{\ast}L(x)
  </annotation>
 </semantics>
</math>

 — The set of all strings with length n.<br/>
For 

<math display="inline" id="ACE_Encrypt:14">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>x</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\,
  </annotation>
 </semantics>
</math>

 — length of string 

<math display="inline" id="ACE_Encrypt:15">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>λ</mi>
    <mi>A</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{A}\,
  </annotation>
 </semantics>
</math>

. The string of length zero is denoted 

<math display="inline" id="ACE_Encrypt:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>A</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>x</ci>
     <ci>y</ci>
    </list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,y\in A^{\ast}
  </annotation>
 </semantics>
</math>

.<br/>
For 

<math display="inline" id="ACE_Encrypt:17">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <mpadded width="+1.7pt">
    <mi>y</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">x</csymbol>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <csymbol cd="unknown">y</csymbol>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x||y\,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="ACE_Encrypt:18">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>x</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\,
  </annotation>
 </semantics>
</math>

 — the result of 

<math display="inline" id="ACE_Encrypt:19">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>y</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:20">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <mrow>
    <mo>{</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <eq></eq>
     <ci>def</ci>
    </apply>
    <ci>b</ci>
    <set>
     <cn type="integer">0</cn>
     <cn type="integer">1</cn>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b\stackrel{\mathrm{def}}{=}\left\{0,1\right\}
  </annotation>
 </semantics>
</math>

 concatenation.</p>
<h3 id="bits-bytes-words">Bits, Bytes, Words</h3>

<p>

<math display="inline" id="ACE_Encrypt:21">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>,</mo>
   <msup>
    <mi>b</mi>
    <msub>
     <mi>n</mi>
     <mn>1</mn>
    </msub>
   </msup>
   <mo>,</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>b</mi>
      <msub>
       <mi>n</mi>
       <mn>1</mn>
      </msub>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>n</mi>
     <mn>2</mn>
    </msub>
   </msup>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>b</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b,b^{n_{1}},(b^{n_{1}})^{n_{2}},...
  </annotation>
 </semantics>
</math>

 — The set of bits.<br/>
 Let us take all sets of form 

<math display="inline" id="ACE_Encrypt:22">
 <semantics>
  <mrow>
   <msub>
    <mn>0</mn>
    <mi>b</mi>
   </msub>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <mn>0</mn>
   <mo>∈</mo>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <eq></eq>
      <ci>def</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <cn type="integer">0</cn>
      <ci>b</ci>
     </apply>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <ci>b</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0_{b}\stackrel{\mathrm{def}}{=}0\in b
  </annotation>
 </semantics>
</math>

. For such a set A we define the "zero element":</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:23">
 <semantics>
  <mrow>
   <msub>
    <mn>0</mn>
    <msup>
     <mi>A</mi>
     <mi>n</mi>
    </msup>
   </msub>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mn>0</mn>
     <mi>A</mi>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mn>0</mn>
     <mi>A</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>A</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <eq></eq>
      <ci>def</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <cn type="integer">0</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <cn type="integer">0</cn>
       <ci>A</ci>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <cn type="integer">0</cn>
       <ci>A</ci>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0_{A^{n}}\stackrel{\mathrm{def}}{=}(0_{A},...,0_{A})\in A^{n}
  </annotation>
 </semantics>
</math>

;<br/>


<math display="inline" id="ACE_Encrypt:24">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>n</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n>0\,
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="ACE_Encrypt:25">
 <semantics>
  <mrow>
   <mi>B</mi>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <msup>
    <mi>b</mi>
    <mn>8</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <eq></eq>
     <ci>def</ci>
    </apply>
    <ci>B</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">8</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B\stackrel{\mathrm{def}}{=}b^{8}
  </annotation>
 </semantics>
</math>

.</p>
</center>

<p>We define 

<math display="inline" id="ACE_Encrypt:26">
 <semantics>
  <mrow>
   <mi>W</mi>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <msup>
    <mi>b</mi>
    <mn>32</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <eq></eq>
     <ci>def</ci>
    </apply>
    <ci>W</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <cn type="integer">32</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W\stackrel{\mathrm{def}}{=}b^{32}
  </annotation>
 </semantics>
</math>

 as a set of bytes, and 

<math display="inline" id="ACE_Encrypt:27">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>A</mi>
     <mo>∗</mo>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>A</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in A^{\ast}\,
  </annotation>
 </semantics>
</math>

 as a set of words.</p>

<p>For 

<math display="inline" id="ACE_Encrypt:28">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mi>b</mi>
    <mo>,</mo>
    <mi>B</mi>
    <mo>,</mo>
    <mi>W</mi>
    <mo rspace="4.2pt">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>A</ci>
    <set>
     <ci>b</ci>
     <ci>B</ci>
     <ci>W</ci>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\in\left\{b,B,W\right\}\,
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="ACE_Encrypt:29">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l>0\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:30">
 <semantics>
  <mrow>
   <msubsup>
    <mi>I</mi>
    <mrow>
     <mi>s</mi>
     <mi>r</mi>
     <mi>c</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>s</mi>
     <mi>t</mi>
    </mrow>
   </msubsup>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mi>s</mi>
     <mi>r</mi>
     <mi>c</mi>
    </mrow>
    <mo>→</mo>
    <mrow>
     <mi>d</mi>
     <mi>s</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>I</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>r</ci>
       <ci>c</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>s</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <times></times>
      <ci>s</ci>
      <ci>r</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>s</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I_{src}^{dst}:src\rightarrow dst
  </annotation>
 </semantics>
</math>

 we define a padding operator:</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:31">
 <semantics>
  <mrow>
   <mi>Z</mi>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>F</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>T</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
   <msup>
    <mi>b</mi>
    <mo>∗</mo>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>W</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>Z</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <ci>normal-∗</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>W</ci>
     <ci>normal-∗</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z,F_{2}[T],b^{\ast},B^{\ast},W^{\ast}
  </annotation>
 </semantics>
</math>

</p>
</center>
<h3 id="conversion-operator">Conversion operator</h3>

<p>Conversion operator 

<math display="block" id="ACE_Encrypt:32">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>P</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi>c</mi>
   <mo>,</mo>
   <mi>d</mi>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>2</mn>
   </msub>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>P</ci>
    <ci>q</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (P,q,g_{1},g_{2},c,d,h_{1},h_{2},k_{1},k_{2})\,
  </annotation>
 </semantics>
</math>

 makes a conversion between elements 

<math display="block" id="ACE_Encrypt:33">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>w</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mn>2</mn>
   </msub>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>w</ci>
    <ci>x</ci>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">2</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,x,y,z_{1},z_{2})\,
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="encryption-scheme">Encryption Scheme</h2>
<h3 id="encryption-key-pair">Encryption Key Pair</h3>

<p>The encryption scheme employs two key types:<br/>
ACE public key

<math display="inline" id="ACE_Encrypt:34">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>m</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\,
  </annotation>
 </semantics>
</math>

.<br/>
ACE private key

<math display="inline" id="ACE_Encrypt:35">
 <semantics>
  <mrow>
   <mn>1024</mn>
   <mo>≤</mo>
   <mi>m</mi>
   <mo>≤</mo>
   <mn>16384</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1024</cn>
     <ci>m</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">16384</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1024\leq m\leq 16384
  </annotation>
 </semantics>
</math>

.<br/>
For a given size parameter m 

<math display="inline" id="ACE_Encrypt:36">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>q</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\,
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:37">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>P</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\,
  </annotation>
 </semantics>
</math>

, key components are defined as:<br/>


<math display="inline" id="ACE_Encrypt:38">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>≡</mo>
   <mrow>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>m</mi>
      <mi>o</mi>
      <mi>d</mi>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>P</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\equiv 1(modq)
  </annotation>
 </semantics>
</math>

 — a 256-bit prime number.<br/>


<math display="inline" id="ACE_Encrypt:39">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi>c</mi>
   <mo>,</mo>
   <mi>d</mi>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>h</mi>
     <mn>2</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{1},g_{2},c,d,h_{1},h_{2}\,
  </annotation>
 </semantics>
</math>

 — a m-bit prime number, such that 

<math display="inline" id="ACE_Encrypt:40">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>P</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <ci>P</ci>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{1,...,P-1\right\}
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:41">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>P</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\,
  </annotation>
 </semantics>
</math>

 — elements 

<math display="inline" id="ACE_Encrypt:42">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>q</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\,
  </annotation>
 </semantics>
</math>

 (whose multiplicative order modulo 

<math display="inline" id="ACE_Encrypt:43">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>z</mi>
     <mn>2</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>w</ci>
    <ci>x</ci>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w,x,y,z_{1},z_{2}\,
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="ACE_Encrypt:44">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>q</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">0</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <ci>q</ci>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{0,...,q-1\right\}
  </annotation>
 </semantics>
</math>

).<br/>


<math display="inline" id="ACE_Encrypt:45">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>k</mi>
     <mn>2</mn>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1},k_{2}\,
  </annotation>
 </semantics>
</math>

 — elements 

<math display="inline" id="ACE_Encrypt:46">
 <semantics>
  <msup>
   <mi>B</mi>
   <mo>∗</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>B</ci>
    <ci>normal-∗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B^{\ast}
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:47">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>20</mn>
     <msup>
      <mi>l</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo>+</mo>
    <mn>64</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">20</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>l</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <cn type="integer">64</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(k_{1})=20l^{\prime}+64
  </annotation>
 </semantics>
</math>

 — elements 

<math display="inline" id="ACE_Encrypt:48">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>32</mn>
     <mrow>
      <mo>⌈</mo>
      <mrow>
       <mi>l</mi>
       <mo>/</mo>
       <mn>16</mn>
      </mrow>
      <mo>⌉</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mn>40</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">32</cn>
      <apply>
       <ceiling></ceiling>
       <apply>
        <divide></divide>
        <ci>l</ci>
        <cn type="integer">16</cn>
       </apply>
      </apply>
     </apply>
     <cn type="integer">40</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(k_{2})=32\left\lceil l/16\right\rceil+40
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="ACE_Encrypt:49">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mrow>
    <mo>⌈</mo>
    <mrow>
     <mi>m</mi>
     <mo>/</mo>
     <mn>8</mn>
    </mrow>
    <mo>⌉</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <apply>
     <ceiling></ceiling>
     <apply>
      <divide></divide>
      <ci>m</ci>
      <cn type="integer">8</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=\left\lceil m/8\right\rceil
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:50">
 <semantics>
  <mrow>
   <msup>
    <mi>l</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>b</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>⌈</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mo>⌈</mo>
           <mrow>
            <mi>l</mi>
            <mo>/</mo>
            <mn>4</mn>
           </mrow>
           <mo>⌉</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mn>4</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>16</mn>
      </mrow>
      <mo>⌉</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>l</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <ceiling></ceiling>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <ceiling></ceiling>
          <apply>
           <divide></divide>
           <ci>l</ci>
           <cn type="integer">4</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">4</cn>
       </apply>
       <cn type="integer">16</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l^{\prime}=L_{b}(\left\lceil(2\left\lceil l/4\right\rceil+4)/16\right\rceil)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="ACE_Encrypt:51">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>m</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:52">
 <semantics>
  <mrow>
   <mn>1024</mn>
   <mo>≤</mo>
   <mi>m</mi>
   <mo>≤</mo>
   <mn>16384</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1024</cn>
     <ci>m</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">16384</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1024\leq m\leq 16384
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="key-generation">Key Generation</h3>

<p><strong>Algorithm.</strong> Key Generation for ACE encryption scheme.<br/>
Input: a size parameter m 

<math display="inline" id="ACE_Encrypt:53">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>q</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\,
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:54">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>255</mn>
   </msup>
   <mo><</mo>
   <mi>q</mi>
   <mo><</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mn>2</mn>
     <mn>256</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">255</cn>
     </apply>
     <ci>q</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">256</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{255}<q<2^{256}\,
  </annotation>
 </semantics>
</math>

.<br/>
Output: a public/private key pair.</p>
<ol>
<li>Generate a random prime 

<math display="inline" id="ACE_Encrypt:55">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>P</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\,
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:56">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <mi>m</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo><</mo>
   <mi>P</mi>
   <mo><</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mn>2</mn>
     <mi>m</mi>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>P</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{m-1}<P<2^{m}\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate a random prime 

<math display="inline" id="ACE_Encrypt:57">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mo>≡</mo>
   <mrow>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>m</mi>
      <mi>o</mi>
      <mi>d</mi>
      <mi>q</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <ci>P</ci>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>q</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\equiv 1(modq)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:58">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mn>1</mn>
   </msub>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>P</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">1</cn>
    </apply>
    <set>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>P</ci>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{1}\in\left\{2,...,P-1\right\}
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:59">
 <semantics>
  <mrow>
   <msubsup>
    <mi>g</mi>
    <mn>1</mn>
    <mi>q</mi>
   </msubsup>
   <mo>≡</mo>
   <mrow>
    <mn>1</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>m</mi>
      <mi>o</mi>
      <mi>d</mi>
      <mi>P</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <equivalent></equivalent>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>q</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>P</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{1}^{q}\equiv 1(modP)
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate a random integer 

<math display="inline" id="ACE_Encrypt:60">
 <semantics>
  <mrow>
   <mi>w</mi>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>w</ci>
    <set>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w\in\left\{1,...,q-1\right\}
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:61">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>x</ci>
     <ci>y</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
    </list>
    <set>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,y,z_{1},z_{2}\in\left\{0,...,q-1\right\}
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate random integers 

<math display="inline" id="ACE_Encrypt:62">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>P</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <ci>P</ci>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{1,...,P-1\right\}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:63">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mn>2</mn>
   </msub>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>g</mi>
     <mn>1</mn>
     <mi>w</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>w</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{2}\leftarrow g_{1}^{w}remP
  </annotation>
 </semantics>
</math>

</li>
<li>Compute the following integers in 

<math display="inline" id="ACE_Encrypt:64">
 <semantics>
  <mrow>
   <mi>c</mi>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>g</mi>
     <mn>1</mn>
     <mi>x</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>c</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>x</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   c\leftarrow g_{1}^{x}remP
  </annotation>
 </semantics>
</math>

:
<center>

<p>

<math display="inline" id="ACE_Encrypt:65">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>g</mi>
     <mn>1</mn>
     <mi>y</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>d</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>y</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\leftarrow g_{1}^{y}remP
  </annotation>
 </semantics>
</math>

,<br/>


<math display="inline" id="ACE_Encrypt:66">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mn>1</mn>
   </msub>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>g</mi>
     <mn>1</mn>
     <msub>
      <mi>z</mi>
      <mn>1</mn>
     </msub>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{1}\leftarrow g_{1}^{z_{1}}remP
  </annotation>
 </semantics>
</math>

,<br/>


<math display="inline" id="ACE_Encrypt:67">
 <semantics>
  <mrow>
   <msub>
    <mi>h</mi>
    <mn>2</mn>
   </msub>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>g</mi>
     <mn>1</mn>
     <msub>
      <mi>z</mi>
      <mn>2</mn>
     </msub>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h_{2}\leftarrow g_{1}^{z_{2}}remP
  </annotation>
 </semantics>
</math>

,<br/>


<math display="inline" id="ACE_Encrypt:68">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mrow>
     <mrow>
      <mn>20</mn>
      <msup>
       <mi>l</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo>+</mo>
     <mn>64</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">20</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>l</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <cn type="integer">64</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{1}\in B^{20l^{\prime}+64}
  </annotation>
 </semantics>
</math>

,<br/>


<math display="inline" id="ACE_Encrypt:69">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mn>2</mn>
   </msub>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo>⌈</mo>
       <mrow>
        <mi>l</mi>
        <mo>/</mo>
        <mn>16</mn>
       </mrow>
       <mo>⌉</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mn>40</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <ceiling></ceiling>
        <apply>
         <divide></divide>
         <ci>l</ci>
         <cn type="integer">16</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">40</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{2}\in B^{2\left\lceil l/16\right\rceil+40}
  </annotation>
 </semantics>
</math>

.</p>
</center></li>
<li>Generate random byte strings 

<math display="inline" id="ACE_Encrypt:70">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>B</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>B</ci>
     </apply>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=L_{B}(P)\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:71">
 <semantics>
  <mrow>
   <msup>
    <mi>l</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>B</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>⌈</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mo>⌈</mo>
           <mrow>
            <mi>l</mi>
            <mo>/</mo>
            <mn>4</mn>
           </mrow>
           <mo>⌉</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mn>4</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>16</mn>
      </mrow>
      <mo>⌉</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>l</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <ceiling></ceiling>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <ceiling></ceiling>
          <apply>
           <divide></divide>
           <ci>l</ci>
           <cn type="integer">4</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">4</cn>
       </apply>
       <cn type="integer">16</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l^{\prime}=L_{B}(\left\lceil(2\left\lceil l/4\right\rceil+4)/16\right\rceil)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="ACE_Encrypt:72">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>P</mi>
    <mo>,</mo>
    <mi>q</mi>
    <mo>,</mo>
    <msub>
     <mi>g</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>g</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi>c</mi>
    <mo>,</mo>
    <mi>d</mi>
    <mo>,</mo>
    <msub>
     <mi>h</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>h</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>k</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>k</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mo>,</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>z</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <vector>
     <ci>P</ci>
     <ci>q</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>c</ci>
     <ci>d</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <cn type="integer">2</cn>
     </apply>
    </vector>
    <vector>
     <ci>w</ci>
     <ci>x</ci>
     <ci>y</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
    </vector>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ((P,q,g_{1},g_{2},c,d,h_{1},h_{2},k_{1},k_{2}),(w,x,y,z_{1},z_{2}))\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:73">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>s</mi>
   <mo>,</mo>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>u</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi>v</mi>
   <mo>,</mo>
   <mi>e</mi>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>v</ci>
    <ci>e</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (s,u_{1},u_{2},v,e)\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Return the public key/private key pair
<center>

<p>

<math display="inline" id="ACE_Encrypt:74">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>u</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <mi>v</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>v</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1},u_{2},v\,
  </annotation>
 </semantics>
</math>

</p>
</center></li>
</ol>
<h3 id="ciphertext-representation">Ciphertext Representation</h3>

<p>A ciphertext of the ACE encryption scheme has the form<br/>
</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:75">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>P</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <ci>P</ci>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{1,...,P-1\right\}
  </annotation>
 </semantics>
</math>

,</p>
</center>

<p><br/>
where the components are defined as:<br/>


<math display="inline" id="ACE_Encrypt:76">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>P</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P\,
  </annotation>
 </semantics>
</math>

 — integers from 

<math display="inline" id="ACE_Encrypt:77">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>q</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\,
  </annotation>
 </semantics>
</math>

 (whose multiplicative order modulo 

<math display="inline" id="ACE_Encrypt:78">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>s</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\,
  </annotation>
 </semantics>
</math>

 divides 

<math display="inline" id="ACE_Encrypt:79">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>W</mi>
    <mn>4</mn>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>W</ci>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W^{4}\,
  </annotation>
 </semantics>
</math>

).<br/>


<math display="inline" id="ACE_Encrypt:80">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>e</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\,
  </annotation>
 </semantics>
</math>

 — element 

<math display="inline" id="ACE_Encrypt:81">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>B</ci>
    <ci>normal-∗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B^{\ast}\,
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:82">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>,</mo>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>u</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <mi>v</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>v</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s,u_{1},u_{2},v\,
  </annotation>
 </semantics>
</math>

 — element 

<math display="inline" id="ACE_Encrypt:83">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>e</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\,
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:84">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>l</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l\,
  </annotation>
 </semantics>
</math>

 we call the <em>preamble</em>, and 

<math display="inline" id="ACE_Encrypt:85">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>e</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\,
  </annotation>
 </semantics>
</math>

 — the <em>cryptogram</em>. If a cleartext is a string consisting of 

<math display="inline" id="ACE_Encrypt:86">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>+</mo>
   <mrow>
    <mn>16</mn>
    <mrow>
     <mo>⌈</mo>
     <mrow>
      <mi>l</mi>
      <mo>/</mo>
      <mn>1024</mn>
     </mrow>
     <mo>⌉</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>l</ci>
    <apply>
     <times></times>
     <cn type="integer">16</cn>
     <apply>
      <ceiling></ceiling>
      <apply>
       <divide></divide>
       <ci>l</ci>
       <cn type="integer">1024</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l+16\left\lceil l/1024\right\rceil
  </annotation>
 </semantics>
</math>

 байт, then the length of 

<math display="inline" id="ACE_Encrypt:87">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mi>E</mi>
   <mi>n</mi>
   <mi>c</mi>
   <mi>o</mi>
   <mi>d</mi>
   <mpadded width="+1.7pt">
    <mi>e</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>C</ci>
    <ci>E</ci>
    <ci>n</ci>
    <ci>c</ci>
    <ci>o</ci>
    <ci>d</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   CEncode\,
  </annotation>
 </semantics>
</math>

 is equal to 

<math display="inline" id="ACE_Encrypt:88">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mi>D</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mi>o</mi>
   <mi>d</mi>
   <mpadded width="+1.7pt">
    <mi>e</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>C</ci>
    <ci>D</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>o</ci>
    <ci>d</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   CDecode\,
  </annotation>
 </semantics>
</math>

.<br/>
We need to introduce the function 

<math display="inline" id="ACE_Encrypt:89">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l>0\,
  </annotation>
 </semantics>
</math>

, which maps a ciphertext to its byte-string representation, and the corresponding inverse function 

<math display="inline" id="ACE_Encrypt:90">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>∈</mo>
   <msup>
    <mi>W</mi>
    <mn>4</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>W</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\in W^{4}
  </annotation>
 </semantics>
</math>

. For the integer 

<math display="inline" id="ACE_Encrypt:91">
 <semantics>
  <mrow>
   <mrow>
    <mn>0</mn>
    <mo>≤</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>v</mi>
    <mo><</mo>
    <msup>
     <mn>256</mn>
     <mi>l</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
     </list>
    </apply>
    <apply>
     <lt></lt>
     <ci>v</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">256</cn>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq u_{1},u_{2},v<256^{l}
  </annotation>
 </semantics>
</math>

, word string 

<math display="inline" id="ACE_Encrypt:92">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\in B^{\ast}
  </annotation>
 </semantics>
</math>

, integers 

<math display="inline" id="ACE_Encrypt:93">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mi>E</mi>
    <mi>n</mi>
    <mi>c</mi>
    <mi>o</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi>v</mi>
     <mo>,</mo>
     <mi>e</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <mrow>
    <msubsup>
     <mi>I</mi>
     <msup>
      <mi>W</mi>
      <mo>∗</mo>
     </msup>
     <msup>
      <mi>B</mi>
      <mo>∗</mo>
     </msup>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo fence="true">||</mo>
     <mrow>
      <mi>p</mi>
      <mi>a</mi>
      <msub>
       <mi>d</mi>
       <mi>l</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>I</mi>
         <mi>Z</mi>
         <msup>
          <mi>B</mi>
          <mo>∗</mo>
         </msup>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>u</mi>
          <mn>1</mn>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">||</mo>
    </mrow>
    <mi>p</mi>
    <mi>a</mi>
    <msub>
     <mi>d</mi>
     <mi>l</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mi>I</mi>
       <mi>Z</mi>
       <msup>
        <mi>B</mi>
        <mo>∗</mo>
       </msup>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>u</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo fence="true">||</mo>
     <mrow>
      <mi>p</mi>
      <mi>a</mi>
      <msub>
       <mi>d</mi>
       <mi>l</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>I</mi>
         <mi>Z</mi>
         <msup>
          <mi>B</mi>
          <mo>∗</mo>
         </msup>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>v</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">||</mo>
    </mrow>
    <mi>e</mi>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <eq></eq>
      <ci>def</ci>
     </apply>
     <apply>
      <times></times>
      <ci>C</ci>
      <ci>E</ci>
      <ci>n</ci>
      <ci>c</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>e</ci>
      <vector>
       <ci>l</ci>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>v</ci>
       <ci>e</ci>
      </vector>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>I</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>W</ci>
         <ci>normal-∗</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>B</ci>
        <ci>normal-∗</ci>
       </apply>
      </apply>
      <ci>s</ci>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>a</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>I</ci>
           <ci>Z</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>B</ci>
           <ci>normal-∗</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>p</ci>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>l</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>Z</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>B</ci>
         <ci>normal-∗</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>a</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>I</ci>
           <ci>Z</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>B</ci>
           <ci>normal-∗</ci>
          </apply>
         </apply>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
      <ci>e</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <ci>normal-∗</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   CEncode(l,s,u_{1},u_{2},v,e)\stackrel{\mathrm{def}}{=}I_{W^{\ast}}^{B^{\ast}}(%
s)||pad_{l}(I_{Z}^{B^{\ast}}(u_{1}))||pad_{l}(I_{Z}^{B^{\ast}}(u_{2}))||pad_{l%
}(I_{Z}^{B^{\ast}}(v))||e\in B^{\ast}
  </annotation>
 </semantics>
</math>

, and byte string 

<math display="inline" id="ACE_Encrypt:94">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l>0\,
  </annotation>
 </semantics>
</math>

,</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:95">
 <semantics>
  <mrow>
   <mi>ψ</mi>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>ψ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi\in B^{\ast}
  </annotation>
 </semantics>
</math>

.</p>
</center>

<p><br/>
For integer 

<math display="inline" id="ACE_Encrypt:96">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <mrow>
     <mn>3</mn>
     <mi>l</mi>
    </mrow>
    <mo>+</mo>
    <mn>16</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>ψ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>l</ci>
     </apply>
     <cn type="integer">16</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(\psi)\geq 3l+16
  </annotation>
 </semantics>
</math>

, byte string 

<math display="inline" id="ACE_Encrypt:97">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mi>D</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mi>o</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msubsup>
      <mi>I</mi>
      <msup>
       <mi>B</mi>
       <mo>∗</mo>
      </msup>
      <msup>
       <mi>W</mi>
       <mo>∗</mo>
      </msup>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mi>ψ</mi>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mn>0</mn>
       <mn>16</mn>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msubsup>
      <mi>I</mi>
      <msup>
       <mi>B</mi>
       <mo>∗</mo>
      </msup>
      <mi>Z</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mi>ψ</mi>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mn>16</mn>
       <mrow>
        <mn>16</mn>
        <mo>+</mo>
        <mi>l</mi>
       </mrow>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msubsup>
      <mi>I</mi>
      <msup>
       <mi>B</mi>
       <mo>∗</mo>
      </msup>
      <mi>Z</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mi>ψ</mi>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mrow>
        <mn>16</mn>
        <mo>+</mo>
        <mi>l</mi>
       </mrow>
       <mrow>
        <mn>16</mn>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <mi>l</mi>
        </mrow>
       </mrow>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msubsup>
      <mi>I</mi>
      <msup>
       <mi>B</mi>
       <mo>∗</mo>
      </msup>
      <mi>Z</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mi>ψ</mi>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mrow>
        <mn>16</mn>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <mi>l</mi>
        </mrow>
       </mrow>
       <mrow>
        <mn>16</mn>
        <mo>+</mo>
        <mrow>
         <mn>3</mn>
         <mi>l</mi>
        </mrow>
       </mrow>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <msubsup>
     <mrow>
      <mo maxsize="160%" minsize="160%">[</mo>
      <mi>ψ</mi>
      <mo maxsize="160%" minsize="160%">]</mo>
     </mrow>
     <mrow>
      <mn>16</mn>
      <mo>+</mo>
      <mrow>
       <mn>3</mn>
       <mi>l</mi>
      </mrow>
     </mrow>
     <mrow>
      <mi>L</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>ψ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>W</mi>
     <mn>4</mn>
    </msup>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <eq></eq>
      <ci>def</ci>
     </apply>
     <apply>
      <times></times>
      <ci>C</ci>
      <ci>D</ci>
      <ci>e</ci>
      <ci>c</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>e</ci>
      <interval closure="open">
       <ci>l</ci>
       <ci>ψ</ci>
      </interval>
     </apply>
     <vector>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>normal-∗</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>W</ci>
         <ci>normal-∗</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>ψ</ci>
         </apply>
         <cn type="integer">0</cn>
        </apply>
        <cn type="integer">16</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>normal-∗</ci>
         </apply>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>ψ</ci>
         </apply>
         <cn type="integer">16</cn>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">16</cn>
         <ci>l</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>normal-∗</ci>
         </apply>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>ψ</ci>
         </apply>
         <apply>
          <plus></plus>
          <cn type="integer">16</cn>
          <ci>l</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">16</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>l</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>normal-∗</ci>
         </apply>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>ψ</ci>
         </apply>
         <apply>
          <plus></plus>
          <cn type="integer">16</cn>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>l</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">16</cn>
         <apply>
          <times></times>
          <cn type="integer">3</cn>
          <ci>l</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>ψ</ci>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">16</cn>
         <apply>
          <times></times>
          <cn type="integer">3</cn>
          <ci>l</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>L</ci>
        <ci>ψ</ci>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>W</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>Z</ci>
      <ci>Z</ci>
      <ci>Z</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>normal-∗</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   CDecode(l,\psi)\stackrel{\mathrm{def}}{=}(I_{B^{\ast}}^{W^{\ast}}(\Bigl[\psi%
\Bigr]_{0}^{16}),I_{B^{\ast}}^{Z}(\Bigl[\psi\Bigr]_{16}^{16+l}),I_{B^{\ast}}^{%
Z}(\Bigl[\psi\Bigr]_{16+l}^{16+2l}),I_{B^{\ast}}^{Z}(\Bigl[\psi\Bigr]_{16+2l}^%
{16+3l}),\Bigl[\psi\Bigr]_{16+3l}^{L(\psi)})\in W^{4}\times Z\times Z\times Z%
\times B^{\ast}
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:98">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>P</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi>c</mi>
   <mo>,</mo>
   <mi>d</mi>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>2</mn>
   </msub>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>P</ci>
    <ci>q</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (P,q,g_{1},g_{2},c,d,h_{1},h_{2},k_{1},k_{2})\,
  </annotation>
 </semantics>
</math>

,</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:99">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>M</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\in B^{\ast}\,
  </annotation>
 </semantics>
</math>

.</p>
</center>
<h3 id="encryption-process">Encryption Process</h3>

<p><strong>Algorithm.</strong> ACE asymmetric encryption operation.<br/>
input: public key 

<math display="inline" id="ACE_Encrypt:100">
 <semantics>
  <mi>ψ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ψ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi
  </annotation>
 </semantics>
</math>

 and byte string 

<math display="inline" id="ACE_Encrypt:101">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>M</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\,
  </annotation>
 </semantics>
</math>

.<br/>
Output: byte string — ciphertext 

<math display="inline" id="ACE_Encrypt:102">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>r</ci>
    <set>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\in\left\{0,...,q-1\right\}
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="ACE_Encrypt:103">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>W</mi>
     <mn>4</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>W</ci>
     <cn type="integer">4</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\in W^{4}\,
  </annotation>
 </semantics>
</math>

.</p>
<ol>
<li>Generate 

<math display="inline" id="ACE_Encrypt:104">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>g</mi>
     <mn>1</mn>
     <mi>r</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>r</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1}\leftarrow g_{1}^{r}remP
  </annotation>
 </semantics>
</math>

 at random.</li>
<li>Generate the ciphertext preamble:
<ol>
<li>Generate 

<math display="inline" id="ACE_Encrypt:105">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>2</mn>
   </msub>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>g</mi>
     <mn>2</mn>
     <mi>r</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>r</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{2}\leftarrow g_{2}^{r}remP
  </annotation>
 </semantics>
</math>

 at random.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:106">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <mi>α</mi>
   </mpadded>
   <mo>←</mo>
   <mrow>
    <mi>U</mi>
    <mi>O</mi>
    <mi>W</mi>
    <mi>H</mi>
    <mi>a</mi>
    <mi>s</mi>
    <msup>
     <mi>h</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>P</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <mi>Z</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <ci>α</ci>
     <apply>
      <times></times>
      <ci>U</ci>
      <ci>O</ci>
      <ci>W</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <ci>normal-′</ci>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>B</ci>
        </apply>
        <ci>P</ci>
       </apply>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <ci>Z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\ \leftarrow UOWHash^{\prime}(k_{1},L_{B}(P),s,u_{1},u_{2})\in Z\,
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:107">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo><</mo>
   <mpadded width="+5pt">
    <mi>α</mi>
   </mpadded>
   <mo><</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mn>2</mn>
     <mn>160</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <cn type="integer">0</cn>
     <ci>α</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">160</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0<\alpha\ <2^{160}\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:108">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>←</mo>
   <mrow>
    <msup>
     <mi>c</mi>
     <mi>r</mi>
    </msup>
    <msup>
     <mi>d</mi>
     <mrow>
      <mpadded width="+5pt">
       <mi>α</mi>
      </mpadded>
      <mi>r</mi>
     </mrow>
    </msup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mpadded width="+1.7pt">
     <mi>P</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>v</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <ci>r</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>d</ci>
      <apply>
       <times></times>
       <ci>α</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v\leftarrow c^{r}d^{\alpha\ r}remP\,
  </annotation>
 </semantics>
</math>

; note that 

<math display="inline" id="ACE_Encrypt:109">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>h</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>h</mi>
     <mn>1</mn>
     <mi>r</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <ci>normal-~</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>r</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{h_{1}}\leftarrow h_{1}^{r}remP
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:110">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>h</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>h</mi>
     <mn>2</mn>
     <mi>r</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <ci>normal-~</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>h</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>r</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{h_{2}}\leftarrow h_{2}^{r}remP
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Compute the key for the symmetric encryption operation:
<ol>
<li>

<math display="inline" id="ACE_Encrypt:111">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>←</mo>
   <mrow>
    <mi>E</mi>
    <mi>S</mi>
    <mi>H</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>P</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mover accent="true">
      <msub>
       <mi>h</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">~</mo>
     </mover>
     <mo>,</mo>
     <mover accent="true">
      <msub>
       <mi>h</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">~</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>W</mi>
     <mn>8</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <ci>k</ci>
     <apply>
      <times></times>
      <ci>E</ci>
      <ci>S</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <ci>h</ci>
      <vector>
       <ci>k</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>B</ci>
        </apply>
        <ci>P</ci>
       </apply>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>h</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>h</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">8</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\leftarrow ESHash(k,L_{B}(P),s,u_{1},u_{2},\tilde{h_{1}},\tilde{h_{2}})\in W^%
{8}\,
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:112">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>←</mo>
   <mrow>
    <mi>S</mi>
    <mi>E</mi>
    <mi>n</mi>
    <mi>c</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <mn>1024</mn>
     <mo>,</mo>
     <mi>M</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>e</ci>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>E</ci>
     <ci>n</ci>
     <ci>c</ci>
     <vector>
      <ci>k</ci>
      <ci>s</ci>
      <cn type="integer">1024</cn>
      <ci>M</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\leftarrow SEnc(k,s,1024,M)
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:113">
 <semantics>
  <mrow>
   <mpadded width="+5pt">
    <mi>ψ</mi>
   </mpadded>
   <mo>←</mo>
   <mrow>
    <mi>C</mi>
    <mi>E</mi>
    <mi>n</mi>
    <mi>c</mi>
    <mi>o</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>P</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mi>v</mi>
     <mo>,</mo>
     <mi>e</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>ψ</ci>
    <apply>
     <times></times>
     <ci>C</ci>
     <ci>E</ci>
     <ci>n</ci>
     <ci>c</ci>
     <ci>o</ci>
     <ci>d</ci>
     <ci>e</ci>
     <vector>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>B</ci>
       </apply>
       <ci>P</ci>
      </apply>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>v</ci>
      <ci>e</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi\ \leftarrow CEncode(L_{B}(P),s,u_{1},u_{2},v,e)
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Compute cryptogram 

<math display="inline" id="ACE_Encrypt:114">
 <semantics>
  <mi>ψ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ψ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi
  </annotation>
 </semantics>
</math>

.</li>
<li>Encode the ciphertext:
<center>

<p>

<math display="inline" id="ACE_Encrypt:115">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>M</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\in B^{\ast}\,
  </annotation>
 </semantics>
</math>

.</p>
</center></li>
<li>Return 

<math display="inline" id="ACE_Encrypt:116">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>M</mi>
     <mi>t</mi>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <ci>t</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{1},...,M_{t}\,
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p>Before starting off the symmetric encryption process, the input message 

<math display="inline" id="ACE_Encrypt:117">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>E</mi>
    <mi>i</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>E</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{i}\,
  </annotation>
 </semantics>
</math>

 is divided into blocks 

<math display="inline" id="ACE_Encrypt:118">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>E</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo fence="true">||</mo>
     <msub>
      <mi>C</mi>
      <mn>1</mn>
     </msub>
     <mo fence="true">||</mo>
    </mrow>
    <mi mathvariant="normal">…</mi>
    <mrow>
     <mo fence="true">||</mo>
     <msub>
      <mi>E</mi>
      <mi>t</mi>
     </msub>
     <mo fence="true">||</mo>
    </mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mi>C</mi>
      <mi>t</mi>
     </msub>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>e</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e=E_{1}||C_{1}||...||E_{t}||C_{t}\,
  </annotation>
 </semantics>
</math>

, where each of the block, possibly except the last one, is of 1024 bytes. Each block is encrypted by the stream cipher. For each encrypted block 

<math display="inline" id="ACE_Encrypt:119">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>e</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>L</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>M</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>16</mn>
     <mrow>
      <mo>⌈</mo>
      <mrow>
       <mrow>
        <mi>L</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>M</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>/</mo>
       <mi>m</mi>
      </mrow>
      <mo>⌉</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>e</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>L</ci>
      <ci>M</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">16</cn>
      <apply>
       <ceiling></ceiling>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>L</ci>
         <ci>M</ci>
        </apply>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(e)=L(M)+16\left\lceil L(M)/m\right\rceil
  </annotation>
 </semantics>
</math>

 16-byte message authentication code is computed. We get the cryptogram</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:120">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>M</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>M</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(M)=0\,
  </annotation>
 </semantics>
</math>

.

<math display="inline" id="ACE_Encrypt:121">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>e</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>e</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(e)=0\,
  </annotation>
 </semantics>
</math>

.</p>
</center>

<p>Note that if 

<math display="block" id="ACE_Encrypt:122">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo>,</mo>
    <mi>s</mi>
    <mo>,</mo>
    <mi>M</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>W</mi>
     <mn>8</mn>
    </msup>
    <mo>×</mo>
    <msup>
     <mi>W</mi>
     <mn>4</mn>
    </msup>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mi>B</mi>
      <mo>∗</mo>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <vector>
     <ci>k</ci>
     <ci>s</ci>
     <ci>M</ci>
     <ci>m</ci>
    </vector>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">8</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>Z</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <ci>normal-∗</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k,s,M,m)\in W^{8}\times W^{4}\times Z\times B^{\ast}\,
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="ACE_Encrypt:123">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>m</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m>0\,
  </annotation>
 </semantics>
</math>

. <strong>Algorithm.</strong> ACE asymmetric encryption process.<br/>
Input

<math display="block" id="ACE_Encrypt:124">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mi>l</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\in B^{l}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="ACE_Encrypt:125">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>L</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>M</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>16</mn>
     <mrow>
      <mo>⌈</mo>
      <mrow>
       <mrow>
        <mi>L</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>N</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>/</mo>
       <mi>m</mi>
      </mrow>
      <mo>⌉</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>L</ci>
      <ci>M</ci>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">16</cn>
      <apply>
       <ceiling></ceiling>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>L</ci>
         <ci>N</ci>
        </apply>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=L(M)+16\left\lceil L(N)/m\right\rceil
  </annotation>
 </semantics>
</math>

<br/>
Output

<math display="inline" id="ACE_Encrypt:126">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>λ</mi>
     <mi>B</mi>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>M</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M=\lambda_{B}\,
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:127">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>λ</mi>
    <mi>B</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{B}\,
  </annotation>
 </semantics>
</math>

.</p>
<ol>
<li>If 

<math display="inline" id="ACE_Encrypt:128">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>S</mi>
    <mi>t</mi>
    <mi>a</mi>
    <mi>t</mi>
    <mi>e</mi>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>I</mi>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo>,</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>S</mi>
    <mi>t</mi>
    <mi>a</mi>
    <mi>t</mi>
    <mi>e</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
     <apply>
      <times></times>
      <ci>I</ci>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
      <ci>G</ci>
      <ci>e</ci>
      <ci>n</ci>
      <interval closure="open">
       <ci>k</ci>
       <ci>s</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   genState\leftarrow InitGen(k,s)\in GenState
  </annotation>
 </semantics>
</math>

, then return 

<math display="inline" id="ACE_Encrypt:129">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mrow>
     <mi>A</mi>
     <mi>X</mi>
     <mi>U</mi>
    </mrow>
   </msub>
   <mi>A</mi>
   <mi>X</mi>
   <mi>U</mi>
   <mi>H</mi>
   <mi>a</mi>
   <mi>s</mi>
   <mpadded width="+1.7pt">
    <mi>h</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>X</ci>
      <ci>U</ci>
     </apply>
    </apply>
    <ci>A</ci>
    <ci>X</ci>
    <ci>U</ci>
    <ci>H</ci>
    <ci>a</ci>
    <ci>s</ci>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{AXU}AXUHash\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Initialize a pseudo-random generator state:
<center>

<p>

<math display="inline" id="ACE_Encrypt:130">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mrow>
       <mi>A</mi>
       <mi>X</mi>
       <mi>U</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <mrow>
      <mi>g</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>S</mi>
      <mi>t</mi>
      <mi>a</mi>
      <mi>t</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>←</mo>
    <mrow>
     <mi>G</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>W</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>d</mi>
     <mi>s</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>5</mn>
         <msub>
          <mi>L</mi>
          <mi>b</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>⌈</mo>
           <mrow>
            <mi>m</mi>
            <mo>/</mo>
            <mn>64</mn>
           </mrow>
           <mo>⌉</mo>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mn>24</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>g</mi>
       <mi>e</mi>
       <mi>n</mi>
       <mi>S</mi>
       <mi>t</mi>
       <mi>a</mi>
       <mi>t</mi>
       <mi>e</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <apply>
       <times></times>
       <ci>A</ci>
       <ci>X</ci>
       <ci>U</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>e</ci>
     <ci>n</ci>
     <ci>W</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
     <ci>s</ci>
     <interval closure="open">
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">5</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>b</ci>
        </apply>
        <apply>
         <ceiling></ceiling>
         <apply>
          <divide></divide>
          <ci>m</ci>
          <cn type="integer">64</cn>
         </apply>
        </apply>
       </apply>
       <cn type="integer">24</cn>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>e</ci>
       <ci>n</ci>
       <ci>S</ci>
       <ci>t</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>e</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k_{AXU},genState)\leftarrow GenWords((5L_{b}(\left\lceil m/64\right\rceil)+24%
),genState).
  </annotation>
 </semantics>
</math>

</p>
</center></li>
<li>Generate the key 

<math display="inline" id="ACE_Encrypt:131">
 <semantics>
  <mrow>
   <mrow>
    <mi>e</mi>
    <mo>←</mo>
    <msub>
     <mi>λ</mi>
     <mi>B</mi>
    </msub>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>i</mi>
    <mo>←</mo>
    <mn>0</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <ci>normal-←</ci>
     <ci>e</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-←</ci>
     <ci>i</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\leftarrow\lambda_{B},i\leftarrow 0
  </annotation>
 </semantics>
</math>

:
<center>

<p>

<math display="inline" id="ACE_Encrypt:132">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mi>a</mi>
     <mi>s</mi>
     <msub>
      <mi>k</mi>
      <mi>m</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>g</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>S</mi>
     <mi>t</mi>
     <mi>a</mi>
     <mi>t</mi>
     <mi>e</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>W</mi>
    <mi>o</mi>
    <mi>r</mi>
    <mi>d</mi>
    <mi>s</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>4</mn>
     <mo>,</mo>
     <mrow>
      <mi>g</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>S</mi>
      <mi>t</mi>
      <mi>a</mi>
      <mi>t</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>e</ci>
     <ci>n</ci>
     <ci>W</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
     <ci>s</ci>
     <interval closure="open">
      <cn type="integer">4</cn>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>e</ci>
       <ci>n</ci>
       <ci>S</ci>
       <ci>t</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>e</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (mask_{m},genState)\leftarrow GenWords(4,genState)
  </annotation>
 </semantics>
</math>

.</p>
</center></li>
<li>

<math display="inline" id="ACE_Encrypt:133">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mi>a</mi>
     <mi>s</mi>
     <msub>
      <mi>k</mi>
      <mi>e</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>g</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>S</mi>
     <mi>t</mi>
     <mi>a</mi>
     <mi>t</mi>
     <mi>e</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>W</mi>
    <mi>o</mi>
    <mi>r</mi>
    <mi>d</mi>
    <mi>s</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mrow>
      <mi>g</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>S</mi>
      <mi>t</mi>
      <mi>a</mi>
      <mi>t</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>e</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>e</ci>
     <ci>n</ci>
     <ci>W</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
     <ci>s</ci>
     <interval closure="open">
      <ci>r</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>e</ci>
       <ci>n</ci>
       <ci>S</ci>
       <ci>t</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>e</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (mask_{e},genState)\leftarrow GenWords(r,genState)
  </annotation>
 </semantics>
</math>

.</li>
<li>While 

<math display="block" id="ACE_Encrypt:134">
 <semantics>
  <mrow>
   <mrow>
    <mi>e</mi>
    <mi>n</mi>
    <mi>c</mi>
   </mrow>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mrow>
      <mo maxsize="160%" minsize="160%">[</mo>
      <mi>M</mi>
      <mo maxsize="160%" minsize="160%">]</mo>
     </mrow>
     <mi>i</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mi>r</mi>
     </mrow>
    </msubsup>
    <mo>⊕</mo>
    <mrow>
     <mi>m</mi>
     <mi>a</mi>
     <mi>s</mi>
     <msub>
      <mi>k</mi>
      <mi>e</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <ci>n</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>M</ci>
       </apply>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>e</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   enc\leftarrow\Bigl[M\Bigr]_{i}^{i+r}\oplus mask_{e}
  </annotation>
 </semantics>
</math>

.
<ol>
<li>Generate mask values for the encryption and MAC:
<ol>
<li>

<math display="inline" id="ACE_Encrypt:135">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mi>r</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>M</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i+r=L(M)\,
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="ACE_Encrypt:136">
 <semantics>
  <mrow>
   <mrow>
    <mi>l</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>t</mi>
    <mi>B</mi>
    <mi>l</mi>
    <mi>o</mi>
    <mi>c</mi>
    <mi>k</mi>
   </mrow>
   <mo>←</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>l</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>t</ci>
     <ci>B</ci>
     <ci>l</ci>
     <ci>o</ci>
     <ci>c</ci>
     <ci>k</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   lastBlock\leftarrow 1
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Encrypt the plaintext

<math display="inline" id="ACE_Encrypt:137">
 <semantics>
  <mrow>
   <mrow>
    <mi>l</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>t</mi>
    <mi>B</mi>
    <mi>l</mi>
    <mi>o</mi>
    <mi>c</mi>
    <mi>k</mi>
   </mrow>
   <mo>←</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>l</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>t</ci>
     <ci>B</ci>
     <ci>l</ci>
     <ci>o</ci>
     <ci>c</ci>
     <ci>k</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   lastBlock\leftarrow 0
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate the message authentication code:
<ol>
<li>If 

<math display="inline" id="ACE_Encrypt:138">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mi>a</mi>
    <mi>c</mi>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>A</mi>
    <mi>X</mi>
    <mi>U</mi>
    <mi>H</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mrow>
       <mi>A</mi>
       <mi>X</mi>
       <mi>U</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <mrow>
      <mi>l</mi>
      <mi>a</mi>
      <mi>s</mi>
      <mi>t</mi>
      <mi>B</mi>
      <mi>l</mi>
      <mi>o</mi>
      <mi>c</mi>
      <mi>k</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>e</mi>
      <mi>n</mi>
      <mi>c</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>W</mi>
    <mn>4</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>X</ci>
      <ci>U</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <ci>h</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>X</ci>
         <ci>U</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>l</ci>
        <ci>a</ci>
        <ci>s</ci>
        <ci>t</ci>
        <ci>B</ci>
        <ci>l</ci>
        <ci>o</ci>
        <ci>c</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <times></times>
        <ci>e</ci>
        <ci>n</ci>
        <ci>c</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   mac\leftarrow AXUHash(k_{AXU},lastBlock,enc)\in W^{4}
  </annotation>
 </semantics>
</math>

, then 

<math display="block" id="ACE_Encrypt:139">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>←</mo>
   <mrow>
    <mi>e</mi>
    <mrow>
     <mo fence="true">||</mo>
     <mrow>
      <mi>e</mi>
      <mi>n</mi>
      <mi>c</mi>
     </mrow>
     <mo fence="true">||</mo>
    </mrow>
    <msubsup>
     <mi>I</mi>
     <msup>
      <mi>W</mi>
      <mo>∗</mo>
     </msup>
     <msup>
      <mi>B</mi>
      <mo>∗</mo>
     </msup>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>m</mi>
       <mi>a</mi>
       <mi>c</mi>
      </mrow>
      <mo>⊕</mo>
      <mrow>
       <mi>m</mi>
       <mi>a</mi>
       <mi>s</mi>
       <msub>
        <mi>k</mi>
        <mi>m</mi>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>e</ci>
    <apply>
     <times></times>
     <ci>e</ci>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>n</ci>
       <ci>c</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>W</ci>
        <ci>normal-∗</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>normal-∗</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">direct-sum</csymbol>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>a</ci>
       <ci>c</ci>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>a</ci>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\leftarrow e||enc||I_{W^{\ast}}^{B^{\ast}}(mac\oplus mask_{m})
  </annotation>
 </semantics>
</math>

; else 

<math display="inline" id="ACE_Encrypt:140">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>←</mo>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mi>r</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>i</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <ci>r</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\leftarrow i+r
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="ACE_Encrypt:141">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>e</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\,
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Update the ciphertext

<math display="inline" id="ACE_Encrypt:142">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>P</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>g</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <mi>c</mi>
   <mo>,</mo>
   <mi>d</mi>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>h</mi>
    <mn>2</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>k</mi>
    <mn>2</mn>
   </msub>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>P</ci>
    <ci>q</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>c</ci>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>h</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <cn type="integer">2</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (P,q,g_{1},g_{2},c,d,h_{1},h_{2},k_{1},k_{2})\,
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="ACE_Encrypt:143">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>w</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mn>2</mn>
   </msub>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>w</ci>
    <ci>x</ci>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">2</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,x,y,z_{1},z_{2})\,
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Return 

<math display="inline" id="ACE_Encrypt:144">
 <semantics>
  <mrow>
   <mi>ψ</mi>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>ψ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi\in B^{\ast}
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<h3 id="decryption-process">Decryption process</h3>

<p><strong>Algorithm.</strong> ACE decryption process.<br/>
Input: public key 

<math display="inline" id="ACE_Encrypt:145">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
    <mo>∪</mo>
    <mrow>
     <mi>R</mi>
     <mi>e</mi>
     <mi>j</mi>
     <mi>e</mi>
     <mi>c</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>M</ci>
    <apply>
     <union></union>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <ci>normal-∗</ci>
     </apply>
     <apply>
      <times></times>
      <ci>R</ci>
      <ci>e</ci>
      <ci>j</ci>
      <ci>e</ci>
      <ci>c</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\in B^{\ast}\cup{Reject}
  </annotation>
 </semantics>
</math>

 and corresponding private key 

<math display="inline" id="ACE_Encrypt:146">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo><</mo>
   <mrow>
    <mrow>
     <mn>3</mn>
     <msub>
      <mi>L</mi>
      <mi>B</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>P</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mpadded width="+1.7pt">
     <mn>16</mn>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>ψ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>B</ci>
      </apply>
      <ci>P</ci>
     </apply>
     <cn type="integer">16</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(\psi)<3L_{B}(P)+16\,
  </annotation>
 </semantics>
</math>

, byt e string 

<math display="inline" id="ACE_Encrypt:147">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mi>e</mi>
   <mi>j</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <ci>e</ci>
    <ci>j</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Reject\,
  </annotation>
 </semantics>
</math>

.<br/>
Output: Decrypted message 

<math display="inline" id="ACE_Encrypt:148">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo>,</mo>
    <msub>
     <mi>u</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>u</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi>v</mi>
    <mo>,</mo>
    <mi>e</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>C</mi>
    <mi>D</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mi>o</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>P</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>ψ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>W</mi>
     <mn>4</mn>
    </msup>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <vector>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>v</ci>
      <ci>e</ci>
     </vector>
     <apply>
      <times></times>
      <ci>C</ci>
      <ci>D</ci>
      <ci>e</ci>
      <ci>c</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>e</ci>
      <interval closure="open">
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>B</ci>
        </apply>
        <ci>P</ci>
       </apply>
       <ci>ψ</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>W</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>Z</ci>
      <ci>Z</ci>
      <ci>Z</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>normal-∗</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (s,u_{1},u_{2},v,e)\leftarrow CDecode(L_{B}(P),\psi)\in W^{4}\times Z\times Z%
\times Z\times B^{\ast}
  </annotation>
 </semantics>
</math>

.</p>
<ol>
<li>Decrypt the ciphertext:
<ol>
<li>If 

<math display="inline" id="ACE_Encrypt:149">
 <semantics>
  <mrow>
   <mrow>
    <mn>0</mn>
    <mo>≤</mo>
    <mrow>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>v</mi>
    <mo><</mo>
    <msup>
     <mn>256</mn>
     <mi>l</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">2</cn>
      </apply>
     </list>
    </apply>
    <apply>
     <lt></lt>
     <ci>v</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">256</cn>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq u_{1},u_{2},v<256^{l}
  </annotation>
 </semantics>
</math>

, then return 

<math display="inline" id="ACE_Encrypt:150">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>B</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>P</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>l</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>B</ci>
     </apply>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l=L_{B}(P)\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute:
<center>

<p>

<math display="inline" id="ACE_Encrypt:151">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>1</mn>
   </msub>
   <mo>≥</mo>
   <mi>P</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1}\geq P
  </annotation>
 </semantics>
</math>

;</p>
</center>

<p><br/>
note that 

<math display="inline" id="ACE_Encrypt:152">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>2</mn>
   </msub>
   <mo>≥</mo>
   <mi>P</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{2}\geq P
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="ACE_Encrypt:153">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>≥</mo>
   <mi>P</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>v</ci>
    <ci>P</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v\geq P
  </annotation>
 </semantics>
</math>

.</p></li>
</ol></li>
<li>Verify the ciphertext preamble:
<ol>
<li>If 

<math display="inline" id="ACE_Encrypt:154">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mi>e</mi>
   <mi>j</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <ci>e</ci>
    <ci>j</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Reject\,
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="ACE_Encrypt:155">
 <semantics>
  <mrow>
   <msubsup>
    <mi>u</mi>
    <mn>1</mn>
    <mi>q</mi>
   </msubsup>
   <mo>≠</mo>
   <mrow>
    <mn>1</mn>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>q</ci>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">1</cn>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{1}^{q}\neq 1remP
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="ACE_Encrypt:156">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mi>e</mi>
   <mi>j</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <ci>e</ci>
    <ci>j</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Reject\,
  </annotation>
 </semantics>
</math>

, then return 

<math display="inline" id="ACE_Encrypt:157">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>j</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mi>t</mi>
   </mrow>
   <mo>←</mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>j</ci>
     <ci>e</ci>
     <ci>c</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   reject\leftarrow 0\,
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="ACE_Encrypt:158">
 <semantics>
  <mrow>
   <msub>
    <mi>u</mi>
    <mn>2</mn>
   </msub>
   <mo>≠</mo>
   <mrow>
    <msubsup>
     <mi>u</mi>
     <mn>1</mn>
     <mi>w</mi>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>u</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>w</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u_{2}\neq u_{1}^{w}remP
  </annotation>
 </semantics>
</math>

, then return 

<math display="inline" id="ACE_Encrypt:159">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>j</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mi>t</mi>
   </mrow>
   <mo>←</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>j</ci>
     <ci>e</ci>
     <ci>c</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   reject\leftarrow 1\,
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="ACE_Encrypt:160">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mo>←</mo>
   <mrow>
    <mi>U</mi>
    <mi>O</mi>
    <mi>W</mi>
    <mi>H</mi>
    <mi>a</mi>
    <mi>s</mi>
    <msup>
     <mi>h</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>P</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mi>Z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <ci>α</ci>
     <apply>
      <times></times>
      <ci>U</ci>
      <ci>O</ci>
      <ci>W</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <ci>normal-′</ci>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>B</ci>
        </apply>
        <ci>P</ci>
       </apply>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <ci>Z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\leftarrow UOWHash^{\prime}(k_{1},L_{B}(P),s,u_{1},u_{2})\in Z
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="ACE_Encrypt:161">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>α</mi>
   <mo>≤</mo>
   <msup>
    <mn>2</mn>
    <mn>160</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>α</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">160</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq\alpha\leq 2^{160}
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="ACE_Encrypt:162">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>≠</mo>
   <mrow>
    <msubsup>
     <mi>u</mi>
     <mn>1</mn>
     <mrow>
      <mi>x</mi>
      <mo>+</mo>
      <mrow>
       <mi>α</mi>
       <mi>y</mi>
      </mrow>
     </mrow>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>v</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>α</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v\neq u_{1}^{x+{\alpha}y}remP
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:163">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>j</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mi>t</mi>
   </mrow>
   <mo>←</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>j</ci>
     <ci>e</ci>
     <ci>c</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   reject\leftarrow 1\,
  </annotation>
 </semantics>
</math>

; note that 

<math display="inline" id="ACE_Encrypt:164">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>j</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mi>t</mi>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>e</ci>
     <ci>j</ci>
     <ci>e</ci>
     <ci>c</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   reject=1\,
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="ACE_Encrypt:165">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mi>e</mi>
   <mi>j</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <ci>e</ci>
    <ci>j</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Reject\,
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="ACE_Encrypt:166">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>h</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>u</mi>
     <mn>1</mn>
     <msub>
      <mi>z</mi>
      <mn>1</mn>
     </msub>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <ci>normal-~</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{h_{1}}\leftarrow u_{1}^{z_{1}}remP
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="ACE_Encrypt:167">
 <semantics>
  <mrow>
   <mover accent="true">
    <msub>
     <mi>h</mi>
     <mn>2</mn>
    </msub>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>u</mi>
     <mn>1</mn>
     <msub>
      <mi>z</mi>
      <mn>2</mn>
     </msub>
    </msubsup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>P</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <ci>normal-~</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>P</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{h_{2}}\leftarrow u_{1}^{z_{2}}remP
  </annotation>
 </semantics>
</math>

, then return 

<math display="inline" id="ACE_Encrypt:168">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>←</mo>
   <mrow>
    <mi>E</mi>
    <mi>S</mi>
    <mi>H</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mn>2</mn>
     </msub>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>P</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <msub>
      <mi>u</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <mover accent="true">
      <msub>
       <mi>h</mi>
       <mn>1</mn>
      </msub>
      <mo stretchy="false">~</mo>
     </mover>
     <mo>,</mo>
     <mover accent="true">
      <msub>
       <mi>h</mi>
       <mn>2</mn>
      </msub>
      <mo stretchy="false">~</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>W</mi>
    <mn>8</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <ci>k</ci>
     <apply>
      <times></times>
      <ci>E</ci>
      <ci>S</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <ci>h</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>B</ci>
        </apply>
        <ci>P</ci>
       </apply>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>h</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>h</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">8</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\leftarrow ESHash(k_{2},L_{B}(P),s,u_{1},\tilde{h_{1}},\tilde{h_{2}})\in W^{8}
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Compute the key for the symmetric decryption operation:
<ol>
<li>

<math display="inline" id="ACE_Encrypt:169">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>←</mo>
   <mrow>
    <mi>S</mi>
    <mi>D</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo>,</mo>
     <mi>s</mi>
     <mo>,</mo>
     <mn>1024</mn>
     <mo>,</mo>
     <mi>e</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>M</ci>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>D</ci>
     <ci>e</ci>
     <ci>c</ci>
     <vector>
      <ci>k</ci>
      <ci>s</ci>
      <cn type="integer">1024</cn>
      <ci>e</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\leftarrow SDec(k,s,1024,e)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:170">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>D</mi>
   <mi>e</mi>
   <mpadded width="+1.7pt">
    <mi>c</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>D</ci>
    <ci>e</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SDec\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:171">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mi>e</mi>
   <mi>j</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <ci>e</ci>
    <ci>j</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Reject\,
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:172">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>M</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\,
  </annotation>
 </semantics>
</math>

;note that 

<math display="inline" id="ACE_Encrypt:173">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>D</mi>
   <mi>e</mi>
   <mpadded width="+1.7pt">
    <mi>c</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>D</ci>
    <ci>e</ci>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SDec\,
  </annotation>
 </semantics>
</math>

 can return 

<math display="block" id="ACE_Encrypt:174">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo>,</mo>
    <mi>s</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>e</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>W</mi>
     <mn>8</mn>
    </msup>
    <mo>×</mo>
    <msup>
     <mi>W</mi>
     <mn>4</mn>
    </msup>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mi>B</mi>
      <mo>∗</mo>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <vector>
     <ci>k</ci>
     <ci>s</ci>
     <ci>m</ci>
     <ci>e</ci>
    </vector>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">8</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>Z</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <ci>normal-∗</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k,s,m,e)\in W^{8}\times W^{4}\times Z\times B^{\ast}\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Return 

<math display="inline" id="ACE_Encrypt:175">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>m</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m>0\,
  </annotation>
 </semantics>
</math>

.</li>
</ol>

<p><strong>Algorithm.</strong> Decryption operation 

<math display="inline" id="ACE_Encrypt:176">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
    <mo>∪</mo>
    <mrow>
     <mi>R</mi>
     <mi>e</mi>
     <mi>j</mi>
     <mi>e</mi>
     <mi>c</mi>
     <mi>t</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>M</ci>
    <apply>
     <union></union>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <ci>normal-∗</ci>
     </apply>
     <apply>
      <times></times>
      <ci>R</ci>
      <ci>e</ci>
      <ci>j</ci>
      <ci>e</ci>
      <ci>c</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\in B^{\ast}\cup{Reject}
  </annotation>
 </semantics>
</math>

.<br/>
Input

<math display="inline" id="ACE_Encrypt:177">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msub>
     <mi>λ</mi>
     <mi>B</mi>
    </msub>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>λ</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e=\lambda_{B}\,
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="ACE_Encrypt:178">
 <semantics>
  <mpadded width="+1.7pt">
   <msub>
    <mi>λ</mi>
    <mi>B</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>λ</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda_{B}\,
  </annotation>
 </semantics>
</math>

<br/>
Output: Decrypted message 

<math display="inline" id="ACE_Encrypt:179">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>S</mi>
    <mi>t</mi>
    <mi>a</mi>
    <mi>t</mi>
    <mi>e</mi>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>I</mi>
    <mi>n</mi>
    <mi>i</mi>
    <mi>t</mi>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo>,</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>S</mi>
    <mi>t</mi>
    <mi>a</mi>
    <mi>t</mi>
    <mi>e</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
     <apply>
      <times></times>
      <ci>I</ci>
      <ci>n</ci>
      <ci>i</ci>
      <ci>t</ci>
      <ci>G</ci>
      <ci>e</ci>
      <ci>n</ci>
      <interval closure="open">
       <ci>k</ci>
       <ci>s</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   genState\leftarrow InitGen(k,s)\in GenState
  </annotation>
 </semantics>
</math>

.</p>
<ol>
<li>If 

<math display="inline" id="ACE_Encrypt:180">
 <semantics>
  <mrow>
   <msub>
    <mi>k</mi>
    <mrow>
     <mi>A</mi>
     <mi>X</mi>
     <mi>U</mi>
    </mrow>
   </msub>
   <mi>A</mi>
   <mi>X</mi>
   <mi>U</mi>
   <mi>H</mi>
   <mi>a</mi>
   <mi>s</mi>
   <mpadded width="+1.7pt">
    <mi>h</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>X</ci>
      <ci>U</ci>
     </apply>
    </apply>
    <ci>A</ci>
    <ci>X</ci>
    <ci>U</ci>
    <ci>H</ci>
    <ci>a</ci>
    <ci>s</ci>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{AXU}AXUHash\,
  </annotation>
 </semantics>
</math>

, then return 

<math display="inline" id="ACE_Encrypt:181">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mrow>
       <mi>A</mi>
       <mi>X</mi>
       <mi>U</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <mrow>
      <mi>g</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>S</mi>
      <mi>t</mi>
      <mi>a</mi>
      <mi>t</mi>
      <msup>
       <mi>e</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>←</mo>
    <mrow>
     <mi>G</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>W</mi>
     <mi>o</mi>
     <mi>r</mi>
     <mi>d</mi>
     <mi>s</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>5</mn>
         <msub>
          <mi>L</mi>
          <mi>b</mi>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>⌈</mo>
           <mrow>
            <mi>m</mi>
            <mo>/</mo>
            <mn>64</mn>
           </mrow>
           <mo>⌉</mo>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mn>24</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>g</mi>
       <mi>e</mi>
       <mi>n</mi>
       <mi>S</mi>
       <mi>t</mi>
       <mi>a</mi>
       <mi>t</mi>
       <mi>e</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>k</ci>
      <apply>
       <times></times>
       <ci>A</ci>
       <ci>X</ci>
       <ci>U</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>e</ci>
     <ci>n</ci>
     <ci>W</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
     <ci>s</ci>
     <interval closure="open">
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">5</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>b</ci>
        </apply>
        <apply>
         <ceiling></ceiling>
         <apply>
          <divide></divide>
          <ci>m</ci>
          <cn type="integer">64</cn>
         </apply>
        </apply>
       </apply>
       <cn type="integer">24</cn>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>e</ci>
       <ci>n</ci>
       <ci>S</ci>
       <ci>t</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>e</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (k_{AXU},genState^{\prime})\leftarrow GenWords((5L_{b}(\left\lceil m/64\right%
\rceil)+24),genState).
  </annotation>
 </semantics>
</math>

.</li>
<li>Initialize a pseudo-random generator state:
<center>

<p>

<math display="inline" id="ACE_Encrypt:182">
 <semantics>
  <mrow>
   <mrow>
    <mi>M</mi>
    <mo>←</mo>
    <msub>
     <mi>λ</mi>
     <mi>B</mi>
    </msub>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>i</mi>
    <mo>←</mo>
    <mn>0</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <ci>normal-←</ci>
     <ci>M</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-←</ci>
     <ci>i</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\leftarrow\lambda_{B},i\leftarrow 0
  </annotation>
 </semantics>
</math>

</p>
</center></li>
<li>Generate the key 

<math display="inline" id="ACE_Encrypt:183">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>≤</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>r</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\leq 0
  </annotation>
 </semantics>
</math>

:
<center>

<p>

<math display="inline" id="ACE_Encrypt:184">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mi>e</mi>
   <mi>j</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <ci>e</ci>
    <ci>j</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Reject\,
  </annotation>
 </semantics>
</math>

.</p>
</center></li>
<li>

<math display="inline" id="ACE_Encrypt:185">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mi>a</mi>
     <mi>s</mi>
     <msub>
      <mi>k</mi>
      <mi>m</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>g</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>S</mi>
     <mi>t</mi>
     <mi>a</mi>
     <mi>t</mi>
     <mi>e</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>W</mi>
    <mi>o</mi>
    <mi>r</mi>
    <mi>d</mi>
    <mi>s</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mn>4</mn>
     <mo>,</mo>
     <mrow>
      <mi>g</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>S</mi>
      <mi>t</mi>
      <mi>a</mi>
      <mi>t</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>e</ci>
     <ci>n</ci>
     <ci>W</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
     <ci>s</ci>
     <interval closure="open">
      <cn type="integer">4</cn>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>e</ci>
       <ci>n</ci>
       <ci>S</ci>
       <ci>t</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>e</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (mask_{m},genState)\leftarrow GenWords(4,genState)
  </annotation>
 </semantics>
</math>

.</li>
<li>While 

<math display="inline" id="ACE_Encrypt:186">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>m</mi>
     <mi>a</mi>
     <mi>s</mi>
     <msub>
      <mi>k</mi>
      <mi>e</mi>
     </msub>
    </mrow>
    <mo>,</mo>
    <mrow>
     <mi>g</mi>
     <mi>e</mi>
     <mi>n</mi>
     <mi>S</mi>
     <mi>t</mi>
     <mi>a</mi>
     <mi>t</mi>
     <mi>e</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>W</mi>
    <mi>o</mi>
    <mi>r</mi>
    <mi>d</mi>
    <mi>s</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mrow>
      <mi>g</mi>
      <mi>e</mi>
      <mi>n</mi>
      <mi>S</mi>
      <mi>t</mi>
      <mi>a</mi>
      <mi>t</mi>
      <mi>e</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <interval closure="open">
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>e</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>e</ci>
      <ci>n</ci>
      <ci>S</ci>
      <ci>t</ci>
      <ci>a</ci>
      <ci>t</ci>
      <ci>e</ci>
     </apply>
    </interval>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>e</ci>
     <ci>n</ci>
     <ci>W</ci>
     <ci>o</ci>
     <ci>r</ci>
     <ci>d</ci>
     <ci>s</ci>
     <interval closure="open">
      <ci>r</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>e</ci>
       <ci>n</ci>
       <ci>S</ci>
       <ci>t</ci>
       <ci>a</ci>
       <ci>t</ci>
       <ci>e</ci>
      </apply>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (mask_{e},genState)\leftarrow GenWords(r,genState)
  </annotation>
 </semantics>
</math>

.
<ol>
<li>If 

<math display="inline" id="ACE_Encrypt:187">
 <semantics>
  <mrow>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mi>r</mi>
    <mo>+</mo>
    <mn>16</mn>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>M</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <ci>r</ci>
     <cn type="integer">16</cn>
    </apply>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i+r+16=L(M)\,
  </annotation>
 </semantics>
</math>

, then return 

<math display="inline" id="ACE_Encrypt:188">
 <semantics>
  <mrow>
   <mrow>
    <mi>l</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>t</mi>
    <mi>b</mi>
    <mi>l</mi>
    <mi>o</mi>
    <mi>c</mi>
    <mi>k</mi>
   </mrow>
   <mo>←</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>l</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>t</ci>
     <ci>b</ci>
     <ci>l</ci>
     <ci>o</ci>
     <ci>c</ci>
     <ci>k</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   lastblock\leftarrow 1
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate mask values for the encryption and MAC:
<ol>
<li>

<math display="inline" id="ACE_Encrypt:189">
 <semantics>
  <mrow>
   <mrow>
    <mi>l</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>t</mi>
    <mi>b</mi>
    <mi>l</mi>
    <mi>o</mi>
    <mi>c</mi>
    <mi>k</mi>
   </mrow>
   <mo>←</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <times></times>
     <ci>l</ci>
     <ci>a</ci>
     <ci>s</ci>
     <ci>t</ci>
     <ci>b</ci>
     <ci>l</ci>
     <ci>o</ci>
     <ci>c</ci>
     <ci>k</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   lastblock\leftarrow 0
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="ACE_Encrypt:190">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mi>a</mi>
    <mi>c</mi>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>A</mi>
    <mi>X</mi>
    <mi>U</mi>
    <mi>H</mi>
    <mi>a</mi>
    <mi>s</mi>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>k</mi>
      <mrow>
       <mi>A</mi>
       <mi>X</mi>
       <mi>U</mi>
      </mrow>
     </msub>
     <mo>,</mo>
     <mrow>
      <mi>l</mi>
      <mi>a</mi>
      <mi>s</mi>
      <mi>t</mi>
      <mi>B</mi>
      <mi>l</mi>
      <mi>o</mi>
      <mi>c</mi>
      <mi>k</mi>
     </mrow>
     <mo>,</mo>
     <msubsup>
      <mrow>
       <mo maxsize="160%" minsize="160%">[</mo>
       <mi>e</mi>
       <mo maxsize="160%" minsize="160%">]</mo>
      </mrow>
      <mi>i</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mi>r</mi>
      </mrow>
     </msubsup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>W</mi>
    <mn>4</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>a</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>X</ci>
      <ci>U</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <ci>h</ci>
      <vector>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <apply>
         <times></times>
         <ci>A</ci>
         <ci>X</ci>
         <ci>U</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>l</ci>
        <ci>a</ci>
        <ci>s</ci>
        <ci>t</ci>
        <ci>B</ci>
        <ci>l</ci>
        <ci>o</ci>
        <ci>c</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>e</ci>
         </apply>
         <ci>i</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <ci>r</ci>
        </apply>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>W</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   mac\leftarrow AXUHash(k_{AXU},lastBlock,\Bigl[e\Bigr]_{i}^{i+r})\in W^{4}
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Verify the message authentication code:
<ol>
<li>If 

<math display="inline" id="ACE_Encrypt:191">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo maxsize="160%" minsize="160%">[</mo>
     <mi>e</mi>
     <mo maxsize="160%" minsize="160%">]</mo>
    </mrow>
    <msubsup>
     <mi>r</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mi>r</mi>
     </mrow>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mi>r</mi>
      <mo>+</mo>
      <mn>16</mn>
     </mrow>
    </msubsup>
   </mrow>
   <mo>≠</mo>
   <mrow>
    <msubsup>
     <mi>I</mi>
     <msup>
      <mi>W</mi>
      <mo>∗</mo>
     </msup>
     <msup>
      <mi>B</mi>
      <mo>∗</mo>
     </msup>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>m</mi>
       <mi>a</mi>
       <mi>c</mi>
      </mrow>
      <mo>⊕</mo>
      <mrow>
       <mi>m</mi>
       <mi>a</mi>
       <mi>s</mi>
       <msub>
        <mi>k</mi>
        <mi>m</mi>
       </msub>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>e</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <ci>r</ci>
       <cn type="integer">16</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>W</ci>
        <ci>normal-∗</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>normal-∗</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">direct-sum</csymbol>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>a</ci>
       <ci>c</ci>
      </apply>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>a</ci>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Bigl[e\Big]r_{i+r}^{i+r+16}\neq I_{W^{\ast}}^{B^{\ast}}(mac\oplus mask_{m})
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="ACE_Encrypt:192">
 <semantics>
  <mrow>
   <mi>R</mi>
   <mi>e</mi>
   <mi>j</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>R</ci>
    <ci>e</ci>
    <ci>j</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Reject\,
  </annotation>
 </semantics>
</math>

; else 

<math display="block" id="ACE_Encrypt:193">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>←</mo>
   <mi>M</mi>
   <mo stretchy="false">|</mo>
   <mo stretchy="false">|</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mrow>
      <mo maxsize="160%" minsize="160%">[</mo>
      <mi>e</mi>
      <mo maxsize="160%" minsize="160%">]</mo>
     </mrow>
     <mi>i</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mi>r</mi>
     </mrow>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>⊕</mo>
   <mi>m</mi>
   <mi>a</mi>
   <mi>s</mi>
   <msub>
    <mi>k</mi>
    <mi>e</mi>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">M</csymbol>
    <ci>normal-←</ci>
    <csymbol cd="unknown">M</csymbol>
    <ci>normal-|</ci>
    <ci>normal-|</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-[</ci>
        <csymbol cd="unknown">e</csymbol>
        <ci>normal-]</ci>
       </cerror>
       <ci>i</ci>
      </apply>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">direct-sum</csymbol>
    <csymbol cd="unknown">m</csymbol>
    <csymbol cd="unknown">a</csymbol>
    <csymbol cd="unknown">s</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>k</ci>
     <ci>e</ci>
    </apply>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\leftarrow M||(\Bigl[e\Bigr]_{i}^{i+r})\oplus mask_{e})
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="ACE_Encrypt:194">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>←</mo>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mi>r</mi>
    <mo>+</mo>
    <mn>16</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>i</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <ci>r</ci>
     <cn type="integer">16</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\leftarrow i+r+16
  </annotation>
 </semantics>
</math>

.</li>
<li>If 

<math display="inline" id="ACE_Encrypt:195">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>M</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\,
  </annotation>
 </semantics>
</math>

, then return 

<math display="block" id="ACE_Encrypt:196">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>N</mi>
   <mo>,</mo>
   <mi>h</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <msup>
    <mi>e</mi>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>k</mi>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <mi>s</mi>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>N</ci>
    <ci>h</ci>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>s</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (N,h,x,e^{\prime},k^{\prime},s)\,
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Update the plaintext

<math display="block" id="ACE_Encrypt:197">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>p</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <mi>a</mi>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>p</ci>
    <ci>q</ci>
    <ci>a</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p,q,a)\,
  </annotation>
 </semantics>
</math>

.</li>
<li>

<math display="inline" id="ACE_Encrypt:198">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>m</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\,
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Return 

<math display="inline" id="ACE_Encrypt:199">
 <semantics>
  <mrow>
   <mn>1024</mn>
   <mo>≤</mo>
   <mi>m</mi>
   <mo>≤</mo>
   <mn>16384</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1024</cn>
     <ci>m</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">16384</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1024\leq m\leq 16384
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<h2 id="signature-scheme">Signature Scheme</h2>

<p>The signature scheme employs two key types:<br/>
ACE Signature public key

<math display="inline" id="ACE_Encrypt:200">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>p</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\,
  </annotation>
 </semantics>
</math>

.<br/>
ACE Signature private key

<math display="inline" id="ACE_Encrypt:201">
 <semantics>
  <mrow>
   <mo>⌊</mo>
   <mrow>
    <mi>m</mi>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mo>⌋</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <floor></floor>
    <apply>
     <divide></divide>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lfloor m/2\right\rfloor
  </annotation>
 </semantics>
</math>

.<br/>
For the given size parameter 

<math display="inline" id="ACE_Encrypt:202">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <mn>2</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p-1)/2\,
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:203">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>q</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q\,
  </annotation>
 </semantics>
</math>

, key components are defined the following way:<br/>


<math display="inline" id="ACE_Encrypt:204">
 <semantics>
  <mrow>
   <mo>⌊</mo>
   <mrow>
    <mi>m</mi>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
   <mo>⌋</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <floor></floor>
    <apply>
     <divide></divide>
     <ci>m</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\lfloor m/2\right\rfloor
  </annotation>
 </semantics>
</math>

 — 

<math display="inline" id="ACE_Encrypt:205">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <mn>2</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <ci>q</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (q-1)/2\,
  </annotation>
 </semantics>
</math>

-bit prime number with 

<math display="inline" id="ACE_Encrypt:206">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>N</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\,
  </annotation>
 </semantics>
</math>

 — is also a prime number.<br/>


<math display="inline" id="ACE_Encrypt:207">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>=</mo>
   <mrow>
    <mi>p</mi>
    <mpadded width="+1.7pt">
     <mi>q</mi>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N=pq\,
  </annotation>
 </semantics>
</math>

 — 

<math display="inline" id="ACE_Encrypt:208">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>m</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\,
  </annotation>
 </semantics>
</math>

-bit prime number with 

<math display="inline" id="ACE_Encrypt:209">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>-</mo>
   <mpadded width="+1.7pt">
    <mn>1</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m-1\,
  </annotation>
 </semantics>
</math>

 — is also a prime number.<br/>


<math display="inline" id="ACE_Encrypt:210">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <mi>x</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>h</ci>
    <ci>x</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h,x\,
  </annotation>
 </semantics>
</math>

 — 

<math display="inline" id="ACE_Encrypt:211">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>N</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <ci>N</ci>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{1,...,N-1\right\}
  </annotation>
 </semantics>
</math>

and has either 

<math display="inline" id="ACE_Encrypt:212">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>N</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\,
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="ACE_Encrypt:213">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>e</mi>
    <mo>′</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{\prime}\,
  </annotation>
 </semantics>
</math>

 бит.<br/>


<math display="inline" id="ACE_Encrypt:214">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>a</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>a</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\,
  </annotation>
 </semantics>
</math>

 — elements 

<math display="inline" id="ACE_Encrypt:215">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>p</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>q</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>/</mo>
     <mn>4</mn>
    </mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">0</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>p</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <cn type="integer">4</cn>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{0,...,(p-1)(q-1)/4-1\right\}
  </annotation>
 </semantics>
</math>

 (quadratic residues modulo 

<math display="inline" id="ACE_Encrypt:216">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>k</mi>
    <mo>′</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>k</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k^{\prime}\,
  </annotation>
 </semantics>
</math>

).<br/>


<math display="inline" id="ACE_Encrypt:217">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>B</mi>
    <mn>184</mn>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>B</ci>
    <cn type="integer">184</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B^{184}\,
  </annotation>
 </semantics>
</math>

 — 161-bit prime number.<br/>


<math display="inline" id="ACE_Encrypt:218">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>s</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\,
  </annotation>
 </semantics>
</math>

 — element 

<math display="inline" id="ACE_Encrypt:219">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>B</mi>
    <mn>32</mn>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>B</ci>
    <cn type="integer">32</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B^{32}\,
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="ACE_Encrypt:220">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>m</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m\,
  </annotation>
 </semantics>
</math>

 — elements 

<math display="inline" id="ACE_Encrypt:221">
 <semantics>
  <mrow>
   <mn>1024</mn>
   <mo>≤</mo>
   <mi>m</mi>
   <mo>≤</mo>
   <mn>16384</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">1024</cn>
     <ci>m</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <cn type="integer">16384</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1024\leq m\leq 16384
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:222">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <mi>q</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>p</ci>
    <ci>q</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p,q\,
  </annotation>
 </semantics>
</math>

 — elements 

<math display="inline" id="ACE_Encrypt:223">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>p</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <mn>2</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <ci>p</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p-1)/2\,
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="key-generation-1">Key Generation</h3>

<p><strong>Algorithm.</strong> Key generation for the ACE public-key signature scheme.<br/>
Input: size parameter 

<math display="inline" id="ACE_Encrypt:224">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>q</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <mn>2</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <minus></minus>
     <ci>q</ci>
     <cn type="integer">1</cn>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (q-1)/2\,
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:225">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mrow>
     <msub>
      <mi>m</mi>
      <mn>1</mn>
     </msub>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo><</mo>
   <mi>p</mi>
   <mo><</mo>
   <msup>
    <mn>2</mn>
    <msub>
     <mi>m</mi>
     <mn>1</mn>
    </msub>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <lt></lt>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>p</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{m_{1}-1}<p<2^{m_{1}}
  </annotation>
 </semantics>
</math>

.<br/>
Output: public/private key pair.</p>
<ol>
<li>Generate random prime numbers

<math display="inline" id="ACE_Encrypt:226">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mo>≠</mo>
   <mi>q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>p</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p\neq q
  </annotation>
 </semantics>
</math>

, such that 

<math display="inline" id="ACE_Encrypt:227">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>⌊</mo>
    <mrow>
     <mi>m</mi>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
    <mo>⌋</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <floor></floor>
     <apply>
      <divide></divide>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{1}=\left\lfloor m/2\right\rfloor
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:228">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mn>1</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>⌈</mo>
    <mrow>
     <mi>m</mi>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
    <mo>⌉</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <ceiling></ceiling>
     <apply>
      <divide></divide>
      <ci>m</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{1}=\left\lceil m/2\right\rceil
  </annotation>
 </semantics>
</math>

 — is also a prime number, and
<center>

<p>

<math display="inline" id="ACE_Encrypt:229">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>←</mo>
   <mrow>
    <mi>p</mi>
    <mi>q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>N</ci>
    <apply>
     <times></times>
     <ci>p</ci>
     <ci>q</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\leftarrow pq
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:230">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>e</mi>
    <mo>′</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>e</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e^{\prime}\,
  </annotation>
 </semantics>
</math>

</p>
</center>

<p>и 

<math display="inline" id="ACE_Encrypt:231">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>160</mn>
   </msup>
   <mo>≤</mo>
   <msup>
    <mi>e</mi>
    <mo>′</mo>
   </msup>
   <mo>≤</mo>
   <msup>
    <mn>2</mn>
    <mn>161</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">160</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">161</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{160}\leq e^{\prime}\leq 2^{161}
  </annotation>
 </semantics>
</math>

,<br/>
where<br/>
</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:232">
 <semantics>
  <mrow>
   <msup>
    <mi>h</mi>
    <mo>′</mo>
   </msup>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>N</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>h</ci>
     <ci>normal-′</ci>
    </apply>
    <set>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>N</ci>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h^{\prime}\in\left\{1,...,N-1\right\}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:233">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mi>c</mi>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>h</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <mi>N</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>c</ci>
     <ci>d</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>N</ci>
     </interval>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   gcd(h^{\prime},N)=1
  </annotation>
 </semantics>
</math>

.</p>
</center></li>
<li>Set 

<math display="inline" id="ACE_Encrypt:234">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mi>c</mi>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>h</mi>
       <mo>′</mo>
      </msup>
      <mo>±</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mi>N</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>c</ci>
     <ci>d</ci>
     <interval closure="open">
      <apply>
       <csymbol cd="latexml">plus-or-minus</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <ci>normal-′</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <ci>N</ci>
     </interval>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   gcd(h^{\prime}\pm 1,N)=1
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate random prime number 

<math display="inline" id="ACE_Encrypt:235">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mo>←</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>h</mi>
       <mo>′</mo>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>h</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h\leftarrow(h^{\prime})^{-2}remN
  </annotation>
 </semantics>
</math>

, где 

<math display="inline" id="ACE_Encrypt:236">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>p</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>q</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>/</mo>
      <mn>4</mn>
     </mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>a</ci>
    <set>
     <cn type="integer">0</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>q</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <cn type="integer">4</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a\in\left\{0,...,(p-1)(q-1)/4-1\right\}
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate random 

<math display="inline" id="ACE_Encrypt:237">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>←</mo>
   <mrow>
    <msup>
     <mi>h</mi>
     <mi>a</mi>
    </msup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>x</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <ci>a</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\leftarrow h^{a}remN
  </annotation>
 </semantics>
</math>

, taking into account 

<math display="inline" id="ACE_Encrypt:238">
 <semantics>
  <mrow>
   <msup>
    <mi>k</mi>
    <mo>′</mo>
   </msup>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>B</mi>
     <mn>184</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <cn type="integer">184</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k^{\prime}\in B^{184}\,
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:239">
 <semantics>
  <mrow>
   <mi>s</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>B</mi>
     <mn>32</mn>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <cn type="integer">32</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s\in B^{32}\,
  </annotation>
 </semantics>
</math>

, and compute 

<math display="inline" id="ACE_Encrypt:240">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>N</mi>
    <mo>,</mo>
    <mi>h</mi>
    <mo>,</mo>
    <mi>x</mi>
    <mo>,</mo>
    <msup>
     <mi>e</mi>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>k</mi>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo>,</mo>
    <mi>q</mi>
    <mo>,</mo>
    <mi>a</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <vector>
     <ci>N</ci>
     <ci>h</ci>
     <ci>x</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>k</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>s</ci>
    </vector>
    <vector>
     <ci>p</ci>
     <ci>q</ci>
     <ci>a</ci>
    </vector>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ((N,h,x,e^{\prime},k^{\prime},s),(p,q,a))\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate random 

<math display="inline" id="ACE_Encrypt:241">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>d</mi>
   <mo>,</mo>
   <mi>w</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <mover accent="true">
    <mi>k</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>d</ci>
    <ci>w</ci>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <ci>normal-~</ci>
     <ci>k</ci>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (d,w,y,y^{\prime},\tilde{k})
  </annotation>
 </semantics>
</math>

and compute 

<math display="inline" id="ACE_Encrypt:242">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>d</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate random byte strings 

<math display="inline" id="ACE_Encrypt:243">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>B</mi>
    <mn>64</mn>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>B</ci>
    <cn type="integer">64</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B^{64}\,
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="ACE_Encrypt:244">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>w</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>w</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   w\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Return public key/private key pair
<center>

<p>

<math display="inline" id="ACE_Encrypt:245">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>160</mn>
   </msup>
   <mo>≤</mo>
   <mi>w</mi>
   <mo>≤</mo>
   <msup>
    <mn>2</mn>
    <mn>161</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">160</cn>
     </apply>
     <ci>w</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">161</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{160}\leq w\leq 2^{161}
  </annotation>
 </semantics>
</math>

.</p>
</center></li>
</ol>
<h3 id="signature-representation">Signature Representation</h3>

<p>The signature in the ACE signature scheme has the form 

<math display="inline" id="ACE_Encrypt:246">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>,</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>y</mi>
     <mo>′</mo>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y,y^{\prime}\,
  </annotation>
 </semantics>
</math>

, where the components are defined the following way:<br/>


<math display="inline" id="ACE_Encrypt:247">
 <semantics>
  <mrow>
   <mo>{</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <mrow>
    <mi>N</mi>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
   <mo>}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <cn type="integer">1</cn>
    <ci>normal-…</ci>
    <apply>
     <minus></minus>
     <ci>N</ci>
     <cn type="integer">1</cn>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\{1,...,N-1\right\}
  </annotation>
 </semantics>
</math>

 — element 

<math display="inline" id="ACE_Encrypt:248">
 <semantics>
  <mpadded width="+1.7pt">
   <mover accent="true">
    <mi>k</mi>
    <mo stretchy="false">~</mo>
   </mover>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-~</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{k}\,
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:249">
 <semantics>
  <mpadded width="+1.7pt">
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>B</ci>
    <ci>normal-∗</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B^{\ast}\,
  </annotation>
 </semantics>
</math>

 — integer, such that 

<math display="inline" id="ACE_Encrypt:250">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mover accent="true">
      <mi>k</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>64</mn>
    <mo>+</mo>
    <mrow>
     <mn>20</mn>
     <msub>
      <mi>L</mi>
      <mi>B</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>⌈</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>L</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>M</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo>+</mo>
          <mn>8</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>/</mo>
        <mn>64</mn>
       </mrow>
       <mo>⌉</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>L</ci>
     <apply>
      <ci>normal-~</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">64</cn>
     <apply>
      <times></times>
      <cn type="integer">20</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>B</ci>
      </apply>
      <apply>
       <ceiling></ceiling>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <ci>L</ci>
          <ci>M</ci>
         </apply>
         <cn type="integer">8</cn>
        </apply>
        <cn type="integer">64</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(\tilde{k})=64+20L_{B}(\left\lceil(L(M)+8)/64\right\rceil)
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:251">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>M</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\,
  </annotation>
 </semantics>
</math>

 — elements 

<math display="inline" id="ACE_Encrypt:252">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>E</mi>
   <mi>n</mi>
   <mi>c</mi>
   <mi>o</mi>
   <mi>d</mi>
   <mpadded width="+1.7pt">
    <mi>e</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>E</ci>
    <ci>n</ci>
    <ci>c</ci>
    <ci>o</ci>
    <ci>d</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SEncode\,
  </annotation>
 </semantics>
</math>

.<br/>


<math display="inline" id="ACE_Encrypt:253">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>D</mi>
   <mi>e</mi>
   <mi>c</mi>
   <mi>o</mi>
   <mi>d</mi>
   <mpadded width="+1.7pt">
    <mi>e</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>D</ci>
    <ci>e</ci>
    <ci>c</ci>
    <ci>o</ci>
    <ci>d</ci>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SDecode\,
  </annotation>
 </semantics>
</math>

 — element 

<math display="inline" id="ACE_Encrypt:254">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l>0\,
  </annotation>
 </semantics>
</math>

;note that 

<math display="inline" id="ACE_Encrypt:255">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mn>64</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <cn type="integer">64</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d\in B^{64}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="ACE_Encrypt:256">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>w</mi>
   <mo>≤</mo>
   <msup>
    <mn>256</mn>
    <mn>21</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>w</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">256</cn>
      <cn type="integer">21</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq w\leq 256^{21}
  </annotation>
 </semantics>
</math>

 — message being signed.<br/>
We need to introduce the 

<math display="inline" id="ACE_Encrypt:257">
 <semantics>
  <mrow>
   <mrow>
    <mn>0</mn>
    <mo>≤</mo>
    <mi>y</mi>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msup>
     <mi>y</mi>
     <mo>′</mo>
    </msup>
    <mo><</mo>
    <msup>
     <mn>256</mn>
     <mi>l</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>y</ci>
    </apply>
    <apply>
     <lt></lt>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>y</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">256</cn>
      <ci>l</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq y,y^{\prime}<256^{l}
  </annotation>
 </semantics>
</math>

 function, which maps a signature into its byte string representation, and the corresponding inverse function 

<math display="inline" id="ACE_Encrypt:258">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>k</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <ci>normal-~</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{k}\in B^{\ast}
  </annotation>
 </semantics>
</math>

. For integer 

<math display="inline" id="ACE_Encrypt:259">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>E</mi>
    <mi>n</mi>
    <mi>c</mi>
    <mi>o</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>d</mi>
     <mo>,</mo>
     <mi>w</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <mover accent="true">
      <mi>k</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo fence="true">||</mo>
     <mrow>
      <mi>p</mi>
      <mi>a</mi>
      <msub>
       <mi>d</mi>
       <mn>21</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>I</mi>
         <mi>Z</mi>
         <msup>
          <mi>B</mi>
          <mo>∗</mo>
         </msup>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>w</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">||</mo>
    </mrow>
    <mi>p</mi>
    <mi>a</mi>
    <msub>
     <mi>d</mi>
     <mi>l</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msubsup>
       <mi>I</mi>
       <mi>Z</mi>
       <msup>
        <mi>B</mi>
        <mo>∗</mo>
       </msup>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo fence="true">||</mo>
     <mrow>
      <mi>p</mi>
      <mi>a</mi>
      <msub>
       <mi>d</mi>
       <mi>l</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msubsup>
         <mi>I</mi>
         <mi>Z</mi>
         <msup>
          <mi>B</mi>
          <mo>∗</mo>
         </msup>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <msup>
          <mi>y</mi>
          <mo>′</mo>
         </msup>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">||</mo>
    </mrow>
    <mover accent="true">
     <mi>k</mi>
     <mo stretchy="false">~</mo>
    </mover>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <eq></eq>
      <ci>def</ci>
     </apply>
     <apply>
      <times></times>
      <ci>S</ci>
      <ci>E</ci>
      <ci>n</ci>
      <ci>c</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>e</ci>
      <vector>
       <ci>l</ci>
       <ci>d</ci>
       <ci>w</ci>
       <ci>y</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>y</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <ci>k</ci>
       </apply>
      </vector>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>a</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <cn type="integer">21</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>I</ci>
           <ci>Z</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>B</ci>
           <ci>normal-∗</ci>
          </apply>
         </apply>
         <ci>w</ci>
        </apply>
       </apply>
      </apply>
      <ci>p</ci>
      <ci>a</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>l</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <ci>Z</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>B</ci>
         <ci>normal-∗</ci>
        </apply>
       </apply>
       <ci>y</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <times></times>
        <ci>p</ci>
        <ci>a</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>d</ci>
         <ci>l</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>I</ci>
           <ci>Z</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>B</ci>
           <ci>normal-∗</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>y</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <ci>normal-~</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <ci>normal-∗</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SEncode(l,d,w,y,y^{\prime},\tilde{k})\stackrel{\mathrm{def}}{=}d||pad_{21}(I_{%
Z}^{B^{\ast}}(w))||pad_{l}(I_{Z}^{B^{\ast}}(y))||pad_{l}(I_{Z}^{B^{\ast}}(y^{%
\prime}))||\tilde{k}\in B^{\ast}
  </annotation>
 </semantics>
</math>

, byte string 

<math display="inline" id="ACE_Encrypt:260">
 <semantics>
  <mrow>
   <mi>l</mi>
   <mo>></mo>
   <mpadded width="+1.7pt">
    <mn>0</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>l</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l>0\,
  </annotation>
 </semantics>
</math>

, integers 

<math display="inline" id="ACE_Encrypt:261">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mo>∗</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>σ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma\in B^{\ast}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="ACE_Encrypt:262">
 <semantics>
  <mrow>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>σ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>l</mi>
    </mrow>
    <mo>+</mo>
    <mn>53</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <times></times>
     <ci>L</ci>
     <ci>σ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>l</ci>
     </apply>
     <cn type="integer">53</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   L(\sigma)\geq 2l+53
  </annotation>
 </semantics>
</math>

, and byte string 

<math display="inline" id="ACE_Encrypt:263">
 <semantics>
  <mrow>
   <mrow>
    <mi>C</mi>
    <mi>S</mi>
    <mi>e</mi>
    <mi>c</mi>
    <mi>o</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>l</mi>
     <mo>,</mo>
     <mi>σ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mover>
    <mo movablelimits="false">=</mo>
    <mi>def</mi>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mrow>
      <mo maxsize="160%" minsize="160%">[</mo>
      <mi>σ</mi>
      <mo maxsize="160%" minsize="160%">]</mo>
     </mrow>
     <mn>0</mn>
     <mn>64</mn>
    </msubsup>
    <mo>,</mo>
    <mrow>
     <msubsup>
      <mi>I</mi>
      <msup>
       <mi>B</mi>
       <mo>∗</mo>
      </msup>
      <mi>Z</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mi>σ</mi>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mn>64</mn>
       <mn>85</mn>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msubsup>
      <mi>I</mi>
      <msup>
       <mi>B</mi>
       <mo>∗</mo>
      </msup>
      <mi>Z</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mi>σ</mi>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mn>85</mn>
       <mrow>
        <mn>85</mn>
        <mo>+</mo>
        <mi>l</mi>
       </mrow>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msubsup>
      <mi>I</mi>
      <msup>
       <mi>B</mi>
       <mo>∗</mo>
      </msup>
      <mi>Z</mi>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msubsup>
       <mrow>
        <mo maxsize="160%" minsize="160%">[</mo>
        <mi>σ</mi>
        <mo maxsize="160%" minsize="160%">]</mo>
       </mrow>
       <mrow>
        <mn>85</mn>
        <mo>+</mo>
        <mi>l</mi>
       </mrow>
       <mrow>
        <mn>85</mn>
        <mo>+</mo>
        <mrow>
         <mn>2</mn>
         <mi>l</mi>
        </mrow>
       </mrow>
      </msubsup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>,</mo>
    <msubsup>
     <mrow>
      <mo maxsize="160%" minsize="160%">[</mo>
      <mi>σ</mi>
      <mo maxsize="160%" minsize="160%">]</mo>
     </mrow>
     <mrow>
      <mn>85</mn>
      <mo>+</mo>
      <mrow>
       <mn>2</mn>
       <mi>l</mi>
      </mrow>
     </mrow>
     <mrow>
      <mi>L</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>σ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <mrow>
    <msup>
     <mi>B</mi>
     <mn>64</mn>
    </msup>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <mi>Z</mi>
    <mo>×</mo>
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <eq></eq>
      <ci>def</ci>
     </apply>
     <apply>
      <times></times>
      <ci>C</ci>
      <ci>S</ci>
      <ci>e</ci>
      <ci>c</ci>
      <ci>o</ci>
      <ci>d</ci>
      <ci>e</ci>
      <interval closure="open">
       <ci>l</ci>
       <ci>σ</ci>
      </interval>
     </apply>
     <vector>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>σ</ci>
        </apply>
        <cn type="integer">0</cn>
       </apply>
       <cn type="integer">64</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>normal-∗</ci>
         </apply>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>σ</ci>
         </apply>
         <cn type="integer">64</cn>
        </apply>
        <cn type="integer">85</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>normal-∗</ci>
         </apply>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>σ</ci>
         </apply>
         <cn type="integer">85</cn>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">85</cn>
         <ci>l</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>I</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>B</ci>
          <ci>normal-∗</ci>
         </apply>
        </apply>
        <ci>Z</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>σ</ci>
         </apply>
         <apply>
          <plus></plus>
          <cn type="integer">85</cn>
          <ci>l</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">85</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>l</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>σ</ci>
        </apply>
        <apply>
         <plus></plus>
         <cn type="integer">85</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>l</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>L</ci>
        <ci>σ</ci>
       </apply>
      </apply>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <cn type="integer">64</cn>
      </apply>
      <ci>Z</ci>
      <ci>Z</ci>
      <ci>Z</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <ci>normal-∗</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   CSecode(l,\sigma)\stackrel{\mathrm{def}}{=}(\Bigl[\sigma\Bigr]_{0}^{64},I_{B^{%
\ast}}^{Z}(\Bigl[\sigma\Bigr]_{64}^{85}),I_{B^{\ast}}^{Z}(\Bigl[\sigma\Bigr]_{%
85}^{85+l}),I_{B^{\ast}}^{Z}(\Bigl[\sigma\Bigr]_{85+l}^{85+2l}),\Bigl[\sigma%
\Bigr]_{85+2l}^{L(\sigma)})\in B^{64}\times Z\times Z\times Z\times B^{\ast}
  </annotation>
 </semantics>
</math>

,</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:264">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>N</mi>
   <mo>,</mo>
   <mi>h</mi>
   <mo>,</mo>
   <mi>x</mi>
   <mo>,</mo>
   <msup>
    <mi>e</mi>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <msup>
    <mi>k</mi>
    <mo>′</mo>
   </msup>
   <mo>,</mo>
   <mi>s</mi>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>N</ci>
    <ci>h</ci>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>k</ci>
     <ci>normal-′</ci>
    </apply>
    <ci>s</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (N,h,x,e^{\prime},k^{\prime},s)\,
  </annotation>
 </semantics>
</math>

.</p>
</center>

<p><br/>
For integer 

<math display="inline" id="ACE_Encrypt:265">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>p</mi>
   <mo>,</mo>
   <mi>q</mi>
   <mo>,</mo>
   <mi>a</mi>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>p</ci>
    <ci>q</ci>
    <ci>a</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (p,q,a)\,
  </annotation>
 </semantics>
</math>

, byte string 

<math display="inline" id="ACE_Encrypt:266">
 <semantics>
  <mrow>
   <mi>M</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>M</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M\in B^{\ast}\,
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="ACE_Encrypt:267">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mrow>
    <mi>L</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>M</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <msup>
    <mn>2</mn>
    <mn>64</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <apply>
      <times></times>
      <ci>L</ci>
      <ci>M</ci>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">64</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq L(M)\leq 2^{64}
  </annotation>
 </semantics>
</math>

,</p>
<center>

<p>

<math display="inline" id="ACE_Encrypt:268">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mo>∈</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>B</mi>
     <mo>∗</mo>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>σ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <ci>normal-∗</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma\in B^{\ast}\,
  </annotation>
 </semantics>
</math>

.</p>
</center>
<h3 id="signature-generation-process">Signature Generation Process</h3>

<p><strong>Algorithm.</strong> ACE Signature Generation Process.<br/>
Input: public key 

<math display="inline" id="ACE_Encrypt:269">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>k</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>∈</mo>
   <msup>
    <mi>B</mi>
    <mrow>
     <mrow>
      <mn>20</mn>
      <mi>m</mi>
     </mrow>
     <mo>+</mo>
     <mn>64</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <ci>normal-~</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>B</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">20</cn>
       <ci>m</ci>
      </apply>
      <cn type="integer">64</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{k}\in B^{20m+64}
  </annotation>
 </semantics>
</math>

 and corresponding private key 

<math display="inline" id="ACE_Encrypt:270">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>L</mi>
     <mi>b</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>⌈</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mi>L</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>M</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mn>8</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>/</mo>
       <mn>64</mn>
      </mrow>
      <mo>⌉</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>L</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <ceiling></ceiling>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>L</ci>
         <ci>M</ci>
        </apply>
        <cn type="integer">8</cn>
       </apply>
       <cn type="integer">64</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=L_{b}(\left\lceil(L(M)+8)/64\right\rceil)
  </annotation>
 </semantics>
</math>

 and byte string 

<math display="inline" id="ACE_Encrypt:271">
 <semantics>
  <mrow>
   <msub>
    <mi>m</mi>
    <mi>h</mi>
   </msub>
   <mo>←</mo>
   <mrow>
    <msubsup>
     <mi>I</mi>
     <msup>
      <mi>W</mi>
      <mo>∗</mo>
     </msup>
     <mi>Z</mi>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>U</mi>
      <mi>O</mi>
      <mi>W</mi>
      <mi>H</mi>
      <mi>a</mi>
      <mi>s</mi>
      <msup>
       <mi>h</mi>
       <mi>′′</mi>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mover accent="true">
        <mi>k</mi>
        <mo stretchy="false">~</mo>
       </mover>
       <mo>,</mo>
       <mi>M</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <ci>h</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>I</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>W</ci>
        <ci>normal-∗</ci>
       </apply>
      </apply>
      <ci>Z</ci>
     </apply>
     <apply>
      <times></times>
      <ci>U</ci>
      <ci>O</ci>
      <ci>W</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <ci>′′</ci>
      </apply>
      <interval closure="open">
       <apply>
        <ci>normal-~</ci>
        <ci>k</ci>
       </apply>
       <ci>M</ci>
      </interval>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{h}\leftarrow I_{W^{\ast}}^{Z}(UOWHash^{\prime\prime}(\tilde{k},M))
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:272">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">~</mo>
   </mover>
   <mo>∈</mo>
   <mrow>
    <mo>{</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <mi>N</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <ci>normal-~</ci>
     <ci>y</ci>
    </apply>
    <set>
     <cn type="integer">1</cn>
     <ci>normal-…</ci>
     <apply>
      <minus></minus>
      <ci>N</ci>
      <cn type="integer">1</cn>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tilde{y}\in\left\{1,...,N-1\right\}
  </annotation>
 </semantics>
</math>

.<br/>
Output: byte string — digital signature 

<math display="inline" id="ACE_Encrypt:273">
 <semantics>
  <mrow>
   <msup>
    <mi>y</mi>
    <mo>′</mo>
   </msup>
   <mo>←</mo>
   <mrow>
    <msup>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mn>2</mn>
    </msup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>y</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <ci>normal-~</ci>
       <ci>y</ci>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y^{\prime}\leftarrow\tilde{y}^{2}remN
  </annotation>
 </semantics>
</math>

.</p>
<ol>
<li>Perform the following steps to hash the input data:
<ol>
<li>Generate a hash key 

<math display="inline" id="ACE_Encrypt:274">
 <semantics>
  <mrow>
   <msup>
    <mi>x</mi>
    <mo>′</mo>
   </msup>
   <mo>←</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>y</mi>
       <mo>′</mo>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>r</mi>
      <mo>′</mo>
     </msup>
    </msup>
    <msup>
     <mi>h</mi>
     <msub>
      <mi>m</mi>
      <mi>h</mi>
     </msub>
    </msup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{\prime}\leftarrow(y^{\prime})^{r^{\prime}}h^{m_{h}}remN
  </annotation>
 </semantics>
</math>

 at random, such that 

<math display="inline" id="ACE_Encrypt:275">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>e</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>e</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:276">
 <semantics>
  <mrow>
   <msup>
    <mn>2</mn>
    <mn>160</mn>
   </msup>
   <mo>≤</mo>
   <mi>e</mi>
   <mo>≤</mo>
   <msup>
    <mn>2</mn>
    <mn>161</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">160</cn>
     </apply>
     <ci>e</ci>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">161</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2^{160}\leq e\leq 2^{161}
  </annotation>
 </semantics>
</math>

.</li>
</ol></li>
<li>Select 

<math display="inline" id="ACE_Encrypt:277">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>w</mi>
   <mo>,</mo>
   <mi>d</mi>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <ci>w</ci>
    <ci>d</ci>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (w,d)\,
  </annotation>
 </semantics>
</math>

 at random, and compute 

<math display="block" id="ACE_Encrypt:278">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>e</mi>
    <mo>,</mo>
    <mi>w</mi>
    <mo>,</mo>
    <mi>d</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>←</mo>
   <mrow>
    <mi>G</mi>
    <mi>e</mi>
    <mi>n</mi>
    <mi>C</mi>
    <mi>e</mi>
    <mi>r</mi>
    <mi>t</mi>
    <mi>P</mi>
    <mi>r</mi>
    <mi>i</mi>
    <mi>m</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <vector>
     <ci>e</ci>
     <ci>w</ci>
     <ci>d</ci>
    </vector>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>e</ci>
     <ci>n</ci>
     <ci>C</ci>
     <ci>e</ci>
     <ci>r</ci>
     <ci>t</ci>
     <ci>P</ci>
     <ci>r</ci>
     <ci>i</ci>
     <ci>m</ci>
     <ci>e</ci>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (e,w,d)\leftarrow GenCertPrime(s)\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:279">
 <semantics>
  <mrow>
   <mi>e</mi>
   <mo>≠</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>e</mi>
     <mo>′</mo>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>e</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e\neq e^{\prime}\,
  </annotation>
 </semantics>
</math>

.</li>
<li>Generate a random prime 

<math display="inline" id="ACE_Encrypt:280">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>←</mo>
   <mrow>
    <mi>U</mi>
    <mi>O</mi>
    <mi>W</mi>
    <mi>H</mi>
    <mi>a</mi>
    <mi>s</mi>
    <msup>
     <mi>h</mi>
     <mi>′′′</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>k</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>N</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <msup>
      <mi>x</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <mover accent="true">
      <mi>k</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mi>Z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-←</ci>
     <ci>r</ci>
     <apply>
      <times></times>
      <ci>U</ci>
      <ci>O</ci>
      <ci>W</ci>
      <ci>H</ci>
      <ci>a</ci>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>h</ci>
       <ci>′′′</ci>
      </apply>
      <vector>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>k</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>L</ci>
         <ci>B</ci>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <ci>normal-~</ci>
        <ci>k</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <ci>Z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r\leftarrow UOWHash^{\prime\prime\prime}(k^{\prime},L_{B}(N),x^{\prime},\tilde%
{k})\in Z
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="ACE_Encrypt:281">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mi>r</mi>
   <mo><</mo>
   <msup>
    <mn>2</mn>
    <mn>160</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <leq></leq>
     <cn type="integer">0</cn>
     <ci>r</ci>
    </apply>
    <apply>
     <lt></lt>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">160</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq r<2^{160}
  </annotation>
 </semantics>
</math>

, and its certificate of correctness 

<math display="inline" id="ACE_Encrypt:282">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>←</mo>
   <mrow>
    <msup>
     <mi>h</mi>
     <mi>b</mi>
    </msup>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>y</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <ci>b</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\leftarrow h^{b}remN
  </annotation>
 </semantics>
</math>



<math display="inline" id="ACE_Encrypt:283">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo>←</mo>
   <mrow>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>a</mi>
      <mo>-</mo>
      <mi>r</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>r</mi>
    <mi>e</mi>
    <mi>m</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>p</mi>
       <mo>′</mo>
      </msup>
      <msup>
       <mi>q</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>b</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>a</ci>
      <ci>r</ci>
     </apply>
     <ci>r</ci>
     <ci>e</ci>
     <ci>m</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>q</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b\leftarrow e^{-1}(a-r)rem(p^{\prime}q^{\prime})
  </annotation>
 </semantics>
</math>

. Repeat this step until 

<math display="inline" id="ACE_Encrypt:284">
 <semantics>
  <mrow>
   <msup>
    <mi>p</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>p</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>p</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>p</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{\prime}=(p-1)/2
  </annotation>
 </semantics>
</math>

.</li>
<li>Set 

<math display="inline" id="ACE_Encrypt:285">
 <semantics>
  <mrow>
   <msup>
    <mi>q</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>q</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mn>2</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>q</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>q</ci>
      <cn type="integer">1</cn>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{\prime}=(q-1)/2
  </annotation>
 </semantics>
</math>

; note that 

<math display="inline" id="ACE_Encrypt:286">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mo>←</mo>
   <mrow>
    <mi>S</mi>
    <mi>E</mi>
    <mi>n</mi>
    <mi>c</mi>
    <mi>o</mi>
    <mi>d</mi>
    <mi>e</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>N</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mi>d</mi>
     <mo>,</mo>
     <mi>w</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <msup>
      <mi>y</mi>
      <mo>′</mo>
     </msup>
     <mo>,</mo>
     <mover accent="true">
      <mi>k</mi>
      <mo stretchy="false">~</mo>
     </mover>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-←</ci>
    <ci>σ</ci>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>E</ci>
     <ci>n</ci>
     <ci>c</ci>
     <ci>o</ci>
     <ci>d</ci>
     <ci>e</ci>
     <vector>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>L</ci>
        <ci>B</ci>
       </apply>
       <ci>N</ci>
      </apply>
      <ci>d</ci>
      <ci>w</ci>
      <ci>y</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <ci>normal-~</ci>
       <ci>k</ci>
      </apply>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma\leftarrow SEncode(L_{B}(N),d,w,y,y^{\prime},\tilde{k})
  </annotation>
 </semantics>
</math>

.</li>
<li>Compute 

<math display="inline" id="ACE_Encrypt:287">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>σ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma\,
  </annotation>
 </semantics>
</math>

, where
<center>

<p><span class="LaTeX">$b \leftarrow e^{-1}(a-r)rem(p^{\prime}q^{\prime})$</span>,</p>
</center>

<p><br/>
and where <span class="LaTeX">$p^{\prime}=(p-1)/2$</span> and <span class="LaTeX">$q^{\prime}=(q-1)/2$</span>.</p></li>
<li>Encode the signature:
<center>

<p><span class="LaTeX">$\sigma \leftarrow SEncode(L_B(N),d,w,y,y^{\prime},\tilde{k})$</span>.</p>
</center></li>
<li>Return <span class="LaTeX">$\sigma\,$</span></li>
</ol>
<h2 id="notes">Notes</h2>

<p>In the definition of ACE Encryption process and ACE Signature process some auxiliary function(e.g. UOWHash,ESHash and some other) are being used, definition of which goes beyond this article. You cand find more details about it in в.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="implementation-utilization-and-performance">Implementation, Utilization and Performance</h2>

<p>ACE Encryption scheme is recommended by NESSIE (New European Schemes for Signatures, Integrity and Encryption) as asymmetric encryption scheme. Press-release is dated by February 2003.</p>

<p>Both schemes were implemented in ANSI C, with the use of GNU GMP library. Tests were done on two platforms: Power PC 604 model 43P under AIX system and 266 MHz Pentium under Windows NT system. Result tables:</p>

<p>Table 1. Time costs on basic operations.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>Power PC</p></td>
<td style="text-align: left;">
<p>Pentium</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>Operand size(byte)</p></td>
<td style="text-align: left;">
<p>Operand size(byte)</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>512</p></td>
<td style="text-align: left;">
<p>1024</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Multiplication</p></td>
<td style="text-align: left;">
<p>3.5 * 10^(-5) sec</p></td>
<td style="text-align: left;">
<p>1.0 * 10^(-4) sec</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Squaring</p></td>
<td style="text-align: left;">
<p>3.3 * 10^(-5) sec</p></td>
<td style="text-align: left;">
<p>1.0 * 10^(-4) sec</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Exponentiation</p></td>
<td style="text-align: left;">
<p>1.9 * 10^(-2) sec</p></td>
<td style="text-align: left;">
<p>1.2 * 10^(-1) sec</p></td>
</tr>
</tbody>
</table>

<p>Table 2. Performance of encryption scheme and signature scheme.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>Power PC</p></td>
<td style="text-align: left;">
<p>Pentium</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">
<p>Fixed costs (ms)</p></td>
<td style="text-align: left;">
<p>MBit/sec</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Encrypt</p></td>
<td style="text-align: left;">
<p>160</p></td>
<td style="text-align: left;">
<p>18</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Decrypt</p></td>
<td style="text-align: left;">
<p>68</p></td>
<td style="text-align: left;">
<p>18</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Sign</p></td>
<td style="text-align: left;">
<p>48</p></td>
<td style="text-align: left;">
<p>64</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Sign set-up</p></td>
<td style="text-align: left;">
<p>29</p></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Verify</p></td>
<td style="text-align: left;">
<p>52</p></td>
<td style="text-align: left;">
<p>65</p></td>
</tr>
</tbody>
</table>
<h2 id="literature">Literature</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.alphaworks.ibm.com/tech/ace"></a><a class="uri" href="http://www.alphaworks.ibm.com/tech/ace">http://www.alphaworks.ibm.com/tech/ace</a></li>
<li><a href="http://www.zurich.ibm.com/security/ace/"></a><a class="uri" href="http://www.zurich.ibm.com/security/ace/">http://www.zurich.ibm.com/security/ace/</a></li>
<li><a href="https://www.cosic.esat.kuleuven.be/nessie/deliverables/decision-final.pdf">NESSIE Portfolio of recommended cryptographic primitives</a></li>
</ul>

<p>"</p>

<p><a href="Category:Cryptographic_software" title="wikilink">Category:Cryptographic software</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://www.zurich.ibm.com/security/ace/ace_spec.pdf">ACE: The Advanced Cryptographic Engine, T. Schweinberger and V. Shoup, manuscript 2000</a><a href="#fnref1">↩</a></li>
</ol>
</section>
</body>
</html>

   Symplectic integrator      Symplectic integrator   In mathematics , a symplectic integrator (SI) is a numerical integration scheme for a specific group of differential equations related to classical mechanics and symplectic geometry . Symplectic integrators form the subclass of geometric integrators which, by definition, are canonical transformations . They are widely used in molecular dynamics , discrete element methods , accelerator physics , and celestial mechanics .  Introduction  Symplectic integrators are designed for the numerical solution of Hamilton's equations , which read         p  ˙   =    -    ∂  H    ∂  q     and      q  ˙   =    ∂  H    ∂  p      ,     formulae-sequence     normal-˙  p          H     q     and       normal-˙  q       H     p       \dot{p}=-\frac{\partial H}{\partial q}\quad\mbox{and}\quad\dot{q}=\frac{%
 \partial H}{\partial p},   where   q   q   q   denotes the position coordinates,   p   p   p   the momentum coordinates, and   H   H   H   is the Hamiltonian. The set of position and momentum coordinates    (  q  ,  p  )     q  p    (q,p)   are called canonical coordinates . (See Hamiltonian mechanics for more background.)  The time evolution of Hamilton's equations is a symplectomorphism , meaning that it conserves the symplectic two-form      d  p   ∧   d  q         d  p     d  q     dp\wedge dq   . A numerical scheme is a symplectic integrator if it also conserves this two-form.  Symplectic integrators possess, as a conserved quantity, a Hamiltonian which is slightly perturbed from the original one. By virtue of these advantages, the SI scheme has been widely applied to the calculations of long-term evolution of chaotic Hamiltonian systems ranging from the Kepler problem to the classical and semi-classical simulations in molecular dynamics .  Most of the usual numerical methods, like the primitive Euler scheme and the classical Runge-Kutta scheme , are not symplectic integrators.  Splitting methods for separable Hamiltonians  A widely used class of symplectic integrators is formed by the splitting methods.  Assume that the Hamiltonian is separable, meaning that it can be written in the form      H   (  p  ,  q  )   =  T   (  p  )   +  V   (  q  )   .   (  1  )      fragments  H   fragments  normal-(  p  normal-,  q  normal-)    T   fragments  normal-(  p  normal-)    V   fragments  normal-(  q  normal-)   normal-.  italic-   fragments  normal-(  1  normal-)     H(p,q)=T(p)+V(q).\qquad\qquad(1)     This happens frequently in Hamiltonian mechanics, with T being the kinetic energy and V the potential energy .  For the notational simplicity, let us introduce the symbol    z  =   (  q  ,  p  )       z   q  p     z=(q,p)   to denote the canonical coordinates including both the position and momentum coordinates. Then, the set of the Hamiltonian's equations given in the introduction can be expressed in a single expression as       z  ˙   =    {  z  ,   H   (  z  )    }    (  2  )         normal-˙  z     z    H  z    2     \dot{z}=\{z,H(z)\}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2)     where    {  ⋅  ,  ⋅  }     normal-⋅  normal-⋅    \{\cdot,\cdot\}   is a Poisson bracket . Furthermore, by introducing an operator,     D  H   ⋅  =   {  ⋅  ,  H  }      fragments   subscript  D  H   normal-⋅    fragments  normal-{  normal-⋅  normal-,  H  normal-}     D_{H}\cdot=\{\cdot,H\}   , which returns a Poisson bracket of the operand with the Hamiltonian , the expression of the Hamilton's equation can be further simplified to        z  ˙   =    D  H   z    .       normal-˙  z      subscript  D  H   z     \dot{z}=D_{H}z.     The formal solution of this set of equations is given as a matrix exponential :      z   (  τ  )   =  exp   (  τ   D  H   )   z   (  0  )   .   (  3  )      fragments  z   fragments  normal-(  τ  normal-)      fragments  normal-(  τ   subscript  D  H   normal-)   z   fragments  normal-(  0  normal-)   normal-.  italic-   fragments  normal-(  3  normal-)     z(\tau)=\exp(\tau D_{H})z(0).\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3)   Note the positivity of    τ   D  H       τ   subscript  D  H     \tau D_{H}   in the matrix exponential.  When the Hamiltonian has the form of eq. (1), the solution (3) is equivalent to      z   (  τ  )   =  exp   [  τ   (   D  T   +   D  V   )   ]   z   (  0  )   .   (  4  )      fragments  z   fragments  normal-(  τ  normal-)      fragments  normal-[  τ   fragments  normal-(   subscript  D  T     subscript  D  V   normal-)   normal-]   z   fragments  normal-(  0  normal-)   normal-.  italic-   fragments  normal-(  4  normal-)     z(\tau)=\exp[\tau(D_{T}+D_{V})]z(0).\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (4)     The SI scheme approximates the time-evolution operator    exp   [   τ   (    D  T   +   D  V    )    ]         τ     subscript  D  T    subscript  D  V       \exp[\tau(D_{T}+D_{V})]   in the formal solution (4) by a product of operators as          exp   [   τ   (    D  T   +   D  V    )    ]        =     ∏   i  =  1   k     exp   (    c  i   τ   D  T    )     exp   (    d  i   τ   D  V    )      +   O   (   τ   k  +  1    )                 =     exp   (    c  1   τ   D  T    )     exp   (    d  1   τ   D  V    )    …   exp   (    c  k   τ   D  T    )     exp   (    d  k   τ   D  V    )     +   O   (   τ   k  +  1    )         ,   (  5  )            τ     subscript  D  T    subscript  D  V        absent      superscript   subscript  product    i  1    k          subscript  c  i   τ   subscript  D  T          subscript  d  i   τ   subscript  D  V         O   superscript  τ    k  1          missing-subexpression    missing-subexpression      missing-subexpression     absent           subscript  c  1   τ   subscript  D  T          subscript  d  1   τ   subscript  D  V     normal-…       subscript  c  k   τ   subscript  D  T          subscript  d  k   τ   subscript  D  V        O   superscript  τ    k  1         5    \begin{array}[]{rl}\exp[\tau(D_{T}+D_{V})]&=\prod_{i=1}^{k}\exp(c_{i}\tau D_{T%
 })\exp(d_{i}\tau D_{V})+O(\tau^{k+1})\\
 \\
 &=\exp(c_{1}\tau D_{T})\exp(d_{1}\tau D_{V})\dots\exp(c_{k}\tau D_{T})\exp(d_{%
 k}\tau D_{V})+O(\tau^{k+1})\end{array},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (5)     where    c  i     subscript  c  i    c_{i}   and    d  i     subscript  d  i    d_{i}   are real numbers,   k   k   k   is an integer, which is called the order of the integrator, and where      ∑   i  =  1   k    c  i    =    ∑   i  =  1   k    d  i    =  1          superscript   subscript     i  1    k    subscript  c  i      superscript   subscript     i  1    k    subscript  d  i         1     \sum_{i=1}^{k}c_{i}=\sum_{i=1}^{k}d_{i}=1   . Note that each of the operators    exp   (    c  i   τ   D  T    )          subscript  c  i   τ   subscript  D  T      \exp(c_{i}\tau D_{T})   and    exp   (    d  i   τ   D  V    )          subscript  d  i   τ   subscript  D  V      \exp(d_{i}\tau D_{V})   provides a symplectic map , so their product appearing in the right hand side of (5) also constitutes a symplectic map.  Since      D  T  2   z   =   {   {  z  ,  T  }   ,  T  }   =   {   (   q  ˙   ,  0  )   ,  T  }   =   (  0  ,  0  )            superscript   subscript  D  T   2   z     z  T   T           normal-˙  q   0   T         0  0      D_{T}^{2}z=\{\{z,T\},T\}=\{(\dot{q},0),T\}=(0,0)   for all   z   z   z   , we can conclude that       D  T  2   =   0.   (  6  )         superscript   subscript  D  T   2    0.  6     D_{T}^{2}=0.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (6)     By using a Taylor series,    exp   (   a   D  T    )         a   subscript  D  T      \exp(aD_{T})   can be expressed as       exp   (   a   D  T    )    =     ∑   n  =  0   ∞      (   a   D  T    )   n    n  !     ,   (  7  )            a   subscript  D  T        superscript   subscript     n  0         superscript    a   subscript  D  T    n     n     7     \exp(aD_{T})=\sum_{n=0}^{\infty}\frac{(aD_{T})^{n}}{n!},\ \ \ \ \ \ \ \ \ \ \ %
 \ \ \ \ \ (7)     where   a   a   a   is an arbitrary real number. Combining (6) and (7), and by using the same reasoning for    D  V     subscript  D  V    D_{V}   as we have used for    D  T     subscript  D  T    D_{T}   , we get      {       exp   (   a   D  T    )    =   1  +   a   D  T            exp   (   a   D  V    )    =   1  +   a   D  V         .   (  8  )      fragments  normal-{          a   subscript  D  T       1    a   subscript  D  T              a   subscript  D  V       1    a   subscript  D  V        normal-.  italic-   fragments  normal-(  8  normal-)     \left\{\begin{array}[]{c}\exp(aD_{T})=1+aD_{T}\\
 \exp(aD_{V})=1+aD_{V}\end{array}\right..\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (8)     In concrete terms,    exp   (    c  i   τ   D  T    )          subscript  c  i   τ   subscript  D  T      \exp(c_{i}\tau D_{T})   gives the mapping       (     q      p     )   ↦   (      q  +   τ   c  i      ∂  T    ∂  p      (  p  )         p     )      maps-to    q    p        q    τ   subscript  c  i       T     p    p      p      \begin{pmatrix}q\\
 p\end{pmatrix}\mapsto\begin{pmatrix}q+\tau c_{i}\frac{\partial T}{\partial p}(%
 p)\\
 p\end{pmatrix}     and    exp   (    d  i   τ   D  V    )          subscript  d  i   τ   subscript  D  V      \exp(d_{i}\tau D_{V})   gives        (     q      p     )   ↦   (     q       p  -   τ   d  i      ∂  V    ∂  q      (  q  )        )    .     maps-to    q    p      q      p    τ   subscript  d  i       V     q    q        \begin{pmatrix}q\\
 p\end{pmatrix}\mapsto\begin{pmatrix}q\\
 p-\tau d_{i}\frac{\partial V}{\partial q}(q)\\
 \end{pmatrix}.     Note that both of these maps are practically computable.  Examples  A first-order example  The symplectic Euler method is the first-order integrator with    k  =  1      k  1    k=1   and coefficients       c  1   =   d  1   =   1.          subscript  c  1    subscript  d  1        1.     c_{1}=d_{1}=1.\     A second-order example  The Verlet method is the second-order integrator with    k  =  2      k  2    k=2   and coefficients        c  1   =   c  2   =    1  2     ,     d  1   =  1   ,    d  2   =  0.       formulae-sequence       subscript  c  1    subscript  c  2          1  2      formulae-sequence     subscript  d  1   1      subscript  d  2   0.      c_{1}=c_{2}=\tfrac{1}{2},\qquad d_{1}=1,\qquad d_{2}=0.     A third-order example  A third order symplectic integrator (with    k  =  3      k  3    k=3   ) was discovered by Ronald Ruth in 1983. 1 One of the many solutions is given by        c  1   =  1   ,     c  2   =   -    2  3      ,    c  3   =    2  3         formulae-sequence     subscript  c  1   1    formulae-sequence     subscript  c  2       2  3        subscript  c  3     2  3       c_{1}=1,\qquad c_{2}=-\tfrac{2}{3},\qquad c_{3}=\tfrac{2}{3}            d  1   =   -    1  24      ,     d  2   =    3  4     ,    d  3   =    7  24       .     formulae-sequence     subscript  d  1       1  24      formulae-sequence     subscript  d  2     3  4       subscript  d  3     7  24       d_{1}=-\tfrac{1}{24},\qquad d_{2}=\tfrac{3}{4},\qquad d_{3}=\tfrac{7}{24}.     A fourth-order example  A fourth order integrator (with    k  =  4      k  4    k=4   ) was also discovered by Ruth in 1983 and distributed privately to the accelerator community at that time. This was described in a lively review article by Forest. 2 This fourth order integrator was published in 1990 by Forest and Ruth and also independently discovered by two other groups around that same time. 3 4 5         c  1   =   c  4   =   1   2   (   2  -   2   1  /  3     )      ,    c  2   =   c  3   =    1  -   2   1  /  3      2   (   2  -   2   1  /  3     )       ,     formulae-sequence       subscript  c  1    subscript  c  4          1    2    2   superscript  2    1  3              subscript  c  2    subscript  c  3            1   superscript  2    1  3       2    2   superscript  2    1  3           c_{1}=c_{4}=\frac{1}{2(2-2^{1/3})},\ \ c_{2}=c_{3}=\frac{1-2^{1/3}}{2(2-2^{1/3%
 })},           d  1   =   d  3   =   1   2  -   2   1  /  3       ,     d  2   =   -    2   1  /  3     2  -   2   1  /  3        ,    d  4   =  0.       formulae-sequence       subscript  d  1    subscript  d  3          1    2   superscript  2    1  3         formulae-sequence     subscript  d  2        superscript  2    1  3      2   superscript  2    1  3           subscript  d  4   0.      d_{1}=d_{3}=\frac{1}{2-2^{1/3}},\ \ d_{2}=-\frac{2^{1/3}}{2-2^{1/3}},\ \ d_{4}%
 =0.   To determine these coefficients, the Baker–Campbell–Hausdorff formula can be used. Yoshida, in particular, gives an elegant derivation of coefficients for higher-order integrators. Later on, Blanes and Moan 6 further developed partitioned Runge-Kutta methods for the integration of systems with separable Hamiltonians with very small error constants.  See also   Energy drift  Multisymplectic integrator  Variational integrator  Verlet integration   References        "  Category:Numerical differential equations  Category:Hamiltonian mechanics     ↩  ↩  ↩  ↩  ↩  ↩     
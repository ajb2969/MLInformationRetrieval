<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1253">Thue–Morse sequence</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Thue–Morse sequence</h1>
<hr/>

<p>  In <a class="uri" href="mathematics" title="wikilink">mathematics</a>, the <strong>Thue–Morse sequence</strong>, or <strong>Prouhet–Thue–Morse sequence</strong>, is the <a href="binary_sequence" title="wikilink">binary sequence</a> (an infinite sequence of 0s and 1s) obtained by starting with 0 and successively appending the <a href="Boolean_algebra" title="wikilink">Boolean complement</a> of the sequence obtained thus far. The first few steps of this procedure yield the strings 0 then 01, 0110, 01101001, 0110100110010110, and so on, which are prefixes of the Thue–Morse sequence. The full sequence begins:</p>
<dl>
<dd>01101001100101101001011001101001.... 
</dd>
</dl>

<p>Any other <a href="ordered_pair" title="wikilink">ordered pair</a> of symbols may be used instead of 0 and 1; the logical structure of the Thue–Morse sequence does not depend on the symbols that are used to represent it.</p>
<h2 id="definition">Definition</h2>

<p>There are several equivalent ways of defining the Thue–Morse sequence.</p>
<h3 id="direct-definition">Direct definition</h3>

<p>To compute the <em>n</em><sup>th</sup> element <em>t<sub>n</sub></em>, write the number <em>n</em> in binary. If the number of ones in this binary expansion is odd then <em>t<sub>n</sub></em> = 1, if even then <em>t<sub>n</sub></em> = 0.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> For this reason <a href="John_H._Conway" title="wikilink">John H. Conway</a> <em>et al</em>. call numbers <em>n</em> satisfying <em>t<sub>n</sub></em> = 1 <em>odious</em> (for <em>odd</em>) numbers and numbers for which <em>t<sub>n</sub></em> = 0 <em>evil</em> (for <em>even</em>) numbers.</p>
<h3 id="recurrence-relation">Recurrence relation</h3>

<p>The Thue–Morse sequence is the sequence <em>t<sub>n</sub></em> satisfying the <a href="recurrence_relation" title="wikilink">recurrence relation</a></p>
<dl>
<dd>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p><em>t</em><sub>0</sub></p></td>
<td style="text-align: left;">
<p>= 0,</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p><em>t</em><sub>2<em>n</em></sub></p></td>
<td style="text-align: left;">
<p>= <em>t<sub>n</sub></em>, and</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p><em>t</em><sub>2<em>n</em>+1</sub></p></td>
<td style="text-align: left;">
<p>= 1 − <em>t<sub>n</sub></em>.</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>

<p>for all positive integers <em>n</em>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h3 id="l-system">L-system</h3>

<p>The Thue–Morse sequence is a <a href="morphic_word" title="wikilink">morphic word</a>:<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> it is the output of the following <a href="L-system" title="wikilink">Lindenmayer system</a>:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">
<p>Variables</p>
</th><td>

<p>0, 1</p>
</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Constants</p>
</td><td>

<p>None</p>
</td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>Start</p>
</td><td>

<p>0</p>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>Rules</p>
</td><td>

<p>(0 → 01), (1 → 10)</p>
</td>
</tr>
</tbody>
</table>
<h3 id="characterization-using-bitwise-negation">Characterization using bitwise negation</h3>

<p>The Thue–Morse sequence in the form given above, as a sequence of <a href="bit" title="wikilink">bits</a>, can be defined <a href="recursion" title="wikilink">recursively</a> using the operation of <a href="bitwise_negation" title="wikilink">bitwise negation</a>. So, the first element is 0. Then once the first 2<sup><em>n</em></sup> elements have been specified, forming a string <em>s</em>, then the next 2<sup><em>n</em></sup> elements must form the bitwise negation of <em>s</em>. Now we have defined the first 2<sup><em>n</em>+1</sup> elements, and we recurse.</p>

<p>Spelling out the first few steps in detail:</p>
<ul>
<li>We start with 0.</li>
<li>The bitwise negation of 0 is 1.</li>
<li>Combining these, the first 2 elements are 01.</li>
<li>The bitwise negation of 01 is 10.</li>
<li>Combining these, the first 4 elements are 0110.</li>
<li>The bitwise negation of 0110 is 1001.</li>
<li>Combining these, the first 8 elements are 01101001.</li>
<li>And so on.</li>
</ul>

<p>So</p>
<ul>
<li><em>T</em><sub>0</sub> = 0.</li>
<li><em>T</em><sub>1</sub> = 01.</li>
<li><em>T</em><sub>2</sub> = 0110.</li>
<li><em>T</em><sub>3</sub> = 01101001.</li>
<li><em>T</em><sub>4</sub> = 0110100110010110.</li>
<li><em>T</em><sub>5</sub> = 01101001100101101001011001101001.</li>
<li><em>T</em><sub>6</sub> = 0110100110010110100101100110100110010110011010010110100110010110.</li>
<li>And so on.</li>
</ul>
<h3 id="infinite-product">Infinite product</h3>

<p>The sequence can also be defined by:</p>

<p>

<math display="block" id="Thue–Morse_sequence:0">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>x</mi>
       <msup>
        <mn>2</mn>
        <mi>i</mi>
       </msup>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>t</mi>
       <mi>j</mi>
      </msub>
     </msup>
     <msup>
      <mi>x</mi>
      <mi>j</mi>
     </msup>
     <mpadded width="-1.7pt">
      <mtext>,</mtext>
     </mpadded>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cn type="integer">2</cn>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>t</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>j</ci>
      </apply>
      <mtext>,</mtext>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \prod_{i=0}^{\infty}(1-x^{2^{i}})=\sum_{j=0}^{\infty}(-1)^{t_{j}}x^{j}\mbox{,}\!
  </annotation>
 </semantics>
</math>

 where <em>t<sub>j</sub></em> is the <em>j</em><sup>th</sup> element if we start at <em>j</em> = 0.</p>
<h2 id="some-properties">Some properties</h2>

<p> Because each new block in the Thue–Morse sequence is defined by forming the bitwise negation of the beginning, and this is repeated at the beginning of the next block, the Thue–Morse sequence is filled with <em>squares</em>: consecutive strings that are repeated. That is, there are many instances of <em>XX</em>, where <em>X</em> is some string. Indeed, 

<math display="inline" id="Thue–Morse_sequence:1">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is such a string if and only if 

<math display="inline" id="Thue–Morse_sequence:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mrow>
     <mi>A</mi>
     <mo rspace="4.2pt">,</mo>
     <mover accent="true">
      <mi>A</mi>
      <mo>¯</mo>
     </mover>
     <mo rspace="4.2pt">,</mo>
     <mrow>
      <mi>A</mi>
      <mover accent="true">
       <mi>A</mi>
       <mo>¯</mo>
      </mover>
      <mi>A</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>X</ci>
    <list>
     <ci>A</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <times></times>
      <ci>A</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>A</ci>
      </apply>
      <ci>A</ci>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X=A,\,\overline{A},\,A\overline{A}A,
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Thue–Morse_sequence:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>A</mi>
    <mo>¯</mo>
   </mover>
   <mi>A</mi>
   <mover accent="true">
    <mi>A</mi>
    <mo>¯</mo>
   </mover>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-¯</ci>
     <ci>A</ci>
    </apply>
    <ci>A</ci>
    <apply>
     <ci>normal-¯</ci>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{A}A\overline{A}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Thue–Morse_sequence:4">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <msub>
    <mi>T</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=T_{k}
  </annotation>
 </semantics>
</math>

 for some 

<math display="inline" id="Thue–Morse_sequence:5">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>k</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\geq 0
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Thue–Morse_sequence:6">
 <semantics>
  <mover accent="true">
   <mi>A</mi>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{A}
  </annotation>
 </semantics>
</math>

 denotes the bitwise negation of 

<math display="inline" id="Thue–Morse_sequence:7">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 (interchange 0s and 1s).<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> For instance, with 

<math display="inline" id="Thue–Morse_sequence:8">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=0
  </annotation>
 </semantics>
</math>

, we have 

<math display="inline" id="Thue–Morse_sequence:9">
 <semantics>
  <mrow>
   <mpadded lspace="5pt" width="+5pt">
    <mi>A</mi>
   </mpadded>
   <mo>=</mo>
   <msub>
    <mi>T</mi>
    <mn>0</mn>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>A</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>T</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ A=T_{0}=0
  </annotation>
 </semantics>
</math>

, and the square 

<math display="inline" id="Thue–Morse_sequence:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mover accent="true">
     <mi>A</mi>
     <mo>¯</mo>
    </mover>
    <mi>A</mi>
    <mi>A</mi>
    <mover accent="true">
     <mi>A</mi>
     <mo>¯</mo>
    </mover>
    <mi>A</mi>
   </mrow>
   <mo>=</mo>
   <mn>010010</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>A</ci>
     </apply>
     <ci>A</ci>
     <ci>A</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>A</ci>
     </apply>
     <ci>A</ci>
    </apply>
    <cn type="integer">010010</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\overline{A}AA\overline{A}A=010010
  </annotation>
 </semantics>
</math>

 appears in 

<math display="inline" id="Thue–Morse_sequence:11">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 starting at the 16th bit. (Thus, squares in 

<math display="inline" id="Thue–Morse_sequence:12">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

 have length either a power of 2 or 3 times a power of 2.) However, there are no <em>cubes</em>: instances of <em>XXX</em>. There are also no <em>overlapping squares</em>: instances of 0<em>X</em>0<em>X</em>0 or 1<em>X</em>1<em>X</em>1.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> The <a href="Critical_exponent_of_a_word" title="wikilink">critical exponent</a> is 2.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a></p>

<p>Notice that <em>T</em><sub>2<em>n</em></sub> is <a href="Palindromic_number" title="wikilink">palindrome</a> for any <em>n</em> &gt; 1. Further, let q<sub><em>n</em></sub> be a word obtain from <em>T</em><sub>2<em>n</em></sub> by counting ones between consecutive zeros. For instance, <em>q</em><sub>1</sub> = 2 and <em>q</em><sub>2</sub> = 2102012 and so on. The words <em>T<sub>n</sub></em> do not contain <em>overlapping squares</em> in consequence, the words <em>q<sub>n</sub></em> are palindrome <a href="squarefree_word" title="wikilink">squarefree words</a>.</p>

<p>The statement above that the Thue–Morse sequence is "filled with squares" can be made precise: It is a <em><a href="uniformly_recurrent_word" title="wikilink">uniformly recurrent word</a></em>, meaning that given any finite string <em>X</em> in the sequence, there is some length <em>n<sub>X</sub></em> (often much longer than the length of <em>X</em>) such that <em>X</em> appears in <em>every</em> block of length <em>n</em>.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> The easiest way to make a recurrent sequence is to form a <a href="periodic_sequence" title="wikilink">periodic sequence</a>, one where the sequence repeats entirely after a given number <em>m</em> of steps. Then <em>n<sub>X</sub></em> can be set to any multiple of <em>m</em> that is larger than twice the length of <em>X</em>. But the Morse sequence is uniformly recurrent <em>without</em> being periodic, not even eventually periodic (meaning periodic after some nonperiodic initial segment).<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>We define the <strong>Thue–Morse morphism</strong> to be the <a href="function_(mathematics)" title="wikilink">function</a> <em>f</em> from the <a href="Set_(mathematics)" title="wikilink">set</a> of binary sequences to itself by replacing every 0 in a sequence with 01 and every 1 with 10.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> Then if <em>T</em> is the Thue–Morse sequence, then <em>f</em>(<em>T</em>) is <em>T</em> again; that is, <em>T</em> is a <a href="fixed_point_(mathematics)" title="wikilink">fixed point</a> of <em>f</em>. The function <em>f</em> is a <a href="prolongable_morphism" title="wikilink">prolongable morphism</a> on the <a href="free_monoid" title="wikilink">free monoid</a> {0,1}<sup>∗</sup> with <em>T</em> as fixed point: indeed, <em>T</em> is essentially the <em>only</em> fixed point of <em>f</em>; the only other fixed point is the bitwise negation of <em>T</em>, which is simply the Thue–Morse sequence on (1,0) instead of on (0,1). This property may be generalized to the concept of an <a href="automatic_sequence" title="wikilink">automatic sequence</a>.</p>

<p>The <em>generating series</em> of <em>T</em> over the <a href="binary_field" title="wikilink">binary field</a> is the <a href="formal_power_series" title="wikilink">formal power series</a></p>

<p>

<math display="block" id="Thue–Morse_sequence:13">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>t</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mi>T</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mpadded width="+5pt">
       <msup>
        <mi>Z</mi>
        <mi>n</mi>
       </msup>
      </mpadded>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>Z</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <times></times>
      <ci>T</ci>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Z</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(Z)=\sum_{n=0}^{\infty}T(n)Z^{n}\ .
  </annotation>
 </semantics>
</math>

</p>

<p>This power series is algebraic over the field of formal power series, satisfying the equation<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>

<math display="block" id="Thue–Morse_sequence:14">
 <semantics>
  <mrow>
   <mrow>
    <mi>Z</mi>
    <mo>+</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>Z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mi>t</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>Z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
     <msup>
      <mi>t</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>Z</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>Z</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>Z</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>t</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z+(1+Z)^{2}t+(1+Z)^{3}t^{2}=0
  </annotation>
 </semantics>
</math>

</p>
<h3 id="in-combinatorial-game-theory">In combinatorial game theory</h3>

<p>The set of <em>evil numbers</em> (numbers 

<math display="inline" id="Thue–Morse_sequence:15">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 with 

<math display="inline" id="Thue–Morse_sequence:16">
 <semantics>
  <mrow>
   <msub>
    <mi>t</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>t</ci>
     <ci>n</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t_{n}=0
  </annotation>
 </semantics>
</math>

) forms a subspace of the nonnegative integers under <a class="uri" href="nim-addition" title="wikilink">nim-addition</a> (<a href="bitwise_operation" title="wikilink">bitwise</a> <a href="exclusive_or" title="wikilink">exclusive or</a>). For the game of <a class="uri" href="Kayles" title="wikilink">Kayles</a>, the evil numbers form the <a href="sparse_space" title="wikilink">sparse space</a>—the subspace of <a href="nim-value" title="wikilink">nim-values</a> which occur for few (finitely many) positions in the game—and the odious numbers are the <a href="common_coset" title="wikilink">common coset</a>.</p>
<h3 id="the-prouhettarryescott-problem">The Prouhet–Tarry–Escott problem</h3>

<p>The <a href="Prouhet–Tarry–Escott_problem" title="wikilink">Prouhet–Tarry–Escott problem</a> can be defined as: given a positive integer <em>N</em> and a non-negative integer <em>k</em>, <a href="Partition_of_a_set" title="wikilink">partition</a> the set <em>S</em> = { 0, 1, ..., <em>N</em>-1 } into two <a href="Disjoint_sets" title="wikilink">disjoint</a> subsets <em>S</em><sub>0</sub> and <em>S</em><sub>1</sub> that have equal sums of powers up to k, that is:</p>

<p>

<math display="block" id="Thue–Morse_sequence:17">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>x</mi>
      <mo>∈</mo>
      <msub>
       <mi>S</mi>
       <mn>0</mn>
      </msub>
     </mrow>
    </munder>
    <msup>
     <mi>x</mi>
     <mi>i</mi>
    </msup>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>x</mi>
      <mo>∈</mo>
      <msub>
       <mi>S</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </munder>
    <msup>
     <mi>x</mi>
     <mi>i</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{x\in S_{0}}x^{i}=\sum_{x\in S_{1}}x^{i}
  </annotation>
 </semantics>
</math>

 for all integers <em>i</em> from 1 to <em>k</em>.</p>

<p>This has a solution if <em>N</em> is a multiple of 2<sup><em>k</em>+1</sup>, given by:</p>
<ul>
<li><em>S</em><sub>0</sub> consists of the integers <em>n</em> in <em>S</em> for which <em>t<sub>n</sub></em> = 0,</li>
<li><em>S</em><sub>1</sub> consists of the integers <em>n</em> in <em>S</em> for which <em>t<sub>n</sub></em> = 1.</li>
</ul>

<p>For example, for <em>N</em> = 8 and <em>k</em> = 2,</p>
<dl>
<dd>
</dd>
<dd><mtpl></mtpl>
</dd>
</dl>

<p>The condition requiring that <em>N</em> be a multiple of 2<sup><em>k</em>+1</sup> is not strictly necessary: there are some further cases for which a solution exists. However, it guarantees a stronger property: if the condition is satisfied, then the set of <em>k</em><sup>th</sup> powers of any set of <em>N</em> numbers in <a href="arithmetic_progression" title="wikilink">arithmetic progression</a> can be partitioned into two sets with equal sums. This follows directly from the expansion given by the <a href="binomial_theorem" title="wikilink">binomial theorem</a> applied to the binomial representing the <em>n</em><sup>th</sup> element of an arithmetic progression.</p>
<h3 id="fractals-and-turtle-graphics">Fractals and Turtle graphics</h3>

<p>A <a href="Turtle_Graphics" title="wikilink">Turtle Graphics</a> is the curve that is generated if an automaton is programmed with a sequence. If the Thue–Morse Sequence members are used in order to select program states:</p>
<ul>
<li>If <em>t</em>(<em>n</em>) = 0, move ahead by one unit,</li>
<li>If <em>t</em>(<em>n</em>) = 1, rotate counterclockwise by an angle of π/3,</li>
</ul>

<p>the resulting curve converges to the <a href="Koch_snowflake" title="wikilink">Koch snowflake</a>, a fractal curve of infinite length containing a finite area. This illustrates the fractal nature of the Thue–Morse Sequence.</p>
<h3 id="equitable-sequencing">Equitable sequencing</h3>

<p>In their book<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> on the problem of <a href="fair_division" title="wikilink">fair division</a>, <a href="Steven_Brams" title="wikilink">Steven Brams</a> and <a href="Alan_D._Taylor" title="wikilink">Alan Taylor</a> invoked the Thue–Morse sequence but did not identify it as such. When allocating a contested pile of items between two parties who agree on the items' relative values, Brams and Taylor suggested a method they called <em>balanced alternation</em>, or ''taking turns taking turns taking turns . . . '', as a way to circumvent the favoritism inherent when one party chooses before the other. An example showed how a divorcing couple might reach a fair settlement in the distribution of jointly-owned items. The parties would take turns to be the first chooser at different points in the selection process: Ann chooses one item, then Ben does, then Ben chooses one item, then Ann does.</p>

<p><a href="Lionel_Levine" title="wikilink">Lionel Levine</a> and <a href="Katherine_Stange" title="wikilink">Katherine Stange</a>, in their discussion of how to fairly apportion a shared meal such as an <a href="Culture_of_Ethiopia#Cuisine" title="wikilink">Ethiopian dinner</a>, proposed the Thue–Morse sequence as a way to reduce the advantage of moving first.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> They suggested that “it would be interesting to quantify the intuition that the Thue-Morse order tends to produce a fair outcome.”</p>

<p><a href="Robert_Richman" title="wikilink">Robert Richman</a> addressed this problem, but he too did not identify the Thue–Morse sequence as such at the time of publication.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> He presented the sequences <a href="#Characterization_using_bitwise_negation" title="wikilink"><em>T<sub>n</sub></em></a> as <a href="step_function" title="wikilink">step functions</a> on the interval [0,1] and described their relationship to the <a href="Walsh_function" title="wikilink">Walsh</a> and <a href="Hans_Rademacher" title="wikilink">Rademacher</a> functions. He showed that the <em>n</em><sup>th</sup> <a class="uri" href="derivative" title="wikilink">derivative</a> can be expressed in terms of <em>T<sub>n</sub></em>. As a consequence, the step function arising from <em>T<sub>n</sub></em> is <a href="Orthogonality" title="wikilink">orthogonal</a> to <a href="polynomial" title="wikilink">polynomials</a> of <a href="Degree_of_a_polynomial" title="wikilink">order</a> <em>n</em> − 1. A consequence of this result is that a resource whose value is expressed as a <a href="Monotonic_function" title="wikilink">monotonically</a> decreasing <a href="continuous_function" title="wikilink">continuous function</a> is most fairly allocated using a sequence that converges to Thue-Morse as the function becomes <a href="Flat_function" title="wikilink">flatter</a>. An example showed how to pour cups of <a href="Drip_brew" title="wikilink">coffee</a> of equal strength from a carafe with a <a href="Nonlinear_system" title="wikilink">nonlinear</a> <a class="uri" href="concentration" title="wikilink">concentration</a> <a class="uri" href="gradient" title="wikilink">gradient</a>, prompting a whimsical article in the popular press.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p><a href="Joshua_Cooper_(mathematician)" title="wikilink">Joshua Cooper</a> and <a href="Aaron_Dutle" title="wikilink">Aaron Dutle</a> showed why the Thue-Morse order provides a fair outcome for discrete events.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> They considered the fairest way to stage a <a href="Évariste_Galois" title="wikilink">Galois</a> duel, in which each of the shooters has equally poor shooting skills. Cooper and Dutle postulated that each dueler would demand a chance to fire as soon as the other’s <a href="a_priori_probability" title="wikilink"><em>a priori</em> probability</a> of winning exceeded their own. They proved that, as the duelers’ hitting probability approaches zero, the firing sequence converges to the Thue–Morse sequence. In so doing, they demonstrated that the Thue-Morse order produces a fair outcome not only for sequences <a href="#Characterization_using_bitwise_negation" title="wikilink"><em>T<sub>n</sub></em></a> of length <em>2<sup>n</sup></em>, but for sequences of any length.</p>

<p>Sports competitions form an important class of equitable sequencing problems, because strict alternation often gives an unfair advantage to one team. Richman suggested that the fairest way for “captain A” and “captain B” to choose sides for a <a href="Streetball" title="wikilink">pick-up game of basketball</a> mirrors <em>T</em><sub>3</sub>: captain A has the first, fourth, sixth, and seventh choices, while captain B has the second, third, fifth, and eighth choices.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> <a href="Ignacio_Palacios-Huerta" title="wikilink">Ignacio Palacios-Huerta</a> proposed changing the sequential order to Thue-Morse to improve the <em><a href="ex_post" title="wikilink">ex post</a></em> fairness of various tournament competitions, such as the kicking sequence of a <a href="Penalty_shoot-out_(association_football)#Procedure" title="wikilink">penalty shoot-out</a> in soccer, the rotation of color of pieces in a <a href="Chess_tournament#Rules" title="wikilink">chess match</a>, and the serving order in a <a href="Tennis_score#Scoring_a_tiebreak_game" title="wikilink">tennis tie-break</a>.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a></p>
<h2 id="history">History</h2>

<p>The Thue–Morse sequence was first studied by <a href="Eugène_Prouhet" title="wikilink">Eugène Prouhet</a> in 1851, who applied it to <a href="number_theory" title="wikilink">number theory</a>. However, Prouhet did not mention the sequence explicitly; this was left to <a href="Axel_Thue" title="wikilink">Axel Thue</a> in 1906, who used it to found the study of <a href="combinatorics_on_words" title="wikilink">combinatorics on words</a>. The sequence was only brought to worldwide attention with the work of <a href="Marston_Morse" title="wikilink">Marston Morse</a> in 1921, when he applied it to <a href="differential_geometry" title="wikilink">differential geometry</a>. The sequence has been discovered independently many times, not always by professional research mathematicians; for example, <a href="Max_Euwe" title="wikilink">Max Euwe</a>, a <a href="Grandmaster_(chess)" title="wikilink">chess grandmaster</a>, who held the world championship title from 1935 to 1937, and mathematics <a class="uri" href="teacher" title="wikilink">teacher</a>, discovered it in 1929 in an application to <a class="uri" href="chess" title="wikilink">chess</a>: by using its cube-free property (see above), he showed how to circumvent a rule aimed at preventing infinitely protracted games by declaring repetition of moves a draw.</p>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li>Allouche, J.-P.; Shallit, J. O. <a href="http://www.cs.uwaterloo.ca/~shallit/Papers/ubiq.ps">The Ubiquitous Prouhet-Thue-Morse Sequence</a>. (contains many applications and some history)</li>
<li>Thue–Morse Sequence over (1,2) </li>
<li>Odious numbers </li>
<li>Evil numbers </li>
<li><a href="http://www2.kenyon.edu/people/holdenerj/StudentResearch/WhenThueMorsemeetsKochJan222005.pdf">When Thue-Morse meets Koch</a>. A paper showing an astonishing similarity between the Thue–Morse Sequence and the <a href="Koch_snowflake" title="wikilink">Koch snowflake</a></li>
<li>[<a class="uri" href="http://www.webcitation.org/query?url=http://www.geocities.com/jan.schat/ThueMorse.PDF&amp;date">http://www.webcitation.org/query?url=http://www.geocities.com/jan.schat/ThueMorse.PDF&amp;date;</a>;=2009-10-26+00:40:54 Reducing the influence of DC offset drift in analog IPs using the Thue-Morse Sequence]. A technical application of the Thue–Morse Sequence</li>
<li><a href="http://reglos.de/musinum">MusiNum - The Music in the Numbers</a>. Freeware to generate self-similar music based on the Thue–Morse Sequence and related number sequences.</li>
</ul>

<p>"</p>

<p><a href="Category:Binary_sequences" title="wikilink">Category:Binary sequences</a> <a href="Category:Fixed_points_(mathematics)" title="wikilink">Category:Fixed points (mathematics)</a> <a href="Category:Parity_(mathematics)" title="wikilink">Category:Parity (mathematics)</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Allouche &amp; Shallit (2003) p.15<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">Lothaire (2011) p.11<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5">Lothaire (2011) p.113<a href="#fnref5">↩</a></li>
<li id="fn6">Pytheas Fogg (2002) p.103<a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8">Lothaire (2011) p.30<a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10">Lothaire (2011) p.31<a href="#fnref10">↩</a></li>
<li id="fn11">Berstel (2009) p.70<a href="#fnref11">↩</a></li>
<li id="fn12">Berstel (2009) p.80<a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
</ol>
</section>
</body>
</html>

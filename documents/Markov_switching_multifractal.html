<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="569">Markov switching multifractal</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Markov switching multifractal</h1>
<hr/>

<p>In financial <a class="uri" href="econometrics" title="wikilink">econometrics</a>, the <strong>Markov-switching multifractal (MSM)</strong> is a model of asset returns that incorporates <a href="Stochastic_Volatility" title="wikilink">stochastic volatility</a> components of <a href="Homogeneity_(statistics)" title="wikilink">heterogeneous durations</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> MSM captures the <a href="Outliers_in_statistics" title="wikilink">outliers</a>, log-memory-like <a href="Volatility_(finance)" title="wikilink">volatility</a> persistence and power variation of <a href="financial_return" title="wikilink">financial returns</a>. In currency and equity series, MSM compares favorably with standard <a href="Stochastic_volatility" title="wikilink">volatility models</a> such as <a href="GARCH" title="wikilink">GARCH(1,1)</a> and FIGARCH both in- and out-of-sample. MSM is used by practitioners in the financial industry to forecast <a href="Volatility_(finance)" title="wikilink">volatility</a>, compute <a href="VaR" title="wikilink">value-at-risk</a>, and price <a href="Derivative_(finance)" title="wikilink">derivatives</a>.</p>
<h2 id="msm-specification">MSM specification</h2>

<p>The MSM model can be specified in both discrete time and continuous time.</p>
<h3 id="discrete-time">Discrete time</h3>

<p>Let 

<math display="inline" id="Markov_switching_multifractal:0">
 <semantics>
  <msub>
   <mi>P</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>P</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{t}
  </annotation>
 </semantics>
</math>

 denote the price of a financial asset, and let 

<math display="inline" id="Markov_switching_multifractal:1">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>ln</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>P</mi>
       <mi>t</mi>
      </msub>
      <mo>/</mo>
      <msub>
       <mi>P</mi>
       <mrow>
        <mi>t</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <ln></ln>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>t</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}=\ln(P_{t}/P_{t-1})
  </annotation>
 </semantics>
</math>

 denote the return over two consecutive periods. In MSM, returns are specified as</p>

<p>

<math display="block" id="Markov_switching_multifractal:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>r</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>μ</mi>
     <mo>+</mo>
     <mrow>
      <mover accent="true">
       <mi>σ</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>M</mi>
          <mrow>
           <mn>1</mn>
           <mo>,</mo>
           <mi>t</mi>
          </mrow>
         </msub>
         <msub>
          <mi>M</mi>
          <mrow>
           <mn>2</mn>
           <mo>,</mo>
           <mi>t</mi>
          </mrow>
         </msub>
         <mi mathvariant="normal">…</mi>
         <msub>
          <mi>M</mi>
          <mrow>
           <mover accent="true">
            <mi>k</mi>
            <mo stretchy="false">¯</mo>
           </mover>
           <mo>,</mo>
           <mi>t</mi>
          </mrow>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </msup>
      <msub>
       <mi>ϵ</mi>
       <mi>t</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>μ</ci>
     <apply>
      <times></times>
      <apply>
       <ci>normal-¯</ci>
       <ci>σ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <list>
          <cn type="integer">1</cn>
          <ci>t</ci>
         </list>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <list>
          <cn type="integer">2</cn>
          <ci>t</ci>
         </list>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <list>
          <apply>
           <ci>normal-¯</ci>
           <ci>k</ci>
          </apply>
          <ci>t</ci>
         </list>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϵ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}=\mu+\bar{\sigma}(M_{1,t}M_{2,t}...M_{\bar{k},t})^{1/2}\epsilon_{t},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Markov_switching_multifractal:3">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Markov_switching_multifractal:4">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

 are constants and {

<math display="inline" id="Markov_switching_multifractal:5">
 <semantics>
  <msub>
   <mi>ϵ</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ϵ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon_{t}
  </annotation>
 </semantics>
</math>

} are independent standard Gaussians. Volatility is driven by the first-order latent Markov state vector:</p>

<p>

<math display="block" id="Markov_switching_multifractal:6">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>M</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>M</mi>
       <mrow>
        <mn>1</mn>
        <mo>,</mo>
        <mi>t</mi>
       </mrow>
      </msub>
      <msub>
       <mi>M</mi>
       <mrow>
        <mn>2</mn>
        <mo>,</mo>
        <mi>t</mi>
       </mrow>
      </msub>
      <mi mathvariant="normal">…</mi>
      <msub>
       <mi>M</mi>
       <mrow>
        <mover accent="true">
         <mi>k</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mo>,</mo>
        <mi>t</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∈</mo>
    <msubsup>
     <mi>R</mi>
     <mo>+</mo>
     <mover accent="true">
      <mi>k</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </msubsup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <list>
        <cn type="integer">1</cn>
        <ci>t</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <list>
        <cn type="integer">2</cn>
        <ci>t</ci>
       </list>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <list>
        <apply>
         <ci>normal-¯</ci>
         <ci>k</ci>
        </apply>
        <ci>t</ci>
       </list>
      </apply>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <plus></plus>
      </apply>
      <apply>
       <ci>normal-¯</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{t}=(M_{1,t}M_{2,t}\dots M_{\bar{k},t})\in R_{+}^{\bar{k}}.
  </annotation>
 </semantics>
</math>

</p>

<p>Given the volatility state 

<math display="inline" id="Markov_switching_multifractal:7">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{t}
  </annotation>
 </semantics>
</math>

, the next-period multiplier 

<math display="inline" id="Markov_switching_multifractal:8">
 <semantics>
  <msub>
   <mi>M</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mrow>
     <mi>t</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <list>
     <ci>k</ci>
     <apply>
      <plus></plus>
      <ci>t</ci>
      <cn type="integer">1</cn>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{k,t+1}
  </annotation>
 </semantics>
</math>

 is drawn from a fixed distribution 

<math display="inline" id="Markov_switching_multifractal:9">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 with probability 

<math display="inline" id="Markov_switching_multifractal:10">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{k}
  </annotation>
 </semantics>
</math>

, and is otherwise left unchanged.</p>
<table>
<tbody>
<tr class="odd">
</tr>
<tr class="even">
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>The transition probabilities are specified by</p>

<p>

<math display="block" id="Markov_switching_multifractal:11">
 <semantics>
  <mrow>
   <msub>
    <mi>γ</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msub>
        <mi>γ</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>b</mi>
       <mrow>
        <mi>k</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>γ</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>γ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <apply>
        <minus></minus>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{k}=1-(1-\gamma_{1})^{(b^{k-1})}
  </annotation>
 </semantics>
</math>

.</p>

<p>The sequence 

<math display="inline" id="Markov_switching_multifractal:12">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{k}
  </annotation>
 </semantics>
</math>

 is approximately geometric 

<math display="inline" id="Markov_switching_multifractal:13">
 <semantics>
  <mrow>
   <msub>
    <mi>γ</mi>
    <mi>k</mi>
   </msub>
   <mo>≈</mo>
   <mrow>
    <msub>
     <mi>γ</mi>
     <mn>1</mn>
    </msub>
    <msup>
     <mi>b</mi>
     <mrow>
      <mi>k</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>γ</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>γ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{k}\approx\gamma_{1}b^{k-1}
  </annotation>
 </semantics>
</math>

 at low frequency. The marginal distribution 

<math display="inline" id="Markov_switching_multifractal:14">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 has a unit mean, has a positive support, and is independent of 

<math display="inline" id="Markov_switching_multifractal:15">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

.</p>
<h4 id="binomial-msm">Binomial MSM</h4>

<p>In empirical applications, the distribution 

<math display="inline" id="Markov_switching_multifractal:16">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 is often a discrete distribution that can take the values 

<math display="inline" id="Markov_switching_multifractal:17">
 <semantics>
  <msub>
   <mi>m</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{0}
  </annotation>
 </semantics>
</math>

 or 

<math display="inline" id="Markov_switching_multifractal:18">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mo>-</mo>
   <msub>
    <mi>m</mi>
    <mn>0</mn>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">2</cn>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>m</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2-m_{0}
  </annotation>
 </semantics>
</math>

 with equal probability. The return process 

<math display="inline" id="Markov_switching_multifractal:19">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}
  </annotation>
 </semantics>
</math>

 is then specified by the parameters 

<math display="inline" id="Markov_switching_multifractal:20">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>m</mi>
     <mn>0</mn>
    </msub>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>,</mo>
    <mover accent="true">
     <mi>σ</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mo>,</mo>
    <mi>b</mi>
    <mo>,</mo>
    <msub>
     <mi>γ</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>θ</ci>
    <vector>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <cn type="integer">0</cn>
     </apply>
     <ci>μ</ci>
     <apply>
      <ci>normal-¯</ci>
      <ci>σ</ci>
     </apply>
     <ci>b</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>γ</ci>
      <cn type="integer">1</cn>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta=(m_{0},\mu,\bar{\sigma},b,\gamma_{1})
  </annotation>
 </semantics>
</math>

. Note that the number of parameters is the same for all 

<math display="inline" id="Markov_switching_multifractal:21">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>k</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>></mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <ci>normal-¯</ci>
     <ci>k</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{k}>1
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="continuous-time">Continuous time</h3>

<p>MSM is similarly defined in continuous time. The price process follows the diffusion:</p>

<p>

<math display="block" id="Markov_switching_multifractal:22">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <msub>
       <mi>P</mi>
       <mi>t</mi>
      </msub>
     </mrow>
     <msub>
      <mi>P</mi>
      <mi>t</mi>
     </msub>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>μ</mi>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>σ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>M</mi>
        <mi>t</mi>
       </msub>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <mi>d</mi>
      <msub>
       <mi>W</mi>
       <mi>t</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>μ</ci>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <times></times>
      <ci>σ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>t</ci>
      </apply>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>W</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dP_{t}}{P_{t}}=\mu dt+\sigma(M_{t})\,dW_{t},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Markov_switching_multifractal:23">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>M</mi>
      <mi>t</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mover accent="true">
     <mi>σ</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>M</mi>
        <mrow>
         <mn>1</mn>
         <mo>,</mo>
         <mi>t</mi>
        </mrow>
       </msub>
       <mi mathvariant="normal">…</mi>
       <msub>
        <mi>M</mi>
        <mrow>
         <mover accent="true">
          <mi>k</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mo>,</mo>
         <mi>t</mi>
        </mrow>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>σ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¯</ci>
      <ci>σ</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <list>
         <cn type="integer">1</cn>
         <ci>t</ci>
        </list>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <list>
         <apply>
          <ci>normal-¯</ci>
          <ci>k</ci>
         </apply>
         <ci>t</ci>
        </list>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(M_{t})=\bar{\sigma}(M_{1,t}\dots M_{\bar{k},t})^{1/2}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Markov_switching_multifractal:24">
 <semantics>
  <msub>
   <mi>W</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>W</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{t}
  </annotation>
 </semantics>
</math>

 is a standard Brownian motion, and 

<math display="inline" id="Markov_switching_multifractal:25">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Markov_switching_multifractal:26">
 <semantics>
  <mover accent="true">
   <mi>σ</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>σ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{\sigma}
  </annotation>
 </semantics>
</math>

 are constants. Each component follows the dynamics:</p>
<table>
<tbody>
<tr class="odd">
</tr>
<tr class="even">
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>The intensities vary geometrically with 

<math display="inline" id="Markov_switching_multifractal:27">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Markov_switching_multifractal:28">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>γ</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>γ</mi>
      <mn>1</mn>
     </msub>
     <msup>
      <mi>b</mi>
      <mrow>
       <mi>k</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>γ</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>γ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <apply>
       <minus></minus>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{k}=\gamma_{1}b^{k-1}.
  </annotation>
 </semantics>
</math>

</p>

<p>When the number of components 

<math display="inline" id="Markov_switching_multifractal:29">
 <semantics>
  <mover accent="true">
   <mi>k</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{k}
  </annotation>
 </semantics>
</math>

 goes to infinity, continuous-time MSM converges to a multifractal diffusion, whose sample paths take a continuum of local Hölder exponents on any finite time interval.</p>
<h2 id="inference-and-closed-form-likelihood">Inference and closed-form likelihood</h2>

<p>When 

<math display="inline" id="Markov_switching_multifractal:30">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 has a <a href="discrete_probability_distribution" title="wikilink">discrete distribution</a>, the Markov state vector 

<math display="inline" id="Markov_switching_multifractal:31">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{t}
  </annotation>
 </semantics>
</math>

 takes finitely many values 

<math display="inline" id="Markov_switching_multifractal:32">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>m</mi>
     <mn>1</mn>
    </msup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msup>
     <mi>m</mi>
     <mi>d</mi>
    </msup>
   </mrow>
   <mo>∈</mo>
   <msubsup>
    <mi>R</mi>
    <mo>+</mo>
    <mover accent="true">
     <mi>k</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>d</ci>
     </apply>
    </list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <plus></plus>
     </apply>
     <apply>
      <ci>normal-¯</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m^{1},...,m^{d}\in R_{+}^{\bar{k}}
  </annotation>
 </semantics>
</math>

. For instance, there are 

<math display="inline" id="Markov_switching_multifractal:33">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mo>=</mo>
   <msup>
    <mn>2</mn>
    <mover accent="true">
     <mi>k</mi>
     <mo stretchy="false">¯</mo>
    </mover>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>d</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cn type="integer">2</cn>
     <apply>
      <ci>normal-¯</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d=2^{\bar{k}}
  </annotation>
 </semantics>
</math>

 possible states in binomial MSM. The Markov dynamics are characterized by the transition matrix 

<math display="inline" id="Markov_switching_multifractal:34">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>i</mi>
       <mo>,</mo>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>i</mi>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>j</mi>
      <mo>≤</mo>
      <mi>d</mi>
     </mrow>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <list>
       <ci>i</ci>
       <ci>j</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>i</ci>
      </apply>
      <apply>
       <leq></leq>
       <ci>j</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=(a_{i,j})_{1\leq i,j\leq d}
  </annotation>
 </semantics>
</math>

 with components 

<math display="inline" id="Markov_switching_multifractal:35">
 <semantics>
  <mrow>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>i</mi>
     <mo>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mi>P</mi>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>M</mi>
     <mrow>
      <mi>t</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <msup>
     <mi>m</mi>
     <mi>j</mi>
    </msup>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>M</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msup>
     <mi>m</mi>
     <mi>i</mi>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i,j}=P\left(M_{t+1}=m^{j}|M_{t}=m^{i}\right)
  </annotation>
 </semantics>
</math>

. Conditional on the volatility state, the return 

<math display="inline" id="Markov_switching_multifractal:36">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{t}
  </annotation>
 </semantics>
</math>

 has Gaussian density</p>

<p>

<math display="block" id="Markov_switching_multifractal:37">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>r</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>M</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msup>
     <mi>m</mi>
     <mi>i</mi>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>m</mi>
        <mi>i</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msqrt>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>[</mo>
    <mo>-</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>r</mi>
         <mi>t</mi>
        </msub>
        <mo>-</mo>
        <mi>μ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <mn>2</mn>
      <msup>
       <mi>σ</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>m</mi>
        <mi>i</mi>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>]</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">f</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>t</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <root></root>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>π</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <ci>t</ci>
        </apply>
        <ci>μ</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>m</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(r_{t}|M_{t}=m^{i})=\frac{1}{\sqrt{2\pi\sigma^{2}(m^{i})}}\exp\left[-\frac{(r%
_{t}-\mu)^{2}}{2\sigma^{2}(m^{i})}\right].
  </annotation>
 </semantics>
</math>

</p>
<h3 id="conditional-distribution">Conditional distribution</h3>

<p>We do not directly observe the latent state vector 

<math display="inline" id="Markov_switching_multifractal:38">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{t}
  </annotation>
 </semantics>
</math>

. Given past returns, we can define the conditional probabilities:</p>

<p>

<math display="block" id="Markov_switching_multifractal:39">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Π</mi>
    <mi>t</mi>
    <mi>j</mi>
   </msubsup>
   <mo>≡</mo>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>M</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <msup>
     <mi>m</mi>
     <mi>j</mi>
    </msup>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>r</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>r</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Π</ci>
      <ci>t</ci>
     </apply>
     <ci>j</ci>
    </apply>
    <equivalent></equivalent>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <ci>t</ci>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>m</ci>
      <ci>j</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>t</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pi_{t}^{j}\equiv P(M_{t}=m^{j}|r_{1},...,r_{t}).
  </annotation>
 </semantics>
</math>

</p>

<p>The vector 

<math display="inline" id="Markov_switching_multifractal:40">
 <semantics>
  <mrow>
   <msub>
    <mi mathvariant="normal">Π</mi>
    <mi>t</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msubsup>
     <mi mathvariant="normal">Π</mi>
     <mi>t</mi>
     <mn>1</mn>
    </msubsup>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msubsup>
     <mi mathvariant="normal">Π</mi>
     <mi>t</mi>
     <mi>d</mi>
    </msubsup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Π</ci>
     <ci>t</ci>
    </apply>
    <vector>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Π</ci>
       <ci>t</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Π</ci>
       <ci>t</ci>
      </apply>
      <ci>d</ci>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pi_{t}=(\Pi_{t}^{1},...,\Pi_{t}^{d})
  </annotation>
 </semantics>
</math>

 is computed recursively:</p>

<p>

<math display="block" id="Markov_switching_multifractal:41">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi mathvariant="normal">Π</mi>
     <mi>t</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mi>ω</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>r</mi>
         <mi>t</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>*</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi mathvariant="normal">Π</mi>
         <mrow>
          <mi>t</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mi>A</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mrow>
         <mi>ω</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <msub>
           <mi>r</mi>
           <mi>t</mi>
          </msub>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>*</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi mathvariant="normal">Π</mi>
           <mrow>
            <mi>t</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mi>A</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
      <msup>
       <mtext>𝟏</mtext>
       <mo>′</mo>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>normal-Π</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <ci>ω</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-Π</ci>
        <apply>
         <minus></minus>
         <ci>t</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>A</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <times></times>
        <apply>
         <times></times>
         <ci>ω</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Π</ci>
          <apply>
           <minus></minus>
           <ci>t</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>A</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <mtext>1</mtext>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pi_{t}=\frac{\omega(r_{t})*(\Pi_{t-1}A)}{[\omega(r_{t})*(\Pi_{t-1}A)]\textbf{%
1}^{\prime}}.
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Markov_switching_multifractal:42">
 <semantics>
  <mrow>
   <mtext>𝟏</mtext>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>R</mi>
    <mi>d</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <mtext>1</mtext>
     <vector>
      <cn type="integer">1</cn>
      <ci>normal-…</ci>
      <cn type="integer">1</cn>
     </vector>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>R</ci>
      <ci>d</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textbf{1}=(1,\dots,1)\in R^{d}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Markov_switching_multifractal:43">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>*</mo>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>y</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>d</mi>
     </msub>
     <msub>
      <mi>y</mi>
      <mi>d</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>x</ci>
     <ci>y</ci>
    </apply>
    <vector>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x*y=\left(x_{1}y_{1},\dots,x_{d}y_{d}\right)
  </annotation>
 </semantics>
</math>

 for any 

<math display="inline" id="Markov_switching_multifractal:44">
 <semantics>
  <mrow>
   <mrow>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
   </mrow>
   <mo>∈</mo>
   <msup>
    <mi>R</mi>
    <mi>d</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <list>
     <ci>x</ci>
     <ci>y</ci>
    </list>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>R</ci>
     <ci>d</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x,y\in R^{d}
  </annotation>
 </semantics>
</math>

, and</p>

<p>

<math display="block" id="Markov_switching_multifractal:45">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>r</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>r</mi>
      <mi>t</mi>
     </msub>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>M</mi>
      <mi>t</mi>
     </msub>
     <mo>=</mo>
     <msup>
      <mi>m</mi>
      <mn>1</mn>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>;</mo>
    <mi mathvariant="normal">…</mi>
    <mo>;</mo>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>r</mi>
      <mi>t</mi>
     </msub>
     <mo stretchy="false">|</mo>
     <msub>
      <mi>M</mi>
      <mi>t</mi>
     </msub>
     <mo>=</mo>
     <msup>
      <mi>m</mi>
      <mi>d</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>]</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ω</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>t</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">f</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>t</ci>
      </apply>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>t</ci>
      </apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-;</ci>
     <ci>normal-…</ci>
     <ci>normal-;</ci>
     <csymbol cd="unknown">f</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>t</ci>
      </apply>
      <ci>normal-|</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <ci>t</ci>
      </apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <ci>d</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega(r_{t})=\left[f(r_{t}|M_{t}=m^{1});\dots;f(r_{t}|M_{t}=m^{d})\right].
  </annotation>
 </semantics>
</math>

</p>

<p>The initial vector 

<math display="inline" id="Markov_switching_multifractal:46">
 <semantics>
  <msub>
   <mi mathvariant="normal">Π</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Π</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pi_{0}
  </annotation>
 </semantics>
</math>

 is set equal to the ergodic distribution of 

<math display="inline" id="Markov_switching_multifractal:47">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>t</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{t}
  </annotation>
 </semantics>
</math>

. For binomial MSM, 

<math display="inline" id="Markov_switching_multifractal:48">
 <semantics>
  <mrow>
   <msubsup>
    <mi mathvariant="normal">Π</mi>
    <mn>0</mn>
    <mi>j</mi>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>d</mi>
   </mrow>
   <mo>=</mo>
   <msup>
    <mn>2</mn>
    <mrow>
     <mo>-</mo>
     <mover accent="true">
      <mi>k</mi>
      <mo stretchy="false">¯</mo>
     </mover>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Π</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>j</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>d</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <apply>
       <minus></minus>
       <apply>
        <ci>normal-¯</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pi_{0}^{j}=1/d=2^{-\bar{k}}
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Markov_switching_multifractal:49">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="closed-form-likelihood">Closed-form Likelihood</h3>

<p>The log likelihood function has the following analytical expression:</p>

<p>

<math display="block" id="Markov_switching_multifractal:50">
 <semantics>
  <mrow>
   <mi>ln</mi>
   <mi>L</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>r</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>r</mi>
     <mi>T</mi>
    </msub>
    <mo>;</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <munderover>
    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
    <mrow>
     <mi>t</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>T</mi>
   </munderover>
   <mi>ln</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>ω</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>r</mi>
      <mi>t</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>.</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi mathvariant="normal">Π</mi>
      <mrow>
       <mi>t</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ln></ln>
    <csymbol cd="unknown">L</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-,</ci>
     <ci>normal-…</ci>
     <ci>normal-,</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>r</ci>
      <ci>T</ci>
     </apply>
     <ci>normal-;</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>t</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>T</ci>
    </apply>
    <ln></ln>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">ω</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>t</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-.</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-Π</ci>
       <apply>
        <minus></minus>
        <ci>t</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <csymbol cd="unknown">A</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ln L(r_{1},\dots,r_{T};\theta)=\sum_{t=1}^{T}\ln[\omega(r_{t}).(\Pi_{t-1}A)].
  </annotation>
 </semantics>
</math>

</p>

<p><a href="Maximum_likelihood_estimation" title="wikilink">Maximum likelihood</a> provides reasonably precise estimates in finite samples.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="other-estimation-methods">Other estimation methods</h3>

<p>When 

<math display="inline" id="Markov_switching_multifractal:51">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 has a <a href="continuous_probability_distribution" title="wikilink">continuous distribution</a>, estimation can proceed by simulated method of moments,<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> or simulated likelihood via a particle filter.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="forecasting">Forecasting</h2>

<p>Given 

<math display="inline" id="Markov_switching_multifractal:52">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mn>1</mn>
   </msub>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
   <mo>,</mo>
   <msub>
    <mi>r</mi>
    <mi>t</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>t</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{1},\dots,r_{t}
  </annotation>
 </semantics>
</math>

, the conditional distribution of the latent state vector at date 

<math display="inline" id="Markov_switching_multifractal:53">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>+</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>t</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t+n
  </annotation>
 </semantics>
</math>

 is given by:</p>

<p>

<math display="block" id="Markov_switching_multifractal:54">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi mathvariant="normal">Π</mi>
      <mo stretchy="false">^</mo>
     </mover>
     <mrow>
      <mi>t</mi>
      <mo>,</mo>
      <mi>n</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi mathvariant="normal">Π</mi>
      <mi>t</mi>
     </msub>
     <msup>
      <mi>A</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-^</ci>
      <ci>normal-Π</ci>
     </apply>
     <list>
      <ci>t</ci>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Π</ci>
      <ci>t</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\Pi}_{t,n}=\Pi_{t}A^{n}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>MSM often provides better volatility forecasts than some of the best traditional models both in and out of sample. Calvet and Fisher<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> report considerable gains in exchange rate volatility forecasts at horizons of 10 to 50 days as compared with GARCH(1,1), Markov-Switching GARCH,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> and Fractionally Integrated GARCH.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> Lux<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> obtains similar results using linear predictions.</p>
<h2 id="applications">Applications</h2>
<h3 id="multiple-assets-and-value-at-risk">Multiple assets and value-at-risk</h3>

<p>Extensions of MSM to multiple assets provide reliable estimates of the value-at-risk in a portfolio of securities.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h3 id="asset-pricing">Asset pricing</h3>

<p>In financial economics, MSM has been used to analyze the pricing implications of multifrequency risk. The models have had some success in explaining the excess volatility of stock returns compared to fundamentals and the negative skewness of equity returns. They have also been used to generate multifractal jump-diffusions.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h2 id="related-approaches">Related approaches</h2>

<p>MSM is a stochastic volatility model<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> with arbitrarily many frequencies. MSM builds on the convenience of regime-switching models, which were advanced in economics and finance by <a href="James_D._Hamilton" title="wikilink">James D. Hamilton</a>.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a><a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> MSM is closely related to the <a href="Multifractal_Model_of_Asset_Returns" title="wikilink">Multifractal Model of Asset Returns</a>.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a> MSM improves on the MMAR’s combinatorial construction by randomizing arrival times, guaranteeing a strictly stationary process. MSM provides a pure regime-switching formulation of multifractal measures, which were pioneered by <a href="Benoît_Mandelbrot" title="wikilink">Benoit Mandelbrot</a>.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a><a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a><a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Brownian_motion" title="wikilink">Brownian motion</a></li>
<li><a href="Markov_chain" title="wikilink">Markov chain</a></li>
<li><a href="Multifractal_model_of_asset_returns" title="wikilink">Multifractal model of asset returns</a></li>
<li><a class="uri" href="Multifractal" title="wikilink">Multifractal</a></li>
<li><a href="Stochastic_volatility" title="wikilink">Stochastic volatility</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://wiki.wstein.org/2008/simuw">Financial Time Series, Multifractals and Hidden Markov Models</a></li>
</ul>

<p>"</p>

<p><a href="Category:Mathematical_finance" title="wikilink">Category:Mathematical finance</a> <a href="Category:Markov_models" title="wikilink">Category:Markov models</a> <a class="uri" href="Category:Fractals" title="wikilink">Category:Fractals</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
</ol>
</section>
</body>
</html>

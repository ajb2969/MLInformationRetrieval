   Large eddy simulation      Large eddy simulation   (Figure)  Large eddy simulation of a turbulent gas velocity field.   Large eddy simulation (LES) is a mathematical model for turbulence used in computational fluid dynamics . It was initially proposed in 1963 by Joseph Smagorinsky to simulate atmospheric air currents, 1 and many of the issues unique to LES were first explored by Deardorff (1970). 2 LES grew rapidly beginning with its invention in the 1960s and is currently applied in a wide variety of engineering applications, including combustion, 3 acoustics, 4 and simulations of the atmospheric boundary layer. 5 LES operates on the Navierâ€“Stokes equations to reduce the range of length scales of the solution, reducing the computational cost.  The principal operation in large eddy simulation is low-pass filtering . This operation is applied to the Navierâ€“Stokes equations to eliminate small scales of the solution. This reduces the computational cost of the simulation. The governing equations are thus transformed, and the solution is a filtered velocity field. Which of the "small" length and time scales to eliminate are selected according to turbulence theory and available computational resources. 6  Large eddy simulation resolves large scales of the flow field solution allowing better fidelity than alternative approaches such as Reynolds-averaged Navierâ€“Stokes (RANS) methods. It also models the smallest (and most expensive 7 ) scales of the solution, rather than resolving them as direct numerical simulation (DNS) does. This makes the computational cost for practical engineering systems with complex geometry or flow configurations, such as turbulent jets, pumps, vehicles, and landing gear, attainable using supercomputers . In contrast, direct numerical simulation , which resolves every scale of the solution, is prohibitively expensive for nearly all systems with complex geometry or flow configurations.  Filter definition and properties  An LES filter can be applied to a spatial and temporal field    Ï•   (  ğ’™  ,  t  )       Ï•   ğ’™  t     \phi(\boldsymbol{x},t)   and perform a spatial filtering operation, a temporal filtering operation, or both. The filtered field, denoted with a bar, is defined as: 8 9        Ï•   (  ğ’™  ,  t  )    Â¯   =    âˆ«   -  âˆ   âˆ     âˆ«   -  âˆ   âˆ    Ï•   (  ğ’“  ,   t  â€²   )   G   (   ğ’™  -  ğ’“   ,   t  -   t  â€²    )   d   t  â€²   d  ğ’“          normal-Â¯    Ï•   ğ’™  t       superscript   subscript            superscript   subscript            Ï•   ğ’“   superscript  t  normal-â€²    G     ğ’™  ğ’“     t   superscript  t  normal-â€²     d   superscript  t  normal-â€²   d  ğ’“       \overline{\phi(\boldsymbol{x},t)}=\displaystyle{\int_{-\infty}^{\infty}}\int_{%
 -\infty}^{\infty}\phi(\boldsymbol{r},t^{\prime})G(\boldsymbol{x}-\boldsymbol{r%
 },t-t^{\prime})dt^{\prime}d\boldsymbol{r}     where   G   G   G   is the filter convolution kernel. This can also be written as:        Ï•  Â¯   =   G  â‹†  Ï•    .       normal-Â¯  Ï•    normal-â‹†  G  Ï•     \overline{\phi}=G\star\phi.     The filter kernel   G   G   G   has an associated cutoff length scale   Î”   normal-Î”   \Delta   and cutoff time scale    Ï„  c     subscript  Ï„  c    \tau_{c}   . Scales smaller than these are eliminated from    Ï•  Â¯     normal-Â¯  Ï•    \overline{\phi}   . Using the above filter definition, any field   Ï•   Ï•   \phi   may be split up into a filtered and sub-filtered (denoted with a prime) portion, as       Ï•  =    Ï•  Â¯   +   Ï•  â€²     .      Ï•     normal-Â¯  Ï•    superscript  Ï•  normal-â€²      \phi=\bar{\phi}+\phi^{\prime}.     It is important to note that the large eddy simulation filtering operation does not satisfy the properties of a Reynolds operator .  Filtered governing equations  The governing equations of LES are obtained by filtering the partial differential equations governing the flow field    Ï  ğ’–   (  ğ’™  ,  t  )       Ï  ğ’–   ğ’™  t     \rho\boldsymbol{u}(\boldsymbol{x},t)   . There are differences between the incompressible and compressible LES governing equations, which lead to the definition of a new filtering operation.  Incompressible flow  For incompressible flow, the continuity equation and Navierâ€“Stokes equations are filtered, yielding the filtered incompressible continuity equation,        âˆ‚    u  i   Â¯     âˆ‚   x  i     =  0           normal-Â¯   subscript  u  i        subscript  x  i     0    \frac{\partial\bar{u_{i}}}{\partial x_{i}}=0     and the filtered Navierâ€“Stokes equations,          âˆ‚    u  i   Â¯     âˆ‚  t    +    âˆ‚   âˆ‚   x  j      (     u  i    u  j    Â¯   )     =    -    1  Ï     âˆ‚   p  Â¯     âˆ‚   x  i       +   Î½   âˆ‚   âˆ‚   x  j      (     âˆ‚    u  i   Â¯     âˆ‚   x  j     +    âˆ‚    u  j   Â¯     âˆ‚   x  i      )     =    -    1  Ï     âˆ‚   p  Â¯     âˆ‚   x  i       +   2  Î½   âˆ‚   âˆ‚   x  j      S   i  j       ,               normal-Â¯   subscript  u  i       t            subscript  x  j      normal-Â¯     subscript  u  i    subscript  u  j               1  Ï        normal-Â¯  p       subscript  x  i         Î½        subscript  x  j            normal-Â¯   subscript  u  i        subscript  x  j          normal-Â¯   subscript  u  j        subscript  x  i                     1  Ï        normal-Â¯  p       subscript  x  i         2  Î½        subscript  x  j      subscript  S    i  j         \frac{\partial\bar{u_{i}}}{\partial t}+\frac{\partial}{\partial x_{j}}\left(%
 \overline{u_{i}u_{j}}\right)=-\frac{1}{\rho}\frac{\partial\overline{p}}{%
 \partial x_{i}}+\nu\frac{\partial}{\partial x_{j}}\left(\frac{\partial\bar{u_{%
 i}}}{\partial x_{j}}+\frac{\partial\bar{u_{j}}}{\partial x_{i}}\right)=-\frac{%
 1}{\rho}\frac{\partial\overline{p}}{\partial x_{i}}+2\nu\frac{\partial}{%
 \partial x_{j}}S_{ij},     where    p  Â¯     normal-Â¯  p    \bar{p}   is the filtered pressure field and    S   i  j      subscript  S    i  j     S_{ij}   is the rate-of-strain tensor. The nonlinear filtered advection term      u  i    u  j    Â¯     normal-Â¯     subscript  u  i    subscript  u  j      \overline{u_{i}u_{j}}   is the chief cause of difficulty in LES modeling. It requires knowledge of the unfiltered velocity field, which is unknown, so it must be modeled. The analysis that follows illustrates the difficulty caused by the nonlinearity, namely, that it causes interaction between large and small scales, preventing separation of scales.  The filtered advection term can be split up, following Leonard (1974), 10 as:         u  i    u  j    Â¯   =    Ï„   i  j   r   +     u  Â¯   i     u  Â¯   j          normal-Â¯     subscript  u  i    subscript  u  j        superscript   subscript  Ï„    i  j    r      subscript   normal-Â¯  u   i    subscript   normal-Â¯  u   j       \overline{u_{i}u_{j}}=\tau_{ij}^{r}+\overline{u}_{i}\overline{u}_{j}     where    Ï„   i  j   r     superscript   subscript  Ï„    i  j    r    \tau_{ij}^{r}   is the residual stress tensor, so that the filtered Navier Stokes equations become         âˆ‚    u  i   Â¯     âˆ‚  t    +    âˆ‚   âˆ‚   x  j      (     u  Â¯   i     u  Â¯   j    )     =     -    1  Ï     âˆ‚   p  Â¯     âˆ‚   x  i       +   2  Î½   âˆ‚   âˆ‚   x  j       S  Â¯    i  j      -    âˆ‚   Ï„   i  j   r     âˆ‚   x  j                 normal-Â¯   subscript  u  i       t            subscript  x  j        subscript   normal-Â¯  u   i    subscript   normal-Â¯  u   j                1  Ï        normal-Â¯  p       subscript  x  i         2  Î½        subscript  x  j      subscript   normal-Â¯  S     i  j           superscript   subscript  Ï„    i  j    r       subscript  x  j        \frac{\partial\bar{u_{i}}}{\partial t}+\frac{\partial}{\partial x_{j}}\left(%
 \overline{u}_{i}\overline{u}_{j}\right)=-\frac{1}{\rho}\frac{\partial\overline%
 {p}}{\partial x_{i}}+2\nu\frac{\partial}{\partial x_{j}}\bar{S}_{ij}-\frac{%
 \partial\tau_{ij}^{r}}{\partial x_{j}}     with the residual stress tensor    Ï„   i  j   r     superscript   subscript  Ï„    i  j    r    \tau_{ij}^{r}   grouping all unclosed terms. Leonard decomposed this stress tensor as     Ï„   i  j   r   =    L   i  j    +   C   i  j    +   R   i  j          superscript   subscript  Ï„    i  j    r      subscript  L    i  j     subscript  C    i  j     subscript  R    i  j       \tau_{ij}^{r}=L_{ij}+C_{ij}+R_{ij}   and provided physical interpretations for each term.    L   i  j      subscript  L    i  j     L_{ij}   , the Leonard tensor, represents interactions among large scales,    R   i  j      subscript  R    i  j     R_{ij}   , the Reynolds stress-like term, represents interactions among the sub-filter scales (SFS), and    C   i  j      subscript  C    i  j     C_{ij}   , the Clark tensor, 11 represents cross-scale interactions between large and small scales. 12 Modeling the unclosed term    Ï„   i  j   r     superscript   subscript  Ï„    i  j    r    \tau_{ij}^{r}   is the task of SFS models (also referred to as sub-grid scale, or SGS, models). This is made challenging by the fact that the sub-filter scale stress tensor    Ï„   i  j   r     superscript   subscript  Ï„    i  j    r    \tau_{ij}^{r}   must account for interactions among all scales, including filtered scales with unfiltered scales.  The filtered governing equation for a passive scalar   Ï•   Ï•   \phi   , such as mixture fraction or temperature, can be written as         âˆ‚   Ï•  Â¯     âˆ‚  t    +    âˆ‚   âˆ‚   x  j      (     u  Â¯   j    Ï•  Â¯    )     =     âˆ‚    J  Ï•   Â¯     âˆ‚   x  j     +    âˆ‚   q   i  j      âˆ‚   x  j                 normal-Â¯  Ï•      t            subscript  x  j        subscript   normal-Â¯  u   j    normal-Â¯  Ï•             normal-Â¯   subscript  J  Ï•        subscript  x  j          subscript  q    i  j        subscript  x  j        \frac{\partial\overline{\phi}}{\partial t}+\frac{\partial}{\partial x_{j}}%
 \left(\overline{u}_{j}\overline{\phi}\right)=\frac{\partial\overline{J_{\phi}}%
 }{\partial x_{j}}+\frac{\partial q_{ij}}{\partial x_{j}}     where    J  Ï•     subscript  J  Ï•    J_{\phi}   is the diffusive flux of   Ï•   Ï•   \phi   , and    q   i  j      subscript  q    i  j     q_{ij}   is the sub-filter stress tensor for the scalar   Ï•   Ï•   \phi   . The filtered diffusive flux     J  Ï•   Â¯     normal-Â¯   subscript  J  Ï•     \overline{J_{\phi}}   is unclosed, unless a particular form is assumed for it (e.g. a gradient diffusion model     J  Ï•   =    D  Ï•     âˆ‚  Ï•    âˆ‚   x  i           subscript  J  Ï•      subscript  D  Ï•       Ï•      subscript  x  i        J_{\phi}=D_{\phi}\frac{\partial\phi}{\partial x_{i}}   ).    q   i  j      subscript  q    i  j     q_{ij}   is defined analogously to    Ï„   i  j   r     superscript   subscript  Ï„    i  j    r    \tau_{ij}^{r}   ,       q   i  j    =     Ï•  Â¯     u  Â¯   j    -    Ï•   u  j    Â¯         subscript  q    i  j         normal-Â¯  Ï•    subscript   normal-Â¯  u   j     normal-Â¯    Ï•   subscript  u  j        q_{ij}=\bar{\phi}\overline{u}_{j}-\overline{\phi u_{j}}     and can similarly be split up into contributions from interactions between various scales. This sub-filter tensor also requires a sub-filter model.  Compressible governing equations  For the governing equations of compressible flow, each equation, starting with the conservation of mass, is filtered. This gives:         âˆ‚   Ï  Â¯     âˆ‚  t    +    âˆ‚     u  i   Ï   Â¯     âˆ‚   x  i      =  0             normal-Â¯  Ï      t         normal-Â¯     subscript  u  i   Ï        subscript  x  i      0    \frac{\partial\overline{\rho}}{\partial t}+\frac{\partial\overline{u_{i}\rho}}%
 {\partial x_{i}}=0     which results in an additional sub-filter term. However, it is desirable to avoid having to model the sub-filter scales of the mass conservation equation. For this reason, Favre 13 proposed a density-weighted filtering operation, called Favre filtering, defined for an arbitrary quantity   Ï•   Ï•   \phi   as:       Ï•  ~   =     Ï  Ï•   Â¯    Ï  Â¯         normal-~  Ï•      normal-Â¯    Ï  Ï•     normal-Â¯  Ï      \tilde{\phi}=\frac{\overline{\rho\phi}}{\overline{\rho}}     which, in the limit of incompressibility, becomes the normal filtering operation. This makes the conservation of mass equation:         âˆ‚   Ï  Â¯     âˆ‚  t    +    âˆ‚    Ï  Â¯     u  i   ~      âˆ‚   x  i      =  0.             normal-Â¯  Ï      t           normal-Â¯  Ï    normal-~   subscript  u  i         subscript  x  i      0.    \frac{\partial\overline{\rho}}{\partial t}+\frac{\partial\overline{\rho}\tilde%
 {u_{i}}}{\partial x_{i}}=0.     This concept can then be extended to write the Favre-filtered momentum equation for compressible flow. Following Vreman: 14          âˆ‚    Ï  Â¯     u  i   ~      âˆ‚  t    +    âˆ‚    Ï  Â¯     u  i   ~     u  j   ~      âˆ‚   x  j     +    âˆ‚   p  Â¯     âˆ‚   x  i      -    âˆ‚    Ïƒ   i  j    Â¯     âˆ‚   x  j      =    -    âˆ‚    Ï  Â¯    Ï„   i  j   r      âˆ‚   x  j      +    âˆ‚   âˆ‚   x  j      (     Ïƒ  Â¯    i  j    -    Ïƒ  ~    i  j     )                    normal-Â¯  Ï    normal-~   subscript  u  i        t           normal-Â¯  Ï    normal-~   subscript  u  i     normal-~   subscript  u  j         subscript  x  j          normal-Â¯  p       subscript  x  i           normal-Â¯   subscript  Ïƒ    i  j         subscript  x  j                 normal-Â¯  Ï    superscript   subscript  Ï„    i  j    r        subscript  x  j              subscript  x  j        subscript   normal-Â¯  Ïƒ     i  j     subscript   normal-~  Ïƒ     i  j         \frac{\partial\overline{\rho}\tilde{u_{i}}}{\partial t}+\frac{\partial%
 \overline{\rho}\tilde{u_{i}}\tilde{u_{j}}}{\partial x_{j}}+\frac{\partial%
 \overline{p}}{\partial x_{i}}-\frac{\partial\overline{\sigma_{ij}}}{\partial x%
 _{j}}=-\frac{\partial\overline{\rho}\tau_{ij}^{r}}{\partial x_{j}}+\frac{%
 \partial}{\partial x_{j}}\left(\overline{\sigma}_{ij}-\tilde{\sigma}_{ij}\right)     where    Ïƒ   i  j      subscript  Ïƒ    i  j     \sigma_{ij}   is the shear stress tensor, given for a Newtonian fluid by:       Ïƒ   i  j    =    2  Î¼   (  T  )    S   i  j     -    2  3   Î¼   (  T  )    Î´   i  j     S   k  k           subscript  Ïƒ    i  j        2  Î¼  T   subscript  S    i  j         2  3   Î¼  T   subscript  Î´    i  j     subscript  S    k  k        \sigma_{ij}=2\mu(T)S_{ij}-\frac{2}{3}\mu(T)\delta_{ij}S_{kk}     and the term     âˆ‚   âˆ‚   x  j      (     Ïƒ  Â¯    i  j    -    Ïƒ  ~    i  j     )             subscript  x  j        subscript   normal-Â¯  Ïƒ     i  j     subscript   normal-~  Ïƒ     i  j       \frac{\partial}{\partial x_{j}}\left(\overline{\sigma}_{ij}-\tilde{\sigma}_{ij%
 }\right)   represents a sub-filter viscous contribution from evaluating the viscosity    Î¼   (  T  )       Î¼  T    \mu(T)   using the Favre-filtered temperature    T  ~     normal-~  T    \tilde{T}   . The subgrid stress tensor for the Favre-filtered momentum field is given by       Ï„   i  j   r   =      u  i   â‹…   u  j    ~   -     u  i   ~     u  j   ~          superscript   subscript  Ï„    i  j    r      normal-~   normal-â‹…   subscript  u  i    subscript  u  j        normal-~   subscript  u  i     normal-~   subscript  u  j        \tau_{ij}^{r}=\widetilde{u_{i}\cdot u_{j}}-\tilde{u_{i}}\tilde{u_{j}}     By analogy, the Leonard decomposition may also be written for the residual stress tensor for a filtered triple product     Ï  Ï•  Ïˆ   Â¯     normal-Â¯    Ï  Ï•  Ïˆ     \overline{\rho\phi\psi}   . The triple product can be rewritten using the Favre filtering operator as     Ï  Â¯     Ï•  Ïˆ   ~        normal-Â¯  Ï    normal-~    Ï•  Ïˆ      \overline{\rho}\widetilde{\phi\psi}   , which is an unclosed term (it requires knowledge of the fields   Ï•   Ï•   \phi   and   Ïˆ   Ïˆ   \psi   , when only the fields    Ï•  ~     normal-~  Ï•    \tilde{\phi}   and    Ïˆ  ~     normal-~  Ïˆ    \tilde{\psi}   are known). It can be broken up in a manner analogous to      u  i    u  j    Â¯     normal-Â¯     subscript  u  i    subscript  u  j      \overline{u_{i}u_{j}}   above, which results in a sub-filter stress tensor     Ï  Â¯    (     Ï•  Ïˆ   ~   -    Ï•  ~    Ïˆ  ~     )        normal-Â¯  Ï      normal-~    Ï•  Ïˆ       normal-~  Ï•    normal-~  Ïˆ       \overline{\rho}\left(\widetilde{\phi\psi}-\tilde{\phi}\tilde{\psi}\right)   . This sub-filter term can be split up into contributions from three types of interactions: the Leondard tensor    L   i  j      subscript  L    i  j     L_{ij}   , representing interactions among resolved scales; the Clark tensor    C   i  j      subscript  C    i  j     C_{ij}   , representing interactions between resolved and unresolved scales; and the Reynolds tensor    R   i  j      subscript  R    i  j     R_{ij}   , which represents interactions among unresolved scales. 15  Filtered kinetic energy equation  In addition to the filtered mass and momentum equations, filtering the kinetic energy equation can provide additional insight. The kinetic energy field can be filtered to yield the total filtered kinetic energy:       E  Â¯   =    1  2      u  i    u  i    Â¯         normal-Â¯  E       1  2    normal-Â¯     subscript  u  i    subscript  u  i        \overline{E}=\frac{1}{2}\overline{u_{i}u_{i}}     and the total filtered kinetic energy can be decomposed into two terms: the kinetic energy of the filtered velocity field    E  f     subscript  E  f    E_{f}   ,       E  f   =    1  2      u  i   Â¯      u  i   Â¯         subscript  E  f       1  2    normal-Â¯   subscript  u  i     normal-Â¯   subscript  u  i       E_{f}=\frac{1}{2}\overline{u_{i}}\,\overline{u_{i}}     and the residual kinetic energy    k  r     subscript  k  r    k_{r}   ,       k  r   =     1  2      u  i    u  i    Â¯    -    1  2      u  i   Â¯      u  i   Â¯     =    1  2    Ï„   i  i   r           subscript  k  r         1  2    normal-Â¯     subscript  u  i    subscript  u  i          1  2    normal-Â¯   subscript  u  i     normal-Â¯   subscript  u  i               1  2    superscript   subscript  Ï„    i  i    r       k_{r}=\frac{1}{2}\overline{u_{i}u_{i}}-\frac{1}{2}\overline{u_{i}}\,\overline{%
 u_{i}}=\frac{1}{2}\tau_{ii}^{r}     such that     E  Â¯   =    E  f   +   k  r         normal-Â¯  E      subscript  E  f    subscript  k  r      \overline{E}=E_{f}+k_{r}   .  The conservation equation for    E  f     subscript  E  f    E_{f}   can be obtained by multiplying the filtered momentum transport equation by     u  i   Â¯     normal-Â¯   subscript  u  i     \overline{u_{i}}   to yield:          âˆ‚   E  f     âˆ‚  t    +     u  j   Â¯     âˆ‚   E  f     âˆ‚   x  j      +    1  Ï     âˆ‚     u  i   Â¯    p  Â¯      âˆ‚   x  i      +    âˆ‚     u  i   Â¯    Ï„   i  j   r      âˆ‚   x  j      -   2  Î½    âˆ‚     u  i   Â¯     S   i  j    Â¯      âˆ‚   x  j       =    -   Ïµ  f    -  Î                 subscript  E  f      t       normal-Â¯   subscript  u  j         subscript  E  f       subscript  x  j          1  Ï          normal-Â¯   subscript  u  i     normal-Â¯  p        subscript  x  i             normal-Â¯   subscript  u  i     superscript   subscript  Ï„    i  j    r        subscript  x  j        2  Î½         normal-Â¯   subscript  u  i     normal-Â¯   subscript  S    i  j          subscript  x  j            subscript  Ïµ  f    normal-Î      \frac{\partial E_{f}}{\partial t}+\overline{u_{j}}\frac{\partial E_{f}}{%
 \partial x_{j}}+\frac{1}{\rho}\frac{\partial\overline{u_{i}}\bar{p}}{\partial x%
 _{i}}+\frac{\partial\overline{u_{i}}\tau_{ij}^{r}}{\partial x_{j}}-2\nu\frac{%
 \partial\overline{u_{i}}\bar{S_{ij}}}{\partial x_{j}}=-\epsilon_{f}-\Pi     where     Ïµ  f   =   2  Î½    S   i  j    Â¯     S   i  j    Â¯         subscript  Ïµ  f     2  Î½   normal-Â¯   subscript  S    i  j      normal-Â¯   subscript  S    i  j        \epsilon_{f}=2\nu\bar{S_{ij}}\bar{S_{ij}}   is the dissipation of kinetic energy of the filtered velocity field by viscous stress, and    Î   =   -    Ï„   i  j   r     S   i  j    Â¯         normal-Î        superscript   subscript  Ï„    i  j    r    normal-Â¯   subscript  S    i  j         \Pi=-\tau_{ij}^{r}\bar{S_{ij}}   represents the sub-filter scale (SFS) dissipation of kinetic energy.  The terms on the left-hand side represent transport, and the terms on the right-hand side are sink terms that dissipate kinetic energy. 16  The   Î    normal-Î    \Pi   SFS dissipation term is of particular interest, since it represents the transfer of energy from large resolved scales to small unresolved scales. On average,   Î    normal-Î    \Pi   transfers energy from large to small scales. However, instantaneously   Î    normal-Î    \Pi   can be positive or negative, meaning it can also act as a source term for    E  f     subscript  E  f    E_{f}   , the kinetic energy of the filtered velocity field. The transfer of energy from unresolved to resolved scales is called backscatter (and likewise the transfer of energy from resolved to unresolved scales is called forward-scatter ). 17  Numerical methods for LES  Large eddy simulation involves the solution to the discrete filtered governing equations using computational fluid dynamics . LES resolves scales from the domain size   L   L   L   down to the filter size   Î”   normal-Î”   \Delta   , and as such a substantial portion of high wave number turbulent fluctuations must be resolved. This requires either high-order numerical schemes , or fine grid resolution if low-order numerical schemes are used. Chapter 13 of Pope 18 addresses the question of how fine a grid resolution    Î”  x      normal-Î”  x    \Delta x   is needed to resolve a filtered velocity field     u  Â¯    (  ğ’™  )        normal-Â¯  u   ğ’™    \overline{u}(\boldsymbol{x})   . Ghosal 19 found that for low-order discretization schemes, such as those used in finite volume methods, the truncation error can be the same order as the subfilter scale contributions, unless the filter width   Î”   normal-Î”   \Delta   is considerably larger than the grid spacing    Î”  x      normal-Î”  x    \Delta x   . While even-order schemes have truncation error, they are non-dissipative, 20 and because subfilter scale models are dissipative, even-order schemes will not affect the subfilter scale model contributions as strongly as dissipative schemes.  Filter implementation  The filtering operation in large eddy simulation can be implicit or explicit. Implicit filtering recognizes that the subfilter scale model will dissipate in the same manner as many numerical schemes. In this way, the grid, or the numerical discretization scheme, can be assumed to be the LES low-pass filter. While this takes full advantage of the grid resolution, and eliminates the computational cost of calculating a subfilter scale model term, it is difficult to determine the shape of the LES filter that is associated with some numerical issues. Additionally, truncation error can also become an issue. 21  In explicit filtering, an LES filter is applied to the discretized Navierâ€“Stokes equations, providing a well-defined filter shape and reducing the truncation error. However, explicit filtering requires a finer grid than implicit filtering, and the computational cost increases with     (   Î”  x   )   4     superscript    normal-Î”  x   4    (\Delta x)^{4}   . Chapter 8 of Sagaut (2006) covers LES numerics in greater detail. 22  Modeling unresolved scales  To discuss the modeling of unresolved scales, first the unresolved scales must be classified. They fall into two groups: resolved sub-filter scales (SFS), and sub-grid scales (SGS).  The resolved sub-filter scales represent the scales with wave numbers larger than the cutoff wave number    k  c     subscript  k  c    k_{c}   , but whose effects are dampened by the filter. Resolved sub-filter scales only exist when filters non-local in wave-space are used (such as a box or Gaussian filter). These resolved sub-filter scales must be modeled using filter reconstruction.  Sub-grid scales are any scales that are smaller than the cutoff filter width   Î”   normal-Î”   \Delta   . The form of the SGS model depends on the filter implementation. As mentioned in the Numerical methods for LES section, if implicit LES is considered, no SGS model is implemented and the numerical effects of the discretization are assumed to mimic the physics of the unresolved turbulent motions.  Sub-grid scale models  Without a universally valid description of turbulence, empirical information must be utilized when constructing and applying SGS models, supplemented with fundamental physical constraints such as Galilean invariance 23 . 24 Two classes of SGS models exist; the first class is functional models and the second class is structural models . Some models may be categorized as both.  Functional (eddyâ€“viscosity) models  Functional models are simpler than structural models, focusing only on dissipating energy at a rate that is physically correct. These are based on an artificial eddy viscosity approach, where the effects of turbulence are lumped into a turbulent viscosity. The approach treats dissipation of kinetic energy at sub-grid scales as analogous to molecular diffusion. In this case, the deviatoric part of    Ï„   i  j      subscript  Ï„    i  j     \tau_{ij}   is modeled as:        Ï„   i  j   r   -    1  3    Ï„   i  j     Î´   i  j      =   -   2   Î½  t     S  Â¯    i  j             superscript   subscript  Ï„    i  j    r       1  3    subscript  Ï„    i  j     subscript  Î´    i  j          2   subscript  Î½  normal-t    subscript   normal-Â¯  S     i  j        \tau_{ij}^{r}-\frac{1}{3}\tau_{ij}\delta_{ij}=-2\nu_{\mathrm{t}}\bar{S}_{ij}     where    Î½  t     subscript  Î½  normal-t    \nu_{\mathrm{t}}   is the turbulent eddy viscosity and      S  Â¯    i  j    =    1  2    (     âˆ‚    u  Â¯   i     âˆ‚   x  j     +    âˆ‚    u  Â¯   j     âˆ‚   x  i      )         subscript   normal-Â¯  S     i  j        1  2          subscript   normal-Â¯  u   i       subscript  x  j          subscript   normal-Â¯  u   j       subscript  x  i         \bar{S}_{ij}=\frac{1}{2}\left(\frac{\partial\bar{u}_{i}}{\partial x_{j}}+\frac%
 {\partial\bar{u}_{j}}{\partial x_{i}}\right)   is the rate-of-strain tensor.  Based on dimensional analysis, the eddy viscosity must have units of     [   Î½  t   ]   =    m  2   s        delimited-[]   subscript  Î½  normal-t       superscript  normal-m  2   normal-s     \left[\nu_{\mathrm{t}}\right]=\frac{\mathrm{m^{2}}}{\mathrm{s}}   . Most eddy viscosity SGS models model the eddy viscosity as the product of a characteristic length scale and a characteristic velocity scale.  Smagorinskyâ€“Lilly model  The first SGS model developed was the Smagorinskyâ€“Lilly SGS model, which was developed by Smagorinsky 25 and used in the first LES simulation by Deardorff. 26 It models the eddy viscosity as:       Î½  t   =     (    C  s    Î”  g    )   2     2    S  Â¯    i  j      S  Â¯    i  j       =     (    C  s    Î”  g    )   2    |  S  |           subscript  Î½  normal-t      superscript     subscript  C  s    subscript  normal-Î”  g    2       2   subscript   normal-Â¯  S     i  j     subscript   normal-Â¯  S     i  j               superscript     subscript  C  s    subscript  normal-Î”  g    2     S       \nu_{\mathrm{t}}=(C_{s}\Delta_{g})^{2}\sqrt{2\bar{S}_{ij}\bar{S}_{ij}}=(C_{s}%
 \Delta_{g})^{2}\left|S\right|     where    Î”  g     subscript  normal-Î”  g    \Delta_{g}   is the grid size and    C  s     subscript  C  s    C_{s}   is a constant.  This method assumes that the energy production and dissipation of the small scales are in equilibrium - that is,    Ïµ  =  Î       Ïµ  normal-Î     \epsilon=\Pi   .  Germano dynamic model  Germano et al. 27 identified a number of studies using the Smagorinsky model that each found different values for the Smagorinsky constant    C  s     subscript  C  s    C_{s}   for different flow configurations. In an attempt to formulate a more universal approach to SGS models, Germano et al. proposed a dynamic Smagorinsky model, which utilized two filters: a grid LES filter, denoted    â‹…  Â¯     normal-Â¯  normal-â‹…    \overline{\cdot}   , and a test LES filter, denoted    â‹…  ^     normal-^  normal-â‹…    \hat{\cdot}   . In this case, the resolved turbulent stress tensor    â„’   i  j      subscript  â„’    i  j     \mathcal{L}_{ij}   is defined as       â„’   i  j    =    T   i  j   r   -    Ï„  ^    i  j   r         subscript  â„’    i  j       superscript   subscript  T    i  j    r    superscript   subscript   normal-^  Ï„     i  j    r      \mathcal{L}_{ij}=T_{ij}^{r}-\hat{\tau}_{ij}^{r}     which is also called the Germano identity. The quantity     T   i  j   r   =       u  i    u  j    Â¯   ^   -      u  Â¯   ^   i      u  Â¯   ^   j          superscript   subscript  T    i  j    r      normal-^   normal-Â¯     subscript  u  i    subscript  u  j         subscript   normal-^   normal-Â¯  u    i    subscript   normal-^   normal-Â¯  u    j       T_{ij}^{r}=\widehat{\overline{u_{i}u_{j}}}-\hat{\bar{u}}_{i}\hat{\bar{u}}_{j}   is the residual stress tensor for the test filter scale, and      Ï„  ^    i  j   r   =       u  i    u  j    Â¯   ^   -      u  Â¯   i     u  Â¯   j    ^         superscript   subscript   normal-^  Ï„     i  j    r      normal-^   normal-Â¯     subscript  u  i    subscript  u  j       normal-^     subscript   normal-Â¯  u   i    subscript   normal-Â¯  u   j        \hat{\tau}_{ij}^{r}=\widehat{\overline{u_{i}u_{j}}}-\widehat{\overline{u}_{i}%
 \overline{u}_{j}}   is the residual stress tensor for the grid filter, then test filtered.      â„’   i  j      subscript  â„’    i  j     \mathcal{L}_{ij}   represents the contribution to the SGS stresses by length scales smaller than the test filter width    Î”  ^     normal-^  normal-Î”    \hat{\Delta}   but larger than the grid filter width    Î”  Â¯     normal-Â¯  normal-Î”    \overline{\Delta}   . The dynamic model then finds the coefficient that best complies with the Germano identity. However, since the identity is a tensorial equation, it is overdetermined (five equations for one unknown), prompting Lilly 28 to propose a minimum least-square error method that leads to an equation for    C  s     subscript  C  s    C_{s}   :       C  s  2   =     â„’   i  j     â„³   i  j       â„³   i  j     â„³   i  j           superscript   subscript  C  s   2        subscript  â„’    i  j     subscript  â„³    i  j        subscript  â„³    i  j     subscript  â„³    i  j        C_{s}^{2}=\frac{\mathcal{L}_{ij}\mathcal{M}_{ij}}{\mathcal{M}_{ij}\mathcal{M}_%
 {ij}}     where       â„³   i  j    =   2    Î”  Â¯   2    (      |   S  ^   |     S  ^    i  j     Â¯   -    Î±  2    |    S  ^   Â¯   |      S  ^   Â¯    i  j      )         subscript  â„³    i  j      2   superscript   normal-Â¯  normal-Î”   2      normal-Â¯       normal-^  S     subscript   normal-^  S     i  j         superscript  Î±  2      normal-Â¯   normal-^  S      subscript   normal-Â¯   normal-^  S      i  j         \mathcal{M}_{ij}=2\overline{\Delta}^{2}\left(\overline{\left|\hat{S}\right|%
 \hat{S}_{ij}}-\alpha^{2}\left|\overline{\hat{S}}\right|\overline{\hat{S}}_{ij}\right)   and     Î±  =    Î”  ^   /   Î”  Â¯     .      Î±     normal-^  normal-Î”    normal-Â¯  normal-Î”      \alpha=\hat{\Delta}/\overline{\Delta}.     However, this procedure was numerically unstable since the numerator could become negative and large fluctuations in    C  s     subscript  C  s    C_{s}   were often observed. Hence, additional averaging of the error in the minimization is often employed, leading to:       C  s  2   =    âŸ¨    â„’   i  j     â„³   i  j     âŸ©    âŸ¨    â„³   i  j     â„³   i  j     âŸ©         superscript   subscript  C  s   2      delimited-âŸ¨âŸ©     subscript  â„’    i  j     subscript  â„³    i  j       delimited-âŸ¨âŸ©     subscript  â„³    i  j     subscript  â„³    i  j         C_{s}^{2}=\frac{\left\langle\mathcal{L}_{ij}\mathcal{M}_{ij}\right\rangle}{%
 \left\langle\mathcal{M}_{ij}\mathcal{M}_{ij}\right\rangle}     This has made the dynamic model more stable and making the method more widely applicable. Inherent in the procedure is the assumption that the coefficient    C  s     subscript  C  s    C_{s}   is invariant of scale (see review 29 ). The averaging can be a spatial averaging over directions of statistical homogeneity (e.g. volume for homogeneous turbulence or wall-parallel planes for channel flow as originally used in Germano et al. 30 ), or time following Lagrangian fluid trajectories . 31  Structural models  Derivation  Using Einstein notation , the Navierâ€“Stokes equations for an incompressible fluid in Cartesian coordinates are        âˆ‚   u  i     âˆ‚   x  i     =  0           subscript  u  i       subscript  x  i     0    \frac{\partial u_{i}}{\partial x_{i}}=0             âˆ‚   u  i     âˆ‚  t    +    âˆ‚    u  i    u  j      âˆ‚   x  j      =    -    1  Ï     âˆ‚  p    âˆ‚   x  i       +   Î½     âˆ‚  2    u  i      âˆ‚   x  j     âˆ‚   x  j         .             subscript  u  i      t           subscript  u  i    subscript  u  j        subscript  x  j              1  Ï       p      subscript  x  i         Î½      superscript   2    subscript  u  i         subscript  x  j       subscript  x  j          \frac{\partial u_{i}}{\partial t}+\frac{\partial u_{i}u_{j}}{\partial x_{j}}=-%
 \frac{1}{\rho}\frac{\partial p}{\partial x_{i}}+\nu\frac{\partial^{2}u_{i}}{%
 \partial x_{j}\partial x_{j}}.     Filtering the momentum equation results in           âˆ‚   u  i     âˆ‚  t    Â¯   +     âˆ‚    u  i    u  j      âˆ‚   x  j     Â¯    =    -     1  Ï     âˆ‚  p    âˆ‚   x  i      Â¯    +    Î½     âˆ‚  2    u  i      âˆ‚   x  j     âˆ‚   x  j       Â¯     .         normal-Â¯       subscript  u  i      t      normal-Â¯         subscript  u  i    subscript  u  j        subscript  x  j            normal-Â¯      1  Ï       p      subscript  x  i         normal-Â¯    Î½      superscript   2    subscript  u  i         subscript  x  j       subscript  x  j           \overline{\frac{\partial u_{i}}{\partial t}}+\overline{\frac{\partial u_{i}u_{%
 j}}{\partial x_{j}}}=-\overline{\frac{1}{\rho}\frac{\partial p}{\partial x_{i}%
 }}+\overline{\nu\frac{\partial^{2}u_{i}}{\partial x_{j}\partial x_{j}}}.     If we assume that filtering and differentiation commute, then          âˆ‚    u  i   Â¯     âˆ‚  t    +     âˆ‚    u  i    u  j      âˆ‚   x  j     Â¯    =    -    1  Ï     âˆ‚   p  Â¯     âˆ‚   x  i       +   Î½     âˆ‚  2     u  i   Â¯      âˆ‚   x  j     âˆ‚   x  j         .             normal-Â¯   subscript  u  i       t     normal-Â¯         subscript  u  i    subscript  u  j        subscript  x  j               1  Ï        normal-Â¯  p       subscript  x  i         Î½      superscript   2    normal-Â¯   subscript  u  i          subscript  x  j       subscript  x  j          \frac{\partial\bar{u_{i}}}{\partial t}+\overline{\frac{\partial u_{i}u_{j}}{%
 \partial x_{j}}}=-\frac{1}{\rho}\frac{\partial\bar{p}}{\partial x_{i}}+\nu%
 \frac{\partial^{2}\bar{u_{i}}}{\partial x_{j}\partial x_{j}}.     This equation models the changes in time of the filtered variables     u  i   Â¯     normal-Â¯   subscript  u  i     \bar{u_{i}}   . Since the unfiltered variables    u  i     subscript  u  i    u_{i}   are not known, it is impossible to directly calculate      âˆ‚    u  i    u  j      âˆ‚   x  j     Â¯     normal-Â¯         subscript  u  i    subscript  u  j        subscript  x  j       \overline{\frac{\partial u_{i}u_{j}}{\partial x_{j}}}   . However, the quantity     âˆ‚     u  i   Â¯     u  j   Â¯      âˆ‚   x  j             normal-Â¯   subscript  u  i     normal-Â¯   subscript  u  j         subscript  x  j      \frac{\partial\bar{u_{i}}\bar{u_{j}}}{\partial x_{j}}   is known. A substitution is made:          âˆ‚    u  i   Â¯     âˆ‚  t    +    âˆ‚     u  i   Â¯     u  j   Â¯      âˆ‚   x  j      =     -    1  Ï     âˆ‚   p  Â¯     âˆ‚   x  i       +   Î½     âˆ‚  2     u  i   Â¯      âˆ‚   x  j     âˆ‚   x  j        -   (      âˆ‚    u  i    u  j      âˆ‚   x  j     Â¯   -    âˆ‚     u  i   Â¯     u  j   Â¯      âˆ‚   x  j      )     .             normal-Â¯   subscript  u  i       t           normal-Â¯   subscript  u  i     normal-Â¯   subscript  u  j         subscript  x  j                1  Ï        normal-Â¯  p       subscript  x  i         Î½      superscript   2    normal-Â¯   subscript  u  i          subscript  x  j       subscript  x  j           normal-Â¯         subscript  u  i    subscript  u  j        subscript  x  j             normal-Â¯   subscript  u  i     normal-Â¯   subscript  u  j         subscript  x  j         \frac{\partial\bar{u_{i}}}{\partial t}+\frac{\partial\bar{u_{i}}\bar{u_{j}}}{%
 \partial x_{j}}=-\frac{1}{\rho}\frac{\partial\bar{p}}{\partial x_{i}}+\nu\frac%
 {\partial^{2}\bar{u_{i}}}{\partial x_{j}\partial x_{j}}-\left(\overline{\frac{%
 \partial u_{i}u_{j}}{\partial x_{j}}}-\frac{\partial\bar{u_{i}}\bar{u_{j}}}{%
 \partial x_{j}}\right).     Let     Ï„   i  j    =      u  i    u  j    Â¯   -     u  i   Â¯     u  j   Â¯          subscript  Ï„    i  j       normal-Â¯     subscript  u  i    subscript  u  j        normal-Â¯   subscript  u  i     normal-Â¯   subscript  u  j        \tau_{ij}=\overline{u_{i}u_{j}}-\bar{u_{i}}\bar{u_{j}}   . The resulting set of equations are the LES equations:          âˆ‚    u  i   Â¯     âˆ‚  t    +     u  j   Â¯     âˆ‚    u  i   Â¯     âˆ‚   x  j       =     -    1  Ï     âˆ‚   p  Â¯     âˆ‚   x  i       +   Î½     âˆ‚  2     u  i   Â¯      âˆ‚   x  j     âˆ‚   x  j        -    âˆ‚   Ï„   i  j      âˆ‚   x  j       .             normal-Â¯   subscript  u  i       t       normal-Â¯   subscript  u  j         normal-Â¯   subscript  u  i        subscript  x  j                 1  Ï        normal-Â¯  p       subscript  x  i         Î½      superscript   2    normal-Â¯   subscript  u  i          subscript  x  j       subscript  x  j             subscript  Ï„    i  j        subscript  x  j        \frac{\partial\bar{u_{i}}}{\partial t}+\bar{u_{j}}\frac{\partial\bar{u_{i}}}{%
 \partial x_{j}}=-\frac{1}{\rho}\frac{\partial\bar{p}}{\partial x_{i}}+\nu\frac%
 {\partial^{2}\bar{u_{i}}}{\partial x_{j}\partial x_{j}}-\frac{\partial\tau_{ij%
 }}{\partial x_{j}}.     See also   Direct numerical simulation  Fluid mechanics  Galilean invariance â€“ an important property of certain types of filters  Reynolds-averaged Navierâ€“Stokes equations  Turbulence   References  "  Category:Partial differential equations  Category:Fluid dynamics  Category:Fluid mechanics  Category:Turbulence  Category:Turbulence models     â†©  â†©  â†©  â†©  â†©  â†©    â†©  â†©  â†©   â†©  â†©  â†©   â†©   â†©  â†©  â†©    â†©    â†©  â†©  â†©   â†©     
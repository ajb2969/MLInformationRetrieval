


Integration by parts




Integration by parts

In calculus, and more generally in mathematical analysis, integration by parts is a theorem that relates the integral of a product of functions to the integral of their derivative and antiderivative. It is frequently used to transform the antiderivative of a product of functions into an antiderivative for which a solution can be more easily found. The rule can be derived in one line simply by integrating the product rule of differentiation.
If 
 
 


 
  and 
 
 


 
 , while 
 
 


 
  and 
 
 


 
 , then integration by parts states that:



or more compactly:



More general formulations of integration by parts exist for the Riemann–Stieltjes integral and Lebesgue–Stieltjes integral. The discrete analogue for sequences is called summation by parts.
Theorem
Product of two functions
The theorem can be derived as follows. Suppose u(x) and v(x) are two continuously differentiable functions. The product rule states (in Leibniz’ notation):



Integrate both sides with respect to x,



then apply the definition of indefinite integral,






gives the formula for integration by parts.
Since du and dv are differentials of a function of one variable x,






The original integral ∫uv′ dx contains v′ (derivative of v); in order to apply the theorem, v (antiderivative of v′) must be found, and then the resulting integral ∫vu′ dx must be evaluated.
Product of many functions
Integrating the product rule for three multiplied functions, u(x), v(x), w(x), gives a similar result:



In general for n factors



which leads to



where the product is of all functions except for the one differentiated in the same term.
Visualization
thumb|280px |Graphical interpretation of the theorem. The pictured curve is parametrized by the variable t. Define a parametric curve by (x, y) = (f(t), g(t)). Assuming that the curve is locally one-to-one, we can define






The area of the blue region is



Similarly, the area of the red region is



The total area A1 + A2 is equal to the area of the bigger rectangle, x2y2, minus the area of the smaller one, x1y1:



Assuming the curve is smooth within a neighborhood, this generalizes to indefinite integrals:


 
  Rearranging:


 
  Thus integration by parts may be thought of as deriving the area of the blue region from the total area and that of the red region.
This visualisation also explains why integration by parts may help find the integral of an inverse function f−1(x) when the integral of the function f(xv) is known. Indeed, the functions x(y) and y(x) are inverses, and the integral ∫x dy may be calculated as above from knowing the integral ∫y dx.
Application to find antiderivatives
Strategy
Integration by parts is a heuristic rather than a purely mechanical process for solving integrals; given a single function to integrate, the typical strategy is to carefully separate it into a product of two functions u(x)v(x) such that the integral produced by the integration by parts formula is easier to evaluate than the original one. The following form is useful in illustrating the best strategy to take:



Note that on the right-hand side, u is differentiated and v is integrated; consequently it is useful to choose u as a function that simplifies when differentiated, and/or to choose v as a function that simplifies when integrated. As a simple example, consider:



Since the derivative of ln x is 1/x, we make (ln x) part u; since the antiderivative of 1/x2 is −1/x, we make (1/x2)dx part dv. The formula now yields:



The antiderivative of −1/x2 can be found with the power rule and is 1/x.
Alternatively, we may choose u and v such that the product u' (∫v dx) simplifies due to cancellation. For example, suppose we wish to integrate:



If we choose u(x) = ln |sin x| and v(x) = sec2x, then u differentiates to 1/ tan x using the chain rule and v integrates to tan x; so the formula gives:



The integrand simplifies to 1, so the antiderivative is x. Finding a simplifying combination frequently involves experimentation.
In some applications, it may not be necessary to ensure that the integral produced by integration by parts has a simple form; for example, in numerical analysis, it may suffice that it has small magnitude and so contributes only a small error term. Some other special techniques are demonstrated in the examples below.

Polynomials and trigonometric functions

In order to calculate



let:






then:



where C is an arbitrary constant of integration.
For higher powers of x in the form



repeatedly using integration by parts can evaluate integrals such as these; each application of the theorem lowers the power of x by one.

Exponentials and trigonometric functions

An example commonly used to examine the workings of integration by parts is



Here, integration by parts is performed twice. First let






then:



Now, to evaluate the remaining integral, we use integration by parts again, with:






Then:



Putting these together,



The same integral shows up on both sides of this equation. The integral can simply be added to both sides to get



which rearranges to:



where again C (and C' = C/2) is an arbitrary constant of integration.
A similar method is used to find the integral of secant cubed.

Functions multiplied by unity

Two other well-known examples are when integration by parts is applied to a function expressed as a product of 1 and itself. This works if the derivative of the function is known, and the integral of this derivative times x is also known.
The first example is ∫ ln(x) dx. We write this as:



Let:






then:



where C is the constant of integration.
The second example is the inverse tangent function arctan(x):



Rewrite this as



Now let:






then



using a combination of the inverse chain rule method and the natural logarithm integral condition.
LIATE rule
A rule of thumb proposed by Herbert Kasube of Bradley University advises that whichever function comes first in the following list should be u:1

L - Logarithmic functions: ln x, logb x, etc.
 
I - Inverse trigonometric functions: arctan x, arcsec x, etc.
 
A - Algebraic functions: x2, 3x50, etc.
 
T - Trigonometric functions: sin x, tan x, etc.
 
E - Exponential functions: ex, 19x, etc.
 

The function which is to be dv is whichever comes last in the list: functions lower on the list have easier antiderivatives than the functions above them. The rule is sometimes written as "DETAIL" where D stands for dv.
To demonstrate the LIATE rule, consider the integral



Following the LIATE rule, u = x and dv = cos x dx, hence du = dx and v = sin x, which makes the integral become


 
  which equals



In general, one tries to choose u and dv such that du is simpler than u and dv is easy to integrate. If instead cos x was chosen as u, and x.dx as dv, we would have the integral



which, after recursive application of the integration by parts formula, would clearly result in an infinite recursion and lead nowhere.
Although a useful rule of thumb, there are exceptions to the LIATE rule. A common alternative is to consider the rules in the "ILATE" order instead. Also, in some cases, polynomial terms need to be split in non-trivial ways. For example, to integrate



one would set



so that



Then



Finally, this results in



Applications in pure mathematics
Integration by parts is often used as a tool to prove theorems in mathematical analysis. This section gives a few examples.
Use in special functions
The gamma function is an example of a special function, defined as an improper integral. Integration by parts illustrates it to be an extension of the factorial:



yielding the famous identity



For integer z, applying this formula repeatedly gives the factorial (denoted by the !):



Use in harmonic analysis
Integration by parts is often used in harmonic analysis, particularly Fourier analysis, to show that quickly oscillating integrals with sufficiently smooth integrands decay quickly. The most common example of this is its use in showing that the decay of function's Fourier transform depends on the smoothness of that function, as described below.

Fourier transform of derivative

If f is a k-times continuously differentiable function and all derivatives up to the kth one decay to zero at infinity, then its Fourier transform satisfies



where  is the kth derivative of f. (The exact constant on the right depends on the convention of the Fourier transform used.) This is proved by noting that



so using integration by parts on the Fourier transform of the derivative we get



Applying this inductively gives the result for general k. A similar method can be used to find the Laplace transform of a derivative of a function.

Decay of Fourier transform

The above result tells us about the decay of the Fourier transform, since it follows that if f and  are integrable then


 
 , where 
 
 
 
 .
In other words, if f satisfies these conditions then its Fourier transform decays at infinity at least as quickly as ξ{{!}}k}}. In particular, if  then the Fourier transform is integrable.
The proof uses the fact, which is immediate from the definition of the Fourier transform, that


 
  Using the same idea on the equality stated at the start of this subsection gives


 
  Summing these two inequalities and then dividing by 2πξk{{!}}}} gives the stated inequality.
Use in operator theory
One use of integration by parts in operator theory is that it shows that the  (where ∆ is the Laplace operator) is a positive operator on  (see Lp space). If f is smooth and compactly supported then, using integration by parts, we have



Other applications

For determining boundary conditions in Sturm–Liouville theory
Deriving the Euler–Lagrange equation in the calculus of variations

Recursive integration by parts
Integration by parts can often be applied recursively to provide the following formula



This form is especially useful when v(n) becomes zero for some n (and, in particular, when v is a polynomial function with degree smaller than n). Hence, the integral evaluation can stop once the v(n − 1) term has been reached.
Tabular integration by parts
While the aforementioned recursive definition is correct, it is often tedious to remember and implement. A much easier visual representation of this process is often taught to students and is dubbed either "the tabular method",2 "the Stand and Deliver method",3 "rapid repeated integration" or "the tic-tac-toe method". This method works best when one of the two functions in the product is a polynomial, that is, after differentiating it several times one obtains zero. It may also be extended to work for functions that will repeat themselves.
For example, consider the integral



Let u = x3. Begin with this function and list in a column all the subsequent derivatives until zero is reached. Secondly, begin with the function v (in this case cos(x)) and list each integral of v until the size of the column is the same as that of u. The result should appear as follows.






Derivatives of u (Column A)

Integrals of v (Column B)

























































Now simply pair the 1st entry of column A with the 2nd entry of column B, the 2nd entry of column A with the 3rd entry of column B, etc... with alternating signs (beginning with the positive sign). Do so until further pairing leads to sums of zeros. The result is the following (notice the alternating signs in each term):



Which, with simplification, leads to the result



With proper understanding of the tabular method, it can be extended. Consider









Derivatives of u (Column A)

Integrals of v (Column B)





































In this case in the last step it is necessary to integrate the product of the two bottom cells obtaining:



which leads to



and yields the result:



Higher dimensions
The formula for integration by parts can be extended to functions of several variables. Instead of an interval one needs to integrate over an n-dimensional set. Also, one replaces the derivative with a partial derivative.


 
 .
More specifically, suppose Ω is an open bounded subset of ℝn with a piecewise smooth boundary Γ. If u and v are two continuously differentiable functions on the closure of Ω, then the formula for integration by parts is


 
  where 
 
 
 
  is the outward unit surface normal to Γ, 
 
 
 
  is its i-th component, and i ranges from 1 to n.
Replacing v in the above formula with vi and summing over i gives the vector formula


 
  where v is a vector-valued function with components v1, ..., vn.
Setting u equal to the constant function 1 in the above formula gives the divergence theorem


 
  For 
 
 
 
  where 
 
 
 
 , one gets


 
  which is the first Green's identity.
The regularity requirements of the theorem can be relaxed. For instance, the boundary Γ need only be Lipschitz continuous. In the first formula above, only u, v ∈ H1(Ω) is necessary (where H1 is a Sobolev space); the other formulas have similarly relaxed requirements.
See also

Integration by parts for the Lebesgue–Stieltjes integral
Integration by parts for semimartingales, involving their quadratic covariation.
Integration by substitution
Legendre transformation

Notes


References





External links


Integration by parts—from MathWorld

es:Métodos de integración#Método de integración por partes"
Category:Integral calculus











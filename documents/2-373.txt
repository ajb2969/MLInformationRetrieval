   Integration by parts      Integration by parts   In calculus , and more generally in mathematical analysis , integration by parts is a theorem that relates the integral of a product of functions to the integral of their derivative and antiderivative. It is frequently used to transform the antiderivative of a product of functions into an antiderivative for which a solution can be more easily found. The rule can be derived in one line simply by integrating the product rule of differentiation .  If   u   u   u      =     =       u   (  x  )       u  x    u(x)   and    d  u      d  u    du      =     =       u  â€²   (  x  )   d  x      u  normal-â€²  x  d  x    uâ€²(x)dx   , while   v   v   v      =     =       v   (  x  )       v  x    v(x)   and    d  v      d  v    dv      =     =       v  â€²   (  x  )   d  x      v  normal-â€²  x  d  x    vâ€²(x)dx   , then integration by parts states that:       âˆ«   u   (  x  )    v  â€²    (  x  )   d  x    =    u   (  x  )   v   (  x  )    -   âˆ«   v   (  x  )    u  â€²    (  x  )   d  x             u  x   superscript  v  normal-â€²   x  d  x        u  x  v  x       v  x   superscript  u  normal-â€²   x  d  x       \int u(x)v^{\prime}(x)\,dx=u(x)v(x)-\int v(x)\,u^{\prime}(x)dx     or more compactly:        âˆ«    u   d  v    =    u  v   -   âˆ«    v   d  u      .          u  d  v        u  v       v  d  u       \int u\,dv=uv-\int v\,du.\!     More general formulations of integration by parts exist for the Riemannâ€“Stieltjes integral and Lebesgueâ€“Stieltjes integral . The discrete analogue for sequences is called summation by parts .  Theorem  Product of two functions  The theorem can be derived as follows. Suppose u ( x ) and v ( x ) are two continuously differentiable  functions . The product rule states (in Leibnizâ€™ notation ):         d   d  x     (   u   (  x  )   v   (  x  )    )    =    v   (  x  )    d   d  x     (   u   (  x  )    )    +   u   (  x  )    d   d  x     (   v   (  x  )    )      .          d    d  x      u  x  v  x        v  x    d    d  x      u  x      u  x    d    d  x      v  x       \frac{d}{dx}\left(u(x)v(x)\right)=v(x)\frac{d}{dx}\left(u(x)\right)+u(x)\frac{%
 d}{dx}\left(v(x)\right).\!     Integrate both sides with respect to x ,       âˆ«    d   d  x     (   u   (  x  )   v   (  x  )    )   d  x    =    âˆ«    u  â€²    (  x  )   v   (  x  )   d  x    +   âˆ«   u   (  x  )    v  â€²    (  x  )   d  x               d    d  x      u  x  v  x   d  x           superscript  u  normal-â€²   x  v  x  d  x        u  x   superscript  v  normal-â€²   x  d  x       \int\frac{d}{dx}\left(u(x)v(x)\right)\,dx=\int u^{\prime}(x)v(x)\,dx+\int u(x)%
 v^{\prime}(x)\,dx     then apply the definition of indefinite integral ,       u   (  x  )   v   (  x  )    =    âˆ«    u  â€²    (  x  )   v   (  x  )   d  x    +   âˆ«   u   (  x  )    v  â€²    (  x  )   d  x           u  x  v  x          superscript  u  normal-â€²   x  v  x  d  x        u  x   superscript  v  normal-â€²   x  d  x       u(x)v(x)=\int u^{\prime}(x)v(x)\,dx+\int u(x)v^{\prime}(x)\,dx          âˆ«   u   (  x  )    v  â€²    (  x  )   d  x    =    u   (  x  )   v   (  x  )    -   âˆ«    u  â€²    (  x  )   v   (  x  )   d  x             u  x   superscript  v  normal-â€²   x  d  x        u  x  v  x        superscript  u  normal-â€²   x  v  x  d  x       \int u(x)v^{\prime}(x)\,dx=u(x)v(x)-\int u^{\prime}(x)v(x)\,dx     gives the formula for integration by parts .  Since du and dv are differentials of a function of one variable x ,        d  u   =    u  â€²    (  x  )   d  x      d  v   =    v  â€²    (  x  )   d  x       formulae-sequence      d  u      superscript  u  normal-â€²   x  d  x        d  v      superscript  v  normal-â€²   x  d  x      du=u^{\prime}(x)dx\quad dv=v^{\prime}(x)dx          âˆ«   u   (  x  )   d  v    =    u   (  x  )   v   (  x  )    -   âˆ«   v   (  x  )   d  u             u  x  d  v        u  x  v  x       v  x  d  u       \int u(x)\,dv=u(x)v(x)-\int v(x)\,du     The original integral âˆ« uv â€² dx contains v â€² ( derivative of v ); in order to apply the theorem, v ( antiderivative of v â€²) must be found, and then the resulting integral âˆ« vu â€² dx must be evaluated.  Product of many functions  Integrating the product rule for three multiplied functions, u ( x ), v ( x ), w ( x ), gives a similar result:         âˆ«  a  b    u   v   d  w    =     [   u  v  w   ]   a  b   -    âˆ«  a  b    u   w   d  v    -    âˆ«  a  b    v   w   d  u      .        superscript   subscript   a   b     u  v  d  w       subscript   superscript   delimited-[]    u  v  w    b   a     superscript   subscript   a   b     u  w  d  v      superscript   subscript   a   b     v  w  d  u       \int_{a}^{b}uv\,dw=[uvw]^{b}_{a}-\int_{a}^{b}uw\,dv-\int_{a}^{b}vw\,du.     In general for n factors         d   d  x     (    âˆ   i  =  1   n     u  i    (  x  )     )    =    âˆ‘   j  =  1   n     âˆ   i  â‰   j   n     u  i    (  x  )     d   u  j    (  x  )     d  x        ,          d    d  x      superscript   subscript  product    i  1    n      subscript  u  i   x       superscript   subscript     j  1    n     superscript   subscript  product    i  j    n      subscript  u  i   x      d   subscript  u  j   x     d  x         \frac{d}{dx}\left(\prod_{i=1}^{n}u_{i}(x)\right)=\sum_{j=1}^{n}\prod_{i\neq j}%
 ^{n}u_{i}(x)\frac{du_{j}(x)}{dx},     which leads to         [    âˆ   i  =  1   n     u  i    (  x  )     ]   a  b   =    âˆ‘   j  =  1   n     âˆ«  a  b     âˆ   i  â‰   j   n     u  i    (  x  )   d   u  j    (  x  )        ,       superscript   subscript   delimited-[]    superscript   subscript  product    i  1    n      subscript  u  i   x     a   b     superscript   subscript     j  1    n     superscript   subscript   a   b     superscript   subscript  product    i  j    n      subscript  u  i   x  d   subscript  u  j   x        \Bigl[\prod_{i=1}^{n}u_{i}(x)\Bigr]_{a}^{b}=\sum_{j=1}^{n}\int_{a}^{b}\prod_{i%
 \neq j}^{n}u_{i}(x)\,du_{j}(x),     where the product is of all functions except for the one differentiated in the same term.  Visualization  thumb|280px |Graphical interpretation of the theorem. The pictured curve is parametrized by the variable t. Define a parametric curve by ( x , y ) = ( f ( t ), g ( t )). Assuming that the curve is locally one-to-one , we can define       x   (  y  )    =   f   (    g   -  1     (  y  )    )          x  y     f     superscript  g    1    y      x(y)=f(g^{-1}(y))          y   (  x  )    =   g   (    f   -  1     (  x  )    )          y  x     g     superscript  f    1    x      y(x)=g(f^{-1}(x))     The area of the blue region is       A  1   =    âˆ«   y  1    y  2     x   (  y  )   d  y         subscript  A  1     superscript   subscript    subscript  y  1     subscript  y  2      x  y  d  y      A_{1}=\int_{y_{1}}^{y_{2}}x(y)dy     Similarly, the area of the red region is       A  2   =    âˆ«   x  1    x  2     y   (  x  )   d  x         subscript  A  2     superscript   subscript    subscript  x  1     subscript  x  2      y  x  d  x      A_{2}=\int_{x_{1}}^{x_{2}}y(x)dx     The total area A 1 + A 2 is equal to the area of the bigger rectangle, x 2 y 2 , minus the area of the smaller one, x 1 y 1 :          âˆ«   y  1    y  2     x   (  y  )   d  y    â    A  1    +      âˆ«   x  1    x  2     y   (  x  )   d  x    â    A  2    =  .  x  .  y   (  x  )     |   x  1    x  2    =  .  y  .  x   (  y  )    |   y  1    y  2        fragments   superscript   normal-â    superscript   subscript    subscript  y  1     subscript  y  2      x  y  d  y      subscript  A  1      superscript   normal-â    superscript   subscript    subscript  x  1     subscript  x  2      y  x  d  x      subscript  A  2     normal-.  x  normal-.  y   fragments  normal-(  x  normal-)    fragments   superscript   subscript  normal-|    x  1      x  2     normal-.  y  normal-.  x   fragments  normal-(  y  normal-)    superscript   subscript  normal-|    y  1      y  2       \overbrace{\int_{y_{1}}^{y_{2}}x(y)dy}^{A_{1}}+\overbrace{\int_{x_{1}}^{x_{2}}%
 y(x)dx}^{A_{2}}=\biggl.x.y(x)\biggl|_{x1}^{x2}=\biggl.y.x(y)\biggl|_{y1}^{y2}     Assuming the curve is smooth within a neighborhood, this generalizes to indefinite integrals:        âˆ«   x  d  y    +   âˆ«   y  d  x     =   x  y             x  d  y        y  d  x       x  y     \int xdy+\int ydx=xy   Rearranging:       âˆ«   x  d  y    =    x  y   -   âˆ«   y  d  x             x  d  y        x  y       y  d  x       \int xdy=xy-\int ydx   Thus integration by parts may be thought of as deriving the area of the blue region from the total area and that of the red region.  This visualisation also explains why integration by parts may help find the integral of an inverse function f âˆ’1 ( x ) when the integral of the function f ( xv ) is known. Indeed, the functions x ( y ) and y ( x ) are inverses, and the integral âˆ« x dy may be calculated as above from knowing the integral âˆ« y dx .  Application to find antiderivatives  Strategy  Integration by parts is a heuristic rather than a purely mechanical process for solving integrals; given a single function to integrate, the typical strategy is to carefully separate it into a product of two functions u ( x ) v ( x ) such that the integral produced by the integration by parts formula is easier to evaluate than the original one. The following form is useful in illustrating the best strategy to take:        âˆ«   u   v   d  x    =    u   âˆ«    v   d  x     -   âˆ«    (    u  â€²    âˆ«    v   d  x     )   d  x      .          u  v  d  x        u      v  d  x            superscript  u  normal-â€²       v  d  x     d  x       \int uv\,dx=u\int v\,dx-\int\left(u^{\prime}\int v\,dx\right)\,dx.\!     Note that on the right-hand side, u is differentiated and v is integrated; consequently it is useful to choose u as a function that simplifies when differentiated, and/or to choose v as a function that simplifies when integrated. As a simple example, consider:       âˆ«      ln  x    x  2     d  x    .            x    superscript  x  2    d  x     \int\frac{\ln x}{x^{2}}\,dx.\!     Since the derivative of ln x is 1/ x , we make (ln x ) part u ; since the antiderivative of 1/ x 2 is âˆ’1/ x , we make (1/ x 2 ) dx part dv . The formula now yields:        âˆ«      ln  x    x  2     d  x    =    -    ln  x   x    -   âˆ«    (   1  x   )    (   -   1  x    )   d  x      .              x    superscript  x  2    d  x            x   x          1  x       1  x    d  x       \int\frac{\ln x}{x^{2}}\,dx=-\frac{\ln x}{x}-\int\biggl(\frac{1}{x}\biggr)%
 \biggl(-\frac{1}{x}\biggr)\,dx.\!     The antiderivative of âˆ’1/ x 2 can be found with the power rule and is 1/ x .  Alternatively, we may choose u and v such that the product u ' (âˆ« v dx ) simplifies due to cancellation. For example, suppose we wish to integrate:       âˆ«    sec  2    x   ln    |   sin  x   |   d  x       .        superscript   2     x          x    d  x        \int\sec^{2}x\ln|\sin x|dx.     If we choose u ( x ) = ln |sin x | and v ( x ) = sec 2 x, then u differentiates to 1/ tan x using the chain rule and v integrates to tan x ; so the formula gives:        âˆ«    sec  2    x   ln    |   sin  x   |   d  x       =    tan   x   ln   |   sin  x   |      -   âˆ«   tan   x   1   tan  x    d  x       .          superscript   2     x          x    d  x             x        x             x    1    x    d  x        \int\sec^{2}x\ln|\sin x|dx=\tan x\ln|\sin x|-\int\tan x\frac{1}{\tan x}dx.     The integrand simplifies to 1, so the antiderivative is x . Finding a simplifying combination frequently involves experimentation.  In some applications, it may not be necessary to ensure that the integral produced by integration by parts has a simple form; for example, in numerical analysis , it may suffice that it has small magnitude and so contributes only a small error term. Some other special techniques are demonstrated in the examples below.   Polynomials and trigonometric functions   In order to calculate       I  =   âˆ«   x   cos   (  x  )    d   x      ,      I      x    x   d  x      I=\int x\cos(x)\,dx\,,     let:      u  =  x  â‡’   d  u   =   d  x         u  x    normal-â‡’      d  u          d  x      u=x\Rightarrow du=dx          d  v   =    cos   (  x  )    d  x   â‡’  v  =   âˆ«    cos   (  x  )    d  x    =   sin   (  x  )            d  v       x   d  x     normal-â‡’    v             x   d  x           x      dv=\cos(x)\,dx\Rightarrow v=\int\cos(x)\,dx=\sin(x)     then:          âˆ«   x   cos   (  x  )    d  x        =   âˆ«    u   d  v            =    u  v   -   âˆ«    v   d  u             =    x   sin   (  x  )     -   âˆ«    sin   (  x  )    d  x              =    x   sin   (  x  )     +   cos   (  x  )    +  C    ,              x    x   d  x      absent      u  d  v        missing-subexpression     absent      u  v       v  d  u         missing-subexpression     absent      x    x          x   d  x         missing-subexpression     absent      x    x      x   C       \begin{aligned}\displaystyle\int x\cos(x)\,dx&\displaystyle=\int u\,dv\\
 &\displaystyle=uv-\int v\,du\\
 &\displaystyle=x\sin(x)-\int\sin(x)\,dx\\
 &\displaystyle=x\sin(x)+\cos(x)+C,\end{aligned}\!     where C is an arbitrary constant of integration .  For higher powers of x in the form        âˆ«    x  n     e  x    d  x    ,   âˆ«    x  n    sin   (  x  )    d  x    ,   âˆ«    x  n    cos   (  x  )    d   x      ,          superscript  x  n    superscript  e  x   d  x         superscript  x  n     x   d  x         superscript  x  n     x   d  x      \int x^{n}e^{x}\,dx,\,\int x^{n}\sin(x)\,dx,\,\int x^{n}\cos(x)\,dx\,,     repeatedly using integration by parts can evaluate integrals such as these; each application of the theorem lowers the power of x by one.   Exponentials and trigonometric functions   An example commonly used to examine the workings of integration by parts is       I  =   âˆ«    e  x    cos   (  x  )    d  x     .      I       superscript  e  x     x   d  x      I=\int e^{x}\cos(x)\,dx.     Here, integration by parts is performed twice. First let      u  =   cos   (  x  )    â‡’   d  u   =   -    sin   (  x  )    d  x          u    x     normal-â‡’      d  u              x   d  x       u=\cos(x)\Rightarrow du=-\sin(x)\,dx          d  v   =     e  x    d  x   â‡’  v  =   âˆ«     e  x    d  x    =   e  x           d  v      superscript  e  x   d  x     normal-â‡’    v            superscript  e  x   d  x          superscript  e  x      dv=e^{x}\,dx\Rightarrow v=\int e^{x}\,dx=e^{x}     then:        âˆ«    e  x    cos   (  x  )    d  x    =     e  x    cos   (  x  )     +   âˆ«    e  x    sin   (  x  )    d  x      .           superscript  e  x     x   d  x         superscript  e  x     x         superscript  e  x     x   d  x       \int e^{x}\cos(x)\,dx=e^{x}\cos(x)+\int e^{x}\sin(x)\,dx.\!     Now, to evaluate the remaining integral, we use integration by parts again, with:      u  =   sin   (  x  )    â‡’   d  u   =    cos   (  x  )    d  x         u    x     normal-â‡’      d  u            x   d  x      u=\sin(x)\Rightarrow du=\cos(x)\,dx           d  v   =     e  x    d  x   â‡’  v  =   âˆ«     e  x    d  x    =   e  x    .          d  v      superscript  e  x   d  x     normal-â‡’    v            superscript  e  x   d  x          superscript  e  x      dv=e^{x}\,dx\Rightarrow v=\int e^{x}\,dx=e^{x}.     Then:        âˆ«    e  x    sin   (  x  )    d  x    =     e  x    sin   (  x  )     -   âˆ«    e  x    cos   (  x  )    d  x      .           superscript  e  x     x   d  x         superscript  e  x     x         superscript  e  x     x   d  x       \int e^{x}\sin(x)\,dx=e^{x}\sin(x)-\int e^{x}\cos(x)\,dx.     Putting these together,        âˆ«    e  x    cos   (  x  )    d  x    =      e  x    cos   (  x  )     +    e  x    sin   (  x  )      -   âˆ«    e  x    cos   (  x  )    d  x      .           superscript  e  x     x   d  x           superscript  e  x     x       superscript  e  x     x          superscript  e  x     x   d  x       \int e^{x}\cos(x)\,dx=e^{x}\cos(x)+e^{x}\sin(x)-\int e^{x}\cos(x)\,dx.     The same integral shows up on both sides of this equation. The integral can simply be added to both sides to get       2   âˆ«    e  x    cos   (  x  )    d  x     =     e  x    (    sin   (  x  )    +   cos   (  x  )     )    +   C          2       superscript  e  x     x   d  x          superscript  e  x       x     x     C     2\int e^{x}\cos(x)\,dx=e^{x}(\sin(x)+\cos(x))+C\!     which rearranges to:       âˆ«    e  x    cos   (  x  )    d  x    =      e  x    (    sin   (  x  )    +   cos   (  x  )     )    2   +    C  â€²              superscript  e  x     x   d  x           superscript  e  x       x     x     2    superscript  C  normal-â€²      \int e^{x}\cos(x)\,dx={e^{x}(\sin(x)+\cos(x))\over 2}+C^{\prime}\!     where again C (and C ' = C /2) is an arbitrary constant of integration .  A similar method is used to find the integral of secant cubed .   Functions multiplied by unity   Two other well-known examples are when integration by parts is applied to a function expressed as a product of 1 and itself. This works if the derivative of the function is known, and the integral of this derivative times x is also known.  The first example is âˆ« ln( x )Â d x . We write this as:       I  =   âˆ«     ln   (  x  )    â‹…   1    d  x     .      I       normal-â‹…    x   1   d  x      I=\int\ln(x)\cdot 1\,dx.\!     Let:      u  =   ln   (  x  )    â‡’   d  u   =    d  x   x         u    x     normal-â‡’      d  u            d  x   x      u=\ln(x)\Rightarrow du=\frac{dx}{x}          d  v   =   d  x   â‡’  v  =   x           d  v     d  x     normal-â‡’    v       x     dv=dx\Rightarrow v=x\,     then:       âˆ«    ln   (  x  )    d  x            x   d  x     \displaystyle\int\ln(x)\,dx     where C is the constant of integration .  The second example is the inverse tangent function arctan( x ):       I  =   âˆ«    arctan   (  x  )    d  x     .      I        x   d  x      I=\int\arctan(x)\,dx.     Rewrite this as       âˆ«     arctan   (  x  )    â‹…   1    d  x    .         normal-â‹…    x   1   d  x     \int\arctan(x)\cdot 1\,dx.     Now let:      u  =   arctan   (  x  )    â‡’   d  u   =    d  x    1  +   x  2           u    x     normal-â‡’      d  u            d  x     1   superscript  x  2        u=\arctan(x)\Rightarrow du=\frac{dx}{1+x^{2}}          d  v   =   d  x   â‡’  v  =  x          d  v     d  x     normal-â‡’    v       x     dv=dx\Rightarrow v=x     then       âˆ«    arctan   (  x  )    d  x            x   d  x     \displaystyle\int\arctan(x)\,dx     using a combination of the inverse chain rule method and the natural logarithm integral condition .  LIATE rule  A rule of thumb proposed by Herbert Kasube of Bradley University advises that whichever function comes first in the following list should be u : 1   L - Logarithmic functions : ln x , log b  x , etc.  I - Inverse trigonometric functions : arctan x , arcsec x , etc.  A - Algebraic functions : x 2 , 3 x 50 , etc.  T - Trigonometric functions : sin x , tan x , etc.  E - Exponential functions : e x , 19 x , etc.   The function which is to be dv is whichever comes last in the list: functions lower on the list have easier antiderivatives than the functions above them. The rule is sometimes written as "DETAIL" where D stands for dv .  To demonstrate the LIATE rule, consider the integral       âˆ«   x   cos    x   d  x      .        x      x  d  x       \int x\cos x\,dx.\!     Following the LIATE rule, u = x and dv = cos x dx, hence du = dx and v = sin x , which makes the integral become       x   sin  x    -   âˆ«   1   sin    x   d   x             x    x        1      x  d  x        x\sin x-\int 1\sin x\,dx\!   which equals        x   sin  x    +   cos  x   +  C   .        x    x      x   C    x\sin x+\cos x+C.\!     In general, one tries to choose u and dv such that du is simpler than u and dv is easy to integrate. If instead cos x was chosen as u , and x.dx as dv , we would have the integral          x  2   2    cos  x    +   âˆ«     x  2   2    sin    x   d  x       ,           superscript  x  2   2     x           superscript  x  2   2       x  d  x        \frac{x^{2}}{2}\cos x+\int\frac{x^{2}}{2}\sin x\,dx,     which, after recursive application of the integration by parts formula, would clearly result in an infinite recursion and lead nowhere.  Although a useful rule of thumb, there are exceptions to the LIATE rule. A common alternative is to consider the rules in the "ILATE" order instead. Also, in some cases, polynomial terms need to be split in non-trivial ways. For example, to integrate       âˆ«    x  3     e   x  2     d  x    ,         superscript  x  3    superscript  e   superscript  x  2    d  x     \int x^{3}e^{x^{2}}\,dx,     one would set        u  =   x  2    ,    d  v   =   x    e   x  2     d  x     ,     formulae-sequence    u   superscript  x  2        d  v     x   superscript  e   superscript  x  2    d  x      u=x^{2},\quad dv=xe^{x^{2}}\,dx,     so that         d  u   =   2   x   d  x    ,   v  =    1  2    e   x  2       .     formulae-sequence      d  u     2  x  d  x      v      1  2    superscript  e   superscript  x  2        du=2x\,dx,\quad v=\frac{1}{2}e^{x^{2}}.     Then        âˆ«    x  3     e   x  2     d  x    =   âˆ«    (   x  2   )    (   x   e   x  2     )   d  x    =   âˆ«    u   d  v    =    u  v   -   âˆ«    v   d  u     =     1  2    x  2    e   x  2     -   âˆ«   x    e   x  2     d  x      .             superscript  x  3    superscript  e   superscript  x  2    d  x         superscript  x  2     x   superscript  e   superscript  x  2     d  x             u  d  v             u  v       v  d  u                1  2    superscript  x  2    superscript  e   superscript  x  2         x   superscript  e   superscript  x  2    d  x        \int x^{3}e^{x^{2}}\,dx=\int\left(x^{2}\right)\left(xe^{x^{2}}\right)\,dx=\int
 u%
 \,dv=uv-\int v\,du=\frac{1}{2}x^{2}e^{x^{2}}-\int xe^{x^{2}}\,dx.     Finally, this results in        âˆ«    x  3     e   x  2     d  x    =     1  2    e   x  2     (    x  2   -  1   )    +  C    .           superscript  x  3    superscript  e   superscript  x  2    d  x          1  2    superscript  e   superscript  x  2       superscript  x  2   1    C     \int x^{3}e^{x^{2}}\,dx=\frac{1}{2}e^{x^{2}}(x^{2}-1)+C.     Applications in pure mathematics  Integration by parts is often used as a tool to prove theorems in mathematical analysis . This section gives a few examples.  Use in special functions  The gamma function is an example of a special function , defined as an improper integral . Integration by parts illustrates it to be an extension of the factorial :      Î“   (  z  )       normal-Î“  z    \displaystyle\Gamma(z)     yielding the famous identity        Î“   (  z  )    =    (   z  -  1   )   Î“   (   z  -  1   )     .        normal-Î“  z       z  1   normal-Î“    z  1      \Gamma(z)=(z-1)\Gamma(z-1)\,.     For integer z , applying this formula repeatedly gives the factorial (denoted by the !):       Î“   (   z  +  1   )    =   z  !         normal-Î“    z  1      z     \Gamma(z+1)=z!     Use in harmonic analysis  Integration by parts is often used in harmonic analysis , particularly Fourier analysis , to show that quickly oscillating integrals with sufficiently smooth integrands decay quickly. The most common example of this is its use in showing that the decay of function's Fourier transform depends on the smoothness of that function, as described below.   Fourier transform of derivative   If f is a k -times continuously differentiable function and all derivatives up to the k th one decay to zero at infinity, then its Fourier transform satisfies         (   â„±   f   (  k  )     )    (  Î¾  )    =     (   2  Ï€  i  Î¾   )   k   â„±  f   (  Î¾  )     ,          â„±   superscript  f  k    Î¾      superscript    2  Ï€  i  Î¾   k   â„±  f  Î¾     (\mathcal{F}f^{(k)})(\xi)=(2\pi i\xi)^{k}\mathcal{F}f(\xi),     where is the k th derivative of f . (The exact constant on the right depends on the convention of the Fourier transform used .) This is proved by noting that         d   d  y     e   -   2  Ï€  i  y  Î¾      =   -   2  Ï€  i  Î¾   e   -   2  Ï€  i  y  Î¾        ,          d    d  y     superscript  e      2  Ï€  i  y  Î¾          2  Ï€  i  Î¾   superscript  e      2  Ï€  i  y  Î¾         \frac{d}{dy}e^{-2\pi iy\xi}=-2\pi i\xi e^{-2\pi iy\xi},     so using integration by parts on the Fourier transform of the derivative we get       (   â„±   f  â€²    )    (  Î¾  )         â„±   superscript  f  normal-â€²    Î¾    \displaystyle(\mathcal{F}f^{\prime})(\xi)     Applying this inductively gives the result for general k . A similar method can be used to find the Laplace transform of a derivative of a function.   Decay of Fourier transform   The above result tells us about the decay of the Fourier transform, since it follows that if f and are integrable then       |   â„±  f   (  Î¾  )    |   â‰¤    I   (  f  )     1  +    |   2  Ï€  Î¾   |   k             â„±  f  Î¾        I  f     1   superscript      2  Ï€  Î¾    k       |\mathcal{F}f(\xi)|\leq\frac{I(f)}{1+|2\pi\xi|^{k}}   , where     I   (  f  )    =    âˆ«   -  âˆ   âˆ     (    |   f   (  y  )    |   +   |    f   (  k  )     (  y  )    |    )   d  y          I  f     superscript   subscript                  f  y         superscript  f  k   y     d  y      I(f)=\int_{-\infty}^{\infty}\Bigl(|f(y)|+|f^{(k)}(y)|\Bigr)dy   .  In other words, if f satisfies these conditions then its Fourier transform decays at infinity at least as quickly as Î¾ {{!}} k }} . In particular, if  then the Fourier transform is integrable.  The proof uses the fact, which is immediate from the definition of the Fourier transform , that        |   â„±  f   (  Î¾  )    |   â‰¤    âˆ«   -  âˆ   âˆ     |   f   (  y  )    |   d  y     .          â„±  f  Î¾      superscript   subscript                f  y    d  y      |\mathcal{F}f(\xi)|\leq\int_{-\infty}^{\infty}|f(y)|\,dy.   Using the same idea on the equality stated at the start of this subsection gives        |     (   2  Ï€  i  Î¾   )   k   â„±  f   (  Î¾  )    |   â‰¤    âˆ«   -  âˆ   âˆ     |    f   (  k  )     (  y  )    |   d  y     .           superscript    2  Ï€  i  Î¾   k   â„±  f  Î¾      superscript   subscript                 superscript  f  k   y    d  y      |(2\pi i\xi)^{k}\mathcal{F}f(\xi)|\leq\int_{-\infty}^{\infty}|f^{(k)}(y)|\,dy.   Summing these two inequalities and then dividing by 2 Ï€Î¾ k {{!}}}} gives the stated inequality.  Use in operator theory  One use of integration by parts in operator theory is that it shows that the  (where âˆ† is the Laplace operator ) is a positive operator on (see L p space ). If f is smooth and compactly supported then, using integration by parts, we have       âŸ¨   -   Î”  f    ,  f  âŸ©    L  2      subscript       normal-Î”  f    f    superscript  L  2     \displaystyle\langle-\Delta f,f\rangle_{L^{2}}     Other applications   For determining boundary conditions in Sturmâ€“Liouville theory  Deriving the Eulerâ€“Lagrange equation in the calculus of variations   Recursive integration by parts  Integration by parts can often be applied recursively to provide the following formula        âˆ«    u   (  n  )    v    =        u   (   n  -  1   )    v   -    u   (   n  -  2   )     v  â€²     +    u   (   n  -  3   )     v  â€²â€²     -  â‹¯   +     (   -  1   )    n  -  1    u   v   (   n  -  1   )     +     (   -  1   )   n    âˆ«   u   v   (  n  )         .           superscript  u  n   v               superscript  u    n  1    v      superscript  u    n  2     superscript  v  normal-â€²        superscript  u    n  3     superscript  v  â€²â€²     normal-â‹¯      superscript    1     n  1    u   superscript  v    n  1        superscript    1   n       u   superscript  v  n         \int u^{(n)}v=u^{(n-1)}v-u^{(n-2)}v^{\prime}+u^{(n-3)}v^{\prime\prime}-\cdots+%
 (-1)^{n-1}uv^{(n-1)}+(-1)^{n}\int uv^{(n)}.     This form is especially useful when v ( n ) becomes zero for some n (and, in particular, when v is a polynomial function with degree smaller than n ). Hence, the integral evaluation can stop once the v ( n âˆ’Â 1) term has been reached.  Tabular integration by parts  While the aforementioned recursive definition is correct, it is often tedious to remember and implement. A much easier visual representation of this process is often taught to students and is dubbed either "the tabular method", 2 "the Stand and Deliver method", 3 "rapid repeated integration" or "the tic-tac-toe method". This method works best when one of the two functions in the product is a polynomial, that is, after differentiating it several times one obtains zero. It may also be extended to work for functions that will repeat themselves.  For example, consider the integral       âˆ«    x  3    cos    x   d  x      .         superscript  x  3       x  d  x       \int x^{3}\cos x\,dx.\!     Let u = x 3 . Begin with this function and list in a column all the subsequent derivatives until zero is reached. Secondly, begin with the function v (in this case cos( x )) and list each integral of v until the size of the column is the same as that of u . The result should appear as follows.        Derivatives of u (Column A)   Integrals of v (Column B)            x  3      superscript  x  3    x^{3}\,          cos   x       x    \cos x\,            3    x  2        3   superscript  x  2     3x^{2}\,          sin   x       x    \sin x\,            6   x       6  x    6x\,          -   cos   x          x     -\cos x\,            6    6   6\,          -   sin   x          x     -\sin x\,            0    0   0\,          cos   x       x    \cos x\,          Now simply pair the 1st entry of column A with the 2nd entry of column B, the 2nd entry of column A with the 3rd entry of column B, etc... with alternating signs (beginning with the positive sign). Do so until further pairing leads to sums of zeros. The result is the following (notice the alternating signs in each term):            (  +  )    (   x  3   )    (   sin  x   )    -    (   3   x  2    )    (   -   cos  x    )     +    (   6  x   )    (   -   sin  x    )     -    (  6  )    (   cos  x   )     +   C    .                superscript  x  3     x        3   superscript  x  2        x          6  x       x        6    x     C    (+)(x^{3})(\sin x)-(3x^{2})(-\cos x)+(6x)(-\sin x)-(6)(\cos x)+C\,.     Which, with simplification, leads to the result           x  3    sin  x    +   3   x  2    cos  x     -   6  x   sin  x    -   6   cos  x     +  C   .             superscript  x  3     x      3   superscript  x  2     x       6  x    x      6    x     C    x^{3}\sin x+3x^{2}\cos x-6x\sin x-6\cos x+C.\,     With proper understanding of the tabular method, it can be extended. Consider       âˆ«    e  x    cos    x   d  x      .         superscript  e  x       x  d  x       \int e^{x}\cos x\,dx.           Derivatives of u (Column A)   Integrals of v (Column B)            e  x      superscript  e  x    e^{x}\,          cos   x       x    \cos x\,             e  x      superscript  e  x    e^{x}\,          sin   x       x    \sin x\,             e  x      superscript  e  x    e^{x}\,          -   cos   x          x     -\cos x\,          In this case in the last step it is necessary to integrate the product of the two bottom cells obtaining:        âˆ«    e  x    cos    x   d  x      =      e  x    sin  x    +    e  x    cos  x     -   âˆ«    e  x    cos    x   d  x        ,           superscript  e  x       x  d  x             superscript  e  x     x       superscript  e  x     x          superscript  e  x       x  d  x         \int e^{x}\cos x\,dx=e^{x}\sin x+e^{x}\cos x-\int e^{x}\cos x\,dx,     which leads to         2    âˆ«    e  x    cos    x   d  x       =     e  x    sin  x    +    e  x    cos  x      ,        2       superscript  e  x       x  d  x            superscript  e  x     x       superscript  e  x     x       2\,\int e^{x}\cos x\,dx=e^{x}\sin x+e^{x}\cos x,     and yields the result:        âˆ«    e  x    cos    x   d  x      =      e  x    (    sin  x   +   cos  x    )    2   +  C    .           superscript  e  x       x  d  x             superscript  e  x       x     x     2   C     \int e^{x}\cos x\,dx={e^{x}(\sin x+\cos x)\over 2}+C.\!     Higher dimensions  The formula for integration by parts can be extended to functions of several variables. Instead of an interval one needs to integrate over an n -dimensional set. Also, one replaces the derivative with a partial derivative .        âˆ«  Î©     Ï†    div     v  â†’    d  V      =     âˆ«   âˆ‚  Î©        Ï†    v  â†’    â‹…  d    S  â†’     -    âˆ«  Î©     v  â†’   â‹…   grad    Ï†   d  V             subscript   normal-Î©     Ï†   div     normal-â†’  v   normal-d  V          subscript     normal-Î©       normal-â‹…    Ï†   normal-â†’  v    normal-d    normal-â†’  S       subscript   normal-Î©    normal-â‹…   normal-â†’  v    grad    Ï†  normal-d  V         \int_{\Omega}\varphi\,\operatorname{div}\,\vec{v}\;\mathrm{d}V=\int_{\partial%
 \Omega}\varphi\,\vec{v}\cdot\mathrm{d}\vec{S}-\int_{\Omega}\vec{v}\cdot%
 \operatorname{grad}\,\varphi\;\mathrm{d}V   .  More specifically, suppose Î© is an open  bounded subset of â„ n with a piecewise smooth  boundary Î“. If u and v are two continuously differentiable functions on the closure of Î©, then the formula for integration by parts is         âˆ«  Î©      âˆ‚  u    âˆ‚   x  i      v   d  Î©    =     âˆ«  Î“    u   v      Î½  ^   i    d  Î“    -    âˆ«  Î©    u     âˆ‚  v    âˆ‚   x  i      d  Î©      ,        subscript   normal-Î©         u      subscript  x  i     v  d  normal-Î©        subscript   normal-Î“     u  v   subscript   normal-^  Î½   i   d  normal-Î“      subscript   normal-Î©     u      v      subscript  x  i     d  normal-Î©       \int_{\Omega}\frac{\partial u}{\partial x_{i}}v\,d\Omega=\int_{\Gamma}uv\,\hat%
 {\nu}_{i}\,d\Gamma-\int_{\Omega}u\frac{\partial v}{\partial x_{i}}\,d\Omega,   where    Î½  ^     normal-^  Î½    \hat{\mathbf{\nu}}   is the outward unit surface normal to Î“,     Î½  ^   i     subscript   normal-^  Î½   i    \hat{\nu}_{i}   is its i -th component, and i ranges from 1 to n .  Replacing v in the above formula with v i and summing over i gives the vector formula         âˆ«  Î©    âˆ‡    u  â‹…   ğ¯    d  Î©     =     âˆ«  Î“    u   (   ğ¯  â‹…   Î½  ^    )   d  Î“    -    âˆ«  Î©       u   âˆ‡   â‹…   ğ¯    d  Î©      ,        subscript   normal-Î©    normal-âˆ‡     normal-â‹…  u  ğ¯   d  normal-Î©         subscript   normal-Î“     u   normal-â‹…  ğ¯   normal-^  Î½    d  normal-Î“      subscript   normal-Î©      normal-â‹…    u  normal-âˆ‡   ğ¯   d  normal-Î©       \int_{\Omega}\nabla u\cdot\mathbf{v}\,d\Omega=\int_{\Gamma}u(\mathbf{v}\cdot%
 \hat{\nu})\,d\Gamma-\int_{\Omega}u\,\nabla\cdot\mathbf{v}\,d\Omega,   where v is a vector-valued function with components v 1 , ..., v n .  Setting u equal to the constant function 1 in the above formula gives the divergence theorem         âˆ«  Î“     ğ¯  â‹…    Î½  ^     d  Î“    =    âˆ«  Î©     âˆ‡  â‹…   ğ¯    d  Î©     .        subscript   normal-Î“      normal-â‹…  ğ¯   normal-^  Î½    d  normal-Î“      subscript   normal-Î©      normal-â‹…  normal-âˆ‡  ğ¯   d  normal-Î©      \int_{\Gamma}\mathbf{v}\cdot\hat{\nu}\,d\Gamma=\int_{\Omega}\nabla\cdot\mathbf%
 {v}\,d\Omega.   For    ğ¯  =   âˆ‡  v       ğ¯   normal-âˆ‡  v     \mathbf{v}=\nabla v   where    v  âˆˆ    C  2    (   Î©  Â¯   )        v     superscript  C  2    normal-Â¯  normal-Î©      v\in C^{2}(\bar{\Omega})   , one gets         âˆ«  Î©     âˆ‡  u   â‹…   âˆ‡    v   d  Î©      =     âˆ«  Î“     u    âˆ‡    v  â‹…    Î½  ^     d  Î“      -    âˆ«  Î©     u     âˆ‡  2     v   d  Î©        ,        subscript   normal-Î©    normal-â‹…   normal-âˆ‡  u    normal-âˆ‡    v  d  normal-Î©          subscript   normal-Î“     u   normal-âˆ‡     normal-â‹…  v   normal-^  Î½    d  normal-Î“        subscript   normal-Î©     u    superscript  normal-âˆ‡  2     v  d  normal-Î©         \int_{\Omega}\nabla u\cdot\nabla v\,d\Omega=\int_{\Gamma}u\,\nabla v\cdot\hat{%
 \nu}\,d\Gamma-\int_{\Omega}u\,\nabla^{2}v\,d\Omega,   which is the first Green's identity .  The regularity requirements of the theorem can be relaxed. For instance, the boundary Î“ need only be Lipschitz continuous . In the first formula above, only u , v âˆˆ H 1 (Î©) is necessary (where H 1 is a Sobolev space ); the other formulas have similarly relaxed requirements.  See also   Integration by parts for the Lebesgueâ€“Stieltjes integral  Integration by parts for semimartingales , involving their quadratic covariation.  Integration by substitution  Legendre transformation   Notes    References       External links    Integration by partsâ€”from MathWorld   es:MÃ©todos de integraciÃ³n#MÃ©todo de integraciÃ³n por partes "  Category:Integral calculus     â†©  â†©  â†©     
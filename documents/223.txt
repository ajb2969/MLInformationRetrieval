   Finite volume method      Finite volume method   The finite-volume method (FVM) is a method for representing and evaluating partial differential equations in the form of algebraic equations [LeVeque, 2002; Toro, 1999]. Similar to the finite difference method or finite element method , values are calculated at discrete places on a meshed geometry. "Finite volume" refers to the small volume surrounding each node point on a mesh. In the finite volume method, volume integrals in a partial differential equation that contain a divergence term are converted to surface integrals , using the divergence theorem . These terms are then evaluated as fluxes at the surfaces of each finite volume. Because the flux entering a given volume is identical to that leaving the adjacent volume, these methods are conservative . Another advantage of the finite volume method is that it is easily formulated to allow for unstructured meshes. The method is used in many computational fluid dynamics packages.  1D example  Consider a simple 1D advection problem defined by the following partial differential equation         (  1  )      ∂  ρ    ∂  t    +    ∂  f    ∂  x      =  0   ,   t  ≥  0.      formulae-sequence     1        ρ     t        f     x      0     t  0.     \quad(1)\qquad\qquad\frac{\partial\rho}{\partial t}+\frac{\partial f}{\partial
 x%
 }=0,\quad t\geq 0.     Here,    ρ  =   ρ   (  x  ,  t  )        ρ    ρ   x  t      \rho=\rho\left(x,t\right)   represents the state variable and    f  =   f   (   ρ   (  x  ,  t  )    )        f    f    ρ   x  t       f=f\left(\rho\left(x,t\right)\right)   represents the flux or flow of   ρ   ρ   \rho   . Conventionally, positive   f   f   f   represents flow to the right while negative   f   f   f   represents flow to the left. If we assume that equation (1) represents a flowing medium of constant area, we can sub-divide the spatial domain,   x   x   x   , into finite volumes or cells with cell centres indexed as   i   i   i   . For a particular cell,   i   i   i   , we can define the volume average value of      ρ  i    (  t  )    =   ρ   (  x  ,  t  )           subscript  ρ  i   t     ρ   x  t      {\rho}_{i}\left(t\right)=\rho\left(x,t\right)   at time    t  =   t  1       t   subscript  t  1     {t=t_{1}}   and    x  ∈   [   x   i  -   1  2     ,   x   i  +   1  2     ]       x    subscript  x    i    1  2      subscript  x    i    1  2        {x\in\left[x_{i-\frac{1}{2}},x_{i+\frac{1}{2}}\right]}   , as         (  2  )      ρ  ¯   i    (   t  1   )     =    1    x   i  +   1  2     -   x   i  -   1  2         ∫   x   i  -   1  2      x   i  +   1  2       ρ   (  x  ,   t  1   )   d  x      ,       2     subscript   normal-¯  ρ   i    subscript  t  1         1     subscript  x    i    1  2      subscript  x    i    1  2         superscript   subscript    subscript  x    i    1  2       subscript  x    i    1  2        ρ   x   subscript  t  1    d  x       \quad(2)\qquad\qquad\bar{\rho}_{i}\left(t_{1}\right)=\frac{1}{x_{i+\frac{1}{2}%
 }-x_{i-\frac{1}{2}}}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}\rho\left(x,t_%
 {1}\right)\,dx,     and at time    t  =   t  2       t   subscript  t  2     {t=t_{2}}   as,         (  3  )      ρ  ¯   i    (   t  2   )     =    1    x   i  +   1  2     -   x   i  -   1  2         ∫   x   i  -   1  2      x   i  +   1  2       ρ   (  x  ,   t  2   )   d  x      ,       3     subscript   normal-¯  ρ   i    subscript  t  2         1     subscript  x    i    1  2      subscript  x    i    1  2         superscript   subscript    subscript  x    i    1  2       subscript  x    i    1  2        ρ   x   subscript  t  2    d  x       \quad(3)\qquad\qquad\bar{\rho}_{i}\left(t_{2}\right)=\frac{1}{x_{i+\frac{1}{2}%
 }-x_{i-\frac{1}{2}}}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}\rho\left(x,t_%
 {2}\right)\,dx,     where    x   i  -   1  2       subscript  x    i    1  2      x_{i-\frac{1}{2}}   and    x   i  +   1  2       subscript  x    i    1  2      x_{i+\frac{1}{2}}   represent locations of the upstream and downstream faces or edges respectively of the    i   t  h      superscript  i    t  h     i^{th}   cell.  Integrating equation (1) in time, we have:         (  4  )    ρ   (  x  ,   t  2   )     =    ρ   (  x  ,   t  1   )    -    ∫   t  1    t  2      f  x    (  x  ,  t  )   d  t      ,       4    ρ   x   subscript  t  2          ρ   x   subscript  t  1       superscript   subscript    subscript  t  1     subscript  t  2       subscript  f  x    x  t   d  t       \quad(4)\qquad\qquad\rho\left(x,t_{2}\right)=\rho\left(x,t_{1}\right)-\int_{t_%
 {1}}^{t_{2}}f_{x}\left(x,t\right)\,dt,     where     f  x   =    ∂  f    ∂  x         subscript  f  x       f     x      f_{x}=\frac{\partial f}{\partial x}   .  To obtain the volume average of    ρ   (  x  ,  t  )       ρ   x  t     \rho\left(x,t\right)   at time    t  =   t  2       t   subscript  t  2     t=t_{2}   , we integrate    ρ   (  x  ,   t  2   )       ρ   x   subscript  t  2      \rho\left(x,t_{2}\right)   over the cell volume,    [   x   i  -   1  2     ,   x   i  +   1  2     ]      subscript  x    i    1  2      subscript  x    i    1  2       \left[x_{i-\frac{1}{2}},x_{i+\frac{1}{2}}\right]   and divide the result by     Δ   x  i    =    x   i  +   1  2     -   x   i  -   1  2            normal-Δ   subscript  x  i       subscript  x    i    1  2      subscript  x    i    1  2        \Delta x_{i}=x_{i+\frac{1}{2}}-x_{i-\frac{1}{2}}   , i.e.         (  5  )      ρ  ¯   i    (   t  2   )     =    1   Δ   x  i       ∫   x   i  -   1  2      x   i  +   1  2        {    ρ   (  x  ,   t  1   )    -    ∫   t  1    t  2      f  x    (  x  ,  t  )   d  t     }   d  x      .       5     subscript   normal-¯  ρ   i    subscript  t  2         1    normal-Δ   subscript  x  i       superscript   subscript    subscript  x    i    1  2       subscript  x    i    1  2             ρ   x   subscript  t  1       superscript   subscript    subscript  t  1     subscript  t  2       subscript  f  x    x  t   d  t      d  x       \quad(5)\qquad\qquad\bar{\rho}_{i}\left(t_{2}\right)=\frac{1}{\Delta x_{i}}%
 \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}\left\{\rho\left(x,t_{1}\right)-%
 \int_{t_{1}}^{t_{2}}f_{x}\left(x,t\right)dt\right\}dx.     We assume that   f   f   f   is well behaved and that we can reverse the order of integration. Also, recall that flow is normal to the unit area of the cell. Now, since in one dimension     f  x   ≜   ∇  f      normal-≜   subscript  f  x    normal-∇  f     f_{x}\triangleq\nabla f   , we can apply the divergence theorem , i.e.      ∮  v     ∇  ⋅  f   d  v    =    ∮  S     f   d  S          subscript  contour-integral  v      normal-⋅  normal-∇  f   d  v      subscript  contour-integral  S     f  d  S      \oint_{v}\nabla\cdot fdv=\oint_{S}f\,dS   , and substitute for the volume integral of the divergence with the values of    f   (  x  )       f  x    f(x)   evaluated at the cell surface (edges    x   i  -   1  2       subscript  x    i    1  2      x_{i-\frac{1}{2}}   and    x   i  +   1  2       subscript  x    i    1  2      x_{i+\frac{1}{2}}   ) of the finite volume as follows:         (  6  )      ρ  ¯   i    (   t  2   )     =      ρ  ¯   i    (   t  1   )    -    1   Δ   x  i      (     ∫   t  1    t  2      f   i  +   1  2     d  t    -    ∫   t  1    t  2      f   i  -   1  2     d  t     )      .       6     subscript   normal-¯  ρ   i    subscript  t  2          subscript   normal-¯  ρ   i    subscript  t  1        1    normal-Δ   subscript  x  i         superscript   subscript    subscript  t  1     subscript  t  2       subscript  f    i    1  2     d  t      superscript   subscript    subscript  t  1     subscript  t  2       subscript  f    i    1  2     d  t         \quad(6)\qquad\qquad\bar{\rho}_{i}\left(t_{2}\right)=\bar{\rho}_{i}\left(t_{1}%
 \right)\par
 -\frac{1}{\Delta x_{i}}\left(\int_{t_{1}}^{t_{2}}f_{i+\frac{1}{2}}%
 dt-\int_{t_{1}}^{t_{2}}f_{i-\frac{1}{2}}dt\right).     where     f   i  ±   1  2     =   f   (   x   i  ±   1  2     ,  t  )         subscript  f   plus-or-minus  i    1  2       f    subscript  x   plus-or-minus  i    1  2     t      f_{i\pm\frac{1}{2}}=f\left(x_{i\pm\frac{1}{2}},t\right)   .  We can therefore derive a semi-discrete numerical scheme for the above problem with cell centres indexed as   i   i   i   , and with cell edge fluxes indexed as    i  ±   1  2      plus-or-minus  i    1  2     i\pm\frac{1}{2}   , by differentiating (6) with respect to time to obtain:         (  7  )      d    ρ  ¯   i     d  t    +    1   Δ   x  i      [    f   i  +   1  2     -   f   i  -   1  2      ]      =  0   ,       7        d   subscript   normal-¯  ρ   i      d  t        1    normal-Δ   subscript  x  i      delimited-[]     subscript  f    i    1  2      subscript  f    i    1  2          0    \quad(7)\qquad\qquad\frac{d\bar{\rho}_{i}}{dt}+\frac{1}{\Delta x_{i}}\left[f_{%
 i+\frac{1}{2}}-f_{i-\frac{1}{2}}\right]=0,     where values for the edge fluxes,    f   i  ±   1  2       subscript  f   plus-or-minus  i    1  2      f_{i\pm\frac{1}{2}}   , can be reconstructed by interpolation or extrapolation of the cell averages. Equation (7) is exact for the volume averages; i.e., no approximations have been made during its derivation.  This method can also be applied to a 2D situation by considering the north and south faces along with the east and west faces around a node.  General conservation law  We can also consider the general conservation law problem, represented by the following PDE ,        (  8  )      ∂  𝐮    ∂  t    +    ∇  ⋅  𝐟    (  𝐮  )      =  0.       8        𝐮     t       normal-⋅  normal-∇  𝐟   𝐮     0.    \quad(8)\qquad\qquad{{\partial{\mathbf{u}}}\over{\partial t}}+\nabla\cdot{%
 \mathbf{f}}\left({\mathbf{u}}\right)={\mathbf{0}}.     Here,   𝐮   𝐮   {\mathbf{u}}   represents a vector of states and   𝐟   𝐟   \mathbf{f}   represents the corresponding flux tensor. Again we can sub-divide the spatial domain into finite volumes or cells. For a particular cell,   i   i   i   , we take the volume integral over the total volume of the cell,    v  i     subscript  v  i    v_{i}   , which gives,        (  9  )      ∫   v  i        ∂  𝐮    ∂  t     d  v    +    ∫   v  i      ∇  ⋅  𝐟    (  𝐮  )   d  v      =  0.       9      subscript    subscript  v  i          𝐮     t    d  v      subscript    subscript  v  i       normal-⋅  normal-∇  𝐟   𝐮  d  v      0.    \quad(9)\qquad\qquad\int_{v_{i}}{{\partial{\mathbf{u}}}\over{\partial t}}\,dv+%
 \int_{v_{i}}\nabla\cdot{\mathbf{f}}\left({\mathbf{u}}\right)\,dv={\mathbf{0}}.     On integrating the first term to get the volume average and applying the divergence theorem to the second, this yields         (  10  )      v  i     d    𝐮  ¯   i     d  t     +    ∮   S  i       𝐟   (  𝐮  )    ⋅   𝐧    d  S      =  𝟎   ,       10       subscript  v  i       d   subscript   normal-¯  𝐮   i      d  t       subscript  contour-integral   subscript  S  i       normal-⋅    𝐟  𝐮   𝐧   d  S      0    \quad(10)\qquad\qquad v_{i}{{d{\mathbf{\bar{u}}}_{i}}\over{dt}}+\oint_{S_{i}}{%
 \mathbf{f}}\left({\mathbf{u}}\right)\cdot{\mathbf{n}}\ dS={\mathbf{0}},     where    S  i     subscript  S  i    S_{i}   represents the total surface area of the cell and   𝐧   𝐧   {\mathbf{n}}   is a unit vector normal to the surface and pointing outward. So, finally, we are able to present the general result equivalent to (8), i.e.        (  11  )      d    𝐮  ¯   i     d  t    +    1   v  i      ∮   S  i       𝐟   (  𝐮  )    ⋅   𝐧    d  S       =  0.       11        d   subscript   normal-¯  𝐮   i      d  t        1   subscript  v  i      subscript  contour-integral   subscript  S  i       normal-⋅    𝐟  𝐮   𝐧   d  S       0.    \quad(11)\qquad\qquad{{d{\mathbf{\bar{u}}}_{i}}\over{dt}}+{{1}\over{v_{i}}}%
 \oint_{S_{i}}{\mathbf{f}}\left({\mathbf{u}}\right)\cdot{\mathbf{n}}\ dS={%
 \mathbf{0}}.     Again, values for the edge fluxes can be reconstructed by interpolation or extrapolation of the cell averages. The actual numerical scheme will depend upon problem geometry and mesh construction. MUSCL reconstruction is often used in high resolution schemes where shocks or discontinuities are present in the solution.  Finite volume schemes are conservative as cell averages change through the edge fluxes. In other words, one cell's loss is another cell's gain !  See also   Finite element method  Flux limiter  Godunov's scheme  Godunov's theorem  High-resolution scheme  KIVA (Software)  MIT General Circulation Model  MUSCL scheme  Sergei K. Godunov  Total variation diminishing  Finite volume method for unsteady flow   References   Eymard, R. Gallouët, T. R. Herbin, R. (2000) The finite volume method Handbook of Numerical Analysis, Vol. VII, 2000, p. 713–1020. Editors: P.G. Ciarlet and J.L. Lions.  LeVeque, Randall (2002), Finite Volume Methods for Hyperbolic Problems , Cambridge University Press.  Toro, E. F. (1999), Riemann Solvers and Numerical Methods for Fluid Dynamics , Springer-Verlag.   Further reading   Patankar, Suhas V. (1980), Numerical Heat Transfer and Fluid Flow , Hemisphere.  Hirsch, C. (1990), Numerical Computation of Internal and External Flows, Volume 2: Computational Methods for Inviscid and Viscous Flows , Wiley.  Laney, Culbert B. (1998), Computational Gas Dynamics , Cambridge University Press.  LeVeque, Randall (1990), Numerical Methods for Conservation Laws , ETH Lectures in Mathematics Series, Birkhauser-Verlag.  Tannehill, John C. , et al., (1997), Computational Fluid mechanics and Heat Transfer , 2nd Ed., Taylor and Francis.  Wesseling, Pieter (2001), Principles of Computational Fluid Dynamics , Springer-Verlag.   External links   The finite volume method by R. Eymard, T Gallouët and R. Herbin, update of the article published in Handbook of Numerical Analysis, 2000   , available under the GFDL .  FiPy: A Finite Volume PDE Solver Using Python from NIST.  CLAWPACK : a software package designed to compute numerical solutions to hyperbolic partial differential equations using a wave propagation approach   "  Category:Numerical differential equations  Category:Computational fluid dynamics  Category:Numerical analysis   
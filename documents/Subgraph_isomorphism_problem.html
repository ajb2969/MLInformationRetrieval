<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="973">Subgraph isomorphism problem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Subgraph isomorphism problem</h1>
<hr/>

<p>In <a href="theoretical_computer_science" title="wikilink">theoretical computer science</a>, the <strong>subgraph isomorphism</strong> problem is a computational task in which two <a href="undirected_graph" title="wikilink">graphs</a> <em>G</em> and <em>H</em> are given as input, and one must determine whether <em>G</em> contains a <a href="Glossary_of_graph_theory#Subgraphs" title="wikilink">subgraph</a> that is <a href="graph_isomorphism" title="wikilink">isomorphic</a> to <em>H</em>. Subgraph isomorphism is a generalization of both the <a href="clique_problem" title="wikilink">maximum clique problem</a> and the problem of testing whether a graph contains a <a href="Hamiltonian_cycle" title="wikilink">Hamiltonian cycle</a>, and is therefore <a class="uri" href="NP-complete" title="wikilink">NP-complete</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> However certain other cases of subgraph isomorphism may be solved in polynomial time.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>Sometimes the name <strong>subgraph matching</strong> is also used for the same problem. This name puts emphasis on finding such a subgraph as opposed to the bare decision problem.</p>
<h2 id="decision-problem-and-computational-complexity">Decision problem and computational complexity</h2>

<p>To prove subgraph isomorphism is NP-complete, it must be formulated as a <a href="decision_problem" title="wikilink">decision problem</a>. The input to the decision problem is a pair of graphs <em>G</em> and <em>H</em>. The answer to the problem is positive if <em>H</em> is isomorphic to a subgraph of <em>G</em>, and negative otherwise.</p>

<p>Formal question:</p>

<p>Let 

<math display="inline" id="Subgraph_isomorphism_problem:0">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>V</mi>
    <mo>,</mo>
    <mi>E</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <interval closure="open">
     <ci>V</ci>
     <ci>E</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G=(V,E)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Subgraph_isomorphism_problem:1">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>V</mi>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>E</mi>
     <mo>′</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>E</ci>
      <ci>normal-′</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=(V^{\prime},E^{\prime})
  </annotation>
 </semantics>
</math>

 be graphs. Is there a subgraph 

<math display="inline" id="Subgraph_isomorphism_problem:2">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>G</mi>
     <mn>0</mn>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>V</mi>
      <mn>0</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>E</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>V</mi>
      <mn>0</mn>
     </msub>
     <mo>⊆</mo>
     <mi>V</mi>
    </mrow>
    <mo>,</mo>
    <mrow>
     <msub>
      <mi>E</mi>
      <mn>0</mn>
     </msub>
     <mo>=</mo>
     <mrow>
      <mi>E</mi>
      <mo>∩</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>V</mi>
         <mn>0</mn>
        </msub>
        <mo>×</mo>
        <msub>
         <mi>V</mi>
         <mn>0</mn>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>G</ci>
      <cn type="integer">0</cn>
     </apply>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <cn type="integer">0</cn>
      </apply>
     </interval>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <subset></subset>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>V</ci>
     </apply>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>E</ci>
       <cn type="integer">0</cn>
      </apply>
      <apply>
       <intersect></intersect>
       <ci>E</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">0</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{0}=(V_{0},E_{0}):V_{0}\subseteq V,E_{0}=E\cap(V_{0}\times V_{0})
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Subgraph_isomorphism_problem:3">
 <semantics>
  <mrow>
   <msub>
    <mi>G</mi>
    <mn>0</mn>
   </msub>
   <mo>≅</mo>
   <mi>H</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>G</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>H</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G_{0}\cong H
  </annotation>
 </semantics>
</math>

? I.e., does there exist an 

<math display="inline" id="Subgraph_isomorphism_problem:4">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mo>:</mo>
   <mrow>
    <msub>
     <mi>V</mi>
     <mn>0</mn>
    </msub>
    <mo>→</mo>
    <msup>
     <mi>V</mi>
     <mo>′</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>f</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f\colon V_{0}\rightarrow V^{\prime}
  </annotation>
 </semantics>
</math>

 such that 

<math display="inline" id="Subgraph_isomorphism_problem:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>v</mi>
      <mn>1</mn>
     </msub>
     <mo>,</mo>
     <msub>
      <mi>v</mi>
      <mn>2</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∈</mo>
    <msub>
     <mi>E</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>⇔</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>v</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>v</mi>
        <mn>2</mn>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∈</mo>
    <msup>
     <mi>E</mi>
     <mo>′</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⇔</ci>
    <apply>
     <in></in>
     <interval closure="open">
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </interval>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <cn type="integer">0</cn>
     </apply>
    </apply>
    <apply>
     <in></in>
     <interval closure="open">
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>v</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </interval>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>E</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (v_{1},v_{2})\in E_{0}\Leftrightarrow(f(v_{1}),f(v_{2}))\in E^{\prime}
  </annotation>
 </semantics>
</math>

?</p>

<p>The proof of subgraph isomorphism being NP-complete is simple and based on reduction of the <a href="clique_problem" title="wikilink">clique problem</a>, an NP-complete decision problem in which the input is a single graph <em>G</em> and a number <em>k</em>, and the question is whether <em>G</em> contains a <a href="complete_graph" title="wikilink">complete subgraph</a> with <em>k</em> vertices. To translate this to a subgraph isomorphism problem, simply let <em>H</em> be the complete graph <em>K</em><sub><em>k</em></sub>; then the answer to the subgraph isomorphism problem for <em>G</em> and <em>H</em> is equal to the answer to the clique problem for <em>G</em> and <em>k</em>. Since the clique problem is NP-complete, this <a href="polynomial-time_many-one_reduction" title="wikilink">polynomial-time many-one reduction</a> shows that subgraph isomorphism is also NP-complete.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>An alternative reduction from the <a href="Hamiltonian_path_problem" title="wikilink">Hamiltonian cycle</a> problem translates a graph <em>G</em> which is to be tested for Hamiltonicity into the pair of graphs <em>G</em> and <em>H</em>, where <em>H</em> is a cycle having the same number of vertices as <em>G</em>. Because the Hamiltonian cycle problem is NP-complete even for <a href="planar_graphs" title="wikilink">planar graphs</a>, this shows that subgraph isomorphism remains NP-complete even in the planar case.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>Subgraph isomorphism is a generalization of the <a href="graph_isomorphism_problem" title="wikilink">graph isomorphism problem</a>, which asks whether <em>G</em> is isomorphic to <em>H</em>: the answer to the graph isomorphism problem is true if and only if <em>G</em> and <em>H</em> both have the same numbers of vertices and edges and the subgraph isomorphism problem for <em>G</em> and <em>H</em> is true. However the complexity-theoretic status of graph isomorphism remains an open question.</p>

<p>In the context of the <a href="Aanderaa–Karp–Rosenberg_conjecture" title="wikilink">Aanderaa–Karp–Rosenberg conjecture</a> on the <a href="query_complexity" title="wikilink">query complexity</a> of monotone graph properties,  showed that any subgraph isomorphism problem has query complexity Ω(<em>n</em><sup>3/2</sup>); that is, solving the subgraph isomorphism requires an algorithm to check the presence or absence in the input of Ω(<em>n</em><sup>3/2</sup>) different edges in the graph.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<h2 id="algorithms">Algorithms</h2>

<p>describes a recursive backtracking procedure for solving the subgraph isomorphism problem. Although its running time is, in general, exponential, it takes polynomial time for any fixed choice of <em>H</em> (with a polynomial that depends on the choice of <em>H</em>). When <em>G</em> is a <a href="planar_graph" title="wikilink">planar graph</a> (or more generally a graph whose <a href="shallow_minor" title="wikilink">shallow minors</a> are <a href="sparse_graph" title="wikilink">sparse graphs</a>) and <em>H</em> is fixed, the running time of subgraph isomorphism can be reduced to <a href="linear_time" title="wikilink">linear time</a>.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a>  is a substantial update to the 1976 subgraph isomorphism algorithm paper.</p>
<h2 id="applications">Applications</h2>

<p>As subgraph isomorphism has been applied in the area of <a class="uri" href="cheminformatics" title="wikilink">cheminformatics</a> to find similarities between chemical compounds from their structural formula; often in this area the term <strong>substructure search</strong> is used.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> Typically a <a href="Query_language" title="wikilink">query structure</a> is defined as <a href="Smiles_arbitrary_target_specification" title="wikilink">SMARTS</a>, a <a class="uri" href="SMILES" title="wikilink">SMILES</a> extension.</p>

<p>The closely related problem of counting the number of isomorphic copies of a graph <em>H</em> in a larger graph <em>G</em> has been applied to pattern discovery in databases,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> the <a class="uri" href="bioinformatics" title="wikilink">bioinformatics</a> of protein-protein interaction networks,<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> and in <a href="exponential_random_graph" title="wikilink">exponential random graph</a> methods for mathematically modeling <a href="social_network" title="wikilink">social networks</a>.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a>  describe an application of subgraph isomorphism in the <a href="computer-aided_design" title="wikilink">computer-aided design</a> of <a href="electronic_circuits" title="wikilink">electronic circuits</a>. Subgraph matching is also a substep in <a href="graph_rewriting" title="wikilink">graph rewriting</a> (the most runtime-intensive), and thus offered by <a href="Graph_rewriting#Implementations_and_applications" title="wikilink">graph rewrite tools</a>.</p>

<p>The problem is also of interest in <a href="artificial_intelligence" title="wikilink">artificial intelligence</a>, where it is considered part of an array of <a href="pattern_matching" title="wikilink">pattern matching</a> in graphs problems; an extension of subgraph isomorphism known as <a href="structure_mining" title="wikilink">graph mining</a> is also of interest in that area.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Frequent_subtree_mining" title="wikilink">Frequent subtree mining</a></li>
<li><a href="Induced_subgraph_isomorphism_problem" title="wikilink">Induced subgraph isomorphism problem</a></li>
<li><a href="Maximum_common_edge_subgraph_problem" title="wikilink">Maximum common edge subgraph problem</a></li>
<li><a href="Maximum_common_subgraph_isomorphism_problem" title="wikilink">Maximum common subgraph isomorphism problem</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>. A1.4: GT48, pg.202.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
<li>

<p>.</p></li>
</ul>

<p>"</p>

<p><a href="Category:NP-complete_problems" title="wikilink">Category:NP-complete problems</a> <a href="Category:Graph_algorithms" title="wikilink">Category:Graph algorithms</a> <a href="Category:Computational_problems_in_graph_theory" title="wikilink">Category:Computational problems in graph theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">The original  paper that proves the <a href="Cook–Levin_theorem" title="wikilink">Cook–Levin theorem</a> already showed subgraph isomorphism to be NP-complete, using a reduction from <a class="uri" href="3-SAT" title="wikilink">3-SAT</a> involving cliques.<a href="#fnref1">↩</a></li>
<li id="fn2"></li>
<li id="fn3">.<a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5">Here Ω invokes <a href="Big_O_notation" title="wikilink">Big Omega notation</a>.<a href="#fnref5">↩</a></li>
<li id="fn6">; <a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8">.<a href="#fnref8">↩</a></li>
<li id="fn9">.<a href="#fnref9">↩</a></li>
<li id="fn10">.<a href="#fnref10">↩</a></li>
<li id="fn11"><a class="uri" href="http://www.aaai.org/Papers/Symposia/Fall/2006/FS-06-02/FS06-02-007.pdf">http://www.aaai.org/Papers/Symposia/Fall/2006/FS-06-02/FS06-02-007.pdf</a>; expanded version at <a class="uri" href="https://e-reports-ext.llnl.gov/pdf/332302.pdf">https://e-reports-ext.llnl.gov/pdf/332302.pdf</a><a href="#fnref11">↩</a></li>
</ol>
</section>
</body>
</html>

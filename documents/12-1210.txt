   Universal variable formulation      Universal variable formulation   In orbital mechanics , the universal variable formulation is a method used to solve the two-body  Kepler problem . It is a generalized form of Kepler's Equations , extending them to apply not only to elliptic orbits , but also parabolic and hyperbolic orbits . It thus is applicable to many situations in the solar system , where orbits of widely varying eccentricities are present.  Introduction  A common problem in orbital mechanics is the following: given a body in an orbit and a time t 0 , find the position of the body at any other given time t . For elliptical orbits with a reasonably small eccentricity , solving Kepler's Equation by methods like Newton's method gives adequate results. However, as the orbit becomes more and more eccentric, the numerical iteration may start to converge slowly or not at all. 1 Furthermore, Kepler's equation cannot be applied to parabolic and hyperbolic orbits , since it specifically is tailored to elliptic orbits.  Derivation  Although equations similar to Kepler's equation can be derived for parabolic and hyperbolic orbits, it is more convenient to introduce a new independent variable to take the place of the eccentric anomaly  E , and having a single equation that can be solved regardless of the eccentricity of the orbit. The new variable s is defined by the following differential equation :        d  s    d  t    =   1  r           d  s     d  t      1  r     \frac{ds}{dt}=\frac{1}{r}   where    r  =   r   (  t  )        r    r  t     r=r(t)   is the time-dependent distance to the center of attraction. The fundamental equation        d  2   𝐫    d   t  2     +   μ   𝐫   r  3      =  𝟎             superscript  d  2   𝐫     d   superscript  t  2       μ    𝐫   superscript  r  3      0    \frac{d^{2}\mathbf{r}}{dt^{2}}+\mu\frac{\mathbf{r}}{r^{3}}=\mathbf{0}   is regularized by applying this change of variables to yield: 2          d  2   𝐫    d   s  2     +    α   𝐫    =   -  𝐏              superscript  d  2   𝐫     d   superscript  s  2       α  𝐫      𝐏     \frac{d^{2}\mathbf{r}}{ds^{2}}+\alpha\ \mathbf{r}=-\mathbf{P}   where P is a constant vector and   α   α   \alpha   is defined by      α  =   μ  a       α    μ  a     \alpha=\frac{\mu}{a}   The equation is the same as the equation for the harmonic oscillator , a well-known equation in both physics and mathematics . Taking the derivative again, we get a third-degree differential equation:          d  3   𝐫    d   s  3     +   α    d  𝐫    d  s      =  𝟎             superscript  d  3   𝐫     d   superscript  s  3       α      d  𝐫     d  s      0    \frac{d^{3}\mathbf{r}}{ds^{3}}+\alpha\frac{d\mathbf{r}}{ds}=\mathbf{0}   The family of solutions to this differential equation 3 are written symbolically as the functions     1  ,    s    c  1    (   α   s  2    )    ,     s  2     c  2    (   α   s  2    )     ,     1    s   subscript  c  1     α   superscript  s  2        superscript  s  2    subscript  c  2     α   superscript  s  2       1,\ s\ c_{1}(\alpha s^{2}),\ s^{2}\ c_{2}(\alpha s^{2}),   where the functions      c   k    (  x  )        subscript  c  k   x    \ c_{k}(x)   , called Stumpff functions , are generalizations of sine and cosine functions. Applying this results in: 4       t  -   t  0    =      r  0     s    c  1    (   α   s  2    )    +    r  0      d   r  0     d  t       s  2     c  2    (   α   s  2    )    +    μ     s  3     c  3    (   α   s  2    )           t   subscript  t  0         subscript  r  0   s   subscript  c  1     α   superscript  s  2        subscript  r  0       d   subscript  r  0      d  t     superscript  s  2    subscript  c  2     α   superscript  s  2       μ   superscript  s  3    subscript  c  3     α   superscript  s  2        t-t_{0}=r_{0}\ s\ c_{1}(\alpha s^{2})+r_{0}\frac{dr_{0}}{dt}\ s^{2}\ c_{2}(%
 \alpha s^{2})+\mu\ s^{3}\ c_{3}(\alpha s^{2})   which is the universal variable formulation of Kepler's Equation. This equation can now be solved numerically using a root-finding algorithm such as Newton's method or Laguerre's method for a given time   t   t   t   to yield   s   s   s   , which in turn is used to compute the f and g functions :      f   (  s  )       f  s    \displaystyle f(s)   The values of the f and g functions determine the position of the body at the time   t   t   t   :      𝐫  =      𝐫  0    f   (  s  )    +     𝐯  0    g   (  s  )         𝐫       subscript  𝐫  0   f  s      subscript  𝐯  0   g  s      \mathbf{r}=\mathbf{r}_{0}\ f(s)+\mathbf{v}_{0}\ g(s)   In addition the velocity of the body at time   t   t   t   can be found using     f  ˙    (  s  )        normal-˙  f   s    \dot{f}(s)   and     g  ˙    (  s  )        normal-˙  g   s    \dot{g}(s)   as follows:      𝐯  =      𝐫  0     f  ˙    (  s  )    +     𝐯  0     g  ˙    (  s  )         𝐯       subscript  𝐫  0    normal-˙  f   s      subscript  𝐯  0    normal-˙  g   s      \mathbf{v}=\mathbf{r}_{0}\ \dot{f}(s)+\mathbf{v}_{0}\ \dot{g}(s)     where   𝐫   𝐫   \mathbf{r}   and   𝐯   𝐯   \mathbf{v}   are the position and velocity respectively at time   t   t   t   , and    𝐫  0     subscript  𝐫  0    \mathbf{r}_{0}   and    𝐯  0     subscript  𝐯  0    \mathbf{v}_{0}   are the position and velocity, respectively, at arbitrary initial time    t  0     subscript  t  0    t_{0}   .  References  "  Category:Orbits     ↩    Equation 6.9.26 ↩     
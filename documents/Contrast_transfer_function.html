<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1049">Contrast transfer function</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Contrast transfer function</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>Typical contrast transfer function observed from an electron micrograph</figcaption>
</figure>

<p>The <strong>contrast transfer function</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> mathematically describes how aberrations in a <a href="transmission_electron_microscope" title="wikilink">transmission electron microscope</a> modify the image of a sample. This <strong>contrast transfer function</strong> <strong>(CTF)</strong> sets the resolution of <strong><a href="High-resolution_transmission_electron_microscopy" title="wikilink">High-Resolution Transmission Electron Microscopy (HRTEM)</a>,</strong> also known as phase contrast TEM.</p>

<p>By considering the recorded image as a CTF-degraded true object, describing the CTF allows the true object to be reverse-engineered. This is typically denoted CTF-correction, and is vital to obtain high resolution structures in three-dimensional electron microscopy, especially <a href="cryo-electron_microscopy" title="wikilink">cryo-electron microscopy</a>. Its equivalent in light-based optics, is the <a href="optical_transfer_function" title="wikilink">optical transfer function</a>.</p>
<h2 id="phase-contrast-in-hrtem">Phase Contrast in HRTEM</h2>

<p>The contrast in <strong>HRTEM</strong> comes from interference in the image plane between the phases of scattered electron waves with the phase of the transmitted electron wave. When an electron wave passes through a sample in the TEM, complex interactions occur. Above the sample, the electron wave can be approximated as a plane wave. As the electron wave, or wavefunction, passes through the sample, both the phase and the amplitude of the electron beam is altered. The resultant scattered and transmitted electron beam is then focused by an objective lens, and imaged by a detector in the image plane.</p>

<p>Detectors are only able to directly measure the amplitude, not the phase. However, with the correct microscope parameters, the phase interference can be indirectly measured via the intensity in the image plane. Electrons interact very strongly with crystalline solids. As a result, the phase changes due to very small features, down to the atomic scale, can be recorded via HRTEM.</p>
<h2 id="contrast-transfer-theory">Contrast Transfer Theory</h2>
<figure><b>(Figure)</b>
<embed src="TEM Ray Diagram with Phase Contrast Transfer Function.pdf" title="TEM Ray Diagram with Phase Contrast Transfer Function"></embed><figcaption>TEM Ray Diagram with Phase Contrast Transfer Function</figcaption>
</figure>

<p><strong>Contrast Transfer Theory</strong> provides a quantitative method to translate the exit wavefunction to a final image. Part of the analysis is based on Fourier transforms of the electron beam wavefunction. When an electron wavefunction passes through a lens, the wavefunction goes through a <a href="Fourier_transform" title="wikilink">Fourier transform</a>. This is a concept from <a href="Fourier_optics" title="wikilink">Fourier optics</a>.</p>

<p>Contrast Transfer Theory consists of four main operations:<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>
<ol>
<li>Take the Fourier transform of the exit wave to obtain the wave amplitude in back focal plane of objective lens</li>
<li>Modify the wavefunction in reciprocal space by a phase factor, also known as the <strong>Phase Contrast Transfer Function</strong>, to account for aberrations</li>
<li>Inverse Fourier transform the modified wavefunction to obtain the wavefunction in the image plane</li>
<li>Find the square modulus of the wavefunction in the image plane to find the image intensity (this is the signal that is recorded on a detector, and creates an image)</li>
</ol>
<h2 id="mathematical-form">Mathematical form</h2>

<p>If we incorporate some assumptions about our sample, then an analytical expression can be found for both <strong>phase contrast</strong> and the phase <strong>contrast transfer function</strong>. As discussed earlier, when the electron wave passes through a sample, the electron beam interacts with the sample via scattering, and experiences a phase shift. This is represented by the electron wavefunction exiting from the bottom of the sample. This expression assumes that the scattering causes a phase shift (and no amplitude shift). This is called the <strong>Phase Object Approximation.</strong></p>
<h3 id="the-exit-wavefunction">The Exit Wavefunction</h3>

<p>Following Wade's notation,<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> the exit wavefunction expression is represented by:</p>

<p>

<math display="block" id="Contrast_transfer_function:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>τ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>τ</mi>
     <mi>o</mi>
    </msub>
    <mi>e</mi>
    <mi>x</mi>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>i</mi>
       <mi>π</mi>
       <mi>λ</mi>
       <mrow>
        <mo largeop="true" symmetric="true">∫</mo>
        <mrow>
         <mi>d</mi>
         <msup>
          <mi>z</mi>
          <mo>′</mo>
         </msup>
         <mi>U</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>r</mi>
          <mo>,</mo>
          <msup>
           <mi>z</mi>
           <mo>′</mo>
          </msup>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>τ</ci>
     <interval closure="open">
      <ci>r</ci>
      <ci>z</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>τ</ci>
      <ci>o</ci>
     </apply>
     <ci>e</ci>
     <ci>x</ci>
     <ci>p</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>π</ci>
        <ci>λ</ci>
        <apply>
         <int></int>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>normal-′</ci>
          </apply>
          <ci>U</ci>
          <interval closure="open">
           <ci>r</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <ci>normal-′</ci>
           </apply>
          </interval>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau(r,z)=\tau_{o}exp[-i\pi\lambda\int dz^{\prime}U(r,z^{\prime})]
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Contrast_transfer_function:1">
 <semantics>
  <mrow>
   <msub>
    <mi>τ</mi>
    <mi>o</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>τ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mn>0</mn>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>τ</ci>
     <ci>o</ci>
    </apply>
    <apply>
     <times></times>
     <ci>τ</ci>
     <interval closure="open">
      <ci>r</ci>
      <cn type="integer">0</cn>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{o}=\tau(r,0)
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Contrast_transfer_function:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>U</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>m</mi>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>r</mi>
      <mo>,</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>/</mo>
    <msup>
     <mi>h</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>U</ci>
     <interval closure="open">
      <ci>r</ci>
      <ci>z</ci>
     </interval>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>m</ci>
      <ci>V</ci>
      <interval closure="open">
       <ci>r</ci>
       <ci>z</ci>
      </interval>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>h</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(r,z)=2mV(r,z)/h^{2}
  </annotation>
 </semantics>
</math>

</p>

<p>Where the exit wavefunction τ is a function of both 

<math display="inline" id="Contrast_transfer_function:3">
 <semantics>
  <mi>r</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>r</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r
  </annotation>
 </semantics>
</math>

 in the plane of the sample, and 

<math display="inline" id="Contrast_transfer_function:4">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 perpendicular to the plane of the sample. 

<math display="inline" id="Contrast_transfer_function:5">
 <semantics>
  <msub>
   <mi>τ</mi>
   <mi>o</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>τ</ci>
    <ci>o</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau_{o}
  </annotation>
 </semantics>
</math>

 represents the wavefunction incident on the top of the sample. 

<math display="inline" id="Contrast_transfer_function:6">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/quantum/debrog2.html#c1">is the wavelength of the electron beam</a>, which is set by the accelerating voltage. 

<math display="inline" id="Contrast_transfer_function:7">
 <semantics>
  <mi>U</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>U</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U
  </annotation>
 </semantics>
</math>

 is the effective potential of the sample, which depends on the atomic potentials within the crystal, represented by 

<math display="inline" id="Contrast_transfer_function:8">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

.</p>

<p>Within the exit wavefunction, the phase shift is represented by:</p>

<p>

<math display="block" id="Contrast_transfer_function:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>ϕ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>π</mi>
    <mi>λ</mi>
    <mrow>
     <mo largeop="true" symmetric="true">∫</mo>
     <mrow>
      <mi>d</mi>
      <msup>
       <mi>z</mi>
       <mo>′</mo>
      </msup>
      <mi>U</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>r</mi>
       <mo>,</mo>
       <msup>
        <mi>z</mi>
        <mo>′</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ϕ</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <times></times>
     <ci>π</ci>
     <ci>λ</ci>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>U</ci>
       <interval closure="open">
        <ci>r</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>normal-′</ci>
        </apply>
       </interval>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \phi(r)=\pi\lambda\int dz^{\prime}U(r,z^{\prime})
  </annotation>
 </semantics>
</math>

</p>

<p>This expression can be further simplified taken into account some more assumptions about the sample. If the sample is considered very thin, and a weak scatterer, so that the phase shift is  This approximation is called the <strong>Weak Phase Object Approximation.</strong></p>

<p>The exit wavefunction can then be expressed as:</p>

<p>

<math display="block" id="Contrast_transfer_function:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>τ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo>,</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>τ</mi>
     <mi>o</mi>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mrow>
       <mi>i</mi>
       <mi>ϕ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>r</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>τ</ci>
     <interval closure="open">
      <ci>r</ci>
      <ci>z</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>τ</ci>
      <ci>o</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>ϕ</ci>
        <ci>r</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau(r,z)=\tau_{o}[1+i\phi(r)]
  </annotation>
 </semantics>
</math>

</p>
<h3 id="the-phase-contrast-transfer-function">The Phase Contrast Transfer Function</h3>

<p>Passing through the objective lens incurs a Fourier transform and phase shift. As such, the wavefunction on the back focal plane of the objective lens can be represented by:<br/>


<math display="block" id="Contrast_transfer_function:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>I</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>δ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi mathvariant="normal">Φ</mi>
     <mi>K</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>I</ci>
     <ci>θ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>δ</ci>
      <ci>θ</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Φ</ci>
      <ci>K</ci>
      <ci>θ</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I(\theta)=\delta(\theta)+\Phi K(\theta)
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Contrast_transfer_function:12">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 = the scattering angle between the transmitted electron wave and the scattered electron wave</p>

<p>

<math display="inline" id="Contrast_transfer_function:13">
 <semantics>
  <mi>δ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>δ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta
  </annotation>
 </semantics>
</math>

 = a <a href="delta_function" title="wikilink">delta function</a> representing the non-scattered, transmitted, electron wave</p>

<p>

<math display="inline" id="Contrast_transfer_function:14">
 <semantics>
  <mi mathvariant="normal">Φ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Φ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Phi
  </annotation>
 </semantics>
</math>

 = the Fourier transform of the wavefunction's phase</p>

<p>

<math display="inline" id="Contrast_transfer_function:15">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>K</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K(\theta)
  </annotation>
 </semantics>
</math>

 = the phase shift incurred by the microscope's aberrations, also known as the <strong>Contrast Transfer Function:</strong></p>

<p>

<math display="block" id="Contrast_transfer_function:16">
 <semantics>
  <mrow>
   <mrow>
    <mi>K</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>s</mi>
    <mi>i</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>π</mi>
        </mrow>
        <mo>/</mo>
        <mi>λ</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>W</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>θ</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>K</ci>
     <ci>θ</ci>
    </apply>
    <apply>
     <times></times>
     <ci>s</ci>
     <ci>i</ci>
     <ci>n</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>π</ci>
        </apply>
        <ci>λ</ci>
       </apply>
       <ci>W</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K(\theta)=sin[(2\pi/\lambda)W(\theta)]
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Contrast_transfer_function:17">
 <semantics>
  <mrow>
   <mrow>
    <mi>W</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>θ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>z</mi>
       <msup>
        <mi>θ</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>C</mi>
       <mi>s</mi>
      </msub>
      <msup>
       <mi>θ</mi>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>/</mo>
     <mn>4</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>W</ci>
     <ci>θ</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>z</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>θ</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W(\theta)=-z\theta^{2}/2+C_{s}\theta^{4}/4
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Contrast_transfer_function:18">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 = the relativistic wavelength of the electron wave, 

<math display="inline" id="Contrast_transfer_function:19">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{s}
  </annotation>
 </semantics>
</math>

 = The <a href="spherical_aberration" title="wikilink">spherical aberration</a> of the objective lens</p>

<p><br/>
The contrast transfer function can also be given in terms of spatial frequencies, or reciprocal space. With the relationship 

<math display="inline" id="Contrast_transfer_function:20">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>=</mo>
   <mrow>
    <mi>λ</mi>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>θ</ci>
    <apply>
     <times></times>
     <ci>λ</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta=\lambda k
  </annotation>
 </semantics>
</math>

, the phase contrast transfer function becomes:</p>

<p>

<math display="block" id="Contrast_transfer_function:21">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mi>s</mi>
   <mi>i</mi>
   <mi>n</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mn>2</mn>
    <mi>π</mi>
    <mi>λ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>W</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">K</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <csymbol cd="unknown">s</csymbol>
    <csymbol cd="unknown">i</csymbol>
    <csymbol cd="unknown">n</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <cn type="integer">2</cn>
     <csymbol cd="unknown">π</csymbol>
     <csymbol cd="unknown">λ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">W</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-]</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K(k)=sin[2\pi\lambda)W(k)]
  </annotation>
 </semantics>
</math>

<br/>


<math display="inline" id="Contrast_transfer_function:22">
 <semantics>
  <mrow>
   <mrow>
    <mi>W</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mi>z</mi>
       <mi>λ</mi>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>C</mi>
      <mi>s</mi>
     </msub>
     <msup>
      <mi>λ</mi>
      <mn>3</mn>
     </msup>
     <msup>
      <mi>k</mi>
      <mn>4</mn>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>W</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>z</ci>
        <ci>λ</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>k</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W(k)=-z\lambda k^{2}/2+C_{s}\lambda^{3}k^{4}
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="Contrast_transfer_function:23">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

 = the defocus of the objective lens (using the convention that underfocus is positive and overfocus is negative), 

<math display="inline" id="Contrast_transfer_function:24">
 <semantics>
  <mi>λ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>λ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lambda
  </annotation>
 </semantics>
</math>

 = the relativistic wavelength of the electron wave, 

<math display="inline" id="Contrast_transfer_function:25">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{s}
  </annotation>
 </semantics>
</math>

 = The <a href="spherical_aberration" title="wikilink">spherical aberration</a> of the objective lens, 

<math display="inline" id="Contrast_transfer_function:26">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 = the spatial frequency (units of m<sup>−1</sup>)</p>
<h3 id="spherical-aberration">Spherical aberration</h3>

<p><a href="Spherical_aberration" title="wikilink">Spherical aberration</a> is a blurring effect arising when a lens is not able to converge incoming rays at higher angles of incidence to the focus point, but rather focuses them to a point closer to the lens. This will have the effect of spreading an imaged point (which is ideally imaged as a single point in the gaussian image plane) out over a finite size disc in the image plane. Giving the measure of aberration in a plane normal to the optical axis is called a transversal aberration. The size (radius) of the aberration disc in this plane can be shown to be proportional to the cube of the incident angle (θ) under the small-angle approximation, and that the explicit form in this case is</p>

<p>

<math display="block" id="Contrast_transfer_function:27">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mi>s</mi>
    </msub>
    <mo>⋅</mo>
    <msup>
     <mi>θ</mi>
     <mn>3</mn>
    </msup>
    <mo>⋅</mo>
    <mi>M</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>s</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>M</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{s}=C_{s}\cdot\theta^{3}\cdot M
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Contrast_transfer_function:28">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{s}
  </annotation>
 </semantics>
</math>

 is the spherical aberration and 

<math display="inline" id="Contrast_transfer_function:29">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

 is the magnification, both effectively being constants of the lens settings. One can then go on to note that the difference in refracted angle between an ideal ray and one which suffers from spherical aberration, is</p>

<p>

<math display="block" id="Contrast_transfer_function:30">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>arctan</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>b</mi>
       <mi>R</mi>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>arctan</mi>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mi>b</mi>
       <mrow>
        <mi>R</mi>
        <mo>+</mo>
        <msub>
         <mi>r</mi>
         <mi>s</mi>
        </msub>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <arctan></arctan>
      <apply>
       <divide></divide>
       <ci>b</ci>
       <ci>R</ci>
      </apply>
     </apply>
     <apply>
      <arctan></arctan>
      <apply>
       <divide></divide>
       <ci>b</ci>
       <apply>
        <plus></plus>
        <ci>R</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <ci>s</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{s}=\arctan\left(\frac{b}{R}\right)-\arctan\left(\frac{b}{R+r_{s}}\right)
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Contrast_transfer_function:31">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 is the distance from the lens to the gaussian image plane and 

<math display="inline" id="Contrast_transfer_function:32">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 is the radial distance from the optical axis to the point on the lens which the ray passed through. Simplifying this further (without applying any approximations) shows that</p>

<p>

<math display="block" id="Contrast_transfer_function:33">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>arctan</mi>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mrow>
       <mi>b</mi>
       <msub>
        <mi>r</mi>
        <mi>s</mi>
       </msub>
      </mrow>
      <mrow>
       <msup>
        <mi>R</mi>
        <mn>2</mn>
       </msup>
       <mo>+</mo>
       <mrow>
        <mi>R</mi>
        <msub>
         <mi>r</mi>
         <mi>s</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <msup>
        <mi>b</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <arctan></arctan>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>b</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>R</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{s}=\arctan\left(\frac{br_{s}}{R^{2}+Rr_{s}+b^{2}}\right)
  </annotation>
 </semantics>
</math>

 Two approximations can now be applied to proceed further in a straight forward manner. They rely on the assumption that both 

<math display="inline" id="Contrast_transfer_function:34">
 <semantics>
  <msub>
   <mi>r</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>r</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{s}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Contrast_transfer_function:35">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 are much smaller than 

<math display="inline" id="Contrast_transfer_function:36">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

, which is equivalent to stating that we are considering relatively small angles of incidence and consequently also very small spherical aberrations. Under such an assumption, the two leading terms in the denominator are insignificant, and can be approximated as not contributing. By way of these assumptions we have also implicitly stated that the fraction itself can be considered small, and this results in the elimination of the 

<math display="inline" id="Contrast_transfer_function:37">
 <semantics>
  <mrow>
   <mi>arctan</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <arctan></arctan>
    <list></list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \arctan()
  </annotation>
 </semantics>
</math>

 function by way of the small-angle approximation;</p>

<p>

<math display="block" id="Contrast_transfer_function:38">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>s</mi>
   </msub>
   <mo>≈</mo>
   <mrow>
    <mi>arctan</mi>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mrow>
       <mi>b</mi>
       <msub>
        <mi>r</mi>
        <mi>s</mi>
       </msub>
      </mrow>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mi>b</mi>
     <msub>
      <mi>r</mi>
      <mi>s</mi>
     </msub>
    </mrow>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>r</mi>
     <mi>s</mi>
    </msub>
    <mi>b</mi>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>C</mi>
      <mi>s</mi>
     </msub>
     <mo>⋅</mo>
     <msup>
      <mi>θ</mi>
      <mn>3</mn>
     </msup>
     <mo>⋅</mo>
     <mi>M</mi>
    </mrow>
    <mi>b</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>α</ci>
      <ci>s</ci>
     </apply>
     <apply>
      <arctan></arctan>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>b</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <ci>s</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>b</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>r</ci>
        <ci>s</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>r</ci>
       <ci>s</ci>
      </apply>
      <ci>b</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>C</ci>
        <ci>s</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>M</ci>
      </apply>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{s}\approx\arctan\left(\frac{br_{s}}{b^{2}}\right)\approx\frac{br_{s}}{%
b^{2}}=\frac{r_{s}}{b}=\frac{C_{s}\cdot\theta^{3}\cdot M}{b}
  </annotation>
 </semantics>
</math>

 If the image is considered to be approximately in focus, and the angle of incidence 

<math display="inline" id="Contrast_transfer_function:39">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 is again considered small, then</p>

<p>

<math display="block" id="Contrast_transfer_function:40">
 <semantics>
  <mrow>
   <mfrac>
    <mi>R</mi>
    <mi>f</mi>
   </mfrac>
   <mo>≈</mo>
   <mrow>
    <mi>tan</mi>
    <mrow>
     <mo>(</mo>
     <mi>θ</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mpadded width="+6.6pt">
     <mi>θ</mi>
    </mpadded>
    <mpadded width="+6.6pt">
     <mtext>and</mtext>
    </mpadded>
    <mi>M</mi>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mi>b</mi>
    <mi>f</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <divide></divide>
      <ci>R</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <tan></tan>
      <ci>θ</ci>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>θ</ci>
      <mtext>and</mtext>
      <ci>M</ci>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <ci>b</ci>
      <ci>f</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{R}{f}\approx\tan\left(\theta\right)\approx\theta~{}~{}\text{and}~{}~{}M%
\approx\frac{b}{f}
  </annotation>
 </semantics>
</math>

 meaning that an approximate expression for the difference in refracted angle between an ideal ray and one which suffers from spherical aberration, is given by</p>

<p>

<math display="block" id="Contrast_transfer_function:41">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>s</mi>
   </msub>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <msub>
      <mi>C</mi>
      <mi>s</mi>
     </msub>
     <mo>⋅</mo>
     <msup>
      <mi>R</mi>
      <mn>3</mn>
     </msup>
    </mrow>
    <msup>
     <mi>f</mi>
     <mn>4</mn>
    </msup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>s</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>R</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">4</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{s}\approx\frac{C_{s}\cdot R^{3}}{f^{4}}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="defocus">Defocus</h3>

<p>As opposed to the spherical aberration, we will proceed by estimating the deviation of a defocused ray from the ideal by stating the longitudal aberration; a measure of how much a ray deviates from the focal point along the optical axis. Denoting this distance 

<math display="inline" id="Contrast_transfer_function:42">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>b</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>b</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta b
  </annotation>
 </semantics>
</math>

, it is possible to show that the difference 

<math display="inline" id="Contrast_transfer_function:43">
 <semantics>
  <msub>
   <mi>α</mi>
   <mi>f</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{f}
  </annotation>
 </semantics>
</math>

 in refracted angle between rays originating from a focused and defocused object, can be related to the refracted angle as<br/>


<math display="block" id="Contrast_transfer_function:44">
 <semantics>
  <mrow>
   <mrow>
    <msqrt>
     <mrow>
      <msup>
       <mi>R</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </msqrt>
    <mo>⋅</mo>
    <mrow>
     <mi>sin</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>α</mi>
       <mi>f</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>b</mi>
    </mrow>
    <mo>⋅</mo>
    <mrow>
     <mi>sin</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>θ</mi>
        <mo>′</mo>
       </msup>
       <mo>-</mo>
       <msub>
        <mi>α</mi>
        <mi>f</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <sin></sin>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>f</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <sin></sin>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>θ</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <ci>f</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{R^{2}+b^{2}}\cdot\sin(\alpha_{f})=\Delta b\cdot\sin(\theta^{\prime}-%
\alpha_{f})
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Contrast_transfer_function:45">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Contrast_transfer_function:46">
 <semantics>
  <mi>b</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>b</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b
  </annotation>
 </semantics>
</math>

 are defined in the same way as they were for spherical aberration. Assuming that 

<math display="inline" id="Contrast_transfer_function:47">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>f</mi>
   </msub>
   <mo>≪</mo>
   <msup>
    <mi>θ</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>θ</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{f}<<\theta^{\prime}
  </annotation>
 </semantics>
</math>

 (or equivalently that 

<math display="inline" id="Contrast_transfer_function:48">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mi>b</mi>
     <mo>⋅</mo>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>α</mi>
        <mi>f</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>≪</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mi>R</mi>
    <mo stretchy="false">|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">much-less-than</csymbol>
    <apply>
     <abs></abs>
     <apply>
      <ci>normal-⋅</ci>
      <ci>b</ci>
      <apply>
       <sin></sin>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <ci>f</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <abs></abs>
     <ci>R</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |b\cdot\sin(\alpha_{f})|<<|R|
  </annotation>
 </semantics>
</math>

 ), we can show that<br/>


<math display="block" id="Contrast_transfer_function:49">
 <semantics>
  <mrow>
   <mrow>
    <mi>sin</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>α</mi>
      <mi>f</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>b</mi>
     <mrow>
      <mi>sin</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>θ</mi>
        <mo>′</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <msqrt>
     <mrow>
      <msup>
       <mi>R</mi>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>b</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </msqrt>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>b</mi>
     </mrow>
     <mo>⋅</mo>
     <mi>R</mi>
    </mrow>
    <mrow>
     <msup>
      <mi>R</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>b</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <sin></sin>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>α</ci>
       <ci>f</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>b</ci>
       <apply>
        <sin></sin>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>θ</ci>
         <ci>normal-′</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>R</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>b</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>b</ci>
       </apply>
       <ci>R</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>R</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>b</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sin(\alpha_{f})\approx\frac{\Delta b\sin(\theta^{\prime})}{\sqrt{R^{2}+b^{2}}%
}=\frac{\Delta b\cdot R}{R^{2}+b^{2}}
  </annotation>
 </semantics>
</math>

 Since we required 

<math display="inline" id="Contrast_transfer_function:50">
 <semantics>
  <msub>
   <mi>α</mi>
   <mi>f</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>α</ci>
    <ci>f</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{f}
  </annotation>
 </semantics>
</math>

 to be small, and since 

<math display="inline" id="Contrast_transfer_function:51">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 being small implies 

<math display="block" id="Contrast_transfer_function:52">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>f</mi>
   </msub>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>b</mi>
     </mrow>
     <mo>⋅</mo>
     <mi>R</mi>
    </mrow>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>b</ci>
      </apply>
      <ci>R</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{f}\approx\frac{\Delta b\cdot R}{b^{2}}
  </annotation>
 </semantics>
</math>

 as<br/>


<math display="inline" id="Contrast_transfer_function:53">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>b</mi>
    </mrow>
    <mo>/</mo>
    <msup>
     <mi>b</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>≈</mo>
   <mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>f</mi>
    </mrow>
    <mo>/</mo>
    <msup>
     <mi>f</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>b</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>b</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta b/b^{2}\approx\Delta f/f^{2}
  </annotation>
 </semantics>
</math>

 From the <a href="thin-lens_formula" title="wikilink">thin-lens formula</a> it can be shown that 

<math display="block" id="Contrast_transfer_function:54">
 <semantics>
  <mrow>
   <msub>
    <mi>α</mi>
    <mi>f</mi>
   </msub>
   <mo>≈</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>f</mi>
     </mrow>
     <mo>⋅</mo>
     <mi>R</mi>
    </mrow>
    <msup>
     <mi>f</mi>
     <mn>2</mn>
    </msup>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>f</ci>
      </apply>
      <ci>R</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha_{f}\approx\frac{\Delta f\cdot R}{f^{2}}
  </annotation>
 </semantics>
</math>

, yielding a final estimation of the difference in refracted angle between in-focus and off-focus rays as<br/>


<math display="inline" id="Contrast_transfer_function:55">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

</p>
<dl>
<dd>
</dd>
</dl>
<h2 id="examples-of-the-contrast-transfer-function">Examples of the Contrast Transfer Function</h2>

<p>The contrast transfer function determines how much phase signal gets transmitted to the real space wavefunction in the image plane. As the modulus squared of the real space wavefunction gives the image signal, the contrast transfer function limits how much information can ultimately be translated into an image. The form of the contrast transfer function determines the quality of real space image formation in the TEM.</p>
<figure><b>(Figure)</b>
<embed src="Unmodified CTF.pdf" title="CTF Function prepared via web applet created by Jiang and Chiu, available at http://jiang.bio.purdue.edu/software/ctf/ctfapplet.html"></embed><figcaption>CTF Function prepared via web applet created by Jiang and Chiu, available at <a class="uri" href="http://jiang.bio.purdue.edu/software/ctf/ctfapplet.html">http://jiang.bio.purdue.edu/software/ctf/ctfapplet.html</a></figcaption>
</figure>

<p>This is an example contrast transfer function. There are a number of things to note:</p>
<ul>
<li>The function exists in the spatial frequency domain, or k-space</li>
<li>Whenever the function is equal to zero, that means there is no transmittance, or no phase signal is incorporated into the real space image</li>
<li>The first time the function crosses the x-axis is called the <strong>point resolution</strong></li>
<li>To maximize phase signal, it is generally better to use imaging conditions that push the point resolution to higher spatial frequencies</li>
<li>When the function is negative, that represents positive phase contrast, leading to a bright background, with dark atomic features</li>
<li>Every time the CTF crosses the x-axis, there is an inversion in contrast</li>
<li>Accordingly, past the point resolution of the microscope the phase information is not directly interpretable, and must be modeled via computer simulation</li>
</ul>
<h3 id="scherzer-defocus">Scherzer Defocus</h3>

<p>The defocus value (

<math display="inline" id="Contrast_transfer_function:56">
 <semantics>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>s</mi>
   </msub>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>C</mi>
       <mi>s</mi>
      </msub>
      <mi>λ</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>s</ci>
      </apply>
      <ci>λ</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{s}=(C_{s}\lambda)^{1/2}
  </annotation>
 </semantics>
</math>

) can be used to counteract the spherical aberration to allow for greater phase contrast. This analysis was developed by Scherzer, and is called the Scherzer defocus.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> 

<math display="inline" id="Contrast_transfer_function:57">
 <semantics>
  <msub>
   <mi>z</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>z</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z_{s}
  </annotation>
 </semantics>
</math>

</p>

<p>The variables are the same as from the mathematical treatment section, with 

<math display="inline" id="Contrast_transfer_function:58">
 <semantics>
  <msub>
   <mi>C</mi>
   <mi>s</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>C</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{s}
  </annotation>
 </semantics>
</math>

 setting the specific Scherzer defocus, 

<math display="inline" id="Contrast_transfer_function:59">
 <semantics>
  <mrow>
   <msub>
    <mi>K</mi>
    <mrow>
     <mi>e</mi>
     <mi>f</mi>
     <mi>f</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <msub>
    <mi>E</mi>
    <mi>t</mi>
   </msub>
   <msub>
    <mi>E</mi>
    <mi>s</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mi>i</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mi>π</mi>
      <mo>/</mo>
      <mi>λ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>W</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>K</ci>
     <apply>
      <times></times>
      <ci>e</ci>
      <ci>f</ci>
      <ci>f</ci>
     </apply>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">k</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>t</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>E</ci>
     <ci>s</ci>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">s</csymbol>
     <csymbol cd="unknown">i</csymbol>
     <csymbol cd="unknown">n</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-[</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <cn type="integer">2</cn>
       <csymbol cd="unknown">π</csymbol>
       <divide></divide>
       <csymbol cd="unknown">λ</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">W</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">k</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>normal-]</ci>
     </cerror>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{eff}(k)=E_{t}E_{s}(sin[(2\pi/\lambda)W(k)]
  </annotation>
 </semantics>
</math>

 as the spherical aberration, and λ as the relativistic wavelength for the electron wave.</p>

<p>The figure in the following section shows the CTF function for a CM300 Microscope at the Scherzer Defocus. Compared to the CTF Function showed above, there is a larger window, also known as a <strong>passband,</strong> of spatial frequencies with high transmittance. This allows more phase signal to pass through to the image plane.</p>
<h3 id="envelope-function">Envelope Function</h3>
<figure><b>(Figure)</b>
<embed src="CTF Modified by Spatial and Temporal Envelope Functions.pdf" title="CTF Function of a CM300 Microscope damped by temporal and spatial envelope functions."></embed><figcaption>CTF Function of a CM300 Microscope damped by temporal and spatial envelope functions.</figcaption>
</figure>

<p>The envelope function represents the effect of additional aberrations that damp the contrast transfer function, and in turn the phase. The envelope terms comprising the envelope function tend to suppress high spatial frequencies. The exact form of the envelope functions can differ from source to source. Generally, they are applied by multiplying the Contrast Transfer Function by an envelope term Et representing temporal aberrations, and an envelope term Es representing spatial aberrations. This yields a modified, or effective Contrast Transfer Function:</p>

<p><span class="LaTeX">$K_{eff}(k) = E_tE_s(sin[(2\pi/\lambda)W(k)]$</span></p>

<p>Examples of temporal aberrations include chromatic aberrations, energy spread, focal spread, instabilities in the high voltage source, and instabilities in the objective lens current. An example of a spatial aberration includes the finite incident beam convergence.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><br/>
As shown in the figure, the most restrictive envelope term will dominate in damping the contrast transfer function. In this particular example, the temporal envelope term is the most restrictive. Because the envelope terms damp more strongly at higher spatial frequencies, there comes a point where no more phase signal can pass through. This is called the <strong>Information Limit</strong> of the microscope, and is one measure of the resolution.</p>

<p><br/>
 Modeling the envelope function can give insight into both TEM instrument design, and imaging parameters. By modeling the different aberrations via envelope terms, it is possible to see which aberrations are most limiting the phase signal.</p>

<p>Various <a href="http://jiang.bio.purdue.edu/software/ctf/ctfapplet.html">software</a> <a href="http://www.maxsidorov.com/ctfexplorer/">packages</a> have been developed to model both the Contrast Transfer Function and Envelope Function for particular microscopes, and particular imaging parameters.</p>
<h2 id="linear-imaging-theory-vs.-non-linear-imaging-theory">Linear Imaging Theory vs. Non-Linear Imaging Theory</h2>
<h3 id="linear-imaging-theory">Linear Imaging Theory</h3>

<p><br/>
The previous description of the contrast transfer function depends on <strong>linear imaging theory</strong>. Linear imaging theory assumes that the transmitted beam is dominant, there is only weak phase scattering by the sample, and that the sample is extremely thin. Linear imaging theory corresponds to all of the scattering, or diffraction, being <a href="Diffraction_formalism" title="wikilink">kinematical</a> in nature. Few of these assumptions hold with real samples. In fact, even a single layer of Uranium atoms does not meet the Weak Phase Object Approximation.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a></p>

<p>Linear imaging theory is still used, however, because it has some computational advantages. In Linear imaging theory, the Fourier coefficients for the image plane wavefunction are separable. This greatly reduces computational complexity, allowing for faster computer simulations of HRTEM images.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>
<h3 id="non-linear-imaging-theory">Non-Linear Imaging Theory</h3>

<p>In practically all crystalline samples, the specimens will be strong scatterers, and will include multiple scattering events. This corresponds to <a href="Dynamical_theory_of_diffraction" title="wikilink">dynamical diffraction</a>. In order to account for these effects, <strong>non-linear imaging theory</strong> is required. With crystalline samples, diffracted beams will not only interfere with the transmitted beam, but will also interfere with each other. This will produce second order diffraction intensities. Non-linear imaging theory is required to model these additional interference effects.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Optical_transfer_function" title="wikilink">Optical transfer function</a></li>
<li><a href="Point_spread_function" title="wikilink">Point spread function</a></li>
<li><a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/ctf/ctf.html">Contrast transfer function (CTF) correction</a></li>
<li><a href="Airy_disk" title="wikilink">Airy disk</a>, different but similar phenomena in light</li>
<li><a href="http://www.youtube.com/watch?v=I3_4HF1ZeIQ">Talk on the CTF by Henning Stahlberg</a></li>
<li><a href="http://em-outreach.ucsd.edu/web-course/ref2.html">CTF reading list</a></li>
<li><a href="http://www.maxsidorov.com/ctfexplorer/index.htm">Interactive CTF Modeling</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a class="uri" href="Category:Microscopes" title="wikilink">Category:Microscopes</a> <a href="Category:Protein_structure" title="wikilink">Category:Protein structure</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2">Spence, John C. H. (1988 2nd ed) <em>Experimental high-resolution electron microscopy</em> (Oxford U. Press, NY) ISBN 0195054059.<a href="#fnref2">↩</a></li>
<li id="fn3">Ludwig Reimer (1997 4th ed) <em>Transmission electron microscopy: Physics of image formation and microanalysis</em> (Springer, Berlin) <a href="http://books.google.com/books?id=3_84SkJXnYkC">preview</a>.<a href="#fnref3">↩</a></li>
<li id="fn4">Earl J. Kirkland (1998) <em>Advanced computing in electron microscopy</em> (Plenum Press, NY).<a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="http://www.numis.northwestern.edu/465/index.shtml">Notes</a> prepared by Professor Laurie Marks at Northwestern University.<a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12">This page was prepared in part for Northwestern University class MSE 465, taught by Professor Laurie Marks.<a href="#fnref12">↩</a></li>
</ol>
</section>
</body>
</html>

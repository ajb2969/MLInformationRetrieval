   Master theorem      Master theorem   In the analysis of algorithms , the master theorem provides a solution in asymptotic terms (using Big O notation ) for recurrence relations of types that occur in the analysis of many divide and conquer algorithms . It was popularized by the canonical algorithms textbook Introduction to Algorithms by Cormen , Leiserson , Rivest , and Stein , in which it is both introduced and proved. Not all recurrence relations can be solved with the use of the master theorem; its generalizations include the Akra–Bazzi method .  Introduction  Consider a problem that can be solved using a recursive algorithm such as the following: '''procedure''' T( n : size of problem ) '''defined as:'''
     '''if''' n < 1 '''then exit''' Do work of amount f(n) T(n/b)
     T(n/b)
     ...repeat for a total of ''a'' times...
     T(n/b)
   '''end procedure'''  In the above algorithm we are dividing the problem into a number of subproblems recursively, each subproblem being of size n/b . This can be visualized as building a call tree with each node of the tree as an instance of one recursive call and its child nodes being instances of subsequent calls. In the above example, each node would have a number of child nodes. Each node does an amount of work that corresponds to the size of the sub problem n passed to that instance of the recursive call and given by    f   (  n  )       f  n    f(n)   . The total amount of work done by the entire tree is the sum of the work performed by all the nodes in the tree.  Algorithms such as above can be represented as a recurrence relation     T   (  n  )    =     a   T   (   n  b   )    +   f   (  n  )           T  n       a  T    n  b      f  n      T(n)=a\;T\left(\frac{n}{b}\right)+f(n)   . This recursive relation can be successively substituted into itself and expanded to obtain expression for total amount of work done.  Duke University,  "Big-Oh for Recursive Functions: Recurrence Relations",   http://www.cs.duke.edu/~ola/ap/recurrence.html   The Master theorem allows us to easily calculate the running time of such a recursive algorithm in Θ-notation without doing an expansion of the recursive relation above.  Generic form  The master theorem concerns recurrence relations of the form:        T   (  n  )    =     a    T    (   n  b   )    +   f   (  n  )         where   a   ≥   1  ,  b   >  1      formulae-sequence      T  n       a  T    n  b      f  n           where  a     1  ,  b        1      T(n)=a\;T\!\left(\frac{n}{b}\right)+f(n)\;\;\;\;\mbox{where}\;\;a\geq 1\mbox{,%
  }b>1     In the application to the analysis of a recursive algorithm, the constants and function take on the following significance:   n is the size of the problem.  a is the number of subproblems in the recursion.  n / b is the size of each subproblem. (Here it is assumed that all subproblems are essentially the same size.)  f ( n ) is the cost of the work done outside the recursive calls, which includes the cost of dividing the problem and the cost of merging the solutions to the subproblems.   It is possible to determine an asymptotic tight bound in these three cases:  Case 1  Generic form  If     f   (  n  )    ∈   O   (   n  c   )          f  n     O   superscript  n  c      f(n)\in O\left(n^{c}\right)   where    c  <    log  b   a       c    subscript   b   a     c<\log_{b}a   (using Big O notation )  then:       T   (  n  )    ∈   Θ   (   n    log  b   a    )          T  n     normal-Θ   superscript  n    subscript   b   a       T(n)\in\Theta\left(n^{\log_{b}a}\right)     Example       T   (  n  )    =    8  T   (   n  2   )    +   1000   n  2           T  n       8  T    n  2      1000   superscript  n  2       T(n)=8T\left(\frac{n}{2}\right)+1000n^{2}     As one can see from the formula above:       a  =  8   ,    b  =  2   ,    f   (  n  )    =   1000   n  2         formulae-sequence    a  8    formulae-sequence    b  2       f  n     1000   superscript  n  2        a=8,\,b=2,\,f(n)=1000n^{2}   , so       f   (  n  )    ∈   O   (   n  c   )          f  n     O   superscript  n  c      f(n)\in O\left(n^{c}\right)   , where    c  =  2      c  2    c=2     Next, we see if we satisfy the case 1 condition:        log  b   a   =    log  2   8   =  3  >  c          subscript   b   a     subscript   2   8        3       c     \log_{b}a=\log_{2}8=3>c   .  It follows from the first case of the master theorem that       T   (  n  )    ∈   Θ   (   n    log  b   a    )    =   Θ   (   n  3   )            T  n     normal-Θ   superscript  n    subscript   b   a            normal-Θ   superscript  n  3       T(n)\in\Theta\left(n^{\log_{b}a}\right)=\Theta\left(n^{3}\right)     (indeed, the exact solution of the recurrence relation is     T   (  n  )    =    1001   n  3    -   1000   n  2           T  n       1001   superscript  n  3      1000   superscript  n  2       T(n)=1001n^{3}-1000n^{2}   , assuming     T   (  1  )    =  1        T  1   1    T(1)=1   ).  Case 2  Generic form  If it is true, for some constant k ≥ 0, that:       f   (  n  )    =   Θ   (    n  c     log  k   n    )          f  n     normal-Θ     superscript  n  c     superscript   k   n       f(n)=\Theta\left(n^{c}\log^{k}n\right)   where    c  =    log  b   a       c    subscript   b   a     c=\log_{b}a     then:       T   (  n  )    =   Θ   (    n  c     log   k  +  1    n    )          T  n     normal-Θ     superscript  n  c     superscript     k  1    n       T(n)=\Theta\left(n^{c}\log^{k+1}n\right)     Example       T   (  n  )    =    2  T   (   n  2   )    +   10  n          T  n       2  T    n  2      10  n      T(n)=2T\left(\frac{n}{2}\right)+10n     As we can see in the formula above the variables get the following values:       a  =  2   ,    b  =  2   ,    c  =  1   ,    f   (  n  )    =   10  n         formulae-sequence    a  2    formulae-sequence    b  2    formulae-sequence    c  1       f  n     10  n        a=2,\,b=2,\,c=1,\,f(n)=10n          f   (  n  )    =   Θ   (    n  c     log  k   n    )          f  n     normal-Θ     superscript  n  c     superscript   k   n       f(n)=\Theta\left(n^{c}\log^{k}n\right)   where     c  =  1   ,   k  =  0      formulae-sequence    c  1     k  0     c=1,k=0   Next, we see if we satisfy the case 2 condition:        log  b   a   =    log  2   2   =  1          subscript   b   a     subscript   2   2        1     \log_{b}a=\log_{2}2=1   , and therefore, yes,    c  =    log  b   a       c    subscript   b   a     c=\log_{b}a     So it follows from the second case of the master theorem:       T   (  n  )    =   Θ   (    n    log  b   a      log   k  +  1    n    )    =   Θ   (    n  1     log  1   n    )    =   Θ   (   n   log  n    )            T  n     normal-Θ     superscript  n    subscript   b   a      superscript     k  1    n            normal-Θ     superscript  n  1     superscript   1   n            normal-Θ    n    n        T(n)=\Theta\left(n^{\log_{b}a}\log^{k+1}n\right)=\Theta\left(n^{1}\log^{1}n%
 \right)=\Theta\left(n\log n\right)     Thus the given recurrence relation T ( n ) was in Θ( n log n ).  (This result is confirmed by the exact solution of the recurrence relation, which is     T   (  n  )    =   n  +   10  n    log  2   n           T  n     n    10  n    subscript   2   n       T(n)=n+10n\log_{2}n   , assuming     T   (  1  )    =  1        T  1   1    T(1)=1   .)  Case 3  Generic form  If it is true that:       f   (  n  )    =   Ω   (   n  c   )          f  n     normal-Ω   superscript  n  c      f(n)=\Omega\left(n^{c}\right)   where    c  >    log  b   a       c    subscript   b   a     c>\log_{b}a     and if it is also true that:       a  f   (   n  b   )    ≤   k  f   (  n  )          a  f    n  b      k  f  n     af\left(\frac{n}{b}\right)\leq kf(n)   for some constant    k  <  1      k  1    k<1   and sufficiently large   n   n   n   (often called the regularity condition ) then:       T   (  n  )    =   Θ   (   f   (  n  )    )          T  n     normal-Θ    f  n      T\left(n\right)=\Theta\left(f(n)\right)     Example       T   (  n  )    =    2  T   (   n  2   )    +   n  2          T  n       2  T    n  2     superscript  n  2      T(n)=2T\left(\frac{n}{2}\right)+n^{2}     As we can see in the formula above the variables get the following values:       a  =  2   ,    b  =  2   ,    f   (  n  )    =   n  2        formulae-sequence    a  2    formulae-sequence    b  2       f  n    superscript  n  2       a=2,\,b=2,\,f(n)=n^{2}          f   (  n  )    =   Ω   (   n  c   )          f  n     normal-Ω   superscript  n  c      f(n)=\Omega\left(n^{c}\right)   , where    c  =  2      c  2    c=2     Next, we see if we satisfy the case 3 condition:        log  b   a   =    log  2   2   =  1          subscript   b   a     subscript   2   2        1     \log_{b}a=\log_{2}2=1   , and therefore, yes,    c  >    log  b   a       c    subscript   b   a     c>\log_{b}a     The regularity condition also holds:       2   (    n  2   4   )    ≤   k   n  2          2     superscript  n  2   4      k   superscript  n  2      2\left(\frac{n^{2}}{4}\right)\leq kn^{2}   , choosing    k  =   1  /  2       k    1  2     k=1/2     So it follows from the third case of the master theorem:        T   (  n  )    =   Θ   (   f   (  n  )    )    =   Θ   (   n  2   )     .          T  n     normal-Θ    f  n           normal-Θ   superscript  n  2       T\left(n\right)=\Theta\left(f(n)\right)=\Theta\left(n^{2}\right).     Thus the given recurrence relation T ( n ) was in Θ( n 2 ), that complies with the f ( n ) of the original formula.  (This result is confirmed by the exact solution of the recurrence relation, which is     T   (  n  )    =    2   n  2    -  n         T  n       2   superscript  n  2    n     T(n)=2n^{2}-n   , assuming     T   (  1  )    =  1        T  1   1    T(1)=1   .)  Inadmissible equations  The following equations cannot be solved using the master theorem:  Massachusetts Institute of Technology (MIT),  "Master Theorem: Practice Problems and Solutions",   http://www.csail.mit.edu/~thies/6.046-web/master.pdf         T   (  n  )    =     2  n   T   (   n  2   )    +   n  n          T  n        superscript  2  n   T    n  2     superscript  n  n      T(n)=2^{n}T\left(\frac{n}{2}\right)+n^{n}     a is not a constant; the number of subproblems should be fixed        T   (  n  )    =    2  T   (   n  2   )    +   n   log  n           T  n       2  T    n  2      n    n       T(n)=2T\left(\frac{n}{2}\right)+\frac{n}{\log n}     non-polynomial difference between f(n) and    n    log  b   a      superscript  n    subscript   b   a     n^{\log_{b}a}   (see below)        T   (  n  )    =    0.5  T   (   n  2   )    +  n         T  n       0.5  T    n  2    n     T(n)=0.5T\left(\frac{n}{2}\right)+n     a <1 cannot have less than one sub problem        T   (  n  )    =    64  T   (   n  8   )    -    n  2    log  n           T  n       64  T    n  8       superscript  n  2     n       T(n)=64T\left(\frac{n}{8}\right)-n^{2}\log n     f(n) which is the combination time is not positive        T   (  n  )    =    T   (   n  2   )    +   n   (   2  -   cos  n    )           T  n       T    n  2      n    2    n        T(n)=T\left(\frac{n}{2}\right)+n(2-\cos n)     case 3 but regularity violation.    In the second inadmissible example above, the difference between    f   (  n  )       f  n    f(n)   and    n    log  b   a      superscript  n    subscript   b   a     n^{\log_{b}a}   can be expressed with the ratio      f   (  n  )     n    log  b   a     =    n   log  n     n   l  o   g  2   2     =   n   n   log  n     =   1   log  n              f  n    superscript  n    subscript   b   a         n    n     superscript  n    l  o   subscript  g  2   2            n    n    n            1    n       \frac{f(n)}{n^{\log_{b}a}}=\frac{\frac{n}{\log n}}{n^{log_{2}2}}=\frac{n}{n%
 \log n}=\frac{1}{\log n}   . It is clear that     1   log  n    <   n  ϵ         1    n     superscript  n  ϵ     \frac{1}{\log n}   for any constant    ϵ  >  0      ϵ  0    \epsilon>0   . Therefore, the difference is not polynomial and the Master Theorem does not apply.  See also   Akra–Bazzi method   Application to common algorithms      Algorithm   Recurrence Relationship   Run time   Comment       Binary search        T   (  n  )    =    T   (   n  2   )    +   O   (  1  )           T  n       T    n  2      O  1      T(n)=T\left(\frac{n}{2}\right)+O(1)          O   (   log  n   )       O    n     O(\log n)      Apply Master theorem case    c  =    log  b   a       c    subscript   b   a     c=\log_{b}a   , where     a  =  1   ,    b  =  2   ,    c  =  0   ,   k  =  0        formulae-sequence    a  1    formulae-sequence    b  2    formulae-sequence    c  0     k  0       a=1,b=2,c=0,k=0     Dartmouth College,   http://www.math.dartmouth.edu/archive/m19w03/public_html/Section5-2.pdf      Binary tree traversal        T   (  n  )    =    2  T   (   n  2   )    +   O   (  1  )           T  n       2  T    n  2      O  1      T(n)=2T\left(\frac{n}{2}\right)+O(1)          O   (  n  )       O  n    O(n)      Apply Master theorem case    c  <    log  b   a       c    subscript   b   a     c<\log_{b}a   where     a  =  2   ,    b  =  2   ,   c  =  0       formulae-sequence    a  2    formulae-sequence    b  2     c  0      a=2,b=2,c=0    1     Optimal Sorted Matrix Search        T   (  n  )    =    2  T   (   n  2   )    +   O   (   log  n   )           T  n       2  T    n  2      O    n       T(n)=2T\left(\frac{n}{2}\right)+O(\log n)          O   (  n  )       O  n    O(n)      Apply Akra-Bazzi theorem for    p  =  1      p  1    p=1   and     g   (  u  )    =   log   (  u  )          g  u     u     g(u)=\log(u)   to get    Θ   (    2  n   -   log  n    )       normal-Θ      2  n     n      \Theta(2n-\log n)        Merge Sort        T   (  n  )    =    2  T   (   n  2   )    +   O   (  n  )           T  n       2  T    n  2      O  n      T(n)=2T\left(\frac{n}{2}\right)+O(n)          O   (   n   log  n    )       O    n    n      O(n\log n)      Apply Master theorem case    c  =    log  b   a       c    subscript   b   a     c=\log_{b}a   , where     a  =  2   ,    b  =  2   ,    c  =  1   ,   k  =  0        formulae-sequence    a  2    formulae-sequence    b  2    formulae-sequence    c  1     k  0       a=2,b=2,c=1,k=0        Notes  References   Thomas H. Cormen , Charles E. Leiserson , Ronald L. Rivest , and Clifford Stein . Introduction to Algorithms , Second Edition. MIT Press and McGraw-Hill, 2001. ISBN 0-262-03293-7. Sections 4.3 (The master method) and 4.4 (Proof of the master theorem), pp. 73–90.  Michael T. Goodrich and Roberto Tamassia . Algorithm Design: Foundation, Analysis, and Internet Examples . Wiley, 2002. ISBN 0-471-38365-1. The master theorem (including the version of Case 2 included here, which is stronger than the one from CLRS) is on pp. 268–270.   "  Category:Asymptotic analysis  Category:Theorems in computational complexity theory  Category:Recurrence relations  Category:Analysis of algorithms         
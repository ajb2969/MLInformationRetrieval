   Lagrange multiplier      Lagrange multiplier     In mathematical optimization , the method of Lagrange multipliers (named after Joseph Louis Lagrange 1 ) is a strategy for finding the local maxima and minima of a function subject to equality constraints .  For instance (see Figure 1), consider the optimization problem   maximize    f   (  x  ,  y  )       f   x  y     f(x,y)     subject to     g   (  x  ,  y  )    =  c        g   x  y    c    g(x,y)=c   .   We need both   f   f   f   and   g   g   g   to have continuous first partial derivatives . We introduce a new variable (   λ   λ   λ   ) called a Lagrange multiplier and study the Lagrange function (or Lagrangian) defined by        Λ   (  x  ,  y  ,  λ  )    =    f   (  x  ,  y  )    +   λ  ⋅   (    g   (  x  ,  y  )    -  c   )      ,        normal-Λ   x  y  λ        f   x  y     normal-⋅  λ      g   x  y    c       \Lambda(x,y,\lambda)=f(x,y)+\lambda\cdot\Big(g(x,y)-c\Big),     where the   λ   λ   λ   term may be either added or subtracted. If is a maximum of    f   (  x  ,  y  )       f   x  y     f(x,y)   for the original constrained problem, then there exists such that is a stationary point for the Lagrange function (stationary points are those points where the partial derivatives of   Λ   normal-Λ   Λ   are zero). However, not all stationary points yield a solution of the original problem. Thus, the method of Lagrange multipliers yields a necessary condition for optimality in constrained problems. 2 3       4 Sufficient conditions for a minimum or maximum also exist.  Introduction  One of the most common problems in calculus is that of finding maxima or minima (in general, "extrema") of a function, but it is often difficult to find a closed form for the function being extremized. Such difficulties often arise when one wishes to maximize or minimize a function subject to fixed outside conditions or constraints. The method of Lagrange multipliers is a powerful tool for solving this class of problems without the need to explicitly solve the conditions and use them to eliminate extra variables.  Consider the two-dimensional problem introduced above:   maximize    f   (  x  ,  y  )       f   x  y     f(x,y)     subject to     g   (  x  ,  y  )    =  0        g   x  y    0    g(x,y)=0      Lagrange multipliers relies on the intuition that at a maximum    f   (  x  ,  y  )       f   x  y     f(x,y)   cannot be increasing in the direction of any neighboring point where    g  =  0      g  0    g=0   . If it were, we could walk along    g  =  0      g  0    g=0   to get higher, meaning that the starting point wasn't actually the maximum.  We can visualize contours of   f   f   f   given by     f   (  x  ,  y  )    =  d        f   x  y    d    f(x,y)=d   for various values of   d   d   d   , and the contour of   g   g   g   given by     g   (  x  ,  y  )    =  0        g   x  y    0    g(x,y)=0   .  Suppose we walk along the contour line with    g  =  0      g  0    g=0   . We are interested in finding points where   f   f   f   does not change as we walk, since these points might be maxima. There are two ways this could happen: First, we could be following a contour line of   f   f   f   , since by definition   f   f   f   does not change as we walk along its contour lines. This would mean that the contour lines of   f   f   f   and   g   g   g   are parallel here. The second possibility is that we have reached a "level" part of   f   f   f   , meaning that   f   f   f   does not change in any direction.  To check the first possibility, notice that since the gradient of a function is perpendicular to the contour lines, the contour lines of   f   f   f   and   g   g   g   are parallel if and only if the gradients of   f   f   f   and   g   g   g   are parallel. Thus we want points    (  x  ,  y  )     x  y    (x,y)   where     g   (  x  ,  y  )    =  0        g   x  y    0    g(x,y)=0   and        ∇   x  ,  y    f   =   -   λ    ∇   x  ,  y    g           subscript  normal-∇   x  y    f       λ    subscript  normal-∇   x  y    g       \nabla_{x,y}f=-\lambda\nabla_{x,y}g   ,  for some   λ   λ   λ     where          ∇   x  ,  y    f   =   (    ∂  f    ∂  x    ,    ∂  f    ∂  y    )    ,     ∇   x  ,  y    g   =   (    ∂  g    ∂  x    ,    ∂  g    ∂  y    )     .     formulae-sequence      subscript  normal-∇   x  y    f        f     x        f     y          subscript  normal-∇   x  y    g        g     x        g     y        \nabla_{x,y}f=\left(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y%
 }\right),\qquad\nabla_{x,y}g=\left(\frac{\partial g}{\partial x},\frac{%
 \partial g}{\partial y}\right).     are the respective gradients. The constant   λ   λ   λ   is required because although the two gradient vectors are parallel, the magnitudes of the gradient vectors are generally not equal. (The negative is traditional). This constant is called the Lagrange multiplier.  Notice that this method also solves the second possibility: if   f   f   f   is level, then its gradient is zero, and setting    λ  =  0      λ  0    λ=0   is a solution regardless of   g   g   g   .  To incorporate these conditions into one equation, we introduce an auxiliary function        Λ   (  x  ,  y  ,  λ  )    =    f   (  x  ,  y  )    +    λ  ⋅  g    (  x  ,  y  )      ,        normal-Λ   x  y  λ        f   x  y       normal-⋅  λ  g    x  y       \Lambda(x,y,\lambda)=f(x,y)+\lambda\cdot g(x,y),     and solve         ∇   x  ,  y  ,  λ    Λ    (  x  ,  y  ,  λ  )    =  0.          subscript  normal-∇   x  y  λ    normal-Λ    x  y  λ    0.    \nabla_{x,y,\lambda}\Lambda(x,y,\lambda)=0.     This is the method of Lagrange multipliers. Note that       ∇  λ   Λ    (  x  ,  y  ,  λ  )    =  0          subscript  normal-∇  λ   normal-Λ    x  y  λ    0    \nabla_{\lambda}\Lambda(x,y,\lambda)=0   implies     g   (  x  ,  y  )    =  0        g   x  y    0    g(x,y)=0   .  The constrained extrema of   f   f   f   are critical points of the Lagrangian   Λ   normal-Λ   Λ   , but they are not necessarily local extrema of   Λ   normal-Λ   Λ   (see Example 2 below).  One may reformulate the Lagrangian as a Hamiltonian , in which case the solutions are local minima for the Hamiltonian. This is done in optimal control theory, in the form of Pontryagin's minimum principle .  The fact that solutions of the Lagrangian are not necessarily extrema also poses difficulties for numerical optimization. This can be addressed by computing the magnitude of the gradient, as the zeros of the magnitude are necessarily local minima, as illustrated in the numerical optimization example .  Handling multiple constraints  The method of Lagrange multipliers can also accommodate multiple constraints. To see how this is done, we need to reexamine the problem in a slightly different manner because the concept of “crossing” discussed above becomes rapidly unclear when we consider the types of constraints that are created when we have more than one constraint acting together.  As an example, consider a paraboloid with a constraint that is a single point (as might be created if we had 2 line constraints that intersect). The level set (i.e., contour line) clearly appears to “cross” that point and its gradient is clearly not parallel to the gradients of either of the two line constraints. Yet, it is obviously a maximum and a minimum because there is only one point on the paraboloid that meets the constraint.  While this example seems a bit odd, it is easy to understand and is representative of the sort of “effective” constraint that appears quite often when we deal with multiple constraints intersecting. Thus, we take a slightly different approach below to explain and derive the Lagrange Multipliers method with any number of constraints.  Throughout this section, the independent variables will be denoted by and, as a group, we will denote them as ( x 1 , x 2 , ..., x N )}} . Also, the function being analyzed will be denoted by    f   (  p  )       f  p    f(p)   and the constraints will be represented by the equations  g 2 ( p ) {{=}} ... {{=}} g M ( p ) {{=}} 0}} .  The basic idea remains essentially the same: if we consider only the points that satisfy the constraints (i.e., are in the constraints), then a point    (  p  ,   f   (  p  )    )     p    f  p     (p,f(p))   is a stationary point (i.e., a point in a “flat” region) of   f   f   f   if and only if the constraints at that point do not allow movement in a direction where   f   f   f   changes value.  Once we have located the stationary points, we need to do further tests to see if we have found a minimum, a maximum or just a stationary point that is neither.  We start by considering the level set of   f   f   f   at    (  p  ,   f   (  p  )    )     p    f  p     (p,f(p))   . The set of vectors  containing the directions in which we can move and still remain in the same level set are the directions where the value of   f   f   f   does not change (i.e., the change equals zero). Thus, for every vector   v   v   v   in , the following relation must hold:          ∂  f    ∂   x  1      v   x  1     +     ∂  f    ∂   x  2      v   x  2     +  ⋯  +     ∂  f    ∂   x  N      v   x  N      =  0              f      subscript  x  1      subscript  v   subscript  x  1           f      subscript  x  2      subscript  v   subscript  x  2     normal-⋯        f      subscript  x  N      subscript  v   subscript  x  N      0    \frac{\partial f}{\partial x_{1}}v_{x_{1}}+\frac{\partial f}{\partial x_{2}}v_%
 {x_{2}}+\cdots+\frac{\partial f}{\partial x_{N}}v_{x_{N}}=0     where the notation above means the -component of the vector   v   v   v   . The equation above can be rewritten in a more compact geometric form that helps our intuition:              [        ∂  f    ∂   x  1           ∂  f    ∂   x  2        …       ∂  f    ∂   x  N         ]           ⏟    ∇   f  T             [      v   x  1         v   x  2        ⋮       v   x  N       ]           ⏟   v       =  0          subscript   normal-⏟     delimited-[]        f      subscript  x  1         f      subscript  x  2     normal-…      f      subscript  x  N          absent      normal-∇   superscript  f  T      subscript   normal-⏟     delimited-[]     subscript  v   subscript  x  1       subscript  v   subscript  x  2      normal-⋮     subscript  v   subscript  x  N         absent     v     absent  0      \begin{matrix}\underbrace{\begin{matrix}\left[\begin{matrix}\frac{\partial f}{%
 \partial x_{1}}&\frac{\partial f}{\partial x_{2}}&...&\frac{\partial f}{%
 \partial x_{N}}\end{matrix}\right]\\
 \\
 \end{matrix}}_{\nabla f^{T}}&\underbrace{\begin{matrix}\left[\begin{matrix}v_{%
 x_{1}}\\
 v_{x_{2}}\\
 \vdots\\
 v_{x_{N}}\\
 \end{matrix}\right]\\
 \\
 \end{matrix}}_{v}&=\,\,0\\
 \end{matrix}     which is the same as writing       ∇    f  T   ⋅  v    =  0.       normal-∇   normal-⋅   superscript  f  T   v    0.    \nabla f^{T}\cdot v=0.     This makes it clear that if we are at   p   p   p   , then all directions from this point that do not change the value of   f   f   f    must be perpendicular to    ∇  f   (  p  )       normal-∇  f  p    ∇f(p)   (the gradient of   f   f   f   at   p   p   p   ).  Now let us consider the effect of the constraints. Each constraint limits the directions that we can move from a particular point and still satisfy the constraint. We can use the same procedure, to look for the set of vectors  containing the directions in which we can move and still satisfy the constraint. As above, for every vector   v   v   v   in , the following relation must hold:           ∂  g    ∂   x  1      v   x  1     +     ∂  g    ∂   x  2      v   x  2     +  ⋯  +     ∂  g    ∂   x  N      v   x  N      =   0  ⇒      ∇    g  T   ⋅  v    =  0.      formulae-sequence            g      subscript  x  1      subscript  v   subscript  x  1           g      subscript  x  2      subscript  v   subscript  x  2     normal-⋯        g      subscript  x  N      subscript  v   subscript  x  N       0  normal-⇒       normal-∇   normal-⋅   superscript  g  T   v    0.     \frac{\partial g}{\partial x_{1}}v_{x_{1}}+\frac{\partial g}{\partial x_{2}}v_%
 {x_{2}}+\cdots+\frac{\partial g}{\partial x_{N}}v_{x_{N}}=0\quad\Rightarrow%
 \quad\nabla g^{T}\cdot v=0.     From this, we see that at point   p   p   p   , all directions from this point that will still satisfy this constraint must be perpendicular to    ∇  g   (  p  )       normal-∇  g  p    ∇g(p)   .  Now we are ready to refine our idea further and complete the method: a point on    f   f   f    is a constrained stationary point if and only if the direction that changes    f   f   f    violates at least one of the constraints, i.e., has no "component" in the "legal" space perpendicular to     ∇  g   (  p  )       normal-∇  g  p    ∇g(p)   . (We can see that this is true because if a direction that changes   f   f   f   did not violate any constraints, then there would be a “legal” point nearby with a higher or lower value for   f   f   f   and the current point would then not be a stationary point.) Mathematically, this means that the gradient of   f   f   f   at this constrained stationary point is perpendicular to the space spanned by the set of vectors , which in turn is perpendicular to the gradients of the constraints   g   g   g   .  Single constraint revisited  For a single constraint, we use the statement above to say that at stationary points the direction that changes   f   f   f   is in the same direction that violates the constraint. To determine if two vectors are in the same direction, we note that if two vectors start from the same point and are “in the same direction”, then one vector can always “reach” the other by changing its length and/or flipping to point the opposite way along the same direction line. In this way, we can succinctly state that two vectors point in the same direction if and only if one of them can be multiplied by some real number such that they become equal to the other. So, for our purposes, we require that:         ∇  f    (  p  )    =     λ    ∇  g    (  p  )    ⇒        ∇  f    (  p  )    -    λ    ∇  g    (  p  )     =  0.      formulae-sequence       normal-∇  f   p      λ   normal-∇  g   p   normal-⇒           normal-∇  f   p     λ   normal-∇  g   p    0.     \nabla f(p)=\lambda\,\nabla g(p)\qquad\Rightarrow\qquad\nabla f(p)-\lambda\,%
 \nabla g(p)=0.     If we now add another simultaneous equation to guarantee that we only perform this test when we are at a point that satisfies the constraint, we end up with 2 simultaneous equations that when solved, identify all constrained stationary points:      {       g   (  p  )    =  0      p  satisfies constraint           ∇  f    (  p  )    -    λ    ∇  g    (  p  )     =  0       p  is a stationary point   .         cases      g  p   0     p  satisfies constraint          normal-∇  f   p     λ   normal-∇  g   p    0     p  is a stationary point     \begin{cases}g(p)=0&p\text{ satisfies constraint}\\
 \nabla f(p)-\lambda\,\nabla g(p)=0&p\text{ is a stationary point}.\end{cases}     Note that the above is a succinct way of writing the equations. Fully expanded, there are    N  +  1      N  1    N+1   simultaneous equations that need to be solved for the    N  +  1      N  1    N+1   variables which are   λ   λ   λ   and :      g   (   x  1   ,   x  2   ,  …  ,   x  N   )       g    subscript  x  1    subscript  x  2   normal-…   subscript  x  N      \displaystyle g\left(x_{1},x_{2},\ldots,x_{N}\right)     Multiple constraints  For more than one constraint, similar reasoning applies. Each constraint function,   g   g   g   , has a space of allowable directions at   p   p   \textstyle p   : the space of vectors perpendicular to     ∇  g    (  p  )        normal-∇  g   p    \textstyle\nabla g(p)   . The set of directions that are allowed by all constraints is thus the space of directions perpendicular to all of the constraint gradients. Denote this space of allowable moves by   A   A   \textstyle A   and denote the span of the constraint gradients by   S   S   \textstyle S   . By the discussion above,    A  =   S  ⟂       A   superscript  S  perpendicular-to     \textstyle A=S^{\perp}   , the space of vectors perpendicular to every element of   S   S   \textstyle S   .  If   p   p   \textstyle p   is an optimum then any element not perpendicular to     ∇  f    (  p  )        normal-∇  f   p    \textstyle\nabla f(p)   is not an allowable direction. One can show that this implies      ∇  f    (  p  )    ∈   A  ⟂   =  S           normal-∇  f   p    superscript  A  perpendicular-to        S     \nabla f(p)\in A^{\perp}=S   . Thus there are scalars such that         ∇  f    (  p  )    =     ∑   k  =  1   M     λ  k    ∇   g  k     (  p  )     ⇒        ∇  f    (  p  )    -    ∑   k  =  1   M     λ  k    ∇   g  k     (  p  )      =  0.      formulae-sequence       normal-∇  f   p      superscript   subscript     k  1    M      subscript  λ  k    normal-∇   subscript  g  k    p    normal-⇒           normal-∇  f   p     superscript   subscript     k  1    M      subscript  λ  k    normal-∇   subscript  g  k    p     0.     \nabla f(p)=\sum_{k=1}^{M}\lambda_{k}\nabla g_{k}(p)\quad\Rightarrow\quad%
 \nabla f(p)-\sum_{k=1}^{M}{\lambda_{k}\nabla g_{k}(p)}=0.     As before, we now add simultaneous equation to guarantee that we only perform this test when we are at a point that satisfies every constraint, we end up with simultaneous equations that when solved, identify all constrained stationary points:      {        g  1    (  p  )    =    g  2    (  p  )    =  ⋯  =    g  M    (  p  )    =  0      p  satisfies all constraints           ∇  f    (  p  )    -     ∑   k  =  1   M       λ  k     ∇   g  k     (  p  )      =  0       p  is a stationary point   .         cases         subscript  g  1   p      subscript  g  2   p        normal-⋯          subscript  g  M   p        0      p  satisfies all constraints          normal-∇  f   p     superscript   subscript     k  1    M      subscript  λ  k    normal-∇   subscript  g  k    p     0     p  is a stationary point     \begin{cases}g_{1}(p)=g_{2}(p)=\cdots=g_{M}(p)=0&p\text{ satisfies all %
 constraints}\\
 \nabla f(p)-\sum_{k=1}^{M}{\lambda_{k}\,\nabla g_{k}(p)}=0&p\text{ is a %
 stationary point}.\end{cases}     The method is complete now (from the standpoint of solving the problem of finding stationary points) but as mathematicians delight in doing, these equations can be further condensed into an even more elegant and succinct form. Lagrange must have cleverly noticed that the equations above look like partial derivatives of some larger scalar function   L   L   L   that takes all the and all the as inputs. Next, he might then have noticed that setting every equation equal to zero is exactly what one would have to do to solve for the unconstrained stationary points of that larger function. Finally, he showed that a larger function   L   L   L   with partial derivatives that are exactly the ones we require can be constructed very simply as below:        L   (   x  1   ,   x  2   ,  …  ,   x  N   ,   λ  1   ,   λ  2   ,  …  ,   λ  M   )    =    f   (   x  1   ,   x  2   ,  …  ,   x  N   )    -    ∑   k  =  1   M     λ  k    g  k    (   x  1   ,   x  2   ,  …  ,   x  N   )       .        L    subscript  x  1    subscript  x  2   normal-…   subscript  x  N    subscript  λ  1    subscript  λ  2   normal-…   subscript  λ  M         f    subscript  x  1    subscript  x  2   normal-…   subscript  x  N       superscript   subscript     k  1    M      subscript  λ  k    subscript  g  k     subscript  x  1    subscript  x  2   normal-…   subscript  x  N         L\left(x_{1},x_{2},\ldots,x_{N},\lambda_{1},\lambda_{2},\ldots,\lambda_{M}%
 \right)=f\left(x_{1},x_{2},\ldots,x_{N}\right)-\sum\limits_{k=1}^{M}{\lambda_{%
 k}g_{k}\left(x_{1},x_{2},\ldots,x_{N}\right)}.     Solving the equation above for its unconstrained stationary points generates exactly the same stationary points as solving for the constrained stationary points of   f   f   f   under the constraints .  In Lagrange’s honor, the function above is called a Lagrangian , the scalars are called Lagrange Multipliers and this optimization method itself is called The Method of Lagrange Multipliers .  The method of Lagrange multipliers is generalized by the Karush–Kuhn–Tucker conditions , which can also take into account inequality constraints of the form    h   (  𝐱  )    ≤  c      h  𝐱  normal-  normal-≤  c    h(\mathbf{x}) ≤c   .  Modern Formulation via Differentiable Manifolds  Finding local maxima of a function    f  :   U  →  ℝ      normal-:  f   normal-→  U  ℝ     f:U\to\mathbb{R}   where   U   U   U   is an open subset of    ℝ  n     superscript  ℝ  n    \mathbb{R}^{n}   is done by finding all points    x  ∈  U      x  U    x\in U   such that      D  x   f   =  0         subscript  D  x   f   0    D_{x}f=0   then checking whether all the eigenvalues of the Hessian     H  x   f       subscript  H  x   f    H_{x}f   are negative. Setting      D  x   f   =  0         subscript  D  x   f   0    D_{x}f=0   is a non-linear problem and in general arbitrarily difficult. After finding the critical points, checking the eigenvalues is a linear problem and thus easy.  When    g  :    ℝ  n   →  ℝ      normal-:  g   normal-→   superscript  ℝ  n   ℝ     g:\mathbb{R}^{n}\to\mathbb{R}   is a smooth function such that      D  x   g   ≠  0         subscript  D  x   g   0    D_{x}g\neq 0   for all   x   x   x   in the level set of   c   c   c   then     g   -  1     (  c  )        superscript  g    1    c    g^{-1}(c)   becomes an    n  -  1      n  1    n-1   -dimensional smooth manifold   M   M   M   , by the level set theorem. Finding local maxima is by definition a local problem, so it can be done on local charts of   M   M   M   : after finding a diffeomorphism    φ  :   V  →   ℝ   n  -  1        normal-:  φ   normal-→  V   superscript  ℝ    n  1       \varphi:V\to\mathbb{R}^{n-1}   from an open subset of    V  ⊆  M      V  M    V\subseteq M   onto an open subset    U  ⊆   ℝ   n  -  1        U   superscript  ℝ    n  1      U\subseteq\mathbb{R}^{n-1}   , we can apply the algorithm in the previous paragraph to the function      f  ′   =   f  ∘   φ   -  1      :   U  →  ℝ      normal-:     superscript  f  normal-′     f   superscript  φ    1       normal-→  U  ℝ     f^{\prime}=f\circ\varphi^{-1}:U\to\mathbb{R}   .  While the above idea sounds good, it is difficult to compute    φ   -  1      superscript  φ    1     \varphi^{-1}   in practice. The entire method of Lagrange multipliers reduces to the idea of skipping that step and finding the zeros of     D  x    f  ′        subscript  D  x    superscript  f  normal-′     D_{x}f^{\prime}   directly. It follows from the construction in the level set theorem that     D  x    φ   -  1         subscript  D  x    superscript  φ    1      D_{x}\varphi^{-1}   is the inclusion map     ker   D    φ   -  1     (  x  )     g   ⊆   ℝ  n         ker   subscript  D     superscript  φ    1    x    g    superscript  ℝ  n     \mathrm{ker}D_{\varphi^{-1}(x)}g\subseteq\mathbb{R}^{n}   . Therefore      0  =    D  x    f  ′    =    D  x    (   f  ∘   φ   -  1     )    =      D    φ   -  1     (  x  )     f   ∘   D  x     φ   -  1           0     subscript  D  x    superscript  f  normal-′            subscript  D  x     f   superscript  φ    1                  subscript  D     superscript  φ    1    x    f    subscript  D  x     superscript  φ    1        0=D_{x}f^{\prime}=D_{x}(f\circ\varphi^{-1})=D_{\varphi^{-1}(x)}f\circ D_{x}%
 \varphi^{-1}   if and only if       ker   D  y   g   ⊆   ker   D  y   f         ker   subscript  D  y   g     ker   subscript  D  y   f     \mathrm{ker}D_{y}g\subseteq\mathrm{ker}D_{y}f   writing   y   y   y   for     φ   -  1     (  x  )        superscript  φ    1    x    \varphi^{-1}(x)   .  By the first isomorphism theorem this is true if and only if there exists a linear map    L  :   ℝ  →  ℝ      normal-:  L   normal-→  ℝ  ℝ     L:\mathbb{R}\to\mathbb{R}   such that      L  ∘   D  y    g   =    D  y   f           L   subscript  D  y    g      subscript  D  y   f     L\circ D_{y}g=D_{y}f   . As a linear map, we must have that     L   (  x  )    =   λ  x         L  x     λ  x     L(x)=\lambda x   for a fixed    λ  ∈  ℝ      λ  ℝ    \lambda\in\mathbb{R}   . So finding a critical point of    f  ′     superscript  f  normal-′    f^{\prime}   is equivalent to solving the system of equations       λ   D  y   g   =    D  y   f         λ   subscript  D  y   g      subscript  D  y   f     \lambda D_{y}g=D_{y}f          g   (  y  )    =  c        g  y   c    g(y)=c     in the variables    y  ∈   ℝ   n  -  1        y   superscript  ℝ    n  1      y\in\mathbb{R}^{n-1}   and    λ  ∈  ℝ      λ  ℝ    \lambda\in\mathbb{R}   . This is in general a non-linear system of   n   n   n   equations and   n   n   n   unknowns.  In the case of several constraints, we work with    g  :    ℝ  n   →   ℝ  m       normal-:  g   normal-→   superscript  ℝ  n    superscript  ℝ  m      g:\mathbb{R}^{n}\to\mathbb{R}^{m}   and replace the condition      D  x   g   ≠  0         subscript  D  x   g   0    D_{x}g\neq 0   for all    x  ∈    g   -  1     (  c  )        x     superscript  g    1    c     x\in g^{-1}(c)   with the requirement that     D  x   g       subscript  D  x   g    D_{x}g   be surjective at all such points. In this case   L   L   L   will be a linear map     ℝ  m   →  ℝ     normal-→   superscript  ℝ  m   ℝ    \mathbb{R}^{m}\to\mathbb{R}   , ie a row vector with   m   m   m   entries.  Interpretation of the Lagrange multipliers  Often the Lagrange multipliers have an interpretation as some quantity of interest. For example, if the Lagrangian expression is       L   (   x  1   ,   x  2   ,  …  ;   λ  1   ,   λ  2   ,  …  )    =    f   (   x  1   ,   x  2   ,  …  )    +    λ  1    (    c  1   -    g  1    (   x  1   ,   x  2   ,  …  )     )    +    λ  2    (    c  2   -    g  2    (   x  1   ,   x  2   ,  …  )     )    +  …         L    subscript  x  1    subscript  x  2   normal-…   subscript  λ  1    subscript  λ  2   normal-…        f    subscript  x  1    subscript  x  2   normal-…       subscript  λ  1      subscript  c  1      subscript  g  1     subscript  x  1    subscript  x  2   normal-…         subscript  λ  2      subscript  c  2      subscript  g  2     subscript  x  1    subscript  x  2   normal-…      normal-…     L(x_{1},x_{2},\dots;\lambda_{1},\lambda_{2},\dots)=f(x_{1},x_{2},\dots)+%
 \lambda_{1}(c_{1}-g_{1}(x_{1},x_{2},\dots))+\lambda_{2}(c_{2}-g_{2}(x_{1},x_{2%
 },\dots))+\dots     then         ∂  L    ∂   c  k     =   λ  k    .          L      subscript  c  k      subscript  λ  k     \frac{\partial L}{\partial{c_{k}}}=\lambda_{k}.     So, is the rate of change of the quantity being optimized as a function of the constraint variable. As examples, in Lagrangian mechanics the equations of motion are derived by finding stationary points of the action , the time integral of the difference between kinetic and potential energy. Thus, the force on a particle due to a scalar potential,    F  =   −  ∇  V       F    normal-−  normal-∇  V     F=−∇V   , can be interpreted as a Lagrange multiplier determining the change in action (transfer of potential to kinetic energy) following a variation in the particle's constrained trajectory. In control theory this is formulated instead as costate equations .  Moreover, by the envelope theorem the optimal value of a Lagrange multiplier has an interpretation as the marginal effect of the corresponding constraint constant upon the optimal attainable value of the original objective function: if we denote values at the optimum with an asterisk, then it can be shown that         d  f   (    x  1  *    (   c  1   ,   c  2   ,  …  )    ,    x  2  *    (   c  1   ,   c  2   ,  …  )    ,  …  )     d   c  k     =   λ  k  *    .          d  f      superscript   subscript  x  1       subscript  c  1    subscript  c  2   normal-…       superscript   subscript  x  2       subscript  c  1    subscript  c  2   normal-…    normal-…      d   subscript  c  k      superscript   subscript  λ  k       \frac{\text{d}f(x_{1}^{*}(c_{1},c_{2},\dots),x_{2}^{*}(c_{1},c_{2},\dots),%
 \dots)}{\text{d}c_{k}}=\lambda_{k}^{*}.     For example, in economics the optimal profit to a player is calculated subject to a constrained space of actions, where a Lagrange multiplier is the change in the optimal value of the objective function (profit) due to the relaxation of a given constraint (e.g. through a change in income); in such a context    λ  *     fragments  λ     λ*   is the marginal cost of the constraint, and is referred to as the shadow price .  Sufficient conditions  Sufficient conditions for a constrained local maximum or minimum can be stated in terms of a sequence of principal minors (determinants of upper-left-justified sub-matrices) of the bordered Hessian matrix of second derivatives of the Lagrangian expression. 5  Examples  Example 1  (Figure)  Fig. 3. Illustration of the constrained optimization problem   Suppose we wish to maximize     f   (  x  ,  y  )    =   x  +  y         f   x  y      x  y     f(x,y)=x+y   subject to the constraint      x  2   +   y  2    =  1         superscript  x  2    superscript  y  2    1    x^{2}+y^{2}=1   . The feasible set is the unit circle, and the level sets of   f   f   f   are diagonal lines (with slope -1), so we can see graphically that the maximum occurs at    (    2   2   ,    2   2   )         2   2       2   2     \left(\tfrac{\sqrt{2}}{2},\tfrac{\sqrt{2}}{2}\right)   , and that the minimum occurs at    (   -    2   2    ,   -    2   2    )           2   2          2   2      \left(-\tfrac{\sqrt{2}}{2},-\tfrac{\sqrt{2}}{2}\right)   .  Using the method of Lagrange multipliers, we have      g   (  x  ,  y  )    -  c   =     x  2   +   y  2    -  1           g   x  y    c        superscript  x  2    superscript  y  2    1     g(x,y)-c=x^{2}+y^{2}-1   , hence        Λ   (  x  ,  y  ,  λ  )    =    f   (  x  ,  y  )    +   λ   (    g   (  x  ,  y  )    -  c   )     =   x  +  y  +   λ   (     x  2   +   y  2    -  1   )      .          normal-Λ   x  y  λ        f   x  y      λ      g   x  y    c            x  y    λ       superscript  x  2    superscript  y  2    1        \Lambda(x,y,\lambda)=f(x,y)+\lambda(g(x,y)-c)=x+y+\lambda(x^{2}+y^{2}-1).     Setting the gradient       ∇   x  ,  y  ,  λ    Λ    (  x  ,  y  ,  λ  )    =  0          subscript  normal-∇   x  y  λ    normal-Λ    x  y  λ    0    \nabla_{x,y,\lambda}\Lambda(x,y,\lambda)=0   yields the system of equations        ∂  Λ    ∂  x          normal-Λ     x     \displaystyle\frac{\partial\Lambda}{\partial x}     where the last equation is the original constraint.  The first two equations yield       x  =  y  =   -   1   2  λ      ,   λ  ≠  0.      formulae-sequence      x  y           1    2  λ         λ  0.     x=y=-\frac{1}{2\lambda},\qquad\lambda\neq 0.     Substituting into the last equation yields      1  /   (   4   λ  2    )    +   1  /   (   4   λ  2    )     =  1          1    4   superscript  λ  2       1    4   superscript  λ  2      1    1/(4\lambda^{2})+1/(4\lambda^{2})=1   , so    λ  =   ∓   1  /   2         λ   minus-or-plus    1    2       \lambda=\mp 1/\sqrt{2}   , which implies that the stationary points are    (    2   /  2   ,    2   /  2   )         2   2       2   2     (\sqrt{2}/2,\sqrt{2}/2)   and    (   -    2   /  2    ,   -    2   /  2    )           2   2          2   2      (-\sqrt{2}/2,-\sqrt{2}/2)   . Evaluating the objective function   f   f   f   at these points yields        f   (    2   /  2   ,    2   /  2   )    =    2   and  f   (   -    2   /  2    ,   -    2   /  2    )    =   -   2     ,          f       2   2       2   2         2   and  f         2   2          2   2               2       f(\sqrt{2}/2,\sqrt{2}/2)=\sqrt{2}\mbox{ and }f(-\sqrt{2}/2,-\sqrt{2}/2)=-\sqrt%
 {2},     thus the maximum is    2      2    \sqrt{2}   , which is attained at    (    2   /  2   ,    2   /  2   )         2   2       2   2     (\sqrt{2}/2,\sqrt{2}/2)   , and the minimum is    -   2         2     -\sqrt{2}   , which is attained at    (   -    2   /  2    ,   -    2   /  2    )           2   2          2   2      (-\sqrt{2}/2,-\sqrt{2}/2)   .  Example 2  (Figure)  Fig. 4. Illustration of the constrained optimization problem   Suppose we want to find the maximum values of       f   (  x  ,  y  )    =    x  2   y         f   x  y       superscript  x  2   y     f(x,y)=x^{2}y     with the condition that the   x   x   x   and   y   y   y   coordinates lie on the circle around the origin with radius √3, that is, subject to the constraint       g   (  x  ,  y  )    =    x  2   +   y  2    =  3.          g   x  y       superscript  x  2    superscript  y  2         3.     g(x,y)=x^{2}+y^{2}=3.     As there is just a single constraint, we will use only one multiplier, say   λ   λ   λ   .  The constraint     g   (  x  ,  y  )    -  3        g   x  y    3    g(x,y)-3   is identically zero on the circle of radius √3. So any multiple of     g   (  x  ,  y  )    -  3        g   x  y    3    g(x,y)-3   may be added to    f   (  x  ,  y  )       f   x  y     f(x,y)   leaving    f   (  x  ,  y  )       f   x  y     f(x,y)   unchanged in the region of interest (above the circle where our original constraint is satisfied). Let        Λ   (  x  ,  y  ,  λ  )    =    f   (  x  ,  y  )    +   λ   (    g   (  x  ,  y  )    -  3   )     =     x  2   y   +   λ   (     x  2   +   y  2    -  3   )      .          normal-Λ   x  y  λ        f   x  y      λ      g   x  y    3               superscript  x  2   y     λ       superscript  x  2    superscript  y  2    3        \Lambda(x,y,\lambda)=f(x,y)+\lambda(g(x,y)-3)=x^{2}y+\lambda(x^{2}+y^{2}-3).     The critical values of   Λ   normal-Λ   Λ   occur where its gradient is zero. The partial derivatives are        ∂  Λ    ∂  x          normal-Λ     x     \displaystyle\frac{\partial\Lambda}{\partial x}     Equation (iii) is just the original constraint. Equation (i) implies    x  =  0      x  0    x=0    or     λ  =   −  y       λ    normal-−  y     λ=−y   . In the first case, if    x  =  0      x  0    x=0   then we must have    y  =   ±   3        y   plus-or-minus    3      y=\pm\sqrt{3}   by (iii) and then by (ii) λ = 0. In the second case, if    λ  =   −  y       λ    normal-−  y     λ=−y   and substituting into equation (ii) we have that,        x  2   -   2   y  2     =  0.         superscript  x  2     2   superscript  y  2     0.    x^{2}-2y^{2}=0.     Then 2 y 2 }} . Substituting into equation (iii) and solving for   y   y   y   gives    y  =   ±  1       y    normal-±  1     y=±1   . Thus there are six critical points:        (   2   ,  1  )   ;   (   -   2    ,  1  )   ;   (   2   ,   -  1   )   ;   (   -   2    ,   -  1   )   ;   (  0  ,   3   )   ;   (  0  ,   -   3    )    .        2   1        2    1      2     1         2      1     0    3     0      3       (\sqrt{2},1);\quad(-\sqrt{2},1);\quad(\sqrt{2},-1);\quad(-\sqrt{2},-1);\quad(0%
 ,\sqrt{3});\quad(0,-\sqrt{3}).     Evaluating the objective at these points, we find that        f   (   ±   2    ,  1  )    =  2   ;     f   (   ±   2    ,   -  1   )    =   -  2    ;    f   (  0  ,   ±   3    )    =  0.       formulae-sequence      f    plus-or-minus    2    1    2    formulae-sequence      f    plus-or-minus    2      1       2        f   0   plus-or-minus    3      0.      f(\pm\sqrt{2},1)=2;\quad f(\pm\sqrt{2},-1)=-2;\quad f(0,\pm\sqrt{3})=0.     Therefore, the objective function attains the global maximum (subject to the constraints) at    (   ±   2    ,  1  )      plus-or-minus    2    1    (\pm\sqrt{2},1)   and the global minimum at     (   ±   2    ,   -  1   )   .      plus-or-minus    2      1     (\pm\sqrt{2},-1).   The point    (  0  ,   3   )     0    3     (0,\sqrt{3})   is a local minimum and    (  0  ,   -   3    )     0      3      (0,-\sqrt{3})   is a local maximum , as may be determined by consideration of the Hessian matrix of    Λ   (  x  ,  y  ,  0  )       normal-Λ   x  y  0     \Lambda(x,y,0)   .  Note that while    (   2   ,  1  ,   -  1   )       2   1    1     (\sqrt{2},1,-1)   is a critical point of   Λ   normal-Λ   Λ   , it is not a local extremum. We have     Λ   (    2   +  ϵ   ,  1  ,    -  1   +  δ   )    =   2  +   δ   (    ϵ  2   +    (   2   2    )   ϵ    )           normal-Λ       2   ϵ   1      1   δ       2    δ     superscript  ϵ  2       2    2    ϵ        \Lambda(\sqrt{2}+\epsilon,1,-1+\delta)=2+\delta(\epsilon^{2}+(2\sqrt{2})\epsilon)   . Given any neighborhood of    (   2   ,  1  ,   -  1   )       2   1    1     (\sqrt{2},1,-1)   , we can choose a small positive   ϵ   ϵ   \epsilon   and a small   δ   δ   \delta   of either sign to get   Λ   normal-Λ   Λ   values both greater and less than   2   2   2   .  Example 3: Entropy  Suppose we wish to find the discrete probability distribution on the points    {   p  1   ,   p  2   ,  …  ,   p  n   }      subscript  p  1    subscript  p  2   normal-…   subscript  p  n     \{p_{1},p_{2},\ldots,p_{n}\}   with maximal information entropy . This is the same as saying that we wish to find the least biased probability distribution on the points    {   p  1   ,   p  2   ,  …  ,   p  n   }      subscript  p  1    subscript  p  2   normal-…   subscript  p  n     \{p_{1},p_{2},\ldots,p_{n}\}   . In other words, we wish to maximize the Shannon entropy equation:        f   (   p  1   ,   p  2   ,  …  ,   p  n   )    =   -    ∑   j  =  1   n     p  j     log  2    p  j        .        f    subscript  p  1    subscript  p  2   normal-…   subscript  p  n         superscript   subscript     j  1    n      subscript  p  j     subscript   2    subscript  p  j         f(p_{1},p_{2},\ldots,p_{n})=-\sum_{j=1}^{n}p_{j}\log_{2}p_{j}.     For this to be a probability distribution the sum of the probabilities    p  i     subscript  p  i    p_{i}   at each point    x  i     subscript  x  i    x_{i}   must equal 1, so our constraint is:       g   (   p  1   ,   p  2   ,  …  ,   p  n   )    =    ∑   j  =  1   n    p  j    =  1.          g    subscript  p  1    subscript  p  2   normal-…   subscript  p  n       superscript   subscript     j  1    n    subscript  p  j         1.     g(p_{1},p_{2},\ldots,p_{n})=\sum_{j=1}^{n}p_{j}=1.     We use Lagrange multipliers to find the point of maximum entropy,     p  →   *     superscript   normal-→  p      \vec{p}^{\,*}   , across all discrete probability distributions    p  →     normal-→  p    \vec{p}   on    {   x  1   ,   x  2   ,  …  ,   x  n   }      subscript  x  1    subscript  x  2   normal-…   subscript  x  n     \{x_{1},x_{2},\ldots,x_{n}\}   . We require that:           ∂   ∂   p  →      (   f  +   λ   (   g  -  1   )     )    |     p  →   =    p  →   *     =  0   ,       evaluated-at          normal-→  p       f    λ    g  1         normal-→  p    superscript   normal-→  p       0    \left.\frac{\partial}{\partial\vec{p}}(f+\lambda(g-1))\right|_{\vec{p}=\vec{p}%
 ^{\,*}}=0,     which gives a system of   n   n   n   equations,    k  =   1  ,  …  ,  n       k   1  normal-…  n     k={1,\ldots,n}   , such that:          ∂   ∂   p  k      {    -   (    ∑   j  =  1   n     p  j     log  2    p  j      )    +   λ   (     ∑   j  =  1   n    p  j    -  1   )     }    |     p  k   =   p  k  *     =  0.       evaluated-at          subscript  p  k            superscript   subscript     j  1    n      subscript  p  j     subscript   2    subscript  p  j         λ      superscript   subscript     j  1    n    subscript  p  j    1          subscript  p  k    subscript   superscript  p    k     0.    \left.\frac{\partial}{\partial p_{k}}\left\{-\left(\sum_{j=1}^{n}p_{j}\log_{2}%
 p_{j}\right)+\lambda\left(\sum_{j=1}^{n}p_{j}-1\right)\right\}\right|_{p_{k}=p%
 ^{*}_{k}}=0.     Carrying out the differentiation of these   n   n   n   equations, we get        -   (    1   ln  2    +    log  2    p  k  *     )    +  λ   =  0.              1    2      subscript   2    subscript   superscript  p    k      λ   0.    -\left(\frac{1}{\ln 2}+\log_{2}p^{*}_{k}\right)+\lambda=0.     This shows that all    p  k  *     subscript   superscript  p    k    p^{*}_{k}   are equal (because they depend on   λ   λ   λ   only). By using the constraint         ∑  j    p  j    =  1   ,        subscript   j    subscript  p  j    1    \sum_{j}p_{j}=1,     we find        p  k  *   =   1  n    .       subscript   superscript  p    k     1  n     p^{*}_{k}=\frac{1}{n}.     Hence, the uniform distribution is the distribution with the greatest entropy, among distributions on   n   n   n   points.  Example 4: Numerical optimization  (Figure)  Lagrange multipliers cause the critical points to occur at saddle points.   (Figure)  The magnitude of the gradient can be used to force the critical points to occur at local minima.   The critical points of Lagrangians occur at saddle points , rather than at local maxima (or minima). 6 Unfortunately, many numerical optimization techniques, such as hill climbing , gradient descent , some of the quasi-Newton methods , among others, are designed to find local maxima (or minima) and not saddle points. For this reason, one must either modify the formulation to ensure that it's a minimization problem (for example, by extremizing the square of the gradient of the Lagrangian as below), or else use an optimization technique that finds stationary points (such as Newton's method without an extremum seeking line search ) and not necessarily extrema.  As a simple example, consider the problem of finding the value of   x   x   x   that minimizes     f   (  x  )    =   x  2         f  x    superscript  x  2     f(x)=x^{2}   , constrained such that     x  2   =  1       superscript  x  2   1    x^{2}=1   . (This problem is somewhat pathological because there are only two values that satisfy this constraint, but it is useful for illustration purposes because the corresponding unconstrained function can be visualized in three dimensions.)  Using Lagrange multipliers, this problem can be converted into an unconstrained optimization problem:        Λ   (  x  ,  λ  )    =    x  2   +   λ   (    x  2   -  1   )      .        normal-Λ   x  λ       superscript  x  2     λ     superscript  x  2   1       \Lambda(x,\lambda)=x^{2}+\lambda(x^{2}-1).     The two critical points occur at saddle points where    x  =  1      x  1    x=1   and    x  =   −  1       x    normal-−  1     x=−1   .  In order to solve this problem with a numerical optimization technique, we must first transform this problem such that the critical points occur at local minima. This is done by computing the magnitude of the gradient of the unconstrained optimization problem.  First, we compute the partial derivative of the unconstrained problem with respect to each variable:        ∂  Λ    ∂  x    =    2  x   +   2  x  λ            normal-Λ     x        2  x     2  x  λ      \frac{\partial\Lambda}{\partial x}=2x+2x\lambda           ∂  Λ    ∂  λ    =    x  2   -  1.           normal-Λ     λ       superscript  x  2   1.     \frac{\partial\Lambda}{\partial\lambda}=x^{2}-1.     If the target function is not easily differentiable, the differential with respect to each variable can be approximated as        ∂  Λ    ∂  x    ≈     Λ   (   x  +  ϵ   ,  λ  )    -   Λ   (  x  ,  λ  )     ϵ           normal-Λ     x          normal-Λ     x  ϵ   λ      normal-Λ   x  λ     ϵ     \frac{\partial\Lambda}{\partial x}\approx\frac{\Lambda(x+\epsilon,\lambda)-%
 \Lambda(x,\lambda)}{\epsilon}   ,        ∂  Λ    ∂  λ    ≈     Λ   (  x  ,   λ  +  ϵ   )    -   Λ   (  x  ,  λ  )     ϵ           normal-Λ     λ          normal-Λ   x    λ  ϵ       normal-Λ   x  λ     ϵ     \frac{\partial\Lambda}{\partial\lambda}\approx\frac{\Lambda(x,\lambda+\epsilon%
 )-\Lambda(x,\lambda)}{\epsilon}   ,  where   ϵ   ϵ   \epsilon   is a small value.  Next, we compute the magnitude of the gradient, which is the square root of the sum of the squares of the partial derivatives:        h   (  x  ,  λ  )    =      (    2  x   +   2  x  λ    )   2   +    (    x  2   -  1   )   2     ≈      (     Λ   (   x  +  ϵ   ,  λ  )    -   Λ   (  x  ,  λ  )     ϵ   )   2   +    (     Λ   (  x  ,   λ  +  ϵ   )    -   Λ   (  x  ,  λ  )     ϵ   )   2      .          h   x  λ         superscript      2  x     2  x  λ    2    superscript     superscript  x  2   1   2               superscript        normal-Λ     x  ϵ   λ      normal-Λ   x  λ     ϵ   2    superscript        normal-Λ   x    λ  ϵ       normal-Λ   x  λ     ϵ   2        h(x,\lambda)=\sqrt{(2x+2x\lambda)^{2}+(x^{2}-1)^{2}}\approx\sqrt{\left(\frac{%
 \Lambda(x+\epsilon,\lambda)-\Lambda(x,\lambda)}{\epsilon}\right)^{2}+\left(%
 \frac{\Lambda(x,\lambda+\epsilon)-\Lambda(x,\lambda)}{\epsilon}\right)^{2}}.     (Since magnitude is always non-negative, optimizing over the squared-magnitude is equivalent to optimizing over the magnitude. Thus, the ``square root" may be omitted from these equations with no expected difference in the results of optimization.)  The critical points of   h   h   h   occur at    x  =  1      x  1    x=1   and    x  =   −  1       x    normal-−  1     x=−1   , just as in   Λ   normal-Λ   Λ   . Unlike the critical points in   Λ   normal-Λ   Λ   , however, the critical points in   h   h   h   occur at local minima, so numerical optimization techniques can be used to find them.  Applications  Economics  Constrained optimization plays a central role in economics . For example, the choice problem for a consumer is represented as one of maximizing a utility function subject to a budget constraint . The Lagrange multiplier has an economic interpretation as the shadow price associated with the constraint, in this example the marginal utility of income . Other examples include profit maximization for a firm, along with various macroeconomic applications.  Control theory  In optimal control theory, the Lagrange multipliers are interpreted as costate variables, and Lagrange multipliers are reformulated as the minimization of the Hamiltonian , in Pontryagin's minimum principle .  Nonlinear programming  The Lagrange multiplier method has several generalizations. In nonlinear programming there are several multiplier rules, e.g. , the Carathéodory-John Multiplier Rule and the Convex Multiplier Rule, for inequality constraints. 7  See also   Adjustment of observations  Duality  Karush–Kuhn–Tucker conditions : generalization of the method of Lagrange multipliers.  Lagrange multipliers on Banach spaces : another generalization of the method of Lagrange multipliers.  Lagrangian relaxation   References  External links  Exposition   Conceptual introduction (plus a brief discussion of Lagrange multipliers in the calculus of variations as used in physics)  Lagrange Multipliers for Quadratic Forms With Linear Constraints by Kenneth H. Carpenter   For additional text and interactive applets   Simple explanation with an example of governments using taxes as Lagrange multipliers  Lagrange Multipliers without Permanent Scarring Explanation with focus on the intuition by Dan Klein  Geometric Representation of Method of Lagrange Multipliers Provides compelling insight in 2 dimensions that at a minimizing point, the direction of steepest descent must be perpendicular to the tangent of the constraint curve at that point. [Needs InternetExplorer/Firefox/Safari] Mathematica demonstration by Shashi Sathyanarayana  Applet  Video Lecture of Lagrange Multipliers  MIT OpenCourseware Video Lecture on Lagrange Multipliers from Multivariable Calculus course  Slides accompanying Bertsekas's nonlinear optimization text , with details on Lagrange multipliers (lectures 11 and 12)  Geometric idea behind Lagrange multipliers   "  Category:Multivariable calculus  Category:Mathematical optimization  Category:Mathematical and quantitative methods (economics)     Mécanique Analytique sect. IV, 2 vols. Paris, 1811 https://archive.org/details/mcaniqueanalyt01lagr ↩  ↩  . ↩  ↩  Chiang, Alpha C. , Fundamental Methods of Mathematical Economics , McGraw-Hill, third edition, 1984: p. 386. isbn:9757860069 ↩  ↩  ↩     
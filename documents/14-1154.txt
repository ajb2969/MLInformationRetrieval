   Wahba's problem      Wahba's problem   In applied mathematics, Wahba's problem , first posed by Grace Wahba in 1965, seeks to find a rotation matrix ( special orthogonal matrix ) between two coordinate systems from a set of (weighted) vector observations. Solutions to Wahba's problem are often used in satellite  attitude determination utilising sensors such as magnetometers and multi-antenna GPS receivers . The cost function that Wahba's problem seeks to minimise is as follows:       J   (  𝐑  )    =    1  2     ∑   k  =  1   N     a  k     ||    𝐰  k   -   𝐑𝐯  k    ||   2            J  𝐑       1  2     superscript   subscript     k  1    N      subscript  a  k    superscript   norm     subscript  𝐰  k    subscript  𝐑𝐯  k     2        J(\mathbf{R})=\frac{1}{2}\sum_{k=1}^{N}a_{k}||\mathbf{w}_{k}-\mathbf{R}\mathbf%
 {v}_{k}||^{2}     where    𝐰  k     subscript  𝐰  k    \mathbf{w}_{k}   is the k -th 3-vector measurement in the reference frame,    𝐯  k     subscript  𝐯  k    \mathbf{v}_{k}   is the corresponding k -th 3-vector measurement in the body frame and   𝐑   𝐑   \mathbf{R}   is a 3 by 3 rotation matrix between the coordinate frames.    a  k     subscript  a  k    a_{k}   is an optional set of weights for each observation.  A number of solutions to the problem have appeared in literature, notably Davenport's q-method, QUEST and singular value decomposition -based methods.  Solution by Singular Value Decomposition  One solution can be found using a singular value decomposition as reported by Markley  1. Obtain a matrix   𝐁   𝐁   \mathbf{B}   as follows:      𝐁  =    ∑   i  =  1   n     a  i    𝐰  i    𝐯  i    T         𝐁    superscript   subscript     i  1    n      subscript  a  i    subscript  𝐰  i    superscript   subscript  𝐯  i   T       \mathbf{B}=\sum_{i=1}^{n}a_{i}\mathbf{w}_{i}{\mathbf{v}_{i}}^{T}     2. Find the singular value decomposition of   𝐁   𝐁   \mathbf{B}       𝐁  =   𝐔𝐒𝐕  T       𝐁   superscript  𝐔𝐒𝐕  T     \mathbf{B}=\mathbf{U}\mathbf{S}\mathbf{V}^{T}     3. The rotation matrix is simply:      𝐑  =   𝐔𝐌𝐕  T       𝐑   superscript  𝐔𝐌𝐕  T     \mathbf{R}=\mathbf{U}\mathbf{M}\mathbf{V}^{T}     where    𝐌  =   diag   (   [     1    1     det    (  𝐔  )    det   (  𝐕  )         ]   )        𝐌   diag    1  1      𝐔    𝐕          \mathbf{M}=\operatorname{diag}(\begin{bmatrix}1&1&\det(\mathbf{U})\det(\mathbf%
 {V})\end{bmatrix})     References   Markley, F. L. Attitude Determination using Vector Observations and the Singular Value Decomposition Journal of the Astronautical Sciences, 1988, 38, 245-258    Wahba, G. Problem 65–1: A Least Squares Estimate of Spacecraft Attitude, SIAM Review, 1965, 7(3), 409   See also   Kabsch algorithm   "  Category:Applied mathematics   
   Wahba's problem      Wahba's problem   In applied mathematics, Wahba's problem , first posed by Grace Wahba in 1965, seeks to find a rotation matrix ( special orthogonal matrix ) between two coordinate systems from a set of (weighted) vector observations. Solutions to Wahba's problem are often used in satellite  attitude determination utilising sensors such as magnetometers and multi-antenna GPS receivers . The cost function that Wahba's problem seeks to minimise is as follows:       J   (  ğ‘  )    =    1  2     âˆ‘   k  =  1   N     a  k     ||    ğ°  k   -   ğ‘ğ¯  k    ||   2            J  ğ‘       1  2     superscript   subscript     k  1    N      subscript  a  k    superscript   norm     subscript  ğ°  k    subscript  ğ‘ğ¯  k     2        J(\mathbf{R})=\frac{1}{2}\sum_{k=1}^{N}a_{k}||\mathbf{w}_{k}-\mathbf{R}\mathbf%
 {v}_{k}||^{2}     where    ğ°  k     subscript  ğ°  k    \mathbf{w}_{k}   is the k -th 3-vector measurement in the reference frame,    ğ¯  k     subscript  ğ¯  k    \mathbf{v}_{k}   is the corresponding k -th 3-vector measurement in the body frame and   ğ‘   ğ‘   \mathbf{R}   is a 3 by 3 rotation matrix between the coordinate frames.    a  k     subscript  a  k    a_{k}   is an optional set of weights for each observation.  A number of solutions to the problem have appeared in literature, notably Davenport's q-method, QUEST and singular value decomposition -based methods.  Solution by Singular Value Decomposition  One solution can be found using a singular value decomposition as reported by Markley  1. Obtain a matrix   ğ   ğ   \mathbf{B}   as follows:      ğ  =    âˆ‘   i  =  1   n     a  i    ğ°  i    ğ¯  i    T         ğ    superscript   subscript     i  1    n      subscript  a  i    subscript  ğ°  i    superscript   subscript  ğ¯  i   T       \mathbf{B}=\sum_{i=1}^{n}a_{i}\mathbf{w}_{i}{\mathbf{v}_{i}}^{T}     2. Find the singular value decomposition of   ğ   ğ   \mathbf{B}       ğ  =   ğ”ğ’ğ•  T       ğ   superscript  ğ”ğ’ğ•  T     \mathbf{B}=\mathbf{U}\mathbf{S}\mathbf{V}^{T}     3. The rotation matrix is simply:      ğ‘  =   ğ”ğŒğ•  T       ğ‘   superscript  ğ”ğŒğ•  T     \mathbf{R}=\mathbf{U}\mathbf{M}\mathbf{V}^{T}     where    ğŒ  =   diag   (   [     1    1     det    (  ğ”  )    det   (  ğ•  )         ]   )        ğŒ   diag    1  1      ğ”    ğ•          \mathbf{M}=\operatorname{diag}(\begin{bmatrix}1&1&\det(\mathbf{U})\det(\mathbf%
 {V})\end{bmatrix})     References   Markley, F. L. Attitude Determination using Vector Observations and the Singular Value Decomposition Journal of the Astronautical Sciences, 1988, 38, 245-258    Wahba, G. Problem 65â€“1: A Least Squares Estimate of Spacecraft Attitude, SIAM Review, 1965, 7(3), 409   See also   Kabsch algorithm   "  Category:Applied mathematics   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="343">K-SVD</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>K-SVD</h1>
<hr/>

<p>In <a href="applied_mathematics" title="wikilink">applied mathematics</a>, <strong>K-SVD</strong> is a <a href="dictionary_learning" title="wikilink">dictionary learning</a> algorithm for creating a dictionary for <a href="sparse_representation" title="wikilink">sparse representations</a>, via a <a href="singular_value_decomposition" title="wikilink">singular value decomposition</a> approach. K-SVD is a generalization of the <a href="k-means_clustering" title="wikilink">k-means clustering</a> method, and it works by iteratively alternating between sparse coding the input data based on the current dictionary, and updating the atoms in the dictionary to better fit the data.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> K-SVD can be found widely in use in applications such as image processing, audio processing, biology, and document analysis.</p>
<h2 id="problem-description">Problem description</h2>

<p>The goal of dictionary learning is to learn an overcomplete dictionary matrix 

<math display="inline" id="K-SVD:0">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mo>∈</mo>
   <msup>
    <mi>ℝ</mi>
    <mrow>
     <mi>n</mi>
     <mo>×</mo>
     <mi>K</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>D</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>K</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D\in\mathbb{R}^{n\times K}
  </annotation>
 </semantics>
</math>

 that contains 

<math display="inline" id="K-SVD:1">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 signal-atoms (in this notation, columns of 

<math display="inline" id="K-SVD:2">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

). A signal vector 

<math display="inline" id="K-SVD:3">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>∈</mo>
   <msup>
    <mi>ℝ</mi>
    <mi>n</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\in\mathbb{R}^{n}
  </annotation>
 </semantics>
</math>

 can be represented, <a href="sparse_vector" title="wikilink">sparsely</a>, as a linear combination of these atoms; to represent 

<math display="inline" id="K-SVD:4">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

, the representation vector 

<math display="inline" id="K-SVD:5">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 should satisfy the exact condition 

<math display="inline" id="K-SVD:6">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=Dx
  </annotation>
 </semantics>
</math>

, or the approximate condition 

<math display="inline" id="K-SVD:7">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>≈</mo>
   <mrow>
    <mi>D</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\approx Dx
  </annotation>
 </semantics>
</math>

, made precise by requiring that 

<math display="inline" id="K-SVD:8">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <mi>y</mi>
      <mo>-</mo>
      <mrow>
       <mi>D</mi>
       <mi>x</mi>
      </mrow>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mi>p</mi>
   </msub>
   <mo>≤</mo>
   <mi>ϵ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">norm</csymbol>
      <apply>
       <minus></minus>
       <ci>y</ci>
       <apply>
        <times></times>
        <ci>D</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <ci>p</ci>
    </apply>
    <ci>ϵ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|y-Dx\|_{p}\leq\epsilon
  </annotation>
 </semantics>
</math>

 for some small value 

<math display="inline" id="K-SVD:9">
 <semantics>
  <mi>ε</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ε</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ε
  </annotation>
 </semantics>
</math>

 and some <a href="Lp_norm" title="wikilink">

<math display="inline" id="K-SVD:10">
 <semantics>
  <mrow>
   <mi>L</mi>
   <mi>ₚ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>L</ci>
    <ci>ₚ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Lₚ
  </annotation>
 </semantics>
</math>

 norm</a>. The vector 

<math display="inline" id="K-SVD:11">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>∈</mo>
   <msup>
    <mi>ℝ</mi>
    <mi>K</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>ℝ</ci>
     <ci>K</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in\mathbb{R}^{K}
  </annotation>
 </semantics>
</math>

 contains the representation coefficients of the signal 

<math display="inline" id="K-SVD:12">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y
  </annotation>
 </semantics>
</math>

. Typically, the norm 

<math display="inline" id="K-SVD:13">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 is selected as <a href="L1_norm" title="wikilink"><mtpl></mtpl></a>, <a href="L2_norm" title="wikilink"><mtpl></mtpl></a>, or <a href="Uniform_norm" title="wikilink"><mtpl></mtpl></a>.</p>

<p>If 

<math display="inline" id="K-SVD:14">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo><</mo>
   <mi>K</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <ci>n</ci>
    <ci>K</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n<K
  </annotation>
 </semantics>
</math>

 and D is a full-rank matrix, an infinite number of solutions are available for the representation problem, Hence, constraints should be set on the solution. Also, to ensure sparsity, the solution with the fewest number of nonzero coefficients is preferred. Thus, the sparsity representation is the solution of either</p>

<p>

<math display="block" id="K-SVD:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>P</mi>
      <mn>0</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <munder>
      <mi>min</mi>
      <mi>x</mi>
     </munder>
     <msub>
      <mrow>
       <mo>∥</mo>
       <mi>x</mi>
       <mo>∥</mo>
      </mrow>
      <mn>0</mn>
     </msub>
    </mrow>
    <mrow>
     <mtext>subject to</mtext>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>D</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <ci>x</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>subject to</mtext>
      <ci>y</ci>
     </apply>
    </list>
    <apply>
     <times></times>
     <ci>D</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (P_{0})\quad\min\limits_{x}\|x\|_{0}\qquad\text{subject to }y=Dx
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="K-SVD:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>P</mi>
      <mrow>
       <mn>0</mn>
       <mo>,</mo>
       <mi>ϵ</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <munder>
      <mi>min</mi>
      <mi>x</mi>
     </munder>
     <msub>
      <mrow>
       <mo>∥</mo>
       <mi>x</mi>
       <mo>∥</mo>
      </mrow>
      <mn>0</mn>
     </msub>
    </mrow>
    <mrow>
     <mtext>subject to</mtext>
     <msub>
      <mrow>
       <mo>∥</mo>
       <mrow>
        <mi>y</mi>
        <mo>-</mo>
        <mrow>
         <mi>D</mi>
         <mi>x</mi>
        </mrow>
       </mrow>
       <mo>∥</mo>
      </mrow>
      <mn>2</mn>
     </msub>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mi>ϵ</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <list>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <list>
       <cn type="integer">0</cn>
       <ci>ϵ</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <ci>x</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>subject to</mtext>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>y</ci>
         <apply>
          <times></times>
          <ci>D</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </list>
    <ci>ϵ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (P_{0,\epsilon})\quad\min\limits_{x}\|x\|_{0}\qquad\text{subject to }\|y-Dx\|_%
{2}\leq\epsilon
  </annotation>
 </semantics>
</math>

</p>

<p>where the 

<math display="inline" id="K-SVD:17">
 <semantics>
  <msub>
   <mrow>
    <mo>∥</mo>
    <mi>x</mi>
    <mo>∥</mo>
   </mrow>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="latexml">norm</csymbol>
     <ci>x</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|x\|_{0}
  </annotation>
 </semantics>
</math>

 counts the nonzero entries in the vector 

<math display="inline" id="K-SVD:18">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

. (See <a href="Lp_space#When_p_.3D_0" title="wikilink">the zero "norm"</a>.)</p>
<h2 id="k-svd-algorithm">K-SVD algorithm</h2>

<p>K-SVD is a kind of generalization of K-means, as follows. The <a href="k-means_clustering" title="wikilink">k-means clustering</a> can be also regarded as a method of <a href="sparse_representation" title="wikilink">sparse representation</a>. That is, finding the best possible codebook to represent the data samples 

<math display="inline" id="K-SVD:19">
 <semantics>
  <msubsup>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
   </mrow>
   <mi>M</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <set>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
     </set>
     <ci>M</ci>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{y_{i}\}^{M}_{i=1}
  </annotation>
 </semantics>
</math>

 by <a href="Nearest_neighbor_search" title="wikilink">nearest neighbor</a>, by solving</p>

<p>

<math display="block" id="K-SVD:20">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <munder>
       <mpadded lspace="10pt" width="+10pt">
        <mi>min</mi>
       </mpadded>
       <mrow>
        <mi>D</mi>
        <mo>,</mo>
        <mi>X</mi>
       </mrow>
      </munder>
      <mrow>
       <mo stretchy="false">{</mo>
       <msubsup>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mi>Y</mi>
          <mo>-</mo>
          <mrow>
           <mi>D</mi>
           <mi>X</mi>
          </mrow>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mi>F</mi>
        <mn>2</mn>
       </msubsup>
       <mo stretchy="false">}</mo>
      </mrow>
     </mrow>
     <mrow>
      <mtext>subject to</mtext>
      <mrow>
       <mo>∀</mo>
       <mi>i</mi>
      </mrow>
     </mrow>
     <mo>,</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>e</mi>
      <mi>k</mi>
     </msub>
     <mtext>for some</mtext>
     <mi>k</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <list>
        <ci>D</ci>
        <ci>X</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>Y</ci>
          <apply>
           <times></times>
           <ci>D</ci>
           <ci>X</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>F</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <mtext>subject to</mtext>
      <apply>
       <csymbol cd="latexml">for-all</csymbol>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>i</ci>
     </apply>
    </list>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <ci>k</ci>
     </apply>
     <mtext>for some</mtext>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \quad\min\limits_{D,X}\{\|Y-DX\|^{2}_{F}\}\qquad\text{subject to }\forall i,x_%
{i}=e_{k}\text{ for some }k.
  </annotation>
 </semantics>
</math>

</p>

<p>which is quite similar to</p>

<p>

<math display="block" id="K-SVD:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mpadded lspace="10pt" width="+10pt">
       <mi>min</mi>
      </mpadded>
      <mrow>
       <mi>D</mi>
       <mo>,</mo>
       <mi>X</mi>
      </mrow>
     </munder>
     <mrow>
      <mo stretchy="false">{</mo>
      <msubsup>
       <mrow>
        <mo>∥</mo>
        <mrow>
         <mi>Y</mi>
         <mo>-</mo>
         <mrow>
          <mi>D</mi>
          <mi>X</mi>
         </mrow>
        </mrow>
        <mo>∥</mo>
       </mrow>
       <mi>F</mi>
       <mn>2</mn>
      </msubsup>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
    <mtext>subject to</mtext>
    <mrow>
     <mo>∀</mo>
     <mi>i</mi>
    </mrow>
    <mo>,</mo>
    <msub>
     <mrow>
      <mo>∥</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo>∥</mo>
     </mrow>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <list>
        <ci>D</ci>
        <ci>X</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>Y</ci>
          <apply>
           <times></times>
           <ci>D</ci>
           <ci>X</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>F</ci>
      </apply>
     </apply>
     <mtext>subject to</mtext>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </list>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \quad\min\limits_{D,X}\{\|Y-DX\|^{2}_{F}\}\qquad\text{subject to }\quad\forall
i%
,\|x_{i}\|_{0}=1.
  </annotation>
 </semantics>
</math>

</p>

<p>The sparse representation term 

<math display="inline" id="K-SVD:22">
 <semantics>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>e</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}=e_{k}
  </annotation>
 </semantics>
</math>

 enforces K-means algorithm to use only one atom (column) in dictionary D. To relax this constraint, the target of the K-SVD algorithm is to represent signal as a linear combination of atoms in D.</p>

<p>The K-SVD algorithm follows the construction flow of K-means algorithm. However, In contrary to K-means, in order to achieve linear combination of atoms in D, sparsity term of the constrain is relaxed so that nonzero entries of each column 

<math display="inline" id="K-SVD:23">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 can be more than 1, but less than a number 

<math display="inline" id="K-SVD:24">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

.</p>

<p>So, the objective function becomes</p>

<p>

<math display="block" id="K-SVD:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <munder>
       <mpadded lspace="10pt" width="+10pt">
        <mi>min</mi>
       </mpadded>
       <mrow>
        <mi>D</mi>
        <mo>,</mo>
        <mi>X</mi>
       </mrow>
      </munder>
      <mrow>
       <mo stretchy="false">{</mo>
       <msubsup>
        <mrow>
         <mo>∥</mo>
         <mrow>
          <mi>Y</mi>
          <mo>-</mo>
          <mrow>
           <mi>D</mi>
           <mi>X</mi>
          </mrow>
         </mrow>
         <mo>∥</mo>
        </mrow>
        <mi>F</mi>
        <mn>2</mn>
       </msubsup>
       <mo stretchy="false">}</mo>
      </mrow>
     </mrow>
     <mtext>subject to</mtext>
     <mrow>
      <mo>∀</mo>
      <mpadded width="+2.8pt">
       <mi>i</mi>
      </mpadded>
     </mrow>
     <mo>,</mo>
     <msub>
      <mrow>
       <mo>∥</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>∥</mo>
      </mrow>
      <mn>0</mn>
     </msub>
    </mrow>
    <mo>≤</mo>
    <msub>
     <mi>T</mi>
     <mn>0</mn>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <list>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <list>
        <ci>D</ci>
        <ci>X</ci>
       </list>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <minus></minus>
          <ci>Y</ci>
          <apply>
           <times></times>
           <ci>D</ci>
           <ci>X</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>F</ci>
      </apply>
     </apply>
     <mtext>subject to</mtext>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \quad\min\limits_{D,X}\{\|Y-DX\|^{2}_{F}\}\qquad\text{subject to }\quad\forall
i%
\;,\|x_{i}\|_{0}\leq T_{0}.
  </annotation>
 </semantics>
</math>

</p>

<p>or in another objective form</p>

<p>

<math display="block" id="K-SVD:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <munder>
       <mpadded lspace="10pt" width="+10pt">
        <mi>min</mi>
       </mpadded>
       <mrow>
        <mi>D</mi>
        <mo>,</mo>
        <mi>X</mi>
       </mrow>
      </munder>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mi>i</mi>
       </munder>
       <msub>
        <mrow>
         <mo>∥</mo>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>∥</mo>
        </mrow>
        <mn>0</mn>
       </msub>
      </mrow>
     </mrow>
     <mtext>subject to</mtext>
     <mrow>
      <mo>∀</mo>
      <mpadded width="+2.8pt">
       <mi>i</mi>
      </mpadded>
     </mrow>
     <mo>,</mo>
     <msubsup>
      <mrow>
       <mo>∥</mo>
       <mrow>
        <mi>Y</mi>
        <mo>-</mo>
        <mrow>
         <mi>D</mi>
         <mi>X</mi>
        </mrow>
       </mrow>
       <mo>∥</mo>
      </mrow>
      <mi>F</mi>
      <mn>2</mn>
     </msubsup>
    </mrow>
    <mo>≤</mo>
    <mi>ϵ</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <list>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <min></min>
       <list>
        <ci>D</ci>
        <ci>X</ci>
       </list>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">norm</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
     <mtext>subject to</mtext>
     <apply>
      <csymbol cd="latexml">for-all</csymbol>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>Y</ci>
         <apply>
          <times></times>
          <ci>D</ci>
          <ci>X</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>F</ci>
     </apply>
    </list>
    <ci>ϵ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \quad\min\limits_{D,X}\sum_{i}\|x_{i}\|_{0}\qquad\text{subject to }\quad%
\forall i\;,\|Y-DX\|^{2}_{F}\leq\epsilon.
  </annotation>
 </semantics>
</math>

</p>

<p>In the K-SVD algorithm, the 

<math display="inline" id="K-SVD:27">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 is first to be fixed and the best coefficient matrix 

<math display="inline" id="K-SVD:28">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

. As finding the truly optimal 

<math display="inline" id="K-SVD:29">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 is impossible, we use an approximation pursuit method. Any such algorithm as OMP, the orthogonal <a href="matching_pursuit" title="wikilink">matching pursuit</a> in can be used for the calculation of the coefficients, as long as it can supply a solution with a fixed and predetermined number of nonzero entries 

<math display="inline" id="K-SVD:30">
 <semantics>
  <msub>
   <mi>T</mi>
   <mn>0</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>T</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{0}
  </annotation>
 </semantics>
</math>

.</p>

<p>After the sparse coding task, the next is to search for a better dictionary 

<math display="inline" id="K-SVD:31">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

. However, finding the whole dictionary all at a time is impossible, so the process then update only one column of the dictionary 

<math display="inline" id="K-SVD:32">
 <semantics>
  <mi>D</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>D</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D
  </annotation>
 </semantics>
</math>

 each time while fix 

<math display="inline" id="K-SVD:33">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

. The update of 

<math display="inline" id="K-SVD:34">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-th
  </annotation>
 </semantics>
</math>

is done by rewriting the penalty term as</p>

<p>

<math display="block" id="K-SVD:35">
 <semantics>
  <mrow>
   <msubsup>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <mi>Y</mi>
      <mo>-</mo>
      <mrow>
       <mi>D</mi>
       <mi>X</mi>
      </mrow>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mi>F</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mrow>
     <mo>|</mo>
     <mrow>
      <mi>Y</mi>
      <mo>-</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>j</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>K</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>d</mi>
         <mi>j</mi>
        </msub>
        <msubsup>
         <mi>x</mi>
         <mi>T</mi>
         <mi>j</mi>
        </msubsup>
       </mrow>
      </mrow>
     </mrow>
     <mo>|</mo>
    </mrow>
    <mi>F</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mrow>
     <mo>|</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>Y</mi>
        <mo>-</mo>
        <mrow>
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>j</mi>
           <mo>≠</mo>
           <mi>k</mi>
          </mrow>
         </munder>
         <mrow>
          <msub>
           <mi>d</mi>
           <mi>j</mi>
          </msub>
          <msubsup>
           <mi>x</mi>
           <mi>T</mi>
           <mi>j</mi>
          </msubsup>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mi>k</mi>
       </msub>
       <msubsup>
        <mi>x</mi>
        <mi>T</mi>
        <mi>k</mi>
       </msubsup>
      </mrow>
     </mrow>
     <mo>|</mo>
    </mrow>
    <mi>F</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <msub>
       <mi>E</mi>
       <mi>k</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mi>k</mi>
       </msub>
       <msubsup>
        <mi>x</mi>
        <mi>T</mi>
        <mi>k</mi>
       </msubsup>
      </mrow>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mi>F</mi>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <ci>Y</ci>
         <apply>
          <times></times>
          <ci>D</ci>
          <ci>X</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>F</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <ci>Y</ci>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>j</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>K</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>d</ci>
            <ci>j</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>x</ci>
             <ci>j</ci>
            </apply>
            <ci>T</ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>F</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <abs></abs>
        <apply>
         <minus></minus>
         <apply>
          <minus></minus>
          <ci>Y</ci>
          <apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <neq></neq>
             <ci>j</ci>
             <ci>k</ci>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>d</ci>
             <ci>j</ci>
            </apply>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>x</ci>
              <ci>j</ci>
             </apply>
             <ci>T</ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>d</ci>
           <ci>k</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>x</ci>
            <ci>k</ci>
           </apply>
           <ci>T</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>F</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">norm</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>d</ci>
           <ci>k</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>x</ci>
            <ci>k</ci>
           </apply>
           <ci>T</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>F</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|Y-DX\|^{2}_{F}=\left|Y-\sum_{j=1}^{K}d_{j}x^{j}_{T}\right|^{2}_{F}=\left|%
\left(Y-\sum_{j\neq k}d_{j}x^{j}_{T}\right)-d_{k}x^{k}_{T}\right|^{2}_{F}=\|E_%
{k}-d_{k}x^{k}_{T}\|^{2}_{F}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="K-SVD:36">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mi>T</mi>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{k}_{T}
  </annotation>
 </semantics>
</math>

 denotes the <em>k</em>-th row of <em>X</em>.</p>

<p>By decomposing the multiplication 

<math display="inline" id="K-SVD:37">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>D</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   DX
  </annotation>
 </semantics>
</math>

 into sum of 

<math display="inline" id="K-SVD:38">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 rank 1 matrices, we can assume the other 

<math display="inline" id="K-SVD:39">
 <semantics>
  <mrow>
   <mi>K</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>K</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K-1
  </annotation>
 </semantics>
</math>

 terms are assumed fixed, and the 

<math display="inline" id="K-SVD:40">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-th
  </annotation>
 </semantics>
</math>

 remains unknown. After this step, we can solve the minimization problem by approximate the 

<math display="inline" id="K-SVD:41">
 <semantics>
  <msub>
   <mi>E</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>E</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E_{k}
  </annotation>
 </semantics>
</math>

 term with a 

<math display="inline" id="K-SVD:42">
 <semantics>
  <mrow>
   <mrow>
    <mi>r</mi>
    <mi>a</mi>
    <mi>n</mi>
    <mi>k</mi>
   </mrow>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <ci>r</ci>
     <ci>a</ci>
     <ci>n</ci>
     <ci>k</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   rank-1
  </annotation>
 </semantics>
</math>

 matrix using <a href="singular_value_decomposition" title="wikilink">singular value decomposition</a>, then update 

<math display="inline" id="K-SVD:43">
 <semantics>
  <msub>
   <mi>d</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{k}
  </annotation>
 </semantics>
</math>

 with it. However, the new solution of vector 

<math display="inline" id="K-SVD:44">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mi>T</mi>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{k}_{T}
  </annotation>
 </semantics>
</math>

 is very likely to be filled, because the sparsity constrain is not enforced.</p>

<p>To cure this problem, Define 

<math display="inline" id="K-SVD:45">
 <semantics>
  <msub>
   <mi>ω</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ω</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{k}
  </annotation>
 </semantics>
</math>

 as</p>

<p>

<math display="block" id="K-SVD:46">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ω</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo stretchy="false">{</mo>
     <mi>i</mi>
     <mo>∣</mo>
     <mrow>
      <mrow>
       <mn>1</mn>
       <mo>≤</mo>
       <mi>i</mi>
       <mo>≤</mo>
       <mi>N</mi>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mrow>
        <msubsup>
         <mi>x</mi>
         <mi>T</mi>
         <mi>k</mi>
        </msubsup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>i</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>≠</mo>
       <mn>0</mn>
      </mrow>
     </mrow>
     <mo stretchy="false">}</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ω</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <ci>i</ci>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <and></and>
       <apply>
        <leq></leq>
        <cn type="integer">1</cn>
        <ci>i</ci>
       </apply>
       <apply>
        <leq></leq>
        <share href="#.cmml">
        </share>
        <ci>N</ci>
       </apply>
      </apply>
      <apply>
       <neq></neq>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <ci>T</ci>
        </apply>
        <ci>i</ci>
       </apply>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega_{k}=\{i\mid 1\leq i\leq N,x^{k}_{T}(i)\neq 0\}.
  </annotation>
 </semantics>
</math>

</p>

<p>Which points to examples 

<math display="inline" id="K-SVD:47">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{y_{i}\}
  </annotation>
 </semantics>
</math>

 that use atom 

<math display="inline" id="K-SVD:48">
 <semantics>
  <msub>
   <mi>d</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{k}
  </annotation>
 </semantics>
</math>

 (also the entries of 

<math display="inline" id="K-SVD:49">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 that is nonzero). Then, define 

<math display="inline" id="K-SVD:50">
 <semantics>
  <msub>
   <mi mathvariant="normal">Ω</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>normal-Ω</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Omega_{k}
  </annotation>
 </semantics>
</math>

 as a matrix of size 

<math display="inline" id="K-SVD:51">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>×</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>ω</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">|</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <apply>
     <abs></abs>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ω</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\times|\omega_{k}|
  </annotation>
 </semantics>
</math>

, with ones on the 

<math display="inline" id="K-SVD:52">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>i</mi>
    <mtext>-th</mtext>
   </mrow>
   <mo>,</mo>
   <mrow>
    <msub>
     <mi>ω</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>i</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <interval closure="open">
    <apply>
     <times></times>
     <ci>i</ci>
     <mtext>-th</mtext>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ω</ci>
      <ci>k</ci>
     </apply>
     <ci>i</ci>
    </apply>
   </interval>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i\text{-th},\omega_{k}(i))
  </annotation>
 </semantics>
</math>

 entries and zeros otherwise. When multiplying 

<math display="inline" id="K-SVD:53">
 <semantics>
  <mrow>
   <msubsup>
    <mi>x</mi>
    <mi>R</mi>
    <mi>k</mi>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mi>T</mi>
     <mi>k</mi>
    </msubsup>
    <msub>
     <mi mathvariant="normal">Ω</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>R</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>T</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ω</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{R}^{k}=x^{k}_{T}\Omega_{k}
  </annotation>
 </semantics>
</math>

, this shrinks the row vector 

<math display="inline" id="K-SVD:54">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mi>T</mi>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>T</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{T}^{k}
  </annotation>
 </semantics>
</math>

 by discarding the nonzero entries. Similarly, the multiplication 

<math display="inline" id="K-SVD:55">
 <semantics>
  <mrow>
   <msubsup>
    <mi>Y</mi>
    <mi>k</mi>
    <mi>R</mi>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mi>Y</mi>
    <msub>
     <mi mathvariant="normal">Ω</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>Y</ci>
      <ci>R</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <ci>Y</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ω</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y^{R}_{k}=Y\Omega_{k}
  </annotation>
 </semantics>
</math>

 is the subset of the examples that are current using the 

<math display="inline" id="K-SVD:56">
 <semantics>
  <msub>
   <mi>d</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{k}
  </annotation>
 </semantics>
</math>

 atom. The same effect can be seen on 

<math display="inline" id="K-SVD:57">
 <semantics>
  <mrow>
   <msubsup>
    <mi>E</mi>
    <mi>k</mi>
    <mi>R</mi>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>E</mi>
     <mi>k</mi>
    </msub>
    <msub>
     <mi mathvariant="normal">Ω</mi>
     <mi>k</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>E</ci>
      <ci>R</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>E</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>normal-Ω</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E^{R}_{k}=E_{k}\Omega_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>So the minimization problem as mentioned before becomes</p>

<p>

<math display="block" id="K-SVD:58">
 <semantics>
  <mrow>
   <msubsup>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <mrow>
       <msub>
        <mi>E</mi>
        <mi>k</mi>
       </msub>
       <msub>
        <mi mathvariant="normal">Ω</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mi>k</mi>
       </msub>
       <msubsup>
        <mi>x</mi>
        <mi>T</mi>
        <mi>k</mi>
       </msubsup>
       <msub>
        <mi mathvariant="normal">Ω</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mi>F</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <msubsup>
    <mrow>
     <mo>∥</mo>
     <mrow>
      <msubsup>
       <mi>E</mi>
       <mi>k</mi>
       <mi>R</mi>
      </msubsup>
      <mo>-</mo>
      <mrow>
       <msub>
        <mi>d</mi>
        <mi>k</mi>
       </msub>
       <msubsup>
        <mi>x</mi>
        <mi>R</mi>
        <mi>k</mi>
       </msubsup>
      </mrow>
     </mrow>
     <mo>∥</mo>
    </mrow>
    <mi>F</mi>
    <mn>2</mn>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>E</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ω</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>k</ci>
          </apply>
          <ci>T</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>normal-Ω</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>F</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">norm</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>E</ci>
          <ci>R</ci>
         </apply>
         <ci>k</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>d</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <ci>k</ci>
          </apply>
          <ci>R</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <cn type="integer">2</cn>
     </apply>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \|E_{k}\Omega_{k}-d_{k}x^{k}_{T}\Omega_{k}\|^{2}_{F}=\|E^{R}_{k}-d_{k}x^{k}_{R%
}\|^{2}_{F}
  </annotation>
 </semantics>
</math>

</p>

<p>and can be done by directly using SVD. SVD decomposes 

<math display="inline" id="K-SVD:59">
 <semantics>
  <msubsup>
   <mi>E</mi>
   <mi>k</mi>
   <mi>R</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>E</ci>
     <ci>R</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E^{R}_{k}
  </annotation>
 </semantics>
</math>

 into 

<math display="inline" id="K-SVD:60">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mi mathvariant="normal">Δ</mi>
   <msup>
    <mi>V</mi>
    <mi>T</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <ci>normal-Δ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>V</ci>
     <ci>T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U\Delta V^{T}
  </annotation>
 </semantics>
</math>

. The solution for 

<math display="inline" id="K-SVD:61">
 <semantics>
  <msub>
   <mi>d</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>d</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d_{k}
  </annotation>
 </semantics>
</math>

 is the first column of U, the coefficient vector 

<math display="inline" id="K-SVD:62">
 <semantics>
  <msubsup>
   <mi>x</mi>
   <mi>R</mi>
   <mi>k</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
    <ci>R</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x^{k}_{R}
  </annotation>
 </semantics>
</math>

 as the first column of 

<math display="inline" id="K-SVD:63">
 <semantics>
  <mrow>
   <mrow>
    <mi>V</mi>
    <mo>×</mo>
    <mi mathvariant="normal">Δ</mi>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <times></times>
     <ci>V</ci>
     <ci>normal-Δ</ci>
    </apply>
    <interval closure="open">
     <cn type="integer">1</cn>
     <cn type="integer">1</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V\times\Delta(1,1)
  </annotation>
 </semantics>
</math>

. After updated the whole dictionary, the process then turns to iteratively solve X, then iteratively solve D.</p>
<h2 id="limitations">Limitations</h2>

<p>Choosing an appropriate "dictionary" for a dataset is a non-convex problem, and K-SVD operates by an iterative update which does not guarantee to find the global optimum.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> However, this is common to other algorithms for this purpose, and K-SVD works fairly well in practice.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Sparse_approximation" title="wikilink">Sparse approximation</a></li>
<li><a href="Singular_value_decomposition" title="wikilink">Singular value decomposition</a></li>
<li><a href="Matrix_norm" title="wikilink">Matrix norm</a></li>
<li><a href="K-means_clustering" title="wikilink">K-means clustering</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Norms_(mathematics)" title="wikilink">Category:Norms (mathematics)</a> <a href="Category:Linear_algebra" title="wikilink">Category:Linear algebra</a> <a href="Category:Data_clustering_algorithms" title="wikilink">Category:Data clustering algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
</ol>
</section>
</body>
</html>

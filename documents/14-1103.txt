   Lindström–Gessel–Viennot lemma      Lindström–Gessel–Viennot lemma   In mathematics, the Lindström–Gessel–Viennot lemma provides a way to count the number of tuples of non-intersecting lattice paths .  Statement  Let G be a locally finite directed acyclic graph . This means that each vertex has finite degree , and that G contains no directed cycles. Consider base vertices    A  =   {   a  1   ,  …  ,   a  n   }       A    subscript  a  1   normal-…   subscript  a  n      A=\{a_{1},\ldots,a_{n}\}   and destination vertices    B  =   {   b  1   ,  …  ,   b  n   }       B    subscript  b  1   normal-…   subscript  b  n      B=\{b_{1},\ldots,b_{n}\}   , and also assign a weight    ω  e     subscript  ω  e    \omega_{e}   to each directed edge e . These edge weights are assumed to belong to some commutative ring . For each directed path P between two vertices, let    ω   (  P  )       ω  P    \omega(P)   be the product of the weights of the edges of the path. For any two vertices a and b , write e ( a , b ) for the sum     e   (  a  ,  b  )    =    ∑   P  :   a  →  b      ω   (  P  )           e   a  b      subscript    normal-:  P   normal-→  a  b       ω  P      e(a,b)=\sum_{P:a\to b}\omega(P)   over all paths from a to b . This is well-defined if between any two points there are only finitely many paths; but even in the general case, this can be well-defined under some circumstances (such as all edge weights being pairwise distinct formal indeterminates, and    e   (  a  ,  b  )       e   a  b     e(a,b)   being regarded as a formal power series). If one assigns the weight 1 to each edge, then e ( a , b ) counts the number of paths from a to b .  With this setup, write      M  =   (      e   (   a  1   ,   b  1   )       e   (   a  1   ,   b  2   )      ⋯     e   (   a  1   ,   b  n   )         e   (   a  2   ,   b  1   )       e   (   a  2   ,   b  2   )      ⋯     e   (   a  2   ,   b  n   )        ⋮    ⋮    ⋱    ⋮       e   (   a  n   ,   b  1   )       e   (   a  n   ,   b  2   )      ⋯     e   (   a  n   ,   b  n   )       )       M      e    subscript  a  1    subscript  b  1       e    subscript  a  1    subscript  b  2     normal-⋯    e    subscript  a  1    subscript  b  n         e    subscript  a  2    subscript  b  1       e    subscript  a  2    subscript  b  2     normal-⋯    e    subscript  a  2    subscript  b  n       normal-⋮  normal-⋮  normal-⋱  normal-⋮      e    subscript  a  n    subscript  b  1       e    subscript  a  n    subscript  b  2     normal-⋯    e    subscript  a  n    subscript  b  n         M=\begin{pmatrix}e(a_{1},b_{1})&e(a_{1},b_{2})&\cdots&e(a_{1},b_{n})\\
 e(a_{2},b_{1})&e(a_{2},b_{2})&\cdots&e(a_{2},b_{n})\\
 \vdots&\vdots&\ddots&\vdots\\
 e(a_{n},b_{1})&e(a_{n},b_{2})&\cdots&e(a_{n},b_{n})\end{pmatrix}   .  An n -tuple of non-intersecting paths from A to B means an n -tuple ( P 1 , ..., P n ) of paths in G with the following properties:   There exists a permutation   σ   σ   \sigma   of    {  1  ,  2  ,  …  ,  n  }     1  2  normal-…  n    \left\{1,2,...,n\right\}   such that, for every i , the path P i is a path from    a  i     subscript  a  i    a_{i}   to    b   σ   (  i  )       subscript  b    σ  i     b_{\sigma(i)}   .    Whenever    i  ≠  j      i  j    i\neq j   , the paths P i and P j have no two vertices in common (not even endpoints).   Given such an n -tuple ( P 1 , ..., P n ), we denote by    σ   (  P  )       σ  P    \sigma(P)   the permutation of   σ   σ   \sigma   from the first condition.  The Lindström–Gessel–Viennot lemma then states that the determinant of M is the signed sum over all n -tuples P = ( P 1 , ..., P n ) of non-intersecting paths from A to B :        det   (  M  )    =    ∑    (   P  1   ,  …  ,   P  n   )   :   A  →  B      sign   (   σ   (  P  )    )     ∏   i  =  1   n    ω   (   P  i   )        .        M     subscript    normal-:    subscript  P  1   normal-…   subscript  P  n     normal-→  A  B       sign    σ  P     superscript   subscript  product    i  1    n     ω   subscript  P  i         \det(M)=\sum_{(P_{1},\ldots,P_{n})\colon A\to B}\mathrm{sign}(\sigma(P))\prod_%
 {i=1}^{n}\omega(P_{i}).     That is, the determinant of M counts the weights of all n -tuples of non-intersecting paths starting at A and ending at B , each affected with the sign of the corresponding permutation of    (  1  ,  2  ,  …  ,  n  )     1  2  normal-…  n    (1,2,\ldots,n)   , given by    P  i     subscript  P  i    P_{i}   taking    a  i     subscript  a  i    a_{i}   to    b   σ   (  i  )       subscript  b    σ  i     b_{\sigma(i)}   .  In particular, if the only permutation possible is the identity (i.e., every n -tuple of non-intersecting paths from A to B takes a i to b i for each i ) and we take the weights to be 1, then det( M ) is exactly the number of non-intersecting n -tuples of paths starting at A and ending at B .  Proof  To prove the Lindström–Gessel–Viennot lemma, we first introduce some notation.  An n -path from an n -tuple    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     (a_{1},a_{2},...,a_{n})   of vertices of G to an n -tuple    (   b  1   ,   b  2   ,  …  ,   b  n   )      subscript  b  1    subscript  b  2   normal-…   subscript  b  n     (b_{1},b_{2},...,b_{n})   of vertices of G will mean an n -tuple    (   P  1   ,   P  2   ,  …  ,   P  n   )      subscript  P  1    subscript  P  2   normal-…   subscript  P  n     (P_{1},P_{2},...,P_{n})   of paths in G , with each    P  i     subscript  P  i    P_{i}   leading from    a  i     subscript  a  i    a_{i}   to    b  i     subscript  b  i    b_{i}   . This n -path will be called nonintersecting if the paths P i and P j have no two vertices in common (not even endpoints) whenever    i  ≠  j      i  j    i\neq j   .  Given an n -path    P  =   (   P  1   ,   P  2   ,  …  ,   P  n   )       P    subscript  P  1    subscript  P  2   normal-…   subscript  P  n      P=(P_{1},P_{2},...,P_{n})   , the weight     ω   (  P  )       ω  P    \omega(P)   of this n -path is defined as the product    ω   (   P  1   )   ω   (   P  2   )   ⋯  ω   (   P  n   )       ω   subscript  P  1   ω   subscript  P  2   normal-⋯  ω   subscript  P  n     \omega(P_{1})\omega(P_{2})\cdots\omega(P_{n})   .  A twisted  n -path from an n -tuple    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     (a_{1},a_{2},...,a_{n})   of vertices of G to an n -tuple    (   b  1   ,   b  2   ,  …  ,   b  n   )      subscript  b  1    subscript  b  2   normal-…   subscript  b  n     (b_{1},b_{2},...,b_{n})   of vertices of G will mean an n -path from    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     (a_{1},a_{2},...,a_{n})   to    (   b   σ   (  1  )     ,   b   σ   (  2  )     ,  …  ,   b   σ   (  n  )     )      subscript  b    σ  1     subscript  b    σ  2    normal-…   subscript  b    σ  n      \left(b_{\sigma(1)},b_{\sigma(2)},...,b_{\sigma(n)}\right)   for some permutation   σ   σ   \sigma   in the symmetric group     S  n     subscript  S  n    S_{n}   . This permutation   σ   σ   \sigma   will be called the twist of this twisted n -path, and denoted by    σ   (  P  )       σ  P    \sigma(P)   (where P is the n -path). This, of course, generalizes the notation    σ   (  P  )       σ  P    \sigma(P)   introduced before.  Recalling the definition of M , we can expand det M as a signed sum of permutations; thus we obtain       det  M   =    ∑   σ  ∈   S  n        sign   (  σ  )    ⋅  e    (   a  1   ,   b   σ   (  1  )     )   e   (   a  2   ,   b   σ   (  2  )     )   ⋯  e   (   a  n   ,   b   σ   (  n  )     )           M     subscript     σ   subscript  S  n        normal-⋅    sign  σ   e     subscript  a  1    subscript  b    σ  1     e    subscript  a  2    subscript  b    σ  2     normal-⋯  e    subscript  a  n    subscript  b    σ  n         \det M=\sum_{\sigma\in S_{n}}\mathrm{sign}(\sigma)\cdot e\left(a_{1},b_{\sigma%
 (1)}\right)e\left(a_{2},b_{\sigma(2)}\right)\cdots e\left(a_{n},b_{\sigma(n)}\right)          =    ∑   σ  ∈   S  n       sign   (  σ  )    ⋅    ∑   P  is an  n  -path from   (   a  1   ,   a  2   ,  …  ,   a  n   )   to   (   b   σ   (  1  )     ,   b   σ   (  2  )     ,  …  ,   b   σ   (  n  )     )      ω   (  P  )           absent    subscript     σ   subscript  S  n      normal-⋅    sign  σ     subscript     P  is an  n  -path from    subscript  a  1    subscript  a  2   normal-…   subscript  a  n    to    subscript  b    σ  1     subscript  b    σ  2    normal-…   subscript  b    σ  n         ω  P        =\sum_{\sigma\in S_{n}}\mathrm{sign}(\sigma)\cdot\sum_{P\text{ is an }n\text{-%
 path from }\left(a_{1},a_{2},...,a_{n}\right)\text{ to }\left(b_{\sigma(1)},b_%
 {\sigma(2)},...,b_{\sigma(n)}\right)}\omega(P)   (since every factor    e   (   a  i   ,   b   σ   (  i  )     )       e    subscript  a  i    subscript  b    σ  i       e\left(a_{i},b_{\sigma(i)}\right)   is a sum over paths     a  i   →   b   σ   (  i  )        normal-→   subscript  a  i    subscript  b    σ  i      a_{i}\to b_{\sigma(i)}   , and thus the product    e   (   a  1   ,   b   σ   (  1  )     )   e   (   a  2   ,   b   σ   (  2  )     )   ⋯  e   (   a  n   ,   b   σ   (  n  )     )       e    subscript  a  1    subscript  b    σ  1     e    subscript  a  2    subscript  b    σ  2     normal-⋯  e    subscript  a  n    subscript  b    σ  n       e\left(a_{1},b_{\sigma(1)}\right)e\left(a_{2},b_{\sigma(2)}\right)\cdots e%
 \left(a_{n},b_{\sigma(n)}\right)   is a sum over n -paths from    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     (a_{1},a_{2},...,a_{n})   to    (   b   σ   (  1  )     ,   b   σ   (  2  )     ,  …  ,   b   σ   (  n  )     )      subscript  b    σ  1     subscript  b    σ  2    normal-…   subscript  b    σ  n      \left(b_{\sigma(1)},b_{\sigma(2)},...,b_{\sigma(n)}\right)   , with the summands being precisely the weights of these n -paths). Using the notion of a twisted n -path, we can simplify the right hand side of this to        ∑   P  is a twisted  n  -path from   (   a  1   ,   a  2   ,  …  ,   a  n   )   to   (   b  1   ,   b  2   ,  …  ,   b  n   )      sign   (   σ   (  P  )    )   ω   (  P  )     .      subscript     P  is a twisted  n  -path from    subscript  a  1    subscript  a  2   normal-…   subscript  a  n    to    subscript  b  1    subscript  b  2   normal-…   subscript  b  n        sign    σ  P   ω  P     \sum_{P\text{ is a twisted }n\text{-path from }\left(a_{1},a_{2},...,a_{n}%
 \right)\text{ to }\left(b_{1},b_{2},...,b_{n}\right)}\mathrm{sign}(\sigma(P))%
 \omega(P).     Now, we have to prove that this is equal to       ∑    (   P  1   ,  …  ,   P  n   )   :   A  →  B      sign   (   σ   (  P  )    )     ∏   i  =  1   n    ω   (   P  i   )          subscript    normal-:    subscript  P  1   normal-…   subscript  P  n     normal-→  A  B       sign    σ  P     superscript   subscript  product    i  1    n     ω   subscript  P  i        \sum_{(P_{1},\ldots,P_{n})\colon A\to B}\mathrm{sign}(\sigma(P))\prod_{i=1}^{n%
 }\omega(P_{i})           =    ∑   P  is a nonintersecting twisted  n  -path from   (   a  1   ,   a  2   ,  …  ,   a  n   )   to   (   b  1   ,   b  2   ,  …  ,   b  n   )      sign   (   σ   (  P  )    )   ω   (  P  )      .      absent    subscript     P  is a nonintersecting twisted  n  -path from    subscript  a  1    subscript  a  2   normal-…   subscript  a  n    to    subscript  b  1    subscript  b  2   normal-…   subscript  b  n        sign    σ  P   ω  P      =\sum_{P\text{ is a nonintersecting twisted }n\text{-path from }\left(a_{1},a_%
 {2},...,a_{n}\right)\text{ to }\left(b_{1},b_{2},...,b_{n}\right)}\mathrm{sign%
 }(\sigma(P))\omega(P).     In other words, we have to prove that the sum of the terms    sign   (   σ   (  P  )    )   ω   (  P  )       sign    σ  P   ω  P    \mathrm{sign}(\sigma(P))\omega(P)   over all twisted n -paths from    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     \left(a_{1},a_{2},...,a_{n}\right)   to    (   b  1   ,   b  2   ,  …  ,   b  n   )      subscript  b  1    subscript  b  2   normal-…   subscript  b  n     \left(b_{1},b_{2},...,b_{n}\right)   equals the same sum but only over nonintersecting n -paths. This clearly is equivalent to proving that the sum of    sign   (   σ   (  P  )    )   ω   (  P  )       sign    σ  P   ω  P    \mathrm{sign}(\sigma(P))\omega(P)   over all twisted n -paths from    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     \left(a_{1},a_{2},...,a_{n}\right)   to    (   b  1   ,   b  2   ,  …  ,   b  n   )      subscript  b  1    subscript  b  2   normal-…   subscript  b  n     \left(b_{1},b_{2},...,b_{n}\right)   which are not nonintersecting vanishes.  To establish this vanishing, we will use an involution on the set of all twisted n -paths from    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     \left(a_{1},a_{2},...,a_{n}\right)   to    (   b  1   ,   b  2   ,  …  ,   b  n   )      subscript  b  1    subscript  b  2   normal-…   subscript  b  n     \left(b_{1},b_{2},...,b_{n}\right)   which are not nonintersecting. This involution will have the property that it flips the sign    sign   (   σ   (  P  )    )       sign    σ  P     \mathrm{sign}(\sigma(P))   (as a consequence, it has no fixed points), while leaving    ω   (  P  )       ω  P    \omega(P)   invariant. Hence, the sum of    sign   (   σ   (  P  )    )   ω   (  P  )       sign    σ  P   ω  P    \mathrm{sign}(\sigma(P))\omega(P)   over all twisted n -paths from    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     \left(a_{1},a_{2},...,a_{n}\right)   to    (   b  1   ,   b  2   ,  …  ,   b  n   )      subscript  b  1    subscript  b  2   normal-…   subscript  b  n     \left(b_{1},b_{2},...,b_{n}\right)   will have to be 0, because the involution splits it into pairs of mutually cancelling summands.  It remains to construct the involution, which we call f . Let    P  =   (   P  1   ,   P  2   ,  …  ,   P  n   )       P    subscript  P  1    subscript  P  2   normal-…   subscript  P  n      P=\left(P_{1},P_{2},...,P_{n}\right)   be any twisted n -path from    (   a  1   ,   a  2   ,  …  ,   a  n   )      subscript  a  1    subscript  a  2   normal-…   subscript  a  n     \left(a_{1},a_{2},...,a_{n}\right)   to    (   b  1   ,   b  2   ,  …  ,   b  n   )      subscript  b  1    subscript  b  2   normal-…   subscript  b  n     \left(b_{1},b_{2},...,b_{n}\right)   which is not non-intersecting. The idea behind the definition of f is to take two intersecting paths    P  i     subscript  P  i    P_{i}   and    P  j     subscript  P  j    P_{j}   , and switch their tails after their point of intersection. However, there are (in general) several pairs of intersecting paths, which can also intersect several times; hence, a choice needs to be made (and f might fail to be an involution if this choice is done badly). We choose the following precise definition: Let i be the smallest index such that the path P i (recall that this is the path starting at a i ) contains an intersection; let m be the first (along P i ) of the points where P i intersects other paths; and then let j be the largest index such that m lies on P j . Then we define f ( P ) to be the same as P , but with the tails of the two paths P i and P j (that is, the parts of these two paths starting at m ) switched. Clearly, f ( P ) is a twisted n -path, whose twist    σ   (   f   (  P  )    )       σ    f  P     \sigma(f(P))   differs from    σ   (  P  )       σ  P    \sigma(P)   by a transposition of    σ   (  i  )       σ  i    \sigma(i)   and    σ   (  j  )       σ  j    \sigma(j)   ; hence,     sign   (   σ   (   f   (  P  )    )    )    =   -   sign   (   σ   (  P  )    )           sign    σ    f  P         sign    σ  P       \mathrm{sign}(\sigma(f(P)))=-\mathrm{sign}(\sigma(P))   . Moreover, f ( P ) has the same total multiset of edges as P ; thus,     ω   (   f   (  P  )    )    =   ω   (  P  )          ω    f  P      ω  P     \omega(f(P))=\omega(P)   . Furthermore, it is easy to see that f is, in fact, an involution; this is because in f ( P ), the smallest index corresponding to an intersecting path will again be i , its first point of intersection will again be m , and the largest index of a path containing m will again be j . So we have found an involution with the desired properties, and thus proven the Lindström-Gessel-Viennot lemma.  Arguments similar to the one above appear in several sources, with variations regarding the choice of which tails to switch. A version with j smallest (unequal to i ) rather than largest appears in the Gessel-Viennot 1989 reference (proof of Theorem 1).  Applications  Schur polynomials  The Lindström–Gessel–Viennot lemma can be used to prove the equivalence of the following two different definitions of Schur polynomials . Given a partition    λ  =    λ  1   +  ⋯  +   λ  r        λ     subscript  λ  1   normal-⋯   subscript  λ  r      \lambda=\lambda_{1}+\cdots+\lambda_{r}   of n , the Schur polynomial     s  λ    (   x  1   ,  …  ,   x  n   )        subscript  s  λ     subscript  x  1   normal-…   subscript  x  n      s_{\lambda}(x_{1},\ldots,x_{n})   can be defined as:          s  λ    (   x  1   ,  …  ,   x  n   )    =    ∑  T    w   (  T  )      ,         subscript  s  λ     subscript  x  1   normal-…   subscript  x  n       subscript   T     w  T      s_{\lambda}(x_{1},\ldots,x_{n})=\sum_{T}w(T),      where the sum is over all semistandard Young tableaux T of shape λ , and the weight of a tableau T is defined as the monomial obtained by taking the product of the x i indexed by the entries i of T . For instance, the weight of the tableau  is     x  1    x  3    x  4  3    x  5    x  6    x  7        subscript  x  1    subscript  x  3    superscript   subscript  x  4   3    subscript  x  5    subscript  x  6    subscript  x  7     x_{1}x_{3}x_{4}^{3}x_{5}x_{6}x_{7}   .          s  λ    (   x  1   ,  …  ,   x  n   )    =   det   (    (   h     λ  i   +  j   -  i    )    i  ,  j    r  ×  r    )     ,         subscript  s  λ     subscript  x  1   normal-…   subscript  x  n        superscript   subscript   subscript  h       subscript  λ  i   j   i     i  j      r  r       s_{\lambda}(x_{1},\ldots,x_{n})=\det\left((h_{\lambda_{i}+j-i})_{i,j}^{r\times
 r%
 }\right),      where h i are the complete homogeneous symmetric polynomials (with h i understood to be 0 if i is negative). For instance, for the partition (3,2,2,1), the corresponding determinant is        s   (  3  ,  2  ,  2  ,  1  )    =   |      h  3      h  4      h  5      h  6        h  1      h  2      h  3      h  4       1     h  1      h  2      h  3       0    0    1     h  1      |    .       subscript  s   3  2  2  1         subscript  h  3    subscript  h  4    subscript  h  5    subscript  h  6      subscript  h  1    subscript  h  2    subscript  h  3    subscript  h  4     1   subscript  h  1    subscript  h  2    subscript  h  3     0  0  1   subscript  h  1        s_{(3,2,2,1)}=\begin{vmatrix}h_{3}&h_{4}&h_{5}&h_{6}\\
 h_{1}&h_{2}&h_{3}&h_{4}\\
 1&h_{1}&h_{2}&h_{3}\\
 0&0&1&h_{1}\end{vmatrix}.     To prove the equivalence, given any partition λ as above, one considers the r starting points     a  i   =   (    r  +  1   -  i   ,  1  )        subscript  a  i        r  1   i   1     a_{i}=(r+1-i,1)   and the r ending points     b  i   =   (     λ  i   +  r  +  1   -  i   ,  n  )        subscript  b  i         subscript  λ  i   r  1   i   n     b_{i}=(\lambda_{i}+r+1-i,n)   , as points in the lattice    ℤ  2     superscript  ℤ  2    \mathbb{Z}^{2}   , which acquires the structure of a directed graph by asserting that the only allowed directions are going one to the right or one up; the weight associated to any horizontal edge at height i is x i , and the weight associated to a vertical edge is 1. With this definition, r -tuples of paths from A to B are exactly semistandard Young tableaux of shape λ , and the weight of such an r -tuple is the corresponding summand in the first definition of the Schur polynomials. For instance, with the tableau , one gets the corresponding 4 -tuple  (Figure)  Schur lattice paths.svg   On the other hand, the matrix M is exactly the matrix written above for D . This shows the required equivalence. (See also §4.5 in Sagan's book, or the First Proof of Theorem 7.16.1 in Stanley's EC2, or §3.3 in Fulmek's arXiv preprint, or §9.13 in Martin's lecture notes, for slight variations on this argument.)  The Cauchy–Binet formula  One can also use the Lindström–Gessel–Viennot lemma to prove the Cauchy–Binet formula , and in particular the multiplicativity of the determinant.  Generalizations  Talaska's formula  The acyclicity of G is an essential assumption in the Lindström-Gessel-Viennot lemma; it guarantees (in reasonable situations) that the sums    e   (  a  ,  b  )       e   a  b     e(a,b)   are well-defined, and it advects into the proof (if G is not acyclic, then f might transform a self-intersection of a path into an intersection of two distinct paths, which breaks the argument that f is an involution). Nevertheless, Kelli Talaska's 2012 paper establishes a formula generalizing the lemma to arbitrary digraphs. The sums    e   (  a  ,  b  )       e   a  b     e(a,b)   are replaced by formal power series, and the sum over nonintersecting path tuples now becomes a sum over collections of nonintersecting and non-self-intersecting paths and cycles, divided by a sum over collections of nonintersecting cycles. The reader is referred to Talaska's paper for details.  See also  Matrix tree theorem  Cauchy–Binet formula  References                    "  Category:Lemmas  Category:Combinatorics  Category:Theorems in combinatorics   
   Upwind differencing scheme for convection      Upwind differencing scheme for convection   The upwind differencing scheme is a method used in numerical methods in computational fluid dynamics for convection – diffusion problems. This scheme is specific for Peclet number greater than 2 or less than −2  Description  The upwind differencing scheme by taking into account the direction of the flow overcomes that inability of the central differencing scheme . This scheme is developed for strong convective flows with suppressed diffusion effects. Also known as ‘Donor Cell’ Differencing Scheme, the convected value of property ф at the cell face is adopted from the upstream node.  It can be described by Steady convection-diffusion partial Differential Equation 1 2 –         ∂   ∂  t     (   ρ  ϕ   )    +   ∇  ⋅   (   ρ  𝐮  ϕ   )     =    ∇  ⋅   (   Γ   grad  ϕ    )    +   S  ϕ                 t      ρ  ϕ     normal-⋅  normal-∇    ρ  𝐮  ϕ        normal-⋅  normal-∇    normal-Γ   grad  ϕ      subscript  S  ϕ      \frac{\partial}{\partial t}(\rho\phi)+\nabla\cdot(\rho\mathbf{u}\phi)\,=\nabla%
 \cdot(\Gamma\operatorname{grad}\phi)+S_{\phi}     Continuity equation        (   ρ  u  A   )   e   -    (   ρ  u  A   )   w    =   0          subscript    ρ  u  A   e    subscript    ρ  u  A   w    0    \left(\rho uA\right)_{e}-\left(\rho uA\right)_{w}=0\,    3 4  where   ρ   ρ   \rho   is density,   Γ   normal-Γ   \Gamma   is diffusion coefficient,   𝐮   𝐮   \mathbf{u}   is the velocity vector,   ϕ   ϕ   \phi   is the property to be computed,    S  ϕ     subscript  S  ϕ    S_{\phi}   is the source term, and the subscripts   e   e   e   and   w   w   w   refer to the "east" and "west" faces of the cell (see Fig. 1 below).  After discretization , applying continuity equation, and taking source term equals to zero we get 5  Central difference discretized equation         F  e    ϕ  e    -    F  w     ϕ  w      =     D  e    (    ϕ  E   -   ϕ  P    )    -    D  w    (    ϕ  P   -   ϕ  W    )              subscript  F  e    subscript  ϕ  e       subscript  F  w    subscript  ϕ  w          subscript  D  e      subscript  ϕ  E    subscript  ϕ  P        subscript  D  w      subscript  ϕ  P    subscript  ϕ  W        F_{e}\phi_{e}-F_{w}\phi_{w}\,=D_{e}(\phi_{E}-\phi_{P})-D_{w}(\phi_{P}-\phi_{W})        absent   \;   . 6 .....(1)        F  e   -    F  w     =  0         subscript  F  e    subscript  F  w    0    F_{e}-F_{w}\,=0        absent   \;    7 .....(2) Lower case denotes the face and upper case denotes node;   E   E   E   ,   W   W   W   , and   P   P   P   refer to the "East," "West," and "Central" cell. (again, see Fig. 1 below).  Defining variable F as convection mass flux and variable D as diffusion  conductance       F   =   ρ  u  A       F    ρ  u  A     F\,=\rho uA        absent   \;   and     absent   \;        D   =    Γ  A    δ  x        D      normal-Γ  A     δ  x      D\,=\frac{\Gamma A}{\delta x}        absent   \;     Peclet number (Pe) is a non-dimensional  parameter determining the comparative strengths of convection and diffusion  Peclet number:       P   e    =    F  D    =    ρ  u     Γ  /  δ   x            P  e     F  D            ρ  u       normal-Γ  δ   x       Pe\,=\frac{F}{D}\,=\frac{\rho u}{\Gamma/\delta x}        absent   \;     For a Peclet number of lower value (|Pe|  2).  For positive flow direction  (Figure)  Fig 1:Upwind scheme for positive flow direction        u  w   >  0       subscript  u  w   0    u_{w}>0          u  e   >  0       subscript  u  e   0    u_{e}>0   Corresponding upwind scheme equation:         F  e    ϕ  P    -    F  w     ϕ  W      =     D  e    (    ϕ  E   -   ϕ  P    )    -    D  w    (    ϕ  P   -   ϕ  W    )              subscript  F  e    subscript  ϕ  P       subscript  F  w    subscript  ϕ  W          subscript  D  e      subscript  ϕ  E    subscript  ϕ  P        subscript  D  w      subscript  ϕ  P    subscript  ϕ  W        F_{e}\phi_{P}-F_{w}\phi_{W}\,=D_{e}(\phi_{E}-\phi_{P})-D_{w}(\phi_{P}-\phi_{W})    8 .....(3)  Due to strong convection and suppressed diffusion        ϕ  e    =   ϕ  P        subscript  ϕ  e    subscript  ϕ  P     \phi_{e}\,=\phi_{P}    9        ϕ  w    =   ϕ  W        subscript  ϕ  w    subscript  ϕ  W     \phi_{w}\,=\phi_{W}     Rearranging equation (3) gives       [   (   D  w   +   F  w   )   +   D  e   +   (   F  e   -   F  w   )   ]     ϕ  P    =   (   D  w   +   F  w   )    ϕ  W   +   D  e    ϕ  E   )     fragments   fragments  normal-[   fragments  normal-(   subscript  D  w     subscript  F  w   normal-)     subscript  D  e     fragments  normal-(   subscript  F  e     subscript  F  w   normal-)   normal-]    subscript  ϕ  P     fragments  normal-(   subscript  D  w     subscript  F  w   normal-)    subscript  ϕ  W     subscript  D  e    subscript  ϕ  E   normal-)    [(D_{w}+F_{w})+D_{e}+(F_{e}-F_{w})]\phi_{P}\,=(D_{w}+F_{w})\phi_{W}+D_{e}\phi_%
 {E})        absent   \;     Identifying coefficients,        a  P    =   [    (    D  w   +   F  w    )   +   D  e   +   (    F  e   -   F  w    )    ]        subscript  a  P    delimited-[]       subscript  D  w    subscript  F  w     subscript  D  e      subscript  F  e    subscript  F  w        a_{P}\,=[(D_{w}+F_{w})+D_{e}+(F_{e}-F_{w})]        absent   \;           a  W    =   (    D  w   +   F  w    )        subscript  a  W      subscript  D  w    subscript  F  w      a_{W}\,=(D_{w}+F_{w})           a  E    =   D  E        subscript  a  E    subscript  D  E     a_{E}\,=D_{E}     For negative flow direction       u  w   <  0       subscript  u  w   0    u_{w}<0          u  e   <  0       subscript  u  e   0    u_{e}<0     Corresponding upwind scheme equation:         F  e    ϕ  E    -    F  w     ϕ  P      =     D  e    (    ϕ  E   -   ϕ  P    )    -    D  w    (    ϕ  P   -   ϕ  W    )              subscript  F  e    subscript  ϕ  E       subscript  F  w    subscript  ϕ  P          subscript  D  e      subscript  ϕ  E    subscript  ϕ  P        subscript  D  w      subscript  ϕ  P    subscript  ϕ  W        F_{e}\phi_{E}-F_{w}\phi_{P}\,=D_{e}(\phi_{E}-\phi_{P})-D_{w}(\phi_{P}-\phi_{W})    10 .....(4)        ϕ  W    =   ϕ  w        subscript  ϕ  W    subscript  ϕ  w     \phi_{W}\,=\phi_{w}           ϕ  P    =   ϕ  e        subscript  ϕ  P    subscript  ϕ  e     \phi_{P}\,=\phi_{e}     Rearranging equation(4) gives        [    (    D  e   -   F  e    )   +   D  w   +   (    F  e   -   F  w    )    ]    ϕ  P    =     D  w    ϕ  W    +    (    D  e   -   F  e    )    ϕ  E            delimited-[]       subscript  D  e    subscript  F  e     subscript  D  w      subscript  F  e    subscript  F  w       subscript  ϕ  P         subscript  D  w    subscript  ϕ  W         subscript  D  e    subscript  F  e     subscript  ϕ  E       [(D_{e}-F_{e})+D_{w}+(F_{e}-F_{w})]\phi_{P}=D_{w}\phi_{W}+(D_{e}-F_{e})\phi_{E}     Identifying coefficients,        a  W    =   D  w        subscript  a  W    subscript  D  w     a_{W}\,=D_{w}           a  E    =    D  e   -   F  e         subscript  a  E      subscript  D  e    subscript  F  e      a_{E}\,=D_{e}-F_{e}     We can generalize coefficients as 11 –       a  W   =    D  w   +   max   (   F  w   ,  0  )          subscript  a  W      subscript  D  w      subscript  F  w   0      a_{W}=D_{w}+\max(F_{w},0)          a  E   =    D  e   +   max   (  0  ,   -   F  e    )          subscript  a  E      subscript  D  e     0     subscript  F  e        a_{E}=D_{e}+\max(0,-F_{e})     (Figure)  Fig 3: Upwind difference versus central difference   Use  Solution in the central difference scheme fails to converge for Peclet number greater than 2 which can be overcome by using an upwind scheme to give a reasonable result. 12 13 Therefore the upwind differencing scheme is applicable for Pe > 2 for positive flow and Pe H.K Versteeg & W. Malalasekera . An introduction to Computational Fluid Dynamics.Chapter:5.Page 118(5.6.1.1).  The upwind differencing scheme formulation is conservative.  Boundedness 14  As the coefficients of the discretised equation are always positive hence satisfying the requirements for boundedness and also the coefficient matrix is diagonally dominant therefore no irregularities occur in the solution.  (Figure)  Fig 4: Accuracy and false deviation variation with the grid size   Transportiveness 15  Transportiveness is built into the formulation as the scheme already accounts for the flow direction.  Accuracy  Based on the backward differencing formula, the accuracy is only first order on the basis of the Taylor series truncation error. It gives error when flow is not aligned with grid lines. Distribution of transported properties become marked giving diffusion-like appearance, called as the false diffusion . Refinement of grid serves in overcoming the issue of false diffusion. With decrease in the grid size, false diffusion decrease thus increasing the accuracy.  References  See also   Central differencing scheme  Finite difference  Upwind scheme   "  Category:Computational fluid dynamics  Category:Numerical differential equations     H.K Versteeg & W. Malalasekera (1995). An introduction to Computational Fluid Dynamics.Chapter:5, Page103. ↩  Central differencing scheme#Steady-state convection diffusion equation ↩  H. K. Versteeg & W. Malalasekera (1995). An introduction to Computational Fluid Dynamics . Chapter 5, page 104. ↩  Central differencing scheme#Formulation of Steady state convection diffusion equation ↩  Central differencing scheme#Formulation of Steady state convection diffusion equation ↩  H.K Versteeg & W. Malalasekera. An introduction to Computational Fluid Dynamics.Chapter:5. Page 105. ↩  H.K Versteeg & W. Malalasekera . An introduction to Computational Fluid Dynamics.Chapter:5. Page 105. ↩  H.K Versteeg & W. Malalasekera . An introduction to Computational Fluid Dynamics.Chapter:5.Page 115. ↩  H. K. Versteeg & W. Malalasekera ). ''An Introduction to Computational Fluid Dynamics, Chapter 5, page 115. ↩  H.K Versteeg & W. Malalasekera. An introduction to Computational Fluid Dynamics.Chapter:5. Page115. ↩  H. K. Versteeg & W. Malalasekera. An Introduction to Computational Fluid Dynamics , Chapter 5, page 116. ↩  H.K Versteeg & W. Malalasekera . An introduction to Computational Fluid Dynamics.Chapter:5. Figure 5.5. ↩  H.K Versteeg & W. Malalasekera . An introduction to Computational Fluid Dynamics.Chapter:5. Figure 5.13. ↩  H.K Versteeg & W. Malalasekera . An introduction to Computational Fluid Dynamics.Chapter:5.Page 118 (5.6.1.2). ↩  H. K. Versteeg & W. Malalasekera (1995). An Introduction to Computational Fluid Dynamics , Chapter 5, page 118. (5.6.1.3) ↩     
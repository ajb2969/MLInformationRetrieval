   Hypergeometric distribution      Hypergeometric distribution   \, | pdf =      (      K      k      )    (       N  -  K        n  -  k       )     (      N      n      )          binomial  K  k    binomial    N  K     n  k      binomial  N  n     {{{K\choose k}{{N-K}\choose{n-k}}}\over{N\choose n}}   | cdf =    1  -        (      n       k  +  1       )    (       N  -  n        K  -  k  -  1       )     (      N      K      )     3     F  2     [      1  ,    k  +  1   -  K   ,    k  +  1   -  n          k  +  2   ,    N  +  k  +  2   -  K  -  n       ;  1  ]        1     subscript       binomial  n    k  1     binomial    N  n     K  k  1      binomial  N  K    3    subscript  F  2       1      k  1   K       k  1   n         k  2       N  k  2   K  n      1      1-{{{n\choose{k+1}}{{N-n}\choose{K-k-1}}}\over{N\choose K}}\,_{3}F_{2}\!\!%
 \left[\begin{array}[]{c}1,\ k+1-K,\ k+1-n\\
 k+2,\ N+k+2-K-n\end{array};1\right]   | mean =    n   K  N       n    K  N     n{K\over N}   | median = | mode =    ⌊     (   n  +  1   )    (   K  +  1   )     N  +  2    ⌋            n  1     K  1      N  2      \left\lfloor\frac{(n+1)(K+1)}{N+2}\right\rfloor   | variance =    n   K  N     (   N  -  K   )   N     N  -  n    N  -  1        n    K  N       N  K   N       N  n     N  1      n{K\over N}{(N-K)\over N}{N-n\over N-1}   | skewness =      (   N  -   2  K    )     (   N  -  1   )    1  2     (   N  -   2  n    )       [   n  K   (   N  -  K   )    (   N  -  n   )    ]    1  2     (   N  -  2   )            N    2  K     superscript    N  1     1  2      N    2  n        superscript   delimited-[]    n  K    N  K     N  n       1  2      N  2      \frac{(N-2K)(N-1)^{\frac{1}{2}}(N-2n)}{[nK(N-K)(N-n)]^{\frac{1}{2}}(N-2)}   | kurtosis =     1   n  K   (   N  -  K   )    (   N  -  n   )    (   N  -  2   )    (   N  -  3   )     ⋅     fragments    1    n  K    N  K     N  n     N  2     N  3     normal-⋅    \left.\frac{1}{nK(N-K)(N-n)(N-2)(N-3)}\cdot\right.       [   (  N  -  1  )    N  2    (  N   (  N  +  1  )   -  6  K   (  N  -  K  )   -  6  n   (  N  -  n  )   )   +     fragments  normal-[   fragments  normal-(  N   1  normal-)    superscript  N  2    fragments  normal-(  N   fragments  normal-(  N   1  normal-)    6  K   fragments  normal-(  N   K  normal-)    6  n   fragments  normal-(  N   n  normal-)   normal-)      \Big[(N-1)N^{2}\Big(N(N+1)-6K(N-K)-6n(N-n)\Big)+       6  n  K   (  N  -  K  )    (  N  -  n  )    (  5  N  -  6  )   ]     fragments  6  n  K   fragments  normal-(  N   K  normal-)    fragments  normal-(  N   n  normal-)    fragments  normal-(  5  N   6  normal-)   normal-]    6nK(N-K)(N-n)(5N-6)\Big]   | entropy = | mgf =       (       N  -  K       n      )     F  1    2     (   -  n   ,   -  K   ;    N  -  K  -  n   +  1   ;   e  t   )     (      N      n      )          binomial    N  K   n    subscript   subscript  F  1   2      n     K       N  K  n   1    superscript  e  t      binomial  N  n     \frac{{N-K\choose n}\scriptstyle{\,{}_{2}F_{1}(-n,-K;N-K-n+1;e^{t})}}{{N%
 \choose n}}\,\!   | char =       (       N  -  K       n      )     F  1    2     (   -  n   ,   -  K   ;    N  -  K  -  n   +  1   ;   e   i  t    )     (      N      n      )          binomial    N  K   n    subscript   subscript  F  1   2      n     K       N  K  n   1    superscript  e    i  t       binomial  N  n     \frac{{N-K\choose n}\scriptstyle{\,{}_{2}F_{1}(-n,-K;N-K-n+1;e^{it})}}{{N%
 \choose n}}   }} In probability theory and statistics , the hypergeometric distribution is a discrete probability distribution that describes the probability of   k   k   k   successes in   n   n   n   draws, without replacement, from a finite population of size   N   N   N   that contains exactly   K   K   K   successes, wherein each draw is either a success or a failure. In contrast, the binomial distribution describes the probability of   k   k   k   successes in   n   n   n   draws with replacement.  In statistics , the hypergeometric test uses the hypergeometric distribution to calculate the statistical significance of having drawn a specific   k   k   k   successes (out of   n   n   n   total draws) from the aforementioned population. The test is often used to identify which sub-populations are over- or under-represented in a sample. This test has a wide range of applications. For example, a marketing group could use the test to understand their customer base by testing a set of known customers for over-representation of various demographic subgroups (e.g., women, people under 30).  Definition  The following conditions characterize the hypergeometric distribution:   The result of each draw (the elements of the population being sampled) can be classified into one of two mutually exclusive categories (e.g. Pass/Fail or Female/Male or Employed/Unemployed).  The probability of a success changes on each draw, as each draw decreases the population ( sampling without replacement from a finite population).   A random variable    X   X   X   follows the hypergeometric distribution if its probability mass function (pmf) is given by 1      P   (  X  =  k  )   =     (      K      k      )    (       N  -  K        n  -  k       )     (      N      n      )       fragments  P   fragments  normal-(  X   k  normal-)         binomial  K  k    binomial    N  K     n  k      binomial  N  n      P(X=k)=\frac{{\left({{K}\atop{k}}\right)}{\left({{N-K}\atop{n-k}}\right)}}{{%
 \left({{N}\atop{n}}\right)}}   ,  where      N   N   N   is the population size,     K   K   K   is the number of success states in the population,     n   n   n   is the number of draws,     k   k   k   is the number of observed successes,      (      a      b      )     binomial  a  b    \textstyle{a\choose b}   is a binomial coefficient .   The pmf is positive when     max   (  0  ,    n  +  K   -  N   )    ≤  k  ≤   min   (  K  ,  n  )            0      n  K   N    k         K  n      \max(0,n+K-N)\leq k\leq\min(K,n)   .  The pmf satisfies the recurrence relation       (  k  +  1  )    (  N  -  K  -   (  n  -  k  -  1  )   )   P   (  X  =  k  +  1  )   =   (  K  -  k  )    (  n  -  k  )   P   (  X  =  k  )      fragments   fragments  normal-(  k   1  normal-)    fragments  normal-(  N   K    fragments  normal-(  n   k   1  normal-)   normal-)   P   fragments  normal-(  X   k   1  normal-)     fragments  normal-(  K   k  normal-)    fragments  normal-(  n   k  normal-)   P   fragments  normal-(  X   k  normal-)     (k+1)(N-K-(n-k-1))P(X=k+1)=(K-k)(n-k)P(X=k)     with      P   (  X  =  0  )   =    (       N  -  K       n      )    (      N      n      )       fragments  P   fragments  normal-(  X   0  normal-)       binomial    N  K   n    binomial  N  n      P(X=0)=\frac{{\left({{N-K}\atop{n}}\right)}}{{\left({{N}\atop{n}}\right)}}   .  Combinatorial identities  As one would expect, the probabilities sum up to 1 :        ∑   0  ≤  k  ≤  n       (      K      k      )    (       N  -  K        n  -  k       )     (      N      n      )     =  1        subscript       0  k       n          binomial  K  k    binomial    N  K     n  k      binomial  N  n     1    \sum_{0\leq k\leq n}{{K\choose k}{N-K\choose n-k}\over{N\choose n}}=1     This is essentially Vandermonde's identity from combinatorics .  Also note the following identity holds:          (      K      k      )    (       N  -  K        n  -  k       )     (      N      n      )    =     (      n      k      )    (       N  -  n        K  -  k       )     (      N      K      )     .           binomial  K  k    binomial    N  K     n  k      binomial  N  n         binomial  n  k    binomial    N  n     K  k      binomial  N  K      {{{K\choose k}{{N-K}\choose{n-k}}}\over{N\choose n}}={{{n\choose k}{{N-n}%
 \choose{K-k}}}\over{N\choose K}}.     This follows from the symmetry of the problem, but it can also be shown by expressing the binomial coefficients in terms of factorials and rearranging the latter.  Application and example  The classical application of the hypergeometric distribution is sampling without replacement . Think of an urn with two types of marbles , red ones and green ones. Define drawing a green marble as a success and drawing a red marble as a failure (analogous to the binomial distribution). If the variable N describes the number of all marbles in the urn (see contingency table below) and K describes the number of green marbles , then N − K corresponds to the number of red marbles . In this example, X is the random variable whose outcome is k , the number of green marbles actually drawn in the experiment. This situation is illustrated by the following contingency table :       drawn   not drawn   total       green marbles   k   K − k   K     red marbles   n − k   N + k − n − K   N − K     total   n   N − n   N       Now, assume (for example) that there are 5 green and 45 red marbles in the urn. Standing next to the urn, you close your eyes and draw 10 marbles without replacement. What is the probability that exactly 4 of the 10 are green? Note that although we are looking at success/failure, the data are not accurately modeled by the binomial distribution , because the probability of success on each trial is not the same, as the size of the remaining population changes as we remove each marble.  This problem is summarized by the following contingency table:       drawn   not drawn   total       green marbles   k = 4   K − k = 1   K = 5     red marbles   n − k = 6   N + k − n − K = 39   N − K = 45     total   n = 10   N − n = 40   N = 50     The probability of drawing exactly k green marbles can be calculated by the formula      P   (  X  =  k  )   =  f   (  k  ;  N  ,  K  ,  n  )   =     (      K      k      )    (       N  -  K        n  -  k       )     (      N      n      )    .     fragments  P   fragments  normal-(  X   k  normal-)    f   fragments  normal-(  k  normal-;  N  normal-,  K  normal-,  n  normal-)         binomial  K  k    binomial    N  K     n  k      binomial  N  n    normal-.    P(X=k)=f(k;N,K,n)={{{K\choose k}{{N-K}\choose{n-k}}}\over{N\choose n}}.     Hence, in this example calculate      P   (  X  =  4  )   =  f   (  4  ;  50  ,  5  ,  10  )   =     (      5      4      )    (      45      6      )     (      50      10      )    =    5  ⋅  8145060   10272278170   =  0.003964583  …  .     fragments  P   fragments  normal-(  X   4  normal-)    f   fragments  normal-(  4  normal-;  50  normal-,  5  normal-,  10  normal-)         binomial  5  4    binomial  45  6     binomial  50  10        normal-⋅  5  8145060   10272278170    0.003964583  normal-…  normal-.    P(X=4)=f(4;50,5,10)={{{5\choose 4}{{45}\choose{6}}}\over{50\choose 10}}={5%
 \cdot 8145060\over 10272278170}=0.003964583\dots.     Intuitively we would expect it to be even more unlikely for all 5 marbles to be green.      P   (  X  =  5  )   =  f   (  5  ;  50  ,  5  ,  10  )   =     (      5      5      )    (      45      5      )     (      50      10      )    =    1  ⋅  1221759   10272278170   =  0.0001189375  …  ,     fragments  P   fragments  normal-(  X   5  normal-)    f   fragments  normal-(  5  normal-;  50  normal-,  5  normal-,  10  normal-)         binomial  5  5    binomial  45  5     binomial  50  10        normal-⋅  1  1221759   10272278170    0.0001189375  normal-…  normal-,    P(X=5)=f(5;50,5,10)={{{5\choose 5}{{45}\choose{5}}}\over{50\choose 10}}={1%
 \cdot 1221759\over 10272278170}=0.0001189375\dots,     As expected, the probability of drawing 5 green marbles is roughly 35 times less likely than that of drawing 4.  Application to Texas Hold'em Poker  In Hold'em Poker players make the best hand they can combining the two cards in their hand with the 5 cards (community cards) eventually turned up on the table. The deck has 52 and there are 13 of each suit. For this example assume a player has 2 clubs in the hand and there are 3 cards showing on the table, 2 of which are also clubs. The player would like to know the probability of one of the next 2 cards to be shown being a club to complete his flush .  There are 4 clubs showing so there are 9 still unseen. There are 5 cards showing (2 in the hand and 3 on the table) so there are     52  -  5   =  47        52  5   47    52-5=47   still unseen.  The probability that one of the next two cards turned is a club can be calculated using hypergeometric with     k  =  1   ,    n  =  2   ,   K  =  9       formulae-sequence    k  1    formulae-sequence    n  2     K  9      k=1,n=2,K=9   and    N  =  47      N  47    N=47   . (about 31.6%)  The probability that both of the next two cards turned are clubs can be calculated using hypergeometric with     k  =  2   ,    n  =  2   ,   K  =  9       formulae-sequence    k  2    formulae-sequence    n  2     K  9      k=2,n=2,K=9   and    N  =  47      N  47    N=47   . (about 3.3%)  The probability that neither of the next two cards turned are clubs can be calculated using hypergeometric with     k  =  0   ,    n  =  2   ,   K  =  9       formulae-sequence    k  0    formulae-sequence    n  2     K  9      k=0,n=2,K=9   and    N  =  47      N  47    N=47   . (about 65.0%)  Symmetries  Swapping the roles of green and red marbles:       f   (  k  ;  N  ,  K  ,  n  )    =   f   (   n  -  k   ;  N  ,   N  -  K   ,  n  )          f   k  N  K  n      f     n  k   N    N  K   n      f(k;N,K,n)=f(n-k;N,N-K,n)     Swapping the roles of drawn and not drawn marbles:       f   (  k  ;  N  ,  K  ,  n  )    =   f   (   K  -  k   ;  N  ,  K  ,   N  -  n   )          f   k  N  K  n      f     K  k   N  K    N  n       f(k;N,K,n)=f(K-k;N,K,N-n)     Swapping the roles of green and drawn marbles:       f   (  k  ;  N  ,  K  ,  n  )    =   f   (  k  ;  N  ,  n  ,  K  )          f   k  N  K  n      f   k  N  n  K      f(k;N,K,n)=f(k;N,n,K)     Hypergeometric test  The hypergeometric test uses the hypergeometric distribution to measure the statistical significance of having drawn a sample consisting of a specific number of   k   k   k   successes (out of   n   n   n   total draws) from a population of size   N   N   N   containing   K   K   K   successes. In a test for over-representation of successes in the sample, the hypergeometric p-value is calculated as the probability of randomly drawing   k   k   k   or more successes from the population in   n   n   n   total draws. In a test for under-representation, the p-value is the probability of randomly drawing   k   k   k   or fewer successes.  Relationship to Fisher's exact test  The test based on the hypergeometric distribution (hypergeometric test) is identical to the corresponding one-tailed version of Fisher's exact test 2 ). Reciprocally, the p-value of a two-sided Fisher's exact test can be calculated as the sum of two appropriate hypergeometric tests (for more information see 3 ).  Order of draws  The probability of drawing any sequence of white and black marbles (the hypergeometric distribution) depends only on the number of white and black marbles, not on the order in which they appear; i.e., it is an exchangeable distribution. As a result, the probability of drawing a white marble in the    i  th     superscript  i  th    i^{\text{th}}   draw is 4        P   (   W  i   )    =   K  N    .        P   subscript  W  i      K  N     P(W_{i})={\frac{K}{N}}.     Related distributions  Let X ~ Hypergeometric(   K   K   K   ,   N   N   N   ,   n   n   n   ) and    p  =   K  /  N       p    K  N     p=K/N   .   If    n  =  1      n  1    n=1   then   X   X   X   has a Bernoulli distribution with parameter   p   p   p   .    Let   Y   Y   Y   have a binomial distribution with parameters   n   n   n   and   p   p   p   ; this models the number of successes in the analogous sampling problem with replacement. If   N   N   N   and   K   K   K   are large compared to   n   n   n   , and   p   p   p   is not close to 0 or 1, then   X   X   X   and   Y   Y   Y   have similar distributions, i.e.,    P   (  X  ≤  k  )   ≈  P   (  Y  ≤  k  )      fragments  P   fragments  normal-(  X   k  normal-)    P   fragments  normal-(  Y   k  normal-)     P(X\leq k)\approx P(Y\leq k)   .    If   n   n   n   is large,   N   N   N   and   K   K   K   are large compared to   n   n   n   , and   p   p   p   is not close to 0 or 1, then         P   (  X  ≤  k  )   ≈  Φ   (    k  -   n  p      n  p   (   1  -  p   )      )      fragments  P   fragments  normal-(  X   k  normal-)    Φ   fragments  normal-(      k    n  p        n  p    1  p      normal-)     P(X\leq k)\approx\Phi\left(\frac{k-np}{\sqrt{np(1-p)}}\right)        where   Φ   normal-Φ   \Phi   is the standard normal distribution function   If the probabilities to draw a white or black marble are not equal (e.g. because white marbles are bigger/easier to grasp than black marbles) then   X   X   X   has a noncentral hypergeometric distribution    The beta-binomial distribution is a conjugate prior for the hypergeometric distribution.   The following table describes four distributions related to the number of successes in a sequence of draws:       With replacements   No replacements       Given number of draws   binomial distribution   hypergeometric distribution     Given number of failures   negative binomial distribution   negative hypergeometric distribution     Multivariate hypergeometric distribution  {\binom{N}{n}} | cdf = | mean =     E   (   X  i   )    =    n   K  i    N         E   subscript  X  i        n   subscript  K  i    N     E(X_{i})=\frac{nK_{i}}{N}   | median = | mode = | variance =     Var   (   X  i   )    =     K  i   N    (   1  -    K  i   N    )   n    N  -  n    N  -  1           Var   subscript  X  i         subscript  K  i   N     1     subscript  K  i   N    n      N  n     N  1       \text{Var}(X_{i})=\frac{K_{i}}{N}\left(1-\frac{K_{i}}{N}\right)n\frac{N-n}{N-1}         Cov   (   X  i   ,   X  j   )    =   -     n   K  i    K  j     N  2      N  -  n    N  -  1            Cov    subscript  X  i    subscript  X  j             n   subscript  K  i    subscript  K  j     superscript  N  2        N  n     N  1        \text{Cov}(X_{i},X_{j})=-\frac{nK_{i}K_{j}}{N^{2}}\frac{N-n}{N-1}   | skewness = | kurtosis = | entropy = | mgf = | char = }}  The model of an urn with black and white marbles can be extended to the case where there are more than two colors of marbles. If there are K i marbles of color i in the urn and you take n marbles at random without replacement, then the number of marbles of each color in the sample ( k 1 , k 2 ,..., k c ) has the multivariate hypergeometric distribution. This has the same relationship to the multinomial distribution that the hypergeometric distribution has to the binomial distribution—the multinomial distribution is the "with-replacement" distribution and the multivariate hypergeometric is the "without-replacement" distribution.  The properties of this distribution are given in the adjacent table, where c is the number of different colors and    N  =    ∑   i  =  1   c    K  i        N    superscript   subscript     i  1    c    subscript  K  i      N=\sum_{i=1}^{c}K_{i}   is the total number of marbles.  Example  Suppose there are 5 black, 10 white, and 15 red marbles in an urn. You reach in and randomly select six marbles without replacement. What is the probability that you pick exactly two of each color?       P   (   2  black   ,   2  white   ,   2  red   )    =     (      5      2      )    (      10      2      )    (      15      2      )     (      30      6      )    =  0.079575596816976          P     2  black     2  white     2  red          binomial  5  2    binomial  10  2    binomial  15  2     binomial  30  6         0.079575596816976     P(2\text{ black},2\text{ white},2\text{ red})={{{5\choose 2}{10\choose 2}{15%
 \choose 2}}\over{30\choose 6}}=0.079575596816976     Note: When picking the six marbles without replacement, the expected number of black marbles is 6×(5/30) = 1, the expected number of white marbles is 6×(10/30) = 2, and the expected number of red marbles is 6×(15/30) = 3. This comes from the expected value of a Binomial distribution, E(X) = np.    See also   Multinomial distribution  Sampling (statistics)  Generalized hypergeometric function  Coupon collector's problem  Geometric distribution  Keno   Notes    References       unpublished note   External links   The Hypergeometric Distribution and Binomial Approximation to a Hypergeometric Random Variable by Chris Boucher, Wolfram Demonstrations Project .    "  Category:Discrete distributions  Category:Factorial and binomial topics  Category:Probability distributions     ↩  ↩  ↩  http://www.stat.yale.edu/~pollard/Courses/600.spring2010/Handouts/Symmetry%5BPolyaUrn%5D.pdf ↩     
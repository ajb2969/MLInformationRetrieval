   FKG inequality      FKG inequality   In mathematics, the Fortuin–Kasteleyn–Ginibre (FKG) inequality is a correlation inequality, a fundamental tool in statistical mechanics and probabilistic combinatorics (especially random graphs and the probabilistic method ), due to . Informally, it says that in many random systems, increasing events are positively correlated, while an increasing and a decreasing event are negatively correlated.  An earlier version, for the special case of i.i.d. variables, called Harris inequality , is due to , see below . One generalization of the FKG inequality is the Holley inequality (1974) below, and an even further generalization is the Ahlswede–Daykin "four functions" theorem (1978) . Furthermore, it has the same conclusion as the Griffiths inequalities , but the hypotheses are different.  The inequality  Let   X   X   X   be a finite distributive lattice , and μ a nonnegative function on it, that is assumed to satisfy the ( FKG ) lattice condition (sometimes a function satisfying this condition is called log supermodular ) i.e.,       μ   (   x  ∧  y   )   μ   (   x  ∨  y   )    ≥   μ   (  x  )   μ   (  y  )          μ    x  y   μ    x  y      μ  x  μ  y     \mu(x\wedge y)\mu(x\vee y)\geq\mu(x)\mu(y)   for all x , y in the lattice   X   X   X   .  The FKG inequality then says that for any two monotonically increasing functions ƒ and g on   X   X   X   , the following positive correlation inequality holds:         (    ∑   x  ∈  X     f   (  x  )   g   (  x  )   μ   (  x  )     )    (    ∑   x  ∈  X     μ   (  x  )     )    ≥    (    ∑   x  ∈  X     f   (  x  )   μ   (  x  )     )    (    ∑   x  ∈  X     g   (  x  )   μ   (  x  )     )     .          subscript     x  X      f  x  g  x  μ  x      subscript     x  X      μ  x         subscript     x  X      f  x  μ  x      subscript     x  X      g  x  μ  x       \left(\sum_{x\in X}f(x)g(x)\mu(x)\right)\left(\sum_{x\in X}\mu(x)\right)\geq%
 \left(\sum_{x\in X}f(x)\mu(x)\right)\left(\sum_{x\in X}g(x)\mu(x)\right).     The same inequality (positive correlation) is true when both ƒ and g are decreasing. If one is increasing and the other is decreasing, then they are negatively correlated and the above inequality is reversed.  Similar statements hold more generally, when   X   X   X   is not necessarily finite, not even countable. In that case, μ has to be a finite measure, and the lattice condition has to be defined using cylinder events; see, e.g., Section 2.2 of .  For proofs, see the original  or the Ahlswede–Daykin inequality (1978) . Also, a rough sketch is given below, due to , using a Markov chain  coupling argument.  Variations on terminology  The lattice condition for μ is also called multivariate total positivity , and sometimes the strong FKG condition ; the term ( multiplicative ) FKG condition is also used in older literature.  The property of μ that increasing functions are positively correlated is also called having positive associations , or the weak FKG condition .  Thus, the FKG theorem can be rephrased as "the strong FKG condition implies the weak FKG condition".  A special case: the Harris inequality  If the lattice   X   X   X   is totally ordered , then the lattice condition is satisfied trivially for any measure μ . For this case, the FKG inequality is Chebyshev's sum inequality : if the two increasing functions take on values     a  1   ≤   a  2   ≤  ⋯  ≤   a  n          subscript  a  1    subscript  a  2        normal-⋯        subscript  a  n      a_{1}\leq a_{2}\leq\cdots\leq a_{n}   and     b  1   ≤   b  2   ≤  ⋯  ≤   b  n          subscript  b  1    subscript  b  2        normal-⋯        subscript  b  n      b_{1}\leq b_{2}\leq\cdots\leq b_{n}   , then (we may assume that the measure μ is uniform)           a  1    b  1    +  ⋯  +    a  n    b  n     n   ≥       a  1   +  ⋯  +   a  n    n       b  1   +  ⋯  +   b  n    n     .             subscript  a  1    subscript  b  1    normal-⋯     subscript  a  n    subscript  b  n     n          subscript  a  1   normal-⋯   subscript  a  n    n        subscript  b  1   normal-⋯   subscript  b  n    n      \frac{a_{1}b_{1}+\cdots+a_{n}b_{n}}{n}\geq\frac{a_{1}+\cdots+a_{n}}{n}\;\frac{%
 b_{1}+\cdots+b_{n}}{n}.     More generally, for any probability measure μ on    \R    \R   \R   and increasing functions ƒ and g ,         ∫   \R     f   (  x  )   g   (  x  )   d  μ   (  x  )     ≥    ∫   \R     f   (  x  )   d  μ   (  x  )     ∫   \R     g   (  x  )   d  μ   (  x  )        ,        subscript   \R     f  x  g  x  d  μ  x      subscript   \R     f  x  d  μ  x    subscript   \R     g  x  d  μ  x        \int_{\R}f(x)g(x)\,d\mu(x)\geq\int_{\R}f(x)\,d\mu(x)\,\int_{\R}g(x)\,d\mu(x),   which follows immediately from        ∫   \R      ∫   \R      [    f   (  x  )    -   f   (  y  )     ]    [    g   (  x  )    -   g   (  y  )     ]   d  μ   (  x  )   d  μ   (  y  )      ≥  0.        subscript   \R     subscript   \R      delimited-[]      f  x     f  y      delimited-[]      g  x     g  y     d  μ  x  d  μ  y     0.    \int_{\R}\int_{\R}[f(x)-f(y)][g(x)-g(y)]\,d\mu(x)\,d\mu(y)\geq 0.     The lattice condition is trivially satisfied also when the lattice is the product of totally ordered lattices,    X  =    X  1   ×  ⋯  ×   X  n        X     subscript  X  1   normal-⋯   subscript  X  n      X=X_{1}\times\cdots\times X_{n}   , and    μ  =    μ  1   ⊗  ⋯  ⊗   μ  n        μ   tensor-product   subscript  μ  1   normal-⋯   subscript  μ  n      \mu=\mu_{1}\otimes\cdots\otimes\mu_{n}   is a product measure. Often all the factors (both the lattices and the measures) are identical, i.e., μ is the probability distribution of i.i.d. random variables.  The FKG inequality for the case of a product measure is known also as the Harris inequality after Harris , who found and used it in his study of percolation in the plane. A proof of the Harris inequality that uses the above double integral trick on    \R    \R   \R   can be found, e.g., in Section 2.2 of .  Simple examples  A typical example is the following. Color each hexagon of the infinite honeycomb lattice black with probability   p   p   p   and white with probability    1  -  p      1  p    1-p   , independently of each other. Let a, b, c, d be four hexagons, not necessarily distinct. Let    a  ↔  b     normal-↔  a  b    a\leftrightarrow b   and    c  ↔  d     normal-↔  c  d    c\leftrightarrow d   be the events that there is a black path from a to b , and a black path from c to d , respectively. Then the Harris inequality says that these events are positively correlated     Pr   (    a  ↔   b  ,  c    ↔  d   )    ≥    Pr   (   a  ↔  b   )     Pr   (   c  ↔  d   )          Pr   normal-↔   normal-↔  a   b  c    d       Pr   normal-↔  a  b     Pr   normal-↔  c  d       \Pr(a\leftrightarrow b,\ c\leftrightarrow d)\geq\Pr(a\leftrightarrow b)\Pr(c%
 \leftrightarrow d)   . In other words, assuming the presence of one path can only increase the probability of the other.  Similarly, if we randomly color the hexagons inside an    n  ×  n      n  n    n\times n   rhombus-shaped hex board , then the events that there is black crossing from the left side of the board to the right side is positively correlated with having a black crossing from the top side to the bottom. On the other hand, having a left-to-right black crossing is negatively correlated with having a top-to-bottom white crossing, since the first is an increasing event (in the amount of blackness), while the second is decreasing. In fact, in any coloring of the hex board exactly one of these two events happen — this is why hex is a well-defined game.  In the Erdős–Rényi random graph , the existence of a Hamiltonian cycle is negatively correlated with the 3-colorability of the graph , since the first is an increasing event, while the latter is decreasing.  Examples from Statistical Mechanics  In statistical mechanics, the usual source of measures that satisfy the lattice condition (and hence the FKG inequality) is the following:  If   S   S   S   is an ordered set (such as    {   -  1   ,   +  1   }       1     1     \{-1,+1\}   ), and   Γ   normal-Γ   \Gamma   is a finite or infinite graph , then the set    S  Γ     superscript  S  normal-Γ    S^{\Gamma}   of   S   S   S   -valued configurations is a poset that is a distributive lattice.  Now, if   Φ   normal-Φ   \Phi   is a submodular potential (i.e., a family of functions        Φ  Λ   :    S  Λ   ⟶    \R   ∪   {  ∞  }      ,     normal-:   subscript  normal-Φ  normal-Λ    normal-⟶   superscript  S  normal-Λ     \R         \Phi_{\Lambda}:S^{\Lambda}\longrightarrow\R\cup\{\infty\},   one for each finite    Λ  ⊂  Γ      normal-Λ  normal-Γ    \Lambda\subset\Gamma   , such that each    Φ  Λ     subscript  normal-Φ  normal-Λ    \Phi_{\Lambda}   is submodular ), then one defines the corresponding Hamiltonians as         H  Λ    (  ϕ  )    :=    ∑    Δ  ∩  Λ   ≠  ∅      Φ  Δ    (  ϕ  )      .     assign     subscript  H  normal-Λ   ϕ     subscript       normal-Δ  normal-Λ         subscript  normal-Φ  normal-Δ   ϕ      H_{\Lambda}(\phi):=\sum_{\Delta\cap\Lambda\not=\emptyset}\Phi_{\Delta}(\phi).     If μ is an extremal Gibbs measure for this Hamiltonian on the set of configurations   ϕ   ϕ   \phi   , then it is easy to show that μ satisfies the lattice condition, see .  A key example is the Ising model on a graph   Γ   normal-Γ   \Gamma   . Let    S  =   {   -  1   ,   +  1   }       S     1     1      S=\{-1,+1\}   , called spins, and    β  ∈   [  0  ,  ∞  ]       β   0      \beta\in[0,\infty]   . Take the following potential:        Φ  Λ    (  ϕ  )    =   {      β   1   {  ϕ   (  x  )   ≠  ϕ   (  y  )   }          if  Λ   =    {  x  ,  y  }   is a pair of adjacent vertices of  Γ    ;       0    otherwise.             subscript  normal-Φ  normal-Λ   ϕ    cases    β   subscript  1   fragments  normal-{  ϕ   fragments  normal-(  x  normal-)    ϕ   fragments  normal-(  y  normal-)   normal-}         if  normal-Λ      x  y   is a pair of adjacent vertices of  normal-Γ    0  otherwise.     \Phi_{\Lambda}(\phi)=\begin{cases}\beta 1_{\{\phi(x)\not=\phi(y)\}}&\text{ if %
 }\Lambda=\{x,y\}\text{ is a pair of adjacent vertices of }\Gamma;\\
 0&\text{ otherwise.}\end{cases}   Submodularity is easy to check; intuitively, taking the min or the max of two configurations tends to decrease the number of disagreeing spins. Then, depending on the graph   Γ   normal-Γ   \Gamma   and the value of   β   β   \beta   , there could be one or more extremal Gibbs measures, see, e.g.,  and .  A generalization: the Holley inequality  The Holley inequality , due to , states that the expectations        ⟨  f  ⟩   i   =     ∑   x  ∈  X     f   (  x  )    μ  i    (  x  )       ∑   x  ∈  X      μ  i    (  x  )           subscript   delimited-⟨⟩  f   i       subscript     x  X      f  x   subscript  μ  i   x      subscript     x  X       subscript  μ  i   x       \langle f\rangle_{i}=\frac{\sum_{x\in X}f(x)\mu_{i}(x)}{\sum_{x\in X}\mu_{i}(x)}     of a monotonically increasing function ƒ on a finite distributive lattice    X   X   X   with respect to two positive functions μ 1 , μ 2 on the lattice satisfy the condition         ⟨  f  ⟩   1   ≥    ⟨  f  ⟩   2    ,       subscript   delimited-⟨⟩  f   1    subscript   delimited-⟨⟩  f   2     \langle f\rangle_{1}\geq\langle f\rangle_{2},     provided the functions satisfy the Holley condition ( criterion )        μ  2    (   x  ∧  y   )    μ  1    (   x  ∨  y   )    ≥    μ  1    (  x  )    μ  2    (  y  )           subscript  μ  2     x  y    subscript  μ  1     x  y       subscript  μ  1   x   subscript  μ  2   y     \mu_{2}(x\wedge y)\mu_{1}(x\vee y)\geq\mu_{1}(x)\mu_{2}(y)     for all x , y in the lattice.  To recover the FKG inequality : If μ satisfies the lattice condition and ƒ and g are increasing functions on   X   X   X   , then μ 1 ( x )= g ( x ) μ ( x ) and μ 2 ( x )= μ ( x ) will satisfy the lattice-type condition of the Holley inequality. Then the Holley inequality states that          ⟨   f  g   ⟩   μ     ⟨  g  ⟩   μ    =    ⟨  f  ⟩   1   ≥    ⟨  f  ⟩   2   =    ⟨  f  ⟩   μ    ,           subscript   delimited-⟨⟩    f  g    μ    subscript   delimited-⟨⟩  g   μ     subscript   delimited-⟨⟩  f   1         subscript   delimited-⟨⟩  f   2         subscript   delimited-⟨⟩  f   μ      \frac{\langle fg\rangle_{\mu}}{\langle g\rangle_{\mu}}=\langle f\rangle_{1}%
 \geq\langle f\rangle_{2}=\langle f\rangle_{\mu},     which is just the FKG inequality.  As for FKG, the Holley inequality follows from the Ahlswede–Daykin inequality .  Weakening the lattice condition: monotonicity  Consider the usual case of   X   X   X   being a product     \R   V     superscript  \R  V    \R^{V}   for some finite set   V   V   V   . The lattice condition on μ is easily seen to imply the following monotonicity , which has the virtue that it is often easier to check than the lattice condition:  Whenever one fixes a vertex    v  ∈  V      v  V    v\in V   and two configurations φ and ψ outside v such that     ϕ   (  w  )    ≥   ψ   (  w  )          ϕ  w     ψ  w     \phi(w)\geq\psi(w)   for all    w  ≠  v      w  v    w\not=v   , the μ -conditional distribution of φ(v) given    {   ϕ   (  w  )    :   w  ≠  v   }     conditional-set    ϕ  w     w  v     \{\phi(w):w\not=v\}    stochastically dominates the μ -conditional distribution of ψ(v) given    {   ψ   (  w  )    :   w  ≠  v   }     conditional-set    ψ  w     w  v     \{\psi(w):w\not=v\}   .  Now, if μ satisfies this monotonicity property, that is already enough for the FKG inequality (positive associations) to hold.  Here is a rough sketch of the proof, due to : starting from any initial configuration on   V   V   V   , one can run a simple Markov chain (the Metropolis algorithm ) that uses independent Uniform[0,1] random variables to update the configuration in each step, such that the chain has a unique stationary measure, the given μ . The monotonicity of μ implies that the configuration at each step is a monotone function of independent variables, hence the product measure version of Harris implies that it has positive associations. Therefore, the limiting stationary measure μ also has this property.  The monotonicity property has a natural version for two measures, saying that μ 1 conditionally pointwise dominates μ 2 . It is again easy to see that if μ 1 and μ 2 satisfy the lattice-type condition of the Holley inequality , then μ 1 conditionally pointwise dominates μ 2 . On the other hand, a Markov chain coupling argument similar to the above, but now without invoking the Harris inequality, shows that conditional pointwise domination, in fact, implies stochastically domination . Stochastic domination is equivalent to saying that      ⟨  f  ⟩   1   ≥    ⟨  f  ⟩   2        subscript   delimited-⟨⟩  f   1    subscript   delimited-⟨⟩  f   2     \langle f\rangle_{1}\geq\langle f\rangle_{2}   for all increasing ƒ , thus we get a proof of the Holley inequality. (And thus also a proof of the FKG inequality, without using the Harris inequality.)  See  and  for details.  See also   Ahlswede–Daykin inequality   References            "  Category:Inequalities  Category:Statistical mechanics  Category:Covariance and correlation   
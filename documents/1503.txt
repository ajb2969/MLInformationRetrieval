   Kalman decomposition      Kalman decomposition   In control theory , a Kalman decomposition provides a mathematical means to convert a representation of any linear time-invariant  control system to a form in which the system can be decomposed into a standard form which makes clear the observable and controllable components of the system. This decomposition results in the system being presented with a more illuminating structure, making it easier to draw conclusions on the system's reachable and observable subspaces.  Notation  The derivation is identical for both discrete-time as well as continuous time LTI systems. The description of a continuous time linear system is        x  ˙    (  t  )    =    A  x   (  t  )    +   B  u   (  t  )            normal-˙  x   t       A  x  t     B  u  t      \dot{x}(t)=Ax(t)+Bu(t)           y    (  t  )    =    C  x   (  t  )    +   D  u   (  t  )           y  t       C  x  t     D  u  t      \,y(t)=Cx(t)+Du(t)     where      x    x   \,x   is the "state vector",      y    y   \,y   is the "output vector",      u    u   \,u   is the "input (or control) vector",      A    A   \,A   is the "state matrix",      B    B   \,B   is the "input matrix",      C    C   \,C   is the "output matrix",      D    D   \,D   is the "feedthrough (or feedforward) matrix".  Similarly, a discrete-time linear control system can be described as        x    (   k  +  1   )    =    A  x   (  k  )    +   B  u   (  k  )           x    k  1        A  x  k     B  u  k      \,x(k+1)=Ax(k)+Bu(k)           y    (  k  )    =    C  x   (  k  )    +   D  u   (  k  )           y  k       C  x  k     D  u  k      \,y(k)=Cx(k)+Du(k)     with similar meanings for the variables. Thus, the system can be described using the tuple consisting of four matrices    (  A  ,  B  ,  C  ,  D  )     A  B  C  D    \,(A,B,C,D)   . Let the order of the system be    n    n   \,n   .  Then, the Kalman decomposition is defined as a transformation of the tuple    (  A  ,  B  ,  C  ,  D  )     A  B  C  D    \,(A,B,C,D)   to    (   A  ^   ,   B  ^   ,   C  ^   ,   D  ^   )      normal-^  A    normal-^  B    normal-^  C    normal-^  D     \,(\hat{A},\hat{B},\hat{C},\hat{D})   as follows:        A  ^    =    T   -  1    A  T        normal-^  A      superscript  T    1    A  T     \,{\hat{A}}={T^{-1}}AT           B  ^    =    T   -  1    B        normal-^  B      superscript  T    1    B     \,{\hat{B}}={T^{-1}}B           C  ^    =   C  T        normal-^  C     C  T     \,{\hat{C}}=CT           D  ^    =  D       normal-^  D   D    \,{\hat{D}}=D       T    T   \,T   is an     n   ×  n      n  n    \,n\times n   invertible matrix defined as       T   =   [      T   r   o  ¯        T   r  o       T    r  o   ¯       T    r  ¯   o       ]       T     subscript  T    r   normal-¯  o      subscript  T    r  o     subscript  T   normal-¯    r  o      subscript  T     normal-¯  r   o        \,T=\begin{bmatrix}T_{r\overline{o}}&T_{ro}&T_{\overline{ro}}&T_{\overline{r}o%
 }\end{bmatrix}     where        T    r   o  ¯       subscript  T    r   normal-¯  o      \,T_{r\overline{o}}   is a matrix whose columns span the subspace of states which are both reachable and unobservable.       T    r  o      subscript  T    r  o     \,T_{ro}   is chosen so that the columns of     [      T   r   o  ¯        T   r  o       ]        subscript  T    r   normal-¯  o      subscript  T    r  o       \,\begin{bmatrix}T_{r\overline{o}}&T_{ro}\end{bmatrix}   are a basis for the reachable subspace.       T     r  o   ¯      subscript  T   normal-¯    r  o      \,T_{\overline{ro}}   is chosen so that the columns of     [      T   r   o  ¯        T    r  o   ¯       ]        subscript  T    r   normal-¯  o      subscript  T   normal-¯    r  o        \,\begin{bmatrix}T_{r\overline{o}}&T_{\overline{ro}}\end{bmatrix}   are a basis for the unobservable subspace.       T     r  ¯   o      subscript  T     normal-¯  r   o     \,T_{\overline{r}o}   is chosen so that     [      T   r   o  ¯        T   r  o       T    r  o   ¯       T    r  ¯   o       ]        subscript  T    r   normal-¯  o      subscript  T    r  o     subscript  T   normal-¯    r  o      subscript  T     normal-¯  r   o       \,\begin{bmatrix}T_{r\overline{o}}&T_{ro}&T_{\overline{ro}}&T_{\overline{r}o}%
 \end{bmatrix}   is invertible.   By construction, the matrix    T    T   \,T   is invertible. It can be observed that some of these matrices may have dimension zero. For example, if the system is both observable and controllable, then     T   =   T   r  o        T   subscript  T    r  o      \,T=T_{ro}   , making the other matrices zero dimension.  Standard Form  By using results from controllability and observability, it can be shown that the transformed system    (   A  ^   ,   B  ^   ,   C  ^   ,   D  ^   )      normal-^  A    normal-^  B    normal-^  C    normal-^  D     \,(\hat{A},\hat{B},\hat{C},\hat{D})   has matrices in the following form:        A  ^    =   [      A   r   o  ¯        A  12      A  13      A  14       0     A   r  o      0     A  24       0    0     A    r  o   ¯       A  34       0    0    0     A    r  ¯   o       ]        normal-^  A      subscript  A    r   normal-¯  o      subscript  A  12    subscript  A  13    subscript  A  14     0   subscript  A    r  o    0   subscript  A  24     0  0   subscript  A   normal-¯    r  o      subscript  A  34     0  0  0   subscript  A     normal-¯  r   o        \,\hat{A}=\begin{bmatrix}A_{r\overline{o}}&A_{12}&A_{13}&A_{14}\\
 0&A_{ro}&0&A_{24}\\
 0&0&A_{\overline{ro}}&A_{34}\\
 0&0&0&A_{\overline{r}o}\end{bmatrix}           B  ^    =   [      B   r   o  ¯          B   r  o        0      0     ]        normal-^  B      subscript  B    r   normal-¯  o        subscript  B    r  o      0    0      \,\hat{B}=\begin{bmatrix}B_{r\overline{o}}\\
 B_{ro}\\
 0\\
 0\end{bmatrix}           C  ^    =   [     0     C   r  o      0     C    r  ¯   o       ]        normal-^  C     0   subscript  C    r  o    0   subscript  C     normal-¯  r   o        \,\hat{C}=\begin{bmatrix}0&C_{ro}&0&C_{\overline{r}o}\end{bmatrix}           D  ^    =  D       normal-^  D   D    \,\hat{D}=D     This leads to the conclusion that   The subsystem    (   A   r  o    ,   B   r  o    ,   C   r  o    ,  D  )      subscript  A    r  o     subscript  B    r  o     subscript  C    r  o    D    \,(A_{ro},B_{ro},C_{ro},D)   is both reachable and observable.  The subsystem    (   [      A   r   o  ¯        A  12       0     A   r  o       ]   ,   [      B   r   o  ¯          B   r  o       ]   ,   [     0     C   r  o       ]   ,  D  )        subscript  A    r   normal-¯  o      subscript  A  12     0   subscript  A    r  o         subscript  B    r   normal-¯  o        subscript  B    r  o        0   subscript  C    r  o      D    \,\left(\begin{bmatrix}A_{r\overline{o}}&A_{12}\\
 0&A_{ro}\end{bmatrix},\begin{bmatrix}B_{r\overline{o}}\\
 B_{ro}\end{bmatrix},\begin{bmatrix}0&C_{ro}\end{bmatrix},D\right)   is reachable.  The subsystem    (   [      A   r  o       A  24       0     A    r  ¯   o       ]   ,   [      B   r  o        0     ]   ,   [      C   r  o       C    r  ¯   o       ]   ,  D  )        subscript  A    r  o     subscript  A  24     0   subscript  A     normal-¯  r   o         subscript  B    r  o      0       subscript  C    r  o     subscript  C     normal-¯  r   o      D    \,\left(\begin{bmatrix}A_{ro}&A_{24}\\
 0&A_{\overline{r}o}\end{bmatrix},\begin{bmatrix}B_{ro}\\
 0\end{bmatrix},\begin{bmatrix}C_{ro}&C_{\overline{r}o}\end{bmatrix},D\right)   is observable.   See also   Observability  Controllability   External links   Lectures on Dynamic Systems and Control, Lecture 25 - Mohammed Dahleh, Munther Dahleh, George Verghese — MIT OpenCourseWare   "  Category:Control theory   
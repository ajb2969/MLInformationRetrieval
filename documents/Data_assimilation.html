<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="712">Data assimilation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Data assimilation</h1>
<hr/>

<p><strong>Data assimilation</strong> is the process by which observations are incorporated into a computer model of a real system. Applications of data assimilation arise in many fields of geosciences, perhaps most importantly in <a href="weather_forecasting" title="wikilink">weather forecasting</a> and <a class="uri" href="hydrology" title="wikilink">hydrology</a>. Data assimilation proceeds by <em>analysis cycles</em>. In each analysis cycle, observations of the current (and possibly past) state of a system are combined with the results from a numerical <a href="mathematical_model" title="wikilink">model</a> (the <em>forecast</em>) to produce an <em>analysis</em>, which is considered as 'the best' estimate of the current state of the system. This is called the <em>analysis step</em>. Essentially, the analysis step tries to balance the uncertainty in the data and in the forecast. The model is then advanced in time and its result becomes the forecast in the next analysis cycle.</p>
<h2 id="data-assimilation-as-statistical-estimation">Data assimilation as statistical estimation</h2>

<p>In data assimilation applications, the analysis and forecasts are best thought of as <a href="probability_distribution" title="wikilink">probability distributions</a>. The analysis step is an application of <a href="Bayes'_theorem" title="wikilink">Bayes' theorem</a> and the overall assimilation procedure is an example of <a href="recursive_Bayesian_estimation" title="wikilink">recursive Bayesian estimation</a>. However, the probabilistic analysis is usually simplified to a computationally feasible form. Advancing the probability distribution in time would be done exactly in the general case by the <a href="Fokker-Planck_equation" title="wikilink">Fokker-Planck equation</a>, but that is unrealistically expensive, so various approximations operating on simplified <a href="Representation_(mathematics)" title="wikilink">representations</a> of the probability distributions are used instead. If the probability distributions are normal, they can be represented by their mean and covariance, which gives rise to the <a href="Kalman_filter" title="wikilink">Kalman filter</a>. However it is not feasible to maintain the covariance because of the large number of degrees of freedom in the state, so various approximations are used instead.</p>

<p>Many methods represent the probability distributions only by the mean and impute some covariance instead. In the basic form, such analysis step is known as optimal statistical interpolation. Adjusting the initial value of the mathematical model instead of changing the state directly at the analysis time is the essence of the variational methods, 3DVAR and 4DVAR. Nudging, also known as Newtonian relaxation or 4DDA, is essentially the same as proceeding in continuous time rather than in discrete analysis cycles (the <a href="Kalman-Bucy_filter" title="wikilink">Kalman-Bucy filter</a>), again with imputing simplified covariance.</p>

<p><a href="Ensemble_Kalman_filter" title="wikilink">Ensemble Kalman filters</a> represent the probability distribution by an ensemble of simulations, and the covariance is approximated by <a href="sample_covariance" title="wikilink">sample covariance</a>.</p>
<h2 id="weather-forecasting-applications">Weather forecasting applications</h2>

<p>Data assimilation is a concept encompassing any method for combining observations of variables such as <a class="uri" href="temperature" title="wikilink">temperature</a> and <a href="atmospheric_pressure" title="wikilink">atmospheric pressure</a> into models used in <a href="numerical_weather_prediction" title="wikilink">numerical weather prediction</a> (NWP).</p>

<p>Two main types of data assimilation are used: three-dimensional (3DDA) which uses only those observations available at the time of analysis, and four-dimensional (4DDA) which also includes the later observations.</p>
<h3 id="why-it-is-necessary">Why it is necessary</h3>

<p> The <a class="uri" href="atmosphere" title="wikilink">atmosphere</a> is a <a class="uri" href="fluid" title="wikilink">fluid</a>. The idea of numerical weather prediction is to sample the state of the fluid at a given time and use the equations of <a href="fluid_dynamics" title="wikilink">fluid dynamics</a> and <a class="uri" href="thermodynamics" title="wikilink">thermodynamics</a> to estimate the state of the fluid at some time in the future. The process of entering observation data into the model to generate <a href="initial_value_problem" title="wikilink">initial conditions</a> is called <em>initialization</em>. On land, terrain maps available at resolutions down to  globally are used to help model atmospheric circulations within regions of rugged topography, in order to better depict features such as downslope winds, <a href="Lee_wave" title="wikilink">mountain waves</a> and related cloudiness that affects incoming solar radiation.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The main inputs from country-based weather services are observations from devices (called <a href="radiosonde" title="wikilink">radiosondes</a>) in weather balloons that measure various atmospheric parameters and transmits them to a fixed receiver, as well as from <a href="weather_satellite" title="wikilink">weather satellites</a>. The <a href="World_Meteorological_Organization" title="wikilink">World Meteorological Organization</a> acts to standardize the instrumentation, observing practices and timing of these observations worldwide. Stations either report hourly in <a class="uri" href="METAR" title="wikilink">METAR</a> reports,<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> or every six hours in <a class="uri" href="SYNOP" title="wikilink">SYNOP</a> reports.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> These observations are irregularly spaced, so they are processed by data assimilation and objective analysis methods, which perform quality control and obtain values at locations usable by the model's mathematical algorithms.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> Some global models use <a href="finite_differences" title="wikilink">finite differences</a>, in which the world is represented as discrete points on a regularly spaced grid of latitude and longitude;<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> other models use <a href="spectral_methods" title="wikilink">spectral methods</a> that solve for a range of wavelengths. The data are then used in the model as the starting point for a forecast.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>A variety of methods are used to gather observational data for use in numerical models. Sites launch radiosondes in weather balloons which rise through the <a class="uri" href="troposphere" title="wikilink">troposphere</a> and well into the <a class="uri" href="stratosphere" title="wikilink">stratosphere</a>.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> Information from weather satellites is used where traditional data sources are not available. Commerce provides <a href="pilot_report" title="wikilink">pilot reports</a> along aircraft routes<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> and ship reports along shipping routes.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> Research projects use <a href="weather_reconnaissance" title="wikilink">reconnaissance aircraft</a> to fly in and around weather systems of interest, such as <a href="tropical_cyclone" title="wikilink">tropical cyclones</a>.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> Reconnaissance aircraft are also flown over the open oceans during the cold season into systems which cause significant uncertainty in forecast guidance, or are expected to be of high impact from three to seven days into the future over the downstream continent.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Sea ice began to be initialized in forecast models in 1971.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> Efforts to involve <a href="sea_surface_temperature" title="wikilink">sea surface temperature</a> in model initialization began in 1972 due to its role in modulating weather in higher latitudes of the Pacific.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>
<h3 id="history">History</h3>

<p> In 1922, <a href="Lewis_Fry_Richardson" title="wikilink">Lewis Fry Richardson</a> published the first attempt at forecasting the weather numerically. Using a <a href="Hydrostatic_equilibrium" title="wikilink">hydrostatic</a> variation of Bjerknes's primitive equations,<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> Richardson produced by hand a 6-hour forecast for the state of the atmosphere over two points in central Europe, taking at least six weeks to do so.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> His forecast calculated that the change in <a href="atmospheric_pressure" title="wikilink">surface pressure</a> would be , an unrealistic value incorrect by two orders of magnitude. The large error was caused by an imbalance in the pressure and wind velocity fields used as the initial conditions in his analysis,<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> indicating the need for a data assimilation scheme.</p>

<p>Originally "subjective analysis" had been used in which NWP forecasts had been adjusted by meteorologists using their operational expertise. Then "objective analysis" (e.g. Cressman algorithm) was introduced for automated data assimilation. These objective methods used simple interpolation approaches, and thus were 3DDA methods.</p>

<p>Later, 4DDA methods, called "nudging", were developed, such as in the <a href="MM5_(weather_model)" title="wikilink">MM5</a> model. They are based on the simple idea of Newtonian relaxation (the 2nd axiom of Newton). They introduce into the right part of dynamical equations of the model a term that is proportional to the difference of the calculated meteorological variable and the observed value. This term that has a negative sign keeps the calculated <a href="State_space_(controls)" title="wikilink">state vector</a> closer to the observations. Nudging can be interpreted as a variant of the <a href="Kalman-Bucy_filter" title="wikilink">Kalman-Bucy filter</a> (a continuous time version of the <a href="Kalman_filter" title="wikilink">Kalman filter</a>) with the gain matrix prescribed rather than obtained from covariances.</p>

<p>A major development was achieved by L. Gandin (1963) who introduced the "statistical interpolation" (or "optimal interpolation") method, which developed earlier ideas of Kolmogorov. This is a 3DDA method and is a type of <a href="regression_analysis" title="wikilink">regression analysis</a> which utilizes information about the spatial distributions of <a class="uri" href="covariance" title="wikilink">covariance</a> functions of the errors of the "first guess" field (previous forecast) and "true field". These functions are never known. However, the different approximations were assumed.</p>

<p>The optimal interpolation algorithm is the reduced version of the <a href="Kalman_filtering" title="wikilink">Kalman filtering</a> (KF) algorithm and in which the covariance matrices are not calculated from the dynamical equations but are pre-determined in advance.</p>

<p>Attempts to introduce the KF algorithms as a 4DDA tool for NWP models came later. However, this was (and remains) a difficult task because the full version requires solution of the enormous number of additional equations (~N*N~10**12, where N=Nx*Ny*Nz is the size of the state vector, Nx~100, Ny~100, Nz~100 - the dimensions of the computational grid). To overcome this difficulty, approximate or suboptimal Kalman filters were developed. These include the <a href="Ensemble_Kalman_filter" title="wikilink">Ensemble Kalman filter</a> and the Reduced-Rank Kalman filters (RRSQRT) (see Todling and Cohn, 1994).</p>

<p>Another significant advance in the development of the 4DDA methods was utilizing the <a href="optimal_control" title="wikilink">optimal control</a> theory (variational approach) in the works of Le Dimet and Talagrand (1986), based on the previous works of G. Marchuk, who was the first to apply that theory in the environmental modeling. The significant advantage of the variational approaches is that the meteorological fields satisfy the dynamical equations of the NWP model and at the same time they minimize the functional, characterizing their difference from observations. Thus, the problem of constrained minimization is solved. The 3DDA variational methods were developed for the first time by Sasaki (1958).</p>

<p>As was shown by Lorenc (1986), all the above-mentioned 4DDA methods are in some limit equivalent, i.e. under some assumptions they minimize the same <a href="Loss_function" title="wikilink">cost function</a>. However, in practical applications these assumptions are never fulfilled, the different methods perform differently and generally it is not clear what approach (Kalman filtering or variational) is better. The fundamental questions also arise in application of the advanced DA techniques such as convergence of the computational method to the global minimum of the functional to be minimised. For instance, cost function or the set in which the solution is sought can be not convex. The 4DDA method which is currently most successful<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a><a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> is hybrid incremental 4D-Var, where an ensemble is used to augment the climatological background error covariances at the start of the data assimilation time window, but the background error covariances are evolved during the time window by a simplified version of the NWP forecast model. This data assimilation method is used operationally at forecast centres such as the <a href="Met_Office" title="wikilink">Met Office</a>.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a><a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>
<h3 id="cost-function">Cost function</h3>

<p>The process of creating the analysis in data assimilation often involves minimization of a <a href="Loss_function" title="wikilink">cost function</a>. A typical cost function would be the sum of the squared deviations of the analysis values from the observations weighted by the accuracy of the observations, plus the sum of the squared deviations of the forecast fields and the analyzed fields weighted by the accuracy of the forecast. This has the effect of making sure that the analysis does not drift too far away from observations and forecasts that are known to usually be reliable.</p>
<h4 id="d-var">3D-Var</h4>

<p>

<math display="inline" id="Data_assimilation:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>J</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐱</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝐱</mi>
         <mo>-</mo>
         <msub>
          <mi>𝐱</mi>
          <mi>b</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msup>
       <mi>𝐁</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐱</mi>
        <mo>-</mo>
        <msub>
         <mi>𝐱</mi>
         <mi>b</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>𝐲</mi>
         <mo>-</mo>
         <mrow>
          <mi>H</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>𝐱</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msup>
       <mi>𝐑</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐲</mi>
        <mo>-</mo>
        <mrow>
         <mi>H</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>𝐱</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>J</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐱</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>b</ci>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐁</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐱</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐲</ci>
        <apply>
         <times></times>
         <ci>H</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>𝐱</ci>
         </apply>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐑</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐲</ci>
       <apply>
        <times></times>
        <ci>H</ci>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>𝐱</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{x})=(\mathbf{x}-\mathbf{x}_{b})^{\mathrm{T}}\mathbf{B}^{-1}(\mathbf{%
x}-\mathbf{x}_{b})+(\mathbf{y}-\mathit{H}[\mathbf{x}])^{\mathrm{T}}\mathbf{R}^%
{-1}(\mathbf{y}-\mathit{H}[\mathbf{x}]),
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Data_assimilation:1">
 <semantics>
  <mi>𝐁</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐁</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{B}
  </annotation>
 </semantics>
</math>

 denotes the background error covariance, 

<math display="inline" id="Data_assimilation:2">
 <semantics>
  <mi>𝐑</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐑</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{R}
  </annotation>
 </semantics>
</math>

 the observational error covariance.</p>

<p>

<math display="inline" id="Data_assimilation:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>∇</mo>
     <mi>J</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐱</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>𝐁</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐱</mi>
       <mo>-</mo>
       <msub>
        <mi>𝐱</mi>
        <mi>b</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <msup>
      <mi>H</mi>
      <mi>T</mi>
     </msup>
     <msup>
      <mi>𝐑</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐲</mi>
       <mo>-</mo>
       <mrow>
        <mi>H</mi>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>𝐱</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-∇</ci>
      <ci>J</ci>
     </apply>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐁</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐱</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>H</ci>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐑</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐲</ci>
       <apply>
        <times></times>
        <ci>H</ci>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>𝐱</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nabla J(\mathbf{x})=2\mathbf{B}^{-1}(\mathbf{x}-\mathbf{x}_{b})-2\mathit{H}^{%
T}\mathbf{R}^{-1}(\mathbf{y}-\mathit{H}[\mathbf{x}])
  </annotation>
 </semantics>
</math>

</p>
<h4 id="d-var-1">4D-var</h4>

<p>

<math display="inline" id="Data_assimilation:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>J</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>𝐱</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐱</mi>
        <mo>-</mo>
        <msub>
         <mi>𝐱</mi>
         <mi>b</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">T</mi>
     </msup>
     <msup>
      <mi>𝐁</mi>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐱</mi>
       <mo>-</mo>
       <msub>
        <mi>𝐱</mi>
        <mi>b</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>𝐲</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mrow>
          <msub>
           <mi>H</mi>
           <mi>i</mi>
          </msub>
          <mrow>
           <mo stretchy="false">[</mo>
           <msub>
            <mi>𝐱</mi>
            <mi>i</mi>
           </msub>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi mathvariant="normal">T</mi>
      </msup>
      <msubsup>
       <mi>𝐑</mi>
       <mi>i</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>𝐲</mi>
         <mi>i</mi>
        </msub>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>H</mi>
          <mi>i</mi>
         </msub>
         <mrow>
          <mo stretchy="false">[</mo>
          <msub>
           <mi>𝐱</mi>
           <mi>i</mi>
          </msub>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>J</ci>
     <ci>𝐱</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐱</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐱</ci>
         <ci>b</ci>
        </apply>
       </apply>
       <ci>normal-T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐁</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐱</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐱</ci>
        <ci>b</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐲</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>H</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>𝐱</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <ci>normal-T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐑</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐲</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>H</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>𝐱</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J(\mathbf{x})=(\mathbf{x}-\mathbf{x}_{b})^{\mathrm{T}}\mathbf{B}^{-1}(\mathbf{%
x}-\mathbf{x}_{b})+\sum_{i=0}^{n}(\mathbf{y}_{i}-\mathit{H}_{i}[\mathbf{x}_{i}%
])^{\mathrm{T}}\mathbf{R}_{i}^{-1}(\mathbf{y}_{i}-\mathit{H}_{i}[\mathbf{x}_{i%
}])
  </annotation>
 </semantics>
</math>

</p>

<p>provided that 

<math display="inline" id="Data_assimilation:5">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathit{H}
  </annotation>
 </semantics>
</math>

 is linear operator (matrix).</p>
<h3 id="future-development">Future development</h3>

<p>Factors driving the rapid development of data assimilation methods for NWP models include:</p>
<ul>
<li>Utilizing the observations currently offers promising improvement in <a href="forecast_skill" title="wikilink">forecast skill</a> at a variety of spatial scales (from global to highly local) and time scales.</li>
<li>The number of different kinds of available observations (<a href="sodar" title="wikilink">sodars</a>, <a href="radar" title="wikilink">radars</a>, <a class="uri" href="satellite" title="wikilink">satellite</a>) is rapidly growing.</li>
</ul>
<h2 id="other-applications">Other applications</h2>

<p>Data assimilation methods are currently also used in other environmental forecasting problems, e.g. in <a href="Hydrology" title="wikilink">hydrological</a> forecasting. Basically, the same types of data assimilation methods as those described above are in use there. An example of chemical data assimilation using <a class="uri" href="Autochem" title="wikilink">Autochem</a> can be found at <a href="http://www.cdacentral.info/">CDACentral</a>.</p>

<p>Given the abundance of spacecraft data for other planets in the solar system, data assimilation is now also applied beyond the Earth to obtain re-analyses of the atmospheric state of extraterrestrial planets. Mars is the only extraterrestrial planet to which data assimilation has been applied so far. Available spacecraft data include, in particular, retrievals of temperature and dust/water ice optical ticknesses from the Thermal Emission Spectrometer onboard NASA's <a href="Mars_Global_Surveyor" title="wikilink">Mars Global Surveyor</a> and the Mars Climate Sounder onboard NASA's <a href="Mars_Reconnaissance_Orbiter" title="wikilink">Mars Reconnaissance Orbiter</a>. Two methods of data assimilation have been applied to these datasets: an Analysis Correction scheme <a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> and two Ensemble Kalman Filter schemes,<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a><a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> both using a global circulation model of the martian atmosphere as forward model. The Mars Analysis Correction Data Assimilation (MACDA) dataset is publicly available from the British Atmospheric Data Centre.<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a></p>

<p>Data assimilation is a part of the challenge for every forecasting problem.</p>

<p>Dealing with biased data is a serious challenge in data assimilation. Further development of methods to deal with biases will be of particular use. If there are several instruments observing the same variable then intercomparing them using <a href="probability_distribution_function" title="wikilink">probability distribution functions</a> can be instructive. Such an analysis is available on line at <a href="http://www.pdfcentral.info/">PDFCentral</a> designed for the validation of observations from the NASA <a href="Aura_(satellite)" title="wikilink">Aura satellite</a>.</p>

<p>Other uses include trajectory estimation for the <a href="Apollo_program" title="wikilink">Apollo program</a>, <a class="uri" href="GPS" title="wikilink">GPS</a>, and <a href="Autochem" title="wikilink">atmospheric chemistry</a>.</p>
<h2 id="prediction-of-future-oil-production">Prediction of future oil production</h2>

<p>Data assimilation is extensively used in petroleum reservoir engineering, where it is usually referred to as "history matching". Data assimilation methods are used for uncertainty assessment of performance predictions of wells in oil reservoirs,<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a> and for generating computational models used for optimizing decision parameters that would improve oil recovery.<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="Roger_Daley" title="wikilink">R. Daley</a>, Atmospheric data analysis, Cambridge University Press, 1991.</li>
<li><a href="http://www.mmm.ucar.edu/mm5/">MM5 community model homepage</a></li>
<li><a href="http://www.ecmwf.int/newsevents/training/lecture_notes/LN_DA.html">ECMWF Data Assimilation Lecture notes</a></li>
<li>Ide, K., P. Courtier, M. Ghil, and A. C. Lorenc (1997) <a href="http://www.atmos.ucla.edu/~kayo/data/publication/ide_etal_jmsj97.pdf">Unified Notation for Data Assimilation: Operational, Sequential and Variational</a> Journal of the Meteorologcial Society of Japan, vol. 75, No. 1B, pp. 181–189</li>
<li><a href="http://www.meted.ucar.edu/nwp/pcu1/ic6/frameset.htm">COMET module "Understanding Data Assimilation"</a></li>
<li>Geir Evensen, Data Assimilation. The Ensemble Kalman Filter. Springer, 2009, second edition</li>
<li>John M. LEWIS; S. Lakshmivarahan, Sudarshan Dhall, "Dynamic Data Assimilation : A Least Squares Approach", Encyclopedia of Mathematics and its Applications 104, Cambridge University Press, 2006 (ISBN 978-0-521-85155-8 Hardback)</li>
<li>Gharib Shirangi, M., History matching production data and uncertainty assessment with an efficient TSVD parameterization algorithm, Journal of Petroleum Science and Engineering, 113 (2014) 54–71, <a class="uri" href="http://www.sciencedirect.com/science/article/pii/S0920410513003227">http://www.sciencedirect.com/science/article/pii/S0920410513003227</a></li>
</ul>
<h2 id="footnotes-hyperlinks">Footnotes (hyperlinks)</h2>
<h2 id="external-links">External links</h2>

<p>Examples of how variational assimilation is implemented weather forecasting at:</p>
<ul>
<li><a class="uri" href="ECMWF" title="wikilink">ECMWF</a> <a class="uri" href="http://www.ecmwf.int/research/ifsdocs/ASSIMILATION/Chap1_Overview2.html">http://www.ecmwf.int/research/ifsdocs/ASSIMILATION/Chap1_Overview2.html</a></li>
<li>the <a href="Met_Office" title="wikilink">Met Office</a> <a class="uri" href="http://www.metoffice.gov.uk/science/creating/first_steps/data_assim.html?zoneid=79046">http://www.metoffice.gov.uk/science/creating/first_steps/data_assim.html?zoneid=79046</a></li>
</ul>

<p>Other examples of assimilation:</p>
<ul>
<li><a href="http://www.CDAcentral.info/">CDACentral (an example analysis from Chemical Data Assimilation)</a></li>
<li><a href="http://www.PDFcentral.info/">PDFCentral (using PDFs to examine biases and representativeness)</a></li>
<li><a href="http://www.openda.org/joomla/index.php">OpenDA – Open Source Data Assimilation package</a></li>
<li><a href="http://pdaf.awi.de">PDAF – open-source Parallel Data Assimilation Framework</a></li>
<li><a href="http://www.data-assimilation.net/">SANGOMA New Data Assimilation techniques</a></li>
</ul>

<p>"</p>

<p><a href="Category:Weather_forecasting" title="wikilink">Category:Weather forecasting</a> <a href="Category:Numerical_climate_and_weather_models" title="wikilink">Category:Numerical climate and weather models</a> <a href="Category:Estimation_theory" title="wikilink">Category:Estimation theory</a> <a href="Category:Control_theory" title="wikilink">Category:Control theory</a> <a href="Category:Bayesian_statistics" title="wikilink">Category:Bayesian statistics</a> <a href="Category:Climate_and_weather_statistics" title="wikilink">Category:Climate and weather statistics</a> <a href="Category:Statistical_forecasting" title="wikilink">Category:Statistical forecasting</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"></li>
<li id="fn18"><a class="uri" href="http://ams.confex.com/ams/91Annual/webprogram/Paper181664.html">http://ams.confex.com/ams/91Annual/webprogram/Paper181664.html</a><a href="#fnref18">↩</a></li>
<li id="fn19"><a class="uri" href="http://hfip.psu.edu/EDA2010/MZhang.pdf">http://hfip.psu.edu/EDA2010/MZhang.pdf</a><a href="#fnref19">↩</a></li>
<li id="fn20"><a class="uri" href="http://www.ecmwf.int/newsevents/meetings/annual_seminar/2011/presentations/Barker.pdf">http://www.ecmwf.int/newsevents/meetings/annual_seminar/2011/presentations/Barker.pdf</a><a href="#fnref20">↩</a></li>
<li id="fn21"><a class="uri" href="http://www.metoffice.gov.uk/research/modelling-systems/unified-model/weather-forecasting">http://www.metoffice.gov.uk/research/modelling-systems/unified-model/weather-forecasting</a><a href="#fnref21">↩</a></li>
<li id="fn22"><a class="uri" href="http://www.atm.ox.ac.uk/group/gpfd/research.html#marsgcm">http://www.atm.ox.ac.uk/group/gpfd/research.html#marsgcm</a><a href="#fnref22">↩</a></li>
<li id="fn23"><a class="uri" href="http://www.eps.jhu.edu/~mjhoffman/pages/research.html">http://www.eps.jhu.edu/~mjhoffman/pages/research.html</a><a href="#fnref23">↩</a></li>
<li id="fn24"><a class="uri" href="http://www.marsclimatecenter.com">http://www.marsclimatecenter.com</a><a href="#fnref24">↩</a></li>
<li id="fn25"><a class="uri" href="http://badc.nerc.ac.uk/home/">http://badc.nerc.ac.uk/home/</a><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
</ol>
</section>
</body>
</html>

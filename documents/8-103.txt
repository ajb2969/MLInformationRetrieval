   Piston motion equations      Piston motion equations   The motion of a non-offset piston connected to a crank through a connecting rod (as would be found in internal combustion engines ), can be expressed through several mathematical equations . This article shows how these motion equations are derived, and shows an example graph.  Crankshaft geometry  (Figure)  Diagram showing geometric layout of piston pin, crank pin and crank center   Definitions  l = rod length (distance between piston pin and crank pin )  r = crank  radius (distance between crank pin and crank center, i.e. half stroke )  A = crank angle (from cylinder  bore centerline at TDC )  x = piston pin position (upward from crank center along cylinder bore centerline)  v = piston pin velocity (upward from crank center along cylinder bore centerline)  a = piston pin acceleration (upward from crank center along cylinder bore centerline)  ω = crank angular velocity in rad/s  Angular velocity  The crankshaft  angular velocity is related to the engine revolutions per minute (RPM):      ω  =     2  π   ⋅  RPM   60       ω     normal-⋅    2  π   RPM   60     \omega=\frac{2\pi\cdot\mathrm{RPM}}{60}     Triangle relation  As shown in the diagram, the crank pin , crank center and piston pin form triangle NOP. By the cosine law it is seen that:      l  2   =     r  2   +   x  2    -   2  ⋅  r  ⋅  x  ⋅   cos  A          superscript  l  2        superscript  r  2    superscript  x  2     normal-⋅  2  r  x    A       l^{2}=r^{2}+x^{2}-2\cdot r\cdot x\cdot\cos A     Equations with respect to angular position (Angle Domain)  The equations that follow describe the reciprocating motion of the piston with respect to crank angle. Example graphs of these equations are shown below.  Position  Position with respect to crank angle (by rearranging the triangle relation):        l  2   -   r  2    =    x  2   -   2  ⋅  r  ⋅  x  ⋅   cos  A            superscript  l  2    superscript  r  2       superscript  x  2    normal-⋅  2  r  x    A       l^{2}-r^{2}=x^{2}-2\cdot r\cdot x\cdot\cos A           l  2   -   r  2    =     x  2   -   2  ⋅  r  ⋅  x  ⋅   cos  A     +    r  2    [    (     cos  2   A   +    sin  2   A    )   -  1   ]            superscript  l  2    superscript  r  2         superscript  x  2    normal-⋅  2  r  x    A        superscript  r  2    delimited-[]        superscript   2   A     superscript   2   A    1        l^{2}-r^{2}=x^{2}-2\cdot r\cdot x\cdot\cos A+r^{2}[(\cos^{2}A+\sin^{2}A)-1]             l  2   -   r  2    +   r  2    -    r  2     sin  2   A     =     x  2   -   2  ⋅  r  ⋅  x  ⋅   cos  A     +    r  2     cos  2   A                superscript  l  2    superscript  r  2     superscript  r  2       superscript  r  2     superscript   2   A          superscript  x  2    normal-⋅  2  r  x    A        superscript  r  2     superscript   2   A       l^{2}-r^{2}+r^{2}-r^{2}\sin^{2}A=x^{2}-2\cdot r\cdot x\cdot\cos A+r^{2}\cos^{2}A           l  2   -    r  2     sin  2   A     =    (   x  -   r  ⋅   cos  A     )   2          superscript  l  2      superscript  r  2     superscript   2   A      superscript    x   normal-⋅  r    A     2     l^{2}-r^{2}\sin^{2}A=(x-r\cdot\cos A)^{2}          x  -   r  ⋅   cos  A     =     l  2   -    r  2     sin  2   A            x   normal-⋅  r    A          superscript  l  2      superscript  r  2     superscript   2   A        x-r\cdot\cos A=\sqrt{l^{2}-r^{2}\sin^{2}A}         x  =    r   cos  A    +     l  2   -    r  2     sin  2   A           x      r    A         superscript  l  2      superscript  r  2     superscript   2   A         x=r\cos A+\sqrt{l^{2}-r^{2}\sin^{2}A}     Velocity  Velocity with respect to crank angle (take first derivative , using the chain rule ):         x  ′     =      d  x    d  A         =      -   r   sin  A     +     (   1  2   )   .   (   -  2   )   .    r  2    sin  A    cos  A        l  2   -    r  2     sin  2   A             =      -   r   sin  A     -     r  2    sin  A    cos  A       l  2   -    r  2     sin  2   A               superscript  x  normal-′        d  x     d  A       missing-subexpression          r    A        formulae-sequence    1  2     2      superscript  r  2     A     A          superscript  l  2      superscript  r  2     superscript   2   A           missing-subexpression          r    A          superscript  r  2     A     A         superscript  l  2      superscript  r  2     superscript   2   A           \begin{array}[]{lcl}x^{\prime}&=&\frac{dx}{dA}\\
 &=&-r\sin A+\frac{(\frac{1}{2}).(-2).r^{2}\sin A\cos A}{\sqrt{l^{2}-r^{2}\sin^%
 {2}A}}\\
 &=&-r\sin A-\frac{r^{2}\sin A\cos A}{\sqrt{l^{2}-r^{2}\sin^{2}A}}\end{array}     Acceleration  Acceleration with respect to crank angle (take second derivative , using the chain rule and the quotient rule ):         x  ′′     =       d  2   x    d   A  2          =      -   r   cos  A     -     r  2     cos  2   A       l  2   -    r  2     sin  2   A       -    -    r  2     sin  2   A        l  2   -    r  2     sin  2   A       -      r  2    sin  A    cos  A    .    (   -   1  2    )   ⋅   (   -  2   )    .    r  2    sin  A    cos  A       (     l  2   -    r  2     sin  2   A      )   3          =      -   r   cos  A     -     r  2    (     cos  2   A   -    sin  2   A    )       l  2   -    r  2     sin  2   A       -     r  4     sin  2   A     cos  2   A      (     l  2   -    r  2     sin  2   A      )   3            superscript  x  ′′         superscript  d  2   x     d   superscript  A  2        missing-subexpression          r    A          superscript  r  2     superscript   2   A         superscript  l  2      superscript  r  2     superscript   2   A              superscript  r  2     superscript   2   A          superscript  l  2      superscript  r  2     superscript   2   A          formulae-sequence     superscript  r  2     A     A     normal-⋅      1  2      2       superscript  r  2     A     A      superscript       superscript  l  2      superscript  r  2     superscript   2   A      3        missing-subexpression          r    A          superscript  r  2       superscript   2   A     superscript   2   A          superscript  l  2      superscript  r  2     superscript   2   A            superscript  r  4     superscript   2   A     superscript   2   A     superscript       superscript  l  2      superscript  r  2     superscript   2   A      3        \begin{array}[]{lcl}x^{\prime\prime}&=&\frac{d^{2}x}{dA^{2}}\\
 &=&-r\cos A-\frac{r^{2}\cos^{2}A}{\sqrt{l^{2}-r^{2}\sin^{2}A}}-\frac{-r^{2}%
 \sin^{2}A}{\sqrt{l^{2}-r^{2}\sin^{2}A}}-\frac{r^{2}\sin A\cos A.(-\frac{1}{2})%
 \cdot(-2).r^{2}\sin A\cos A}{\left(\sqrt{l^{2}-r^{2}\sin^{2}A}\right)^{3}}\\
 &=&-r\cos A-\frac{r^{2}(\cos^{2}A-\sin^{2}A)}{\sqrt{l^{2}-r^{2}\sin^{2}A}}-%
 \frac{r^{4}\sin^{2}A\cos^{2}A}{\left(\sqrt{l^{2}-r^{2}\sin^{2}A}\right)^{3}}%
 \end{array}     Equations with respect to time (Time Domain)  Angular velocity derivatives  If angular velocity is constant, then      A  =   ω   t        A    ω  t     A=\omega t\,   and the following relations apply:        d  A    d  t    =  ω          d  A     d  t    ω    \frac{dA}{dt}=\omega            d  2   A    d   t  2     =  0           superscript  d  2   A     d   superscript  t  2     0    \frac{d^{2}A}{dt^{2}}=0     Converting from Angle Domain to Time Domain  The equations that follow describe the reciprocating motion of the piston with respect to time.  If time  domain is required instead of angle domain, first replace A with ω t in the equations, and then scale for angular velocity as follows:  Position  Position with respect to time is simply:      x    x   x\,     Velocity  Velocity with respect to time (using the chain rule ):        v    =      d  x    d  t         =       d  x    d  A    ⋅    d  A    d  t          =       d  x    d  A    ⋅  ω        =      x  ′   ⋅  ω         v       d  x     d  t       missing-subexpression     normal-⋅      d  x     d  A        d  A     d  t        missing-subexpression     normal-⋅      d  x     d  A    ω      missing-subexpression     normal-⋅   superscript  x  normal-′   ω      \begin{array}[]{lcl}v&=&\frac{dx}{dt}\\
 &=&\frac{dx}{dA}\cdot\frac{dA}{dt}\\
 &=&\frac{dx}{dA}\cdot\ \omega\\
 &=&x^{\prime}\cdot\omega\\
 \end{array}     Acceleration  Acceleration with respect to time (using the chain rule and product rule , and the angular velocity derivatives ):        a    =       d  2   x    d   t  2          =      d   d  t      d  x    d  t          =      d   d  t     (     d  x    d  A    ⋅    d  A    d  t     )         =        d   d  t     (    d  x    d  A    )    ⋅    d  A    d  t     +      d  x    d  A    ⋅   d   d  t      (    d  A    d  t    )          =        d   d  A     (    d  x    d  A    )    ⋅    (    d  A    d  t    )   2    +     d  x    d  A    ⋅     d  2   A    d   t  2            =         d  2   x    d   A  2     ⋅    (    d  A    d  t    )   2    +     d  x    d  A    ⋅     d  2   A    d   t  2            =         d  2   x    d   A  2     ⋅   ω  2    +     d  x    d  A    ⋅  0         =      x  ′′   ⋅   ω  2          a        superscript  d  2   x     d   superscript  t  2        missing-subexpression        d    d  t        d  x     d  t        missing-subexpression        d    d  t     normal-⋅      d  x     d  A        d  A     d  t         missing-subexpression       normal-⋅      d    d  t        d  x     d  A         d  A     d  t        normal-⋅      d  x     d  A      d    d  t         d  A     d  t         missing-subexpression       normal-⋅      d    d  A        d  x     d  A      superscript      d  A     d  t    2     normal-⋅      d  x     d  A         superscript  d  2   A     d   superscript  t  2          missing-subexpression       normal-⋅       superscript  d  2   x     d   superscript  A  2      superscript      d  A     d  t    2     normal-⋅      d  x     d  A         superscript  d  2   A     d   superscript  t  2          missing-subexpression       normal-⋅       superscript  d  2   x     d   superscript  A  2      superscript  ω  2     normal-⋅      d  x     d  A    0       missing-subexpression     normal-⋅   superscript  x  ′′    superscript  ω  2       \begin{array}[]{lcl}a&=&\frac{d^{2}x}{dt^{2}}\\
 &=&\frac{d}{dt}\frac{dx}{dt}\\
 &=&\frac{d}{dt}(\frac{dx}{dA}\cdot\frac{dA}{dt})\\
 &=&\frac{d}{dt}(\frac{dx}{dA})\cdot\frac{dA}{dt}+\frac{dx}{dA}\cdot\frac{d}{dt%
 }(\frac{dA}{dt})\\
 &=&\frac{d}{dA}(\frac{dx}{dA})\cdot(\frac{dA}{dt})^{2}+\frac{dx}{dA}\cdot\frac%
 {d^{2}A}{dt^{2}}\\
 &=&\frac{d^{2}x}{dA^{2}}\cdot(\frac{dA}{dt})^{2}+\frac{dx}{dA}\cdot\frac{d^{2}%
 A}{dt^{2}}\\
 &=&\frac{d^{2}x}{dA^{2}}\cdot\omega^{2}+\frac{dx}{dA}\cdot 0\\
 &=&x^{\prime\prime}\cdot\omega^{2}\\
 \end{array}     Scaling for angular velocity  You can see that x is unscaled, x' is scaled by ω , and x" is scaled by ω ². To convert x' from velocity vs angle [inch/rad] to velocity vs time [inch/s] multiply x' by ω [rad/s]. To convert x" from acceleration vs angle [inch/rad²] to acceleration vs time [inch/s²] multiply x" by ω ² [rad²/s²].  Note that dimensional analysis shows that the units are consistent.  Velocity maxima/minima  Acceleration zero crossings  The velocity maxima and minima do not occur at crank angles (A) of plus or minus 90°. The velocity maxima and minima occur at crank angles that depend on rod length (l) and half stroke (r) , and correspond to the crank angles where the acceleration is zero (crossing the horizontal axis).  Crank-Rod angle not right angled  The velocity maxima and minima do not necessarily occur when the crank makes a right angle with the rod. Counter-examples exist to disprove the idea that velocity maxima/minima occur when crank-rod angle is right angled.  Example  For rod length 6" and crank radius 2", numerically solving the acceleration zero-crossings finds the velocity maxima/minima to be at crank angles of ±73.17615°. Then, using the triangle sine law, it is found that the crank-rod angle is 88.21738° and the rod-vertical angle is 18.60647°. Clearly, in this example, the angle between the crank and the rod is not a right angle.  (Sanity check, summing the angles of the triangle 88.21738° + 18.60647° + 73.17615° gives 180.00000°)  A single counter-example is sufficient to disprove the statement "velocity maxima/minima occur when crank makes a right angle with rod" .  Example graph of piston motion  The graph shows x, x', x" with respect to crank angle for various half strokes, where L = rod length (l) and R = half stroke (r) :   Pistons motion animation with same rod length and crank radius values in graph above :   See also   Internal combustion engine  Reciprocating engine  Scotch yoke   References   http://www.epi-eng.com/piston_engine_technology/piston_motion_basics.htm   Further reading   John Benjamin Heywood, Internal Combustion Engine Fundamentals , McGraw Hill, 1989.  Charles Fayette Taylor, The Internal Combustion Engine in Theory and Practice, Vol. 1 & 2 , 2nd Edition, MIT Press 1985.   External links   epi-eng Piston Motion  codecogs Velocity and Acceleration of a Piston  animated engines Four Stroke Engine  desmos interactive crank animation  networcs D & T Mechanisms - Interactive Tools for Teachers  mecamedia piston motion animation  youtube Rotating chevy 350 short block.  youtube 3D animation of a V8 ENGINE  youtube Inside a V8 Engine at Idle Speed   "  Motion equations  Category:Engine technology  Category:Mechanical engineering  Category:Equations   
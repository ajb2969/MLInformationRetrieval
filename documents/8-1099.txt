   Faulhaber's formula      Faulhaber's formula   In mathematics , Faulhaber's formula , named after Johann Faulhaber , expresses the sum of the p -th powers of the first n positive integers        ∑   k  =  1   n    k  p    =    1  p   +   2  p   +   3  p   +  ⋯  +   n  p          superscript   subscript     k  1    n    superscript  k  p       superscript  1  p    superscript  2  p    superscript  3  p   normal-⋯   superscript  n  p      \sum_{k=1}^{n}k^{p}=1^{p}+2^{p}+3^{p}+\cdots+n^{p}     as a ( p + 1)th-degree polynomial function of n , the coefficients involving Bernoulli numbers  B j .  The formula says          ∑   k  =  1   n    k  p    =    1   p  +  1      ∑   j  =  0   p      (   -  1   )   j    (      p  +  1       j     )    B  j    n    p  +  1   -  j        ,     where    B  1    =   -   1  2      .     formulae-sequence      superscript   subscript     k  1    n    superscript  k  p        1    p  1      superscript   subscript     j  0    p      superscript    1   j    binomial    p  1   j    subscript  B  j    superscript  n      p  1   j            where   subscript  B  1        1  2       \sum_{k=1}^{n}k^{p}={1\over p+1}\sum_{j=0}^{p}(-1)^{j}{p+1\choose j}B_{j}n^{p+%
 1-j},\qquad\mbox{where}~{}B_{1}=-\frac{1}{2}.     Faulhaber himself did not know the formula in this form, but only computed the first seventeen polynomials; the general form was established with the discovery of the Bernoulli numbers (see History section below). The derivation of Faulhaber's formula is available in The Book of Numbers by John Horton Conway and Richard K. Guy . 1  There is also a similar (but somehow simpler) expression: using the idea of telescoping and the binomial theorem , one gets Pascal 's identity : 2         (   n  +  1   )    k  +  1    -  1   =    ∑   m  =  1   n    (     (   m  +  1   )    k  +  1    -   m   k  +  1     )    =    ∑   p  =  0   k     (      k  +  1       p     )    (    1  p   +   2  p   +  …  +   n  p    )              superscript    n  1     k  1    1     superscript   subscript     m  1    n      superscript    m  1     k  1     superscript  m    k  1             superscript   subscript     p  0    k      binomial    k  1   p      superscript  1  p    superscript  2  p   normal-…   superscript  n  p         (n+1)^{k+1}-1=\sum_{m=1}^{n}\left((m+1)^{k+1}-m^{k+1}\right)=\sum_{p=0}^{k}{%
 \left({{k+1}\atop{p}}\right)}(1^{p}+2^{p}+\dots+n^{p})   . This in particular yields the examples below, e.g., take k = 1 to get the first example.  Examples       1  +  2  +  3  +  ⋯  +  n   =    n   (   n  +  1   )    2   =     n  2   +  n   2           1  2  3  normal-⋯  n       n    n  1    2             superscript  n  2   n   2      1+2+3+\cdots+n={n(n+1)\over 2}={n^{2}+n\over 2}   (the triangular numbers )        1  2   +   2  2   +   3  2   +  ⋯  +   n  2    =    n   (   n  +  1   )    (    2  n   +  1   )    6   =     2   n  3    +   3   n  2    +  n   6            superscript  1  2    superscript  2  2    superscript  3  2   normal-⋯   superscript  n  2        n    n  1       2  n   1    6              2   superscript  n  3      3   superscript  n  2    n   6      1^{2}+2^{2}+3^{2}+\cdots+n^{2}={n(n+1)(2n+1)\over 6}={2n^{3}+3n^{2}+n\over 6}   (the square pyramidal numbers )        1  3   +   2  3   +   3  3   +  ⋯  +   n  3    =    (    n   (   n  +  1   )    2   )   2   =     n  4   +   2   n  3    +   n  2    4            superscript  1  3    superscript  2  3    superscript  3  3   normal-⋯   superscript  n  3     superscript      n    n  1    2   2             superscript  n  4     2   superscript  n  3     superscript  n  2    4      1^{3}+2^{3}+3^{3}+\cdots+n^{3}=\left({n(n+1)\over 2}\right)^{2}={n^{4}+2n^{3}+%
 n^{2}\over 4}   (the squared triangular numbers )       1  4   +   2  4   +   3  4   +  ⋯  +   n  4        superscript  1  4    superscript  2  4    superscript  3  4   normal-⋯   superscript  n  4     \displaystyle 1^{4}+2^{4}+3^{4}+\cdots+n^{4}          1  5   +   2  5   +   3  5   +  ⋯  +   n  5        superscript  1  5    superscript  2  5    superscript  3  5   normal-⋯   superscript  n  5     \displaystyle 1^{5}+2^{5}+3^{5}+\cdots+n^{5}          1  6   +   2  6   +   3  6   +  ⋯  +   n  6        superscript  1  6    superscript  2  6    superscript  3  6   normal-⋯   superscript  n  6     \displaystyle 1^{6}+2^{6}+3^{6}+\cdots+n^{6}     Proof  Let         S  p    (  n  )    =    ∑   k  =  1   n    k  p     ,         subscript  S  p   n     superscript   subscript     k  1    n    superscript  k  p      S_{p}(n)=\sum_{k=1}^{n}k^{p},   denote the sum under consideration for integer    p  ≥  0.      p  0.    p\geq 0.     Define the following exponential generating function with (initially) indeterminant   z   z   z           G   (  z  ,  n  )    =    ∑   p  =  0   ∞     S  p    (  n  )    1   p  !     z  p      .        G   z  n      superscript   subscript     p  0         subscript  S  p   n    1    p     superscript  z  p       G(z,n)=\sum_{p=0}^{\infty}S_{p}(n)\frac{1}{p!}z^{p}.   We find       G   (  z  ,  n  )    =         G   z  n    absent    \displaystyle G(z,n)=   This is an entire function in   z   z   z   so that   z   z   z   can be taken to be any complex number.  We next recall the exponential generating function for the Bernoulli polynomials      B  j    (  x  )        subscript  B  j   x    B_{j}(x)            z   e   z  x       e  z   -  1    =    ∑   j  =  0   ∞     B  j    (  x  )     z  j    j  !       ,          z   superscript  e    z  x        superscript  e  z   1      superscript   subscript     j  0         subscript  B  j   x     superscript  z  j     j        \frac{ze^{zx}}{e^{z}-1}=\sum_{j=0}^{\infty}B_{j}(x)\frac{z^{j}}{j!},   where     B  j   =    B  j    (  0  )         subscript  B  j      subscript  B  j   0     B_{j}=B_{j}(0)   denotes the Bernoulli number (with the convention     B  1   =   -   1  2         subscript  B  1       1  2      B_{1}=-\frac{1}{2}   ). We obtain the Faulhaber formula by expanding the generating function as follows:       G   (  z  ,  n  )    =         G   z  n    absent    \displaystyle G(z,n)=   Note that     B  j   =  0       subscript  B  j   0    B_{j}=0   for all odd    j  >  1      j  1    j>1   . Hence some authors define     B  1   =   1  2        subscript  B  1     1  2     B_{1}=\frac{1}{2}   so that the alternating factor     (   -  1   )   j     superscript    1   j    (-1)^{j}   is absent.  Alternate expressions  By relabelling we find the alternative expression             ∑   k  =  1   n    k  p    =    ∑   k  =  0   p       (   -  1   )    p  -  k     k  +  1     (      p      k      )    B   p  -  k     n   k  +  1       .        superscript   subscript     k  1    n    superscript  k  p      superscript   subscript     k  0    p        superscript    1     p  k      k  1     binomial  p  k    subscript  B    p  k     superscript  n    k  1        \sum_{k=1}^{n}k^{p}=\sum_{k=0}^{p}{(-1)^{p-k}\over k+1}{p\choose k}B_{p-k}n^{k%
 +1}.     We may also expand    G   (  z  ,  n  )       G   z  n     G(z,n)   in terms of the Bernoulli polynomials to find       G   (  z  ,  n  )    =         G   z  n    absent    \displaystyle G(z,n)=   which implies         ∑   k  =  1   n    k  p    =    1   p  +  1     (     B   p  +  1     (   n  +  1   )    -    B   p  +  1     (  1  )     )     .        superscript   subscript     k  1    n    superscript  k  p        1    p  1         subscript  B    p  1      n  1       subscript  B    p  1    1       \sum_{k=1}^{n}k^{p}=\frac{1}{p+1}\left(B_{p+1}(n+1)-B_{p+1}(1)\right).     Relationship to Riemann Zeta Function  Using     B  k   =   -   k  ζ   (   1  -  k   )          subscript  B  k       k  ζ    1  k       B_{k}=-k\zeta(1-k)   , one can write         ∑   k  =  1   n    k  p    =     n   p  +  1     p  +  1    -    ∑   j  =  0    p  -  1      (     p      j     )   ζ   (   -  j   )    n   p  -  j        .        superscript   subscript     k  1    n    superscript  k  p         superscript  n    p  1      p  1      superscript   subscript     j  0      p  1       binomial  p  j   ζ    j    superscript  n    p  j         \sum\limits_{k=1}^{n}k^{p}=\frac{n^{p+1}}{p+1}-\sum\limits_{j=0}^{p-1}{p%
 \choose j}\zeta(-j)n^{p-j}.     If we consider the generating function    G   (  z  ,  n  )       G   z  n     G(z,n)   in the large   n   n   n   limit for     ℜ   (  z  )    <  0        z   0    \Re(z)<0   , then we find        lim   n  →  ∞     G   (  z  ,  n  )     =   1    e   -  z    -  1    =    ∑   j  =  0   ∞      (   -  1   )   j    B  j     z   j  -  1     j  !              subscript    normal-→  n       G   z  n       1     superscript  e    z    1           superscript   subscript     j  0         superscript    1   j    subscript  B  j      superscript  z    j  1      j         \lim_{n\rightarrow\infty}G(z,n)=\frac{1}{e^{-z}-1}=\sum_{j=0}^{\infty}(-1)^{j}%
 B_{j}\frac{z^{j-1}}{j!}   Heuristically, this suggests that         ∑   k  =  1   ∞    k  p    =      (   -  1   )    p  +  1     B   p  +  1      p  +  1     .        superscript   subscript     k  1       superscript  k  p         superscript    1     p  1     subscript  B    p  1       p  1      \sum_{k=1}^{\infty}k^{p}=\frac{(-1)^{p+1}B_{p+1}}{p+1}.   This result agrees with the value of the Riemann zeta function      ζ   (  s  )    =    ∑   n  =  1   ∞    1   n  s           ζ  s     superscript   subscript     n  1        1   superscript  n  s       \zeta(s)=\sum_{n=1}^{\infty}\frac{1}{n^{s}}   for negative integers    s  =   -  p   <  0        s    p        0     s=-p<0   on appropriately analytically continuing    ζ   (  s  )       ζ  s    \zeta(s)   .  Umbral form  In the classic umbral calculus one formally treats the indices j in a sequence B j as if they were exponents, so that, in this case we can apply the binomial theorem and say        ∑   k  =  1   n    k  p    =    1   p  +  1      ∑   j  =  0   p     (      p  +  1       j     )    B  j    n    p  +  1   -  j       =    1   p  +  1      ∑   j  =  0   p     (      p  +  1       j     )    B  j    n    p  +  1   -  j               superscript   subscript     k  1    n    superscript  k  p        1    p  1      superscript   subscript     j  0    p      binomial    p  1   j    subscript  B  j    superscript  n      p  1   j                1    p  1      superscript   subscript     j  0    p      binomial    p  1   j    superscript  B  j    superscript  n      p  1   j          \sum_{k=1}^{n}k^{p}={1\over p+1}\sum_{j=0}^{p}{p+1\choose j}B_{j}n^{p+1-j}={1%
 \over p+1}\sum_{j=0}^{p}{p+1\choose j}B^{j}n^{p+1-j}             =      (   B  +  n   )    p  +  1    -   B   p  +  1      p  +  1     .      absent       superscript    B  n     p  1     superscript  B    p  1       p  1      ={(B+n)^{p+1}-B^{p+1}\over p+1}.        In the modern umbral calculus, one considers the linear functional  T on the vector space of polynomials in a variable b given by        T   (   b  j   )    =   B  j    .        T   superscript  b  j     subscript  B  j     T(b^{j})=B_{j}.\,     Then one can say        ∑   k  =  1   n    k  p    =    1   p  +  1      ∑   j  =  0   p     (      p  +  1       j     )    B  j    n    p  +  1   -  j       =    1   p  +  1      ∑   j  =  0   p     (      p  +  1       j     )   T   (   b  j   )    n    p  +  1   -  j               superscript   subscript     k  1    n    superscript  k  p        1    p  1      superscript   subscript     j  0    p      binomial    p  1   j    subscript  B  j    superscript  n      p  1   j                1    p  1      superscript   subscript     j  0    p      binomial    p  1   j   T   superscript  b  j    superscript  n      p  1   j          \sum_{k=1}^{n}k^{p}={1\over p+1}\sum_{j=0}^{p}{p+1\choose j}B_{j}n^{p+1-j}={1%
 \over p+1}\sum_{j=0}^{p}{p+1\choose j}T(b^{j})n^{p+1-j}       = {1 \over p+1} T\left(\sum_{j=0}^p {p+1 \choose j} b^j n^{p+1-j} \right)     = T\left({(b+n)^{p+1} - b^{p+1} \over p+1}\right).  Faulhaber polynomials  The term Faulhaber polynomials is used by some authors to refer to something other than the polynomial sequence given above. Faulhaber observed that if p is odd , then       1  p   +   2  p   +   3  p   +  ⋯  +   n  p        superscript  1  p    superscript  2  p    superscript  3  p   normal-⋯   superscript  n  p     1^{p}+2^{p}+3^{p}+\cdots+n^{p}     is a polynomial function of       a  =   1  +  2  +  3  +  ⋯  +  n   =    n   (   n  +  1   )    2    .        a    1  2  3  normal-⋯  n            n    n  1    2      a=1+2+3+\cdots+n=\frac{n(n+1)}{2}.     In particular:         1  3   +   2  3   +   3  3   +  ⋯  +   n  3    =   a  2    ;         superscript  1  3    superscript  2  3    superscript  3  3   normal-⋯   superscript  n  3     superscript  a  2     1^{3}+2^{3}+3^{3}+\cdots+n^{3}=a^{2};            1  5   +   2  5   +   3  5   +  ⋯  +   n  5    =     4   a  3    -   a  2    3    ;         superscript  1  5    superscript  2  5    superscript  3  5   normal-⋯   superscript  n  5          4   superscript  a  3     superscript  a  2    3     1^{5}+2^{5}+3^{5}+\cdots+n^{5}={4a^{3}-a^{2}\over 3};            1  7   +   2  7   +   3  7   +  ⋯  +   n  7    =      12   a  4    -   8   a  3     +   2   a  2     6    ;         superscript  1  7    superscript  2  7    superscript  3  7   normal-⋯   superscript  n  7            12   superscript  a  4      8   superscript  a  3       2   superscript  a  2     6     1^{7}+2^{7}+3^{7}+\cdots+n^{7}={12a^{4}-8a^{3}+2a^{2}\over 6};            1  9   +   2  9   +   3  9   +  ⋯  +   n  9    =       16   a  5    -   20   a  4     +   12   a  3     -   3   a  2     5    ;         superscript  1  9    superscript  2  9    superscript  3  9   normal-⋯   superscript  n  9              16   superscript  a  5      20   superscript  a  4       12   superscript  a  3       3   superscript  a  2     5     1^{9}+2^{9}+3^{9}+\cdots+n^{9}={16a^{5}-20a^{4}+12a^{3}-3a^{2}\over 5};            1  11   +   2  11   +   3  11   +  ⋯  +   n  11    =        32   a  6    -   64   a  5     +   68   a  4     -   40   a  3     +   10   a  2     6    .         superscript  1  11    superscript  2  11    superscript  3  11   normal-⋯   superscript  n  11                32   superscript  a  6      64   superscript  a  5       68   superscript  a  4       40   superscript  a  3       10   superscript  a  2     6     1^{11}+2^{11}+3^{11}+\cdots+n^{11}={32a^{6}-64a^{5}+68a^{4}-40a^{3}+10a^{2}%
 \over 6}.     More generally,       1    2  p   +  1    +   2    2  p   +  1         superscript  1      2  p   1     superscript  2      2  p   1      \displaystyle 1^{2p+1}+2^{2p+1}     The first of these identities (i.e., the case p = 3) is known as Nicomachus's theorem .  Some authors call the polynomials in a on the right-hand sides of these identities Faulhaber polynomials . These polynomials are divisible by because the Bernoulli number  is 0 for    j  >  1      j  1    j>1   odd.  Faulhaber also knew that if a sum for an odd power is given by        ∑   k  =  1   n    k    2  m   +  1     =     c  1    a  2    +    c  2    a  3    +  ⋯  +    c  m    a   m  +  1            superscript   subscript     k  1    n    superscript  k      2  m   1          subscript  c  1    superscript  a  2       subscript  c  2    superscript  a  3    normal-⋯     subscript  c  m    superscript  a    m  1        \sum_{k=1}^{n}k^{2m+1}=c_{1}a^{2}+c_{2}a^{3}+\cdots+c_{m}a^{m+1}     then the sum for the even power just below is given by         ∑   k  =  1   n    k   2  m     =     n  +   1  /  2      2  m   +  1     (    2   c  1   a   +   3   c  2    a  2    +  ⋯  +    (   m  +  1   )    c  m    a  m     )     .        superscript   subscript     k  1    n    superscript  k    2  m           n    1  2        2  m   1        2   subscript  c  1   a     3   subscript  c  2    superscript  a  2    normal-⋯      m  1    subscript  c  m    superscript  a  m        \sum_{k=1}^{n}k^{2m}=\frac{n+1/2}{2m+1}(2c_{1}a+3c_{2}a^{2}+\cdots+(m+1)c_{m}a%
 ^{m}).     Note that the polynomial in parentheses is the derivative of the polynomial above with respect to a .  Since a = n ( n + 1)/2, these formulae show that for an odd power (greater than 1), the sum is a polynomial in n having factors n 2 and ( n + 1) 2 , while for an even power the polynomial has factors n , n + ½ and n + 1.  History  Faulhaber's formula is also called Bernoulli's formula . Faulhaber did not know the properties of the coefficients discovered by Bernoulli. Rather, he knew at least the first 17 cases, as well as the existence of the Faulhaber polynomials for odd powers described above. 3  A rigorous proof of these formulas and his assertion that such formulas would exist for all odd powers took until .  Notes  External links      A very rare book, but Knuth has placed a photocopy in the Stanford library, call number QA154.8 F3 1631a f MATH. ()   (winner of a 1997 Lester R. Ford Award )   "  Category:Finite differences     ↩  ↩  The arxiv.org paper has a misprint in the formula for the sum of 11th powers, which was corrected in the printed version. Correct version. ↩     
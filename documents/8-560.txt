   Lebesgue differentiation theorem      Lebesgue differentiation theorem   In mathematics , the Lebesgue differentiation theorem is a theorem of real analysis , which states that for almost every point, the value of an integrable function is the limit of infinitesimal averages taken about the point. The theorem is named for Henri Lebesgue .  Statement  For a Lebesgue integrable real or complex-valued function f on R n , the indefinite integral is a set function which maps a measurable set A to the Lebesgue integral of    f  ‚ãÖ   ùüè  A      normal-‚ãÖ  f   subscript  1  A     f\cdot\mathbf{1}_{A}   , where    ùüè  A     subscript  1  A    \mathbf{1}_{A}   denotes the characteristic function of the set A . It is usually written          ‚à´  A     f   d  Œª    ,      subscript   A     f  normal-d  Œª     \int_{A}f\ \mathrm{d}\lambda,        with Œª the n ‚Äìdimensional Lebesgue measure .  The derivative of this integral at x is defined to be          lim   B  ‚Üí  x      1   |  B  |      ‚à´  B     f   d  Œª      ,      subscript    normal-‚Üí  B  x        1    B      subscript   B     f  normal-d  Œª       \lim_{B\rightarrow x}\frac{1}{|B|}\int_{B}f\,\mathrm{d}\lambda,        where | B | denotes the volume ( i.e. , the Lebesgue measure) of a ball  B centered at x , and B ‚Üí x means that the diameter of B tends to 0. The Lebesgue differentiation theorem states that this derivative exists and is equal to f ( x ) at almost every point x ‚àà R n . In fact a slightly stronger statement is true. Note that:          |     1   |  B  |      ‚à´  B    f   (  y  )   d  Œª   (  y  )      -   f   (  x  )     |   =   |     1   |  B  |      ‚à´  B    f   (  y  )      -   f   (  x  )   d  Œª   (  y  )     |   ‚â§    1   |  B  |      ‚à´  B     |    f   (  y  )    -   f   (  x  )     |   d  Œª   (  y  )       .                1    B      subscript   B     f  y  normal-d  Œª  y       f  x             1    B      subscript   B     f  y       f  x  normal-d  Œª  y              1    B      subscript   B           f  y     f  x     normal-d  Œª  y        \left|\frac{1}{|B|}\int_{B}f(y)\,\mathrm{d}\lambda(y)-f(x)\right|=\left|\frac{%
 1}{|B|}\int_{B}f(y)-f(x)\,\mathrm{d}\lambda(y)\right|\leq\frac{1}{|B|}\int_{B}%
 |f(y)-f(x)|\,\mathrm{d}\lambda(y).        The stronger assertion is that the right hand side tends to zero for almost every point x . The points x for which this is true are called the Lebesgue points of f .  A more general version also holds. One may replace the balls B by a family   ùí±   ùí±   \mathcal{V}   of sets U of bounded eccentricity . This means that there exists some fixed c > 0 such that each set U from the family is contained in a ball B with     |  U  |   ‚â•    c    |  B  |          U     c    B      |U|\geq c\,|B|   . It is also assumed that every point x ‚àà R n is contained in arbitrarily small sets from   ùí±   ùí±   \mathcal{V}   . When these sets shrink to x , the same result holds: for almost every point x ,          f   (  x  )    =    lim    U  ‚Üí  x   ,   U  ‚àà  ùí±       1   |  U  |      ‚à´  U     f   d  Œª       .        f  x     subscript    formulae-sequence   normal-‚Üí  U  x     U  ùí±         1    U      subscript   U     f  normal-d  Œª        f(x)=\lim_{U\rightarrow x,\,U\in\mathcal{V}}\frac{1}{|U|}\int_{U}f\,\mathrm{d}\lambda.        The family of cubes is an example of such a family   ùí±   ùí±   \mathcal{V}   , as is the family   ùí±   ùí±   \mathcal{V}   ( m ) of rectangles in R 2 such that the ratio of sides stays between m ‚àí1 and m , for some fixed m ‚â•¬†1. If an arbitrary norm is given on R n , the family of balls for the metric associated to the norm is another example.  The one-dimensional case was proved earlier by . If f is integrable on the real line, the function       F   (  x  )    =    ‚à´   -  ‚àû   x    f   (  t  )   d  t          F  x     superscript   subscript        x     f  t  normal-d  t      F(x)=\int_{-\infty}^{x}f(t)\,\mathrm{d}t   is almost everywhere differentiable, with       F  ‚Ä≤    (  x  )    =   f   (  x  )     .         superscript  F  normal-‚Ä≤   x     f  x     F^{\prime}(x)=f(x).     Proof  The theorem in its stronger form‚Äîthat almost every point is a Lebesgue point of a locally integrable function  f ‚Äîcan be proved as a consequence of the weak‚Äì L 1 estimates for the Hardy‚ÄìLittlewood maximal function . The proof below follows the standard treatment that can be found in , ,  and .  Since the statement is local in character, f can be assumed to be zero outside some ball of finite radius and hence integrable. It is then sufficient to prove that the set       E  Œ±   =   {   x  ‚àà   ùêë  n    :     lim sup     |  B  |   ‚Üí  0   ,   x  ‚àà  B       1   |  B  |      ‚à´  B     |    f   (  y  )    -   f   (  x  )     |   d  y      >   2  Œ±    }        subscript  E  Œ±    conditional-set    x   superscript  ùêë  n        subscript  limit-supremum   formulae-sequence   normal-‚Üí    B   0     x  B         1    B      subscript   B           f  y     f  x     normal-d  y        2  Œ±       E_{\alpha}=\Bigl\{x\in\mathbf{R}^{n}:\limsup_{|B|\rightarrow 0,\,x\in B}\frac{%
 1}{|B|}\int_{B}|f(y)-f(x)|\,\mathrm{d}y>2\alpha\Bigr\}   has measure 0 for all Œ± >¬†0.  Let Œµ >¬†0 be given. Using the density of continuous functions of compact  support in L 1 ( R n ) , one can find such a function g satisfying         ‚à•   f  -  g   ‚à•    L  1    =    ‚à´   ùêë  n      |    f   (  x  )    -   g   (  x  )     |   d  x    <  Œµ   .         subscript   norm    f  g     superscript  L  1      subscript    superscript  ùêë  n            f  x     g  x     normal-d  x         Œµ     \|f-g\|_{L^{1}}=\int_{\mathbf{R}^{n}}|f(x)-g(x)|\,\mathrm{d}x<\varepsilon.   It is then helpful to rewrite the main difference as          1   |  B  |      ‚à´  B    f   (  y  )   d  y     -   f   (  x  )     =    (    1   |  B  |      ‚à´  B     (    f   (  y  )    -   g   (  y  )     )   d  y     )   +   (     1   |  B  |      ‚à´  B    g   (  y  )   d  y     -   g   (  x  )     )   +   (    g   (  x  )    -   f   (  x  )     )     .            1    B      subscript   B     f  y  normal-d  y       f  x          1    B      subscript   B         f  y     g  y    normal-d  y           1    B      subscript   B     g  y  normal-d  y       g  x        g  x     f  x       \frac{1}{|B|}\int_{B}f(y)\,\mathrm{d}y-f(x)=\Bigl(\frac{1}{|B|}\int_{B}\bigl(f%
 (y)-g(y)\bigr)\,\mathrm{d}y\Bigr)+\Bigl(\frac{1}{|B|}\int_{B}g(y)\,\mathrm{d}y%
 -g(x)\Bigr)+\bigl(g(x)-f(x)\bigr).   The first term can be bounded by the value at x of the maximal function for f ‚àí g , denoted here by      (   f  -  g   )   *    (  x  )        superscript    f  g     x    (f-g)^{*}(x)   :         1   |  B  |      ‚à´  B     |    f   (  y  )    -   g   (  y  )     |   d  y     ‚â§    sup   r  >  0      1   |    B  r    (  x  )    |      ‚à´    B  r    (  x  )       |    f   (  y  )    -   g   (  y  )     |   d  y      =     (   f  -  g   )   *    (  x  )     .            1    B      subscript   B           f  y     g  y     normal-d  y       subscript  supremum    r  0        1       subscript  B  r   x       subscript      subscript  B  r   x            f  y     g  y     normal-d  y              superscript    f  g     x      \frac{1}{|B|}\int_{B}|f(y)-g(y)|\,\mathrm{d}y\leq\sup_{r>0}\frac{1}{|B_{r}(x)|%
 }\int_{B_{r}(x)}|f(y)-g(y)|\,\mathrm{d}y=(f-g)^{*}(x).   The second term disappears in the limit since g is a continuous function, and the third term is bounded by | f ( x )¬†‚àí g ( x )|. For the absolute value of the original difference to be greater than 2 Œ± in the limit, at least one of the first or third terms must be greater than Œ± in absolute value. However, the estimate on the Hardy‚ÄìLittlewood function says that        |   {  x  :      (   f  -  g   )   *    (  x  )    >  Œ±   }   |   ‚â§      A  n   Œ±      ‚à•   f  -  g   ‚à•    L  1     <      A  n   Œ±    Œµ    ,           conditional-set  x       superscript    f  g     x   Œ±          subscript  A  n   Œ±    subscript   norm    f  g     superscript  L  1               subscript  A  n   Œ±   Œµ      \Bigl|\left\{x:(f-g)^{*}(x)>\alpha\right\}\Bigr|\leq\frac{A_{n}}{\alpha}\,\|f-%
 g\|_{L^{1}}<\frac{A_{n}}{\alpha}\,\varepsilon,   for some constant A n depending only upon the dimension n . The Markov inequality (also called Tchebyshev's inequality) says that       |   {  x  :    |    f   (  x  )    -   g   (  x  )     |   >  Œ±   }   |   ‚â§     1  Œ±      ‚à•   f  -  g   ‚à•    L  1     <     1  Œ±    Œµ            conditional-set  x          f  x     g  x     Œ±         1  Œ±    subscript   norm    f  g     superscript  L  1              1  Œ±   Œµ      \Bigl|\left\{x:|f(x)-g(x)|>\alpha\right\}\Bigr|\leq\frac{1}{\alpha}\,\|f-g\|_{%
 L^{1}}<\frac{1}{\alpha}\,\varepsilon   whence        |   E  Œ±   |   ‚â§       A  n   +  1   Œ±    Œµ    .         subscript  E  Œ±           subscript  A  n   1   Œ±   Œµ     |E_{\alpha}|\leq\frac{A_{n}+1}{\alpha}\,\varepsilon.   Since Œµ was arbitrary, it can be taken to be arbitrarily small, and the theorem follows.  Discussion of proof  The Vitali covering lemma is vital to the proof of this theorem; its role lies in proving the estimate for the Hardy-Littlewood maximal function.  The theorem also holds if balls are replaced, in the definition of the derivative, by families of sets with diameter tending to zero satisfying the Lebesgue's regularity condition , defined above as family of sets with bounded eccentricity . This follows since the same substitution can be made in the statement of the Vitali covering lemma.  Discussion  This is an analogue, and a generalization, of the fundamental theorem of calculus , which equates a Riemann integrable function and the derivative of its (indefinite) integral. It is also possible to show a converse - that every differentiable function is equal to the integral of its derivative, but this requires a Henstock-Kurzweil integral in order to be able to integrate an arbitrary derivative.  A special case of the Lebesgue differentiation theorem is the Lebesgue density theorem , which is equivalent to the differentiation theorem for characteristic functions of measurable sets. The density theorem is usually proved using a simpler method (e.g. see Measure and Category).  This theorem is also true for every finite Borel measure on R n instead of Lebesgue measure (a proof can be found in e.g. ). More generally, it is true of any finite Borel measure on a separable metric space such that at least one of the following holds:   the metric space is a Riemannian manifold ,  the metric space is a locally compact ultrametric space ,  the measure is doubling .   A proof of these results can be found in sections 2.8-2.9 of (Federer 1969).  See also   Lebesgue's density theorem   References                "  Category:Theorems in real analysis  Category:Theorems in measure theory   
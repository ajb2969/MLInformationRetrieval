   Leapfrog integration      Leapfrog integration   In mathematics  leapfrog integration is a method for numerically integrating differential equations of the form       x  ¨   =      d  2   x   /  d    t  2    =   F   (  x  )           normal-¨  x          superscript  d  2   x   d    superscript  t  2           F  x      \ddot{x}=d^{2}x/dt^{2}=F(x)   , or equivalently of the form        v  ˙   =     d  v   /  d   t   =   F   (  x  )     ,    x  ˙   =     d  x   /  d   t   =  v      formulae-sequence       normal-˙  v         d  v   d   t          F  x          normal-˙  x         d  x   d   t        v      \dot{v}=dv/dt=F(x),\;\dot{x}=dx/dt=v   , particularly in the case of a dynamical system of classical mechanics .  The method is known by different names in different disciplines. In particular, it is similar to the Velocity Verlet method, which is a variant of Verlet integration . Leapfrog integration is equivalent to updating positions    x   (  t  )       x  t    x(t)   and velocities     v   (  t  )    =    x  ˙    (  t  )          v  t      normal-˙  x   t     v(t)=\dot{x}(t)   at interleaved time points, staggered in such a way that they 'leapfrog' over each other. For example, the position is updated at integer time steps and the velocity is updated at integer-plus-a-half time steps.  Leapfrog integration is a second order method, in contrast to Euler integration , which is only first order, yet requires the same number of function evaluations per step. Unlike Euler integration, it is stable for oscillatory motion, as long as the time-step    Δ  t      normal-Δ  t    \Delta t   is constant, and     Δ  t   ≤   2  /  ω         normal-Δ  t     2  ω     \Delta t\leq 2/\omega   . 1  In leapfrog integration, the equations for updating position and velocity are      x  i     subscript  x  i    \displaystyle x_{i}     where    x  i     subscript  x  i    x_{i}   is position at step   i   i   i   ,    v   i  +   1  /   2        subscript  v    i    1  2      v_{i+1/2\,}   is the velocity, or first derivative of   x   x   x   , at step    i  +   1  /   2        i    1  2     i+1/2\,   ,     a  i   =   F   (   x  i   )         subscript  a  i     F   subscript  x  i      a_{i}=F(x_{i})   is the acceleration, or second derivative of   x   x   x   , at step   i   i   i   and    Δ  t      normal-Δ  t    \Delta t   is the size of each time step. These equations can be expressed in a form which gives velocity at integer steps as well. 2 However, even in this synchronized form, the time-step    Δ  t      normal-Δ  t    \Delta t   must be constant to maintain stability. 3      x   i  +  1      subscript  x    i  1     \displaystyle x_{i+1}     One use of this equation is in gravity simulations, since in that case the acceleration depends only on the positions of the gravitating masses (and not on their velocities), although higher order integrators (such as Runge–Kutta methods ) are more frequently used.  There are two primary strengths to Leapfrog integration when applied to mechanics problems. The first is the time-reversibility of the Leapfrog method. One can integrate forward n steps, and then reverse the direction of integration and integrate backwards n steps to arrive at the same starting position. The second strength of Leapfrog integration is its symplectic nature, which implies that it conserves the (slightly modified) energy of dynamical systems. This is especially useful when computing orbital dynamics, as many other integration schemes, such as the (order 4) Runge-Kutta method, do not conserve energy and allow the system to drift substantially over time.  Because of its time-reversibility, and because it is a symplectic integrator , leapfrog integration is also used in Hamiltonian Monte Carlo , a method for drawing random samples from a probability distribution whose overall normalization is unknown. 4  See also   Numerical ordinary differential equations  Symplectic integration  Euler integration  Verlet integration  Runge–Kutta integration   References  External links   The Leapfrog Integrator , Drexel University Physics   "  Category:Numerical differential equations     C. K. Birdsall and A. B. Langdon, Plasma Physics via Computer Simulations , McGraw-Hill Book Company, 1985, p. 56 ↩  4.1 Two Ways to Write the Leapfrog ↩  [Skeel, R. D., "Variable Step Size Destabilizes the Stömer/Leapfrog/Verlet Method," BIT Numerical Mathematics, Vol. 33, 1993, pp. 172-175.] ↩  ↩     
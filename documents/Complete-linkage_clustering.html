<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="346">Complete-linkage clustering</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Complete-linkage clustering</h1>
<hr/>

<p><strong>Complete-linkage clustering</strong> is one of several methods of agglomerative <a href="hierarchical_clustering" title="wikilink">hierarchical clustering</a>. At the beginning of the process, each element is in a cluster of its own. The clusters are then sequentially combined into larger clusters until all elements end up being in the same cluster. At each step, the two clusters separated by the shortest distance are combined. The definition of 'shortest distance' is what differentiates between the different agglomerative clustering methods. In complete-linkage clustering, the link between two clusters contains all element pairs, and the distance between clusters equals the distance between those two elements (one in each cluster) that are farthest away from each other. The shortest of these links that remains at any step causes the fusion of the two clusters whose elements are involved. The method is also known as <strong>farthest neighbour clustering</strong>. The result of the clustering can be visualized as a <a class="uri" href="dendrogram" title="wikilink">dendrogram</a>, which shows the sequence of cluster fusion and the distance at which each fusion took place.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Mathematically, the complete linkage function ‚Äî the distance 

<math display="inline" id="Complete-linkage_clustering:0">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo>,</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>D</ci>
    <interval closure="open">
     <ci>X</ci>
     <ci>Y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(X,Y)
  </annotation>
 </semantics>
</math>

 between clusters 

<math display="inline" id="Complete-linkage_clustering:1">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Complete-linkage_clustering:2">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 ‚Äî is described by the following expression : 

<math display="inline" id="Complete-linkage_clustering:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>max</mi>
      <mrow>
       <mrow>
        <mi>x</mi>
        <mo>‚àà</mo>
        <mi>X</mi>
       </mrow>
       <mo>,</mo>
       <mrow>
        <mi>y</mi>
        <mo>‚àà</mo>
        <mi>Y</mi>
       </mrow>
      </mrow>
     </msub>
     <mi>d</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <interval closure="open">
      <ci>X</ci>
      <ci>Y</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <max></max>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <in></in>
         <ci>x</ci>
         <ci>X</ci>
        </apply>
        <apply>
         <in></in>
         <ci>y</ci>
         <ci>Y</ci>
        </apply>
       </apply>
      </apply>
      <ci>d</ci>
     </apply>
     <interval closure="open">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(X,Y)=\max_{x\in X,y\in Y}d(x,y)
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Complete-linkage_clustering:4">
 <semantics>
  <mrow>
   <mi>d</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>d</ci>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(x,y)
  </annotation>
 </semantics>
</math>

 is the distance between elements 

<math display="inline" id="Complete-linkage_clustering:5">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>‚àà</mo>
   <mi>X</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>x</ci>
    <ci>X</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\in X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Complete-linkage_clustering:6">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>‚àà</mo>
   <mi>Y</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <ci>y</ci>
    <ci>Y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y\in Y
  </annotation>
 </semantics>
</math>

 ;</li>
<li>

<math display="inline" id="Complete-linkage_clustering:7">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Complete-linkage_clustering:8">
 <semantics>
  <mi>Y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Y
  </annotation>
 </semantics>
</math>

 are two sets of elements (clusters)</li>
</ul>

<p>Complete linkage clustering avoids a drawback of the alternative <a href="Single_linkage_clustering" title="wikilink">single linkage</a> method - the so-called <em>chaining phenomenon</em>, where clusters formed via single linkage clustering may be forced together due to single elements being close to each other, even though many of the elements in each cluster may be very distant to each other. Complete linkage tends to find compact clusters of approximately equal diameters.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="naive-algorithm">Naive Algorithm</h2>

<p>The following algorithm is an <a href="Hierarchical_clustering" title="wikilink">agglomerative</a> scheme that erases rows and columns in a proximity matrix as old clusters are merged into new ones. The 

<math display="inline" id="Complete-linkage_clustering:9">
 <semantics>
  <mrow>
   <mi>N</mi>
   <mo>√ó</mo>
   <mi>N</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>N</ci>
    <ci>N</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N\times N
  </annotation>
 </semantics>
</math>

 proximity matrix <em>D</em> contains all distances <em>d</em>(<em>i</em>,<em>j</em>). The clusterings are assigned sequence numbers 0,1,......, (<em>n</em>¬†‚àí¬†1) and <em>L</em>(<em>k</em>) is the level of the kth clustering. A cluster with sequence number <em>m</em> is denoted (<em>m</em>) and the proximity between clusters (<em>r</em>) and (<em>s</em>) is denoted <em>d</em>[(<em>r</em>),(<em>s</em>)].</p>

<p>The algorithm is composed of the following steps:</p>
<ol>
<li>Begin with the disjoint clustering having level <em>L</em>(0) = 0 and sequence number m = 0.</li>
<li>Find the most similar pair of clusters in the current clustering, say pair (r), (s), according to <em>d</em>[(<em>r</em>),(<em>s</em>)] = max <em>d</em>[(<em>i</em>),(<em>j</em>)] where the maximum is over all pairs of clusters in the current clustering.</li>
<li>Increment the sequence number: <em>m</em> = <em>m</em>¬†+¬†1. Merge clusters (<em>r</em>) and (<em>s</em>) into a single cluster to form the next clustering <em>m</em>. Set the level of this clustering to <em>L</em>(<em>m</em>) = <em>d</em>[(<em>r</em>),(<em>s</em>)]</li>
<li>Update the proximity matrix, <em>D</em>, by deleting the rows and columns corresponding to clusters (<em>r</em>) and (<em>s</em>) and adding a row and column corresponding to the newly formed cluster. The proximity between the new cluster, denoted (<em>r</em>,<em>s</em>) and old cluster (<em>k</em>) is defined as <em>d</em>[(<em>k</em>), (<em>r</em>,<em>s</em>)] = <strong>max <em>d</em>[(<em>k</em>),(<em>r</em>)], <em>d</em>[(<em>k</em>),(<em>s</em>)]</strong>.</li>
<li>If all objects are in one cluster, stop. Else, go to step 2.</li>
</ol>
<h2 id="optimally-efficient-algorithm">Optimally efficient algorithm</h2>

<p>The algorithm explained above is easy to understand but of complexity 

<math display="inline" id="Complete-linkage_clustering:10">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>3</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùí™</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">3</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(n^{3})
  </annotation>
 </semantics>
</math>

. In May 1976, D. Defays proposed an optimally efficient algorithm of only complexity 

<math display="inline" id="Complete-linkage_clustering:11">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">ùí™</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>n</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ùí™</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{O}(n^{2})
  </annotation>
 </semantics>
</math>

 known as CLINK (published 1977)<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> inspired by the similar algorithm SLINK for <a href="single-linkage_clustering" title="wikilink">single-linkage clustering</a>.</p>
<h2 id="other-linkages">Other linkages</h2>

<p>Alternative linkage schemes include <a href="Single_linkage_clustering" title="wikilink">single linkage</a> and <a href="UPGMA" title="wikilink">average linkage</a> clustering - implementing a different linkage in the naive algorithm is simply a matter of using a different formula to calculate inter-cluster distances in the initial computation of the proximity matrix and in step 4 of the above algorithm. An optimally efficient algorithm is however not available for arbitrary linkages. The formula that should be adjusted has been highlighted using bold text.</p>
<h2 id="references">References</h2>
<h2 id="other-literature">Other literature</h2>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Data_clustering_algorithms" title="wikilink">Category:Data clustering algorithms</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">‚Ü©</a></li>
<li id="fn2">Legendre, P. &amp; Legendre, L. 1998. Numerical Ecology. Second English Edition. 853 pages.<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"><a href="#fnref3">‚Ü©</a></li>
<li id="fn4">Everitt, Landau and Leese (2001), pp. 62-64.<a href="#fnref4">‚Ü©</a></li>
<li id="fn5"><a href="#fnref5">‚Ü©</a></li>
</ol>
</section>
</body>
</html>

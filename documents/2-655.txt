   Ray transfer matrix analysis      Ray transfer matrix analysis   Ray transfer matrix analysis (also known as ABCD matrix analysis ) is a type of ray tracing technique used in the design of some optical systems, particularly lasers . It involves the construction of a ray transfer matrix which describes the optical system; tracing of a light path through the system can then be performed by multiplying this matrix with a vector representing the light ray . The same analysis is also used in accelerator physics to track particles through the magnet installations of a particle accelerator , see Beam optics .  The technique that is described below uses the paraxial approximation of ray optics, which means that all rays are assumed to be at a small angle (θ in radians) and a small distance ( x ) relative to the optical axis of the system. 1  Definition of the ray transfer matrix  The ray tracing technique is based on two reference planes, called the input and output planes, each perpendicular to the optical axis of the system. Without loss of generality, we will define the optical axis so that it coincides with the z -axis of a fixed coordinate system. A light ray enters the system when the ray crosses the input plane at a distance x 1 from the optical axis while traveling in a direction that makes an angle θ 1 with the optical axis. Some distance further along, the ray crosses the output plane, this time at a distance x 2 from the optical axis and making an angle θ 2 . n 1 and n 2 are the indices of refraction of the medium in the input and output plane, respectively.  These quantities are related by the expression        (      x  2        θ  2      )   =    (     A    B      C    D     )    (      x  1        θ  1      )     ,       binomial   subscript  x  2    subscript  θ  2        A  B    C  D     binomial   subscript  x  1    subscript  θ  1       {x_{2}\choose\theta_{2}}=\begin{pmatrix}A&B\\
 C&D\end{pmatrix}{x_{1}\choose\theta_{1}},     where        A  =      x  2    x  1    |     θ  1   =  0      B  =      x  2    θ  1    |     x  1   =  0      ,     formulae-sequence    A   evaluated-at     subscript  x  2    subscript  x  1       subscript  θ  1   0       B   evaluated-at     subscript  x  2    subscript  θ  1       subscript  x  1   0       A={x_{2}\over x_{1}}\bigg|_{\theta_{1}=0}\qquad B={x_{2}\over\theta_{1}}\bigg|%
 _{x_{1}=0},     and        C  =      θ  2    x  1    |     θ  1   =  0      D  =      θ  2    θ  1    |     x  1   =  0      .     formulae-sequence    C   evaluated-at     subscript  θ  2    subscript  x  1       subscript  θ  1   0       D   evaluated-at     subscript  θ  2    subscript  θ  1       subscript  x  1   0       C={\theta_{2}\over x_{1}}\bigg|_{\theta_{1}=0}\qquad D={\theta_{2}\over\theta_%
 {1}}\bigg|_{x_{1}=0}.     This relates the ray vectors at the input and output planes by the ray transfer matrix (RTM) M , which represents the optical system between the two reference planes. A thermodynamics argument based on the blackbody radiation can be used to show that the determinant of a RTM is the ratio of the indices of refraction:        det   (  𝐌  )    =    A  D   -   B  C    =    n  1    n  2     .          𝐌       A  D     B  C            subscript  n  1    subscript  n  2       \det(\mathbf{M})=AD-BC={n_{1}\over n_{2}}.     As a result, if the input and output planes are located within the same medium, or within two different media which happen to have identical indices of refraction, then the determinant of M is simply equal to 1.  Note that at least one source 2 uses a different convention for the ray vectors. The optical direction cosine , n sin θ, is used instead of θ. This would alter some of the ABCD matrices, especially for refraction.  A similar technique can be used to analyze electrical circuits . See  Two-port networks .  Some examples   For example, if there is free space between the two planes, the ray transfer matrix is given by:       𝐒  =   (     1    d      0    1     )       𝐒    1  d    0  1      \mathbf{S}=\begin{pmatrix}1&d\\
 0&1\end{pmatrix}   ,  where d is the separation distance (measured along the optical axis) between the two reference planes. The ray transfer equation thus becomes:       (      x  2        θ  2      )   =   𝐒   (      x  1        θ  1      )         binomial   subscript  x  2    subscript  θ  2      𝐒   binomial   subscript  x  1    subscript  θ  1       {x_{2}\choose\theta_{2}}=\mathbf{S}{x_{1}\choose\theta_{1}}   ,  and this relates the parameters of the two rays as:         x  2     =      x  1   +   d   θ  1          θ  2     =     θ  1          subscript  x  2       subscript  x  1     d   subscript  θ  1        subscript  θ  2     subscript  θ  1      \begin{matrix}x_{2}&=&x_{1}+d\theta_{1}\\
 \theta_{2}&=&\theta_{1}\end{matrix}      Another simple example is that of a thin lens . Its RTM is given by:       𝐋  =   (     1    0         -  1   f      1     )       𝐋    1  0        1   f   1      \mathbf{L}=\begin{pmatrix}1&0\\
 \frac{-1}{f}&1\end{pmatrix}   ,  where f is the focal length of the lens. To describe combinations of optical components, ray transfer matrices may be multiplied together to obtain an overall RTM for the compound optical system. For the example of free space of length d followed by a lens of focal length f :      𝐋𝐒  =    (     1    0         -  1   f      1     )    (     1    d      0    1     )    =   (     1    d         -  1   f       1  -    d  f        )         𝐋𝐒      1  0        1   f   1      1  d    0  1            1  d        1   f     1    d  f         \mathbf{L}\mathbf{S}=\begin{pmatrix}1&0\\
 \frac{-1}{f}&1\end{pmatrix}\begin{pmatrix}1&d\\
 0&1\end{pmatrix}=\begin{pmatrix}1&d\\
 \frac{-1}{f}&1-\frac{d}{f}\end{pmatrix}   .  Note that, since the multiplication of matrices is non- commutative , this is not the same RTM as that for a lens followed by free space:      𝐒𝐋  =    (     1    d      0    1     )    (     1    0         -  1   f      1     )    =   (      1  -    d  f       d         -  1   f      1     )         𝐒𝐋      1  d    0  1      1  0        1   f   1              1    d  f    d        1   f   1       \mathbf{SL}=\begin{pmatrix}1&d\\
 0&1\end{pmatrix}\begin{pmatrix}1&0\\
 \frac{-1}{f}&1\end{pmatrix}=\begin{pmatrix}1-\frac{d}{f}&d\\
 \frac{-1}{f}&1\end{pmatrix}   .  Thus the matrices must be ordered appropriately, with the last matrix premultiplying the second last, and so on until the first matrix is premultiplied by the second. Other matrices can be constructed to represent interfaces with media of different refractive indices , reflection from mirrors , etc.  Table of ray transfer matrices  for simple optical components      Element   Matrix   Remarks       Propagation in free space or in a medium of constant refractive index       (     1    d      0    1     )      1  d    0  1     \begin{pmatrix}1&d\\
 0&1\end{pmatrix}      d = distance      Refraction at a flat interface       (     1    0      0      n  1    n  2       )      1  0    0     subscript  n  1    subscript  n  2       \begin{pmatrix}1&0\\
 0&\frac{n_{1}}{n_{2}}\end{pmatrix}      n 1 = initial refractive index  n 2 = final refractive index.     Refraction at a curved interface       (     1    0         n  1   -   n  2     R  ⋅   n  2         n  1    n  2       )      1  0         subscript  n  1    subscript  n  2     normal-⋅  R   subscript  n  2        subscript  n  1    subscript  n  2       \begin{pmatrix}1&0\\
 \frac{n_{1}-n_{2}}{R\cdot n_{2}}&\frac{n_{1}}{n_{2}}\end{pmatrix}      R = radius of curvature, R > 0 for convex (centre of curvature after interface)  n 1 = initial refractive index  n 2 = final refractive index.     Reflection from a flat mirror       (     1    0      0     -  1      )      1  0    0    1      \begin{pmatrix}1&0\\
 0&-1\end{pmatrix}      Only valid for mirrors perpendicular to the ray.     Reflection from a curved mirror       (     1    0       -   2  R      1     )      1  0        2  R    1     \begin{pmatrix}1&0\\
 -\frac{2}{R}&1\end{pmatrix}      R = radius of curvature, R > 0 for concave, valid in the paraxial approximation     Thin lens       (     1    0       -   1  f      1     )      1  0        1  f    1     \begin{pmatrix}1&0\\
 -\frac{1}{f}&1\end{pmatrix}      f = focal length of lens where f > 0 for convex/positive (converging) lens. Only valid if the focal length is much greater than the thickness of the lens.     Thick lens        (     1    0         n  2   -   n  1      R  2    n  1         n  2    n  1       )    (     1    t      0    1     )    (     1    0         n  1   -   n  2      R  1    n  2         n  1    n  2       )         1  0         subscript  n  2    subscript  n  1       subscript  R  2    subscript  n  1        subscript  n  2    subscript  n  1        1  t    0  1      1  0         subscript  n  1    subscript  n  2       subscript  R  1    subscript  n  2        subscript  n  1    subscript  n  2        \begin{pmatrix}1&0\\
 \frac{n_{2}-n_{1}}{R_{2}n_{1}}&\frac{n_{2}}{n_{1}}\end{pmatrix}\begin{pmatrix}%
 1&t\\
 0&1\end{pmatrix}\begin{pmatrix}1&0\\
 \frac{n_{1}-n_{2}}{R_{1}n_{2}}&\frac{n_{1}}{n_{2}}\end{pmatrix}      n 1 = refractive index outside of the lens.  n 2 = refractive index of the lens itself (inside the lens).  R 1 = Radius of curvature of First surface.  R 2 = Radius of curvature of Second surface.  t = center thickness of lens.     Single right angle prism       (     k     d   n  k        0     1  k      )      k    d    n  k      0    1  k      \begin{pmatrix}k&\frac{d}{nk}\\
 0&\frac{1}{k}\end{pmatrix}      k = (cos   ψ   ψ   \psi   /cos   ϕ   ϕ   \phi   ) is the beam expansion factor, where   ϕ   ϕ   \phi   is the angle of incidence,   ψ   ψ   \psi   is the angle of refraction, d = prism path length, n = refractive index of the prism material. This matrix applies for orthogonal beam exit.     Resonator stability  RTM analysis is particularly useful when modeling the behaviour of light in optical resonators , such as those used in lasers. At its simplest, an optical resonator consists of two identical facing mirrors of 100% reflectivity and radius of curvature  R , separated by some distance d . For the purposes of ray tracing, this is equivalent to a series of identical thin lenses of focal length f = R /2, each separated from the next by length d . This construction is known as a lens equivalent duct or lens equivalent waveguide . The RTM of each section of the waveguide is, as above,      𝐌  =  𝐋𝐒  =   (     1    d         -  1   f       1  -    d  f        )         𝐌  𝐋𝐒         1  d        1   f     1    d  f         \mathbf{M}=\mathbf{L}\mathbf{S}=\begin{pmatrix}1&d\\
 \frac{-1}{f}&1-\frac{d}{f}\end{pmatrix}   .  RTM analysis can now be used to determine the stability of the waveguide (and equivalently, the resonator). That is, it can be determined under what conditions light travelling down the waveguide will be periodically refocussed and stay within the waveguide. To do so, we can find all the "eigenrays" of the system: the input ray vector at each of the mentioned sections of the waveguide times a real or complex factor λ is equal to the output one. This gives:       𝐌   (      x  1        θ  1      )    =   (      x  2        θ  2      )   =   λ   (      x  1        θ  1      )            𝐌   binomial   subscript  x  1    subscript  θ  1      binomial   subscript  x  2    subscript  θ  2           λ   binomial   subscript  x  1    subscript  θ  1        \mathbf{M}{x_{1}\choose\theta_{1}}={x_{2}\choose\theta_{2}}=\lambda{x_{1}%
 \choose\theta_{1}}   .  which is an eigenvalue equation:        [   𝐌  -   λ  𝐈    ]    (      x  1        θ  1      )    =  0         delimited-[]    𝐌    λ  𝐈      binomial   subscript  x  1    subscript  θ  1     0    \left[\mathbf{M}-\lambda\mathbf{I}\right]{x_{1}\choose\theta_{1}}=0   ,  where I is the 2x2 identity matrix .  We proceed to calculate the eigenvalues of the transfer matrix:       det   [   𝐌  -   λ  𝐈    ]    =  0       det    𝐌    λ  𝐈     0    \operatorname{det}\left[\mathbf{M}-\lambda\mathbf{I}\right]=0   ,  leading to the characteristic equation         λ  2   -    tr   (  𝐌  )    λ    +   det   (  𝐌  )     =  0           superscript  λ  2     tr  𝐌   λ     det  𝐌    0    \lambda^{2}-\operatorname{tr}(\mathbf{M})\lambda+\operatorname{det}(\mathbf{M}%
 )=0   ,  where       tr   (  𝐌  )    =   A  +  D   =   2  -   d  f           tr  𝐌     A  D          2    d  f       \operatorname{tr}(\mathbf{M})=A+D=2-{d\over f}     is the trace of the RTM, and       det   (  𝐌  )    =    A  D   -   B  C    =  1         det  𝐌       A  D     B  C         1     \operatorname{det}(\mathbf{M})=AD-BC=1     is the determinant of the RTM. After one common substitution we have:         λ  2   -   2  g  λ    +  1   =  0           superscript  λ  2     2  g  λ    1   0    \lambda^{2}-2g\lambda+1=0   ,  where       g     =  def      tr   (  𝐌  )    2   =   1  -   d   2  f           superscript   def   g     tr  𝐌   2          1    d    2  f        g\ \stackrel{\mathrm{def}}{=}\ {\operatorname{tr}(\mathbf{M})\over 2}=1-{d%
 \over 2f}     is the stability parameter . The eigenvalues are the solutions of the characteristic equation. From the quadratic formula we find       λ  ±   =   g  ±      g  2   -  1           subscript  λ  plus-or-minus    plus-or-minus  g       superscript  g  2   1       \lambda_{\pm}=g\pm\sqrt{g^{2}-1}\,     Now, consider a ray after N passes through the system:       (      x  N        θ  N      )   =    λ  N    (      x  1        θ  1      )         binomial   subscript  x  N    subscript  θ  N       superscript  λ  N    binomial   subscript  x  1    subscript  θ  1       {x_{N}\choose\theta_{N}}=\lambda^{N}{x_{1}\choose\theta_{1}}   .  If the waveguide is stable, no ray should stray arbitrarily far from the main axis, that is, λ N must not grow without limit. Suppose     g  2   >  1       superscript  g  2   1    g^{2}>1   . Then both eigenvalues are real. Since      λ  +    λ  -    =  1         subscript  λ     subscript  λ     1    \lambda_{+}\lambda_{-}=1   , one of them has to be bigger than 1 (in absolute value), which implies that the ray which corresponds to this eigenvector would not converge. Therefore in a stable waveguide,    g  2     superscript  g  2    g^{2}   ≤ 1, and the eigenvalues can be represented by complex numbers:       λ  ±   =   g  ±   i    1  -   g  2       =    cos   (  ϕ  )    ±   i   sin   (  ϕ  )      =   e   ±   i  ϕ            subscript  λ  plus-or-minus    plus-or-minus  g    i      1   superscript  g  2             plus-or-minus    ϕ     i    ϕ           superscript  e   plus-or-minus    i  ϕ        \lambda_{\pm}=g\pm i\sqrt{1-g^{2}}=\cos(\phi)\pm i\sin(\phi)=e^{\pm i\phi}   ,  with the substitution g = cos(ϕ).  For     g  2   <  1       superscript  g  2   1    g^{2}<1   let    r  +     subscript  r     r_{+}   and    r  -     subscript  r     r_{-}   be the eigenvectors with respect to the eigenvalues    λ  +     subscript  λ     \lambda_{+}   and    λ  -     subscript  λ     \lambda_{-}   respectively, which span all the vector space because they are orthogonal, the latter due to    λ  +     subscript  λ     \lambda_{+}   ≠    λ  -     subscript  λ     \lambda_{-}   . The input vector can therefore be written as        c  +    r  +    +    c  -    r  -           subscript  c     subscript  r        subscript  c     subscript  r       c_{+}r_{+}+c_{-}r_{-}   ,  for some constants    c  +     subscript  c     c_{+}   and    c  -     subscript  c     c_{-}   .  After N waveguide sectors, the output reads        𝐌  N    (     c  +    r  +    +    c  -    r  -     )    =     λ  +  N    c  +    r  +    +    λ  -  N    c  -    r  -     =     e   i  N  ϕ     c  +    r  +    +    e   -   i  N  ϕ      c  -    r  -              superscript  𝐌  N        subscript  c     subscript  r        subscript  c     subscript  r            superscript   subscript  λ    N    subscript  c     subscript  r        superscript   subscript  λ    N    subscript  c     subscript  r                superscript  e    i  N  ϕ     subscript  c     subscript  r        superscript  e      i  N  ϕ      subscript  c     subscript  r         \mathbf{M}^{N}(c_{+}r_{+}+c_{-}r_{-})=\lambda_{+}^{N}c_{+}r_{+}+\lambda_{-}^{N%
 }c_{-}r_{-}=e^{iN\phi}c_{+}r_{+}+e^{-iN\phi}c_{-}r_{-}   ,  which represents a periodic function.  Ray transfer matrices for Gaussian beams  The matrix formalism is also useful to describe Gaussian beams . If we have a Gaussian beam of wavelength    λ  0     subscript  λ  0    \lambda_{0}   , radius of curvature R , beam spot size w and refractive index n , it is possible to define a complex beam parameter  q by:       1  q   =    1  R   -    i   λ  0     π  n   w  2            1  q       1  R       i   subscript  λ  0      π  n   superscript  w  2        \frac{1}{q}=\frac{1}{R}-\frac{i\lambda_{0}}{\pi nw^{2}}   .  This beam can be propagated through an optical system with a given ray transfer matrix by using the equation:       (      q  2       1     )   =   k   (     A    B      C    D     )    (      q  1       1     )         binomial   subscript  q  2   1     k    A  B    C  D     binomial   subscript  q  1   1      {q_{2}\choose 1}=k\begin{pmatrix}A&B\\
 C&D\end{pmatrix}{q_{1}\choose 1}   ,  where k is a normalisation constant chosen to keep the second component of the ray vector equal to 1. Using matrix multiplication , this equation expands as       q  2   =   k   (    A   q  1    +  B   )         subscript  q  2     k      A   subscript  q  1    B      q_{2}=k(Aq_{1}+B)\,     and      1  =   k   (    C   q  1    +  D   )        1    k      C   subscript  q  1    D      1=k(Cq_{1}+D)\,     Dividing the first equation by the second eliminates the normalisation constant:       q  2   =     A   q  1    +  B     C   q  1    +  D         subscript  q  2         A   subscript  q  1    B       C   subscript  q  1    D      q_{2}=\frac{Aq_{1}+B}{Cq_{1}+D}   ,  It is often convenient to express this last equation in reciprocal form:        1   q  2    =    C  +   D  /   q  1      A  +   B  /   q  1       .        1   subscript  q  2        C    D   subscript  q  1       A    B   subscript  q  1        {1\over q_{2}}={C+D/q_{1}\over A+B/q_{1}}.     Example: Free space  Consider a beam traveling a distance d through free space, the ray transfer matrix is       [     A     B  ;       C     D  ;      ]   =   [     1     d  ;       0    1     ]         A  B    C  D      1  d    0  1      \begin{bmatrix}A&B\\
 C&D\end{bmatrix}=\begin{bmatrix}1&d\\
 0&1\end{bmatrix}   . and so       q  2   =     A   q  1    +  B     C   q  1    +  D    =     q  1   +  d   1   =    q  1   +  d          subscript  q  2         A   subscript  q  1    B       C   subscript  q  1    D              subscript  q  1   d   1           subscript  q  1   d      q_{2}=\frac{Aq_{1}+B}{Cq_{1}+D}=\frac{q_{1}+d}{1}=q_{1}+d   . That is, traveling through free space increases the radius by d .  Example: Thin lens  Consider a beam traveling through a thin lens with focal length f . The ray transfer matrix is       [     A     B  ;       C     D  ;      ]   =   [     1    0       -   1  /  f      1     ]         A  B    C  D      1  0        1  f    1      \begin{bmatrix}A&B\\
 C&D\end{bmatrix}=\begin{bmatrix}1&0\\
 -1/f&1\end{bmatrix}   . and so       q  2   =     A   q  1    +  B     C   q  1    +  D    =    q  1     -    q  1   f    +  1           subscript  q  2         A   subscript  q  1    B       C   subscript  q  1    D            subscript  q  1          subscript  q  1   f    1       q_{2}=\frac{Aq_{1}+B}{Cq_{1}+D}=\frac{q_{1}}{-\frac{q_{1}}{f}+1}          1   q  2    =     -    q  1   f    +  1    q  1    =    1   q  1    -   1  f            1   subscript  q  2             subscript  q  1   f    1    subscript  q  1             1   subscript  q  1      1  f       \frac{1}{q_{2}}=\frac{-\frac{q_{1}}{f}+1}{q_{1}}=\frac{1}{q_{1}}-\frac{1}{f}   . Again, only the real part of q is affected: the reciprocal of the radius of curvature is reduced by 1/ f .  See also   Transfer-matrix method (optics)  Linear canonical transformation   References  *: Section 1.4, pp. 26 – 36.  *:  *: Chapter 6.  External links   Thick lenses (Matrix methods)  ABCD Matrices Tutorial Provides an example for a system matrix of an entire system.  ABCD Calculator An interactive calculator to help solve ABCD matrices.  Simple Optical Designer (Android App) An application to explore optical systems using the ABCD matrix method.   "  Category:Geometrical optics  Category:Accelerator physics     An exact method for tracing meridional rays is available here . ↩  ↩     
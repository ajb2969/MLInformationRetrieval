   Partial fractions in complex analysis      Partial fractions in complex analysis   In complex analysis , a partial fraction expansion is a way of writing a meromorphic function  f(z) as an infinite sum of rational functions and polynomials . When f(z) is a rational function, this reduces to the usual method of partial fractions .  Motivation  By using polynomial long division and the partial fraction technique from algebra, any rational function can be written as a sum of terms of the form 1 / (az + b) k + p(z) , where a and b are complex, k is an integer, and p(z) is a polynomial . Just as polynomial factorization can be generalized to the Weierstrass factorization theorem , there is an analogy to partial fraction expansions for certain meromorphic functions.  A proper rational function, i.e. one for which the degree of the denominator is greater than the degree of the numerator, has a partial fraction expansion with no polynomial terms. Similarly, a meromorphic function f(z) for which | f(z) | goes to 0 as z goes to infinity at least as quickly as | 1/z |, has an expansion with no polynomial terms.  Calculation  Let f(z) be a function meromorphic in the finite complex plane with poles at λ 1 , λ 2 , ..., and let ( Γ 1 , Γ 2 , ...) be a sequence of simple closed curves such that:   The origin lies inside each curve Γ k  No curve passes through a pole of f  Γ k lies inside Γ k+1 for all k        lim   k  →  ∞     d   (   Γ  k   )     =  ∞        subscript    normal-→  k       d   subscript  normal-Γ  k        \lim_{k\rightarrow\infty}d(\Gamma_{k})=\infty   , where d(Γ k ) gives the distance from the curve to the origin   Suppose also that there exists an integer p such that        lim   k  →  ∞      ∮   Γ  k      |    f   (  z  )     z   p  +  1     |    |   d  z   |      <  ∞        subscript    normal-→  k       subscript  contour-integral   subscript  normal-Γ  k            f  z    superscript  z    p  1          d  z          \lim_{k\rightarrow\infty}\oint_{\Gamma_{k}}\left|\frac{f(z)}{z^{p+1}}\right||%
 dz|<\infty     Writing PP( f(z) ; z = λ k ) for the principal part of the Laurent expansion of f about the point λ k , we have        f   (  z  )    =    ∑   k  =  0   ∞    PP   (   f   (  z  )    ;   z  =   λ  k    )      ,        f  z     superscript   subscript     k  0       PP    f  z     z   subscript  λ  k        f(z)=\sum_{k=0}^{\infty}\operatorname{PP}(f(z);z=\lambda_{k}),     if p = -1 , and if p > -1 ,        f   (  z  )    =    ∑   k  =  0   ∞    (    PP   (   f   (  z  )    ;   z  =   λ  k    )    +   c   0  ,  k    +    c   1  ,  k    z   +  ⋯  +    c   p  ,  k     z  p     )     ,        f  z     superscript   subscript     k  0         PP    f  z     z   subscript  λ  k      subscript  c   0  k       subscript  c   1  k    z   normal-⋯     subscript  c   p  k     superscript  z  p        f(z)=\sum_{k=0}^{\infty}(\operatorname{PP}(f(z);z=\lambda_{k})+c_{0,k}+c_{1,k}%
 z+\cdots+c_{p,k}z^{p}),     where the coefficients c j,k are given by       c   j  ,  k    =    Res   z  =   λ  k       f   (  z  )     z   j  +  1           subscript  c   j  k      subscript  Res    z   subscript  λ  k         f  z    superscript  z    j  1        c_{j,k}=\operatorname{Res}_{z=\lambda_{k}}\frac{f(z)}{z^{j+1}}     λ 0 should be set to 0, because even if f(z) itself does not have a pole at 0, the residues of f(z)/z j+1 at z = 0 must still be included in the sum.  Note that in the case of λ 0 = 0, we can use the Laurent expansion of f(z) about the origin to get       f   (  z  )    =     a   -  m     z  m    +    a    -  m   +  1     z   m  -  1     +  ⋯  +   a  0   +    a  1   z   +  ⋯         f  z        subscript  a    m     superscript  z  m       subscript  a      m   1     superscript  z    m  1     normal-⋯   subscript  a  0      subscript  a  1   z   normal-⋯     f(z)=\frac{a_{-m}}{z^{m}}+\frac{a_{-m+1}}{z^{m-1}}+\cdots+a_{0}+a_{1}z+\cdots           c   j  ,  k    =    Res   z  =  0     (     a   -  m     z   m  +  j  +  1     +    a    -  m   +  1     z   m  +  j     +  ⋯  +    a  j   z   +  ⋯   )    =   a  j    ,         subscript  c   j  k      subscript  Res    z  0         subscript  a    m     superscript  z    m  j  1        subscript  a      m   1     superscript  z    m  j     normal-⋯     subscript  a  j   z   normal-⋯          subscript  a  j      c_{j,k}=\operatorname{Res}_{z=0}\left(\frac{a_{-m}}{z^{m+j+1}}+\frac{a_{-m+1}}%
 {z^{m+j}}+\cdots+\frac{a_{j}}{z}+\cdots\right)=a_{j},           ∑   j  =  0   p     c   j  ,  k     z  j     =    a  0   +    a  1   z   +  ⋯  +    a  p    z  p           superscript   subscript     j  0    p      subscript  c   j  k     superscript  z  j        subscript  a  0      subscript  a  1   z   normal-⋯     subscript  a  p    superscript  z  p       \sum_{j=0}^{p}c_{j,k}z^{j}=a_{0}+a_{1}z+\cdots+a_{p}z^{p}     so that the polynomial terms contributed are exactly the regular part of the Laurent series up to z p .  For the other poles λ k where k ≥ 1, 1/z j+1 can be pulled out of the residue calculations:       c   j  ,  k    =    1   λ  k   j  +  1       Res   z  =   λ  k     f    (  z  )         subscript  c   j  k        1   superscript   subscript  λ  k     j  1       subscript  Res    z   subscript  λ  k     f   z     c_{j,k}=\frac{1}{\lambda_{k}^{j+1}}\operatorname{Res}_{z=\lambda_{k}}f(z)           ∑   j  =  0   p     c   j  ,  k     z  j     =    [     Res   z  =   λ  k     f    (  z  )    ]     ∑   j  =  0   p     1   λ  k   j  +  1      z  j            superscript   subscript     j  0    p      subscript  c   j  k     superscript  z  j        delimited-[]      subscript  Res    z   subscript  λ  k     f   z      superscript   subscript     j  0    p       1   superscript   subscript  λ  k     j  1      superscript  z  j        \sum_{j=0}^{p}c_{j,k}z^{j}=[\operatorname{Res}_{z=\lambda_{k}}f(z)]\sum_{j=0}^%
 {p}\frac{1}{\lambda_{k}^{j+1}}z^{j}     To avoid issues with convergence, the poles should be ordered so that if λ k is inside Γ n , then λ j is also inside Γ n for all j k'' will be squares with vertices at ±πk ± πki traversed counterclockwise, k > 1, which are easily seen to satisfy the necessary conditions.  On the horizontal sides of Γ k ,        z  =   t  ±   π  k  i     ,   t  ∈   [   -   π  k    ,   π  k   ]     ,     formulae-sequence    z   plus-or-minus  t    π  k  i       t       π  k      π  k       z=t\pm\pi ki,\ \ t\in[-\pi k,\pi k],     so        |   tan   (  z  )    |   2   =    |      sin   (  t  )     cosh   (   π  k   )     ±   i   cos   (  t  )     sinh   (   π  k   )         cos   (  t  )     cosh   (   π  k   )     ±   i   sin   (  t  )     sinh   (   π  k   )       |   2        superscript      z    2    superscript       plus-or-minus      t       π  k       i    t       π  k       plus-or-minus      t       π  k       i    t       π  k        2     |\tan(z)|^{2}=\left|\frac{\sin(t)\cosh(\pi k)\pm i\cos(t)\sinh(\pi k)}{\cos(t)%
 \cosh(\pi k)\pm i\sin(t)\sinh(\pi k)}\right|^{2}           |   tan   (  z  )    |   2   =       sin  2    (  t  )      cosh  2    (   π  k   )     +     cos  2    (  t  )      sinh  2    (   π  k   )          cos  2    (  t  )      cosh  2    (   π  k   )     +     sin  2    (  t  )      sinh  2    (   π  k   )            superscript      z    2           superscript   2   t     superscript   2     π  k         superscript   2   t     superscript   2     π  k            superscript   2   t     superscript   2     π  k         superscript   2   t     superscript   2     π  k         |\tan(z)|^{2}=\frac{\sin^{2}(t)\cosh^{2}(\pi k)+\cos^{2}(t)\sinh^{2}(\pi k)}{%
 \cos^{2}(t)\cosh^{2}(\pi k)+\sin^{2}(t)\sinh^{2}(\pi k)}     sinh( x ) |\tan(z)|^2  For x > 0, coth( x ) is continuous, decreasing, and bounded below by 1, so it follows that on the horizontal sides of Γ k , |tan( z )| k''.  With this bound on |tan( z )| we can see that         ∮   Γ  k      |    tan   (  z  )    z   |   d  z    ≤    length   (   Γ  k   )      max   z  ∈   Γ  k      |    tan   (  z  )    z   |     <   8  k  π    coth   (  π  )     k  π     =   8   coth   (  π  )     <  ∞   .          subscript  contour-integral   subscript  normal-Γ  k            z   z    d  z      length   subscript  normal-Γ  k      subscript     z   subscript  normal-Γ  k           z   z             8  k  π     hyperbolic-cotangent  π     k  π            8   hyperbolic-cotangent  π             \oint_{\Gamma_{k}}\left|\frac{\tan(z)}{z}\right|dz\leq\operatorname{length}(%
 \Gamma_{k})\max_{z\in\Gamma_{k}}\left|\frac{\tan(z)}{z}\right|<8k\pi\frac{%
 \coth(\pi)}{k\pi}=8\coth(\pi)<\infty.     (The maximum of |1/ z | on Γ k occurs at the minimum of | z |, which is kπ ).  Therefore p = 0, and the partial fraction expansion of tan( z ) looks like        tan   (  z  )    =    ∑   k  =  0   ∞    (    PP   (   tan   (  z  )    ;   z  =   λ  k    )    +    Res   z  =   λ  k       tan   (  z  )    z     )     .        z     superscript   subscript     k  0         PP    z     z   subscript  λ  k       subscript  Res    z   subscript  λ  k         z   z        \tan(z)=\sum_{k=0}^{\infty}(\operatorname{PP}(\tan(z);z=\lambda_{k})+%
 \operatorname{Res}_{z=\lambda_{k}}\frac{\tan(z)}{z}).     The principal parts and residues are easy enough to calculate, as all the poles of tan( z ) are simple and have residue -1:       PP   (   tan   (  z  )    ;   z  =    (   n  +   1  2    )   π    )    =    -  1    z  -    (   n  +   1  2    )   π          PP    z     z      n    1  2    π         1     z      n    1  2    π       \operatorname{PP}(\tan(z);z=(n+\frac{1}{2})\pi)=\frac{-1}{z-(n+\frac{1}{2})\pi}           Res   z  =    (   n  +   1  2    )   π       tan   (  z  )    z    =    -  1     (   n  +   1  2    )   π          subscript  Res    z      n    1  2    π         z   z        1       n    1  2    π      \operatorname{Res}_{z=(n+\frac{1}{2})\pi}\frac{\tan(z)}{z}=\frac{-1}{(n+\frac{%
 1}{2})\pi}     We can ignore λ 0 = 0, since both tan( z ) and tan( z )/ z are analytic at 0, so there is no contribution to the sum, and ordering the poles λ k so that λ 1 = π /2, λ 2 = - π /2, λ 3 = 3 π /2, etc., gives       tan   (  z  )    =    ∑   k  =  0   ∞    [    (     -  1    z  -    (   k  +   1  2    )   π     -   1    (   k  +   1  2    )   π     )   +   (     -  1    z  +    (   k  +   1  2    )   π     +   1    (   k  +   1  2    )   π     )    ]          z     superscript   subscript     k  0       delimited-[]          1     z      k    1  2    π       1      k    1  2    π           1     z      k    1  2    π       1      k    1  2    π          \tan(z)=\sum_{k=0}^{\infty}\left[\left(\frac{-1}{z-(k+\frac{1}{2})\pi}-\frac{1%
 }{(k+\frac{1}{2})\pi}\right)+\left(\frac{-1}{z+(k+\frac{1}{2})\pi}+\frac{1}{(k%
 +\frac{1}{2})\pi}\right)\right]          tan   (  z  )    =    ∑   k  =  0   ∞     -   2  z      z  2   -     (   k  +   1  2    )   2    π  2             z     superscript   subscript     k  0            2  z       superscript  z  2      superscript    k    1  2    2    superscript  π  2         \tan(z)=\sum_{k=0}^{\infty}\frac{-2z}{z^{2}-(k+\frac{1}{2})^{2}\pi^{2}}     Applications  Infinite products  Because the partial fraction expansion often yields sums of 1/(a+bz) , it can be useful in finding a way to write a function as an infinite product ; integrating both sides gives a sum of logarithms, and exponentiating gives the desired product:       tan   (  z  )    =   -    ∑   k  =  0   ∞    (    1   z  -    (   k  +   1  2    )   π     +   1   z  +    (   k  +   1  2    )   π      )           z       superscript   subscript     k  0          1    z      k    1  2    π       1    z      k    1  2    π          \tan(z)=-\sum_{k=0}^{\infty}\left(\frac{1}{z-(k+\frac{1}{2})\pi}+\frac{1}{z+(k%
 +\frac{1}{2})\pi}\right)           ∫  0  z     tan   (  w  )    d  w    =   log   sec  z          superscript   subscript   0   z       w   d  w        z      \int_{0}^{z}\tan(w)dw=\log\sec z           ∫  0  z     1   w  ±    (   k  +   1  2    )   π     d  w    =   log   (   1  ±   z    (   k  +   1  2    )   π     )          superscript   subscript   0   z       1   plus-or-minus  w      k    1  2    π     d  w       plus-or-minus  1    z      k    1  2    π        \int_{0}^{z}\frac{1}{w\pm(k+\frac{1}{2})\pi}dw=\log\left(1\pm\frac{z}{(k+\frac%
 {1}{2})\pi}\right)     Applying some logarithm rules,       log   sec  z    =   -    ∑   k  =  0   ∞    (    log   (   1  -   z    (   k  +   1  2    )   π     )    +   log   (   1  +   z    (   k  +   1  2    )   π     )     )             z        superscript   subscript     k  0            1    z      k    1  2    π          1    z      k    1  2    π           \log\sec z=-\sum_{k=0}^{\infty}\left(\log\left(1-\frac{z}{(k+\frac{1}{2})\pi}%
 \right)+\log\left(1+\frac{z}{(k+\frac{1}{2})\pi}\right)\right)           log   cos  z    =    ∑   k  =  0   ∞    log   (   1  -    z  2      (   k  +   1  2    )   2    π  2      )      ,          z      superscript   subscript     k  0          1     superscript  z  2      superscript    k    1  2    2    superscript  π  2          \log\cos z=\sum_{k=0}^{\infty}\log\left(1-\frac{z^{2}}{(k+\frac{1}{2})^{2}\pi^%
 {2}}\right),     which finally gives        cos  z   =    ∏   k  =  0   ∞    (   1  -    z  2      (   k  +   1  2    )   2    π  2      )     .        z     superscript   subscript  product    k  0        1     superscript  z  2      superscript    k    1  2    2    superscript  π  2         \cos z=\prod_{k=0}^{\infty}\left(1-\frac{z^{2}}{(k+\frac{1}{2})^{2}\pi^{2}}%
 \right).     Laurent series  The partial fraction expansion for a function can also be used to find a Laurent series for it by simply replacing the rational functions in the sum with their Laurent series, which are often not difficult to write in closed form. This can also lead to interesting identities if a Laurent series is already known.  Recall that        tan   (  z  )    =    ∑   k  =  0   ∞     -   2  z      z  2   -     (   k  +   1  2    )   2    π  2       =    ∑   k  =  0   ∞     -   8  z      4   z  2    -     (    2  k   +  1   )   2    π  2        .          z     superscript   subscript     k  0            2  z       superscript  z  2      superscript    k    1  2    2    superscript  π  2              superscript   subscript     k  0            8  z        4   superscript  z  2       superscript      2  k   1   2    superscript  π  2          \tan(z)=\sum_{k=0}^{\infty}\frac{-2z}{z^{2}-(k+\frac{1}{2})^{2}\pi^{2}}=\sum_{%
 k=0}^{\infty}\frac{-8z}{4z^{2}-(2k+1)^{2}\pi^{2}}.     We can expand the summand using a geometric series:         -   8  z      4   z  2    -     (    2  k   +  1   )   2    π  2      =     8  z      (    2  k   +  1   )   2    π  2      1   1  -    (    2  z     (    2  k   +  1   )   π    )   2      =    8     (    2  k   +  1   )   2    π  2       ∑   n  =  0   ∞      2   2  n       (    2  k   +  1   )    2  n     π   2  n       z    2  n   +  1        .              8  z        4   superscript  z  2       superscript      2  k   1   2    superscript  π  2            8  z      superscript      2  k   1   2    superscript  π  2       1    1   superscript      2  z         2  k   1   π    2               8     superscript      2  k   1   2    superscript  π  2       superscript   subscript     n  0           superscript  2    2  n       superscript      2  k   1     2  n     superscript  π    2  n       superscript  z      2  n   1          \frac{-8z}{4z^{2}-(2k+1)^{2}\pi^{2}}=\frac{8z}{(2k+1)^{2}\pi^{2}}\frac{1}{1-(%
 \frac{2z}{(2k+1)\pi})^{2}}=\frac{8}{(2k+1)^{2}\pi^{2}}\sum_{n=0}^{\infty}\frac%
 {2^{2n}}{(2k+1)^{2n}\pi^{2n}}z^{2n+1}.     Substituting back,        tan   (  z  )    =   2    ∑   k  =  0   ∞     ∑   n  =  0   ∞      2    2  n   +  2       (    2  k   +  1   )     2  n   +  2     π    2  n   +  2       z    2  n   +  1         ,        z     2    superscript   subscript     k  0        superscript   subscript     n  0           superscript  2      2  n   2       superscript      2  k   1       2  n   2     superscript  π      2  n   2       superscript  z      2  n   1          \tan(z)=2\sum_{k=0}^{\infty}\sum_{n=0}^{\infty}\frac{2^{2n+2}}{(2k+1)^{2n+2}%
 \pi^{2n+2}}z^{2n+1},     which shows that the coefficients a n in the Laurent (Taylor) series of tan(z) about z = 0 are       a    2  n   +  1    =    T    2  n   +  1      (    2  n   +  1   )   !    =     2    2  n   +  3     π    2  n   +  2       ∑   k  =  0   ∞    1    (    2  k   +  1   )     2  n   +  2              subscript  a      2  n   1       subscript  T      2  n   1          2  n   1               superscript  2      2  n   3     superscript  π      2  n   2       superscript   subscript     k  0        1   superscript      2  k   1       2  n   2          a_{2n+1}=\frac{T_{2n+1}}{(2n+1)!}=\frac{2^{2n+3}}{\pi^{2n+2}}\sum_{k=0}^{%
 \infty}\frac{1}{(2k+1)^{2n+2}}           a   2  n    =    T   2  n      (   2  n   )   !    =  0   ,         subscript  a    2  n       subscript  T    2  n        2  n          0     a_{2n}=\frac{T_{2n}}{(2n)!}=0,     where T n are the tangent numbers .  Conversely, we can compare this formula to the Taylor expansion for tan( z ) about z = 0 to calculate the infinite sums:       tan   (  z  )    =   z  +    1  3    z  3    +    2  15    z  5    +  ⋯         z     z      1  3    superscript  z  3        2  15    superscript  z  5    normal-⋯     \tan(z)=z+\frac{1}{3}z^{3}+\frac{2}{15}z^{5}+\cdots           ∑   k  =  0   ∞    1    (    2  k   +  1   )   2     =    π  2    2  3    =    π  2   8           superscript   subscript     k  0        1   superscript      2  k   1   2        superscript  π  2    superscript  2  3            superscript  π  2   8      \sum_{k=0}^{\infty}\frac{1}{(2k+1)^{2}}=\frac{\pi^{2}}{2^{3}}=\frac{\pi^{2}}{8}            ∑   k  =  0   ∞    1    (    2  k   +  1   )   4     =    1  3     π  4    2  5     =    π  4   96    .          superscript   subscript     k  0        1   superscript      2  k   1   4         1  3      superscript  π  4    superscript  2  5             superscript  π  4   96      \sum_{k=0}^{\infty}\frac{1}{(2k+1)^{4}}=\frac{1}{3}\frac{\pi^{4}}{2^{5}}=\frac%
 {\pi^{4}}{96}.     See also   Partial fraction  Line integral  Residue (complex analysis)  Residue theorem   References   Markushevich, A.I. Theory of functions of a complex variable . Trans. Richard A. Silverman. Vol. 2. Englewood Cliffs, N.J.: Prentice-Hall, 1965.   "  Category:Complex analysis  Category:Partial fractions   
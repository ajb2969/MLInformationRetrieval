


Draft:Adaptive filtering by optimal projection




Draft:Adaptive filtering by optimal projection



Adaptive filtering by optimal projection (AFOP) is a mathematical procedure for filtering a multivariate signal. It is a linear, spatial, instantaneous and adaptive filter. The method consists on constructing a filtering matrix which will reduce artifact components and preserve at most main signal components. The construction of the matrix requires two steps:

The first one to determine the distribution of artifacts using the common spatial pattern (CSP).


The second one to determine the distribution of main signals using a linear regression.

Details
Suppose two windows of a multivariate signals 
 
 
 
  of dimension 
 
 
 
 . 
 
 
 
  is the number of signals and 
 
 
 
  is the number samples.
The aim of AFOP is to construct a filtering matrix 
 
 
 
  of dimension 
 
 
 
  such that 
 
 
 
  preserves at most the main signals while reducing at most the artifacts.
This filtering matrix is an idempotent matrix that is to say 
 
 
 
 . The eigen values of idempotent matrix are all 0 or 1. Thus, any idempotent matrix can be defined (from a unique way) by the two right-eigen spaces:



 
  of dimension 
 
 
 
  which corresponds to the image

 
 .




 
  of dimension 
 
 
 
  which corresponds to the nullspace of 
 
 
 
 .

On the same way, any idempotent matrix can be defined (from a unique way) by the two left eigen spaces:


 
  of dimension 
 
 



 
  of dimension 
 
 

 
  corresponds to the distribution (or mixing) of main signals whereas 
 
 
 
  corresponds to the distribution of artifacts signals.


 
  corresponds to the separation main signals (a.k.a. how to obtain the components of main signals from the various channel) whereas 
 
 
 
  corresponds to the separation of artifacts signals.
AFOP use two steps to determine those subspaces:
Step 1. Determination of F1
The determination of 
 
 
 
  is based on the assumption that artifact distribution subspace 
 
 
 
  on the window 
 
 
 
  is the same that the one on other windows 
 
 
 
  and 
 
 
 
  of respective dimension 
 
 
 
  and 
 
 
 
 . In addition, it is assumed that the ratio of all artifacts between 
 
 
 
  and 
 
 
 
  is supperior to the ratio of main signals.
This first step consists then to use the Common spatial pattern method to extract the subspace of components which have the minimum variance ratio between those two windows.



The solution is given analytically by the diagonalisation of 
 
 
 
  with 
 
 
 
  and 
 
 
 
 , the two covariance matrices. We have then:



with 
 
 
 
  the matrix of eigenvector and 
 
 
 
  the diagonal matrix of eigen values 
 
 
 
  sorted by increasing order.


 
  is then the subspace generated by the 
 
 
 
  first eigen vectors in 
 
 
 
 .
Step 2. Determination of E1
Once the separation of main components is determined, the distribution of those components is computed by a linear regression on the window 
 
 
 
 . 
 
 
 
  is then defined by:



that is to say 
 
 
 
  is the subspace orthogonal to 
 
 
 
  for the scalar product 
 
 
 
  with 
 
 
 
  the covariance matrix of 
 
 
 
 .
The frequency dual method
The DAFOP method consist in researching sources with a frequency pattern
Progressive orthogonalization
If the artifact distribution on the window 
 
 
 
  is slightly different from the one on window 
 
 
 
 , some instability may occur. A residue of artifact can appear of the main signal components and the linear regression tends to over amplify this component.
To reduce this problem, it is possible to project the 
 
 
 
  under the principal components of PCA. Here is the precise algorithm:
1. PCA: Compute the covariance matrix and its diagonalisation (with diagonal matrix of eigenvalues sorted in decreasing order)
2. Set k = n
3. Define EPCAk as the subspace generated by the k first column vectors of Q.
4. Define as the orthogonal projection of E0 on EPCAk ()
5. Define as the C−1-orthogonal subspace of (Regression)
6. If the minimum angle between and is less than a threshold, set k = k − 1 and go to (3)
7. Define Fk as the oblique projector of nullspace and image (Eq. (2)).
Application
References






"



   Draft:Adaptive filtering by optimal projection      Draft:Adaptive filtering by optimal projection     Adaptive filtering by optimal projection (AFOP) is a mathematical procedure for filtering a multivariate signal. It is a linear, spatial, instantaneous and adaptive filter. The method consists on constructing a filtering matrix which will reduce artifact components and preserve at most main signal components. The construction of the matrix requires two steps:   The first one to determine the distribution of artifacts using the common spatial pattern (CSP).    The second one to determine the distribution of main signals using a linear regression .   Details  Suppose two windows of a multivariate signals   𝐗   𝐗   \mathbf{X}   of dimension    (  n  ,  t  )     n  t    (n,t)   .   n   n   n   is the number of signals and   t   t   t   is the number samples.  The aim of AFOP is to construct a filtering matrix   𝐅   𝐅   \mathbf{F}   of dimension    (  n  ,  n  )     n  n    (n,n)   such that     𝐗  ^   =  𝐅𝐗       normal-^  𝐗   𝐅𝐗    \hat{\mathbf{X}}=\mathbf{FX}   preserves at most the main signals while reducing at most the artifacts.  This filtering matrix is an idempotent matrix that is to say    𝐅𝐅  =  𝐅      𝐅𝐅  𝐅    \mathbf{FF}=\mathbf{F}   . The eigen values of idempotent matrix are all 0 or 1. Thus, any idempotent matrix can be defined (from a unique way) by the two right-eigen spaces:       E  1     subscript  E  1    E_{1}   of dimension    n  1     subscript  n  1    n_{1}   which corresponds to the image    𝐅   𝐅   \mathbf{F}   .        E  0     subscript  E  0    E_{0}   of dimension     n  0   =   n  -   n  1         subscript  n  0     n   subscript  n  1      n_{0}=n-n_{1}   which corresponds to the nullspace of   𝐅   𝐅   \mathbf{F}   .   On the same way, any idempotent matrix can be defined (from a unique way) by the two left eigen spaces:       F  1   =   E  0  ⊥        subscript  F  1    superscript   subscript  E  0   bottom     F_{1}=E_{0}^{\bot}   of dimension    n  1     subscript  n  1    n_{1}          F  0   =   E  1  ⊥        subscript  F  0    superscript   subscript  E  1   bottom     F_{0}=E_{1}^{\bot}   of dimension     n  0   =   n  -   n  1         subscript  n  0     n   subscript  n  1      n_{0}=n-n_{1}       E  1     subscript  E  1    E_{1}   corresponds to the distribution (or mixing) of main signals whereas    E  0     subscript  E  0    E_{0}   corresponds to the distribution of artifacts signals.      F  1     subscript  F  1    F_{1}   corresponds to the separation main signals (a.k.a. how to obtain the components of main signals from the various channel) whereas    F  0     subscript  F  0    F_{0}   corresponds to the separation of artifacts signals.  AFOP use two steps to determine those subspaces:  Step 1. Determination of F 1  The determination of    F  1     subscript  F  1    F_{1}   is based on the assumption that artifact distribution subspace    E  0     subscript  E  0    E_{0}   on the window   𝐗   𝐗   \mathbf{X}   is the same that the one on other windows    𝐗  1     subscript  𝐗  1    \mathbf{X}_{1}   and    𝐗  2     subscript  𝐗  2    \mathbf{X}_{2}   of respective dimension    (  n  ,   t  1   )     n   subscript  t  1     (n,t_{1})   and    (  n  ,   t  2   )     n   subscript  t  2     (n,t_{2})   . In addition, it is assumed that the ratio of all artifacts between    𝐗  1     subscript  𝐗  1    \mathbf{X}_{1}   and    𝐗  2     subscript  𝐗  2    \mathbf{X}_{2}   is supperior to the ratio of main signals.  This first step consists then to use the Common spatial pattern method to extract the subspace of components which have the minimum variance ratio between those two windows.       F  1   =   arg    min   {  F  ∈   ℜ  n   with  dim   (  F  )   =   n  1   }     (       max   p  ∈  F        ∥    𝐩  𝐓    𝐗  2    ∥   2     ∥    𝐩  𝐓    𝐗  1    ∥   2         )          subscript  F  1       subscript    fragments  normal-{  F    superscript   n   with  dimension   fragments  normal-(  F  normal-)     subscript  n  1   normal-}        subscript     p  F       superscript   norm     superscript  𝐩  𝐓    subscript  𝐗  2     2    superscript   norm     superscript  𝐩  𝐓    subscript  𝐗  1     2           F_{1}={\arg\min}_{\{F\in\Re^{n}\text{ with }\dim(F)=n_{1}\}}\begin{pmatrix}%
 \max_{p\in F}\frac{\|\mathbf{p^{T}X}_{2}\|^{2}}{\|\mathbf{p^{T}X}_{1}\|^{2}}%
 \end{pmatrix}     The solution is given analytically by the diagonalisation of     𝐑  2   -  1     𝐑  1        superscript   subscript  𝐑  2     1     subscript  𝐑  1     \mathbf{R}_{2}^{-1}\mathbf{R}_{1}   with     𝐑  1   =     𝐗  1    𝐗  1  T     t  1         subscript  𝐑  1        subscript  𝐗  1    superscript   subscript  𝐗  1   T     subscript  t  1      \mathbf{R}_{1}=\frac{\mathbf{X}_{1}\mathbf{X}_{1}^{T}}{t_{1}}   and     𝐑  2   =     𝐗  2    𝐗  2  T     t  2         subscript  𝐑  2        subscript  𝐗  2    superscript   subscript  𝐗  2   T     subscript  t  2      \mathbf{R}_{2}=\frac{\mathbf{X}_{2}\mathbf{X}_{2}^{T}}{t_{2}}   , the two covariance matrices. We have then:        𝐑  2   -  1     𝐑  1    =   𝐏𝐃𝐏   -  1           superscript   subscript  𝐑  2     1     subscript  𝐑  1     superscript  𝐏𝐃𝐏    1      \mathbf{R}_{2}^{-1}\mathbf{R}_{1}=\mathbf{PDP}^{-1}     with    𝐏  =   [      𝐩  1     ⋯     𝐩  n      ]       𝐏     subscript  𝐩  1   normal-⋯   subscript  𝐩  n       \mathbf{P}=\begin{bmatrix}\mathbf{p}_{1}&\cdots&\mathbf{p}_{n}\end{bmatrix}   the matrix of eigenvector and   𝐃   𝐃   \mathbf{D}   the diagonal matrix of eigen values    {   λ  1   ,  ⋯  ,   λ  n   }      subscript  λ  1   normal-⋯   subscript  λ  n     \{\lambda_{1},\cdots,\lambda_{n}\}   sorted by increasing order.      F  1     subscript  F  1    F_{1}   is then the subspace generated by the    n  1     subscript  n  1    n_{1}   first eigen vectors in   𝐏   𝐏   \mathbf{P}   .  Step 2. Determination of E 1  Once the separation of main components is determined, the distribution of those components is computed by a linear regression on the window   𝐗   𝐗   \mathbf{X}   .    E  1     subscript  E  1    E_{1}   is then defined by:       E  1   =   E  0   ⊥   C   -  1      =    (   F  1  ⊥   )    ⊥   𝐑   -  1             subscript  E  1    superscript   subscript  E  0    subscript  bottom   superscript  C    1            superscript   superscript   subscript  F  1   bottom    subscript  bottom   superscript  𝐑    1         E_{1}=E_{0}^{\bot_{C^{-1}}}=(F_{1}^{\bot})^{\bot_{\mathbf{R}^{-1}}}     that is to say    E  1     subscript  E  1    E_{1}   is the subspace orthogonal to    E  0     subscript  E  0    E_{0}   for the scalar product    ⟨  𝐑  ⋅  ,  ⋅  ⟩     fragments  normal-⟨  R  normal-⋅  normal-,  normal-⋅  normal-⟩    \langle\mathbf{R}\cdot,\cdot\rangle   with    𝐑  =    𝐗𝐗  T   t       𝐑     superscript  𝐗𝐗  T   t     \mathbf{R}=\frac{\mathbf{X}\mathbf{X}^{T}}{t}   the covariance matrix of   𝐗   𝐗   \mathbf{X}   .  The frequency dual method  The DAFOP method consist in researching sources with a frequency pattern  Progressive orthogonalization  If the artifact distribution on the window   𝐗   𝐗   \mathbf{X}   is slightly different from the one on window    𝐗  2     subscript  𝐗  2    \mathbf{X}_{2}   , some instability may occur. A residue of artifact can appear of the main signal components and the linear regression tends to over amplify this component.  To reduce this problem, it is possible to project the    E  0     subscript  E  0    E_{0}   under the principal components of PCA . Here is the precise algorithm:  1. PCA: Compute the covariance matrix and its diagonalisation (with diagonal matrix of eigenvalues sorted in decreasing order)  2. Set k = n  3. Define EPCAk as the subspace generated by the k first column vectors of Q .  4. Define as the orthogonal projection of E0 on EPCAk ()  5. Define as the C−1-orthogonal subspace of (Regression)  6. If the minimum angle between and is less than a threshold, set k = k − 1 and go to (3)  7. Define F k as the oblique projector of nullspace and image (Eq. (2)).  Application  References        "   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="518">Udwadia–Kalaba equation</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Udwadia–Kalaba equation</h1>
<hr/>

<p>In <a href="theoretical_physics" title="wikilink">theoretical physics</a>, the <strong>Udwadia–Kalaba equation</strong> <a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> is a method for deriving the equations of motion of a constrained mechanical system. This equation was discovered by Firdaus E. Udwadia and Robert E. Kalaba in 1992. The fundamental equation is the simplest and most comprehensive equation so far discovered <a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> for writing down the equations of motion of a constrained mechanical system. Although it is mostly a restatement of <a href="Newton's_second_law_of_motion" title="wikilink">Newton's second law of motion</a>, it makes a convenient distinction between externally applied forces and the internal forces of constraint, similar to the use of constraints in <a href="Lagrangian_mechanics" title="wikilink">Lagrangian mechanics</a>, but without the use of <a href="Lagrange_multipliers" title="wikilink">Lagrange multipliers</a>. The Udwadia–Kalaba equation applies to a wide class of constraints, both <a href="holonomic_constraints" title="wikilink">holonomic constraints</a> and <a class="uri" href="nonholonomic" title="wikilink">nonholonomic</a> ones, as long as they are linear with respect to the accelerations. The equation even generalizes to constraint forces that do not obey <a href="D'Alembert's_principle" title="wikilink">D'Alembert's principle</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="the-central-problem-of-constrained-motion">The central problem of constrained motion</h2>

<p>In the study of the dynamics of mechanical systems, the configuration of a given system <em>S</em> is, in general, completely described by <em>n</em> <a href="generalized_coordinates" title="wikilink">generalized coordinates</a> so that its generalized coordinate <em>n</em>-vector is given by</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐪</mi>
    <mo>:=</mo>
    <msup>
     <mrow>
      <mo stretchy="false">[</mo>
      <msub>
       <mi>q</mi>
       <mn>1</mn>
      </msub>
      <mo>,</mo>
      <msub>
       <mi>q</mi>
       <mn>2</mn>
      </msub>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <msub>
       <mi>q</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi mathvariant="normal">T</mi>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <ci>𝐪</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <list>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>n</ci>
      </apply>
     </list>
     <ci>normal-T</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{q}:=[q_{1},q_{2},\ldots,q_{n}]^{\mathrm{T}}.
  </annotation>
 </semantics>
</math>

</p>

<p>where T denotes <a href="matrix_transpose" title="wikilink">matrix transpose</a>. Using Newtonian or <a href="Lagrangian_dynamics" title="wikilink">Lagrangian dynamics</a>, the unconstrained equations of motion of the system <em>S</em> under study can be derived as a matrix equation (see <a href="matrix_multiplication" title="wikilink">matrix multiplication</a>):</p>

<p>(t)=\mathbf{Q}(q,\dot{q},t)\,, |cellpadding = 6 |border = 1 |border colour = black |background colour=white}}</p>

<p>where the dots represent <a href="time_derivative" title="wikilink">derivatives with respect to time</a>:</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:1">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>q</mi>
      <mo>˙</mo>
     </mover>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mfrac>
      <mrow>
       <mi>d</mi>
       <msub>
        <mi>q</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-˙</ci>
      <ci>q</ci>
     </apply>
     <ci>i</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>q</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{q}_{i}=\frac{dq_{i}}{dt}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>It is assumed that the <a href="initial_conditions" title="wikilink">initial conditions</a> <strong>q</strong>(0) and 

<math display="inline" id="Udwadia–Kalaba_equation:2">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝐪</mi>
    <mo>˙</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-˙</ci>
     <ci>𝐪</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\mathbf{q}}(0)
  </annotation>
 </semantics>
</math>

 are known. We call the system <em>S</em> unconstrained because 

<math display="inline" id="Udwadia–Kalaba_equation:3">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝐪</mi>
    <mo>˙</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>0</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-˙</ci>
     <ci>𝐪</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{\mathbf{q}}(0)
  </annotation>
 </semantics>
</math>

 may be arbitrarily assigned.</p>

<p>The <em>n</em>-vector <strong>Q</strong> denotes the total <a href="generalized_force" title="wikilink">generalized force</a> acted on the system by some external influence; it can be expressed as the sum of all the <a href="conservative_force" title="wikilink">conservative forces</a> as well as <em>non</em>-conservative forces.</p>

<p>The <em>n</em>-by-<em>n</em> matrix <strong>M</strong> is <a href="symmetric_matrix" title="wikilink">symmetric</a>, and it can be <a href="positive_definite_matrix" title="wikilink">positive definite</a> 

<math display="inline" id="Udwadia–Kalaba_equation:4">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>𝐌</mi>
    <mo>></mo>
    <mn>0</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>𝐌</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{M}>0)
  </annotation>
 </semantics>
</math>

 or semi-positive definite 

<math display="inline" id="Udwadia–Kalaba_equation:5">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>𝐌</mi>
    <mo>≥</mo>
    <mn>0</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>𝐌</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{M}\geq 0)
  </annotation>
 </semantics>
</math>

. Typically, it is assumed that <strong>M</strong> is positive definite; however, it is not uncommon to derive the unconstrained equations of motion of the system <em>S</em> such that <strong>M</strong> is only semi-positive definite; i.e., the mass matrix may be singular (it has no <a href="inverse_matrix" title="wikilink">inverse matrix</a>).<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h3 id="constraints">Constraints</h3>

<p>We now assume that the unconstrained system <em>S</em> is subjected to a set of <em>m</em> consistent equality constraints given by</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐀</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>q</mi>
      <mo>,</mo>
      <mover accent="true">
       <mi>q</mi>
       <mo>˙</mo>
      </mover>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>𝐛</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>q</mi>
      <mo>,</mo>
      <mover accent="true">
       <mi>q</mi>
       <mo>˙</mo>
      </mover>
      <mo>,</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐀</ci>
     <vector>
      <ci>q</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>q</ci>
      </apply>
      <ci>t</ci>
     </vector>
     <apply>
      <ci>normal-¨</ci>
      <ci>𝐪</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>𝐛</ci>
     <vector>
      <ci>q</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>q</ci>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}(q,\dot{q},t)\ddot{\mathbf{q}}=\mathbf{b}(q,\dot{q},t),
  </annotation>
 </semantics>
</math>

 where <strong>A</strong> is a known <em>m</em>-by-<em>n</em> matrix of rank <em>r</em> and <strong>b</strong> is a known <em>m</em>-vector. We note that this set of constraint equations encompass a very general variety of <a href="Holonomic_constraints" title="wikilink">holonomic</a> and <a href="nonholonomic_system" title="wikilink">non-holonomic</a> equality constraints. For example, holonomic constraints of the form</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>φ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>q</mi>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>φ</ci>
     <interval closure="open">
      <ci>q</ci>
      <ci>t</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varphi(q,t)=0
  </annotation>
 </semantics>
</math>

 can be differentiated twice with respect to time while non-holonomic constraints of the form</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>ψ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>q</mi>
     <mo>,</mo>
     <mover accent="true">
      <mi>q</mi>
      <mo>˙</mo>
     </mover>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>ψ</ci>
     <vector>
      <ci>q</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>q</ci>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \psi(q,\dot{q},t)=0
  </annotation>
 </semantics>
</math>

 can be differentiated once with respect to time to obtain the <em>m</em>-by-<em>n</em> matrix <strong>A</strong> and the <em>m</em>-vector <strong>b</strong>. In short, constraints may be specified that are</p>
<ol>
<li>nonlinear functions of displacement and velocity,</li>
<li>explicitly dependent on time, and</li>
<li>functionally dependent.</li>
</ol>

<p>As a consequence of subjecting these constraints to the unconstrained system <em>S</em>, an additional force is conceptualized to arise, namely, the force of constraint. Therefore, the constrained system <em>S<sub>c</sub></em> becomes</p>

<p>=\mathbf{Q}+\mathbf{Q}_{c}(q,\dot{q},t), |cellpadding = 6 |border = 1 |border colour = black |background colour=white}}</p>

<p>where <strong>Q</strong><sub><em>c</em></sub>—the constraint force—is the additional force needed to satisfy the imposed constraints. The central problem of constrained motion is now stated as follows:</p>
<ol>
<li>given the unconstrained equations of motion of the system <em>S</em>,</li>
<li>given the generalized displacement <em>q</em>(<em>t</em>) and the generalized velocity 

<math display="inline" id="Udwadia–Kalaba_equation:9">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>q</mi>
    <mo>˙</mo>
   </mover>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <ci>normal-˙</ci>
     <ci>q</ci>
    </apply>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \dot{q}(t)
  </annotation>
 </semantics>
</math>

 of the constrained system <em>S<sub>c</sub></em> at time <em>t</em>, and</li>
<li>given the constraints in the form 

<math display="inline" id="Udwadia–Kalaba_equation:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐀</mi>
    <mover accent="true">
     <mi>q</mi>
     <mo>¨</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mi>𝐛</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐀</ci>
     <apply>
      <ci>normal-¨</ci>
      <ci>q</ci>
     </apply>
    </apply>
    <ci>𝐛</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}\ddot{q}=\mathbf{b}
  </annotation>
 </semantics>
</math>

 as stated above,</li>
</ol>

<p>find the equations of motion for the <em>constrained</em> system—the acceleration—at time <em>t</em>, which is in accordance with the agreed upon principles of analytical dynamics.</p>
<h2 id="equation-of-motion">Equation of motion</h2>

<p>The solution to this central problem is given by the Udwadia–Kalaba equation. When the matrix <strong>M</strong> is positive definite, the equation of motion of the constrained system <em>S<sub>c</sub></em>, at each instant of time, is<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:11">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝐌</mi>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>𝐐</mi>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>𝐌</mi>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </msup>
      <msup>
       <mrow>
        <mo>(</mo>
        <msup>
         <mi>𝐀𝐌</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msup>
        <mo>)</mo>
       </mrow>
       <mo>+</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐛</mi>
        <mo>-</mo>
        <mrow>
         <msup>
          <mi>𝐀𝐌</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mi>𝐐</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐌</ci>
     <apply>
      <ci>normal-¨</ci>
      <ci>𝐪</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <ci>𝐐</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐌</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐀𝐌</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <plus></plus>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐛</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀𝐌</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>𝐐</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}\ddot{\mathbf{q}}=\mathbf{Q}+\mathbf{M}^{1/2}\left(\mathbf{A}\mathbf%
{M}^{-1/2}\right)^{+}(\mathbf{b}-\mathbf{A}\mathbf{M}^{-1}\mathbf{Q}),
  </annotation>
 </semantics>
</math>

</p>

<p>where the '+' symbol denotes the <a href="Moore-Penrose_pseudoinverse" title="wikilink">pseudoinverse</a> of the matrix 

<math display="inline" id="Udwadia–Kalaba_equation:12">
 <semantics>
  <msup>
   <mi>𝐀𝐌</mi>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mn>2</mn>
    </mrow>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>𝐀𝐌</ci>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{A}\mathbf{M}^{-1/2}
  </annotation>
 </semantics>
</math>

. The force of constraint is thus given explicitly as</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:13">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐐</mi>
     <mi>c</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>𝐌</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>𝐀𝐌</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo>+</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐛</mi>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>𝐀𝐌</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mi>𝐐</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐐</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐌</ci>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐀𝐌</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <plus></plus>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐛</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐀𝐌</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>𝐐</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}_{c}=\mathbf{M}^{1/2}\left(\mathbf{A}\mathbf{M}^{-1/2}\right)^{+}(%
\mathbf{b}-\mathbf{A}\mathbf{M}^{-1}\mathbf{Q}),
  </annotation>
 </semantics>
</math>

</p>

<p>and since the matrix <strong>M</strong> is positive definite the generalized acceleration of the constrained system <em>S<sub>c</sub></em> is determined explicitly by</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:14">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝐪</mi>
     <mo>¨</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>𝐌</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mi>𝐐</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>𝐌</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <msup>
       <mrow>
        <mo>(</mo>
        <msup>
         <mi>𝐀𝐌</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msup>
        <mo>)</mo>
       </mrow>
       <mo>+</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐛</mi>
        <mo>-</mo>
        <mrow>
         <msup>
          <mi>𝐀𝐌</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msup>
         <mi>𝐐</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¨</ci>
     <ci>𝐪</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐌</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>𝐐</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐌</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐀𝐌</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <plus></plus>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐛</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀𝐌</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>𝐐</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ddot{\mathbf{q}}=\mathbf{M}^{-1}\mathbf{Q}+\mathbf{M}^{-1/2}\left(\mathbf{A}%
\mathbf{M}^{-1/2}\right)^{+}(\mathbf{b}-\mathbf{A}\mathbf{M}^{-1}\mathbf{Q}).
  </annotation>
 </semantics>
</math>

</p>

<p>In the case that the matrix <strong>M</strong> is semi-positive definite 

<math display="inline" id="Udwadia–Kalaba_equation:15">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>𝐌</mi>
    <mo>≥</mo>
    <mn>0</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>𝐌</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\mathbf{M}\geq 0)
  </annotation>
 </semantics>
</math>

, the above equation cannot be used directly because <strong>M</strong> may be singular. Furthermore, the generalized accelerations may not be unique unless the (<em>n</em> + <em>m</em>)-by-<em>n</em> matrix</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:16">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>𝐌</mi>
    <mo stretchy="false">^</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>𝐌</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>𝐀</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-^</ci>
     <ci>𝐌</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <ci>𝐌</ci>
      </matrixrow>
      <matrixrow>
       <ci>𝐀</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mathbf{M}}=\left[\begin{array}[]{c}\mathbf{M}\\
\mathbf{A}\end{array}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>has full rank (rank = <em>n</em>).<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> But since the observed accelerations of mechanical systems in nature are always unique, this rank condition is a necessary and sufficient condition for obtaining the uniquely defined generalized accelerations of the constrained system <em>S<sub>c</sub></em> at each instant of time. Thus, when 

<math display="inline" id="Udwadia–Kalaba_equation:17">
 <semantics>
  <mover accent="true">
   <mi>𝐌</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝐌</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mathbf{M}}
  </annotation>
 </semantics>
</math>

 has full rank, the equations of motion of the constrained system <em>S<sub>c</sub></em> at each instant of time are uniquely determined by (1) creating the auxiliary unconstrained system<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>𝐌</mi>
      <mi>𝐀</mi>
     </msub>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
    <mo>:=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐌</mi>
       <mo>+</mo>
       <mrow>
        <msup>
         <mi>𝐀</mi>
         <mo>+</mo>
        </msup>
        <mi>𝐀</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>𝐐</mi>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>𝐀</mi>
       <mo>+</mo>
      </msup>
      <mi>𝐛</mi>
     </mrow>
    </mrow>
    <mo>:=</mo>
    <msub>
     <mi>𝐐</mi>
     <mi>𝐛</mi>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐌</ci>
       <ci>𝐀</ci>
      </apply>
      <apply>
       <ci>normal-¨</ci>
       <ci>𝐪</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <ci>𝐌</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀</ci>
         <plus></plus>
        </apply>
        <ci>𝐀</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-¨</ci>
       <ci>𝐪</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <ci>𝐐</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐀</ci>
        <plus></plus>
       </apply>
       <ci>𝐛</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐐</ci>
      <ci>𝐛</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{\mathbf{A}}\ddot{\mathbf{q}}:=(\mathbf{M}+\mathbf{A}^{+}\mathbf{A}%
)\ddot{\mathbf{q}}=\mathbf{Q}+\mathbf{A}^{+}\mathbf{b}:=\mathbf{Q}_{\mathbf{b}},
  </annotation>
 </semantics>
</math>

</p>

<p>and by (2) applying the fundamental equation of constrained motion to this auxiliary unconstrained system so that the auxiliary constrained equations of motion are explicitly given by<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:19">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>𝐌</mi>
      <mi>𝐀</mi>
     </msub>
     <mover accent="true">
      <mi>𝐪</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>𝐐</mi>
      <mi>𝐛</mi>
     </msub>
     <mo>+</mo>
     <mrow>
      <msubsup>
       <mi>𝐌</mi>
       <mi>𝐀</mi>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mn>2</mn>
       </mrow>
      </msubsup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi>𝐀𝐌</mi>
         <mi>𝐀</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>+</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐛</mi>
        <mo>-</mo>
        <mrow>
         <msubsup>
          <mi>𝐀𝐌</mi>
          <mi>𝐀</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msubsup>
         <msub>
          <mi>𝐐</mi>
          <mi>𝐛</mi>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐌</ci>
      <ci>𝐀</ci>
     </apply>
     <apply>
      <ci>normal-¨</ci>
      <ci>𝐪</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐐</ci>
      <ci>𝐛</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <ci>𝐀</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐀𝐌</ci>
         <ci>𝐀</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <plus></plus>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐛</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐀𝐌</ci>
          <ci>𝐀</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐐</ci>
         <ci>𝐛</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{\mathbf{A}}\ddot{\mathbf{q}}=\mathbf{Q}_{\mathbf{b}}+\mathbf{M}_{%
\mathbf{A}}^{1/2}(\mathbf{A}\mathbf{M}_{\mathbf{A}}^{-1/2})^{+}(\mathbf{b}-%
\mathbf{A}\mathbf{M}_{\mathbf{A}}^{-1}\mathbf{Q}_{\mathbf{b}}).
  </annotation>
 </semantics>
</math>

</p>

<p>Moreover, when the matrix 

<math display="inline" id="Udwadia–Kalaba_equation:20">
 <semantics>
  <mover accent="true">
   <mi>𝐌</mi>
   <mo stretchy="false">^</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-^</ci>
    <ci>𝐌</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \hat{\mathbf{M}}
  </annotation>
 </semantics>
</math>

 has full rank, the matrix 

<math display="inline" id="Udwadia–Kalaba_equation:21">
 <semantics>
  <msub>
   <mi>𝐌</mi>
   <mi>𝐀</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝐌</ci>
    <ci>𝐀</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}_{\mathbf{A}}
  </annotation>
 </semantics>
</math>

 is always positive definite. This yields, explicitly, the generalized accelerations of the constrained system <em>S<sub>c</sub></em> as</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:22">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝐪</mi>
     <mo>¨</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msubsup>
       <mi>𝐌</mi>
       <mi>𝐀</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <msub>
       <mi>𝐐</mi>
       <mi>𝐛</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msubsup>
       <mi>𝐌</mi>
       <mi>𝐀</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
       </mrow>
      </msubsup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <msubsup>
         <mi>𝐀𝐌</mi>
         <mi>𝐀</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>+</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>𝐛</mi>
        <mo>-</mo>
        <mrow>
         <msubsup>
          <mi>𝐀𝐌</mi>
          <mi>𝐀</mi>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msubsup>
         <msub>
          <mi>𝐐</mi>
          <mi>𝐛</mi>
         </msub>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¨</ci>
     <ci>𝐪</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <ci>𝐀</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐐</ci>
       <ci>𝐛</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐌</ci>
        <ci>𝐀</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐀𝐌</ci>
         <ci>𝐀</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <plus></plus>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐛</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>𝐀𝐌</ci>
          <ci>𝐀</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐐</ci>
         <ci>𝐛</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \ddot{\mathbf{q}}=\mathbf{M}_{\mathbf{A}}^{-1}\mathbf{Q}_{\mathbf{b}}+\mathbf{%
M}_{\mathbf{A}}^{-1/2}(\mathbf{A}\mathbf{M}_{\mathbf{A}}^{-1/2})^{+}(\mathbf{b%
}-\mathbf{A}\mathbf{M}_{\mathbf{A}}^{-1}\mathbf{Q}_{\mathbf{b}}).
  </annotation>
 </semantics>
</math>

</p>

<p>This equation is valid when the matrix <strong>M</strong> is either positive definite <em>or</em> positive semi-definite! Additionally, the force of constraint that causes the constrained system <em>S<sub>c</sub></em>—a system that may have a singular mass matrix <strong>M</strong>—to satisfy the imposed constraints is explicitly given by</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:23">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐐</mi>
     <mi>c</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <msubsup>
      <mi>𝐌</mi>
      <mi>𝐀</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msubsup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <msubsup>
        <mi>𝐀𝐌</mi>
        <mi>𝐀</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
       </msubsup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>+</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐛</mi>
       <mo>-</mo>
       <mrow>
        <msubsup>
         <mi>𝐀𝐌</mi>
         <mi>𝐀</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
        <msub>
         <mi>𝐐</mi>
         <mi>𝐛</mi>
        </msub>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐐</ci>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐌</ci>
       <ci>𝐀</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐀𝐌</ci>
        <ci>𝐀</ci>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <plus></plus>
     </apply>
     <apply>
      <minus></minus>
      <ci>𝐛</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>𝐀𝐌</ci>
         <ci>𝐀</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐐</ci>
        <ci>𝐛</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{Q}_{c}=\mathbf{M}_{\mathbf{A}}^{1/2}(\mathbf{A}\mathbf{M}_{\mathbf{A}}%
^{-1/2})^{+}(\mathbf{b}-\mathbf{A}\mathbf{M}_{\mathbf{A}}^{-1}\mathbf{Q}_{%
\mathbf{b}}).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="non-ideal-constraints">Non-ideal constraints</h2>

<p>At any time during the motion we may consider perturbing the system by a <a href="virtual_displacement" title="wikilink">virtual displacement</a> δ<strong>r</strong> consistent with the constraints of the system. The displacement is allowed to be either reversible or irreversible. If the displacement is irreversible, then it performs <a href="virtual_work" title="wikilink">virtual work</a>. We may write the virtual work of the displacement as</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:24">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>W</mi>
     <mi>c</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>𝐂</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>q</mi>
     <mo>,</mo>
     <mover accent="true">
      <mi>q</mi>
      <mo>˙</mo>
     </mover>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>δ</mi>
    <mi>𝐫</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>W</ci>
      <ci>c</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐂</ci>
      <ci>normal-T</ci>
     </apply>
     <vector>
      <ci>q</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>q</ci>
      </apply>
      <ci>t</ci>
     </vector>
     <ci>δ</ci>
     <ci>𝐫</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   W_{c}(t)=\mathbf{C}^{\mathrm{T}}(q,\dot{q},t)\delta\mathbf{r}(t)
  </annotation>
 </semantics>
</math>

</p>

<p>The vector 

<math display="inline" id="Udwadia–Kalaba_equation:25">
 <semantics>
  <mrow>
   <mi>𝐂</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>q</mi>
    <mo>,</mo>
    <mover accent="true">
     <mi>q</mi>
     <mo>˙</mo>
    </mover>
    <mo>,</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝐂</ci>
    <vector>
     <ci>q</ci>
     <apply>
      <ci>normal-˙</ci>
      <ci>q</ci>
     </apply>
     <ci>t</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}(q,\dot{q},t)
  </annotation>
 </semantics>
</math>

 describes the non-ideality of the virtual work and may be related, for example, to <a class="uri" href="friction" title="wikilink">friction</a> or <a href="Drag_(physics)" title="wikilink">drag</a> forces (such forces have velocity dependence). This is a generalized <a href="D'Alembert's_principle" title="wikilink">D'Alembert's principle</a>, where the usual form of the principle has vanishing virtual work with 

<math display="inline" id="Udwadia–Kalaba_equation:26">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐂</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>q</mi>
     <mo>,</mo>
     <mover accent="true">
      <mi>q</mi>
      <mo>˙</mo>
     </mover>
     <mo>,</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐂</ci>
     <vector>
      <ci>q</ci>
      <apply>
       <ci>normal-˙</ci>
       <ci>q</ci>
      </apply>
      <ci>t</ci>
     </vector>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}(q,\dot{q},t)=0
  </annotation>
 </semantics>
</math>

.</p>

<p>The Udwadia–Kalaba equation is modified by an additional non-ideal constraint term to</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:27">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝐌</mi>
    <mover accent="true">
     <mi>𝐪</mi>
     <mo>¨</mo>
    </mover>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>𝐐</mi>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>𝐌</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <msup>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>𝐀𝐌</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>1</mn>
          <mo>/</mo>
          <mn>2</mn>
         </mrow>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo>+</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>𝐛</mi>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>𝐀𝐌</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mi>𝐐</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>𝐌</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mi>𝐈</mi>
       <mo>-</mo>
       <mrow>
        <msup>
         <mrow>
          <mo>(</mo>
          <msup>
           <mi>𝐀𝐌</mi>
           <mrow>
            <mo>-</mo>
            <mrow>
             <mn>1</mn>
             <mo>/</mo>
             <mn>2</mn>
            </mrow>
           </mrow>
          </msup>
          <mo>)</mo>
         </mrow>
         <mo>+</mo>
        </msup>
        <msup>
         <mi>𝐀𝐌</mi>
         <mrow>
          <mo>-</mo>
          <mrow>
           <mn>1</mn>
           <mo>/</mo>
           <mn>2</mn>
          </mrow>
         </mrow>
        </msup>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
     <msup>
      <mi>𝐌</mi>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mi>𝐂</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝐌</ci>
     <apply>
      <ci>normal-¨</ci>
      <ci>𝐪</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <ci>𝐐</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐌</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐀𝐌</ci>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <plus></plus>
      </apply>
      <apply>
       <minus></minus>
       <ci>𝐛</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀𝐌</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>𝐐</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐌</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <ci>𝐈</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>𝐀𝐌</ci>
           <apply>
            <minus></minus>
            <apply>
             <divide></divide>
             <cn type="integer">1</cn>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <plus></plus>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝐀𝐌</ci>
          <apply>
           <minus></minus>
           <apply>
            <divide></divide>
            <cn type="integer">1</cn>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐌</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>𝐂</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{M}\ddot{\mathbf{q}}=\mathbf{Q}+\mathbf{M}^{1/2}\left(\mathbf{A}\mathbf%
{M}^{-1/2}\right)^{+}(\mathbf{b}-\mathbf{A}\mathbf{M}^{-1}\mathbf{Q})+\mathbf{%
M}^{1/2}\left[\mathbf{I}-\left(\mathbf{A}\mathbf{M}^{-1/2}\right)^{+}\mathbf{A%
}\mathbf{M}^{-1/2}\right]\mathbf{M}^{1/2}\mathbf{C}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="examples">Examples</h2>
<h3 id="inverse-kepler-problem">Inverse Kepler problem</h3>

<p>The method can solve the inverse <a href="Kepler_problem" title="wikilink">Kepler problem</a> of determining the force law that corresponds to the orbits that are <a href="conic_section" title="wikilink">conic sections</a>.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> We take there to be no external forces (not even gravity) and instead constrain the particle motion to follow orbits of the form</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:28">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>ϵ</mi>
     <mi>x</mi>
    </mrow>
    <mo>+</mo>
    <mi>l</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>ϵ</ci>
      <ci>x</ci>
     </apply>
     <ci>l</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=\epsilon x+l
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Udwadia–Kalaba_equation:29">
 <semantics>
  <mrow>
   <mi>r</mi>
   <mo>=</mo>
   <msqrt>
    <mrow>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>y</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </msqrt>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>r</ci>
    <apply>
     <root></root>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>y</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r=\sqrt{x^{2}+y^{2}}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Udwadia–Kalaba_equation:30">
 <semantics>
  <mi>ϵ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϵ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \epsilon
  </annotation>
 </semantics>
</math>

 is the eccentricity, and <em>l</em> is the semi-latus rectum. Differentiating twice with respect to time and rearranging slightly gives a constraint</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:31">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mrow>
        <mi>r</mi>
        <mi>ϵ</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mover accent="true">
      <mi>x</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>y</mi>
     <mover accent="true">
      <mi>y</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>x</mi>
         <mover accent="true">
          <mi>y</mi>
          <mo>˙</mo>
         </mover>
        </mrow>
        <mo>-</mo>
        <mrow>
         <mi>y</mi>
         <mover accent="true">
          <mi>x</mi>
          <mo>˙</mo>
         </mover>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <msup>
      <mi>r</mi>
      <mn>2</mn>
     </msup>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>r</ci>
        <ci>ϵ</ci>
       </apply>
      </apply>
      <apply>
       <ci>normal-¨</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>y</ci>
      <apply>
       <ci>normal-¨</ci>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>x</ci>
         <apply>
          <ci>normal-˙</ci>
          <ci>y</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>y</ci>
         <apply>
          <ci>normal-˙</ci>
          <ci>x</ci>
         </apply>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x-r\epsilon)\ddot{x}+y\ddot{y}=-\frac{(x\dot{y}-y\dot{x})^{2}}{r^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>We assume the body has a simple, constant mass. We also assume that <a href="angular_momentum" title="wikilink">angular momentum</a> about the focus is conserved as</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:32">
 <semantics>
  <mrow>
   <mrow>
    <mi>m</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>x</mi>
       <mover accent="true">
        <mi>y</mi>
        <mo>˙</mo>
       </mover>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>y</mi>
       <mover accent="true">
        <mi>x</mi>
        <mo>˙</mo>
       </mover>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>L</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>m</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>x</ci>
       <apply>
        <ci>normal-˙</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>y</ci>
       <apply>
        <ci>normal-˙</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>L</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m(x\dot{y}-y\dot{x})=L
  </annotation>
 </semantics>
</math>

</p>

<p>with time derivative</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:33">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>x</mi>
     <mover accent="true">
      <mi>y</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>y</mi>
     <mover accent="true">
      <mi>x</mi>
      <mo>¨</mo>
     </mover>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>x</ci>
      <apply>
       <ci>normal-¨</ci>
       <ci>y</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>y</ci>
      <apply>
       <ci>normal-¨</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x\ddot{y}-y\ddot{x}=0
  </annotation>
 </semantics>
</math>

</p>

<p>We can combine these two constraints into the matrix equation</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mrow>
          <mi>r</mi>
          <mi>ϵ</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mi>x</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>x</mi>
         <mo>¨</mo>
        </mover>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>y</mi>
         <mo>¨</mo>
        </mover>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mstyle displaystyle="false">
         <mfrac>
          <msup>
           <mi>L</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <msup>
            <mi>m</mi>
            <mn>2</mn>
           </msup>
           <msup>
            <mi>r</mi>
            <mn>2</mn>
           </msup>
          </mrow>
         </mfrac>
        </mstyle>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>r</ci>
         <ci>ϵ</ci>
        </apply>
       </apply>
       <ci>y</ci>
      </matrixrow>
      <matrixrow>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
       </apply>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <ci>normal-¨</ci>
        <ci>x</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <ci>normal-¨</ci>
        <ci>y</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>L</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>m</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}x-r\epsilon&y\\
y&-x\end{pmatrix}\begin{pmatrix}\ddot{x}\\
\ddot{y}\end{pmatrix}=\begin{pmatrix}-\frac{L^{2}}{m^{2}r^{2}}\\
0\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>The constraint matrix has inverse</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:35">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <mrow>
          <mi>r</mi>
          <mi>ϵ</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mi>x</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>l</mi>
      <mi>r</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>x</mi>
       </mtd>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>-</mo>
           <mrow>
            <mi>r</mi>
            <mi>ϵ</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <times></times>
         <ci>r</ci>
         <ci>ϵ</ci>
        </apply>
       </apply>
       <ci>y</ci>
      </matrixrow>
      <matrixrow>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <ci>x</ci>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>l</ci>
       <ci>r</ci>
      </apply>
     </apply>
     <matrix>
      <matrixrow>
       <ci>x</ci>
       <ci>y</ci>
      </matrixrow>
      <matrixrow>
       <ci>y</ci>
       <apply>
        <minus></minus>
        <apply>
         <minus></minus>
         <ci>x</ci>
         <apply>
          <times></times>
          <ci>r</ci>
          <ci>ϵ</ci>
         </apply>
        </apply>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}x-r\epsilon&y\\
y&-x\end{pmatrix}^{-1}=\frac{1}{lr}\begin{pmatrix}x&y\\
y&-(x-r\epsilon)\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>The force of constraint is therefore the expected, central <a href="inverse_square_law" title="wikilink">inverse square law</a></p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:36">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐅</mi>
    <mi>c</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>m</mi>
    <msup>
     <mi>𝐀</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>𝐛</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mi>m</mi>
     <mrow>
      <mi>l</mi>
      <mi>r</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>x</mi>
       </mtd>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>y</mi>
       </mtd>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>x</mi>
           <mo>-</mo>
           <mrow>
            <mi>r</mi>
            <mi>ϵ</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mstyle displaystyle="false">
          <mfrac>
           <msup>
            <mi>L</mi>
            <mn>2</mn>
           </msup>
           <mrow>
            <msup>
             <mi>m</mi>
             <mn>2</mn>
            </msup>
            <msup>
             <mi>r</mi>
             <mn>2</mn>
            </msup>
           </mrow>
          </mfrac>
         </mstyle>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mn>0</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <msup>
       <mi>L</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mi>m</mi>
       <mi>l</mi>
       <msup>
        <mi>r</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>cos</mi>
          <mi>θ</mi>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>sin</mi>
          <mi>θ</mi>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐅</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <times></times>
      <ci>m</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝐀</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>𝐛</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>m</ci>
       <apply>
        <times></times>
        <ci>l</ci>
        <ci>r</ci>
       </apply>
      </apply>
      <matrix>
       <matrixrow>
        <ci>x</ci>
        <ci>y</ci>
       </matrixrow>
       <matrixrow>
        <ci>y</ci>
        <apply>
         <minus></minus>
         <apply>
          <minus></minus>
          <ci>x</ci>
          <apply>
           <times></times>
           <ci>r</ci>
           <ci>ϵ</ci>
          </apply>
         </apply>
        </apply>
       </matrixrow>
      </matrix>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>L</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>m</ci>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>r</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <cn type="integer">0</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>L</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <ci>m</ci>
         <ci>l</ci>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>r</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <matrix>
        <matrixrow>
         <apply>
          <cos></cos>
          <ci>θ</ci>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <sin></sin>
          <ci>θ</ci>
         </apply>
        </matrixrow>
       </matrix>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{c}=m\mathbf{A}^{-1}\mathbf{b}=\frac{m}{lr}\begin{pmatrix}x&y\\
y&-(x-r\epsilon)\end{pmatrix}\begin{pmatrix}-\frac{L^{2}}{m^{2}r^{2}}\\
0\end{pmatrix}=-\frac{L^{2}}{mlr^{2}}\begin{pmatrix}\cos{\theta}\\
\sin{\theta}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="inclined-plane-with-friction">Inclined plane with friction</h3>

<p>Consider a small block of constant mass on an <a href="inclined_plane" title="wikilink">inclined plane</a> at an angle 

<math display="inline" id="Udwadia–Kalaba_equation:37">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 above horizontal. The constraint that the block lie on the plane can be written as</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:38">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <mrow>
     <mi>tan</mi>
     <mi>α</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>x</ci>
     <apply>
      <tan></tan>
      <ci>α</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=x\tan{\alpha}
  </annotation>
 </semantics>
</math>

</p>

<p>After taking two time derivatives, we can put this into a standard constraint matrix equation form</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:39">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>tan</mi>
          <mi>α</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>x</mi>
         <mo>¨</mo>
        </mover>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mover accent="true">
         <mi>y</mi>
         <mo>¨</mo>
        </mover>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <tan></tan>
         <ci>α</ci>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <matrix>
      <matrixrow>
       <apply>
        <ci>normal-¨</ci>
        <ci>x</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <ci>normal-¨</ci>
        <ci>y</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}-\tan{\alpha}&1\end{pmatrix}\begin{pmatrix}\ddot{x}\\
\ddot{y}\end{pmatrix}=0
  </annotation>
 </semantics>
</math>

</p>

<p>The constraint matrix has pseudoinverse</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:40">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mi>tan</mi>
          <mi>α</mi>
         </mrow>
        </mrow>
       </mtd>
       <mtd columnalign="center">
        <mn>1</mn>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>+</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>cos</mi>
     <mn>2</mn>
    </msup>
    <mrow>
     <mi>α</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mo>-</mo>
          <mrow>
           <mi>tan</mi>
           <mi>α</mi>
          </mrow>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mn>1</mn>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <matrix>
      <matrixrow>
       <apply>
        <minus></minus>
        <apply>
         <tan></tan>
         <ci>α</ci>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </matrixrow>
     </matrix>
     <plus></plus>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cos></cos>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <ci>α</ci>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <tan></tan>
          <ci>α</ci>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <cn type="integer">1</cn>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}-\tan{\alpha}&1\end{pmatrix}^{+}=\cos^{2}{\alpha}\begin{pmatrix%
}-\tan{\alpha}\\
1\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>We allow there to be sliding friction between the block and the inclined plane. We parameterize this force by a standard coefficient of friction multiplied by the normal force</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:41">
 <semantics>
  <mrow>
   <mi>𝐂</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>μ</mi>
     <mi>m</mi>
     <mi>g</mi>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mi>α</mi>
       <mrow>
        <mo>sgn</mo>
        <mrow>
         <mover accent="true">
          <mi>y</mi>
          <mo>˙</mo>
         </mover>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <mrow>
              <mi>cos</mi>
              <mi>α</mi>
             </mrow>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <mrow>
              <mi>sin</mi>
              <mi>α</mi>
             </mrow>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐂</ci>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>μ</ci>
      <ci>m</ci>
      <ci>g</ci>
      <apply>
       <cos></cos>
       <apply>
        <times></times>
        <ci>α</ci>
        <apply>
         <ci>sgn</ci>
         <apply>
          <times></times>
          <apply>
           <ci>normal-˙</ci>
           <ci>y</ci>
          </apply>
          <matrix>
           <matrixrow>
            <apply>
             <cos></cos>
             <ci>α</ci>
            </apply>
           </matrixrow>
           <matrixrow>
            <apply>
             <sin></sin>
             <ci>α</ci>
            </apply>
           </matrixrow>
          </matrix>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{C}=-\mu mg\cos{\alpha}\operatorname{sgn}{\dot{y}}\begin{pmatrix}\cos{%
\alpha}\\
\sin{\alpha}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Whereas the force of gravity is reversible, the force of friction is not. Therefore the virtual work associated with a virtual displacement will depend on <strong>C</strong>. We may summarize the three forces (external, ideal constraint, and non-ideal constraint) as follows:</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:42">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐅</mi>
    <mrow>
     <mi>e</mi>
     <mi>x</mi>
     <mi>t</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mi>𝐐</mi>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>m</mi>
     <mi>g</mi>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mn>0</mn>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>y</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐅</ci>
      <apply>
       <times></times>
       <ci>e</ci>
       <ci>x</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>𝐐</ci>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>m</ci>
       <ci>g</ci>
       <matrix>
        <matrixrow>
         <cn type="integer">0</cn>
        </matrixrow>
        <matrixrow>
         <ci>y</ci>
        </matrixrow>
       </matrix>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{ext}=\mathbf{Q}=-mg\begin{pmatrix}0\\
y\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:43">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐅</mi>
    <mrow>
     <mi>c</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msup>
      <mi>𝐀</mi>
      <mo>+</mo>
     </msup>
     <mi>𝐀𝐐</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>m</mi>
    <mi>g</mi>
    <mrow>
     <msup>
      <mi>cos</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mi>α</mi>
      <mrow>
       <mo>(</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>tan</mi>
            <mi>α</mi>
           </mrow>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mrow>
           <mo>-</mo>
           <mrow>
            <mi>tan</mi>
            <mi>α</mi>
           </mrow>
          </mrow>
         </mtd>
         <mtd columnalign="center">
          <mn>1</mn>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mn>0</mn>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi>y</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>m</mi>
    <mi>g</mi>
    <mrow>
     <mo>(</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <mo>-</mo>
         <mrow>
          <mrow>
           <mi>sin</mi>
           <mi>α</mi>
          </mrow>
          <mrow>
           <mi>cos</mi>
           <mi>α</mi>
          </mrow>
         </mrow>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mrow>
         <msup>
          <mi>cos</mi>
          <mn>2</mn>
         </msup>
         <mi>α</mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐅</ci>
      <list>
       <ci>c</ci>
       <ci>i</ci>
      </list>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐀</ci>
        <plus></plus>
       </apply>
       <ci>𝐀𝐐</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>g</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <cos></cos>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <times></times>
        <ci>α</ci>
        <matrix>
         <matrixrow>
          <apply>
           <minus></minus>
           <apply>
            <tan></tan>
            <ci>α</ci>
           </apply>
          </apply>
         </matrixrow>
         <matrixrow>
          <cn type="integer">1</cn>
         </matrixrow>
        </matrix>
        <matrix>
         <matrixrow>
          <apply>
           <minus></minus>
           <apply>
            <tan></tan>
            <ci>α</ci>
           </apply>
          </apply>
          <cn type="integer">1</cn>
         </matrixrow>
        </matrix>
        <matrix>
         <matrixrow>
          <cn type="integer">0</cn>
         </matrixrow>
         <matrixrow>
          <ci>y</ci>
         </matrixrow>
        </matrix>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>m</ci>
      <ci>g</ci>
      <matrix>
       <matrixrow>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <sin></sin>
           <ci>α</ci>
          </apply>
          <apply>
           <cos></cos>
           <ci>α</ci>
          </apply>
         </apply>
        </apply>
       </matrixrow>
       <matrixrow>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cos></cos>
          <cn type="integer">2</cn>
         </apply>
         <ci>α</ci>
        </apply>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{c,i}=-\mathbf{A}^{+}\mathbf{A}\mathbf{Q}=mg\cos^{2}{\alpha}\begin{%
pmatrix}-\tan{\alpha}\\
1\end{pmatrix}\begin{pmatrix}-\tan{\alpha}&1\end{pmatrix}\begin{pmatrix}0\\
y\end{pmatrix}=mg\begin{pmatrix}-\sin{\alpha}\cos{\alpha}\\
\cos^{2}{\alpha}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:44">
 <semantics>
  <mrow>
   <msub>
    <mi>𝐅</mi>
    <mrow>
     <mi>c</mi>
     <mo>,</mo>
     <mrow>
      <mi>n</mi>
      <mi>i</mi>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>𝐈</mi>
      <mo>-</mo>
      <mrow>
       <msup>
        <mi>𝐀</mi>
        <mo>+</mo>
       </msup>
       <mi>𝐀</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>𝐂</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>μ</mi>
     <mi>m</mi>
     <mi>g</mi>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mi>α</mi>
       <mrow>
        <mo>sgn</mo>
        <mover accent="true">
         <mi>y</mi>
         <mo>˙</mo>
        </mover>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mtable displaystyle="true">
         <mtr>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
         </mtr>
         <mtr>
          <mtd columnalign="center">
           <mn>0</mn>
          </mtd>
          <mtd columnalign="center">
           <mn>1</mn>
          </mtd>
         </mtr>
        </mtable>
        <mo>)</mo>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msup>
         <mi>cos</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mi>α</mi>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <mrow>
              <mo>-</mo>
              <mrow>
               <mi>tan</mi>
               <mi>α</mi>
              </mrow>
             </mrow>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <mn>1</mn>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <mrow>
              <mo>-</mo>
              <mrow>
               <mi>tan</mi>
               <mi>α</mi>
              </mrow>
             </mrow>
            </mtd>
            <mtd columnalign="center">
             <mn>1</mn>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>μ</mi>
     <mi>m</mi>
     <mi>g</mi>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mi>α</mi>
       <mrow>
        <mo>sgn</mo>
        <mrow>
         <mover accent="true">
          <mi>y</mi>
          <mo>˙</mo>
         </mover>
         <mrow>
          <mo>(</mo>
          <mtable displaystyle="true">
           <mtr>
            <mtd columnalign="center">
             <mrow>
              <msup>
               <mi>cos</mi>
               <mn>2</mn>
              </msup>
              <mi>α</mi>
             </mrow>
            </mtd>
           </mtr>
           <mtr>
            <mtd columnalign="center">
             <mrow>
              <mrow>
               <mi>sin</mi>
               <mi>α</mi>
              </mrow>
              <mrow>
               <mi>cos</mi>
               <mi>α</mi>
              </mrow>
             </mrow>
            </mtd>
           </mtr>
          </mtable>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝐅</ci>
      <list>
       <ci>c</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>𝐈</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>𝐀</ci>
         <plus></plus>
        </apply>
        <ci>𝐀</ci>
       </apply>
      </apply>
      <ci>𝐂</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>μ</ci>
       <ci>m</ci>
       <ci>g</ci>
       <apply>
        <cos></cos>
        <apply>
         <times></times>
         <ci>α</ci>
         <apply>
          <ci>sgn</ci>
          <apply>
           <ci>normal-˙</ci>
           <ci>y</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <matrix>
          <matrixrow>
           <cn type="integer">1</cn>
           <cn type="integer">0</cn>
          </matrixrow>
          <matrixrow>
           <cn type="integer">0</cn>
           <cn type="integer">1</cn>
          </matrixrow>
         </matrix>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <cos></cos>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <ci>α</ci>
           <matrix>
            <matrixrow>
             <apply>
              <minus></minus>
              <apply>
               <tan></tan>
               <ci>α</ci>
              </apply>
             </apply>
            </matrixrow>
            <matrixrow>
             <cn type="integer">1</cn>
            </matrixrow>
           </matrix>
           <matrix>
            <matrixrow>
             <apply>
              <minus></minus>
              <apply>
               <tan></tan>
               <ci>α</ci>
              </apply>
             </apply>
             <cn type="integer">1</cn>
            </matrixrow>
           </matrix>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>μ</ci>
       <ci>m</ci>
       <ci>g</ci>
       <apply>
        <cos></cos>
        <apply>
         <times></times>
         <ci>α</ci>
         <apply>
          <ci>sgn</ci>
          <apply>
           <times></times>
           <apply>
            <ci>normal-˙</ci>
            <ci>y</ci>
           </apply>
           <matrix>
            <matrixrow>
             <apply>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <cos></cos>
               <cn type="integer">2</cn>
              </apply>
              <ci>α</ci>
             </apply>
            </matrixrow>
            <matrixrow>
             <apply>
              <times></times>
              <apply>
               <sin></sin>
               <ci>α</ci>
              </apply>
              <apply>
               <cos></cos>
               <ci>α</ci>
              </apply>
             </apply>
            </matrixrow>
           </matrix>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{c,ni}=(\mathbf{I}-\mathbf{A}^{+}\mathbf{A})\mathbf{C}=-\mu mg\cos{%
\alpha}\operatorname{sgn}{\dot{y}}\left[\begin{pmatrix}1&0\\
0&1\end{pmatrix}-\cos^{2}{\alpha}\begin{pmatrix}-\tan{\alpha}\\
1\end{pmatrix}\begin{pmatrix}-\tan{\alpha}&1\end{pmatrix}\right]=-\mu mg\cos{%
\alpha}\operatorname{sgn}{\dot{y}}\begin{pmatrix}\cos^{2}{\alpha}\\
\sin{\alpha}\cos{\alpha}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>Combining the above, we find that the equations of motion are</p>

<p>

<math display="block" id="Udwadia–Kalaba_equation:45">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mover accent="true">
        <mi>x</mi>
        <mo>¨</mo>
       </mover>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mover accent="true">
        <mi>y</mi>
        <mo>¨</mo>
       </mover>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>𝐅</mi>
       <mrow>
        <mi>e</mi>
        <mi>x</mi>
        <mi>t</mi>
       </mrow>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>𝐅</mi>
       <mrow>
        <mi>c</mi>
        <mo>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
      <mo>+</mo>
      <msub>
       <mi>𝐅</mi>
       <mrow>
        <mi>c</mi>
        <mo>,</mo>
        <mrow>
         <mi>n</mi>
         <mi>i</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>sin</mi>
        <mi>α</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>μ</mi>
        <mrow>
         <mi>cos</mi>
         <mrow>
          <mi>α</mi>
          <mrow>
           <mo>sgn</mo>
           <mover accent="true">
            <mi>y</mi>
            <mo>˙</mo>
           </mover>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>cos</mi>
          <mi>α</mi>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mrow>
          <mi>sin</mi>
          <mi>α</mi>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <matrix>
      <matrixrow>
       <apply>
        <ci>normal-¨</ci>
        <ci>x</ci>
       </apply>
      </matrixrow>
      <matrixrow>
       <apply>
        <ci>normal-¨</ci>
        <ci>y</ci>
       </apply>
      </matrixrow>
     </matrix>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>m</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐅</ci>
        <apply>
         <times></times>
         <ci>e</ci>
         <ci>x</ci>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐅</ci>
        <list>
         <ci>c</ci>
         <ci>i</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>𝐅</ci>
        <list>
         <ci>c</ci>
         <apply>
          <times></times>
          <ci>n</ci>
          <ci>i</ci>
         </apply>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>g</ci>
       <apply>
        <plus></plus>
        <apply>
         <sin></sin>
         <ci>α</ci>
        </apply>
        <apply>
         <times></times>
         <ci>μ</ci>
         <apply>
          <cos></cos>
          <apply>
           <times></times>
           <ci>α</ci>
           <apply>
            <ci>sgn</ci>
            <apply>
             <ci>normal-˙</ci>
             <ci>y</ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
       <matrix>
        <matrixrow>
         <apply>
          <cos></cos>
          <ci>α</ci>
         </apply>
        </matrixrow>
        <matrixrow>
         <apply>
          <sin></sin>
          <ci>α</ci>
         </apply>
        </matrixrow>
       </matrix>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{pmatrix}\ddot{x}\\
\ddot{y}\end{pmatrix}=\frac{1}{m}\left(\mathbf{F}_{ext}+\mathbf{F}_{c,i}+%
\mathbf{F}_{c,ni}\right)=-g\left(\sin{\alpha}+\mu\cos{\alpha}\operatorname{sgn%
}{\dot{y}}\right)\begin{pmatrix}\cos{\alpha}\\
\sin{\alpha}\end{pmatrix}
  </annotation>
 </semantics>
</math>

</p>

<p>This is like a constant downward acceleration due to gravity with a slight modification. If the block is moving up the inclined plane, then the friction increases the downward acceleration. If the block is moving down the inclined plane, then the friction reduces the downward acceleration.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Mass_matrix" title="wikilink">Mass matrix</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Dynamics_(mechanics)" title="wikilink">Category:Dynamics (mechanics)</a> <a href="Category:classical_mechanics" title="wikilink">Category:classical mechanics</a> <a href="Category:Theoretical_physics" title="wikilink">Category:Theoretical physics</a> <a href="Category:Mathematical_physics" title="wikilink">Category:Mathematical physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Udwadia, F.E.; Kalaba, R.E. (1996). <em>Analytical Dynamics: A New Approach.</em> Cambridge University Press. ISBN 0-521-04833-8<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"></li>
<li id="fn11"></li>
<li id="fn12"></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
</ol>
</section>
</body>
</html>

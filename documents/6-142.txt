   Stiff equation      Stiff equation   In mathematics , a stiff equation is a differential equation for which certain numerical methods for solving the equation are numerically unstable , unless the step size is taken to be extremely small. It has proven difficult to formulate a precise definition of stiffness, but the main idea is that the equation includes some terms that can lead to rapid variation in the solution.  When integrating a differential equation numerically, one would expect the requisite step size to be relatively small in a region where the solution curve displays much variation and to be relatively large where the solution curve straightens out to approach a line with slope nearly zero. For some problems this is not the case. Sometimes the step size is forced down to an unacceptably small level in a region where the solution curve is very smooth. The phenomenon being exhibited here is known as stiffness . In some cases we may have two different problems with the same solution, yet problem one is not stiff and problem two is stiff. Clearly the phenomenon cannot be a property of the exact solution, since this is the same for both problems, and must be a property of the differential system itself. It is thus appropriate to speak of stiff systems .  Motivating example  (Figure)  Explicit numerical methods exhibiting instability when integrating a stiff ordinary differential equation   Consider the initial value problem      The exact solution (shown in cyan) is      We seek a numerical solution that exhibits the same behavior.  The figure (right) illustrates the numerical issues for various numerical integrators applied on the equation.  One of the most prominent examples of the stiff ODEs is a system that describes the chemical reaction of Robertson:      If one treats this system on a short interval, e.g.    t  ∈   [  0  ,  40  ]       t   0  40     t\in[0,40]   there is no problem in numerical integration. However, if the interval is very large (10 11 say), then many standard codes fail to integrate it correctly.  Additional examples are the sets of ODEs resulting from the temporal integration of large chemical reaction mechanisms. Here, the stiffness arises from the coexistence of very slow and very fast reactions. To solve them, the software packages KPP and Autochem can be used.  Stiffness ratio  Consider the linear constant coefficient inhomogeneous system      where     𝕪  ,  𝕗   ∈   ℝ  n        𝕪  𝕗    superscript  ℝ  n     \mathbb{y},\mathbb{f}\in\mathbb{R}^{n}   and   𝔸   𝔸   \mathbb{A}   is a constant    n  ×  n      n  n    n\times n   matrix with eigenvalues      λ  t   ∈  ℂ   ,   t  =   1  ,  2  ,  …  ,  n       formulae-sequence     subscript  λ  t   ℂ     t   1  2  normal-…  n      \lambda_{t}\in\mathbb{C},t=1,2,\ldots,n   (assumed distinct) and corresponding eigenvectors      𝕔  t   ∈   ℂ  n    ,   t  =   1  ,  2  ,  …  ,  n       formulae-sequence     subscript  𝕔  t    superscript  ℂ  n      t   1  2  normal-…  n      \mathbb{c}_{t}\in\mathbb{C}^{n},t=1,2,\ldots,n   . The general solution of () takes the form      where the κ t are arbitrary constants and    𝕘   (  x  )       𝕘  x    \mathbb{g}(x)   is a particular integral. Now let us suppose that      which implies that each of the terms         exp   (    λ  t   x   )     𝕔  t    →  0     normal-→         subscript  λ  t   x     subscript  𝕔  t    0    \exp(\lambda_{t}x)\mathbb{c}_{t}\rightarrow 0     as     x  →  ∞     normal-→  x     x\rightarrow\infty    , so that the solution     𝕪   (  x  )       𝕪  x    \mathbb{y}(x)     approaches     𝕘   (  x  )       𝕘  x    \mathbb{g}(x)    asymptotically as     x  →  ∞     normal-→  x     x\rightarrow\infty    ;  the term      exp   (    λ  t   x   )     𝕔  t            subscript  λ  t   x     subscript  𝕔  t     \exp(\lambda_{t}x)\mathbb{c}_{t}    will decay monotonically if λ t is real and sinusoidally if λ t is complex.  Interpreting x to be time (as it often is in physical problems) it is appropriate to call     Σ   t  =  1   n    κ  t    exp   (    λ  t   x   )     𝕔  t        superscript   subscript  normal-Σ    t  1    n    subscript  κ  t        subscript  λ  t   x     subscript  𝕔  t     \Sigma_{t=1}^{n}\kappa_{t}\exp(\lambda_{t}x)\mathbb{c}_{t}   the transient solution and    𝕘   (  x  )       𝕘  x    \mathbb{g}(x)   the steady-state solution . If    |   R  e   (   λ  t   )    |        R  e   subscript  λ  t      |Re(\lambda_{t})|   is large, then the corresponding term     κ  t    exp   (    λ  t   x   )     𝕔  t        subscript  κ  t        subscript  λ  t   x     subscript  𝕔  t     \kappa_{t}\exp(\lambda_{t}x)\mathbb{c}_{t}   will decay quickly as x increases and is thus called a fast transient ; if    |   R  e   (   λ  t   )    |        R  e   subscript  λ  t      |Re(\lambda_{t})|   is small, the corresponding term     κ  t    exp   (    λ  t   x   )     𝕔  t        subscript  κ  t        subscript  λ  t   x     subscript  𝕔  t     \kappa_{t}\exp(\lambda_{t}x)\mathbb{c}_{t}   decays slowly and is called a slow transient . Let     λ  ¯   ,   λ  ¯   ∈   {   λ  t   ,  t  =  1  ,  2  ,  …  ,  n  }      fragments   normal-¯  λ   normal-,   normal-¯  λ     fragments  normal-{   subscript  λ  t   normal-,  t   1  normal-,  2  normal-,  normal-…  normal-,  n  normal-}     \overline{\lambda},\underline{\lambda}\in\{\lambda_{t},t=1,2,\ldots,n\}   be defined by      so that     κ  t    exp   (    λ  ¯   x   )     𝕔  t        subscript  κ  t        normal-¯  λ   x     subscript  𝕔  t     \kappa_{t}\exp(\overline{\lambda}x)\mathbb{c}_{t}   is the fastest transient and     κ  t    exp   (    λ  ¯   x   )     𝕔  t        subscript  κ  t        normal-¯  λ   x     subscript  𝕔  t     \kappa_{t}\exp(\underline{\lambda}x)\mathbb{c}_{t}   the slowest. We now define the stiffness ratio as      Characterization of stiffness  In this section we consider various aspects of the phenomenon of stiffness. 'Phenomenon' is probably a more appropriate word than 'property', since the latter rather implies that stiffness can be defined in precise mathematical terms; it turns out not to be possible to do this in a satisfactory manner, even for the restricted class of linear constant coefficient systems. We shall also see several qualitative statements that can be (and mostly have been) made in an attempt to encapsulate the notion of stiffness, and state what is probably the most satisfactory of these as a 'definition' of stiffness.  J. D. Lambert defines stiffness as follows:   If a numerical method with a finite region of absolute stability , applied to a system with any initial conditions , is forced to use in a certain interval of integration a steplength which is excessively small in relation to the smoothness of the exact solution in that interval, then the system is said to be stiff in that interval.   There are other characteristics which are exhibited by many examples of stiff problems, but for each there are counterexamples, so these characteristics do not make good definitions of stiffness. Nonetheless, definitions based upon these characteristics are in common use by some authors and are good clues as to the presence of stiffness. Lambert refers to these as 'statements' rather than definitions, for the aforementioned reasons. A few of these are:   A linear constant coefficient system is stiff if all of its eigenvalues have negative real part and the stiffness ratio is large.  Stiffness occurs when stability requirements, rather than those of accuracy, constrain the steplength.  Stiffness occurs when some components of the solution decay much more rapidly than others. 1   Etymology  The origin of the term 'stiffness' seems to be somewhat of a mystery. According to Joseph Oakland Hirschfelder , the term 'stiff' is used because such systems correspond to tight coupling between the driver and driven in servomechanisms . 2 According to Richard. L. Burden and J. Douglas Faires,   Significant difficulties can occur when standard numerical techniques are applied to approximate the solution of a differential equation when the exact solution contains terms of the form e λt , where λ is a complex number with negative real part. ... Problems involving rapidly decaying transient solutions occur naturally in a wide variety of applications, including the study of spring and damping systems, the analysis of control systems , and problems in chemical kinetics . These are all examples of a class of problems called stiff (mathematical stiffness) systems of differential equations, due to their application in analyzing the motion of spring and mass systems having large spring constants (physical stiffness ). 3   For example, the initial value problem      with m = 1, c = 1001, k = 1000, can be written in the form () with n = 2 and          and has eigenvalues      λ  ¯   =   -  1000    ,    λ  ¯   =   -  1       formulae-sequence     normal-¯  λ     1000       normal-¯  λ     1      \overline{\lambda}=-1000,\underline{\lambda}=-1   . Both eigenvalues have negative real part and the stiffness ratio is      which is fairly large. System () then certainly satisfies statements 1 and 3. Here the spring constant k is large and the damping constant c is even larger. 4 (Note that 'large' is a vague, subjective term, but the larger the above quantities are, the more pronounced will be the effect of stiffness.) The exact solution to () is      Note that () behaves quite nearly as a simple exponential x 0 e − t , but the presence of the e −1000 t term, even with a small coefficient is enough to make the numerical computation very sensitive to step size. Stable integration of () requires a very small step size until well into the smooth part of the solution curve, resulting in an error much smaller than required for accuracy. Thus the system also satisfies statement 2 and Lambert's definition.  A-stability  The behaviour of numerical methods on stiff problems can be analyzed by applying these methods to the test equation    y  =   k  y       y    k  y     y=ky   subject to the initial condition     y   (  0  )    =  1        y  0   1    y(0)=1   with    k  ∈  ℂ      k  ℂ    k\in\mathbb{C}   . The solution of this equation is  }} . This solution approaches zero as    t  →  ∞     normal-→  t     t\to\infty   when      Re    (  k  )    <  0.        Re  k   0.    \mathrm{Re}\,(k)<0.   If the numerical method also exhibits this behaviour (for a fixed step size), then the method is said to be A-stable. 5 (Note that a numerical method that is L-stable (see below) has the stronger property that the solution approaches zero in a single step as the step size goes to infinity.) A-stable methods do not exhibit the instability problems as described in the motivating example.  Runge–Kutta methods  Runge–Kutta methods applied to the test equation     y  ′   =   k  ⋅  y        superscript  y  normal-′    normal-⋅  k  y     y^{\prime}=k\cdot y   take the form     y   n  +  1    =    ϕ   (   h  k   )    ⋅   y  n         subscript  y    n  1     normal-⋅    ϕ    h  k     subscript  y  n      y_{n+1}=\phi(hk)\cdot y_{n}   , and, by induction,     y  n   =     (   ϕ   (   h  k   )    )   n   ⋅   y  0         subscript  y  n    normal-⋅   superscript    ϕ    h  k    n    subscript  y  0      y_{n}=\left(\phi(hk)\right)^{n}\cdot y_{0}   . The function   ϕ   ϕ   \phi   is called the stability function . Thus, the condition that     y  n   →  0     normal-→   subscript  y  n   0    y_{n}\to 0   as    n  →  ∞     normal-→  n     n\to\infty   is equivalent to     |   ϕ   (   h  k   )    |   <  1          ϕ    h  k     1    |\phi(hk)|<1   . This motivates the definition of the region of absolute stability (sometimes referred to simply as stability region ), which is the set    {   z  ∈  ℂ   |    |   ϕ   (  z  )    |   <  1   }     conditional-set    z  ℂ         ϕ  z    1     \{z\in\mathbb{C}|\,|\phi(z)|<1\}   . The method is A-stable if the region of absolute stability contains the set    {   z  ∈   \C    |    Re   (  z  )    <  0   }     conditional-set    z  \C       Re  z   0     \{z\in\C|\mathrm{Re}(z)<0\}   , that is, the left half plane.  Example: The Euler methods  Consider the Euler methods above. The explicit Euler method applied to the test equation     y  ′   =   k  ⋅  y        superscript  y  normal-′    normal-⋅  k  y     y^{\prime}=k\cdot y   is        y   n  +  1    =    y  n   +    h  ⋅  f    (   t  n   ,   y  n   )     =    y  n   +   h  ⋅   (   k   y  n    )     =    y  n   +   h  ⋅  k  ⋅   y  n     =    (   1  +   h  ⋅  k    )    y  n     .         subscript  y    n  1       subscript  y  n      normal-⋅  h  f     subscript  t  n    subscript  y  n              subscript  y  n    normal-⋅  h    k   subscript  y  n              subscript  y  n    normal-⋅  h  k   subscript  y  n              1   normal-⋅  h  k     subscript  y  n       y_{n+1}=y_{n}+h\cdot f(t_{n},y_{n})=y_{n}+h\cdot(ky_{n})=y_{n}+h\cdot k\cdot y%
 _{n}=(1+h\cdot k)y_{n}.   Hence,     y  n   =     (   1  +   h  k    )   n   ⋅   y  0         subscript  y  n    normal-⋅   superscript    1    h  k    n    subscript  y  0      y_{n}=(1+hk)^{n}\cdot y_{0}   with     ϕ   (  z  )    =   1  +  z         ϕ  z     1  z     \phi(z)=1+z   . The region of absolute stability for this method is thus    {   z  ∈  ℂ   |    |   1  +  z   |   <  1   }     conditional-set    z  ℂ         1  z    1     \{z\in\mathbb{C}||1+z|<1\}   which is the disk depicted on the right. The Euler method is not A-stable.  The motivating example had    k  =   -  15       k    15     k=-15   . The value of z when taking step size    h  =   1  /  4       h    1  4     h=1/4   is    z  =   -    15  *  1   /  4    =   -  3.75         z        15  1   4           3.75      z=-15*1/4=-3.75   , which is outside the stability region. Indeed, the numerical results do not converge to zero. However, with step size    h  =   1  /  8       h    1  8     h=1/8   , we have    z  =   -  1.875       z    1.875     z=-1.875   which is just inside the stability region and the numerical results converge to zero, albeit rather slowly.  Example: Trapezoidal method  Consider the trapezoidal method        y   n  +  1    =    y  n   +      1  2    h   ⋅   (    f   (   t  n   ,   y  n   )    +   f   (   t   n  +  1    ,   y   n  +  1    )     )      ,       subscript  y    n  1       subscript  y  n    normal-⋅      1  2   h       f    subscript  t  n    subscript  y  n       f    subscript  t    n  1     subscript  y    n  1           y_{n+1}=y_{n}+\tfrac{1}{2}h\cdot\left(f(t_{n},y_{n})+f(t_{n+1},y_{n+1})\right),   when applied to the test equation     y  ′   =   k  ⋅  y        superscript  y  normal-′    normal-⋅  k  y     y^{\prime}=k\cdot y   , is        y   n  +  1    =    y  n   +      1  2    h   ⋅   (    k   y  n    +   k   y   n  +  1      )      .       subscript  y    n  1       subscript  y  n    normal-⋅      1  2   h       k   subscript  y  n      k   subscript  y    n  1          y_{n+1}=y_{n}+\tfrac{1}{2}h\cdot\left(ky_{n}+ky_{n+1}\right).   Solving for    y   n  +  1      subscript  y    n  1     y_{n+1}   yields        y   n  +  1    =     1  +    1  2   h  k     1  -    1  2   h  k     ⋅   y  n     .       subscript  y    n  1     normal-⋅      1      1  2   h  k      1      1  2   h  k      subscript  y  n      y_{n+1}=\frac{1+\frac{1}{2}hk}{1-\frac{1}{2}hk}\cdot y_{n}.   Thus, the stability function is       ϕ   (  z  )    =    1  +    1  2   z     1  -    1  2   z           ϕ  z       1      1  2   z      1      1  2   z       \phi(z)={1+{1\over 2}z\over 1-{1\over 2}z}   and the region of absolute stability is       {   z  ∈  ℂ   |    |    1  +    1  2   z     1  -    1  2   z     |   <  1   }   .     conditional-set    z  ℂ           1      1  2   z      1      1  2   z      1     \left\{z\in\mathbb{C}\left|\ \left|{1+{1\over 2}z\over 1-{1\over 2}z}\right|<1%
 \right.\right\}.   This region contains the left-half plane, so the trapezoidal method is A-stable. In fact, the stability region is identical to the left-half plane, and thus the numerical solution of     y  ′   =   k  ⋅  y        superscript  y  normal-′    normal-⋅  k  y     y^{\prime}=k\cdot y   converges to zero if and only if the exact solution does. Nevertheless, the trapezoidal method does not have perfect behavior: it does damp all decaying components, but rapidly decaying components are damped only very mildly, because     ϕ   (  z  )    →  1     normal-→    ϕ  z   1    \phi(z)\to 1   as    z  →   -  ∞      normal-→  z        z\to-\infty   . This led to the concept of L-stability : a method is L-stable if it is A-stable and     |   ϕ   (  z  )    |   →  0     normal-→      ϕ  z    0    |\phi(z)|\to 0   as    z  →  ∞     normal-→  z     z\to\infty   . The trapezoidal method is A-stable but not L-stable. The implicit Euler method is an example of an L-stable method. 6  General theory  The stability function of a Runge–Kutta method with coefficients   A   A   A   and   b   b   b   is given by        ϕ   (  z  )    =    det   (    I  -   z  A    +   z  e   b  T     )     det   (   I  -   z  A    )      ,        ϕ  z           I    z  A      z  e   superscript  b  T          I    z  A        \phi(z)=\frac{\det(I-zA+zeb^{T})}{\det(I-zA)},   where   e   e   e   denotes the vector with ones. This is a rational function (one polynomial divided by another).  Explicit Runge–Kutta methods have a strictly lower triangular coefficient matrix   A   A   A   and thus, their stability function is a polynomial. It follows that explicit Runge–Kutta methods cannot be A-stable.  The stability function of implicit Runge–Kutta methods is often analyzed using order stars . The order star for a method with stability function   ϕ   ϕ   \phi   is defined to be the set    {   z  ∈   \C    |    |   ϕ   (  z  )    |   >   |   e  z   |    }     conditional-set    z  \C         ϕ  z       superscript  normal-e  z       \{z\in\C||\phi(z)|>|\mathrm{e}^{z}|\}   . A method is A-stable if and only if its stability function has no poles in the left-hand plane and its order star contains no purely imaginary numbers. 7  Multistep methods  Linear multistep methods have the form        y   n  +  1    =     ∑   i  =  0   s     a  i    y   n  -  i      +   h    ∑   j  =   -  1    s     b  j   f   (   t   n  -  j    ,   y   n  -  j    )        .       subscript  y    n  1        superscript   subscript     i  0    s      subscript  a  i    subscript  y    n  i        h    superscript   subscript     j    1     s      subscript  b  j   f    subscript  t    n  j     subscript  y    n  j           y_{n+1}=\sum_{i=0}^{s}a_{i}y_{n-i}+h\sum_{j=-1}^{s}b_{j}f(t_{n-j},y_{n-j}).   Applied to the test equation, they become        y   n  +  1    =     ∑   i  =  0   s     a  i    y   n  -  i      +   h  k    ∑   j  =   -  1    s     b  j    y   n  -  j         ,       subscript  y    n  1        superscript   subscript     i  0    s      subscript  a  i    subscript  y    n  i        h  k    superscript   subscript     j    1     s      subscript  b  j    subscript  y    n  j          y_{n+1}=\sum_{i=0}^{s}a_{i}y_{n-i}+hk\sum_{j=-1}^{s}b_{j}y_{n-j},   which can be simplified to         (   1  -    b   -  1    z    )    y   n  +  1     -    ∑   j  =  0   s     (    a  j   +    b  j   z    )    y   n  -  j       =  0            1     subscript  b    1    z     subscript  y    n  1       superscript   subscript     j  0    s        subscript  a  j      subscript  b  j   z     subscript  y    n  j       0    (1-b_{-1}z)y_{n+1}-\sum_{j=0}^{s}(a_{j}+b_{j}z)y_{n-j}=0   where z = hk . This is a linear recurrence relation . The method is A-stable if all solutions { y n } of the recurrence relation converge to zero when Re z \Phi(z, w) = w^{s+1}-\sum_{i=0}^s a_iw^{s-i} - z\sum_{j=-1}^s b_jw^{s-j}. All solutions converge to zero for a given value of z if all solutions w of Φ( z , w ) = 0 lie in the unit circle.  The region of absolute stability for a multistep method of the above form is then the set of all    z  ∈  ℂ      z  ℂ    z\in\mathbb{C}   for which all w such that Φ( z , w ) = 0 satisfy | w | y_{n+1} = y_n + h \left( \tfrac32 f(t_n, y_n) - \tfrac12 f(t_{n-1}, y_{n-1}) \right) . The characteristic polynomial is       Φ   (  w  ,  z  )    =     w  2   -    (   1  +     3  2    z    )   w    +     1  2    z    =  0          normal-Φ   w  z         superscript  w  2       1      3  2   z    w        1  2   z         0     \Phi(w,z)=w^{2}-(1+\tfrac{3}{2}z)w+\tfrac{1}{2}z=0   which has roots       w  =     1  2     (    1  +     3  2    z    ±    1  +  z  +     9  4     z  2       )     ,      w      1  2    plus-or-minus    1      3  2   z        1  z      9  4    superscript  z  2          w=\tfrac{1}{2}\Big(1+\tfrac{3}{2}z\pm\sqrt{1+z+\tfrac{9}{4}z^{2}}\Big),   thus the region of absolute stability is       {   z  ∈  ℂ   |    |     1  2     (    1  +     3  2    z    ±    1  +  z  +     9  4     z  2       )    |   <  1   }   .     conditional-set    z  ℂ           1  2    plus-or-minus    1      3  2   z        1  z      9  4    superscript  z  2         1     \left\{z\in\mathbb{C}\left|\ \left|\tfrac{1}{2}\Big(1+\tfrac{3}{2}z\pm\sqrt{1+%
 z+\tfrac{9}{4}z^{2}}\Big)\right|<1\right.\right\}.   This region is shown on the right. It does not include all the left half-plane (in fact it only includes the real axis between z = −1 and z = 0) so the Adams–Bashforth method is not A-stable.  General theory  Explicit multistep methods can never be A-stable, just like explicit Runge–Kutta methods. Implicit multistep methods can only be A-stable if their order is at most 2. The latter result is known as the second Dahlquist barrier; it restricts the usefulness of linear multistep methods for stiff equations. An example of a second-order A-stable method is the trapezoidal rule mentioned above, which can also be considered as a linear multistep method. 8  See also   Condition number  Differential inclusion , an extension of the notion of differential equation that allows discontinuities, in part as way to sidestep some stiffness issues  Explicit and implicit methods   Notes    References    .   .   . 1   .   .   .   .   .   .   .   .   .   .    .   .  Stability of Runge-Kutta Methods   External links   An Introduction to Physically Based Modeling: Energy Functions and Stiffness   "  Category:Numerical differential equations     ↩  ↩  ↩  ↩  This definition is due to . ↩  The definition of L-stability is due to . ↩  The definition is due to ; see also . ↩  See . ↩     
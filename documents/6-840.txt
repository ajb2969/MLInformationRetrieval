   Duncan's new multiple range test      Duncan's new multiple range test   In statistics , Duncan's new multiple range test (MRT) is a multiple comparison procedure developed by David B. Duncan in 1955. Duncan's MRT belongs to the general class of multiple comparison procedures that use the studentized range statistic q r to compare sets of means.  David B. Duncan developed this test as a modification of the Student–Newman–Keuls method that would have greater power. Duncan's MRT is especially protective against false negative (Type II) error at the expense of having a greater risk of making false positive (Type I) errors . Duncan's test is commonly used in agronomy and other agricultural research.  The result of the test is a set of subsets of means, where in each subset means have been found not to be significantly different from one another.  Definition  Assumptions: 1.A sample of observed means     m  1   ,   m  2   ,  …  ,   m  n       subscript  m  1    subscript  m  2   normal-…   subscript  m  n     m_{1},m_{2},...,m_{n}   , which have been drawn independently from n normal populations with "true" means,     μ  1   ,   μ  2   ,  …  ,   μ  2       subscript  μ  1    subscript  μ  2   normal-…   subscript  μ  2     \mu_{1},\mu_{2},...,\mu_{2}   respectively. 2.A common standard error    σ   σ   \sigma   . This standard error is unknown, but there is available the usual estimate    s  m     subscript  s  m    s_{m}   , which is independent of the observed means and is based on a number of degrees of freedom , denoted by    n  2     subscript  n  2    n_{2}   . (More precisely,    S  m     subscript  S  m    S_{m}   , has the property that      n  2   ⋅   S  m  2     σ  m  2        normal-⋅   subscript  n  2    superscript   subscript  S  m   2     subscript   superscript  σ  2   m     \frac{n_{2}\cdot S_{m}^{2}}{\sigma^{2}_{m}}   is distributed as    χ  2     superscript  χ  2    \chi^{2}   with    n  2     subscript  n  2    n_{2}   degrees of freedom, independently of sample means).  The exact definition of the test is: The difference between any two means in a set of n means is significant provided the range of each and every subset which contains the given means is significant according to an    α  p     subscript  α  p    \alpha_{p}   level range test where     α  p   =   1  -   γ  p         subscript  α  p     1   subscript  γ  p      \alpha_{p}=1-\gamma_{p}   ,     γ  p   =    (   1  -  α   )    (   p  -  1   )         subscript  γ  p    superscript    1  α     p  1      \gamma_{p}=(1-\alpha)^{(p-1)}   and   p   p   p   is the number of means in the subset concerned. Exception: The sole exception to this rule is that no difference between two means can be declared significant if the two means concerned are both contained in a subset of the means which has a non-significant range.  The Procedure  The procedure consists of a series of pairwise comparisons between means. Each comparison is performed at a significance level    α  p     subscript  α  p    \alpha_{p}   , defined by the number of means separating the two means compared (    α  p     subscript  α  p    \alpha_{p}   for    p  -  2      p  2    p-2   separating means). The test are performed sequentially, where the result of a test determines which test is performed next.  The tests are performed in the following order: the largest minus the smallest, the largest minus the second smallest, up to the largest minus the second largest; then the second largest minus the smallest, the second largest minus the second smallest, and so on, finishing with the second smallest minus the smallest.  With only one exception, given below, each difference is significant if it exceeds the corresponding shortest significant range; otherwise it is not significant. Where the shortest significant range is the significant studentized range , multiplied by the standard error. The shortest significant range will be designated as    R   (  p  ,  α  )      subscript  R   p  α     R_{(p,\alpha)}   , where   p   p   p   is the number means in the subset. The sole exception to this rule is that no difference between two means can be declared significant if the two means concerned are both contained in a subset of the means which has a non-significant range.  An algorithm for performing the test is as follows:  1.Rank the sample means, largest to smallest.  2. For each     m  i     subscript  m  i    m_{i}    sample mean, largest to smallest, do the following:  2.1 for each sample mean, (denoted     m  j     subscript  m  j    m_{j}    ) , for smallest up to     m   (   i  -  1   )      subscript  m    i  1     m_{(i-1)}    .  2.1.1 compare      m  i   -   m  j        subscript  m  i    subscript  m  j     m_{i}-m_{j}    to critical value      σ  m   ⋅   R   (  p  ,  α  )       normal-⋅   subscript  σ  m    subscript  R   p  α      \sigma_{m}\cdot R_{(p,\alpha)}    ,      P  =   i  -  j    ,   α  =   α  p       formulae-sequence    P    i  j      α   subscript  α  p      P=i-j,\alpha=\alpha_{p}     2.1.2 if      m  i   -   m  j        subscript  m  i    subscript  m  j     m_{i}-m_{j}    does not exceed the critical value, the  subset     (   m  j   ,   m   j  +  1    ,  …  ,   m  I   )      subscript  m  j    subscript  m    j  1    normal-…   subscript  m  I     (m_{j},m_{j+1},...,m_{I})    is  declared  not  siginificantlly  different :  2.1.2.1 Go to next iteration of loop 2.  2.1.3 Otherwise, keep going with loop 2.1  Critical Values  Duncan's Multiple range test makes use of the studentized range distribution in order to determine critical values for comparisons between means. Note that different comparisons between means may differ by their significance levels- since the significance level is subject to the size of the subset of means in question.  Let us denote    Q   (  p  ,  ν  ,   γ   (  p  ,  α  )    )      subscript  Q   p  ν   subscript  γ   p  α       Q_{(p,\nu,\gamma_{(p,\alpha)})}   as the    γ  α     subscript  γ  α    \gamma_{\alpha}   quantile of the studentized range distribution , with p observations , and   ν   ν   \nu   degrees of freedom for the second sample (see studentized range for more information). Let us denote    r   (  p  ,  ν  ,  α  )      subscript  r   p  ν  α     r_{(p,\nu,\alpha)}   as the standardized critical value, given by the rule:  If p=2      r   (  p  ,  ν  ,  α  )    =   Q   (  p  ,  ν  ,   γ   (  p  ,  α  )    )         subscript  r   p  ν  α     subscript  Q   p  ν   subscript  γ   p  α        r_{(p,\nu,\alpha)}=Q_{(p,\nu,\gamma_{(p,\alpha)})}    Else      r   (  p  ,  ν  ,  α  )    =   m  a  x   (   Q   (  p  ,  ν  ,   γ   (  p  ,  α  )    )    ,   r   (   p  -  1   ,  ν  ,  α  )    )         subscript  r   p  ν  α      m  a  x    subscript  Q   p  ν   subscript  γ   p  α       subscript  r     p  1   ν  α        r_{(p,\nu,\alpha)}=max(Q_{(p,\nu,\gamma_{(p,\alpha)})},r_{(p-1,\nu,\alpha)})     The shortest critical range, (the actual critical value of the test) is computed as :     R  (   p  ,  ν  ,  α  )  =  σ    m   ⋅  r     (  p  ,  ν  ,  α  )       fragments   subscript  R  normal-(   p  normal-,  ν  normal-,  α  normal-)   σ   m   normal-⋅  r    p  ν  α      R_{(}p,\nu,\alpha)=\sigma_{m}\cdot r_{(p,\nu,\alpha)}   . For   ν   ν   \nu   ->∞, a tabulation exists for an exact value of Q (see link). A word of caution is needed here: notations for Q and R are not the same throughout literature, where Q is sometimes denoted as the shortest significant interval, and R as the significant quantile for studentized range distribution (Duncan's 1955 paper uses both notations in different parts).  Numeric Example  Let us look at the example of 5 treatment means: {| |- ! Treatments !! T1 !! T5 !! T2 !! T3 !! T4 |- | Treatment Means || 9.8 || 10.8 || 15.4 || 17.8 || 21.6 |- | Rank || 1 || 2 || 3 || 4 || 5 |} With a standard error of     s  m   =  1.796       subscript  s  m   1.796    s_{m}=1.796   , and    ν  =  20      ν  20    \nu=20   (degrees of freedom for estimating the standard error). Using a known tabulation for Q , one reaches the values of    r   (  p  ,  ν  ,  α  )      subscript  r   p  ν  α     r_{(p,\nu,\alpha)}   :      r   (  2  ,  20  ,  0.05  )    =  2.95       subscript  r   2  20  0.05    2.95    r_{(2,20,0.05)}=2.95         r   (  3  ,  20  ,  0.05  )    =  3.10       subscript  r   3  20  0.05    3.10    r_{(3,20,0.05)}=3.10         r   (  4  ,  20  ,  0.05  )    =  3.18       subscript  r   4  20  0.05    3.18    r_{(4,20,0.05)}=3.18         r   (  5  ,  20  ,  0.05  )    =  3.25       subscript  r   5  20  0.05    3.25    r_{(5,20,0.05)}=3.25    Now we may obtain the values of the shortest significant range , by the formula:      R   (  p  ,  ν  ,  α  )    =    σ  m   *   r   (  p  ,  ν  ,  α  )          subscript  R   p  ν  α       subscript  σ  m    subscript  r   p  ν  α       R_{(p,\nu,\alpha)}=\sigma_{m}*r_{(p,\nu,\alpha)}    Reaching:       R   (  2  ,  20  ,  0.05  )    =  3.75       subscript  R   2  20  0.05    3.75    R_{(2,20,0.05)}=3.75         R   (  3  ,  20  ,  0.05  )    =  3.94       subscript  R   3  20  0.05    3.94    R_{(3,20,0.05)}=3.94         R   (  4  ,  20  ,  0.05  )    =  4.04       subscript  R   4  20  0.05    4.04    R_{(4,20,0.05)}=4.04         R   (  5  ,  20  ,  0.05  )    =  4.13       subscript  R   5  20  0.05    4.13    R_{(5,20,0.05)}=4.13    Then, the observed differences between means are tested, beginning with the largest versus smallest, which would be compared with the least significant range     R   (  5  ,  20  ,  0.05  )    =  4.13.       subscript  R   5  20  0.05    4.13.    R_{(5,20,0.05)}=4.13.   Next, the difference of the largest and the second smallest is computed and compared with the least significant difference     R   (  4  ,  20  ,  0.05  )    =  4.04       subscript  R   4  20  0.05    4.04    R_{(4,20,0.05)}=4.04   .  If an observed difference is greater than the corresponding shortest significant range, then we concolude that the pair of means in question is significantly different. If an observed difference is smaller than the corresponding shortest significant range, all differences sharing the same upper mean are considered insignificant, in order to prevent contradictions (differences sharing the same upper mean are shorter by construction).  For our case, the comparison will yield:       4  v  s  .1   :    21.6  -  9.8   =  11.8  >   4.13   (   R  5   )        normal-:    4  v  s  .1         21.6  9.8   11.8         4.13   subscript  R  5        4vs.1:21.6-9.8=11.8>4.13(R_{5})         4  v  s  .5   :    21.6  -  10.8   =  10.8  >   4.04   (   R  4   )        normal-:    4  v  s  .5         21.6  10.8   10.8         4.04   subscript  R  4        4vs.5:21.6-10.8=10.8>4.04(R_{4})         4  v  s  .2   :    21.6  -  15.4   =  6.2  >   3.94   (   R  3   )        normal-:    4  v  s  .2         21.6  15.4   6.2         3.94   subscript  R  3        4vs.2:21.6-15.4=6.2>3.94(R_{3})         4  v  s  .3   :    21.6  -  17.6   =  4.0  >   3.75   (   R  2   )        normal-:    4  v  s  .3         21.6  17.6   4.0         3.75   subscript  R  2        4vs.3:21.6-17.6=4.0>3.75(R_{2})         3  v  s  .1   :    17.6  -  9.8   =  7.8  >   4.04   (   R  4   )        normal-:    3  v  s  .1         17.6  9.8   7.8         4.04   subscript  R  4        3vs.1:17.6-9.8=7.8>4.04(R_{4})         3  v  s  .5   :    17.6  -  10.8   =  6.8  >   3.94   (   R  3   )        normal-:    3  v  s  .5         17.6  10.8   6.8         3.94   subscript  R  3        3vs.5:17.6-10.8=6.8>3.94(R_{3})         3  v  s  .2   :    17.6  -  15.4   =  2.2  <   3.75   (   R  2   )        normal-:    3  v  s  .2         17.6  15.4   2.2         3.75   subscript  R  2        3vs.2:17.6-15.4=2.2<3.75(R_{2})         2  v  s  .1   :    15.4  -  9.8   =  5.6  >   3.94   (   R  3   )        normal-:    2  v  s  .1         15.4  9.8   5.6         3.94   subscript  R  3        2vs.1:15.4-9.8=5.6>3.94(R_{3})         2  v  s  .5   :    15.4  -  10.8   =  4.6  >   3.75   (   R  2   )        normal-:    2  v  s  .5         15.4  10.8   4.6         3.75   subscript  R  2        2vs.5:15.4-10.8=4.6>3.75(R_{2})         5  v  s  .1   :    10.8  -  9.8   =  1.0  <   3.75   (   R  2   )        normal-:    5  v  s  .1         10.8  9.8   1.0         3.75   subscript  R  2        5vs.1:10.8-9.8=1.0<3.75(R_{2})     We see that there are significant differences between all pairs of treatments except (T3,T2) and (T5,T1). A graph underlining those means that are not significantly different is shown below:  T1 T5  T2 T3 T4  Protection and Significance Levels based on Degrees of Freedom  The new multiple range test proposed by Duncan makes use of special protection levels based upon degrees of freedom . Let     γ   2  ,  α    =   1  -  α        subscript  γ   2  α      1  α     \gamma_{2,\alpha}={1-\alpha}   be the protection level for testing the significance of a difference between two means; that is, the probability that a significant difference between two means will not be found if the population means are equal. Duncan reasons that one has p-1 degrees of freedom for testing p ranked mean, and hence one may conduct p-1 independent tests, each with protection level     γ   2  ,  α    =   1  -  α        subscript  γ   2  α      1  α     \gamma_{2,\alpha}={1-\alpha}   . Hence, the joint protection level is:       γ   p  ,  α    =   γ   2  ,  α    p  -  1    =    (   1  -  α   )    p  -  1           subscript  γ   p  α     superscript   subscript  γ   2  α      p  1          superscript    1  α     p  1       \gamma_{p,\alpha}=\gamma_{2,\alpha}^{p-1}=(1-\alpha)^{p-1}   where     α  p   =   1  -   γ  p         subscript  α  p     1   subscript  γ  p      \alpha_{p}=1-\gamma_{p}     that is, the probability that one finds no significant differences in making p-1 independent tests, each at protection level     γ   2  ,  α    =   1  -  α        subscript  γ   2  α      1  α     \gamma_{2,\alpha}={1-\alpha}   , is    γ   2  ,  α    p  -  1      superscript   subscript  γ   2  α      p  1     \gamma_{2,\alpha}^{p-1}   , under the hypothesis that all p population means are equal. In general: the difference between any two means in a set of n means is significant provided the range of each and every subset ,which contains the given means, is significant according to an    α  p     subscript  α  p    \alpha_{p}   –level range test, where p is the number of means in the subset concerned.  For    α  =  0.05      α  0.05    \alpha=0.05   , the protection level can be tabulated for various value of r as follows:       Protection level     :   γ   p  ,  α       normal-:  absent   subscript  γ   p  α      :\gamma_{p,\alpha}      probability of falsely rejecting     H  0   :   α  p      normal-:   subscript  H  0    subscript  α  p     H_{0}:\alpha_{p}          p=2   0.95   0.05     p=3   0.903   0.097     p=4   0.857   0.143     p=5   0.815   0.185     p=6   0.774   0.226     p=7   0.735   0.265       Note that although this procedure makes use of the Studentized range , his error rate is neither on an experiment-wise basis (as with Tukey's) nor on a per- comparisons basis. Duncan's multiple range test does not control the familywise error rate . See Criticism Section for further details.  Duncan bayesian multiple comparison procedure  Duncan (1965) also gave the first Bayesian multiple comparison procedure, for the pairwise comparisons among the means in a one-way layout. This multiple comparison procedure is different for the one discussed above.  Duncan's Bayesian MCP discusses the differences between ordered group means, where the statistics in question are pairwise comparison (no equivalent is defined for the property of a subset having 'significantly different' property).  Duncan modeled the consequences of two or more means being equal using additive loss functions within and across the pairwise comparisons . If one assumes the same loss function across the pairwise comparisons, one needs to specify only one constant K, and this indicates the relative seriousness of type I to type II errors in each pairwise comparison.  A study, which performed by Juliet Popper Shaffer (1998), has shown that the method proposed by Duncan, modified to provide weak control of FWE and using an empirical estimate of the variance of the population means, has good properties both from the Bayesian point of view, as a minimum- risk method, and from the frequentist point of view, with good average power.  In addition, results indicate considerable similarity in both risk and average power between Duncan's modified procedure and the Benjamini and Hochberg (1995) False discovery rate -controlling procedure, with the same weak familywise error control.  Criticism  Duncan's test has been criticised as being too liberal by many statisticians including Henry Scheffé , and John W. Tukey . Duncan argued that a more liberal procedure was appropriate because in real world practice the global null hypothesis H 0 = "All means are equal" is often false and thus traditional statisticians overprotect a probably false null hypothesis against type I errors. According to Duncan, one should adjust the protection levels for different p-mean comparisons according to the problem discussed. The example discussed by Duncan in his 1955 paper is of a comparison of many means (i.e. 100),when one is interested only in two-mean and three-mean comparisons, and general p-mean comparisons (deciding whether there is some difference between p-means) are of no special interest (if p is 15 or more for example). Duncan's multiple range test is very “liberal” in terms of Type I errors. The following example will illustrate why:  Let us assume one is truly interested, as Duncan suggested, only with the correct ranking of subsets of size 4 or below. Let us also assume that one performs the simple pairwise comparison with a protection level     γ  2   =  0.95       subscript  γ  2   0.95    \gamma_{2}=0.95   . Given an overall set of 100 means, let us look at the null hypotheses of the test:  There are    (      100      2      )     binomial  100  2    100\choose 2   null hypotheses for the correct ranking of each 2 means. The significance level of each hypothesis is     1  -  0.95   =  0.05        1  0.95   0.05    1-0.95=0.05     There are    (      100      3      )     binomial  100  3    100\choose 3   null hypotheses for the correct ranking of each 3 means. The significance level of each hypothesis is     1  -    (  0.95  )   2    =  0.097        1   superscript  0.95  2    0.097    1-(0.95)^{2}=0.097     There are    (      100      4      )     binomial  100  4    100\choose 4   null hypotheses for the correct ranking of each 4 means. The significance level of each hypothesis is     1  -    (  0.95  )   3    =  0.143        1   superscript  0.95  3    0.143    1-(0.95)^{3}=0.143     As we can see, the test has two main problems , regarding the type I errors:   Duncan’s tests is based on the Newman–Keuls procedure , which does not protect the familywise error rate (though protecting the per-comparison alpha level)   Duncan’s test intentionally raises the alpha levels ( Type I error rate ) in each step of the Newman–Keuls procedure (significance levels of     α  p   ≥  α       subscript  α  p   α    \alpha_{p}\geq\alpha   ).   Therefore, it is advised not to use the procedure discussed.  Duncan later developed the Duncan–Waller test which is based on Bayesian principles. It uses the obtained value of F to estimate the prior probability of the null hypothesis being true.  Different approaches to the problem  If one still wishes to address the problem of finding similar subsets of group means, other solutions are found in literature.  Tukey's range test is commonly used to compare pairs of means, this procedure controls the familywise error rate in the strong sense.  Another solution is to perform Student's t-test of all pairs of means, and then to use FDR Controlling procedure (to control the expected proportion of incorrectly rejected null hypotheses ).  Other possible solutions, which do not include hypothesis testing, but result in a partition of subsets include Clustering & Hierarchical Clustering . These solutions differ from the approach presented in this method:   By being distance/density based, and not distribution based.  Needing a larger group of means, in order to produce significant results or working with the entire data set.   References         Tables for the Use of Range and Studentized Range in Tests of Hypotheses    H. Leon Harter, Champaigne, IL; N. Balakrishnan, McMaster University, Hamilton, Ontario, Canada; Hardback - Published Oct 27, 1997   External links   Critical values for Duncan's multiple range tests   "  Category:Statistical tests  Category:Multiple comparisons   
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="62">Wiener filter</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Wiener filter</h1>
<hr/>

<p>In <a href="signal_processing" title="wikilink">signal processing</a>, the <strong>Wiener filter</strong> is a <a href="filter_(signal_processing)" title="wikilink">filter</a> used to produce an estimate of a desired or target random process by linear time-invariant (<a href="Linear_filter" title="wikilink">LTI</a>) filtering of an observed noisy process, assuming known <a href="Stationary_process" title="wikilink">stationary</a> signal and noise spectra, and additive noise. The Wiener filter minimizes the mean square error between the estimated random process and the desired process.</p>
<h2 id="description">Description</h2>

<p>The goal of the Wiener filter is to compute a <a href="Estimation_theory" title="wikilink"> statistical estimate</a> of an unknown signal using a related signal as an input and filtering that known signal to produce the estimate as an output. For example, the known signal might consist of an unknown signal of interest that has been corrupted by additive <a class="uri" href="noise" title="wikilink">noise</a>. The Wiener filter can be used to filter out the noise from the corrupted signal to provide an estimate of the underlying signal of interest. The Wiener filter is based on a <a class="uri" href="statistical" title="wikilink">statistical</a> approach, and a more statistical account of the theory is given in the <a href="minimum_mean-square_error" title="wikilink">minimum mean-square error</a> (MMSE) article.</p>

<p>Typical deterministic filters are designed for a desired <a href="frequency_response" title="wikilink">frequency response</a>. However, the design of the Wiener filter takes a different approach. One is assumed to have knowledge of the spectral properties of the original signal and the noise, and one seeks the <a href="LTI_system_theory" title="wikilink">linear time-invariant</a> filter whose output would come as close to the original signal as possible. Wiener filters are characterized by the following:<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<ol>
<li>Assumption: signal and (additive) noise are stationary linear <a href="stochastic_process" title="wikilink">stochastic processes</a> with known spectral characteristics or known <a class="uri" href="autocorrelation" title="wikilink">autocorrelation</a> and <a class="uri" href="cross-correlation" title="wikilink">cross-correlation</a></li>
<li>Requirement: the filter must be physically realizable/<a href="Causal_system" title="wikilink">causal</a> (this requirement can be dropped, resulting in a non-causal solution)</li>
<li>Performance criterion: <a href="minimum_mean-square_error" title="wikilink">minimum mean-square error</a> (MMSE)</li>
</ol>

<p>This filter is frequently used in the process of <a class="uri" href="deconvolution" title="wikilink">deconvolution</a>; for this application, see <a href="Wiener_deconvolution" title="wikilink">Wiener deconvolution</a>.</p>
<h2 id="wiener-filter-solutions">Wiener filter solutions</h2>

<p>The Wiener filter problem has solutions for three possible cases: one where a noncausal filter is acceptable (requiring an infinite amount of both past and future data), the case where a <a href="causal_system" title="wikilink">causal</a> filter is desired (using an infinite amount of past data), and the <a href="finite_impulse_response" title="wikilink">finite impulse response</a> (FIR) case where a finite amount of past data is used. The first case is simple to solve but is not suited for real-time applications. Wiener's main accomplishment was solving the case where the causality requirement is in effect, and in an appendix of Wiener's book <a href="Norman_Levinson" title="wikilink">Levinson</a> gave the FIR solution.</p>
<h3 id="noncausal-solution">Noncausal solution</h3>

<p>

<math display="block" id="Wiener_filter:0">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>s</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <msub>
        <mi>S</mi>
        <mrow>
         <mi>x</mi>
         <mo>,</mo>
         <mi>s</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>s</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <msub>
        <mi>S</mi>
        <mi>x</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>s</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>α</mi>
       <mi>s</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <list>
         <ci>x</ci>
         <ci>s</ci>
        </list>
       </apply>
       <ci>s</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>x</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>α</ci>
       <ci>s</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(s)=\frac{S_{x,s}(s)}{S_{x}(s)}e^{\alpha s}.
  </annotation>
 </semantics>
</math>

</p>

<p>Where 

<math display="inline" id="Wiener_filter:1">
 <semantics>
  <mi>S</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>S</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S
  </annotation>
 </semantics>
</math>

 are spectra. Provided that 

<math display="inline" id="Wiener_filter:2">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(t)
  </annotation>
 </semantics>
</math>

 is optimal, then the <a href="minimum_mean-square_error" title="wikilink">minimum mean-square error</a> equation reduces to</p>

<p>

<math display="block" id="Wiener_filter:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>e</mi>
       <mn>2</mn>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>R</mi>
       <mi>s</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mrow>
        <mo>-</mo>
        <mi mathvariant="normal">∞</mi>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </msubsup>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>τ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msub>
        <mi>R</mi>
        <mrow>
         <mi>x</mi>
         <mo>,</mo>
         <mi>s</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>τ</mi>
         <mo>+</mo>
         <mi>α</mi>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>τ</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <ci>s</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <apply>
         <minus></minus>
         <infinity></infinity>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>τ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <list>
         <ci>x</ci>
         <ci>s</ci>
        </list>
       </apply>
       <apply>
        <plus></plus>
        <ci>τ</ci>
        <ci>α</ci>
       </apply>
       <ci>d</ci>
       <ci>τ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(e^{2})=R_{s}(0)-\int_{-\infty}^{\infty}{g(\tau)R_{x,s}(\tau+\alpha)\,d\tau},
  </annotation>
 </semantics>
</math>

</p>

<p>and the solution 

<math display="inline" id="Wiener_filter:4">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(t)
  </annotation>
 </semantics>
</math>

 is the inverse two-sided <a href="Laplace_transform" title="wikilink">Laplace transform</a> of 

<math display="inline" id="Wiener_filter:5">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(s)
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="causal-solution">Causal solution</h3>

<p>

<math display="block" id="Wiener_filter:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>s</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mi>H</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>s</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msubsup>
       <mi>S</mi>
       <mi>x</mi>
       <mo>+</mo>
      </msubsup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>s</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <ci>s</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>H</ci>
      <ci>s</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>x</ci>
       </apply>
       <plus></plus>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(s)=\frac{H(s)}{S_{x}^{+}(s)},
  </annotation>
 </semantics>
</math>

</p>

<p>where</p>
<ul>
<li>

<math display="inline" id="Wiener_filter:7">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(s)
  </annotation>
 </semantics>
</math>

 consists of the causal part of 

<math display="inline" id="Wiener_filter:8">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msub>
      <mi>S</mi>
      <mrow>
       <mi>x</mi>
       <mo>,</mo>
       <mi>s</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>s</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <msubsup>
      <mi>S</mi>
      <mi>x</mi>
      <mo>-</mo>
     </msubsup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>s</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <msup>
    <mi>e</mi>
    <mrow>
     <mi>α</mi>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <list>
        <ci>x</ci>
        <ci>s</ci>
       </list>
      </apply>
      <ci>s</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>x</ci>
       </apply>
       <minus></minus>
      </apply>
      <ci>s</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{S_{x,s}(s)}{S_{x}^{-}(s)}e^{\alpha s}
  </annotation>
 </semantics>
</math>

 (that is, that part of this fraction having a positive time solution under the inverse Laplace transform)</li>
<li>

<math display="inline" id="Wiener_filter:9">
 <semantics>
  <mrow>
   <msubsup>
    <mi>S</mi>
    <mi>x</mi>
    <mo>+</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>x</ci>
     </apply>
     <plus></plus>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}^{+}(s)
  </annotation>
 </semantics>
</math>

 is the causal component of 

<math display="inline" id="Wiener_filter:10">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>x</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>x</ci>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}(s)
  </annotation>
 </semantics>
</math>

 (i.e., the inverse Laplace transform of 

<math display="inline" id="Wiener_filter:11">
 <semantics>
  <mrow>
   <msubsup>
    <mi>S</mi>
    <mi>x</mi>
    <mo>+</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>x</ci>
     </apply>
     <plus></plus>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}^{+}(s)
  </annotation>
 </semantics>
</math>

 is non-zero only for 

<math display="inline" id="Wiener_filter:12">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>t</mi>
   </mpadded>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>t</ci>
    <cn type="float">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t\,\geq\,0
  </annotation>
 </semantics>
</math>

)</li>
<li>

<math display="inline" id="Wiener_filter:13">
 <semantics>
  <mrow>
   <msubsup>
    <mi>S</mi>
    <mi>x</mi>
    <mo>-</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>x</ci>
     </apply>
     <minus></minus>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}^{-}(s)
  </annotation>
 </semantics>
</math>

 is the anti-causal component of 

<math display="inline" id="Wiener_filter:14">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>x</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>x</ci>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}(s)
  </annotation>
 </semantics>
</math>

 (i.e., the inverse Laplace transform of 

<math display="inline" id="Wiener_filter:15">
 <semantics>
  <mrow>
   <msubsup>
    <mi>S</mi>
    <mi>x</mi>
    <mo>-</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>x</ci>
     </apply>
     <minus></minus>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}^{-}(s)
  </annotation>
 </semantics>
</math>

 is non-zero only for 

<math display="inline" id="Wiener_filter:16">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo><</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <ci>t</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t<0
  </annotation>
 </semantics>
</math>

)</li>
</ul>

<p>This general formula is complicated and deserves a more detailed explanation. To write down the solution 

<math display="inline" id="Wiener_filter:17">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(s)
  </annotation>
 </semantics>
</math>

 in a specific case, one should follow these steps:<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<ol>
<li>Start with the spectrum 

<math display="inline" id="Wiener_filter:18">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>x</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>x</ci>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}(s)
  </annotation>
 </semantics>
</math>

 in rational form and factor it into causal and anti-causal components:
<dl>
<dd>

<p>

<math display="inline" id="Wiener_filter:19">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>S</mi>
     <mi>x</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>S</mi>
     <mi>x</mi>
     <mo>+</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <msubsup>
     <mi>S</mi>
     <mi>x</mi>
     <mo>-</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>x</ci>
     </apply>
     <ci>s</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>x</ci>
      </apply>
      <plus></plus>
     </apply>
     <ci>s</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>S</ci>
       <ci>x</ci>
      </apply>
      <minus></minus>
     </apply>
     <ci>s</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}(s)=S_{x}^{+}(s)S_{x}^{-}(s)
  </annotation>
 </semantics>
</math>

</p>
</dd>
</dl>

<p>where 

<math display="inline" id="Wiener_filter:20">
 <semantics>
  <msup>
   <mi>S</mi>
   <mo>+</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>S</ci>
    <plus></plus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S^{+}
  </annotation>
 </semantics>
</math>

 contains all the zeros and poles in the left half plane (LHP) and 

<math display="inline" id="Wiener_filter:21">
 <semantics>
  <msup>
   <mi>S</mi>
   <mo>-</mo>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>S</ci>
    <minus></minus>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S^{-}
  </annotation>
 </semantics>
</math>

 contains the zeroes and poles in the right half plane (RHP). This is called the <a href="Wiener–Hopf_method" title="wikilink">Wiener–Hopf factorization</a>.</p></li>
<li>Divide 

<math display="inline" id="Wiener_filter:22">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mrow>
     <mi>x</mi>
     <mo>,</mo>
     <mi>s</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <msup>
    <mi>e</mi>
    <mrow>
     <mi>α</mi>
     <mi>s</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <list>
      <ci>x</ci>
      <ci>s</ci>
     </list>
    </apply>
    <ci>s</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <times></times>
      <ci>α</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x,s}(s)e^{\alpha s}
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="Wiener_filter:23">
 <semantics>
  <mrow>
   <msubsup>
    <mi>S</mi>
    <mi>x</mi>
    <mo>-</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>x</ci>
     </apply>
     <minus></minus>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}^{-}(s)
  </annotation>
 </semantics>
</math>

 and write out the result as a partial fraction expansion.</li>
<li>Select only those terms in this expansion having poles in the LHP. Call these terms 

<math display="inline" id="Wiener_filter:24">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(s)
  </annotation>
 </semantics>
</math>

.</li>
<li>Divide 

<math display="inline" id="Wiener_filter:25">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(s)
  </annotation>
 </semantics>
</math>

 by 

<math display="inline" id="Wiener_filter:26">
 <semantics>
  <mrow>
   <msubsup>
    <mi>S</mi>
    <mi>x</mi>
    <mo>+</mo>
   </msubsup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>x</ci>
     </apply>
     <plus></plus>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{x}^{+}(s)
  </annotation>
 </semantics>
</math>

. The result is the desired filter transfer function 

<math display="inline" id="Wiener_filter:27">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(s)
  </annotation>
 </semantics>
</math>

.</li>
</ol>
<h2 id="finite-impulse-response-wiener-filter-for-discrete-series">Finite impulse response Wiener filter for discrete series</h2>

<p> The causal <a href="finite_impulse_response" title="wikilink">finite impulse response</a> (FIR) Wiener filter, instead of using some given data matrix X and output vector Y, finds optimal tap weights by using the statistics of the input and output signals. It populates the input matrix X with estimates of the auto-correlation of the input signal (T) and populates the output vector Y with estimates of the cross-correlation between the output and input signals (V).</p>

<p>In order to derive the coefficients of the Wiener filter, consider the signal <em>w</em>[<em>n</em>] being fed to a Wiener filter of order <em>N</em> and with coefficients 

<math display="inline" id="Wiener_filter:28">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{a_{i}\}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Wiener_filter:29">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>i</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mn>0</mn>
    <mo rspace="4.2pt">,</mo>
    <mi mathvariant="normal">…</mi>
    <mo rspace="4.2pt">,</mo>
    <mi>N</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>i</ci>
    <list>
     <cn type="float">0</cn>
     <ci>normal-…</ci>
     <ci>N</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\,=\,0,\,\ldots,\,N
  </annotation>
 </semantics>
</math>

. The output of the filter is denoted <em>x</em>[<em>n</em>] which is given by the expression</p>

<p>

<math display="block" id="Wiener_filter:30">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>x</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>n</mi>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>a</mi>
       <mi>i</mi>
      </msub>
      <mi>w</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>i</mi>
       </mrow>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>x</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <ci>i</ci>
      </apply>
      <ci>w</ci>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x[n]=\sum_{i=0}^{N}a_{i}w[n-i].
  </annotation>
 </semantics>
</math>

</p>

<p>The residual error is denoted <em>e</em>[<em>n</em>] and is defined as <em>e</em>[<em>n</em>] = <em>x</em>[<em>n</em>] − <em>s</em>[<em>n</em>] (see the corresponding block diagram). The Wiener filter is designed so as to minimize the mean square error (<a href="Minimum_mean_square_error" title="wikilink">MMSE</a> criteria) which can be stated concisely as follows:</p>

<p>

<math display="block" id="Wiener_filter:31">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>a</mi>
     <mi>i</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>arg</mi>
      <mrow>
       <mpadded width="+3.3pt">
        <mi>min</mi>
       </mpadded>
       <mi>E</mi>
      </mrow>
     </mrow>
     <mrow>
      <mo stretchy="false">{</mo>
      <mrow>
       <msup>
        <mi>e</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>n</mi>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <arg></arg>
      <apply>
       <min></min>
       <ci>E</ci>
      </apply>
     </apply>
     <set>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>n</ci>
       </apply>
      </apply>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}=\arg\min~{}E\{e^{2}[n]\},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Wiener_filter:32">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">{</mo>
    <mo>⋅</mo>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <set>
     <ci>normal-⋅</ci>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E\{\cdot\}
  </annotation>
 </semantics>
</math>

 denotes the expectation operator. In the general case, the coefficients 

<math display="inline" id="Wiener_filter:33">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

 may be complex and may be derived for the case where <em>w</em>[<em>n</em>] and <em>s</em>[<em>n</em>] are complex as well. With a complex signal, the matrix to be solved is a <a href="Hermitian_matrix" title="wikilink">Hermitian</a> <a href="Toeplitz_matrix" title="wikilink">Toeplitz matrix</a>, rather than <a href="Symmetric_matrix" title="wikilink">symmetric</a> <a href="Toeplitz_matrix" title="wikilink">Toeplitz matrix</a>. For simplicity, the following considers only the case where all these quantities are real. The mean square error (MSE) may be rewritten as:</p>

<p>

<math display="block" id="Wiener_filter:34">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mi>E</mi>
      <mrow>
       <mo stretchy="false">{</mo>
       <mrow>
        <msup>
         <mi>e</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">}</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mi>E</mi>
      <mrow>
       <mo stretchy="false">{</mo>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mi>x</mi>
           <mrow>
            <mo stretchy="false">[</mo>
            <mi>n</mi>
            <mo stretchy="false">]</mo>
           </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mi>s</mi>
           <mrow>
            <mo stretchy="false">[</mo>
            <mi>n</mi>
            <mo stretchy="false">]</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">}</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mo stretchy="false">{</mo>
         <mrow>
          <msup>
           <mi>x</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>n</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">}</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>E</mi>
        <mrow>
         <mo stretchy="false">{</mo>
         <mrow>
          <msup>
           <mi>s</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>n</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">}</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <mi>E</mi>
       <mrow>
        <mo stretchy="false">{</mo>
        <mrow>
         <mi>x</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>n</mi>
          <mo stretchy="false">]</mo>
         </mrow>
         <mi>s</mi>
         <mrow>
          <mo stretchy="false">[</mo>
          <mi>n</mi>
          <mo stretchy="false">]</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">}</mo>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mi>E</mi>
         <mrow>
          <mo stretchy="false">{</mo>
          <msup>
           <mrow>
            <mo maxsize="120%" minsize="120%">(</mo>
            <mrow>
             <munderover>
              <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
              <mrow>
               <mi>i</mi>
               <mo>=</mo>
               <mn>0</mn>
              </mrow>
              <mi>N</mi>
             </munderover>
             <mrow>
              <msub>
               <mi>a</mi>
               <mi>i</mi>
              </msub>
              <mi>w</mi>
              <mrow>
               <mo stretchy="false">[</mo>
               <mrow>
                <mi>n</mi>
                <mo>-</mo>
                <mi>i</mi>
               </mrow>
               <mo stretchy="false">]</mo>
              </mrow>
             </mrow>
            </mrow>
            <mo maxsize="120%" minsize="120%">)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
          <mo stretchy="false">}</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>E</mi>
         <mrow>
          <mo stretchy="false">{</mo>
          <mrow>
           <msup>
            <mi>s</mi>
            <mn>2</mn>
           </msup>
           <mrow>
            <mo stretchy="false">[</mo>
            <mi>n</mi>
            <mo stretchy="false">]</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">}</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <mi>E</mi>
        <mrow>
         <mo stretchy="false">{</mo>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>0</mn>
           </mrow>
           <mi>N</mi>
          </munderover>
          <mrow>
           <msub>
            <mi>a</mi>
            <mi>i</mi>
           </msub>
           <mi>w</mi>
           <mrow>
            <mo stretchy="false">[</mo>
            <mrow>
             <mi>n</mi>
             <mo>-</mo>
             <mi>i</mi>
            </mrow>
            <mo stretchy="false">]</mo>
           </mrow>
           <mi>s</mi>
           <mrow>
            <mo stretchy="false">[</mo>
            <mi>n</mi>
            <mo stretchy="false">]</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo stretchy="false">}</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>.</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <ci>E</ci>
      <set>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>n</ci>
        </apply>
       </apply>
      </set>
     </apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>E</ci>
      <set>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>x</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>n</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>s</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </set>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>E</ci>
        <set>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>n</ci>
          </apply>
         </apply>
        </set>
       </apply>
       <apply>
        <times></times>
        <ci>E</ci>
        <set>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>s</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>n</ci>
          </apply>
         </apply>
        </set>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>E</ci>
       <set>
        <apply>
         <times></times>
         <ci>x</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>n</ci>
         </apply>
         <ci>s</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>n</ci>
         </apply>
        </apply>
       </set>
      </apply>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>E</ci>
        <set>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <apply>
              <eq></eq>
              <ci>i</ci>
              <cn type="integer">0</cn>
             </apply>
            </apply>
            <ci>N</ci>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <ci>a</ci>
             <ci>i</ci>
            </apply>
            <ci>w</ci>
            <apply>
             <csymbol cd="latexml">delimited-[]</csymbol>
             <apply>
              <minus></minus>
              <ci>n</ci>
              <ci>i</ci>
             </apply>
            </apply>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
        </set>
       </apply>
       <apply>
        <times></times>
        <ci>E</ci>
        <set>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>s</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>n</ci>
          </apply>
         </apply>
        </set>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>E</ci>
       <set>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <ci>N</ci>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>a</ci>
           <ci>i</ci>
          </apply>
          <ci>w</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <apply>
            <minus></minus>
            <ci>n</ci>
            <ci>i</ci>
           </apply>
          </apply>
          <ci>s</ci>
          <apply>
           <csymbol cd="latexml">delimited-[]</csymbol>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
       </set>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}E\{e^{2}[n]\}&=&E\{(x[n]-s[n])^{2}\}\\
&=&E\{x^{2}[n]\}+E\{s^{2}[n]\}-2E\{x[n]s[n]\}\\
&=&E\{\big(\sum_{i=0}^{N}a_{i}w[n-i]\big)^{2}\}+E\{s^{2}[n]\}-2E\{\sum_{i=0}^{%
N}a_{i}w[n-i]s[n]\}.\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>To find the vector 

<math display="inline" id="Wiener_filter:35">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <msub>
    <mi>a</mi>
    <mn>0</mn>
   </msub>
   <mo rspace="4.2pt">,</mo>
   <mi mathvariant="normal">…</mi>
   <mo rspace="4.2pt">,</mo>
   <msub>
    <mi>a</mi>
    <mi>N</mi>
   </msub>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>a</ci>
     <ci>N</ci>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [a_{0},\,\ldots,\,a_{N}]
  </annotation>
 </semantics>
</math>

 which minimizes the expression above, calculate its derivative with respect to 

<math display="inline" id="Wiener_filter:36">
 <semantics>
  <msub>
   <mi>a</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>a</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a_{i}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Wiener_filter:37">
 <semantics>
  <mtable displaystyle="true">
   <mtr>
    <mtd columnalign="right">
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
      <mi>E</mi>
      <mrow>
       <mo stretchy="false">{</mo>
       <mrow>
        <msup>
         <mi>e</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">}</mo>
      </mrow>
     </mrow>
    </mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>E</mi>
          <mrow>
           <mo stretchy="false">{</mo>
           <mrow>
            <mrow>
             <mo maxsize="120%" minsize="120%">(</mo>
             <mrow>
              <munderover>
               <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
               <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>0</mn>
               </mrow>
               <mi>N</mi>
              </munderover>
              <mrow>
               <msub>
                <mi>a</mi>
                <mi>j</mi>
               </msub>
               <mi>w</mi>
               <mrow>
                <mo stretchy="false">[</mo>
                <mrow>
                 <mi>n</mi>
                 <mo>-</mo>
                 <mi>j</mi>
                </mrow>
                <mo stretchy="false">]</mo>
               </mrow>
              </mrow>
             </mrow>
             <mo maxsize="120%" minsize="120%">)</mo>
            </mrow>
            <mi>w</mi>
            <mrow>
             <mo stretchy="false">[</mo>
             <mrow>
              <mi>n</mi>
              <mo>-</mo>
              <mi>i</mi>
             </mrow>
             <mo stretchy="false">]</mo>
            </mrow>
           </mrow>
           <mo stretchy="false">}</mo>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mrow>
          <mn>2</mn>
          <mi>E</mi>
          <mrow>
           <mo stretchy="false">{</mo>
           <mrow>
            <mi>s</mi>
            <mrow>
             <mo stretchy="false">[</mo>
             <mi>n</mi>
             <mo stretchy="false">]</mo>
            </mrow>
            <mi>w</mi>
            <mrow>
             <mo stretchy="false">[</mo>
             <mrow>
              <mi>n</mi>
              <mo>-</mo>
              <mi>i</mi>
             </mrow>
             <mo stretchy="false">]</mo>
            </mrow>
           </mrow>
           <mo stretchy="false">}</mo>
          </mrow>
         </mrow>
        </mrow>
        <mi>i</mi>
       </mrow>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mo rspace="4.2pt">,</mo>
      <mrow>
       <mi mathvariant="normal">…</mi>
       <mo rspace="4.2pt">,</mo>
       <mi>N</mi>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd></mtd>
    <mtd columnalign="center">
     <mo>=</mo>
    </mtd>
    <mtd columnalign="left">
     <mrow>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>j</mi>
           <mo>=</mo>
           <mn>0</mn>
          </mrow>
          <mi>N</mi>
         </munderover>
         <mrow>
          <mi>E</mi>
          <mrow>
           <mo stretchy="false">{</mo>
           <mrow>
            <mi>w</mi>
            <mrow>
             <mo stretchy="false">[</mo>
             <mrow>
              <mi>n</mi>
              <mo>-</mo>
              <mi>j</mi>
             </mrow>
             <mo stretchy="false">]</mo>
            </mrow>
            <mi>w</mi>
            <mrow>
             <mo stretchy="false">[</mo>
             <mrow>
              <mi>n</mi>
              <mo>-</mo>
              <mi>i</mi>
             </mrow>
             <mo stretchy="false">]</mo>
            </mrow>
           </mrow>
           <mo stretchy="false">}</mo>
          </mrow>
          <msub>
           <mi>a</mi>
           <mi>j</mi>
          </msub>
         </mrow>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mn>2</mn>
        <mi>E</mi>
        <mrow>
         <mo stretchy="false">{</mo>
         <mrow>
          <mi>w</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mi>i</mi>
           </mrow>
           <mo stretchy="false">]</mo>
          </mrow>
          <mi>s</mi>
          <mrow>
           <mo stretchy="false">[</mo>
           <mi>n</mi>
           <mo stretchy="false">]</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">}</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>.</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <ci>E</ci>
      <set>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>n</ci>
        </apply>
       </apply>
      </set>
     </apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <list>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>E</ci>
          <set>
           <apply>
            <times></times>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <sum></sum>
               <apply>
                <eq></eq>
                <ci>j</ci>
                <cn type="integer">0</cn>
               </apply>
              </apply>
              <ci>N</ci>
             </apply>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>a</ci>
               <ci>j</ci>
              </apply>
              <ci>w</ci>
              <apply>
               <csymbol cd="latexml">delimited-[]</csymbol>
               <apply>
                <minus></minus>
                <ci>n</ci>
                <ci>j</ci>
               </apply>
              </apply>
             </apply>
            </apply>
            <ci>w</ci>
            <apply>
             <csymbol cd="latexml">delimited-[]</csymbol>
             <apply>
              <minus></minus>
              <ci>n</ci>
              <ci>i</ci>
             </apply>
            </apply>
           </apply>
          </set>
         </apply>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>E</ci>
          <set>
           <apply>
            <times></times>
            <ci>s</ci>
            <apply>
             <csymbol cd="latexml">delimited-[]</csymbol>
             <ci>n</ci>
            </apply>
            <ci>w</ci>
            <apply>
             <csymbol cd="latexml">delimited-[]</csymbol>
             <apply>
              <minus></minus>
              <ci>n</ci>
              <ci>i</ci>
             </apply>
            </apply>
           </apply>
          </set>
         </apply>
        </apply>
        <ci>i</ci>
       </list>
       <cn type="integer">0</cn>
      </apply>
      <list>
       <ci>normal-…</ci>
       <ci>N</ci>
      </list>
     </apply>
    </matrixrow>
    <matrixrow>
     <cerror>
      <csymbol cd="ambiguous">missing-subexpression</csymbol>
     </cerror>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <times></times>
         <ci>E</ci>
         <set>
          <apply>
           <times></times>
           <ci>w</ci>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <apply>
             <minus></minus>
             <ci>n</ci>
             <ci>j</ci>
            </apply>
           </apply>
           <ci>w</ci>
           <apply>
            <csymbol cd="latexml">delimited-[]</csymbol>
            <apply>
             <minus></minus>
             <ci>n</ci>
             <ci>i</ci>
            </apply>
           </apply>
          </apply>
         </set>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>E</ci>
       <set>
        <apply>
         <times></times>
         <ci>w</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <ci>s</ci>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <ci>n</ci>
         </apply>
        </apply>
       </set>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{array}[]{rcl}\frac{\partial}{\partial a_{i}}E\{e^{2}[n]\}&=&2E\{\big(%
\sum_{j=0}^{N}a_{j}w[n-j]\big)w[n-i]\}-2E\{s[n]w[n-i]\}\quad i=0,\,\ldots,\,N%
\\
&=&2\sum_{j=0}^{N}E\{w[n-j]w[n-i]\}a_{j}-2E\{w[n-i]s[n]\}.\end{array}
  </annotation>
 </semantics>
</math>

</p>

<p>Assuming that <em>w</em>[<em>n</em>] and <em>s</em>[<em>n</em>] are each stationary and jointly stationary, the sequences 

<math display="inline" id="Wiener_filter:38">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi>w</mi>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>m</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>w</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{w}[m]
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Wiener_filter:39">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mrow>
     <mi>w</mi>
     <mi>s</mi>
    </mrow>
   </msub>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>m</mi>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <apply>
      <times></times>
      <ci>w</ci>
      <ci>s</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{ws}[m]
  </annotation>
 </semantics>
</math>

 known respectively as the autocorrelation of <em>w</em>[<em>n</em>] and the cross-correlation between <em>w</em>[<em>n</em>] and <em>s</em>[<em>n</em>] can be defined as follows:</p>

<p>

<math display="inline" id="Wiener_filter:40">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>m</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <ci>w</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>m</ci>
     </apply>
    </apply>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle R_{w}[m]=
  </annotation>
 </semantics>
</math>


</p>

<p>The derivative of the MSE may therefore be rewritten as (notice that 

<math display="inline" id="Wiener_filter:41">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>R</mi>
     <mrow>
      <mi>w</mi>
      <mi>s</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mo>-</mo>
      <mi>i</mi>
     </mrow>
     <mo rspace="4.2pt" stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <msub>
     <mi>R</mi>
     <mrow>
      <mi>s</mi>
      <mi>w</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>i</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <apply>
       <times></times>
       <ci>w</ci>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <minus></minus>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <apply>
       <times></times>
       <ci>s</ci>
       <ci>w</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{ws}[-i]\,=\,R_{sw}[i]
  </annotation>
 </semantics>
</math>

)</p>

<p>

<math display="block" id="Wiener_filter:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
      <mi>E</mi>
      <mrow>
       <mo stretchy="false">{</mo>
       <mrow>
        <msup>
         <mi>e</mi>
         <mn>2</mn>
        </msup>
        <mrow>
         <mo stretchy="false">[</mo>
         <mi>n</mi>
         <mo stretchy="false">]</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">}</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mn>0</mn>
         </mrow>
         <mi>N</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>R</mi>
          <mi>w</mi>
         </msub>
         <mrow>
          <mo stretchy="false">[</mo>
          <mrow>
           <mi>j</mi>
           <mo>-</mo>
           <mi>i</mi>
          </mrow>
          <mo stretchy="false">]</mo>
         </mrow>
         <msub>
          <mi>a</mi>
          <mi>j</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>R</mi>
        <mrow>
         <mi>s</mi>
         <mi>w</mi>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>i</mi>
        <mo stretchy="false">]</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mrow>
      <mn>0</mn>
      <mo rspace="4.2pt">,</mo>
      <mi mathvariant="normal">…</mi>
      <mo rspace="4.2pt">,</mo>
      <mi>N</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>a</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <ci>E</ci>
      <set>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>e</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>n</ci>
        </apply>
       </apply>
      </set>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <ci>w</ci>
         </apply>
         <apply>
          <csymbol cd="latexml">delimited-[]</csymbol>
          <apply>
           <minus></minus>
           <ci>j</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>a</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <apply>
         <times></times>
         <ci>s</ci>
         <ci>w</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>normal-…</ci>
      <ci>N</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial a_{i}}E\{e^{2}[n]\}=2\sum_{j=0}^{N}R_{w}[j-i]a_{j}-2R%
_{sw}[i]\quad i=0,\,\ldots,\,N.
  </annotation>
 </semantics>
</math>

</p>

<p>Letting the derivative be equal to zero results in</p>

<p>

<math display="block" id="Wiener_filter:43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>j</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>R</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo stretchy="false">[</mo>
        <mrow>
         <mi>j</mi>
         <mo>-</mo>
         <mi>i</mi>
        </mrow>
        <mo stretchy="false">]</mo>
       </mrow>
       <msub>
        <mi>a</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mrow>
        <mi>s</mi>
        <mi>w</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>i</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
    </mrow>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mrow>
      <mn>0</mn>
      <mo rspace="4.2pt">,</mo>
      <mi mathvariant="normal">…</mi>
      <mo rspace="4.2pt">,</mo>
      <mi>N</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>R</ci>
        <ci>w</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <minus></minus>
         <ci>j</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>a</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>R</ci>
       <apply>
        <times></times>
        <ci>s</ci>
        <ci>w</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <ci>i</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>normal-…</ci>
      <ci>N</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{j=0}^{N}R_{w}[j-i]a_{j}=R_{sw}[i]\quad i=0,\,\ldots,\,N,
  </annotation>
 </semantics>
</math>

</p>

<p>which can be rewritten in matrix form</p>

<p>

<math display="inline" id="Wiener_filter:44">
 <semantics>
  <mrow>
   <mi>𝐓𝐚</mi>
   <mo>=</mo>
   <mi>𝐯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐓𝐚</ci>
    <ci>𝐯</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\mathbf{T}\mathbf{a}=\mathbf{v}
  </annotation>
 </semantics>
</math>


</p>

<p>These equations are known as the <a href="Wiener–Hopf_equations" title="wikilink">Wiener–Hopf equations</a>. The matrix T appearing in the equation is a symmetric <a href="Toeplitz_matrix" title="wikilink">Toeplitz matrix</a>. Under suitable conditions on 

<math display="inline" id="Wiener_filter:45">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

, these matrices are known to be positive definite and therefore non-singular yielding a unique solution to the determination of the Wiener filter coefficient vector, 

<math display="inline" id="Wiener_filter:46">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <mi>𝐚</mi>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mrow>
    <msup>
     <mi>𝐓</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mi>𝐯</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝐚</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐓</ci>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>𝐯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{a}\,=\,\mathbf{T}^{-1}\mathbf{v}
  </annotation>
 </semantics>
</math>

. Furthermore, there exists an efficient algorithm to solve such Wiener–Hopf equations known as the <a href="Levinson_recursion" title="wikilink">Levinson-Durbin</a> algorithm so an explicit inversion of 

<math display="inline" id="Wiener_filter:47">
 <semantics>
  <mi>𝐓</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐓</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{T}
  </annotation>
 </semantics>
</math>

 is not required.</p>
<h3 id="relationship-to-the-least-squares-filter">Relationship to the least squares filter</h3>

<p>The realization of the causal Wiener filter looks a lot like the solution to the <a href="least_squares" title="wikilink">least squares</a> estimate, except in the signal processing domain. The least squares solution, for input matrix 

<math display="inline" id="Wiener_filter:48">
 <semantics>
  <mi>𝐗</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐗</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{X}
  </annotation>
 </semantics>
</math>

 and output vector 

<math display="inline" id="Wiener_filter:49">
 <semantics>
  <mi>𝐲</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝐲</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{y}
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="block" id="Wiener_filter:50">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <mi>𝜷</mi>
     <mo mathvariant="bold" stretchy="false">^</mo>
    </mover>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msup>
         <mi>𝐗</mi>
         <mi>𝐓</mi>
        </msup>
        <mi>𝐗</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <msup>
      <mi>𝐗</mi>
      <mi>𝐓</mi>
     </msup>
     <mi>𝒚</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>bold-^</ci>
     <ci>𝜷</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>𝐗</ci>
        <ci>𝐓</ci>
       </apply>
       <ci>𝐗</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>𝐗</ci>
      <ci>𝐓</ci>
     </apply>
     <ci>𝒚</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \boldsymbol{\hat{\beta}}=(\mathbf{X}^{\mathbf{T}}\mathbf{X})^{-1}\mathbf{X}^{%
\mathbf{T}}\boldsymbol{y}.
  </annotation>
 </semantics>
</math>

</p>

<p>The FIR Wiener filter is related to the <a href="least_mean_squares_filter" title="wikilink">least mean squares filter</a>, but minimizing the error criterion of the latter does not rely on cross-correlations or auto-correlations. Its solution converges to the Wiener filter solution.</p>
<h2 id="applications">Applications</h2>

<p>The Wiener filter has a variety of applications in signal processing, image processing, control systems, and digital communications. These applications generally fall into one of four main categories:</p>
<ul>
<li><a href="System_identification" title="wikilink">System identification</a></li>
<li><a class="uri" href="Deconvolution" title="wikilink">Deconvolution</a></li>
<li><a href="Noise_reduction" title="wikilink">Noise reduction</a></li>
<li><a href="Detection_theory" title="wikilink">Signal detection</a></li>
</ul>

<p>For example, the Wiener filter can be used in image processing to remove noise from a picture. For example, using the Mathematica function: <code>WienerFilter[image,2]</code> on the first image on the right, produces the filtered image below it.  </p>

<p>It is commonly used to denoise audio signals, especially speech, as a preprocessor before <a href="speech_recognition" title="wikilink">speech recognition</a>.</p>
<h2 id="history">History</h2>

<p>The filter was proposed by <a href="Norbert_Wiener" title="wikilink">Norbert Wiener</a> during the 1940s and published in 1949.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The discrete-time equivalent of Wiener's work was derived independently by <a href="Andrey_Kolmogorov" title="wikilink">Andrey Kolmogorov</a> and published in 1941. Hence the theory is often called the <strong>Wiener–Kolmogorov</strong> filtering theory (<em>cf.</em> <a class="uri" href="Kriging" title="wikilink">Kriging</a>). The Wiener filter was the first statistically designed filter to be proposed and subsequently gave rise to many others including the famous <a href="Kalman_filter" title="wikilink">Kalman filter</a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Norbert_Wiener" title="wikilink">Norbert Wiener</a></li>
<li><a href="Kalman_filter" title="wikilink">Kalman filter</a></li>
<li><a href="Wiener_deconvolution" title="wikilink">Wiener deconvolution</a></li>
<li><a href="Eberhard_Hopf" title="wikilink">Eberhard Hopf</a></li>
<li><a href="Least_mean_squares_filter" title="wikilink">Least mean squares filter</a></li>
<li><a href="Similarities_between_Wiener_and_LMS" title="wikilink">Similarities between Wiener and LMS</a></li>
<li><a href="Linear_prediction" title="wikilink">Linear prediction</a></li>
<li><a href="Minimum_mean_square_error" title="wikilink">MMSE estimator</a></li>
<li><a href="Generalized_Wiener_filter" title="wikilink">Generalized Wiener filter</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="Thomas_Kailath" title="wikilink">Thomas Kailath</a>, <a href="Ali_H._Sayed" title="wikilink">Ali H. Sayed</a>, and <a href="Babak_Hassibi" title="wikilink">Babak Hassibi</a>, Linear Estimation, Prentice-Hall, NJ, 2000, ISBN 978-0-13-022464-4.</li>
<li>Wiener N: The interpolation, extrapolation and smoothing of stationary time series', Report of the Services 19, Research Project DIC-6037 MIT, February 1942</li>
<li>Kolmogorov A.N: 'Stationary sequences in Hilbert space', (In Russian) Bull. Moscow Univ. 1941 vol.2 no.6 1-40. English translation in Kailath T. (ed.) <em>Linear least squares estimation</em> Dowden, Hutchinson &amp; Ross 1977</li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>Mathematica <a href="http://reference.wolfram.com/mathematica/ref/WienerFilter.html">WienerFilter</a> function</li>
</ul>

<p>"</p>

<p><a href="Category:Linear_filters" title="wikilink">Category:Linear filters</a> <a href="Category:Estimation_theory" title="wikilink">Category:Estimation theory</a> <a href="Category:Stochastic_processes" title="wikilink">Category:Stochastic processes</a> <a href="Category:Time_series_analysis" title="wikilink">Category:Time series analysis</a> <a href="Category:Image_noise_reduction_techniques" title="wikilink">Category:Image noise reduction techniques</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

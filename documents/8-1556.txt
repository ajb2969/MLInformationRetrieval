   Bayesian linear regression      Bayesian linear regression   In statistics , Bayesian linear regression is an approach to linear regression in which the statistical analysis is undertaken within the context of Bayesian inference . When the regression model has errors that have a normal distribution , and if a particular form of prior distribution is assumed, explicit results are available for the posterior probability distributions of the model's parameters.  Model setup  Consider a standard linear regression problem, in which for    i  =   1  ,  …  ,  n       i   1  normal-…  n     i=1,...,n   we specify the conditional distribution of     y  i     subscript  y  i    y_{i}    given a     k  ×  1      k  1    k\times 1    predictor vector     𝐱  i     subscript  𝐱  i    \mathbf{x}_{i}    :        y  i   =     𝐱  i  T   𝜷   +   ϵ  i     ,       subscript  y  i        superscript   subscript  𝐱  i   normal-T   𝜷    subscript  ϵ  i      y_{i}=\mathbf{x}_{i}^{\rm T}\boldsymbol{\beta}+\epsilon_{i},     where    𝜷   𝜷   \boldsymbol{\beta}    is a     k  ×  1      k  1    k\times 1    vector, and the    ϵ  i     subscript  ϵ  i    \epsilon_{i}   are independent and identical  normally distributed random variables:        ϵ  i   ∼   N   (  0  ,   σ  2   )     .     similar-to   subscript  ϵ  i     N   0   superscript  σ  2       \epsilon_{i}\sim N(0,\sigma^{2}).     This corresponds to the following likelihood function :      ρ   (  𝐲  |  𝐗  ,  𝜷  ,   σ  2   )   ∝    (   σ  2   )    -   n  /  2     exp   (  -   1   2   σ  2       (  𝐲  -  𝐗  𝜷  )   T    (  𝐲  -  𝐗  𝜷  )   )   .     fragments  ρ   fragments  normal-(  y  normal-|  X  normal-,  β  normal-,   superscript  σ  2   normal-)   proportional-to   superscript   fragments  normal-(   superscript  σ  2   normal-)       n  2       fragments  normal-(     1    2   superscript  σ  2      superscript   fragments  normal-(  y   X  β  normal-)   normal-T    fragments  normal-(  y   X  β  normal-)   normal-)   normal-.    \rho(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma^{2})\propto(\sigma^{2})^{%
 -n/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta%
 })^{\rm T}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})\right).     The ordinary least squares solution is to estimate the coefficient vector using the Moore-Penrose pseudoinverse :       𝜷  ^   =     (    𝐗  T   𝐗   )    -  1     𝐗  T   𝐲        normal-^  𝜷      superscript     superscript  𝐗  normal-T   𝐗     1     superscript  𝐗  normal-T   𝐲     \hat{\boldsymbol{\beta}}=(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}%
 \mathbf{y}     where   𝐗   𝐗   \mathbf{X}   is the     n  ×  k      n  k    n\times k     design matrix , each row of which is a predictor vector    𝐱  i  T     superscript   subscript  𝐱  i   normal-T    \mathbf{x}_{i}^{\rm T}   ; and   𝐲   𝐲   \mathbf{y}   is the column   n   n   n   -vector     [     y  1     ⋯    y  n    ]   T     superscript   delimited-[]     subscript  y  1   normal-⋯   subscript  y  n     normal-T    [y_{1}\;\cdots\;y_{n}]^{\rm T}   .  This is a frequentist approach, and it assumes that there are enough measurements to say something meaningful about   𝜷   𝜷   \boldsymbol{\beta}   . In the Bayesian approach, the data are supplemented with additional information in the form of a prior probability distribution . The prior belief about the parameters is combined with the data's likelihood function according to Bayes theorem to yield the posterior belief about the parameters   𝜷   𝜷   \boldsymbol{\beta}   and   σ   σ   \sigma   . The prior can take different functional forms depending on the domain and the information that is available a priori.  With conjugate priors  Conjugate prior distribution  For an arbitrary prior distribution, there may be no analytical solution for the posterior distribution . In this section, we will consider a so-called conjugate prior for which the posterior distribution can be derived analytically.  A prior    ρ   (  𝜷  ,   σ  2   )       ρ   𝜷   superscript  σ  2      \rho(\boldsymbol{\beta},\sigma^{2})   is conjugate to this likelihood function if it has the same functional form with respect to   𝜷   𝜷   \boldsymbol{\beta}   and   σ   σ   \sigma   . Since the log-likelihood is quadratic in   𝜷   𝜷   \boldsymbol{\beta}   , the log-likelihood is re-written such that the likelihood becomes normal in    (   𝜷  -   𝜷  ^    )      𝜷   normal-^  𝜷     (\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})   . Write        (   𝐲  -   𝐗  𝜷    )   T    (   𝐲  -   𝐗  𝜷    )        superscript    𝐲    𝐗  𝜷    normal-T     𝐲    𝐗  𝜷      \displaystyle(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-%
 \mathbf{X}\boldsymbol{\beta})     The likelihood is now re-written as      ρ   (  𝐲  |  𝐗  ,  𝜷  ,   σ  2   )      fragments  ρ   fragments  normal-(  y  normal-|  X  normal-,  β  normal-,   superscript  σ  2   normal-)     \displaystyle\rho(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma^{2})     where         v   s  2    =     (   𝐲  -   𝐗   𝜷  ^     )   T    (   𝐲  -   𝐗   𝜷  ^     )     ,     and   v   =   n  -  k     ,     formulae-sequence      v   superscript  s  2       superscript    𝐲    𝐗   normal-^  𝜷     normal-T     𝐲    𝐗   normal-^  𝜷           and  v     n  k      vs^{2}=(\mathbf{y}-\mathbf{X}\hat{\boldsymbol{\beta}})^{\rm T}(\mathbf{y}-%
 \mathbf{X}\hat{\boldsymbol{\beta}}),\text{and}\;v=n-k,     where   k   k   k   is the number of regression coefficients.  This suggests a form for the prior:      ρ   (  𝜷  ,   σ  2   )   =  ρ   (   σ  2   )   ρ   (  𝜷  |   σ  2   )   ,     fragments  ρ   fragments  normal-(  β  normal-,   superscript  σ  2   normal-)    ρ   fragments  normal-(   superscript  σ  2   normal-)   ρ   fragments  normal-(  β  normal-|   superscript  σ  2   normal-)   normal-,    \rho(\boldsymbol{\beta},\sigma^{2})=\rho(\sigma^{2})\rho(\boldsymbol{\beta}|%
 \sigma^{2}),     where    ρ   (   σ  2   )       ρ   superscript  σ  2     \rho(\sigma^{2})   is an inverse-gamma distribution        ρ   (   σ  2   )    ∝     (   σ  2   )    -   (     v  0   /  2   +  1   )      exp   (   -     v  0    s  0  2     2   σ  2      )      .     proportional-to    ρ   superscript  σ  2       superscript   superscript  σ  2          subscript  v  0   2   1              subscript  v  0    superscript   subscript  s  0   2      2   superscript  σ  2          \rho(\sigma^{2})\propto(\sigma^{2})^{-(v_{0}/2+1)}\exp\left(-\frac{v_{0}s_{0}^%
 {2}}{2{\sigma}^{2}}\right).     In the notation introduced in the inverse-gamma distribution article, this is the density of an    Inv-Gamma   (   a  0   ,   b  0   )       Inv-Gamma    subscript  a  0    subscript  b  0      \text{Inv-Gamma}(a_{0},b_{0})   distribution with     a  0   =    v  0   /  2        subscript  a  0      subscript  v  0   2     a_{0}=v_{0}/2   and     b  0   =    1  2    v  0    s  0  2         subscript  b  0       1  2    subscript  v  0    superscript   subscript  s  0   2      b_{0}=\frac{1}{2}v_{0}s_{0}^{2}   with    v  0     subscript  v  0    v_{0}   and    s  0  2     superscript   subscript  s  0   2    s_{0}^{2}   as the prior values of   v   v   v   and    s  2     superscript  s  2    s^{2}   , respectively. Equivalently, it can also be described as a scaled inverse chi-squared distribution ,     Scale-inv-   χ  2    (   v  0   ,   s  0  2   )    .      Scale-inv-   superscript  χ  2     subscript  v  0    superscript   subscript  s  0   2      \mbox{Scale-inv-}\chi^{2}(v_{0},s_{0}^{2}).   .  Further the conditional prior density    ρ   (  𝜷  |   σ  2   )      fragments  ρ   fragments  normal-(  β  normal-|   superscript  σ  2   normal-)     \rho(\boldsymbol{\beta}|\sigma^{2})   is a normal distribution ,      ρ   (  𝜷  |   σ  2   )   ∝    (   σ  2   )    -   k  /  2     exp   (  -   1   2   σ  2       (  𝜷  -   𝝁  0   )   T    𝚲  0    (  𝜷  -   𝝁  0   )   )   .     fragments  ρ   fragments  normal-(  β  normal-|   superscript  σ  2   normal-)   proportional-to   superscript   fragments  normal-(   superscript  σ  2   normal-)       k  2       fragments  normal-(     1    2   superscript  σ  2      superscript   fragments  normal-(  β    subscript  𝝁  0   normal-)   normal-T    subscript  𝚲  0    fragments  normal-(  β    subscript  𝝁  0   normal-)   normal-)   normal-.    \rho(\boldsymbol{\beta}|\sigma^{2})\propto(\sigma^{2})^{-k/2}\exp\left(-\frac{%
 1}{2{\sigma}^{2}}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})^{\rm T}\mathbf{%
 \Lambda}_{0}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})\right).     In the notation of the normal distribution , the conditional prior distribution is     𝒩   (   𝝁  0   ,    σ  2    𝚲  0   -  1     )    .      𝒩    subscript  𝝁  0      superscript  σ  2    superscript   subscript  𝚲  0     1        \mathcal{N}\left(\boldsymbol{\mu}_{0},\sigma^{2}\mathbf{\Lambda}_{0}^{-1}%
 \right).     Posterior distribution  With the prior now specified, the posterior distribution can be expressed as      ρ   (  𝜷  ,   σ  2   |  𝐲  ,  𝐗  )   ∝  ρ   (  𝐲  |  𝐗  ,  𝜷  ,   σ  2   )   ρ   (  𝜷  |   σ  2   )   ρ   (   σ  2   )      fragments  ρ   fragments  normal-(  β  normal-,   superscript  σ  2   normal-|  y  normal-,  X  normal-)   proportional-to  ρ   fragments  normal-(  y  normal-|  X  normal-,  β  normal-,   superscript  σ  2   normal-)   ρ   fragments  normal-(  β  normal-|   superscript  σ  2   normal-)   ρ   fragments  normal-(   superscript  σ  2   normal-)     \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto\rho(\mathbf{y%
 }|\mathbf{X},\boldsymbol{\beta},\sigma^{2})\rho(\boldsymbol{\beta}|\sigma^{2})%
 \rho(\sigma^{2})            ∝     (   σ  2   )    -   n  /  2      exp   (   -    1   2   σ  2       (   𝐲  -   𝐗  𝜷    )   T    (   𝐲  -   𝐗  𝜷    )     )        proportional-to  absent     superscript   superscript  σ  2       n  2             1    2   superscript  σ  2      superscript    𝐲    𝐗  𝜷    normal-T     𝐲    𝐗  𝜷          \propto(\sigma^{2})^{-n/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\mathbf{y}-%
 \mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})\right)               ×     (   σ  2   )    -   k  /  2      exp   (   -    1   2   σ  2       (   𝜷  -   𝝁  0    )   T    𝚲  0    (   𝜷  -   𝝁  0    )     )         absent     superscript   superscript  σ  2       k  2             1    2   superscript  σ  2      superscript    𝜷   subscript  𝝁  0    normal-T    subscript  𝚲  0     𝜷   subscript  𝝁  0          \times(\sigma^{2})^{-k/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\boldsymbol{\beta}%
 -\boldsymbol{\mu}_{0})^{\rm T}\boldsymbol{\Lambda}_{0}(\boldsymbol{\beta}-%
 \boldsymbol{\mu}_{0})\right)                ×     (   σ  2   )    -   (    a  0   +  1   )      exp   (   -    b  0    σ  2     )      .      absent     superscript   superscript  σ  2        subscript  a  0   1            subscript  b  0    superscript  σ  2         \times(\sigma^{2})^{-(a_{0}+1)}\exp\left(-\frac{b_{0}}{{\sigma}^{2}}\right).        With some re-arrangement, 1 the posterior can be re-written so that the posterior mean    𝝁  n     subscript  𝝁  n    \boldsymbol{\mu}_{n}   of the parameter vector   𝜷   𝜷   \boldsymbol{\beta}   can be expressed in terms of the least squares estimator    𝜷  ^     normal-^  𝜷    \hat{\boldsymbol{\beta}}   and the prior mean    𝝁  0     subscript  𝝁  0    \boldsymbol{\mu}_{0}   , with the strength of the prior indicated by the prior precision matrix    𝚲  0     subscript  𝚲  0    \boldsymbol{\Lambda}_{0}           𝝁  n   =     (     𝐗  T   𝐗   +   𝚲  0    )    -  1     (     𝐗  T   𝐗   𝜷  ^    +    𝚲  0    𝝁  0     )     .       subscript  𝝁  n      superscript       superscript  𝐗  normal-T   𝐗    subscript  𝚲  0      1         superscript  𝐗  normal-T   𝐗   normal-^  𝜷       subscript  𝚲  0    subscript  𝝁  0        \boldsymbol{\mu}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0})^{%
 -1}(\mathbf{X}^{\rm T}\mathbf{X}\hat{\boldsymbol{\beta}}+\boldsymbol{\Lambda}_%
 {0}\boldsymbol{\mu}_{0}).     To justify that    𝝁  n     subscript  𝝁  n    \boldsymbol{\mu}_{n}   is indeed the posterior mean, the quadratic terms in the exponential can be re-arranged as a quadratic form in    𝜷  -   𝝁  n       𝜷   subscript  𝝁  n     \boldsymbol{\beta}-\boldsymbol{\mu}_{n}   . 2          (   𝐲  -   𝐗  𝜷    )   T    (   𝐲  -   𝐗  𝜷    )    +     (   𝜷  -   𝝁  0    )   T    𝚲  0    (   𝜷  -   𝝁  0    )     =            superscript    𝐲    𝐗  𝜷    normal-T     𝐲    𝐗  𝜷        superscript    𝜷   subscript  𝝁  0    normal-T    subscript  𝚲  0     𝜷   subscript  𝝁  0      absent    (\mathbf{y}-\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-\mathbf{X}%
 \boldsymbol{\beta})+(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})^{\rm T}%
 \boldsymbol{\Lambda}_{0}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})=                 (   𝜷  -   𝝁  n    )   T    (     𝐗  T   𝐗   +   𝚲  0    )    (   𝜷  -   𝝁  n    )    +    𝐲  T   𝐲    -    𝝁  n  T    (     𝐗  T   𝐗   +   𝚲  0    )    𝝁  n     +    𝝁  0  T    𝚲  0    𝝁  0     .             superscript    𝜷   subscript  𝝁  n    normal-T        superscript  𝐗  normal-T   𝐗    subscript  𝚲  0      𝜷   subscript  𝝁  n        superscript  𝐲  normal-T   𝐲       superscript   subscript  𝝁  n   normal-T        superscript  𝐗  normal-T   𝐗    subscript  𝚲  0     subscript  𝝁  n        superscript   subscript  𝝁  0   normal-T    subscript  𝚲  0    subscript  𝝁  0      (\boldsymbol{\beta}-\boldsymbol{\mu}_{n})^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}%
 +\boldsymbol{\Lambda}_{0})(\boldsymbol{\beta}-\boldsymbol{\mu}_{n})+\mathbf{y}%
 ^{\rm T}\mathbf{y}-\boldsymbol{\mu}_{n}^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+%
 \boldsymbol{\Lambda}_{0})\boldsymbol{\mu}_{n}+\boldsymbol{\mu}_{0}^{\rm T}%
 \boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}.        Now the posterior can be expressed as a normal distribution times an inverse-gamma distribution :      ρ   (  𝜷  ,   σ  2   |  𝐲  ,  𝐗  )   ∝    (   σ  2   )    -   k  /  2     exp   (  -   1   2   σ  2       (  𝜷  -   𝝁  n   )   T    (   𝐗  T   𝐗  +   𝚲  0   )    (  𝜷  -   𝝁  n   )   )      fragments  ρ   fragments  normal-(  β  normal-,   superscript  σ  2   normal-|  y  normal-,  X  normal-)   proportional-to   superscript   fragments  normal-(   superscript  σ  2   normal-)       k  2       fragments  normal-(     1    2   superscript  σ  2      superscript   fragments  normal-(  β    subscript  𝝁  n   normal-)   normal-T    fragments  normal-(   superscript  𝐗  normal-T   X    subscript  𝚲  0   normal-)    fragments  normal-(  β    subscript  𝝁  n   normal-)   normal-)     \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto(\sigma^{2})^{%
 -k/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\boldsymbol{\beta}-\boldsymbol{\mu}_{n%
 })^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+\mathbf{\Lambda}_{0})(\boldsymbol{%
 \beta}-\boldsymbol{\mu}_{n})\right)             ×     (   σ  2   )     -    (   n  +   2   a  0     )   /  2    -  1     exp   (   -       2   b  0    +    𝐲  T   𝐲    -    𝝁  n  T    (     𝐗  T   𝐗   +   𝚲  0    )    𝝁  n     +    𝝁  0  T    𝚲  0    𝝁  0      2   σ  2      )      .      absent     superscript   superscript  σ  2           n    2   subscript  a  0     2    1                  2   subscript  b  0       superscript  𝐲  normal-T   𝐲       superscript   subscript  𝝁  n   normal-T        superscript  𝐗  normal-T   𝐗    subscript  𝚲  0     subscript  𝝁  n        superscript   subscript  𝝁  0   normal-T    subscript  𝚲  0    subscript  𝝁  0       2   superscript  σ  2          \times(\sigma^{2})^{-(n+2a_{0})/2-1}\exp\left(-\frac{2b_{0}+\mathbf{y}^{\rm T}%
 \mathbf{y}-\boldsymbol{\mu}_{n}^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+%
 \boldsymbol{\Lambda}_{0})\boldsymbol{\mu}_{n}+\boldsymbol{\mu}_{0}^{\rm T}%
 \boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}}{2{\sigma}^{2}}\right).        Therefore the posterior distribution can be parametrized as follows.      ρ   (  𝜷  ,   σ  2   |  𝐲  ,  𝐗  )   ∝  ρ   (  𝜷  |   σ  2   ,  𝐲  ,  𝐗  )   ρ   (   σ  2   |  𝐲  ,  𝐗  )   ,     fragments  ρ   fragments  normal-(  β  normal-,   superscript  σ  2   normal-|  y  normal-,  X  normal-)   proportional-to  ρ   fragments  normal-(  β  normal-|   superscript  σ  2   normal-,  y  normal-,  X  normal-)   ρ   fragments  normal-(   superscript  σ  2   normal-|  y  normal-,  X  normal-)   normal-,    \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto\rho(%
 \boldsymbol{\beta}|\sigma^{2},\mathbf{y},\mathbf{X})\rho(\sigma^{2}|\mathbf{y}%
 ,\mathbf{X}),     where the two factors correspond to the densities of    𝒩   (   𝝁  n   ,    σ  2    𝚲  n   -  1     )       𝒩    subscript  𝝁  n      superscript  σ  2    superscript   subscript  𝚲  n     1        \mathcal{N}\left(\boldsymbol{\mu}_{n},\sigma^{2}\boldsymbol{\Lambda}_{n}^{-1}%
 \right)\,   and    Inv-Gamma   (   a  n   ,   b  n   )       Inv-Gamma    subscript  a  n    subscript  b  n      \text{Inv-Gamma}\left(a_{n},b_{n}\right)   distributions, with the parameters of these given by         𝚲  n   =   (     𝐗  T   𝐗   +   𝚲  0    )    ,    𝝁  n   =     (   𝚲  n   )    -  1     (     𝐗  T   𝐗   𝜷  ^    +    𝚲  0    𝝁  0     )      ,     formulae-sequence     subscript  𝚲  n        superscript  𝐗  normal-T   𝐗    subscript  𝚲  0        subscript  𝝁  n      superscript   subscript  𝚲  n     1         superscript  𝐗  normal-T   𝐗   normal-^  𝜷       subscript  𝚲  0    subscript  𝝁  0         \boldsymbol{\Lambda}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\mathbf{\Lambda}_{0}),%
 \quad\boldsymbol{\mu}_{n}=(\boldsymbol{\Lambda}_{n})^{-1}(\mathbf{X}^{\rm T}%
 \mathbf{X}\hat{\boldsymbol{\beta}}+\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0%
 }),            a  n   =    a  0   +   n  2     ,    b  n   =    b  0   +    1  2    (      𝐲  T   𝐲   +    𝝁  0  T    𝚲  0    𝝁  0     -    𝝁  n  T    𝚲  n    𝝁  n     )       .     formulae-sequence     subscript  a  n      subscript  a  0     n  2        subscript  b  n      subscript  b  0       1  2          superscript  𝐲  normal-T   𝐲      superscript   subscript  𝝁  0   normal-T    subscript  𝚲  0    subscript  𝝁  0        superscript   subscript  𝝁  n   normal-T    subscript  𝚲  n    subscript  𝝁  n          a_{n}=a_{0}+\frac{n}{2},\qquad b_{n}=b_{0}+\frac{1}{2}(\mathbf{y}^{\rm T}%
 \mathbf{y}+\boldsymbol{\mu}_{0}^{\rm T}\boldsymbol{\Lambda}_{0}\boldsymbol{\mu%
 }_{0}-\boldsymbol{\mu}_{n}^{\rm T}\boldsymbol{\Lambda}_{n}\boldsymbol{\mu}_{n}).     This can be interpreted as Bayesian learning where the parameters are updated according to the following equations.        𝝁  n   =     (     𝐗  T   𝐗   +   𝚲  0    )    -  1     (     𝚲  0    𝝁  0    +    𝐗  T   𝐗   𝜷  ^     )    =     (     𝐗  T   𝐗   +   𝚲  0    )    -  1     (     𝚲  0    𝝁  0    +    𝐗  T   𝐲    )     ,         subscript  𝝁  n      superscript       superscript  𝐗  normal-T   𝐗    subscript  𝚲  0      1         subscript  𝚲  0    subscript  𝝁  0       superscript  𝐗  normal-T   𝐗   normal-^  𝜷              superscript       superscript  𝐗  normal-T   𝐗    subscript  𝚲  0      1         subscript  𝚲  0    subscript  𝝁  0       superscript  𝐗  normal-T   𝐲        \boldsymbol{\mu}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0})^{%
 -1}(\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}+\mathbf{X}^{\rm T}\mathbf{X}%
 \hat{\boldsymbol{\beta}})=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{%
 0})^{-1}(\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}+\mathbf{X}^{\rm T}%
 \mathbf{y}),           𝚲  n   =   (     𝐗  T   𝐗   +   𝚲  0    )    ,       subscript  𝚲  n        superscript  𝐗  normal-T   𝐗    subscript  𝚲  0      \boldsymbol{\Lambda}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0%
 }),           a  n   =    a  0   +   n  2     ,       subscript  a  n      subscript  a  0     n  2      a_{n}=a_{0}+\frac{n}{2},           b  n   =    b  0   +    1  2    (      𝐲  T   𝐲   +    𝝁  0  T    𝚲  0    𝝁  0     -    𝝁  n  T    𝚲  n    𝝁  n     )      .       subscript  b  n      subscript  b  0       1  2          superscript  𝐲  normal-T   𝐲      superscript   subscript  𝝁  0   normal-T    subscript  𝚲  0    subscript  𝝁  0        superscript   subscript  𝝁  n   normal-T    subscript  𝚲  n    subscript  𝝁  n         b_{n}=b_{0}+\frac{1}{2}(\mathbf{y}^{\rm T}\mathbf{y}+\boldsymbol{\mu}_{0}^{\rm
 T%
 }\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}-\boldsymbol{\mu}_{n}^{\rm T}%
 \boldsymbol{\Lambda}_{n}\boldsymbol{\mu}_{n}).     Model evidence  The model evidence     p   (  𝐲  |  m  )      fragments  p   fragments  normal-(  y  normal-|  m  normal-)     p(\mathbf{y}|m)   is the probability of the data given the model   m   m   m   . It is also known as the marginal likelihood , and as the prior predictive density. Here, the model is defined by the likelihood function    p   (  𝐲  |  𝐗  ,  𝜷  ,  σ  )      fragments  p   fragments  normal-(  y  normal-|  X  normal-,  β  normal-,  σ  normal-)     p(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma)   and the prior distribution on the parameters, i.e.    p   (  𝜷  ,  σ  )       p   𝜷  σ     p(\boldsymbol{\beta},\sigma)   . The model evidence captures in a single number how well such a model explains the observations. The model evidence of the Bayesian linear regression model presented in this section can be used to compare competing linear models by Bayesian model comparison . These models may differ in the number and values of the predictor variables as well as in their priors on the model parameters. Model complexity is already taken into account by the model evidence, because it marginalizes out the parameters by integrating    p   (  𝐲  ,  𝜷  ,  σ  |  𝐗  )      fragments  p   fragments  normal-(  y  normal-,  β  normal-,  σ  normal-|  X  normal-)     p(\mathbf{y},\boldsymbol{\beta},\sigma|\mathbf{X})   over all possible values of   𝜷   𝜷   \boldsymbol{\beta}   and   σ   σ   \sigma   .      p   (  𝐲  |  m  )   =  ∫  p   (  𝐲  |  𝐗  ,  𝜷  ,  σ  )   p   (  𝜷  ,  σ  )   d   𝜷   d  σ     fragments  p   fragments  normal-(  y  normal-|  m  normal-)     p   fragments  normal-(  y  normal-|  X  normal-,  β  normal-,  σ  normal-)   p   fragments  normal-(  β  normal-,  σ  normal-)   d  β  d  σ    p(\mathbf{y}|m)=\int p(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma)\,p(%
 \boldsymbol{\beta},\sigma)\,d\boldsymbol{\beta}\,d\sigma   This integral can be computed analytically and the solution is given in the following equation. 3      p   (  𝐲  |  m  )   =   1    (   2  π   )    n  /  2        det   (   𝚲  0   )     det   (   𝚲  n   )      ⋅    b  0   a  0     b  n   a  n     ⋅    Γ   (   a  n   )     Γ   (   a  0   )        fragments  p   fragments  normal-(  y  normal-|  m  normal-)      1   superscript    2  π     n  2            subscript  𝚲  0       subscript  𝚲  n      normal-⋅     superscript   subscript  b  0    subscript  a  0     superscript   subscript  b  n    subscript  a  n     normal-⋅      normal-Γ   subscript  a  n      normal-Γ   subscript  a  0       p(\mathbf{y}|m)=\frac{1}{(2\pi)^{n/2}}\sqrt{\frac{\det(\boldsymbol{\Lambda}_{0%
 })}{\det(\boldsymbol{\Lambda}_{n})}}\cdot\frac{b_{0}^{a_{0}}}{b_{n}^{a_{n}}}%
 \cdot\frac{\Gamma(a_{n})}{\Gamma(a_{0})}     Here   Γ   normal-Γ   \Gamma   denotes the gamma function . Because we have chosen a conjugate prior, the marginal likelihood can also be easily computed by evaluating the following equality for arbitrary values of   𝜷   𝜷   \boldsymbol{\beta}   and   σ   σ   \sigma   .      p   (  𝐲  |  m  )   =    p   (  𝜷  ,  σ  |  m  )   p   (  𝐲  |  𝐗  ,  𝜷  ,  σ  ,  m  )     p   (  𝜷  ,  σ  |  𝐲  ,  𝐗  ,  m  )        fragments  p   fragments  normal-(  y  normal-|  m  normal-)       fragments  p   fragments  normal-(  β  normal-,  σ  normal-|  m  normal-)   p   fragments  normal-(  y  normal-|  X  normal-,  β  normal-,  σ  normal-,  m  normal-)     fragments  p   fragments  normal-(  β  normal-,  σ  normal-|  y  normal-,  X  normal-,  m  normal-)       p(\mathbf{y}|m)=\frac{p(\boldsymbol{\beta},\sigma|m)\,p(\mathbf{y}|\mathbf{X},%
 \boldsymbol{\beta},\sigma,m)}{p(\boldsymbol{\beta},\sigma|\mathbf{y},\mathbf{X%
 },m)}   Note that this equation is nothing but a re-arrangement of Bayes theorem . Inserting the formulas for the prior, the likelihood, and the posterior and simplifying the resulting expression leads to the analytic expression given above.  Other cases  In general, it may be impossible or impractical to derive the posterior distribution analytically. However, it is possible to approximate the posterior by an approximate Bayesian inference method such as Monte Carlo sampling 4 or variational Bayes .  The special case      𝝁  0   =  0   ,    𝚲  0   =   c  𝐈       formulae-sequence     subscript  𝝁  0   0      subscript  𝚲  0     c  𝐈      \boldsymbol{\mu}_{0}=0,\mathbf{\Lambda}_{0}=c\mathbf{I}   is called ridge regression .  A similar analysis can be performed for the general case of the multivariate regression and part of this provides for Bayesian estimation of covariance matrices : see Bayesian multivariate linear regression .  See also   Bayes linear statistics  Tikhonov regularization   Notes    References           Thomas P. Minka (2001) Bayesian Linear Regression , Microsoft research web page   External links   Bayesian estimation of linear models (R programming wikibook) . Bayesian linear regression as implemented in R .   "  Linear regression  Category:Regression analysis     The intermediate steps of this computation can be found in O'Hagan (1994) at the beginning of the chapter on Linear models. ↩  The intermediate steps are in Fahrmeir et al. (2009) on page 188. ↩  The intermediate steps of this computation can be found in O'Hagan (1994) on page 257. ↩  Carlin and Louis(2008) and Gelman, et al. (2003) explain how to use sampling methods for Bayesian linear regression. ↩     
   Bayesian linear regression      Bayesian linear regression   In statistics , Bayesian linear regression is an approach to linear regression in which the statistical analysis is undertaken within the context of Bayesian inference . When the regression model has errors that have a normal distribution , and if a particular form of prior distribution is assumed, explicit results are available for the posterior probability distributions of the model's parameters.  Model setup  Consider a standard linear regression problem, in which for    i  =   1  ,  â€¦  ,  n       i   1  normal-â€¦  n     i=1,...,n   we specify the conditional distribution of     y  i     subscript  y  i    y_{i}    given a     k  Ã—  1      k  1    k\times 1    predictor vector     ğ±  i     subscript  ğ±  i    \mathbf{x}_{i}    :        y  i   =     ğ±  i  T   ğœ·   +   Ïµ  i     ,       subscript  y  i        superscript   subscript  ğ±  i   normal-T   ğœ·    subscript  Ïµ  i      y_{i}=\mathbf{x}_{i}^{\rm T}\boldsymbol{\beta}+\epsilon_{i},     where    ğœ·   ğœ·   \boldsymbol{\beta}    is a     k  Ã—  1      k  1    k\times 1    vector, and the    Ïµ  i     subscript  Ïµ  i    \epsilon_{i}   are independent and identical  normally distributed random variables:        Ïµ  i   âˆ¼   N   (  0  ,   Ïƒ  2   )     .     similar-to   subscript  Ïµ  i     N   0   superscript  Ïƒ  2       \epsilon_{i}\sim N(0,\sigma^{2}).     This corresponds to the following likelihood function :      Ï   (  ğ²  |  ğ—  ,  ğœ·  ,   Ïƒ  2   )   âˆ    (   Ïƒ  2   )    -   n  /  2     exp   (  -   1   2   Ïƒ  2       (  ğ²  -  ğ—  ğœ·  )   T    (  ğ²  -  ğ—  ğœ·  )   )   .     fragments  Ï   fragments  normal-(  y  normal-|  X  normal-,  Î²  normal-,   superscript  Ïƒ  2   normal-)   proportional-to   superscript   fragments  normal-(   superscript  Ïƒ  2   normal-)       n  2       fragments  normal-(     1    2   superscript  Ïƒ  2      superscript   fragments  normal-(  y   X  Î²  normal-)   normal-T    fragments  normal-(  y   X  Î²  normal-)   normal-)   normal-.    \rho(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma^{2})\propto(\sigma^{2})^{%
 -n/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta%
 })^{\rm T}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})\right).     The ordinary least squares solution is to estimate the coefficient vector using the Moore-Penrose pseudoinverse :       ğœ·  ^   =     (    ğ—  T   ğ—   )    -  1     ğ—  T   ğ²        normal-^  ğœ·      superscript     superscript  ğ—  normal-T   ğ—     1     superscript  ğ—  normal-T   ğ²     \hat{\boldsymbol{\beta}}=(\mathbf{X}^{\rm T}\mathbf{X})^{-1}\mathbf{X}^{\rm T}%
 \mathbf{y}     where   ğ—   ğ—   \mathbf{X}   is the     n  Ã—  k      n  k    n\times k     design matrix , each row of which is a predictor vector    ğ±  i  T     superscript   subscript  ğ±  i   normal-T    \mathbf{x}_{i}^{\rm T}   ; and   ğ²   ğ²   \mathbf{y}   is the column   n   n   n   -vector     [     y  1     â‹¯    y  n    ]   T     superscript   delimited-[]     subscript  y  1   normal-â‹¯   subscript  y  n     normal-T    [y_{1}\;\cdots\;y_{n}]^{\rm T}   .  This is a frequentist approach, and it assumes that there are enough measurements to say something meaningful about   ğœ·   ğœ·   \boldsymbol{\beta}   . In the Bayesian approach, the data are supplemented with additional information in the form of a prior probability distribution . The prior belief about the parameters is combined with the data's likelihood function according to Bayes theorem to yield the posterior belief about the parameters   ğœ·   ğœ·   \boldsymbol{\beta}   and   Ïƒ   Ïƒ   \sigma   . The prior can take different functional forms depending on the domain and the information that is available a priori.  With conjugate priors  Conjugate prior distribution  For an arbitrary prior distribution, there may be no analytical solution for the posterior distribution . In this section, we will consider a so-called conjugate prior for which the posterior distribution can be derived analytically.  A prior    Ï   (  ğœ·  ,   Ïƒ  2   )       Ï   ğœ·   superscript  Ïƒ  2      \rho(\boldsymbol{\beta},\sigma^{2})   is conjugate to this likelihood function if it has the same functional form with respect to   ğœ·   ğœ·   \boldsymbol{\beta}   and   Ïƒ   Ïƒ   \sigma   . Since the log-likelihood is quadratic in   ğœ·   ğœ·   \boldsymbol{\beta}   , the log-likelihood is re-written such that the likelihood becomes normal in    (   ğœ·  -   ğœ·  ^    )      ğœ·   normal-^  ğœ·     (\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})   . Write        (   ğ²  -   ğ—  ğœ·    )   T    (   ğ²  -   ğ—  ğœ·    )        superscript    ğ²    ğ—  ğœ·    normal-T     ğ²    ğ—  ğœ·      \displaystyle(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-%
 \mathbf{X}\boldsymbol{\beta})     The likelihood is now re-written as      Ï   (  ğ²  |  ğ—  ,  ğœ·  ,   Ïƒ  2   )      fragments  Ï   fragments  normal-(  y  normal-|  X  normal-,  Î²  normal-,   superscript  Ïƒ  2   normal-)     \displaystyle\rho(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma^{2})     where         v   s  2    =     (   ğ²  -   ğ—   ğœ·  ^     )   T    (   ğ²  -   ğ—   ğœ·  ^     )     ,     and   v   =   n  -  k     ,     formulae-sequence      v   superscript  s  2       superscript    ğ²    ğ—   normal-^  ğœ·     normal-T     ğ²    ğ—   normal-^  ğœ·           and  v     n  k      vs^{2}=(\mathbf{y}-\mathbf{X}\hat{\boldsymbol{\beta}})^{\rm T}(\mathbf{y}-%
 \mathbf{X}\hat{\boldsymbol{\beta}}),\text{and}\;v=n-k,     where   k   k   k   is the number of regression coefficients.  This suggests a form for the prior:      Ï   (  ğœ·  ,   Ïƒ  2   )   =  Ï   (   Ïƒ  2   )   Ï   (  ğœ·  |   Ïƒ  2   )   ,     fragments  Ï   fragments  normal-(  Î²  normal-,   superscript  Ïƒ  2   normal-)    Ï   fragments  normal-(   superscript  Ïƒ  2   normal-)   Ï   fragments  normal-(  Î²  normal-|   superscript  Ïƒ  2   normal-)   normal-,    \rho(\boldsymbol{\beta},\sigma^{2})=\rho(\sigma^{2})\rho(\boldsymbol{\beta}|%
 \sigma^{2}),     where    Ï   (   Ïƒ  2   )       Ï   superscript  Ïƒ  2     \rho(\sigma^{2})   is an inverse-gamma distribution        Ï   (   Ïƒ  2   )    âˆ     (   Ïƒ  2   )    -   (     v  0   /  2   +  1   )      exp   (   -     v  0    s  0  2     2   Ïƒ  2      )      .     proportional-to    Ï   superscript  Ïƒ  2       superscript   superscript  Ïƒ  2          subscript  v  0   2   1              subscript  v  0    superscript   subscript  s  0   2      2   superscript  Ïƒ  2          \rho(\sigma^{2})\propto(\sigma^{2})^{-(v_{0}/2+1)}\exp\left(-\frac{v_{0}s_{0}^%
 {2}}{2{\sigma}^{2}}\right).     In the notation introduced in the inverse-gamma distribution article, this is the density of an    Inv-Gamma   (   a  0   ,   b  0   )       Inv-Gamma    subscript  a  0    subscript  b  0      \text{Inv-Gamma}(a_{0},b_{0})   distribution with     a  0   =    v  0   /  2        subscript  a  0      subscript  v  0   2     a_{0}=v_{0}/2   and     b  0   =    1  2    v  0    s  0  2         subscript  b  0       1  2    subscript  v  0    superscript   subscript  s  0   2      b_{0}=\frac{1}{2}v_{0}s_{0}^{2}   with    v  0     subscript  v  0    v_{0}   and    s  0  2     superscript   subscript  s  0   2    s_{0}^{2}   as the prior values of   v   v   v   and    s  2     superscript  s  2    s^{2}   , respectively. Equivalently, it can also be described as a scaled inverse chi-squared distribution ,     Scale-inv-   Ï‡  2    (   v  0   ,   s  0  2   )    .      Scale-inv-   superscript  Ï‡  2     subscript  v  0    superscript   subscript  s  0   2      \mbox{Scale-inv-}\chi^{2}(v_{0},s_{0}^{2}).   .  Further the conditional prior density    Ï   (  ğœ·  |   Ïƒ  2   )      fragments  Ï   fragments  normal-(  Î²  normal-|   superscript  Ïƒ  2   normal-)     \rho(\boldsymbol{\beta}|\sigma^{2})   is a normal distribution ,      Ï   (  ğœ·  |   Ïƒ  2   )   âˆ    (   Ïƒ  2   )    -   k  /  2     exp   (  -   1   2   Ïƒ  2       (  ğœ·  -   ğ  0   )   T    ğš²  0    (  ğœ·  -   ğ  0   )   )   .     fragments  Ï   fragments  normal-(  Î²  normal-|   superscript  Ïƒ  2   normal-)   proportional-to   superscript   fragments  normal-(   superscript  Ïƒ  2   normal-)       k  2       fragments  normal-(     1    2   superscript  Ïƒ  2      superscript   fragments  normal-(  Î²    subscript  ğ  0   normal-)   normal-T    subscript  ğš²  0    fragments  normal-(  Î²    subscript  ğ  0   normal-)   normal-)   normal-.    \rho(\boldsymbol{\beta}|\sigma^{2})\propto(\sigma^{2})^{-k/2}\exp\left(-\frac{%
 1}{2{\sigma}^{2}}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})^{\rm T}\mathbf{%
 \Lambda}_{0}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})\right).     In the notation of the normal distribution , the conditional prior distribution is     ğ’©   (   ğ  0   ,    Ïƒ  2    ğš²  0   -  1     )    .      ğ’©    subscript  ğ  0      superscript  Ïƒ  2    superscript   subscript  ğš²  0     1        \mathcal{N}\left(\boldsymbol{\mu}_{0},\sigma^{2}\mathbf{\Lambda}_{0}^{-1}%
 \right).     Posterior distribution  With the prior now specified, the posterior distribution can be expressed as      Ï   (  ğœ·  ,   Ïƒ  2   |  ğ²  ,  ğ—  )   âˆ  Ï   (  ğ²  |  ğ—  ,  ğœ·  ,   Ïƒ  2   )   Ï   (  ğœ·  |   Ïƒ  2   )   Ï   (   Ïƒ  2   )      fragments  Ï   fragments  normal-(  Î²  normal-,   superscript  Ïƒ  2   normal-|  y  normal-,  X  normal-)   proportional-to  Ï   fragments  normal-(  y  normal-|  X  normal-,  Î²  normal-,   superscript  Ïƒ  2   normal-)   Ï   fragments  normal-(  Î²  normal-|   superscript  Ïƒ  2   normal-)   Ï   fragments  normal-(   superscript  Ïƒ  2   normal-)     \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto\rho(\mathbf{y%
 }|\mathbf{X},\boldsymbol{\beta},\sigma^{2})\rho(\boldsymbol{\beta}|\sigma^{2})%
 \rho(\sigma^{2})            âˆ     (   Ïƒ  2   )    -   n  /  2      exp   (   -    1   2   Ïƒ  2       (   ğ²  -   ğ—  ğœ·    )   T    (   ğ²  -   ğ—  ğœ·    )     )        proportional-to  absent     superscript   superscript  Ïƒ  2       n  2             1    2   superscript  Ïƒ  2      superscript    ğ²    ğ—  ğœ·    normal-T     ğ²    ğ—  ğœ·          \propto(\sigma^{2})^{-n/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\mathbf{y}-%
 \mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-\mathbf{X}\boldsymbol{\beta})\right)               Ã—     (   Ïƒ  2   )    -   k  /  2      exp   (   -    1   2   Ïƒ  2       (   ğœ·  -   ğ  0    )   T    ğš²  0    (   ğœ·  -   ğ  0    )     )         absent     superscript   superscript  Ïƒ  2       k  2             1    2   superscript  Ïƒ  2      superscript    ğœ·   subscript  ğ  0    normal-T    subscript  ğš²  0     ğœ·   subscript  ğ  0          \times(\sigma^{2})^{-k/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\boldsymbol{\beta}%
 -\boldsymbol{\mu}_{0})^{\rm T}\boldsymbol{\Lambda}_{0}(\boldsymbol{\beta}-%
 \boldsymbol{\mu}_{0})\right)                Ã—     (   Ïƒ  2   )    -   (    a  0   +  1   )      exp   (   -    b  0    Ïƒ  2     )      .      absent     superscript   superscript  Ïƒ  2        subscript  a  0   1            subscript  b  0    superscript  Ïƒ  2         \times(\sigma^{2})^{-(a_{0}+1)}\exp\left(-\frac{b_{0}}{{\sigma}^{2}}\right).        With some re-arrangement, 1 the posterior can be re-written so that the posterior mean    ğ  n     subscript  ğ  n    \boldsymbol{\mu}_{n}   of the parameter vector   ğœ·   ğœ·   \boldsymbol{\beta}   can be expressed in terms of the least squares estimator    ğœ·  ^     normal-^  ğœ·    \hat{\boldsymbol{\beta}}   and the prior mean    ğ  0     subscript  ğ  0    \boldsymbol{\mu}_{0}   , with the strength of the prior indicated by the prior precision matrix    ğš²  0     subscript  ğš²  0    \boldsymbol{\Lambda}_{0}           ğ  n   =     (     ğ—  T   ğ—   +   ğš²  0    )    -  1     (     ğ—  T   ğ—   ğœ·  ^    +    ğš²  0    ğ  0     )     .       subscript  ğ  n      superscript       superscript  ğ—  normal-T   ğ—    subscript  ğš²  0      1         superscript  ğ—  normal-T   ğ—   normal-^  ğœ·       subscript  ğš²  0    subscript  ğ  0        \boldsymbol{\mu}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0})^{%
 -1}(\mathbf{X}^{\rm T}\mathbf{X}\hat{\boldsymbol{\beta}}+\boldsymbol{\Lambda}_%
 {0}\boldsymbol{\mu}_{0}).     To justify that    ğ  n     subscript  ğ  n    \boldsymbol{\mu}_{n}   is indeed the posterior mean, the quadratic terms in the exponential can be re-arranged as a quadratic form in    ğœ·  -   ğ  n       ğœ·   subscript  ğ  n     \boldsymbol{\beta}-\boldsymbol{\mu}_{n}   . 2          (   ğ²  -   ğ—  ğœ·    )   T    (   ğ²  -   ğ—  ğœ·    )    +     (   ğœ·  -   ğ  0    )   T    ğš²  0    (   ğœ·  -   ğ  0    )     =            superscript    ğ²    ğ—  ğœ·    normal-T     ğ²    ğ—  ğœ·        superscript    ğœ·   subscript  ğ  0    normal-T    subscript  ğš²  0     ğœ·   subscript  ğ  0      absent    (\mathbf{y}-\mathbf{X}\boldsymbol{\beta})^{\rm T}(\mathbf{y}-\mathbf{X}%
 \boldsymbol{\beta})+(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})^{\rm T}%
 \boldsymbol{\Lambda}_{0}(\boldsymbol{\beta}-\boldsymbol{\mu}_{0})=                 (   ğœ·  -   ğ  n    )   T    (     ğ—  T   ğ—   +   ğš²  0    )    (   ğœ·  -   ğ  n    )    +    ğ²  T   ğ²    -    ğ  n  T    (     ğ—  T   ğ—   +   ğš²  0    )    ğ  n     +    ğ  0  T    ğš²  0    ğ  0     .             superscript    ğœ·   subscript  ğ  n    normal-T        superscript  ğ—  normal-T   ğ—    subscript  ğš²  0      ğœ·   subscript  ğ  n        superscript  ğ²  normal-T   ğ²       superscript   subscript  ğ  n   normal-T        superscript  ğ—  normal-T   ğ—    subscript  ğš²  0     subscript  ğ  n        superscript   subscript  ğ  0   normal-T    subscript  ğš²  0    subscript  ğ  0      (\boldsymbol{\beta}-\boldsymbol{\mu}_{n})^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}%
 +\boldsymbol{\Lambda}_{0})(\boldsymbol{\beta}-\boldsymbol{\mu}_{n})+\mathbf{y}%
 ^{\rm T}\mathbf{y}-\boldsymbol{\mu}_{n}^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+%
 \boldsymbol{\Lambda}_{0})\boldsymbol{\mu}_{n}+\boldsymbol{\mu}_{0}^{\rm T}%
 \boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}.        Now the posterior can be expressed as a normal distribution times an inverse-gamma distribution :      Ï   (  ğœ·  ,   Ïƒ  2   |  ğ²  ,  ğ—  )   âˆ    (   Ïƒ  2   )    -   k  /  2     exp   (  -   1   2   Ïƒ  2       (  ğœ·  -   ğ  n   )   T    (   ğ—  T   ğ—  +   ğš²  0   )    (  ğœ·  -   ğ  n   )   )      fragments  Ï   fragments  normal-(  Î²  normal-,   superscript  Ïƒ  2   normal-|  y  normal-,  X  normal-)   proportional-to   superscript   fragments  normal-(   superscript  Ïƒ  2   normal-)       k  2       fragments  normal-(     1    2   superscript  Ïƒ  2      superscript   fragments  normal-(  Î²    subscript  ğ  n   normal-)   normal-T    fragments  normal-(   superscript  ğ—  normal-T   X    subscript  ğš²  0   normal-)    fragments  normal-(  Î²    subscript  ğ  n   normal-)   normal-)     \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto(\sigma^{2})^{%
 -k/2}\exp\left(-\frac{1}{2{\sigma}^{2}}(\boldsymbol{\beta}-\boldsymbol{\mu}_{n%
 })^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+\mathbf{\Lambda}_{0})(\boldsymbol{%
 \beta}-\boldsymbol{\mu}_{n})\right)             Ã—     (   Ïƒ  2   )     -    (   n  +   2   a  0     )   /  2    -  1     exp   (   -       2   b  0    +    ğ²  T   ğ²    -    ğ  n  T    (     ğ—  T   ğ—   +   ğš²  0    )    ğ  n     +    ğ  0  T    ğš²  0    ğ  0      2   Ïƒ  2      )      .      absent     superscript   superscript  Ïƒ  2           n    2   subscript  a  0     2    1                  2   subscript  b  0       superscript  ğ²  normal-T   ğ²       superscript   subscript  ğ  n   normal-T        superscript  ğ—  normal-T   ğ—    subscript  ğš²  0     subscript  ğ  n        superscript   subscript  ğ  0   normal-T    subscript  ğš²  0    subscript  ğ  0       2   superscript  Ïƒ  2          \times(\sigma^{2})^{-(n+2a_{0})/2-1}\exp\left(-\frac{2b_{0}+\mathbf{y}^{\rm T}%
 \mathbf{y}-\boldsymbol{\mu}_{n}^{\rm T}(\mathbf{X}^{\rm T}\mathbf{X}+%
 \boldsymbol{\Lambda}_{0})\boldsymbol{\mu}_{n}+\boldsymbol{\mu}_{0}^{\rm T}%
 \boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}}{2{\sigma}^{2}}\right).        Therefore the posterior distribution can be parametrized as follows.      Ï   (  ğœ·  ,   Ïƒ  2   |  ğ²  ,  ğ—  )   âˆ  Ï   (  ğœ·  |   Ïƒ  2   ,  ğ²  ,  ğ—  )   Ï   (   Ïƒ  2   |  ğ²  ,  ğ—  )   ,     fragments  Ï   fragments  normal-(  Î²  normal-,   superscript  Ïƒ  2   normal-|  y  normal-,  X  normal-)   proportional-to  Ï   fragments  normal-(  Î²  normal-|   superscript  Ïƒ  2   normal-,  y  normal-,  X  normal-)   Ï   fragments  normal-(   superscript  Ïƒ  2   normal-|  y  normal-,  X  normal-)   normal-,    \rho(\boldsymbol{\beta},\sigma^{2}|\mathbf{y},\mathbf{X})\propto\rho(%
 \boldsymbol{\beta}|\sigma^{2},\mathbf{y},\mathbf{X})\rho(\sigma^{2}|\mathbf{y}%
 ,\mathbf{X}),     where the two factors correspond to the densities of    ğ’©   (   ğ  n   ,    Ïƒ  2    ğš²  n   -  1     )       ğ’©    subscript  ğ  n      superscript  Ïƒ  2    superscript   subscript  ğš²  n     1        \mathcal{N}\left(\boldsymbol{\mu}_{n},\sigma^{2}\boldsymbol{\Lambda}_{n}^{-1}%
 \right)\,   and    Inv-Gamma   (   a  n   ,   b  n   )       Inv-Gamma    subscript  a  n    subscript  b  n      \text{Inv-Gamma}\left(a_{n},b_{n}\right)   distributions, with the parameters of these given by         ğš²  n   =   (     ğ—  T   ğ—   +   ğš²  0    )    ,    ğ  n   =     (   ğš²  n   )    -  1     (     ğ—  T   ğ—   ğœ·  ^    +    ğš²  0    ğ  0     )      ,     formulae-sequence     subscript  ğš²  n        superscript  ğ—  normal-T   ğ—    subscript  ğš²  0        subscript  ğ  n      superscript   subscript  ğš²  n     1         superscript  ğ—  normal-T   ğ—   normal-^  ğœ·       subscript  ğš²  0    subscript  ğ  0         \boldsymbol{\Lambda}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\mathbf{\Lambda}_{0}),%
 \quad\boldsymbol{\mu}_{n}=(\boldsymbol{\Lambda}_{n})^{-1}(\mathbf{X}^{\rm T}%
 \mathbf{X}\hat{\boldsymbol{\beta}}+\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0%
 }),            a  n   =    a  0   +   n  2     ,    b  n   =    b  0   +    1  2    (      ğ²  T   ğ²   +    ğ  0  T    ğš²  0    ğ  0     -    ğ  n  T    ğš²  n    ğ  n     )       .     formulae-sequence     subscript  a  n      subscript  a  0     n  2        subscript  b  n      subscript  b  0       1  2          superscript  ğ²  normal-T   ğ²      superscript   subscript  ğ  0   normal-T    subscript  ğš²  0    subscript  ğ  0        superscript   subscript  ğ  n   normal-T    subscript  ğš²  n    subscript  ğ  n          a_{n}=a_{0}+\frac{n}{2},\qquad b_{n}=b_{0}+\frac{1}{2}(\mathbf{y}^{\rm T}%
 \mathbf{y}+\boldsymbol{\mu}_{0}^{\rm T}\boldsymbol{\Lambda}_{0}\boldsymbol{\mu%
 }_{0}-\boldsymbol{\mu}_{n}^{\rm T}\boldsymbol{\Lambda}_{n}\boldsymbol{\mu}_{n}).     This can be interpreted as Bayesian learning where the parameters are updated according to the following equations.        ğ  n   =     (     ğ—  T   ğ—   +   ğš²  0    )    -  1     (     ğš²  0    ğ  0    +    ğ—  T   ğ—   ğœ·  ^     )    =     (     ğ—  T   ğ—   +   ğš²  0    )    -  1     (     ğš²  0    ğ  0    +    ğ—  T   ğ²    )     ,         subscript  ğ  n      superscript       superscript  ğ—  normal-T   ğ—    subscript  ğš²  0      1         subscript  ğš²  0    subscript  ğ  0       superscript  ğ—  normal-T   ğ—   normal-^  ğœ·              superscript       superscript  ğ—  normal-T   ğ—    subscript  ğš²  0      1         subscript  ğš²  0    subscript  ğ  0       superscript  ğ—  normal-T   ğ²        \boldsymbol{\mu}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0})^{%
 -1}(\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}+\mathbf{X}^{\rm T}\mathbf{X}%
 \hat{\boldsymbol{\beta}})=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{%
 0})^{-1}(\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}+\mathbf{X}^{\rm T}%
 \mathbf{y}),           ğš²  n   =   (     ğ—  T   ğ—   +   ğš²  0    )    ,       subscript  ğš²  n        superscript  ğ—  normal-T   ğ—    subscript  ğš²  0      \boldsymbol{\Lambda}_{n}=(\mathbf{X}^{\rm T}\mathbf{X}+\boldsymbol{\Lambda}_{0%
 }),           a  n   =    a  0   +   n  2     ,       subscript  a  n      subscript  a  0     n  2      a_{n}=a_{0}+\frac{n}{2},           b  n   =    b  0   +    1  2    (      ğ²  T   ğ²   +    ğ  0  T    ğš²  0    ğ  0     -    ğ  n  T    ğš²  n    ğ  n     )      .       subscript  b  n      subscript  b  0       1  2          superscript  ğ²  normal-T   ğ²      superscript   subscript  ğ  0   normal-T    subscript  ğš²  0    subscript  ğ  0        superscript   subscript  ğ  n   normal-T    subscript  ğš²  n    subscript  ğ  n         b_{n}=b_{0}+\frac{1}{2}(\mathbf{y}^{\rm T}\mathbf{y}+\boldsymbol{\mu}_{0}^{\rm
 T%
 }\boldsymbol{\Lambda}_{0}\boldsymbol{\mu}_{0}-\boldsymbol{\mu}_{n}^{\rm T}%
 \boldsymbol{\Lambda}_{n}\boldsymbol{\mu}_{n}).     Model evidence  The model evidence     p   (  ğ²  |  m  )      fragments  p   fragments  normal-(  y  normal-|  m  normal-)     p(\mathbf{y}|m)   is the probability of the data given the model   m   m   m   . It is also known as the marginal likelihood , and as the prior predictive density. Here, the model is defined by the likelihood function    p   (  ğ²  |  ğ—  ,  ğœ·  ,  Ïƒ  )      fragments  p   fragments  normal-(  y  normal-|  X  normal-,  Î²  normal-,  Ïƒ  normal-)     p(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma)   and the prior distribution on the parameters, i.e.    p   (  ğœ·  ,  Ïƒ  )       p   ğœ·  Ïƒ     p(\boldsymbol{\beta},\sigma)   . The model evidence captures in a single number how well such a model explains the observations. The model evidence of the Bayesian linear regression model presented in this section can be used to compare competing linear models by Bayesian model comparison . These models may differ in the number and values of the predictor variables as well as in their priors on the model parameters. Model complexity is already taken into account by the model evidence, because it marginalizes out the parameters by integrating    p   (  ğ²  ,  ğœ·  ,  Ïƒ  |  ğ—  )      fragments  p   fragments  normal-(  y  normal-,  Î²  normal-,  Ïƒ  normal-|  X  normal-)     p(\mathbf{y},\boldsymbol{\beta},\sigma|\mathbf{X})   over all possible values of   ğœ·   ğœ·   \boldsymbol{\beta}   and   Ïƒ   Ïƒ   \sigma   .      p   (  ğ²  |  m  )   =  âˆ«  p   (  ğ²  |  ğ—  ,  ğœ·  ,  Ïƒ  )   p   (  ğœ·  ,  Ïƒ  )   d   ğœ·   d  Ïƒ     fragments  p   fragments  normal-(  y  normal-|  m  normal-)     p   fragments  normal-(  y  normal-|  X  normal-,  Î²  normal-,  Ïƒ  normal-)   p   fragments  normal-(  Î²  normal-,  Ïƒ  normal-)   d  Î²  d  Ïƒ    p(\mathbf{y}|m)=\int p(\mathbf{y}|\mathbf{X},\boldsymbol{\beta},\sigma)\,p(%
 \boldsymbol{\beta},\sigma)\,d\boldsymbol{\beta}\,d\sigma   This integral can be computed analytically and the solution is given in the following equation. 3      p   (  ğ²  |  m  )   =   1    (   2  Ï€   )    n  /  2        det   (   ğš²  0   )     det   (   ğš²  n   )      â‹…    b  0   a  0     b  n   a  n     â‹…    Î“   (   a  n   )     Î“   (   a  0   )        fragments  p   fragments  normal-(  y  normal-|  m  normal-)      1   superscript    2  Ï€     n  2            subscript  ğš²  0       subscript  ğš²  n      normal-â‹…     superscript   subscript  b  0    subscript  a  0     superscript   subscript  b  n    subscript  a  n     normal-â‹…      normal-Î“   subscript  a  n      normal-Î“   subscript  a  0       p(\mathbf{y}|m)=\frac{1}{(2\pi)^{n/2}}\sqrt{\frac{\det(\boldsymbol{\Lambda}_{0%
 })}{\det(\boldsymbol{\Lambda}_{n})}}\cdot\frac{b_{0}^{a_{0}}}{b_{n}^{a_{n}}}%
 \cdot\frac{\Gamma(a_{n})}{\Gamma(a_{0})}     Here   Î“   normal-Î“   \Gamma   denotes the gamma function . Because we have chosen a conjugate prior, the marginal likelihood can also be easily computed by evaluating the following equality for arbitrary values of   ğœ·   ğœ·   \boldsymbol{\beta}   and   Ïƒ   Ïƒ   \sigma   .      p   (  ğ²  |  m  )   =    p   (  ğœ·  ,  Ïƒ  |  m  )   p   (  ğ²  |  ğ—  ,  ğœ·  ,  Ïƒ  ,  m  )     p   (  ğœ·  ,  Ïƒ  |  ğ²  ,  ğ—  ,  m  )        fragments  p   fragments  normal-(  y  normal-|  m  normal-)       fragments  p   fragments  normal-(  Î²  normal-,  Ïƒ  normal-|  m  normal-)   p   fragments  normal-(  y  normal-|  X  normal-,  Î²  normal-,  Ïƒ  normal-,  m  normal-)     fragments  p   fragments  normal-(  Î²  normal-,  Ïƒ  normal-|  y  normal-,  X  normal-,  m  normal-)       p(\mathbf{y}|m)=\frac{p(\boldsymbol{\beta},\sigma|m)\,p(\mathbf{y}|\mathbf{X},%
 \boldsymbol{\beta},\sigma,m)}{p(\boldsymbol{\beta},\sigma|\mathbf{y},\mathbf{X%
 },m)}   Note that this equation is nothing but a re-arrangement of Bayes theorem . Inserting the formulas for the prior, the likelihood, and the posterior and simplifying the resulting expression leads to the analytic expression given above.  Other cases  In general, it may be impossible or impractical to derive the posterior distribution analytically. However, it is possible to approximate the posterior by an approximate Bayesian inference method such as Monte Carlo sampling 4 or variational Bayes .  The special case      ğ  0   =  0   ,    ğš²  0   =   c  ğˆ       formulae-sequence     subscript  ğ  0   0      subscript  ğš²  0     c  ğˆ      \boldsymbol{\mu}_{0}=0,\mathbf{\Lambda}_{0}=c\mathbf{I}   is called ridge regression .  A similar analysis can be performed for the general case of the multivariate regression and part of this provides for Bayesian estimation of covariance matrices : see Bayesian multivariate linear regression .  See also   Bayes linear statistics  Tikhonov regularization   Notes    References           Thomas P. Minka (2001) Bayesian Linear Regression , Microsoft research web page   External links   Bayesian estimation of linear models (R programming wikibook) . Bayesian linear regression as implemented in R .   "  Linear regression  Category:Regression analysis     The intermediate steps of this computation can be found in O'Hagan (1994) at the beginning of the chapter on Linear models. â†©  The intermediate steps are in Fahrmeir et al. (2009) on page 188. â†©  The intermediate steps of this computation can be found in O'Hagan (1994) on page 257. â†©  Carlin and Louis(2008) and Gelman, et al. (2003) explain how to use sampling methods for Bayesian linear regression. â†©     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="547">Empirical Bayes method</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Empirical Bayes method</h1>
<hr/>

<p><strong>Empirical Bayes methods</strong> are procedures for <a href="statistical_inference" title="wikilink">statistical inference</a> in which the prior distribution is estimated from the data. This approach stands in contrast to standard <a href="Bayesian_probability" title="wikilink">Bayesian methods</a>, for which the prior distribution is fixed before any data are observed. Despite this difference in perspective, empirical Bayes may be viewed as an approximation to a fully Bayesian treatment of a <a href="hierarchical_Bayes_model" title="wikilink">hierarchical model</a> wherein the parameters at the highest level of the hierarchy are set to their most likely values, instead of being integrated out. Empirical Bayes, also known as <a href="marginal_likelihood" title="wikilink">maximum marginal likelihood</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> represents one approach for setting <a class="uri" href="hyperparameters" title="wikilink">hyperparameters</a>.</p>
<h2 id="introduction">Introduction</h2>

<p>Empirical Bayes methods can be seen as an approximation to a fully Bayesian treatment of a <a href="hierarchical_Bayes_model" title="wikilink">hierarchical Bayes model</a>.</p>

<p>In, for example, a two-stage hierarchical Bayes model, observed data 

<math display="inline" id="Empirical_Bayes_method:0">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>y</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>y</mi>
     <mi>N</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>N</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=\{y_{1},y_{2},\dots,y_{N}\}
  </annotation>
 </semantics>
</math>

 are assumed to be generated from an unobserved set of parameters 

<math display="inline" id="Empirical_Bayes_method:1">
 <semantics>
  <mrow>
   <mi>θ</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>θ</mi>
     <mn>1</mn>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>θ</mi>
     <mn>2</mn>
    </msub>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <msub>
     <mi>θ</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>θ</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>n</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta=\{\theta_{1},\theta_{2},\dots,\theta_{n}\}
  </annotation>
 </semantics>
</math>

 according to a probability distribution 

<math display="inline" id="Empirical_Bayes_method:2">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>y</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y|\theta)\,
  </annotation>
 </semantics>
</math>

. In turn, the parameters 

<math display="inline" id="Empirical_Bayes_method:3">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 can be considered samples drawn from a population characterised by <a class="uri" href="hyperparameters" title="wikilink">hyperparameters</a> 

<math display="inline" id="Empirical_Bayes_method:4">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>η</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\,
  </annotation>
 </semantics>
</math>

 according to a probability distribution 

<math display="inline" id="Empirical_Bayes_method:5">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>η</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|\eta)\,
  </annotation>
 </semantics>
</math>

. In the hierarchical Bayes model, though not in the empirical Bayes approximation, the hyperparameters 

<math display="inline" id="Empirical_Bayes_method:6">
 <semantics>
  <mpadded width="+1.7pt">
   <mi>η</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\,
  </annotation>
 </semantics>
</math>

 are considered to be drawn from an unparameterized distribution 

<math display="inline" id="Empirical_Bayes_method:7">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>p</ci>
    <ci>η</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\eta)\,
  </annotation>
 </semantics>
</math>

.</p>

<p>Information about a particular quantity of interest 

<math display="inline" id="Empirical_Bayes_method:8">
 <semantics>
  <mpadded width="+2.8pt">
   <msub>
    <mi>θ</mi>
    <mi>i</mi>
   </msub>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{i}\;
  </annotation>
 </semantics>
</math>

 therefore comes not only from the properties of those data which directly depend on it, but also from the properties of the population of parameters 

<math display="inline" id="Empirical_Bayes_method:9">
 <semantics>
  <mpadded width="+2.8pt">
   <mi>θ</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta\;
  </annotation>
 </semantics>
</math>

 as a whole, inferred from the data as a whole, summarised by the hyperparameters 

<math display="inline" id="Empirical_Bayes_method:10">
 <semantics>
  <mpadded width="+2.8pt">
   <mi>η</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\;
  </annotation>
 </semantics>
</math>

.</p>

<p>Using <a href="Bayes'_theorem" title="wikilink">Bayes' theorem</a>,</p>

<p>

<math display="block" id="Empirical_Bayes_method:11">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">|</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">|</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>η</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo rspace="4.2pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mpadded width="+1.7pt">
    <mi>η</mi>
   </mpadded>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <apply>
      <times></times>
      <ci>p</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">η</csymbol>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)=\frac{p(y|\theta)p(\theta)}{p(y)}=\frac{p(y|\theta)}{p(y)}\int p(%
\theta|\eta)p(\eta)\,d\eta\,.
  </annotation>
 </semantics>
</math>

</p>

<p>In general, this integral will not be tractable <a href="Integral#Analytical" title="wikilink">analytically</a> or <a href="Symbolic_integration" title="wikilink">symbolically</a> and must be evaluated by <a href="Integral#Numerical" title="wikilink">numerical</a> methods. Stochastic (random) or deterministic approximations may be used. Example stochastic methods are <a href="Markov_chain_Monte_Carlo" title="wikilink">Markov Chain Monte Carlo</a> and <a href="Monte_Carlo_integration" title="wikilink">Monte Carlo</a> sampling. Deterministic approximations are discussed in <a href="numerical_integration" title="wikilink">quadrature</a>.</p>

<p>Alternatively, the expression can be written as</p>

<p>

<math display="block" id="Empirical_Bayes_method:12">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>η</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mi>η</mi>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mfrac>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">|</mo>
      <mi>θ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">|</mo>
      <mi>η</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mi>p</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">|</mo>
      <mi>η</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mpadded width="+1.7pt">
    <mi>η</mi>
   </mpadded>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">η</csymbol>
    <eq></eq>
    <int></int>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">η</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">η</csymbol>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">η</csymbol>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)=\int p(\theta|\eta,y)p(\eta|y)\;d\eta=\int\frac{p(y|\theta)p(%
\theta|\eta)}{p(y|\eta)}p(\eta|y)\;d\eta\,,
  </annotation>
 </semantics>
</math>

 and the term in the integral can in turn be expressed as</p>

<p>

<math display="block" id="Empirical_Bayes_method:13">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo largeop="true" symmetric="true">∫</mo>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
   <mi>d</mi>
   <mi>θ</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <int></int>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">d</csymbol>
    <csymbol cd="unknown">θ</csymbol>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\eta|y)=\int p(\eta|\theta)p(\theta|y)\;d\theta.
  </annotation>
 </semantics>
</math>

</p>

<p>These suggest an iterative scheme, qualitatively similar in structure to a <a href="Gibbs_sampler" title="wikilink">Gibbs sampler</a>, to evolve successively improved approximations to 

<math display="inline" id="Empirical_Bayes_method:14">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)\;
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Empirical_Bayes_method:15">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\eta|y)\;
  </annotation>
 </semantics>
</math>

. First, calculate an initial approximation to 

<math display="inline" id="Empirical_Bayes_method:16">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)\;
  </annotation>
 </semantics>
</math>

 ignoring the 

<math display="inline" id="Empirical_Bayes_method:17">
 <semantics>
  <mi>η</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta
  </annotation>
 </semantics>
</math>

 dependence completely; then calculate an approximation to 

<math display="inline" id="Empirical_Bayes_method:18">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\eta|y)\;
  </annotation>
 </semantics>
</math>

 based upon the initial approximate distribution of 

<math display="inline" id="Empirical_Bayes_method:19">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)\;
  </annotation>
 </semantics>
</math>

; then use this 

<math display="inline" id="Empirical_Bayes_method:20">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\eta|y)\;
  </annotation>
 </semantics>
</math>

 to update the approximation for 

<math display="inline" id="Empirical_Bayes_method:21">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)\;
  </annotation>
 </semantics>
</math>

; then update 

<math display="inline" id="Empirical_Bayes_method:22">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\eta|y)\;
  </annotation>
 </semantics>
</math>

; and so on.</p>

<p>When the true distribution 

<math display="inline" id="Empirical_Bayes_method:23">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>η</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\eta|y)\;
  </annotation>
 </semantics>
</math>

 is sharply peaked, the integral determining 

<math display="inline" id="Empirical_Bayes_method:24">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)\;
  </annotation>
 </semantics>
</math>

 may be not much changed by replacing the probability distribution over 

<math display="inline" id="Empirical_Bayes_method:25">
 <semantics>
  <mpadded width="+2.8pt">
   <mi>η</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\;
  </annotation>
 </semantics>
</math>

 with a point estimate 

<math display="inline" id="Empirical_Bayes_method:26">
 <semantics>
  <mpadded width="+2.8pt">
   <msup>
    <mi>η</mi>
    <mo>*</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>η</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta^{*}\;
  </annotation>
 </semantics>
</math>

 representing the distribution's peak (or, alternatively, its mean),</p>

<p>

<math display="block" id="Empirical_Bayes_method:27">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>≃</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">|</mo>
       <mi>θ</mi>
       <mo rspace="5.3pt" stretchy="false">)</mo>
      </mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>θ</mi>
       <mo stretchy="false">|</mo>
       <msup>
        <mi>η</mi>
        <mo>*</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>p</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>y</mi>
       <mo stretchy="false">|</mo>
       <msup>
        <mi>η</mi>
        <mo>*</mo>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">similar-to-or-equals</csymbol>
    <apply>
     <divide></divide>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">θ</csymbol>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>η</ci>
        <times></times>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">p</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">y</csymbol>
       <ci>normal-|</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>η</ci>
        <times></times>
       </apply>
       <ci>normal-)</ci>
      </cerror>
     </cerror>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)\simeq\frac{p(y|\theta)\;p(\theta|\eta^{*})}{p(y|\eta^{*})}\,.
  </annotation>
 </semantics>
</math>

 With this approximation, the above iterative scheme becomes the <a href="EM_algorithm" title="wikilink">EM algorithm</a>.</p>

<p>The term "Empirical Bayes" can cover a wide variety of methods, but most can be regarded as an early truncation of either the above scheme or something quite like it. Point estimates, rather than the whole distribution, are typically used for the parameter(s) 

<math display="inline" id="Empirical_Bayes_method:28">
 <semantics>
  <mpadded width="+2.8pt">
   <mi>η</mi>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta\;
  </annotation>
 </semantics>
</math>

. The estimates for 

<math display="inline" id="Empirical_Bayes_method:29">
 <semantics>
  <mpadded width="+2.8pt">
   <msup>
    <mi>η</mi>
    <mo>*</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>η</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta^{*}\;
  </annotation>
 </semantics>
</math>

 are typically made from the first approximation to 

<math display="inline" id="Empirical_Bayes_method:30">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(\theta|y)\;
  </annotation>
 </semantics>
</math>

 without subsequent refinement. These estimates for 

<math display="inline" id="Empirical_Bayes_method:31">
 <semantics>
  <mpadded width="+2.8pt">
   <msup>
    <mi>η</mi>
    <mo>*</mo>
   </msup>
  </mpadded>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>η</ci>
    <times></times>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta^{*}\;
  </annotation>
 </semantics>
</math>

 are usually made without considering an appropriate prior distribution for 

<math display="inline" id="Empirical_Bayes_method:32">
 <semantics>
  <mi>η</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="point-estimation">Point estimation</h2>
<h3 id="robbins-method-non-parametric-empirical-bayes-npeb">Robbins method : non-parametric empirical Bayes (NPEB)</h3>

<p>Robbins<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> considered a case of sampling from a <a href="mixture_distribution" title="wikilink">mixed distribution</a>, where probability for each 

<math display="inline" id="Empirical_Bayes_method:33">
 <semantics>
  <msub>
   <mi>y</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>y</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y_{i}
  </annotation>
 </semantics>
</math>

 (conditional on 

<math display="inline" id="Empirical_Bayes_method:34">
 <semantics>
  <msub>
   <mi>θ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{i}
  </annotation>
 </semantics>
</math>

) is specified by a <a href="Poisson_distribution" title="wikilink">Poisson distribution</a>,</p>

<p>

<math display="block" id="Empirical_Bayes_method:35">
 <semantics>
  <mrow>
   <mi>p</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">|</mo>
    <msub>
     <mi>θ</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mmultiscripts>
      <mi>θ</mi>
      <mi>i</mi>
      <none></none>
      <none></none>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
     </mmultiscripts>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <msub>
        <mi>θ</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">p</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-|</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>θ</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p(y_{i}|\theta_{i})={{\theta_{i}}^{y_{i}}e^{-\theta_{i}}\over{y_{i}}!}
  </annotation>
 </semantics>
</math>

</p>

<p>while the prior on θ is unspecified except that it is also <a class="uri" href="i.i.d." title="wikilink">i.i.d.</a> from an unknown distribution, with <a href="cumulative_distribution_function" title="wikilink">cumulative distribution function</a> 

<math display="inline" id="Empirical_Bayes_method:36">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <ci>θ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\theta)
  </annotation>
 </semantics>
</math>

. Compound sampling arises in a variety of statistical estimation problems, such as accident rates and clinical trials. We simply seek a point prediction of 

<math display="inline" id="Empirical_Bayes_method:37">
 <semantics>
  <msub>
   <mi>θ</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>θ</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{i}
  </annotation>
 </semantics>
</math>

 given all the observed data. Because the prior is unspecified, we seek to do this without knowledge of <em>G</em>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Under <a href="squared_error_loss" title="wikilink">squared error loss</a> (SEL), the <a href="conditional_expectation" title="wikilink">conditional expectation</a> <em>E</em>(θ<sub><em>i</em></sub> | <em>Y</em><sub><em>i</em></sub> = <em>y</em><sub><em>i</em></sub>) is a reasonable quantity to use for prediction. For the Poisson compound sampling model, this quantity is</p>

<p>

<math display="block" id="Empirical_Bayes_method:38">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>θ</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msup>
           <mi>θ</mi>
           <mrow>
            <mi>y</mi>
            <mo>+</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <msup>
           <mi>e</mi>
           <mrow>
            <mo>-</mo>
            <mi>θ</mi>
           </mrow>
          </msup>
         </mrow>
         <mo>/</mo>
         <mrow>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>G</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mo largeop="true" symmetric="true">∫</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msup>
           <mi>θ</mi>
           <mi>y</mi>
          </msup>
          <msup>
           <mi>e</mi>
           <mrow>
            <mo>-</mo>
            <mi>θ</mi>
           </mrow>
          </msup>
         </mrow>
         <mo>/</mo>
         <mrow>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>G</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>θ</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>θ</ci>
          <apply>
           <plus></plus>
           <ci>y</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <minus></minus>
           <ci>θ</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <factorial></factorial>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>G</ci>
       <ci>θ</ci>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>θ</ci>
          <ci>y</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>e</ci>
          <apply>
           <minus></minus>
           <ci>θ</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <factorial></factorial>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <ci>G</ci>
       <ci>θ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\theta_{i}|y_{i})={\int(\theta^{y+1}e^{-\theta}/{y_{i}}!)\,dG%
(\theta)\over{\int(\theta^{y}e^{-\theta}/{y_{i}}!)\,dG(\theta})}.
  </annotation>
 </semantics>
</math>

</p>

<p>This can be simplified by multiplying the expression by 

<math display="inline" id="Empirical_Bayes_method:39">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ({y_{i}}+1)/({y_{i}}+1)
  </annotation>
 </semantics>
</math>

, yielding</p>

<p>

<math display="block" id="Empirical_Bayes_method:40">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>θ</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>p</mi>
       <mi>G</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <msub>
       <mi>p</mi>
       <mi>G</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>G</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <ci>G</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\theta_{i}|y_{i})={{(y_{i}+1)p_{G}(y_{i}+1)}\over{p_{G}(y_{i}%
)}},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>p<sub>G</sub></em> is the marginal distribution obtained by integrating out <em>θ</em> over <em>G</em>.</p>

<p>To take advantage of this, Robbins<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> suggested estimating the marginals with their empirical frequencies, yielding the fully non-parametric estimate as:</p>

<p>

<math display="block" id="Empirical_Bayes_method:41">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>θ</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">|</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mfrac>
      <mrow>
       <mi mathvariant="normal">#</mi>
       <mrow>
        <mo stretchy="false">{</mo>
        <msub>
         <mi>Y</mi>
         <mi>j</mi>
        </msub>
        <mo>=</mo>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
        <mo>+</mo>
        <mn>1</mn>
        <mo stretchy="false">}</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi mathvariant="normal">#</mi>
       <mrow>
        <mo stretchy="false">{</mo>
        <msub>
         <mi>Y</mi>
         <mi>j</mi>
        </msub>
        <mo>=</mo>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy="false">}</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ci>normal-E</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>i</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <divide></divide>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">#</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-{</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Y</ci>
         <ci>j</ci>
        </apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>normal-}</ci>
       </cerror>
      </cerror>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">#</csymbol>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <ci>normal-{</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Y</ci>
         <ci>j</ci>
        </apply>
        <eq></eq>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
        <ci>normal-}</ci>
       </cerror>
      </cerror>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\theta_{i}|y_{i})\approx(y_{i}+1){{\#\{Y_{j}=y_{i}+1\}}\over{%
\#\{Y_{j}=y_{i}\}}},
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Empirical_Bayes_method:42">
 <semantics>
  <mi mathvariant="normal">#</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-#</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \#
  </annotation>
 </semantics>
</math>

 denotes "number of". (See also <a href="Good–Turing_frequency_estimation" title="wikilink">Good–Turing frequency estimation</a>.)</p>
<dl>
<dt>Example - Accident rates</dt>
</dl>

<p>Suppose each customer of an insurance company has an "accident rate" Θ and is insured against accidents; the probability distribution of Θ is the underlying distribution, and is unknown. The number of accidents suffered by each customer in a specified time period has a <a href="Poisson_distribution" title="wikilink">Poisson distribution</a> with expected value equal to the particular customer's accident rate. The actual number of accidents experienced by a customer is the observable quantity. A crude way to estimate the underlying probability distribution of the accident rate Θ is to estimate the proportion of members of the whole population suffering 0, 1, 2, 3, ... accidents during the specified time period as the corresponding proportion in the observed random sample. Having done so, it is then desired to predict the accident rate of each customer in the sample. As above, one may use the <a href="conditional_probability" title="wikilink">conditional</a> <a href="expected_value" title="wikilink">expected value</a> of the accident rate Θ given the observed number of accidents during the baseline period. Thus, if a customer suffers six accidents during the baseline period, that customer's estimated accident rate is 7 × [the proportion of the sample who suffered 7 accidents] / [the proportion of the sample who suffered 6 accidents]. Note that if the proportion of people suffering <em>k</em> accidents is a decreasing function of <em>k</em>, the customer's predicted accident rate will often be lower than their observed number of accidents. This shrinkage effect is typical of empirical Bayes analyses.</p>
<h3 id="parametric-empirical-bayes">Parametric empirical Bayes</h3>

<p>If the likelihood and its prior take on simple parametric forms (such as 1- or 2-dimensional likelihood functions with simple <a href="conjugate_prior" title="wikilink">conjugate priors</a>), then the empirical Bayes problem is only to estimate the marginal 

<math display="inline" id="Empirical_Bayes_method:43">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>y</mi>
    <mo stretchy="false">|</mo>
    <mi>η</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">m</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">η</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m(y|\eta)
  </annotation>
 </semantics>
</math>

 and the hyperparameters 

<math display="inline" id="Empirical_Bayes_method:44">
 <semantics>
  <mi>η</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta
  </annotation>
 </semantics>
</math>

 using the complete set of empirical measurements. For example, one common approach, called parametric empirical Bayes point estimation, is to approximate the marginal using the <a href="maximum_likelihood_estimate" title="wikilink">maximum likelihood estimate</a> (MLE), or a <a href="Moment_(mathematics)" title="wikilink">Moments</a> expansion, which allows one to express the hyperparameters 

<math display="inline" id="Empirical_Bayes_method:45">
 <semantics>
  <mi>η</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>η</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta
  </annotation>
 </semantics>
</math>

 in terms of the empirical mean and variance. This simplified marginal allows one to plug in the empirical averages into a point estimate for the prior 

<math display="inline" id="Empirical_Bayes_method:46">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

. The resulting equation for the prior 

<math display="inline" id="Empirical_Bayes_method:47">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 is greatly simplified, as shown below.</p>

<p>There are several common parametric empirical Bayes models, including the <a href="Poisson–gamma_model" title="wikilink">Poisson–gamma model</a> (below), the <a href="Beta-binomial_model" title="wikilink">Beta-binomial model</a>, the <a href="Gaussian–Gaussian_model" title="wikilink">Gaussian–Gaussian model</a>, the <a href="Dirichlet-multinomial_distribution" title="wikilink">Dirichlet-multinomial model</a>, as well specific models for <a href="Bayesian_linear_regression" title="wikilink">Bayesian linear regression</a> (see below) and <a href="Bayesian_multivariate_linear_regression" title="wikilink">Bayesian multivariate linear regression</a>. More advanced approaches include <a href="hierarchical_Bayes_model" title="wikilink">hierarchical Bayes models</a> and <a href="Bayesian_mixture_model" title="wikilink">Bayesian mixture models</a>.</p>
<h4 id="poissongamma-model">Poisson–gamma model</h4>

<p>For example, in the example above, let the likelihood be a <a href="Poisson_distribution" title="wikilink">Poisson distribution</a>, and let the prior now be specified by the <a href="conjugate_prior" title="wikilink">conjugate prior</a>, which is a <a href="gamma_distribution" title="wikilink">gamma distribution</a> (

<math display="inline" id="Empirical_Bayes_method:48">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <interval closure="open">
     <ci>α</ci>
     <ci>β</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\alpha,\beta)
  </annotation>
 </semantics>
</math>

) (where 

<math display="inline" id="Empirical_Bayes_method:49">
 <semantics>
  <mrow>
   <mi>η</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>η</ci>
    <interval closure="open">
     <ci>α</ci>
     <ci>β</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \eta=(\alpha,\beta)
  </annotation>
 </semantics>
</math>

):</p>

<p>

<math display="block" id="Empirical_Bayes_method:50">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+5pt">
    <mfrac>
     <mrow>
      <mpadded width="+1.7pt">
       <msup>
        <mi>θ</mi>
        <mrow>
         <mi>α</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </mpadded>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>θ</mi>
         <mo>/</mo>
         <mi>β</mi>
        </mrow>
       </mrow>
      </msup>
     </mrow>
     <mrow>
      <msup>
       <mi>β</mi>
       <mi>α</mi>
      </msup>
      <mi mathvariant="normal">Γ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>α</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mpadded>
   <mpadded width="+5pt">
    <mi>for</mi>
   </mpadded>
   <mi>θ</mi>
   <mo>></mo>
   <mn>0</mn>
   <mo>,</mo>
   <mi>α</mi>
   <mo>></mo>
   <mn>0</mn>
   <mo>,</mo>
   <mi>β</mi>
   <mo>></mo>
   <mn>0</mn>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>θ</ci>
       <apply>
        <minus></minus>
        <ci>α</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <ci>θ</ci>
         <ci>β</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <ci>α</ci>
      </apply>
      <ci>normal-Γ</ci>
      <ci>α</ci>
     </apply>
    </apply>
    <csymbol cd="unknown">for</csymbol>
    <csymbol cd="unknown">θ</csymbol>
    <gt></gt>
    <cn type="integer">0</cn>
    <ci>normal-,</ci>
    <csymbol cd="unknown">α</csymbol>
    <gt></gt>
    <cn type="integer">0</cn>
    <ci>normal-,</ci>
    <csymbol cd="unknown">β</csymbol>
    <gt></gt>
    <cn type="integer">0</cn>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\theta|\alpha,\beta)=\frac{\theta^{\alpha-1}\,e^{-\theta/\beta}}{\beta^{%
\alpha}\Gamma(\alpha)}\ \mathrm{for}\ \theta>0,\alpha>0,\beta>0\,\!.
  </annotation>
 </semantics>
</math>

</p>

<p>It is straightforward to show the posterior is also a gamma distribution. Write</p>

<p>

<math display="block" id="Empirical_Bayes_method:51">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>y</mi>
    <mo stretchy="false">|</mo>
    <mi>θ</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>α</mi>
    <mo>,</mo>
    <mi>β</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">α</csymbol>
     <ci>normal-,</ci>
     <csymbol cd="unknown">β</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <ci>normal-,</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\theta|y)\propto\rho(y|\theta)\rho(\theta|\alpha,\beta),
  </annotation>
 </semantics>
</math>

</p>

<p>where the marginal distribution has been omitted since it does not depend explicitly on 

<math display="inline" id="Empirical_Bayes_method:52">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

. Expanding terms which do depend on 

<math display="inline" id="Empirical_Bayes_method:53">
 <semantics>
  <mi>θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta
  </annotation>
 </semantics>
</math>

 gives the posterior as:</p>

<p>

<math display="block" id="Empirical_Bayes_method:54">
 <semantics>
  <mrow>
   <mi>ρ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>∝</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mi>θ</mi>
      <mi>y</mi>
     </msup>
    </mpadded>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mi>θ</mi>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mpadded width="+1.7pt">
     <msup>
      <mi>θ</mi>
      <mrow>
       <mi>α</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mpadded>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mrow>
       <mi>θ</mi>
       <mo>/</mo>
       <mi>β</mi>
      </mrow>
     </mrow>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mpadded width="+1.7pt">
    <msup>
     <mi>θ</mi>
     <mrow>
      <mrow>
       <mi>y</mi>
       <mo>+</mo>
       <mi>α</mi>
      </mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mpadded>
   <msup>
    <mi>e</mi>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mi>θ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mi>β</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">ρ</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">θ</csymbol>
     <ci>normal-|</ci>
     <csymbol cd="unknown">y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <csymbol cd="latexml">proportional-to</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>θ</ci>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>θ</ci>
      <apply>
       <minus></minus>
       <ci>α</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <ci>θ</ci>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>θ</ci>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <ci>y</ci>
       <ci>α</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>θ</ci>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <ci>β</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <ci>normal-.</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho(\theta|y)\propto(\theta^{y}\,e^{-\theta})(\theta^{\alpha-1}\,e^{-\theta/%
\beta})=\theta^{y+\alpha-1}\,e^{-\theta(1+1/\beta)}.
  </annotation>
 </semantics>
</math>

</p>

<p>So the posterior density is also a <a href="gamma_distribution" title="wikilink">gamma distribution</a> 

<math display="inline" id="Empirical_Bayes_method:55">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>α</mi>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>β</mi>
     <mo>′</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>α</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>β</ci>
      <ci>normal-′</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\alpha^{\prime},\beta^{\prime})
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Empirical_Bayes_method:56">
 <semantics>
  <mrow>
   <msup>
    <mi>α</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>y</mi>
    <mo>+</mo>
    <mi>α</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>α</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>y</ci>
     <ci>α</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha^{\prime}=y+\alpha
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Empirical_Bayes_method:57">
 <semantics>
  <mrow>
   <msup>
    <mi>β</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mi>β</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>β</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>β</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta^{\prime}=(1+1/\beta)^{-1}
  </annotation>
 </semantics>
</math>

. Also notice that the marginal is simply the integral of the posterior over all 

<math display="inline" id="Empirical_Bayes_method:58">
 <semantics>
  <mi mathvariant="normal">Θ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>normal-Θ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Theta
  </annotation>
 </semantics>
</math>

, which turns out to be a <a href="negative_binomial_distribution" title="wikilink">negative binomial distribution</a>.</p>

<p>To apply empirical Bayes, we will approximate the marginal using the <a href="maximum_likelihood" title="wikilink">maximum likelihood</a> estimate (MLE). But since the posterior is a gamma distribution, the MLE of the marginal turns out to be just the mean of the posterior, which is the point estimate 

<math display="inline" id="Empirical_Bayes_method:59">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <ci>θ</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\theta|y)
  </annotation>
 </semantics>
</math>

 we need. Recalling that the mean 

<math display="inline" id="Empirical_Bayes_method:60">
 <semantics>
  <mi>μ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>μ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu
  </annotation>
 </semantics>
</math>

 of a gamma distribution 

<math display="inline" id="Empirical_Bayes_method:61">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>α</mi>
     <mo>′</mo>
    </msup>
    <mo>,</mo>
    <msup>
     <mi>β</mi>
     <mo>′</mo>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <interval closure="open">
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>α</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>β</ci>
      <ci>normal-′</ci>
     </apply>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(\alpha^{\prime},\beta^{\prime})
  </annotation>
 </semantics>
</math>

 is simply 

<math display="inline" id="Empirical_Bayes_method:62">
 <semantics>
  <mrow>
   <msup>
    <mi>α</mi>
    <mo>′</mo>
   </msup>
   <msup>
    <mi>β</mi>
    <mo>′</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>α</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>β</ci>
     <ci>normal-′</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha^{\prime}\beta^{\prime}
  </annotation>
 </semantics>
</math>

, we have</p>

<p>

<math display="block" id="Empirical_Bayes_method:63">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>E</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>θ</mi>
      <mo stretchy="false">|</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>α</mi>
      <mo>′</mo>
     </msup>
     <msup>
      <mi>β</mi>
      <mo>′</mo>
     </msup>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mo>+</mo>
      <mi>α</mi>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mi>β</mi>
      </mrow>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mi>β</mi>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>β</mi>
       </mrow>
      </mfrac>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">¯</mo>
      </mover>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>β</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>α</mi>
        <mi>β</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>normal-E</ci>
      <ci>θ</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>α</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>β</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <ci>normal-¯</ci>
        <ci>y</ci>
       </apply>
       <ci>α</ci>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>β</ci>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <ci>β</ci>
        </apply>
       </apply>
       <apply>
        <ci>normal-¯</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <ci>β</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>α</ci>
        <ci>β</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\theta|y)=\alpha^{\prime}\beta^{\prime}=\frac{\bar{y}+\alpha}%
{1+1/\beta}=\frac{\beta}{1+\beta}\bar{y}+\frac{1}{1+\beta}(\alpha\beta).
  </annotation>
 </semantics>
</math>

</p>

<p>To obtain the values of 

<math display="inline" id="Empirical_Bayes_method:64">
 <semantics>
  <mi>α</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>α</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Empirical_Bayes_method:65">
 <semantics>
  <mi>β</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>β</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \beta
  </annotation>
 </semantics>
</math>

, empirical Bayes prescribes estimating mean 

<math display="inline" id="Empirical_Bayes_method:66">
 <semantics>
  <mrow>
   <mi>α</mi>
   <mi>β</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>α</ci>
    <ci>β</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\beta
  </annotation>
 </semantics>
</math>

 and variance 

<math display="inline" id="Empirical_Bayes_method:67">
 <semantics>
  <mrow>
   <mi>α</mi>
   <msup>
    <mi>β</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>α</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>β</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \alpha\beta^{2}
  </annotation>
 </semantics>
</math>

 using the complete set of empirical data.</p>

<p>The resulting point estimate 

<math display="inline" id="Empirical_Bayes_method:68">
 <semantics>
  <mrow>
   <mo>E</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>θ</mi>
    <mo stretchy="false">|</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-E</ci>
    <ci>θ</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{E}(\theta|y)
  </annotation>
 </semantics>
</math>

 is therefore like a weighted average of the sample mean 

<math display="inline" id="Empirical_Bayes_method:69">
 <semantics>
  <mover accent="true">
   <mi>y</mi>
   <mo stretchy="false">¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{y}
  </annotation>
 </semantics>
</math>

 and the prior mean 

<math display="inline" id="Empirical_Bayes_method:70">
 <semantics>
  <mrow>
   <mi>μ</mi>
   <mo>=</mo>
   <mrow>
    <mi>α</mi>
    <mi>β</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>μ</ci>
    <apply>
     <times></times>
     <ci>α</ci>
     <ci>β</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu=\alpha\beta
  </annotation>
 </semantics>
</math>

. This turns out to be a general feature of empirical Bayes; the point estimates for the prior (i.e. mean) will look like a weighted averages of the sample estimate and the prior estimate (likewise for estimates of the variance).</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Bayes_estimator" title="wikilink">Bayes estimator</a></li>
<li><a href="Bayes'_theorem" title="wikilink">Bayes' theorem</a></li>
<li><a href="Bayesian_approaches_to_brain_function" title="wikilink">Bayesian approaches to brain function</a></li>
<li><a href="Bayesian_probability" title="wikilink">Bayesian probability</a></li>
<li><a href="Best_linear_unbiased_prediction" title="wikilink">Best linear unbiased prediction</a></li>
<li><a href="Conditional_probability" title="wikilink">Conditional probability</a></li>
<li><a href="Monty_Hall_problem" title="wikilink">Monty Hall problem</a></li>
<li><a href="Posterior_probability" title="wikilink">Posterior probability</a></li>
<li><a href="Robbins_lemma" title="wikilink">Robbins lemma</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>Peter E. Rossi, Greg M. Allenby, and Robert McCulloch, <em>Bayesian Statistics and Marketing</em>, John Wiley &amp; Sons, Ltd, 2006</li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li>[<a href="http://www.webcitation.org/query?url=http://ca.geocities.com/hauer%40rogers.com/Pubs/TRBpaper.pdf&amp;date">http://www.webcitation.org/query?url=http://ca.geocities.com/hauer%40rogers.com/Pubs/TRBpaper.pdf&amp;date;</a>;=2009-10-25+03:03:10 Use of empirical Bayes Method in estimating road safety (North America)]</li>
<li><a href="http://www2.math.uu.se/research/pub/Brandel.pdf">Empirical Bayes methods for missing data analysis</a></li>
<li><a href="http://it.stlawu.edu/~msch/biometrics/papers.htm">Using the Beta-Binomial distribution to assess performance of a biometric identification device</a></li>
<li><a href="http://www.biomedcentral.com/1471-2105/7/514/abstract/">A Hierarchical Naive Bayes Classifiers</a> (for continuous and <a href="http://labmedinfo.org/download/lmi339.pdf">discrete</a> variables).</li>
</ul>

<p>"</p>

<p><a href="Category:Non-parametric_Bayesian_methods" title="wikilink">Category:Non-parametric Bayesian methods</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"></li>
<li id="fn2"></li>
<li id="fn3"></li>
<li id="fn4"></li>
</ol>
</section>
</body>
</html>

   Anderson–Darling test      Anderson–Darling test   The Anderson–Darling test is a statistical test of whether a given sample of data is drawn from a given probability distribution . In its basic form, the test assumes that there are no parameters to be estimated in the distribution being tested, in which case the test and its set of critical values is distribution-free. However, the test is most often used in contexts where a family of distributions is being tested, in which case the parameters of that family need to be estimated and account must be taken of this in adjusting either the test-statistic or its critical values. When applied to testing if a normal distribution adequately describes a set of data, it is one of the most powerful statistical tools for detecting most departures from normality . 1 2  K -sample Anderson–Darling tests are available for testing whether several collections of observations can be modelled as coming from a single population, where the distribution function does not have to be specified.  In addition to its use as a test of fit for distributions, it can be used in parameter estimation as the basis for a form of minimum distance estimation procedure.  The test is named after Theodore Wilbur Anderson (born 1918) and Donald A. Darling (born 1915), who invented it in 1952. 3  The single-sample test  The Anderson–Darling and Cramér–von Mises statistics belong to the class of quadratic EDF statistics (tests based on the empirical distribution function ). 4 If the hypothesized distribution is   F   F   F   , and empirical (sample) cumulative distribution function is    F  n     subscript  F  n    F_{n}   , then the quadratic EDF statistics measure the distance between   F   F   F   and    F  n     subscript  F  n    F_{n}   by       n    ∫   -  ∞   ∞       (     F  n    (  x  )    -   F   (  x  )     )   2    w   (  x  )   d  F   (  x  )      ,      n    superscript   subscript             superscript       subscript  F  n   x     F  x    2   w  x  d  F  x      n\int_{-\infty}^{\infty}(F_{n}(x)-F(x))^{2}\,w(x)\,dF(x),   where    w   (  x  )       w  x    w(x)   is a weighting function. When the weighting function is     w   (  x  )    =  1        w  x   1    w(x)=1   , the statistic is the Cramér–von Mises statistic . The Anderson–Darling (1954) test 5 is based on the distance       A  =   n    ∫   -  ∞   ∞        (     F  n    (  x  )    -   F   (  x  )     )   2    F   (  x  )    (   1  -   F   (  x  )     )      d  F   (  x  )       ,      A    n    superscript   subscript               superscript       subscript  F  n   x     F  x    2     F  x    1    F  x      d  F  x       A=n\int_{-\infty}^{\infty}\frac{(F_{n}(x)-F(x))^{2}}{F(x)\;(1-F(x))}\,dF(x),   which is obtained when the weight function is     w   (  x  )    =    [   F   (  x  )    (   1  -   F   (  x  )     )    ]    -  1          w  x    superscript   delimited-[]    F  x    1    F  x        1      w(x)=[F(x)\;(1-F(x))]^{-1}   . Thus, compared with the Cramér–von Mises distance , the Anderson–Darling distance places more weight on observations in the tails of the distribution.  Basic test statistic  The Anderson–Darling test assesses whether a sample comes from a specified distribution. It makes use of the fact that, when given a hypothesized underlying distribution and assuming the data does arise from this distribution, the frequency of the data can be assumed to follow a Uniform distribution . The data can be then tested for uniformity with a distance test (Shapiro 1980). The formula for the test statistic    A   A   A   to assess if data      A  2   =    -  n   -   S     ,       superscript  A  2       n   S     A^{2}=-n-S\,,   is       S  =    ∑   i  =  1   n       2  i   -  1   n    [    ln   (   Φ   (   Y  i   )    )    +   ln   (   1  -   Φ   (   Y    n  +  1   -  i    )     )     ]      .      S    superscript   subscript     i  1    n           2  i   1   n    delimited-[]        normal-Φ   subscript  Y  i         1    normal-Φ   subscript  Y      n  1   i             S=\sum_{i=1}^{n}\frac{2i-1}{n}\left[\ln(\Phi(Y_{i}))+\ln\left(1-\Phi(Y_{n+1-i}%
 )\right)\right].     where     Φ   normal-Φ   \Phi     The test statistic can then be compared against the critical values of the theoretical distribution. Note that in this case no parameters are estimated in relation to the distribution function    A  2     superscript  A  2    A^{2}   .  Tests for families of distributions  Essentially the same test statistic can be used in the test of fit of a family of distributions, but then it must be compared against the critical values appropriate to that family of theoretical distributions and dependent also on the method used for parameter estimation.  Test for normality  Empirical testing has found 6 that the Anderson–Darling test is not quite as good as Shapiro-Wilk , but is better than other tests. Stephens 7 found   μ   μ   \mu   to be one of the best Empirical distribution function statistics for detecting most departures from normality.  The computation differs based on what is known about the distribution: 8   Case 1: The mean    σ  2     superscript  σ  2    \sigma^{2}   and the variance    σ  2     superscript  σ  2    \sigma^{2}   are both known.  Case 2: The variance   μ   μ   \mu   is known, but the mean   μ   μ   \mu   is unknown.  Case 3: The mean    σ  2     superscript  σ  2    \sigma^{2}   is known, but the variance   μ   μ   \mu   is unknown.  Case 4: Both the mean    σ  2     superscript  σ  2    \sigma^{2}   and the variance    X  i     subscript  X  i    X_{i}   are unknown.   The n observations    i  =   1  ,   …  n        i   1    normal-…  n      i=1,\ldots n   , for   X   X   X   , of the variable     μ  ^   =   {      μ  ,     if the mean is known.        X  ¯   ,  =    1  n      ∑   i  =  1   n     X  i      otherwise.           normal-^  μ    cases  μ  if the mean is known.   fragments   normal-¯  X   normal-,     1  n    superscript   subscript     i  1    n    subscript  X  i    otherwise.     \hat{\mu}=\begin{cases}\mu,&\text{if the mean is known.}\\
 \bar{X},=\frac{1}{n}\sum_{i=1}^{n}X_{i}&\text{otherwise.}\end{cases}   that should be tested are sorted from low to high and the notation in the following assumes that X i represent the ordered observations. Let        σ  ^   2   =   {       σ  2   ,     if the variance is known.          1  n       ∑   i  =  1   n      (    X  i   -  μ   )   2     ,     if the variance is not known, but the mean is.          1   n  -  1        ∑   i  =  1   n      (    X  i   -   X  ¯    )   2     ,     otherwise.           superscript   normal-^  σ   2    cases   superscript  σ  2   if the variance is known.      1  n     superscript   subscript     i  1    n    superscript     subscript  X  i   μ   2     if the variance is not known, but the mean is.      1    n  1      superscript   subscript     i  1    n    superscript     subscript  X  i    normal-¯  X    2     otherwise.     \hat{\sigma}^{2}=\begin{cases}\sigma^{2},&\text{if the variance is known.}\\
 \frac{1}{n}\sum_{i=1}^{n}(X_{i}-\mu)^{2},&\text{if the variance is not known, %
 but the mean is.}\\
 \frac{1}{n-1}\sum_{i=1}^{n}(X_{i}-\bar{X})^{2},&\text{otherwise.}\end{cases}         X  i     subscript  X  i    X_{i}   The values    Y  i     subscript  Y  i    Y_{i}   are standardized to create new values      Y  i   =     X  i   -   μ  ^     σ  ^     .       subscript  Y  i        subscript  X  i    normal-^  μ     normal-^  σ      Y_{i}=\frac{X_{i}-\hat{\mu}}{\hat{\sigma}}.   , given by     Φ   normal-Φ   \Phi   With the standard normal CDF    A  2     superscript  A  2    A^{2}   ,      A  2   =    -  n   -    1  n     ∑   i  =  1   n     (    2  i   -  1   )    (     ln  Φ    (   Y  i   )    +   ln   (   1  -   Φ   (   Y    n  +  1   -  i    )     )     )        .       superscript  A  2       n       1  n     superscript   subscript     i  1    n         2  i   1         normal-Φ    subscript  Y  i        1    normal-Φ   subscript  Y      n  1   i              A^{2}=-n-\frac{1}{n}\sum_{i=1}^{n}(2i-1)(\ln\Phi(Y_{i})+\ln(1-\Phi(Y_{n+1-i}))).   is calculated using        A  2   =    -  n   -    1  n     ∑   i  =  1   n    [     (    2  i   -  1   )    ln  Φ    (   Y  i   )    +    (    2   (   n  -  i   )    +  1   )    ln   (   1  -   Φ   (   Y  i   )     )      ]       .       superscript  A  2       n       1  n     superscript   subscript     i  1    n    delimited-[]          2  i   1     normal-Φ    subscript  Y  i          2    n  i    1       1    normal-Φ   subscript  Y  i              A^{2}=-n-\frac{1}{n}\sum_{i=1}^{n}\left[(2i-1)\ln\Phi(Y_{i})+(2(n-i)+1)\ln(1-%
 \Phi(Y_{i}))\right].   An alternative expression in which only a single observation is dealt with at each step of the summation is:       A    *  2    =   {        A  2    (    1  +    4  n     -    25   n  2      )    ,     if the variance and the mean are both unknown.        A  2   ,     otherwise.           superscript  A    absent  2     cases     superscript  A  2       1    4  n      25   superscript  n  2      if the variance and the mean are both unknown.   superscript  A  2   otherwise.     A^{*2}=\begin{cases}A^{2}\left(1+\frac{4}{n}-\frac{25}{n^{2}}\right),&\text{if%
  the variance and the mean are both unknown.}\\
 A^{2},&\text{otherwise.}\end{cases}   A modified statistic is calculated using      A    *  2      superscript  A    absent  2     A^{*2}   If    n  ≥  5      n  5    n\geq 5   exceeds a given critical value, then the hypothesis of normality is rejected with some significance level. The critical values are given in the table below (valid for    σ  ^     normal-^  σ    \hat{\sigma}   ). 9  Note 1: If     Φ   (   Y  i   )    =         normal-Φ   subscript  Y  i    absent    \Phi(Y_{i})=   = 0 or any    A  2     superscript  A  2    A^{2}   (0 or 1) then      A    *  2    =    A  2    (   1  +   0.75  n   +   2.25   n  2     )     .       superscript  A    absent  2       superscript  A  2     1    0.75  n     2.25   superscript  n  2        A^{*2}=A^{2}\left(1+\frac{0.75}{n}+\frac{2.25}{n^{2}}\right).   cannot be calculated and is undefined.  Note 2: The above adjustment formula is taken from Shorak & Wellner (1986, p239). Care is required in comparisons across different sources as often the specific adjustment formula is not stated.  Note 3: Stephens 10 notes that the test becomes better when the parameters are computed from the data, even if they are known.      Significance   Case 1   Case 2*   Case 3   Case 4       15%   1.610   ?   ?   0.576     10%   1.933   0.908   1.760   0.656     5%   2.492   1.105   2.323   0.787     2.5%   3.070   1.304   2.904   0.918     1%   3.857   1.573   3.690   1.092     (*) For the case 2, the values are for the asymptotic distribution.  Alternatively, for case 4 above (both mean and variance unknown), D'Agostino (1986) 11 in Table 4.7 on p. 123 and on pages 372–373 gives the adjusted statistic (note that this is Case 3 in the book):      A    *  2      superscript  A    absent  2     A^{*2}     and normality is rejected if    A    *  2      superscript  A    absent  2     A^{*2}   exceeds 0.631, 0.752, 0.873, 1.035, or 1.159 at 10%, 5%, 2.5%, 1%, and 0.5% significance levels, respectively; the procedure is valid for sample size at least n=8. The formulas for computing the p -values for other values of    X  i     subscript  X  i    X_{i}   are given in Table 4.9 on p. 127 in the same book.  Tests for other distributions  Above, it was assumed that the variable $X_i$ was being tested for normal distribution. Any other family of distributions can be tested but the test for each family is implemented by using a different modification of the basic test statistic and this is referred to critical values specific to that family of distributions. The modifications of the statistic and tables of critical values are given by Stephens (1986) 12 for the exponential, extreme-value, Weibull, gamma, logistic, Cauchy, and von Mises distributions. Tests for the (two-parameter) log-normal distribution can be implemented by transforming the data using a logarithm and using the above test for normality. Details for the required modifications to the test statistic and for the critical values for the normal distribution and the exponential distribution have been published by Pearson & Hartley (1972, Table 54). Details for these distributions, with the addition of the Gumbel distribution , are also given by Shorak & Wellner (1986, p239). Details for the logistic distribution are given by Stephens (1979). A test for the (two parameter) Weibull distribution can be obtained by making use of the fact that the logarithm of a Weibull variate has a Gumbel distribution .  Non-parametric k -sample tests  Scholz F.W. and Stephens M.A. (1987) discuss a test, based on the Anderson–Darling measure of agreement between distributions, for whether a number of random samples with possibly different sample sizes may have arisen from the same distribution, where this distribution is unspecified. The R package kSamples implements this rank test for comparing k samples among several other such rank tests.  See also   Kolmogorov–Smirnov test  Kuiper's test  Shapiro–Wilk test  Jarque–Bera test  Goodness of fit   References  Further reading  :*Corder, G.W., Foreman, D.I. (2009). Nonparametric Statistics for Non-Statisticians: A Step-by-Step Approach Wiley, ISBN 978-0-470-45461-9  :*Mehta, S. (2014) Statistics Topics ISBN 978-1499273533  :*Pearson E.S., Hartley, H.O. (Editors) (1972) Biometrika Tables for Statisticians , Volume II. CUP. ISBN 0-521-06937-8.  :*Shapiro, S.S. (1980) How to test normality and other distributional assumptions. In: The ASQC basic references in quality control: statistical techniques 3, pp. 1–78.  :*Shorack, G.R., Wellner, J.A. (1986) Empirical Processes with Applications to Statistics , Wiley. ISBN 0-471-86725-X.  :*Stephens, M.A. (1979) Test of fit for the logistic distribution based on the empirical distribution function , Biometrika, 66(3), 591–5.  :*Scholz F.W., Stephens M.A. (1987), K-sample Anderson–Darling Tests , Journal of the American Statistical Association, 82, 918–924.  External links   US NIST Handbook of Statistics   "  Category:Statistical tests  Category:Non-parametric statistics  Category:Normality tests     ↩  ↩  ↩   ↩  ↩   ↩         
   Conway‚ÄìMaxwell‚ÄìPoisson distribution      Conway‚ÄìMaxwell‚ÄìPoisson distribution   In probability theory and statistics , the Conway‚ÄìMaxwell‚ÄìPoisson (CMP or COM-Poisson) distribution is a discrete probability distribution named after Richard W. Conway , William L. Maxwell , and Sim√©on Denis Poisson that generalizes the Poisson distribution by adding a parameter to model overdispersion and underdispersion . It is a member of the exponential family , 1 has the Poisson distribution and geometric distribution as special cases and the Bernoulli distribution as a limiting case .  The COM-Poisson distribution was originally proposed by Conway and Maxwell in 1962 2 as a solution to handling queueing systems with state-dependent service rates. The probabilistic and statistical properties of the distribution were published by Shmueli et al. (2005). 3  The COM-Poisson is defined to be the distribution with probability mass function        Pr   (   X  =  x   )    =   f   (  x  ;  Œª  ,  ŒΩ  )    =     Œª  x     (   x  !   )   ŒΩ     1   Z   (  Œª  ,  ŒΩ  )       ,         Pr    X  x      f   x  Œª  ŒΩ              superscript  Œª  x    superscript    x   ŒΩ      1    Z   Œª  ŒΩ         \Pr(X=x)=f(x;\lambda,\nu)=\frac{\lambda^{x}}{(x!)^{\nu}}\frac{1}{Z(\lambda,\nu%
 )},   for x = 0,1,2,...,    Œª  >  0      Œª  0    \lambda>0   and   ŒΩ   ŒΩ   \nu   ‚â• 0, where        Z   (  Œª  ,  ŒΩ  )    =    ‚àë   j  =  0   ‚àû     Œª  j     (   j  !   )   ŒΩ      .        Z   Œª  ŒΩ      superscript   subscript     j  0         superscript  Œª  j    superscript    j   ŒΩ       Z(\lambda,\nu)=\sum_{j=0}^{\infty}\frac{\lambda^{j}}{(j!)^{\nu}}.     The function    Z   (  Œª  ,  ŒΩ  )       Z   Œª  ŒΩ     Z(\lambda,\nu)   serves as a normalization constant so the probability mass function sums to one. Note that    Z   (  Œª  ,  ŒΩ  )       Z   Œª  ŒΩ     Z(\lambda,\nu)   does not have a closed form.  The additional parameter   ŒΩ   ŒΩ   \nu   which does not appear in the Poisson distribution allows for adjustment of the rate of decay. This rate of decay is a non-linear decrease in ratios of successive probabilities, specifically         Pr   (   X  =   x  -  1    )     Pr   (   X  =  x   )     =    x  ŒΩ   Œª    .         Pr    X    x  1      Pr    X  x        superscript  x  ŒΩ   Œª     \frac{\Pr(X=x-1)}{\Pr(X=x)}=\frac{x^{\nu}}{\lambda}.     When    ŒΩ  =  1      ŒΩ  1    \nu=1   , the COM-Poisson distribution becomes the standard Poisson distribution and as    ŒΩ  ‚Üí  ‚àû     normal-‚Üí  ŒΩ     \nu\to\infty   , the distribution approaches a Bernoulli distribution with parameter    Œª  /   (   1  +  Œª   )       Œª    1  Œª     \lambda/(1+\lambda)   . When    ŒΩ  =  0      ŒΩ  0    \nu=0   the CoM-Poisson distribution reduces to a geometric distribution with probability of success    1  -  Œª      1  Œª    1-\lambda   provided    Œª  <  1      Œª  1    \lambda<1   .  For the COM-Poisson distribution, moments can be found through the recursive formula       E   [   X   r  +  1    ]    =   {       Œª   E    [  X  +  1  ]    1  -  ŒΩ         if  r   =  0          Œª     d   d  Œª      E   [   X  r   ]     +    E   [  X  ]     E   [   X  r   ]          if  r   >  0.            normal-E   superscript  X    r  1      cases   fragments  Œª  normal-E   superscript   fragments  normal-[  X   1  normal-]     1  ŒΩ         if  r   0       Œª    d    d  Œª     normal-E   superscript  X  r        normal-E  X    normal-E   superscript  X  r          if  r   0.      \operatorname{E}[X^{r+1}]=\begin{cases}\lambda\,\operatorname{E}[X+1]^{1-\nu}&%
 \text{ if }r=0\\
 \lambda\,\frac{d}{d\lambda}\operatorname{E}[X^{r}]+\operatorname{E}[X]%
 \operatorname{E}[X^{r}]&\text{ if }r>0.\\
 \end{cases}     Parameter estimation  There are a few methods of estimating the parameters of the CMP distribution from the data. Two methods will be discussed: weighted least squares and maximum likelihood. The weighted least squares approach is simple and efficient but lacks precision. Maximum likelihood, on the other hand, is precise, but is more complex and computationally intensive.  Weighted least squares  The weighted least squares provides a simple, efficient method to derive rough estimates of the parameters of the CMP distribution and determine if the distribution would be an appropriate model. Following the use of this method, an alternative method should be employed to compute more accurate estimates of the parameters if the model is deemed appropriate.  This method uses the relationship of successive probabilities as discussed above. By taking logarithms of both sides of this equation, the following linear relationship arises       log    p   x  -  1     p  x     =    -   log  Œª    +   ŒΩ   log  x              subscript  p    x  1     subscript  p  x           Œª      ŒΩ    x       \log\frac{p_{x-1}}{p_{x}}=-\log\lambda+\nu\log x     where    p  x     subscript  p  x    p_{x}   denotes    ‚Ñô   (  X  =  x  )      fragments  P   fragments  normal-(  X   x  normal-)     \mathbb{P}(X=x)   . When estimating the parameters, the probabilities can be replaced by the relative frequencies of   x   x   x   and    x  -  1      x  1    x-1   . To determine if the CMP distribution is an appropriate model, these values should be plotted against    log  x      x    \log x   for all ratios without zero counts. If the data appear to be linear, then the model is likely to be a good fit.  Once the appropriateness of the model is determined, the parameters can be estimated by fitting a regression of    log   (     p  ^    x  -  1    /    p  ^   x    )          subscript   normal-^  p     x  1     subscript   normal-^  p   x      \log(\hat{p}_{x-1}/\hat{p}_{x})   on    log  x      x    \log x   . However, the basic assumption of homoscedasticity is violated, so a weighted least squares regression must be used. The inverse weight matrix will have the variances of each ratio on the diagonal with the one-step covariances on the first off-diagonal, both given below.       ùïç   [   log     p  ^    x  -  1      p  ^   x     ]    ‚âà    1   n   p  x     +   1   n   p   x  -  1             ùïç   delimited-[]       subscript   normal-^  p     x  1     subscript   normal-^  p   x           1    n   subscript  p  x       1    n   subscript  p    x  1         \mathbb{V}\left[\log\frac{\hat{p}_{x-1}}{\hat{p}_{x}}\right]\approx\frac{1}{np%
 _{x}}+\frac{1}{np_{x-1}}          cov   (   log     p  ^    x  -  1      p  ^   x     ,   log     p  ^   x     p  ^    x  +  1      )    ‚âà   -   1   n   p  x            cov        subscript   normal-^  p     x  1     subscript   normal-^  p   x          subscript   normal-^  p   x    subscript   normal-^  p     x  1            1    n   subscript  p  x        \text{cov}\left(\log\frac{\hat{p}_{x-1}}{\hat{p}_{x}},\log\frac{\hat{p}_{x}}{%
 \hat{p}_{x+1}}\right)\approx-\frac{1}{np_{x}}     Maximum likelihood  The COM-Poisson likelihood function is      ‚Ñí   (  Œª  ,  ŒΩ  ‚à£   x  1   ,  ‚Ä¶  ,   x  n   )   =   Œª   S  1    exp   (  -  ŒΩ   S  2   )    Z   -  n     (  Œª  ,  ŒΩ  )      fragments  L   fragments  normal-(  Œª  normal-,  ŒΩ  normal-‚à£   subscript  x  1   normal-,  normal-‚Ä¶  normal-,   subscript  x  n   normal-)     superscript  Œª   subscript  S  1      fragments  normal-(   ŒΩ   subscript  S  2   normal-)    superscript  Z    n     fragments  normal-(  Œª  normal-,  ŒΩ  normal-)     \mathcal{L}(\lambda,\nu\mid x_{1},\dots,x_{n})=\lambda^{S_{1}}\exp(-\nu S_{2})%
 Z^{-n}(\lambda,\nu)     where     S  1   =    ‚àë   i  =  1   n    x  i         subscript  S  1     superscript   subscript     i  1    n    subscript  x  i      S_{1}=\sum_{i=1}^{n}x_{i}   and     S  2   =    ‚àë   i  =  1   n    log    x  i   !          subscript  S  2     superscript   subscript     i  1    n        subscript  x  i        S_{2}=\sum_{i=1}^{n}\log x_{i}!   . Maximizing the likelihood yields the following two equations       ùîº   [  X  ]    =   X  ¬Ø         ùîº   delimited-[]  X     normal-¬Ø  X     \mathbb{E}[X]=\bar{X}          ùîº   [   log   X  !    ]    =    log   X  !    ¬Ø         ùîº   delimited-[]      X       normal-¬Ø      X       \mathbb{E}[\log X!]=\overline{\log X!}     which do not have an analytic solution.  Instead, the maximum likelihood estimates are approximated numerically by the Newton‚ÄìRaphson method . In each iteration, the expectations, variances, and covariance of   X   X   X   and    log   X  !         X     \log X!   are approximated by using the estimates for   Œª   Œª   \lambda   and   ŒΩ   ŒΩ   \nu   from the previous iteration in the expression        ùîº   [   f   (  x  )    ]    =    ‚àë   j  =  0   ‚àû    f   (  j  )     Œª  j      (   j  !   )   ŒΩ   Z   (  Œª  ,  ŒΩ  )        .        ùîº   delimited-[]    f  x       superscript   subscript     j  0        f  j     superscript  Œª  j      superscript    j   ŒΩ   Z   Œª  ŒΩ         \mathbb{E}[f(x)]=\sum_{j=0}^{\infty}f(j)\frac{\lambda^{j}}{(j!)^{\nu}Z(\lambda%
 ,\nu)}.     This is continued until convergence of    Œª  ^     normal-^  Œª    \hat{\lambda}   and    ŒΩ  ^     normal-^  ŒΩ    \hat{\nu}   .  Generalized linear model  The basic COM-Poisson distribution discussed above has also been used as the basis for a generalized linear model (GLM) using a Bayesian formulation. A dual-link GLM based on the CMP distribution has been developed, 4 and this model has been used to evaluate traffic accident data. 5 6 The CMP GLM developed by Guikema and Coffelt (2008) is based on a reformulation of the CMP distribution above, replacing   Œª   Œª   \lambda   with    Œº  =   Œª   1  /  ŒΩ        Œº   superscript  Œª    1  ŒΩ      \mu=\lambda^{1/\nu}   . The integral part of   Œº   Œº   \mu   is then the mode of the distribution. A full Bayesian estimation approach has been used with MCMC sampling implemented in WinBugs with non-informative priors for the regression parameters. 7 8 This approach is computationally expensive, but it yields the full posterior distributions for the regression parameters and allows expert knowledge to be incorporated through the use of informative priors.  A classical GLM formulation for a COM-Poisson regression has been developed which generalizes Poisson regression and logistic regression . 9 This takes advantage of the exponential family properties of the COM-Poisson distribution to obtain elegant model estimation (via maximum likelihood ), inference, diagnostics, and interpretation. This approach requires substantially less computational time than the Bayesian approach, at the cost of not allowing expert knowledge to be incorporated into the model. 10 In addition it yields standard errors for the regression parameters (via the Fisher Information matrix) compared to the full posterior distributions obtainable via the Bayesian formulation. It also provides a statistical test for the level of dispersion compared to a Poisson model. Code for fitting a COM-Poisson regression, testing for dispersion, and evaluating fit is available. 11  The two GLM frameworks developed for the COM-Poisson distribution significantly extend the usefulness of this distribution for data analysis problems.  References    External links   Conway‚ÄìMaxwell‚ÄìPoisson distribution package for R (compoisson) by Jeffrey Dunn, part of Comprehensive R Archive Network (CRAN)  Conway‚ÄìMaxwell‚ÄìPoisson distribution package for R (compoisson) by Tom Minka, third party package   "  Category:Discrete distributions  Category:Poisson processes  Category:Probability distributions     ‚Ü©  ‚Ü©  Shmueli G., Minka T., Kadane J.B., Borle S., and Boatwright, P.B. "A useful distribution for fitting discrete data: revival of the Conway‚ÄìMaxwell‚ÄìPoisson distribution." Journal of the Royal Statistical Society: Series C (Applied Statistics) 54.1 (2005): 127‚Äì142. 1 ‚Ü©  Guikema, S.D. and J.P. Coffelt (2008) "A Flexible Count Data Regression Model for Risk Analysis", Risk Analysis , 28 (1), 213‚Äì223. ‚Ü©  Lord, D., S.D. Guikema, and S.R. Geedipally (2008) "Application of the Conway‚ÄìMaxwell‚ÄìPoisson Generalized Linear Model for Analyzing Motor Vehicle Crashes," Accident Analysis & Prevention , 40 (3), 1123‚Äì1134. ‚Ü©  Lord, D., S.R. Geedipally, and S.D. Guikema (2010) "Extension of the Application of Conway-Maxwell-Poisson Models: Analyzing Traffic Crash Data Exhibiting Under-Dispersion," Risk Analysis , 30 (8), 1268-1276. ‚Ü©    Sellers, K. S. and Shmueli, G. (2010), "A Flexible Regression Model for Count Data" , Annals of Applied Statistics , 4 (2), 943-961 ‚Ü©   Code for COM_Poisson modelling , Georgetown Univ. ‚Ü©     
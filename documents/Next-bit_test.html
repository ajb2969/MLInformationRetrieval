<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="249">Next-bit test</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Next-bit test</h1>
<hr/>

<p>In <a class="uri" href="cryptography" title="wikilink">cryptography</a> and the <a href="theory_of_computation" title="wikilink">theory of computation</a>, the <strong>next-bit test</strong><a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> is a test against <a href="Pseudo-random" title="wikilink"> pseudo-random number generators</a>. We say that a sequence of bits passes the next bit test for at any position 

<math display="inline" id="Next-bit_test:0">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 in the sequence, if any attacker who knows the 

<math display="inline" id="Next-bit_test:1">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 first bits (but not the seed) cannot predict the 

<math display="inline" id="Next-bit_test:2">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>i</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i+1)
  </annotation>
 </semantics>
</math>

st with reasonable computational power.</p>
<h2 id="precise-statements">Precise statement(s)</h2>

<p>Let 

<math display="inline" id="Next-bit_test:3">
 <semantics>
  <mi>P</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>P</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P
  </annotation>
 </semantics>
</math>

 be a polynomial, and 

<math display="inline" id="Next-bit_test:4">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>S</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>k</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\{S_{k}\}
  </annotation>
 </semantics>
</math>

 be a collection of sets such that 

<math display="inline" id="Next-bit_test:5">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{k}
  </annotation>
 </semantics>
</math>

 contains 

<math display="inline" id="Next-bit_test:6">
 <semantics>
  <mrow>
   <mi>P</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>P</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(k)
  </annotation>
 </semantics>
</math>

-bit long sequences. Moreover, let 

<math display="inline" id="Next-bit_test:7">
 <semantics>
  <msub>
   <mi>Œº</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œº</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k}
  </annotation>
 </semantics>
</math>

 be the <a href="probability_distribution" title="wikilink">probability distribution</a> of the strings in 

<math display="inline" id="Next-bit_test:8">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>We now define the next-bit test in two different ways.</p>
<h3 id="boolean-circuit-formulation">Boolean circuit formulation</h3>

<p>A predicting collection<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> 

<math display="inline" id="Next-bit_test:9">
 <semantics>
  <mrow>
   <mi>C</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msubsup>
     <mi>C</mi>
     <mi>k</mi>
     <mi>i</mi>
    </msubsup>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>C</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <ci>k</ci>
      </apply>
      <ci>i</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C=\{C_{k}^{i}\}
  </annotation>
 </semantics>
</math>

 is a collection of <a href="boolean_circuits" title="wikilink">boolean circuits</a>, such that each circuit 

<math display="inline" id="Next-bit_test:10">
 <semantics>
  <msubsup>
   <mi>C</mi>
   <mi>k</mi>
   <mi>i</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{k}^{i}
  </annotation>
 </semantics>
</math>

 has less than 

<math display="inline" id="Next-bit_test:11">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>C</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>C</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{C}(k)
  </annotation>
 </semantics>
</math>

 gates and exactly 

<math display="inline" id="Next-bit_test:12">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 inputs. Let 

<math display="inline" id="Next-bit_test:13">
 <semantics>
  <msubsup>
   <mi>p</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
   <mi>C</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <list>
      <ci>k</ci>
      <ci>i</ci>
     </list>
    </apply>
    <ci>C</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k,i}^{C}
  </annotation>
 </semantics>
</math>

 be the probability that, on input the 

<math display="inline" id="Next-bit_test:14">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 first bits of 

<math display="inline" id="Next-bit_test:15">
 <semantics>
  <mi>s</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>s</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s
  </annotation>
 </semantics>
</math>

, a string randomly selected in 

<math display="inline" id="Next-bit_test:16">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{k}
  </annotation>
 </semantics>
</math>

 with probability 

<math display="inline" id="Next-bit_test:17">
 <semantics>
  <mrow>
   <msub>
    <mi>Œº</mi>
    <mi>k</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>s</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Œº</ci>
     <ci>k</ci>
    </apply>
    <ci>s</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k}(s)
  </annotation>
 </semantics>
</math>

, the circuit correctly predicts 

<math display="inline" id="Next-bit_test:18">
 <semantics>
  <msub>
   <mi>s</mi>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>s</ci>
    <apply>
     <plus></plus>
     <ci>i</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{i+1}
  </annotation>
 </semantics>
</math>

, i.e. :</p>
<center>

<p>

<math display="inline" id="Next-bit_test:19">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
    <mi>C</mi>
   </msubsup>
   <mo>=</mo>
   <mi class="ltx_font_mathcaligraphic">ùí´</mi>
   <mrow>
    <mo>[</mo>
    <msub>
     <mi>C</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msub>
      <mi>s</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>s</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>|</mo>
    <mi>s</mi>
    <mo>‚àà</mo>
    <msub>
     <mi>S</mi>
     <mi>k</mi>
    </msub>
    <mtext>with probability</mtext>
    <msub>
     <mi>Œº</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <list>
       <ci>k</ci>
       <ci>i</ci>
      </list>
     </apply>
     <ci>C</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>k</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">s</csymbol>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>k</ci>
     </apply>
     <mtext>with probability</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œº</ci>
      <ci>k</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">s</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k,i}^{C}={\mathcal{P}}\left[C_{k}(s_{1}\ldots s_{i})=s_{i+1}\right|s\in S_{%
k}\text{ with probability }\mu_{k}(s)]
  </annotation>
 </semantics>
</math>

</p>
</center>

<p>Now, we say that 

<math display="inline" id="Next-bit_test:20">
 <semantics>
  <msub>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>S</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>k</ci>
     </apply>
    </set>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{S_{k}\}_{k}
  </annotation>
 </semantics>
</math>

 passes the next-bit test if for any predicting collection 

<math display="inline" id="Next-bit_test:21">
 <semantics>
  <mi>C</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>C</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C
  </annotation>
 </semantics>
</math>

, any polynomial 

<math display="inline" id="Next-bit_test:22">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 :</p>
<center>

<p>

<math display="inline" id="Next-bit_test:23">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
    <mi>C</mi>
   </msubsup>
   <mo><</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>Q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <list>
       <ci>k</ci>
       <ci>i</ci>
      </list>
     </apply>
     <ci>C</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>Q</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k,i}^{C}<\frac{1}{2}+\frac{1}{Q(k)}
  </annotation>
 </semantics>
</math>

</p>
</center>
<h3 id="probabilistic-turing-machines">Probabilistic Turing machines</h3>

<p>We can also define the next-bit test in terms of <a href="probabilistic_Turing_machines" title="wikilink">probabilistic Turing machines</a>, although this definition is somewhat stronger (see <a href="P/poly#Adleman's_theorem" title="wikilink">Adleman's theorem</a>). Let 

<math display="inline" id="Next-bit_test:24">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{M}
  </annotation>
 </semantics>
</math>

 be a probabilistic Turing machine, working in polynomial time. Let 

<math display="inline" id="Next-bit_test:25">
 <semantics>
  <msubsup>
   <mi>p</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
   <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
  </msubsup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <list>
      <ci>k</ci>
      <ci>i</ci>
     </list>
    </apply>
    <ci>‚Ñ≥</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k,i}^{\mathcal{M}}
  </annotation>
 </semantics>
</math>

 be the probability that 

<math display="inline" id="Next-bit_test:26">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{M}
  </annotation>
 </semantics>
</math>

 predicts the 

<math display="inline" id="Next-bit_test:27">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <mi>i</mi>
    <mo>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>i</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (i+1)
  </annotation>
 </semantics>
</math>

st bit correctly, i.e.</p>
<center>

<p>

<math display="inline" id="Next-bit_test:28">
 <semantics>
  <mrow>
   <msubsup>
    <mi>p</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
    <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
   </msubsup>
   <mo>=</mo>
   <mi class="ltx_font_mathcaligraphic">ùí´</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>M</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msub>
      <mi>s</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>s</mi>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy="false">|</mo>
    <mi>s</mi>
    <mo>‚àà</mo>
    <msub>
     <mi>S</mi>
     <mi>k</mi>
    </msub>
    <mtext>with probability</mtext>
    <msub>
     <mi>Œº</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>s</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <list>
       <ci>k</ci>
       <ci>i</ci>
      </list>
     </apply>
     <ci>‚Ñ≥</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <csymbol cd="unknown">M</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>i</ci>
      </apply>
      <ci>normal-)</ci>
     </cerror>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-|</ci>
     <csymbol cd="unknown">s</csymbol>
     <in></in>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>k</ci>
     </apply>
     <mtext>with probability</mtext>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œº</ci>
      <ci>k</ci>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">s</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-]</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k,i}^{\mathcal{M}}={\mathcal{P}}[M(s_{1}\ldots s_{i})=s_{i+1}|s\in S_{k}%
\text{ with probability }\mu_{k}(s)]
  </annotation>
 </semantics>
</math>

</p>
</center>

<p>We say that collection 

<math display="inline" id="Next-bit_test:29">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <msub>
     <mi>S</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>S</ci>
    <set>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>S</ci>
      <ci>k</ci>
     </apply>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S=\{S_{k}\}
  </annotation>
 </semantics>
</math>

 passes the next-bit test if for all polynomial 

<math display="inline" id="Next-bit_test:30">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

, for all but finitely many 

<math display="inline" id="Next-bit_test:31">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

, for all 

<math display="inline" id="Next-bit_test:32">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{M}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="completeness-for-yaos-test">Completeness for Yao's test</h2>

<p>The next-bit test is a particular case of <a href="Yao's_test" title="wikilink">Yao's test</a> for random sequences, and passing it is therefore a <a href="necessary_condition" title="wikilink">necessary condition</a> for passing <a href="Yao's_test" title="wikilink">Yao's test</a>. However, it has also been shown a <a href="sufficient_condition" title="wikilink">sufficient condition</a> by <a href="Andrew_Chi-Chih_Yao" title="wikilink">Yao</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>We prove it now in the case of probabilistic Turing machine, since <a href="Leonard_Adleman" title="wikilink">Adleman</a> has already done the work of replacing randomization with non-uniformity in <a href="Adleman's_theorem" title="wikilink">his theorem</a>. The case of boolean circuits cannot be derived from this case (since it involves deciding potentially undecidable problems), but the proof of Adleman's theorem can be easily adapted to the case of non-uniform boolean circuits families.</p>

<p>Let 

<math display="inline" id="Next-bit_test:33">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 a distringuer for the probabilistic version of Yao's test, i.e. a probabilistic Turing machine, running in polynomial time, such that there is a polynomial 

<math display="inline" id="Next-bit_test:34">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 such that for infinitely many 

<math display="inline" id="Next-bit_test:35">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <msubsup>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>S</mi>
      </mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
     </msubsup>
     <mo>-</mo>
     <msubsup>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>U</mi>
      </mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
     </msubsup>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>‚â•</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <abs></abs>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <list>
         <ci>k</ci>
         <ci>S</ci>
        </list>
       </apply>
       <ci>‚Ñ≥</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>p</ci>
        <list>
         <ci>k</ci>
         <ci>U</ci>
        </list>
       </apply>
       <ci>‚Ñ≥</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |p_{k,S}^{\mathcal{M}}-p_{k,U}^{\mathcal{M}}|\geq\frac{1}{Q(k)}
  </annotation>
 </semantics>
</math>

</p>
<center>

<p>

<math display="inline" id="Next-bit_test:36">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mrow>
     <msub>
      <mi>s</mi>
      <mn>1</mn>
     </msub>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msub>
      <mi>s</mi>
      <mi>i</mi>
     </msub>
     <msub>
      <mi>u</mi>
      <mrow>
       <mi>i</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
     <mi mathvariant="normal">‚Ä¶</mi>
     <msub>
      <mi>u</mi>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <mrow>
      <mi>s</mi>
      <mo>‚àà</mo>
      <msub>
       <mi>S</mi>
       <mi>k</mi>
      </msub>
     </mrow>
     <mo>,</mo>
     <mrow>
      <mi>u</mi>
      <mo>‚àà</mo>
      <msup>
       <mrow>
        <mo stretchy="false">{</mo>
        <mn>0</mn>
        <mo>,</mo>
        <mn>1</mn>
        <mo stretchy="false">}</mo>
       </mrow>
       <mrow>
        <mi>P</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>k</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msup>
     </mrow>
    </mrow>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <list>
      <ci>k</ci>
      <ci>i</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="latexml">conditional-set</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <apply>
        <plus></plus>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>u</ci>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <in></in>
       <ci>s</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <in></in>
       <ci>u</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <set>
         <cn type="integer">0</cn>
         <cn type="integer">1</cn>
        </set>
        <apply>
         <times></times>
         <ci>P</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{k,i}=\{s_{1}\ldots s_{i}u_{i+1}\ldots u_{P(k)}|s\in S_{k},u\in\{0,1\}^{P(k)}\}
  </annotation>
 </semantics>
</math>

</p>
</center>

<p>Let 

<math display="block" id="Next-bit_test:37">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">{</mo>
     <mn>0</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo stretchy="false">}</mo>
    </mrow>
    <mrow>
     <mi>P</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <list>
      <ci>k</ci>
      <cn type="integer">0</cn>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <set>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
     </set>
     <apply>
      <times></times>
      <ci>P</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{k,0}=\{0,1\}^{P(k)}
  </annotation>
 </semantics>
</math>

. We have 

<math display="inline" id="Next-bit_test:38">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>S</mi>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <list>
      <ci>k</ci>
      <apply>
       <times></times>
       <ci>P</ci>
       <ci>k</ci>
      </apply>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{k,P(k)}=S_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Next-bit_test:39">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">‚àë</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mrow>
      <mi>P</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </msubsup>
    <mrow>
     <mo stretchy="false">|</mo>
     <mrow>
      <msubsup>
       <mi>p</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <msub>
         <mi>R</mi>
         <mrow>
          <mi>k</mi>
          <mo>,</mo>
          <mrow>
           <mi>i</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </mrow>
        </msub>
       </mrow>
       <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
      </msubsup>
      <mo>-</mo>
      <msubsup>
       <mi>p</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <msub>
         <mi>R</mi>
         <mrow>
          <mi>k</mi>
          <mo>,</mo>
          <mi>i</mi>
         </mrow>
        </msub>
       </mrow>
       <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
      </msubsup>
     </mrow>
     <mo stretchy="false">|</mo>
    </mrow>
   </mrow>
   <mo>‚â•</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <msubsup>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <msub>
        <mi>R</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mi>P</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>k</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </msub>
      </mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
     </msubsup>
     <mo>-</mo>
     <msubsup>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <msub>
        <mi>R</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mn>0</mn>
        </mrow>
       </msub>
      </mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
     </msubsup>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">|</mo>
    <mrow>
     <msubsup>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>S</mi>
      </mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
     </msubsup>
     <mo>-</mo>
     <msubsup>
      <mi>p</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>U</mi>
      </mrow>
      <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
     </msubsup>
    </mrow>
    <mo stretchy="false">|</mo>
   </mrow>
   <mo>‚â•</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>k</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <geq></geq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <list>
           <ci>k</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>R</ci>
            <list>
             <ci>k</ci>
             <apply>
              <plus></plus>
              <ci>i</ci>
              <cn type="integer">1</cn>
             </apply>
            </list>
           </apply>
          </list>
         </apply>
         <ci>‚Ñ≥</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>p</ci>
          <list>
           <ci>k</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>R</ci>
            <list>
             <ci>k</ci>
             <ci>i</ci>
            </list>
           </apply>
          </list>
         </apply>
         <ci>‚Ñ≥</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <ci>‚Ñ≥</ci>
        </apply>
        <list>
         <ci>k</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <list>
           <ci>k</ci>
           <apply>
            <times></times>
            <ci>P</ci>
            <ci>k</ci>
           </apply>
          </list>
         </apply>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>p</ci>
         <ci>‚Ñ≥</ci>
        </apply>
        <list>
         <ci>k</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>R</ci>
          <list>
           <ci>k</ci>
           <cn type="integer">0</cn>
          </list>
         </apply>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <abs></abs>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <list>
          <ci>k</ci>
          <ci>S</ci>
         </list>
        </apply>
        <ci>‚Ñ≥</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <list>
          <ci>k</ci>
          <ci>U</ci>
         </list>
        </apply>
        <ci>‚Ñ≥</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>Q</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=0}^{P(k)}|p_{k,R_{k,i+1}}^{\mathcal{M}}-p_{k,R_{k,i}}^{\mathcal{M}}|%
\geq|p^{\mathcal{M}}_{k,R_{k,P(k)}}-p^{\mathcal{M}}_{k,R_{k,0}}|=|p_{k,S}^{%
\mathcal{M}}-p_{k,U}^{\mathcal{M}}|\geq\frac{1}{Q(k)}
  </annotation>
 </semantics>
</math>

. Then, we notice that 

<math display="inline" id="Next-bit_test:40">
 <semantics>
  <mrow>
   <mo stretchy="false">|</mo>
   <mrow>
    <msubsup>
     <mi>p</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <msub>
       <mi>R</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
      </msub>
     </mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
    </msubsup>
    <mo>-</mo>
    <msubsup>
     <mi>p</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <msub>
       <mi>R</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
     <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
    </msubsup>
   </mrow>
   <mo stretchy="false">|</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <abs></abs>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <list>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <list>
          <ci>k</ci>
          <apply>
           <plus></plus>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </list>
        </apply>
       </list>
      </apply>
      <ci>‚Ñ≥</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>p</ci>
       <list>
        <ci>k</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>R</ci>
         <list>
          <ci>k</ci>
          <ci>i</ci>
         </list>
        </apply>
       </list>
      </apply>
      <ci>‚Ñ≥</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   |p_{k,R_{k,i+1}}^{\mathcal{M}}-p_{k,R_{k,i}}^{\mathcal{M}}|
  </annotation>
 </semantics>
</math>

. Therefore, at least one of the 

<math display="inline" id="Next-bit_test:41">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>k</ci>
     <ci>P</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{Q(k)P(k)}
  </annotation>
 </semantics>
</math>

 should be no smaller than 

<math display="inline" id="Next-bit_test:42">
 <semantics>
  <msub>
   <mi>Œº</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œº</ci>
    <list>
     <ci>k</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k,i}
  </annotation>
 </semantics>
</math>

.</p>

<p>Next, we consider probability distributions 

<math display="inline" id="Next-bit_test:43">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>Œº</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>¬Ø</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¬Ø</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Œº</ci>
     <list>
      <ci>k</ci>
      <ci>i</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\mu_{k,i}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Next-bit_test:44">
 <semantics>
  <msub>
   <mi>R</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>R</ci>
    <list>
     <ci>k</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{k,i}
  </annotation>
 </semantics>
</math>

 on 

<math display="inline" id="Next-bit_test:45">
 <semantics>
  <msub>
   <mi>Œº</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œº</ci>
    <list>
     <ci>k</ci>
     <ci>i</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k,i}
  </annotation>
 </semantics>
</math>

. Distribution 

<math display="inline" id="Next-bit_test:46">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 is the probability distribution of choosing the 

<math display="inline" id="Next-bit_test:47">
 <semantics>
  <msub>
   <mi>S</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>S</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{k}
  </annotation>
 </semantics>
</math>

 first bits in 

<math display="inline" id="Next-bit_test:48">
 <semantics>
  <msub>
   <mi>Œº</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œº</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k}
  </annotation>
 </semantics>
</math>

 with probability given by 

<math display="inline" id="Next-bit_test:49">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mi>i</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(k)-i
  </annotation>
 </semantics>
</math>

, and the 

<math display="inline" id="Next-bit_test:50">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Œº</mi>
     <mrow>
      <mi>k</mi>
      <mo>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>w</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">‚Ä¶</mi>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>P</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>k</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mrow>
         <mi>s</mi>
         <mo>‚àà</mo>
         <msub>
          <mi>S</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>s</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">‚Ä¶</mi>
          <msub>
           <mi>s</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>=</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">‚Ä¶</mi>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
       </mrow>
      </msub>
      <mrow>
       <msub>
        <mi>Œº</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>s</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>i</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Œº</ci>
      <list>
       <ci>k</ci>
       <ci>i</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <in></in>
         <ci>s</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>S</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <eq></eq>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>s</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-‚Ä¶</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>s</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-‚Ä¶</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œº</ci>
        <ci>k</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k,i}(w_{1}\ldots w_{P(k)})=\left(\sum_{s\in S_{k},s_{1}\ldots s_{i}=w_{1}%
\ldots w_{i}}\mu_{k}(s)\right)\left(\frac{1}{2}\right)^{P(k)-i}
  </annotation>
 </semantics>
</math>

 remaining bits uniformly at random. We have thus :</p>
<center>

<p>

<math display="inline" id="Next-bit_test:51">
 <semantics>
  <mrow>
   <mrow>
    <mover accent="true">
     <msub>
      <mi>Œº</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo>¬Ø</mo>
    </mover>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>w</mi>
       <mn>1</mn>
      </msub>
      <mi mathvariant="normal">‚Ä¶</mi>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>P</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>k</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">‚àë</mo>
       <mrow>
        <mrow>
         <mi>s</mi>
         <mo>‚àà</mo>
         <msub>
          <mi>S</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>,</mo>
        <mrow>
         <mrow>
          <msub>
           <mi>s</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">‚Ä¶</mi>
          <msub>
           <mi>s</mi>
           <mrow>
            <mi>i</mi>
            <mo>-</mo>
            <mn>1</mn>
           </mrow>
          </msub>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <msub>
             <mi>s</mi>
             <mi>i</mi>
            </msub>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo>=</mo>
         <mrow>
          <msub>
           <mi>w</mi>
           <mn>1</mn>
          </msub>
          <mi mathvariant="normal">‚Ä¶</mi>
          <msub>
           <mi>w</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mrow>
       </mrow>
      </msub>
      <mrow>
       <msub>
        <mi>Œº</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>s</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mrow>
       <mi>P</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mi>i</mi>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>normal-¬Ø</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œº</ci>
       <list>
        <ci>k</ci>
        <ci>i</ci>
       </list>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-‚Ä¶</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>w</ci>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <csymbol cd="ambiguous">formulae-sequence</csymbol>
        <apply>
         <in></in>
         <ci>s</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>S</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <eq></eq>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>s</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-‚Ä¶</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>s</ci>
           <apply>
            <minus></minus>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>s</ci>
            <ci>i</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>normal-‚Ä¶</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>w</ci>
           <ci>i</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œº</ci>
        <ci>k</ci>
       </apply>
       <ci>s</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>P</ci>
        <ci>k</ci>
       </apply>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\mu_{k,i}}(w_{1}\ldots w_{P(k)})=\left(\sum_{s\in S_{k},s_{1}\ldots s%
_{i-1}(1-s_{i})=w_{1}\ldots w_{i}}\mu_{k}(s)\right)\left(\frac{1}{2}\right)^{P%
(k)-i}
  </annotation>
 </semantics>
</math>

</p>
</center>
<center>

<p>

<math display="inline" id="Next-bit_test:52">
 <semantics>
  <mrow>
   <msub>
    <mi>Œº</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>Œº</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
      </msub>
      <mo>+</mo>
      <mover accent="true">
       <msub>
        <mi>Œº</mi>
        <mrow>
         <mi>k</mi>
         <mo>,</mo>
         <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </mrow>
       </msub>
       <mo>¬Ø</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Œº</ci>
     <list>
      <ci>k</ci>
      <ci>i</ci>
     </list>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œº</ci>
       <list>
        <ci>k</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </list>
      </apply>
      <apply>
       <ci>normal-¬Ø</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œº</ci>
        <list>
         <ci>k</ci>
         <apply>
          <plus></plus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k,i}=\frac{1}{2}(\mu_{k,i+1}+\overline{\mu_{k,i+1}})
  </annotation>
 </semantics>
</math>

</p>
</center>

<p>We thus have 

<math display="inline" id="Next-bit_test:53">
 <semantics>
  <msub>
   <mi>Œº</mi>
   <mrow>
    <mi>k</mi>
    <mo>,</mo>
    <mrow>
     <mi>i</mi>
     <mo>+</mo>
     <mn>1</mn>
    </mrow>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>Œº</ci>
    <list>
     <ci>k</ci>
     <apply>
      <plus></plus>
      <ci>i</ci>
      <cn type="integer">1</cn>
     </apply>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{k,i+1}
  </annotation>
 </semantics>
</math>

 (a simple calculus trick shows this), thus distributions 

<math display="inline" id="Next-bit_test:54">
 <semantics>
  <mover accent="true">
   <msub>
    <mi>Œº</mi>
    <mrow>
     <mi>k</mi>
     <mo>,</mo>
     <mrow>
      <mi>i</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </mrow>
   </msub>
   <mo>¬Ø</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¬Ø</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Œº</ci>
     <list>
      <ci>k</ci>
      <apply>
       <plus></plus>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{\mu_{k,i+1}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Next-bit_test:55">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{M}
  </annotation>
 </semantics>
</math>

 can be distinguished by 

<math display="inline" id="Next-bit_test:56">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>p</mi>
     <msub>
      <mi>Œº</mi>
      <mrow>
       <mi>k</mi>
       <mo>,</mo>
       <mrow>
        <mi>i</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
     </msub>
     <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
    </msubsup>
    <mo>-</mo>
    <msubsup>
     <mi>p</mi>
     <mover accent="true">
      <msub>
       <mi>Œº</mi>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mrow>
         <mi>i</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
      </msub>
      <mo>¬Ø</mo>
     </mover>
     <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
    </msubsup>
   </mrow>
   <mo>‚â•</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mo>+</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>R</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>‚Ñ≥</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Œº</ci>
       <list>
        <ci>k</ci>
        <apply>
         <plus></plus>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </list>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>p</ci>
       <ci>‚Ñ≥</ci>
      </apply>
      <apply>
       <ci>normal-¬Ø</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Œº</ci>
        <list>
         <ci>k</ci>
         <apply>
          <plus></plus>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>R</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p^{\mathcal{M}}_{\mu_{k,i+1}}-p^{\mathcal{M}}_{\overline{\mu_{k,i+1}}}\geq%
\frac{1}{2}+\frac{1}{R(k)}
  </annotation>
 </semantics>
</math>

. Without loss of generality, we can assume that 

<math display="inline" id="Next-bit_test:57">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Next-bit_test:58">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 a polynomial.</p>

<p>This gives us a possible construction of a Turing machine solving the next-bit test : upon receiving the 

<math display="inline" id="Next-bit_test:59">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">ùí©</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ùí©</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{N}
  </annotation>
 </semantics>
</math>

 first bits of a sequence, 

<math display="inline" id="Next-bit_test:60">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

 pads this input with a guess of bit 

<math display="inline" id="Next-bit_test:61">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>-</mo>
   <mi>i</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>k</ci>
    </apply>
    <ci>i</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(k)-i-1
  </annotation>
 </semantics>
</math>

 and then 

<math display="inline" id="Next-bit_test:62">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>‚Ñ≥</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{M}
  </annotation>
 </semantics>
</math>

 random bits, chosen with uniform probability. Then it runs 

<math display="inline" id="Next-bit_test:63">
 <semantics>
  <mi>l</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>l</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   l
  </annotation>
 </semantics>
</math>

, and outputs 

<math display="inline" id="Next-bit_test:64">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 if the result is 

<math display="inline" id="Next-bit_test:65">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>-</mo>
   <mi>l</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <cn type="integer">1</cn>
    <ci>l</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-l
  </annotation>
 </semantics>
</math>

, and <span class="LaTeX">$1-l$</span> else.</p>
<h2 id="references">References</h2>
<references>
</references>

<p>"</p>

<p><a href="Category:Pseudorandom_number_generators" title="wikilink">Category:Pseudorandom number generators</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="Andrew_Chi-Chih_Yao" title="wikilink">Andrew Chi-Chih Yao</a>. <a href="http://www.busim.ee.boun.edu.tr/~mihcak/teaching/ee684-spring07/proposed-project-papers/one-way-functions/Yao-XOR-Lemma-and-Hard-Core-Predicates/Yao-XOR-original.pdf">Theory and applications of trapdoor functions</a>. In Proceedings of the 23rd IEEE Symposium on Foundations of Computer Science, 1982.<a href="#fnref1">‚Ü©</a></li>
<li id="fn2"><a href="Manuel_Blum" title="wikilink">Manuel Blum</a> and <a href="Silvio_Micali" title="wikilink">Silvio Micali</a>, How to generate cryptographically strong sequences of pseudo-random bits, in SIAM J. COMPUT., Vol. 13, No. 4, November 1984<a href="#fnref2">‚Ü©</a></li>
<li id="fn3"></li>
</ol>
</section>
</body>
</html>

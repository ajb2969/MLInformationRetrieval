<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1304">Difference density map</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Difference density map</h1>
<hr/>

<p>In <a href="X-ray_crystallography" title="wikilink">X-ray crystallography</a>, a <strong>difference density map</strong> shows the spatial distribution of the difference between the measured <a href="electron_density" title="wikilink">electron density</a> of the crystal and the electron density explained by the current model.</p>

<p>Conventionally, they are displayed as <a href="isosurface" title="wikilink">isosurfaces</a> with positive density—electron density where there's nothing in the model, usually corresponding to some constituent of the crystal that hasn't been modelled, for example a <a class="uri" href="ligand" title="wikilink">ligand</a> or a <a href="crystallisation_adjutant" title="wikilink">crystallisation adjutant</a> -- in green, and negative density—parts of the model not backed up by electron density, indicating either that an atom has been disordered by <a href="radiation_damage" title="wikilink">radiation damage</a> or that it is modelled in the wrong place—in red.</p>

<p>Difference density maps are usually calculated using Fourier coefficients which are the differences between the observed structure factor amplitudes from the X-ray diffraction experiment and the calculated structure factor amplitudes from the current model, using the phase from the model for both terms (since no phases are available for the observed data). The two sets of structure factors must be on the same scale. It is now normal to also include weighting terms which take into account the estimated errors in the current model:</p>

<p>

<math display="inline" id="Difference_density_map:0">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mrow>
     <mi>d</mi>
     <mi>i</mi>
     <mi>f</mi>
     <mi>f</mi>
     <mi>m</mi>
     <mi>a</mi>
     <mi>p</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>m</mi>
       <mrow>
        <mo stretchy="false">|</mo>
        <msub>
         <mi>F</mi>
         <mrow>
          <mi>o</mi>
          <mi>b</mi>
          <mi>s</mi>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>D</mi>
       <mrow>
        <mo stretchy="false">|</mo>
        <msub>
         <mi>F</mi>
         <mrow>
          <mi>c</mi>
          <mi>a</mi>
          <mi>l</mi>
          <mi>c</mi>
         </mrow>
        </msub>
        <mo stretchy="false">|</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>e</mi>
    <mi>x</mi>
    <mi>p</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>2</mn>
      <mi>π</mi>
      <mi>i</mi>
      <msub>
       <mi>ϕ</mi>
       <mrow>
        <mi>c</mi>
        <mi>a</mi>
        <mi>l</mi>
        <mi>c</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>i</ci>
      <ci>f</ci>
      <ci>f</ci>
      <ci>m</ci>
      <ci>a</ci>
      <ci>p</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>m</ci>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <apply>
          <times></times>
          <ci>o</ci>
          <ci>b</ci>
          <ci>s</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>D</ci>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>F</ci>
         <apply>
          <times></times>
          <ci>c</ci>
          <ci>a</ci>
          <ci>l</ci>
          <ci>c</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>e</ci>
     <ci>x</ci>
     <ci>p</ci>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>π</ci>
      <ci>i</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ϕ</ci>
       <apply>
        <times></times>
        <ci>c</ci>
        <ci>a</ci>
        <ci>l</ci>
        <ci>c</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{diffmap}=(m|F_{obs}|-D|F_{calc}|)exp(2\pi i\phi_{calc})
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>m</em> is a <a href="figure_of_merit" title="wikilink">figure of merit</a> which is an estimate of the cosine of the error in the phase, and <em>D</em> is a scale factor.</p>

<p>These coefficients are derived from the gradient of the likelihood function of the observed structure factors on the basis of the current model.</p>

<p>"</p>

<p><a class="uri" href="Category:Crystallography" title="wikilink">Category:Crystallography</a></p>
</body>
</html>

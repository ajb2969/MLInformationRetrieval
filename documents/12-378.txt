   Principal component regression      Principal component regression   In statistics , principal component regression (PCR) is a regression analysis technique that is based on principal component analysis (PCA). Typically, it considers regressing the outcome (also known as the response or, the dependent variable) on a set of covariates (also known as predictors or, explanatory variables or, independent variables) based on a standard linear regression model , but uses PCA for estimating the unknown regression coefficients in the model.  In PCR, instead of regressing the dependent variable on the explanatory variables directly, the principal components of the explanatory variables are used as regressors . One typically uses only a subset of all the principal components for regression , thus making PCR some kind of a regularized procedure. Often the principal components with higher variances (the ones based on eigenvectors corresponding to the higher eigenvalues of the sample  variance-covariance matrix of the explanatory variables) are selected as regressors. However, for the purpose of predicting the outcome, the principal components with low variances may also be important, in some cases even more important. 1  One major use of PCR lies in overcoming the multicollinearity problem which arises when two or more of the explanatory variables are close to being collinear . 2 PCR can aptly deal with such situations by excluding some of the low-variance principal components in the regression step. In addition, by usually regressing on only a subset of all the principal components, PCR can result in dimension reduction through substantially lowering the effective number of parameters characterizing the underlying model. This can be particularly useful in settings with high-dimensional covariates . Also, through appropriate selection of the principal components to be used for regression, PCR can lead to efficient prediction of the outcome based on the assumed model.  The principle  The PCR method may be broadly divided into three major steps:   1.      absent   \;\;   Perform PCA on the observed data matrix for the explanatory variables to obtain the principal components, and then (usually) select a subset, based on some appropriate criteria, of the principal components so obtained for further use.    2.      absent   \;\;   Now regress the observed vector of outcomes on the selected principal components as covariates, using ordinary least squares regression ( linear regression ) to get a vector of estimated regression coefficients (with dimension equal to the number of selected principal components).    3.      absent   \;\;   Now transform this vector back to the scale of the actual covariates, using the selected PCA loadings (the eigenvectors corresponding to the selected principal components) to get the final PCR estimator (with dimension equal to the total number of covariates) for estimating the regression coefficients characterizing the original model.   Details of the method  Data Representation: Let     ğ˜   n  Ã—  1    =    (   y  1   ,  â€¦  ,   y  n   )   T        subscript  ğ˜    n  1     superscript    subscript  y  1   normal-â€¦   subscript  y  n    T     \mathbf{Y}_{n\times 1}=\left(y_{1},\ldots,y_{n}\right)^{T}   denote the vector of observed outcomes and     ğ—   n  Ã—  p    =    [   ğ±  1   ,  â€¦  ,   ğ±  p   ]   T        subscript  ğ—    n  p     superscript    subscript  ğ±  1   normal-â€¦   subscript  ğ±  p    T     \mathbf{X}_{n\times p}=\left[\mathbf{x}_{1},\ldots,\mathbf{x}_{p}\right]^{T}   denote the corresponding data matrix of observed covariates where,   n   n   n   and   p   p   p   denote the size of the observed sample and the number of covariates respectively, with    n  â‰¥  p      n  p    n\geq p   . Each of the   n   n   n   rows of   ğ—   ğ—   \mathbf{X}   denotes one set of observations for the   p   p   p    dimensional covariate and the respective entry of   ğ˜   ğ˜   \mathbf{Y}   denotes the corresponding observed outcome.  Data Pre-processing: Assume that   ğ˜   ğ˜   \mathbf{Y}   and each of the   p   p   p   columns of   ğ—   ğ—   \mathbf{X}   have already been centered so that all of them have zero empirical means . This centering step is crucial (at least for the columns of   ğ—   ğ—   \mathbf{X}   ) since PCR involves the use of PCA on   ğ—   ğ—   \mathbf{X}   and PCA is sensitive to centering of the data.  Underlying Model: Following centering, the standard Gaussâ€“Markov  linear regression model for   ğ˜   ğ˜   \mathbf{Y}   on   ğ—   ğ—   \mathbf{X}   can be represented as    ğ˜  =    ğ—  ğœ·   +   ğœº        ğ˜      ğ—  ğœ·   ğœº     \mathbf{Y}=\mathbf{X}\boldsymbol{\beta}+\boldsymbol{\varepsilon}\;   where,    ğœ·  âˆˆ   â„  p       ğœ·   superscript  â„  p     \boldsymbol{\beta}\in\mathbb{R}^{p}   denotes the unknown parameter vector of regression coefficients and   ğœº   ğœº   \boldsymbol{\varepsilon}   denotes the vector of random errors with     E   (  ğœº  )    =   ğŸ        normal-E  ğœº   0    \operatorname{E}\left(\boldsymbol{\varepsilon}\right)=\mathbf{0}\;   and     Var   (  ğœº  )    =    Ïƒ  2    I   n  Ã—  n          Var  ğœº      superscript  Ïƒ  2    subscript  I    n  n       \;\operatorname{Var}\left(\boldsymbol{\varepsilon}\right)=\sigma^{2}I_{n\times
 n}   for some unknown variance parameter     Ïƒ  2   >   0        superscript  Ïƒ  2   0    \sigma^{2}>0\;\;     Objective: The primary goal is to obtain an efficient estimator     ğœ·  ^     normal-^  ğœ·    \widehat{\boldsymbol{\beta}}   for the parameter   ğœ·   ğœ·   \boldsymbol{\beta}   , based on the data. One frequently used approach for this is ordinary least squares regression which, assuming   ğ—   ğ—   \mathbf{X}   is full column rank , gives the unbiased estimator       ğœ·  ^   ols   =     (    ğ—  T   ğ—   )    -  1     ğ—  T   ğ˜        subscript   normal-^  ğœ·   ols      superscript     superscript  ğ—  T   ğ—     1     superscript  ğ—  T   ğ˜     \widehat{\boldsymbol{\beta}}_{\mathrm{ols}}=(\mathbf{X}^{T}\mathbf{X})^{-1}%
 \mathbf{X}^{T}\mathbf{Y}   of   ğœ·   ğœ·   \boldsymbol{\beta}   . PCR is another technique that may be used for the same purpose of estimating   ğœ·   ğœ·   \boldsymbol{\beta}   .  PCA Step: PCR starts by performing a PCA on the centered data matrix   ğ—   ğ—   \mathbf{X}   . For this, let    ğ—  =   U  Î”   V  T        ğ—    U  normal-Î”   superscript  V  T      \mathbf{X}=U\Delta V^{T}   denote the singular value decomposition of   ğ—   ğ—   \mathbf{X}   where,     Î”   p  Ã—  p    =   diag   [   Î´  1   ,  â€¦  ,   Î´  p   ]         subscript  normal-Î”    p  p     diag   subscript  Î´  1   normal-â€¦   subscript  Î´  p      \Delta_{p\times p}=\operatorname{diag}\left[\delta_{1},\ldots,\delta_{p}\right]   with     Î´  1   â‰¥  â‹¯  â‰¥   Î´  p   â‰¥  0         subscript  Î´  1   normal-â‹¯        subscript  Î´  p        0     \delta_{1}\geq\cdots\geq\delta_{p}\geq 0   denoting the non-negative singular values of   ğ—   ğ—   \mathbf{X}   , while the columns of     U   n  Ã—  p    =   [   ğ®  1   ,  â€¦  ,   ğ®  p   ]        subscript  U    n  p      subscript  ğ®  1   normal-â€¦   subscript  ğ®  p      U_{n\times p}=[\mathbf{u}_{1},\ldots,\mathbf{u}_{p}]   and     V   p  Ã—  p    =   [   ğ¯  1   ,  â€¦  ,   ğ¯  p   ]        subscript  V    p  p      subscript  ğ¯  1   normal-â€¦   subscript  ğ¯  p      V_{p\times p}=[\mathbf{v}_{1},\ldots,\mathbf{v}_{p}]   are both orthonormal sets of vectors denoting the left and right singular vectors of   ğ—   ğ—   \mathbf{X}   respectively.  The Principal Components:     V  Î›   V  T       V  normal-Î›   superscript  V  T     V\Lambda V^{T}   gives a spectral decomposition of     ğ—  T   ğ—       superscript  ğ—  T   ğ—    \mathbf{X}^{T}\mathbf{X}   where     Î›   p  Ã—  p    =   diag   [   Î»  1   ,  â€¦  ,   Î»  p   ]    =   diag   [   Î´  1  2   ,  â€¦  ,   Î´  p  2   ]    =   Î”  2          subscript  normal-Î›    p  p     diag   subscript  Î»  1   normal-â€¦   subscript  Î»  p          diag   superscript   subscript  Î´  1   2   normal-â€¦   superscript   subscript  Î´  p   2          superscript  normal-Î”  2      \Lambda_{p\times p}=\operatorname{diag}\left[\lambda_{1},\ldots,\lambda_{p}%
 \right]=\operatorname{diag}\left[\delta_{1}^{2},\ldots,\delta_{p}^{2}\right]=%
 \Delta^{2}   with     Î»  1   â‰¥  â‹¯  â‰¥   Î»  p   â‰¥  0         subscript  Î»  1   normal-â‹¯        subscript  Î»  p        0     \lambda_{1}\geq\cdots\geq\lambda_{p}\geq 0   denoting the non-negative eigenvalues (also known as the principal values ) of     ğ—  T   ğ—       superscript  ğ—  T   ğ—    \mathbf{X}^{T}\mathbf{X}   , while the columns of   V   V   V   denote the corresponding orthonormal set of eigenvectors. Then,    ğ—ğ¯  j     subscript  ğ—ğ¯  j    \mathbf{X}\mathbf{v}_{j}   and    ğ¯  j     subscript  ğ¯  j    \mathbf{v}_{j}   respectively denote the    j   t  h      superscript  j    t  h     j^{th}    principal component and the    j   t  h      superscript  j    t  h     j^{th}    principal component direction (or, PCA loading ) corresponding to the    j   t  h      superscript  j    t  h     j^{th}   largest principal value     Î»  j     subscript  Î»  j    \lambda_{j}   for each    j  âˆˆ   {  1  ,  â€¦  ,  p  }       j   1  normal-â€¦  p     j\in\{1,\ldots,p\}   .  Derived covariates: For any    k  âˆˆ   {  1  ,  â€¦  ,  p  }       k   1  normal-â€¦  p     k\in\{1,\ldots,p\}   , let    V  k     subscript  V  k    V_{k}   denote the    p  Ã—  k      p  k    p\times k   matrix with orthonormal columns consisting of the first   k   k   k   columns of   V   V   V   . Let     W  k   =   ğ—   V  k         subscript  W  k     ğ—   subscript  V  k      W_{k}=\mathbf{X}V_{k}        =   [   ğ—ğ¯  1   ,  â€¦  ,   ğ—ğ¯  k   ]       absent    subscript  ğ—ğ¯  1   normal-â€¦   subscript  ğ—ğ¯  k      =[\mathbf{X}\mathbf{v}_{1},\ldots,\mathbf{X}\mathbf{v}_{k}]   denote the    n  Ã—  k      n  k    n\times k   matrix having the first   k   k   k   principal components as its columns.   W   W   W   may be viewed as the data matrix obtained by using the transformed covariates     ğ±  i  k   =    V  k  T    ğ±  i    âˆˆ   â„  k          superscript   subscript  ğ±  i   k      superscript   subscript  V  k   T    subscript  ğ±  i          superscript  â„  k      \mathbf{x}_{i}^{k}=V_{k}^{T}\mathbf{x}_{i}\in\mathbb{R}^{k}   instead of using the original covariates     ğ±  i   âˆˆ     â„  p     âˆ€  1    â‰¤  i  â‰¤  n         subscript  ğ±  i      superscript  â„  p    for-all  1         i       n     \mathbf{x}_{i}\in\mathbb{R}^{p}\;\;\forall\;\;1\leq i\leq n   .  The PCR Estimator: Let      Î³  ^   k   =     (    W  k  T    W  k    )    -  1     W  k  T   ğ˜   âˆˆ   â„  k          subscript   normal-^  Î³   k      superscript     superscript   subscript  W  k   T    subscript  W  k      1     superscript   subscript  W  k   T   ğ˜         superscript  â„  k      \widehat{\gamma}_{k}=\left(W_{k}^{T}W_{k}\right)^{-1}W_{k}^{T}\mathbf{Y}\in%
 \mathbb{R}^{k}   denote the vector of estimated regression coefficients obtained by ordinary least squares regression of the response vector   ğ˜   ğ˜   \mathbf{Y}   on the data matrix    W  k     subscript  W  k    W_{k}   . Then, for any    k  âˆˆ   {  1  ,  â€¦  ,  p  }       k   1  normal-â€¦  p     k\in\{1,\ldots,p\}   , the final PCR estimator of   ğœ·   ğœ·   \boldsymbol{\beta}   based on using the first   k   k   k   principal components is given by      ğœ·  ^   k   =    V  k     Î³  ^   k    âˆˆ   â„  p          subscript   normal-^  ğœ·   k      subscript  V  k    subscript   normal-^  Î³   k          superscript  â„  p      \widehat{\boldsymbol{\beta}}_{k}=V_{k}\widehat{\gamma}_{k}\in\mathbb{R}^{p}   .  Fundamental characteristics and applications of the PCR estimator  Two basic properties  The fitting process for obtaining the PCR estimator involves regressing the response vector on the derived data matrix    W  k     subscript  W  k    W_{k}   which has orthogonal columns for any    k  âˆˆ   {  1  ,  â€¦  ,  p  }       k   1  normal-â€¦  p     k\in\{1,\ldots,p\}   since the principal components are mutually orthogonal to each other. Thus in the regression step, performing a multiple linear regression jointly on the   k   k   k   selected principal components as covariates is equivalent to carrying out   k   k   k   independent simple linear regressions (or, univariate regressions) separately on each of the   k   k   k   selected principal components as a covariate.  When all the principal components are selected for regression so that    k  =  p      k  p    k=p   , then the PCR estimator is equivalent to the ordinary least squares estimator. Thus,      ğœ·  ^   p   =    ğœ·  ^   ols        subscript   normal-^  ğœ·   p    subscript   normal-^  ğœ·   ols     \widehat{\boldsymbol{\beta}}_{p}=\widehat{\boldsymbol{\beta}}_{\mathrm{ols}}   . This is easily seen from the fact that     W  p   =   ğ—   V  p    =   ğ—  V          subscript  W  p     ğ—   subscript  V  p           ğ—  V      W_{p}=\mathbf{X}V_{p}=\mathbf{X}V   and also observing that   V   V   V   is an orthogonal matrix .  Variance reduction  For any    k  âˆˆ   {  1  ,  â€¦  ,  p  }       k   1  normal-â€¦  p     k\in\{1,\ldots,p\}   , the variance of     ğœ·  ^   k     subscript   normal-^  ğœ·   k    \widehat{\boldsymbol{\beta}}_{k}   is given by        Var   (    ğœ·  ^   k   )    =     Ïƒ  2     V  k     (    W  k  T    W  k    )    -  1     V  k  T    =     Ïƒ  2      V  k     diag   (   Î»  1   -  1    ,  â€¦  ,   Î»  k   -  1    )     V  k  T    =    Ïƒ  2     âˆ‘   j  =  1   k      ğ¯  j    ğ¯  j  T     Î»  j       .         Var   subscript   normal-^  ğœ·   k       superscript  Ïƒ  2    subscript  V  k    superscript     superscript   subscript  W  k   T    subscript  W  k      1     superscript   subscript  V  k   T            superscript  Ïƒ  2    subscript  V  k    diag   superscript   subscript  Î»  1     1    normal-â€¦   superscript   subscript  Î»  k     1      superscript   subscript  V  k   T            superscript  Ïƒ  2     superscript   subscript     j  1    k        subscript  ğ¯  j    superscript   subscript  ğ¯  j   T     subscript  Î»  j         \operatorname{Var}(\widehat{\boldsymbol{\beta}}_{k})=\sigma^{2}\;V_{k}(W_{k}^{%
 T}W_{k})^{-1}V_{k}^{T}=\sigma^{2}\;V_{k}\;\operatorname{diag}\left(\lambda_{1}%
 ^{-1},\ldots,\lambda_{k}^{-1}\right)V_{k}^{T}=\sigma^{2}\sideset{}{}{\sum}_{j=%
 1}^{k}\frac{\mathbf{v}_{j}\mathbf{v}_{j}^{T}}{\lambda_{j}}.\;     In particular,     Var   (    ğœ·  ^   p   )    =   Var   (    ğœ·  ^   ols   )    =    Ïƒ  2     âˆ‘   j  =  1   p      ğ¯  j    ğ¯  j  T     Î»  j             Var   subscript   normal-^  ğœ·   p     Var   subscript   normal-^  ğœ·   ols            superscript  Ïƒ  2     superscript   subscript     j  1    p        subscript  ğ¯  j    superscript   subscript  ğ¯  j   T     subscript  Î»  j         \operatorname{Var}(\widehat{\boldsymbol{\beta}}_{p})=\operatorname{Var}(%
 \widehat{\boldsymbol{\beta}}_{\mathrm{ols}})=\sigma^{2}\sideset{}{}{\sum}_{j=1%
 }^{p}\frac{\mathbf{v}_{j}\mathbf{v}_{j}^{T}}{\lambda_{j}}   . Hence,      Var   (    ğœ·  ^   ols   )    -   Var   (    ğœ·  ^   k   )     =    Ïƒ  2     âˆ‘   j  =   k  +  1    p      ğ¯  j    ğ¯  j  T     Î»  j             Var   subscript   normal-^  ğœ·   ols     Var   subscript   normal-^  ğœ·   k        superscript  Ïƒ  2     superscript   subscript     j    k  1     p        subscript  ğ¯  j    superscript   subscript  ğ¯  j   T     subscript  Î»  j        \operatorname{Var}(\widehat{\boldsymbol{\beta}}_{\mathrm{ols}})-\operatorname{%
 Var}(\widehat{\boldsymbol{\beta}}_{k})=\sigma^{2}\sideset{}{}{\sum}_{j=k+1}^{p%
 }\frac{\mathbf{v}_{j}\mathbf{v}_{j}^{T}}{\lambda_{j}}   for any    k  âˆˆ   {  1  ,  â€¦  ,   (   p  -  1   )   }       k   1  normal-â€¦    p  1      k\in\{1,\ldots,(p-1)\}   .  Thus, for any     k  âˆˆ   {  1  ,  â€¦  ,  p  }    ,     Var   (    ğœ·  ^   ols   )    -   Var   (    ğœ·  ^   k   )     âª°  0      formulae-sequence    k   1  normal-â€¦  p     succeeds-or-equals     Var   subscript   normal-^  ğœ·   ols     Var   subscript   normal-^  ğœ·   k     0     k\in\{1,\ldots,p\},\operatorname{Var}(\widehat{\boldsymbol{\beta}}_{\mathrm{%
 ols}})-\operatorname{Var}(\widehat{\boldsymbol{\beta}}_{k})\succeq 0   where    A  âª°  0     succeeds-or-equals  A  0    A\succeq 0   indicates that a square symmetric matrix   A   A   A   is non-negative definite . Consequently, any given linear form of the PCR estimator has a lower variance compared to that of the same linear form of the ordinary least squares estimator.  Addressing multicollinearity  Under multicollinearity , two or more of the covariates are highly correlated , so that one can be linearly predicted from the others with a non-trivial degree of accuracy. Consequently, the columns of the data matrix   ğ—   ğ—   \mathbf{X}   that correspond to the observations for these covariates tend to become linearly dependent and therefore,   ğ—   ğ—   \mathbf{X}   tends to become rank deficient losing its full column rank structure. More quantitatively, one or more of the smaller eigenvalues of     ğ—  T   ğ—       superscript  ğ—  T   ğ—    \mathbf{X}^{T}\mathbf{X}   get(s) very close or, become(s) exactly equal to   0   0    under such situations. The variance expressions above indicate that these small eigenvalues have the maximum inflation effect on the variance of the least squares estimator, thereby destabilizing the estimator significantly when they are close to   0   0    . This issue can be effectively addressed through using a PCR estimator obtained by excluding the principal components corresponding to these small eigenvalues.  Dimension reduction  PCR may also be used for performing dimension reduction . To see this, let    L  k     subscript  L  k    L_{k}   denote any    p  Ã—  k      p  k    p\times k   matrix having orthonormal columns, for any    k  âˆˆ   {  1  ,  â€¦  ,  p  }       k   1  normal-â€¦  p     k\in\{1,\ldots,p\}   . Suppose now that we want to approximate each of the covariate observations    ğ±  i     subscript  ğ±  i    \mathbf{x}_{i}   through the rank    k   k   k    linear transformation      L  k    ğ³  i        subscript  L  k    subscript  ğ³  i     L_{k}\mathbf{z}_{i}   for some     ğ³  i   âˆˆ    â„  k     (  1  â‰¤  i  â‰¤  n  )      fragments   subscript  ğ³  i     superscript  â„  k    fragments  normal-(  1   i   n  normal-)     \mathbf{z}_{i}\in\mathbb{R}^{k}\;(1\leq i\leq n)   .  Then, it can be shown that     âˆ‘   i  =  1   n     âˆ¥    ğ±  i   -    L  k    ğ³  i     âˆ¥   2       superscript   subscript     i  1    n    superscript   norm     subscript  ğ±  i      subscript  L  k    subscript  ğ³  i      2     \sum_{i=1}^{n}\|\mathbf{x}_{i}-L_{k}\mathbf{z}_{i}\|^{2}   is minimized at     L  k   =   V  k   â†’          subscript  L  k    subscript  V  k     normal-â†’    absent     L_{k}=V_{k}\rightarrow   the matrix with the first   k   k   k   principal component directions as columns, and     ğ³  i   =   ğ±  i  k   =    V  k  T    ğ±  i    â†’          subscript  ğ³  i    superscript   subscript  ğ±  i   k           superscript   subscript  V  k   T    subscript  ğ±  i      normal-â†’    absent     \mathbf{z}_{i}=\mathbf{x}_{i}^{k}=V_{k}^{T}\mathbf{x}_{i}\rightarrow   the corresponding   k   k   k   dimensional derived covariates. Thus the   k   k   k   dimensional principal components provide the best linear approximation of rank   k   k   k   to the observed data matrix   ğ—   ğ—   \mathbf{X}   .  The corresponding reconstruction error is given by      âˆ‘   i  =  1   n     âˆ¥    ğ±  i   -    V  k    ğ±  i  k     âˆ¥   2    =    âˆ‘   j  =   k  +  1    n    (   Î»  j   )          superscript   subscript     i  1    n    superscript   norm     subscript  ğ±  i      subscript  V  k    superscript   subscript  ğ±  i   k      2      superscript   subscript     j    k  1     n    subscript  Î»  j      \sum_{i=1}^{n}\|\mathbf{x}_{i}-V_{k}\mathbf{x}_{i}^{k}\|^{2}=\sum_{j=k+1}^{n}%
 \left(\lambda_{j}\right)\;   for any    1  â‰¤  k  <  p        1  k       p     1\leq k   and,      âˆ‘   i  =  1   n     âˆ¥    ğ±  i   -    V  k    ğ±  i  k     âˆ¥   2    =  0        superscript   subscript     i  1    n    superscript   norm     subscript  ğ±  i      subscript  V  k    superscript   subscript  ğ±  i   k      2    0    \sum_{i=1}^{n}\|\mathbf{x}_{i}-V_{k}\mathbf{x}_{i}^{k}\|^{2}=0   , for    k  =  p      k  p    k=p   .  Thus any potential dimension reduction may be achieved by choosing   k   k   k   , the number of principal components to be used, through appropriate thresholding on the cumulative sum of the eigenvalues of     ğ—  T   ğ—       superscript  ğ—  T   ğ—    \mathbf{X}^{T}\mathbf{X}   . Since the smaller eigenvalues do not contribute significantly to the cumulative sum, the corresponding principal components may be continued to be dropped as long as the desired threshold limit is not exceeded. The same criteria may also be used for addressing the multicollinearity issue whereby the principal components corresponding to the smaller eigenvalues may be ignored as long as the threshold limit is maintained.  Regularization effect  Since the PCR estimator typically uses only a subset of all the principal components for regression, it can be viewed as some sort of a regularized procedure. More specifically, for any    1  â‰¤  k  <  p        1  k       p     1\leq k   , the PCR estimator     ğœ·  ^   k     subscript   normal-^  ğœ·   k    \widehat{\boldsymbol{\beta}}_{k}   denotes the regularized solution to the following constrained minimization problem:        min    ğœ·  *   âˆˆ   â„  p        âˆ¥   ğ˜  -   ğ—   ğœ·  *     âˆ¥   2           subscript  ğœ·     superscript  â„  p       superscript   norm    ğ˜    ğ—   subscript  ğœ·       2     \underset{\boldsymbol{\beta}_{*}\in\mathbb{R}^{p}}{\min}\;\|\mathbf{Y}-\mathbf%
 {X}\boldsymbol{\beta}_{*}\|^{2}   subject to     ğœ·  *   âŸ‚   {   ğ¯   k  +  1    ,  â€¦  ,   ğ¯  p   }      perpendicular-to   subscript  ğœ·      subscript  ğ¯    k  1    normal-â€¦   subscript  ğ¯  p      \boldsymbol{\beta}_{*}\perp\{\mathbf{v}_{k+1},\ldots,\mathbf{v}_{p}\}   . The constraint may be equivalently written as      V   (   p  -  k   )   T    ğœ·  *    =  ğŸ         superscript   subscript  V    p  k    T    subscript  ğœ·     0    V_{\left(p-k\right)}^{T}\boldsymbol{\beta}_{*}=\mathbf{0}   where,      V   (   p  -  k   )    =    [   ğ¯   k  +  1    ,  â€¦  ,   ğ¯  p   ]    p  Ã—   (   p  -  k   )      .       subscript  V    p  k     subscript    subscript  ğ¯    k  1    normal-â€¦   subscript  ğ¯  p      p    p  k       V_{\left(p-k\right)}=\left[\mathbf{v}_{k+1},\ldots,\mathbf{v}_{p}\right]_{p%
 \times\left(p-k\right)}.     Thus, when only a proper subset of all the principal components are selected for regression, the PCR estimator so obtained is based on a hard form of regularization that constrains the resulting solution to the column space of the selected principal component directions, and consequently restricts it to be orthogonal to the excluded directions.  Optimality of PCR among a class of regularized estimators  Given the constrained minimization problem as defined above, let us consider the following generalized version of it:        min    ğœ·  *   âˆˆ   â„  p        âˆ¥   ğ˜  -   ğ—   ğœ·  *     âˆ¥   2           subscript  ğœ·     superscript  â„  p       superscript   norm    ğ˜    ğ—   subscript  ğœ·       2     \underset{\boldsymbol{\beta}_{*}\in\mathbb{R}^{p}}{\min}\;\|\mathbf{Y}-\mathbf%
 {X}\boldsymbol{\beta}_{*}\|^{2}   subject to      L   (   p  -  k   )   T    ğœ·  *    =  ğŸ         superscript   subscript  L    p  k    T    subscript  ğœ·     0    L_{\left(p-k\right)}^{T}\boldsymbol{\beta}_{*}=\mathbf{0}     where,    L   (   p  -  k   )      subscript  L    p  k     L_{\left(p-k\right)}   denotes any full column rank matrix of order    p  Ã—   (   p  -  k   )       p    p  k     p\times\left(p-k\right)   with    1  â‰¤  k  <  p        1  k       p     1\leq k   .  Let     ğœ·  ^   L     subscript   normal-^  ğœ·   L    \widehat{\boldsymbol{\beta}}_{L}   denote the corresponding solution. Thus      ğœ·  ^   L   =      arg  min     ğœ·  *   âˆˆ   â„  p        âˆ¥   ğ˜  -   ğ—   ğœ·  *     âˆ¥   2         subscript   normal-^  ğœ·   L         subscript  ğœ·     superscript  â„  p     arg      superscript   norm    ğ˜    ğ—   subscript  ğœ·       2      \widehat{\boldsymbol{\beta}}_{L}=\underset{\boldsymbol{\beta}_{*}\in\mathbb{R}%
 ^{p}}{\operatorname{arg}\;\min}\;\|\mathbf{Y}-\mathbf{X}\boldsymbol{\beta}_{*}%
 \|^{2}   subject to      L   (   p  -  k   )   T    ğœ·  *    =  ğŸ         superscript   subscript  L    p  k    T    subscript  ğœ·     0    L_{\left(p-k\right)}^{T}\boldsymbol{\beta}_{*}=\mathbf{0}   . Then, Park (1981) 3 showed that the optimal choice of the restriction matrix    L   (   p  -  k   )      subscript  L    p  k     L_{\left(p-k\right)}   for which the corresponding estimator     ğœ·  ^   L     subscript   normal-^  ğœ·   L    \widehat{\boldsymbol{\beta}}_{L}   achieves the minimum prediction error is given by:       L   (   p  -  k   )   *   =    V   (   p  -  k   )     Î›   (   p  -  k   )    1  /  2          subscript   superscript  L      p  k       subscript  V    p  k     superscript   subscript  normal-Î›    p  k      1  2       L^{*}_{\left(p-k\right)}=V_{\left(p-k\right)}\Lambda_{\left(p-k\right)}^{1/2}   where,      Î›   (   p  -  k   )    1  /  2    =   diag   (   Î»   k  +  1    1  /  2    ,  â€¦  ,   Î»  p   1  /  2    )     .       superscript   subscript  normal-Î›    p  k      1  2     diag   superscript   subscript  Î»    k  1      1  2    normal-â€¦   superscript   subscript  Î»  p     1  2       \Lambda_{\left(p-k\right)}^{1/2}=\operatorname{diag}\left(\lambda_{k+1}^{1/2},%
 \ldots,\lambda_{p}^{1/2}\right).     Quite clearly, the resulting optimal estimator     ğœ·  ^    L  *      subscript   normal-^  ğœ·    superscript  L      \widehat{\boldsymbol{\beta}}_{L^{*}}   is then simply given by the PCR estimator     ğœ·  ^   k     subscript   normal-^  ğœ·   k    \widehat{\boldsymbol{\beta}}_{k}   based on the first   k   k   k   principal components.  Efficiency  Since the ordinary least squares estimator is unbiased for   ğœ·   ğœ·   \boldsymbol{\beta}   , we have     Var   (    ğœ·  ^   ols   )    =   MSE   (    ğœ·  ^   ols   )         Var   subscript   normal-^  ğœ·   ols     MSE   subscript   normal-^  ğœ·   ols      \operatorname{Var}(\widehat{\boldsymbol{\beta}}_{\mathrm{ols}})=\operatorname{%
 MSE}(\widehat{\boldsymbol{\beta}}_{\mathrm{ols}})   where, MSE denotes the mean squared error . Now, if for some    k  âˆˆ   {  1  ,  â€¦  ,  p  }       k   1  normal-â€¦  p     k\in\{1,\ldots,p\}   , we additionally have      V   (   p  -  k   )   T   ğœ·   =  ğŸ         superscript   subscript  V    p  k    T   ğœ·   0    V_{\left(p-k\right)}^{T}\boldsymbol{\beta}=\mathbf{0}   , then the corresponding     ğœ·  ^   k     subscript   normal-^  ğœ·   k    \widehat{\boldsymbol{\beta}}_{k}   is also unbiased for   ğœ·   ğœ·   \boldsymbol{\beta}   and therefore     Var   (    ğœ·  ^   k   )    =   MSE   (    ğœ·  ^   k   )         Var   subscript   normal-^  ğœ·   k     MSE   subscript   normal-^  ğœ·   k      \operatorname{Var}(\widehat{\boldsymbol{\beta}}_{k})=\operatorname{MSE}(%
 \widehat{\boldsymbol{\beta}}_{k})   as well.  Since we have already seen that     Var   (    ğœ·  ^   ols   )    -   Var   (    ğœ·  ^   j   )         Var   subscript   normal-^  ğœ·   ols     Var   subscript   normal-^  ğœ·   j      \operatorname{Var}(\widehat{\boldsymbol{\beta}}_{\mathrm{ols}})-\operatorname{%
 Var}(\widehat{\boldsymbol{\beta}}_{j})        âª°    0    âˆ€  1    â‰¤  j  â‰¤  p       succeeds-or-equals  absent    0   for-all  1         j       p     \succeq 0\;\forall\;1\leq j\leq p   , this would then imply      MSE   (    ğœ·  ^   ols   )    -   MSE   (    ğœ·  ^   k   )     âª°  0     succeeds-or-equals     MSE   subscript   normal-^  ğœ·   ols     MSE   subscript   normal-^  ğœ·   k     0    \operatorname{MSE}(\widehat{\boldsymbol{\beta}}_{\mathrm{ols}})-\operatorname{%
 MSE}(\widehat{\boldsymbol{\beta}}_{k})\succeq 0   for that particular   k   k   k   . Thus in that case, the corresponding     ğœ·  ^   k     subscript   normal-^  ğœ·   k    \widehat{\boldsymbol{\beta}}_{k}   would be a more efficient estimator of   ğœ·   ğœ·   \boldsymbol{\beta}   compared to     ğœ·  ^   ols     subscript   normal-^  ğœ·   ols    \widehat{\boldsymbol{\beta}}_{\mathrm{ols}}   , based on using the mean squared error as the performance criteria. In addition, any given linear form of the corresponding     ğœ·  ^   k     subscript   normal-^  ğœ·   k    \widehat{\boldsymbol{\beta}}_{k}   would also have a lower mean squared error compared to that of the same linear form of     ğœ·  ^   ols     subscript   normal-^  ğœ·   ols    \widehat{\boldsymbol{\beta}}_{\mathrm{ols}}   .  Suppose now that for a given    k  âˆˆ   {  1  ,  â€¦  ,  p  }       k   1  normal-â€¦  p     k\in\{1,\ldots,p\}   ,      V   (   p  -  k   )   T   ğœ·   â‰   ğŸ         superscript   subscript  V    p  k    T   ğœ·   0    V_{\left(p-k\right)}^{T}\boldsymbol{\beta}\neq\mathbf{0}   . Then the corresponding     ğœ·  ^   k     subscript   normal-^  ğœ·   k    \widehat{\boldsymbol{\beta}}_{k}   is biased for   ğœ·   ğœ·   \boldsymbol{\beta}   . However, since     Var   (    ğœ·  ^   ols   )    -   Var   (    ğœ·  ^   k   )         Var   subscript   normal-^  ğœ·   ols     Var   subscript   normal-^  ğœ·   k      \operatorname{Var}(\widehat{\boldsymbol{\beta}}_{\mathrm{ols}})-\operatorname{%
 Var}(\widehat{\boldsymbol{\beta}}_{k})   is     âª°    0    âˆ€  1    â‰¤  k  â‰¤  p       succeeds-or-equals  absent    0   for-all  1         k       p     \succeq 0\;\forall\;1\leq k\leq p   , it is still possible that      MSE   (    ğœ·  ^   ols   )    -   MSE   (    ğœ·  ^   k   )     âª°  0     succeeds-or-equals     MSE   subscript   normal-^  ğœ·   ols     MSE   subscript   normal-^  ğœ·   k     0    \operatorname{MSE}(\widehat{\boldsymbol{\beta}}_{\mathrm{ols}})-\operatorname{%
 MSE}(\widehat{\boldsymbol{\beta}}_{k})\succeq 0   , especially if   k   k   k   is such that the excluded principal components correspond to the smaller eigenvalues, thereby resulting in lower bias .  In order to ensure efficient estimation and prediction performance of PCR as an estimator of   ğœ·   ğœ·   \boldsymbol{\beta}   , Park (1981) 4 proposes the following guideline for selecting the principal components to be used for regression: Drop the    j   t  h      superscript  j    t  h     j^{th}   principal component if and only if     Î»  j   <     (   p   Ïƒ  2    )   /   ğœ·  T    ğœ·        subscript  Î»  j         p   superscript  Ïƒ  2     superscript  ğœ·  T    ğœ·     \lambda_{j}<(p\sigma^{2})/\boldsymbol{\beta}^{T}\boldsymbol{\beta}   . Practical implementation of this guideline of course requires estimates for the unknown model parameters    Ïƒ  2     superscript  Ïƒ  2    \sigma^{2}   and   ğœ·   ğœ·   \boldsymbol{\beta}   . In general, they may be estimated using the unrestricted least squares estimates obtained from the original full model. Park (1981) 5 however provides a slightly modified set of estimates that may be better suited for this purpose.  Unlike the criteria based on the cumulative sum of the eigenvalues of     ğ—  T   ğ—       superscript  ğ—  T   ğ—    \mathbf{X}^{T}\mathbf{X}   , which is probably more suited for addressing the multicollinearity problem and for performing dimension reduction, the above criteria actually attempts to improve the prediction and estimation efficiency of the PCR estimator by involving both the outcome as well as the covariates in the process of selecting the principal components to be used in the regression step. Alternative approaches with similar goals include selection of the principal components based on cross-validation or the Mallows's Cp criteria. Often, the principal components are also selected based on their degree of association with the outcome.  Shrinkage effect of PCR  In general, PCR is essentially a shrinkage estimator that usually retains the high variance principal components (corresponding to the higher eigenvalues of     ğ—  T   ğ—       superscript  ğ—  T   ğ—    \mathbf{X}^{T}\mathbf{X}   ) as covariates in the model and discards the remaining low variance components (corresponding to the lower eigenvalues of     ğ—  T   ğ—       superscript  ğ—  T   ğ—    \mathbf{X}^{T}\mathbf{X}   ). Thus it exerts a discrete shrinkage effect on the low variance components nullifying their contribution completely in the original model. In contrast, the ridge regression estimator exerts a smooth shrinkage effect through the regularization parameter (or, the tuning parameter) inherently involved in its construction. While it does not completely discard any of the components, it exerts a shrinkage effect over all of them in a continuous manner so that the extent of shrinkage is higher for the low variance components and lower for the high variance components. Frank and Friedman (1993) 6 conclude that for the purpose of prediction itself, the ridge estimator, owing to its smooth shrinkage effect, is perhaps a better choice compared to the PCR estimator having a discrete shrinkage effect.  In addition, the principal components are obtained from the eigen-decomposition of   ğ—   ğ—   \mathbf{X}   that involves the observations for the explanatory variables only. Therefore the resulting PCR estimator obtained from using these principal components as covariates need not necessarily have satisfactory predictive performance for the outcome. A somewhat similar estimator that tries to address this issue through its very construction is the partial least squares (PLS) estimator. Similar to PCR, PLS also uses derived covariates of lower dimensions. However unlike PCR, the derived covariates for PLS are obtained based on using both the outcome as well as the covariates. While PCR seeks the high variance directions in the space of the covariates, PLS seeks the directions in the covariate space that are most useful for the prediction of the outcome.  Recently, a variant of the classical PCR known as the supervised PCR was proposed by Bair, Hastie, Paul and Tibshirani (2006). 7 In a spirit similar to that of PLS, it attempts at obtaining derived covariates of lower dimensions based on a criteria that involves both the outcome as well as the covariates. The method starts by performing a set of   p   p   p    simple linear regressions (or, univariate regressions) wherein the outcome vector is regressed separately on each of the   p   p   p   covariates taken one at a time. Then, for some    m  âˆˆ   {  1  ,  â€¦  ,  p  }       m   1  normal-â€¦  p     m\in\{1,\ldots,p\}   , the first   m   m   m   covariates that turn out to be the most correlated with the outcome (based on the degree of significance of the corresponding estimated regression coefficients) are selected for further use. A conventional PCR, as described earlier, is then performed, but now it is based on only the    n  Ã—  m      n  m    n\times m   data matrix corresponding to the observations for the selected covariates. The number of covariates used    m  âˆˆ   {  1  ,  â€¦  ,  p  }       m   1  normal-â€¦  p     m\in\{1,\ldots,p\}   and the subsequent number of principal components used    k  âˆˆ   {  1  ,  â€¦  ,  m  }       k   1  normal-â€¦  m     k\in\{1,\ldots,m\}   are usually selected by cross-validation .  Generalization to kernel settings  The classical PCR method as described above is based on classical PCA and considers a linear regression model for predicting the outcome based on the covariates. However, it can be easily generalized to a kernel machine setting whereby the regression function need not necessarily be linear in the covariates, but instead it can belong to the Reproducing Kernel Hilbert Space associated with any arbitrary (possibly non-linear ), symmetric  positive-definite kernel . The linear regression model turns out to be a special case of this setting when the kernel function is chosen to be the linear kernel .  In general, under the kernel machine setting, the vector of covariates is first mapped into a high-dimensional (potentially infinite-dimensional ) feature space characterized by the kernel function chosen. The mapping so obtained is known as the feature map and each of its coordinates , also known as the feature elements , corresponds to one feature (may be linear or, non-linear ) of the covariates. The regression function is then assumed to be a linear combination of these feature elements . Thus, the underlying regression model in the kernel machine setting is essentially a linear regression model with the understanding that instead of the original set of covariates, the predictors are now given by the vector (potentially infinite-dimensional ) of feature elements obtained by transforming the actual covariates using the feature map .  However, the kernel trick actually enables us to operate in the feature space without ever explicitly computing the feature map . It turns out that it is only sufficient to compute the pairwise inner products among the feature maps for the observed covariate vectors and these inner products are simply given by the values of the kernel function evaluated at the corresponding pairs of covariate vectors. The pairwise inner products so obtained may therefore be represented in the form of a    n  Ã—  n      n  n    n\times n   symmetric non-negative definite matrix also known as the kernel matrix .  PCR in the kernel machine setting can now be implemented by first appropriately centering this kernel matrix (K, say) with respect to the feature space and then performing a kernel PCA on the centered kernel matrix (K', say) whereby an eigendecomposition of K' is obtained. Kernel PCR then proceeds by (usually) selecting a subset of all the eigenvectors so obtained and then performing a standard linear regression of the outcome vector on these selected eigenvectors . The eigenvectors to be used for regression are usually selected using cross-validation . The estimated regression coefficients (having the same dimension as the number of selected eigenvectors) along with the corresponding selected eigenvectors are then used for predicting the outcome for a future observation. In machine learning , this technique is also known as spectral regression .  Clearly, kernel PCR has a discrete shrinkage effect on the eigenvectors of K', quite similar to the discrete shrinkage effect of classical PCR on the principal components, as discussed earlier. However, it should be noted that the feature map associated with the chosen kernel could potentially be infinite-dimensional, and hence the corresponding principal components and principal component directions could be infinite-dimensional as well. Therefore these quantities are often practically intractable under the kernel machine setting. Kernel PCR essentially works around this problem by considering an equivalent dual formulation based on using the spectral decomposition of the associated kernel matrix. Under the linear regression model (which corresponds to choosing the kernel function as the linear kernel), this amounts to considering a spectral decomposition of the corresponding    n  Ã—  n      n  n    n\times n   kernel matrix    ğ—ğ—  T     superscript  ğ—ğ—  T    \mathbf{X}\mathbf{X}^{T}   and then regressing the outcome vector on a selected subset of the eigenvectors of    ğ—ğ—  T     superscript  ğ—ğ—  T    \mathbf{X}\mathbf{X}^{T}   so obtained. It can be easily shown that this is the same as regressing the outcome vector on the corresponding principal components (which are finite-dimensional in this case), as defined in the context of the classical PCR. Thus, for the linear kernel, the kernel PCR based on a dual formulation is exactly equivalent to the classical PCR based on a primal formulation. However, for arbitrary (and possibly non-linear) kernels, this primal formulation may become intractable owing to the infinite dimensionality of the associated feature map. Thus classical PCR becomes practically infeasible in that case, but kernel PCR based on the dual formulation still remains valid and computationally scalable.  Software/source code   R - free statistical environment. PCR is part of pls package functionallity. 8   See also   Principal component analysis  Partial least squares regression  Ridge regression  Multilinear subspace learning  Canonical correlation  Deming regression  Total sum of squares   References  Further reading      "  Category:Regression analysis     â†©  Dodge, Y. (2003) The Oxford Dictionary of Statistical Terms , OUP. ISBN 0-19-920613-9 â†©  â†©    â†©  â†©  http://cran.r-project.org/web/packages/pls/pls.pdf â†©     
   Numerov's method      Numerov's method   Numerov's method is a numerical method to solve ordinary differential equations of second order in which the first-order term does not appear. It is a fourth-order linear multistep method . The method is implicit, but can be made explicit if the differential equation is linear.  Numerov's method was developed by the Russian astronomer Boris Vasil'evich Numerov .  The method  The Numerov method can be used to solve differential equations of the form        (     d  2    d   x  2     +   a   (  x  )     )   y   (  x  )    =  0             superscript  d  2     d   superscript  x  2       a  x    y  x   0    \left(\frac{d^{2}}{dx^{2}}+a(x)\right)y(x)=0     The function    a   (  x  )       a  x    a(x)   is sampled in the interval [a..b] at equidistant positions    x  n     subscript  x  n    x_{n}   . Starting from function values at two consecutive samples    x   n  -  1      subscript  x    n  1     x_{n-1}   and    x  n     subscript  x  n    x_{n}   the remaining function values can be calculated as       y   n  +  1    =      (   2  -     5   h  2    6    a  n     )    y  n    -    (   1  +     h  2   12    a   n  -  1      )    y   n  -  1       1  +     h  2   12    a   n  +  1            subscript  y    n  1            2        5   superscript  h  2    6    subscript  a  n      subscript  y  n        1       superscript  h  2   12    subscript  a    n  1       subscript  y    n  1        1       superscript  h  2   12    subscript  a    n  1         y_{n+1}=\frac{\left(2-\frac{5h^{2}}{6}a_{n}\right)y_{n}-\left(1+\frac{h^{2}}{1%
 2}a_{n-1}\right)y_{n-1}}{1+\frac{h^{2}}{12}a_{n+1}}     where     a  n   =   a   (   x  n   )         subscript  a  n     a   subscript  x  n      a_{n}=a(x_{n})   and     y  n   =   y   (   x  n   )         subscript  y  n     y   subscript  x  n      y_{n}=y(x_{n})   are the function values at the positions    x  n     subscript  x  n    x_{n}   and    h  =    x  n   -   x   n  -  1         h     subscript  x  n    subscript  x    n  1       h=x_{n}-x_{n-1}   is the distance between two consecutive samples.  Nonlinear equations  For nonlinear equations of the form         d  2    d   x  2     y   =   f   (  x  ,  y  )             superscript  d  2     d   superscript  x  2     y     f   x  y      \frac{d^{2}}{dx^{2}}y=f(x,y)     the method is given by        y   n  +  1    =     2   y  n    -   y   n  -  1     +     1  12     h  2    (    f   n  +  1    +   10   f  n    +   f   n  -  1     )      .       subscript  y    n  1          2   subscript  y  n     subscript  y    n  1         1  12    superscript  h  2      subscript  f    n  1      10   subscript  f  n     subscript  f    n  1         y_{n+1}=2y_{n}-y_{n-1}+\tfrac{1}{12}h^{2}(f_{n+1}+10f_{n}+f_{n-1}).     This is an implicit linear multistep method , which reduces to the explicit method given above if f is linear in y by setting     f   (  x  ,  y  )    =   -   a   (  x  )   y   (  x  )           f   x  y        a  x  y  x      f(x,y)=-a(x)y(x)   . It achieves order 4 .  Application  In numerical physics the method is used to find solutions of the unidimensional Schr√∂dinger equation for arbitrary potentials.        [    -     ‚Ñè  2    2  Œº     (     1  r     ‚àÇ  2    ‚àÇ   r  2     r   -    l   (   l  +  1   )     r  2     )     +   V   (  r  )     ]   R   (  r  )    =   E  R   (  r  )           delimited-[]           superscript  Planck-constant-over-2-pi  2     2  Œº          1  r      superscript   2      superscript  r  2     r       l    l  1     superscript  r  2         V  r     R  r     E  R  r     \left[-{\hbar^{2}\over 2\mu}\left(\frac{1}{r}{\partial^{2}\over\partial r^{2}}%
 r-{l(l+1)\over r^{2}}\right)+V(r)\right]R(r)=ER(r)     The above equation can be rewritten in the form        [      ‚àÇ  2    ‚àÇ   r  2     -    l   (   l  +  1   )     r  2     +     2  Œº    ‚Ñè  2     (   E  -   V   (  r  )     )     ]   u   (  r  )    =  0         delimited-[]         superscript   2      superscript  r  2         l    l  1     superscript  r  2           2  Œº    superscript  Planck-constant-over-2-pi  2      E    V  r       u  r   0    \left[{\partial^{2}\over\partial r^{2}}-{l(l+1)\over r^{2}}+{2\mu\over\hbar^{2%
 }}\left(E-V(r)\right)\right]u(r)=0     with     u   (  r  )    =   r  R   (  r  )          u  r     r  R  r     u(r)=rR(r)   . If we compare this equation with the defining equation of the Numerov method we see       a   (  x  )    =      2  Œº    ‚Ñè  2     (   E  -   V   (  x  )     )    -    l   (   l  +  1   )     x  2           a  x           2  Œº    superscript  Planck-constant-over-2-pi  2      E    V  x         l    l  1     superscript  x  2       a(x)=\frac{2\mu}{\hbar^{2}}\left(E-V(x)\right)-\frac{l(l+1)}{x^{2}}     and thus can numerically solve the radial Schr√∂dinger equation.  Derivation  Start with the Taylor expansion of    y   (  x  )       y  x    y(x)   about a point    x  0     subscript  x  0    x_{0}   :       y   (  x  )    =    y   (   x  0   )    +    (   x  -   x  0    )    y  ‚Ä≤    (   x  0   )    +      (   x  -   x  0    )   2    2  !     y  ‚Ä≤‚Ä≤    (   x  0   )    +      (   x  -   x  0    )   3    3  !     y  ‚Ä≤‚Ä≤‚Ä≤    (   x  0   )    +      (   x  -   x  0    )   4    4  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  0   )    +      (   x  -   x  0    )   5    5  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  0   )    +   ùí™   (   h  6   )           y  x       y   subscript  x  0        x   subscript  x  0     superscript  y  normal-‚Ä≤    subscript  x  0         superscript    x   subscript  x  0    2     2     superscript  y  ‚Ä≤‚Ä≤    subscript  x  0         superscript    x   subscript  x  0    3     3     superscript  y  ‚Ä≤‚Ä≤‚Ä≤    subscript  x  0         superscript    x   subscript  x  0    4     4     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  0         superscript    x   subscript  x  0    5     5     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  0      ùí™   superscript  h  6       y(x)=y(x_{0})+(x-x_{0})y^{\prime}(x_{0})+\frac{(x-x_{0})^{2}}{2!}y^{\prime%
 \prime}(x_{0})+\frac{(x-x_{0})^{3}}{3!}y^{\prime\prime\prime}(x_{0})+\frac{(x-%
 x_{0})^{4}}{4!}y^{\prime\prime\prime\prime}(x_{0})+\frac{(x-x_{0})^{5}}{5!}y^{%
 \prime\prime\prime\prime\prime}(x_{0})+\mathcal{O}(h^{6})     Denote the distance from   x   x   x   to    x  0     subscript  x  0    x_{0}   by    h  =   x  -   x  0        h    x   subscript  x  0      h=x-x_{0}   and, noting that this means    x  =    x  0   +  h       x     subscript  x  0   h     x=x_{0}+h   , we can write the above equation as       y   (    x  0   +  h   )    =    y   (   x  0   )    +   h   y  ‚Ä≤    (   x  0   )    +     h  2    2  !     y  ‚Ä≤‚Ä≤    (   x  0   )    +     h  3    3  !     y  ‚Ä≤‚Ä≤‚Ä≤    (   x  0   )    +     h  4    4  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  0   )    +     h  5    5  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  0   )    +   ùí™   (   h  6   )           y     subscript  x  0   h        y   subscript  x  0      h   superscript  y  normal-‚Ä≤    subscript  x  0         superscript  h  2     2     superscript  y  ‚Ä≤‚Ä≤    subscript  x  0         superscript  h  3     3     superscript  y  ‚Ä≤‚Ä≤‚Ä≤    subscript  x  0         superscript  h  4     4     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  0         superscript  h  5     5     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  0      ùí™   superscript  h  6       y(x_{0}+h)=y(x_{0})+hy^{\prime}(x_{0})+\frac{h^{2}}{2!}y^{\prime\prime}(x_{0})%
 +\frac{h^{3}}{3!}y^{\prime\prime\prime}(x_{0})+\frac{h^{4}}{4!}y^{\prime\prime%
 \prime\prime}(x_{0})+\frac{h^{5}}{5!}y^{\prime\prime\prime\prime\prime}(x_{0})%
 +\mathcal{O}(h^{6})     Computationally, this amounts taking a step forward by an amount h. If we want to take a step backwards , replace every h with -h for the equation of    y   (    x  0   -  h   )       y     subscript  x  0   h     y(x_{0}-h)   :       y   (    x  0   -  h   )    =         y   (   x  0   )    -   h   y  ‚Ä≤    (   x  0   )     +     h  2    2  !     y  ‚Ä≤‚Ä≤    (   x  0   )     -     h  3    3  !     y  ‚Ä≤‚Ä≤‚Ä≤    (   x  0   )     +     h  4    4  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  0   )     -     h  5    5  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  0   )     +   ùí™   (   h  6   )           y     subscript  x  0   h                  y   subscript  x  0      h   superscript  y  normal-‚Ä≤    subscript  x  0          superscript  h  2     2     superscript  y  ‚Ä≤‚Ä≤    subscript  x  0          superscript  h  3     3     superscript  y  ‚Ä≤‚Ä≤‚Ä≤    subscript  x  0          superscript  h  4     4     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  0          superscript  h  5     5     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  0       ùí™   superscript  h  6       y(x_{0}-h)=y(x_{0})-hy^{\prime}(x_{0})+\frac{h^{2}}{2!}y^{\prime\prime}(x_{0})%
 -\frac{h^{3}}{3!}y^{\prime\prime\prime}(x_{0})+\frac{h^{4}}{4!}y^{\prime\prime%
 \prime\prime}(x_{0})-\frac{h^{5}}{5!}y^{\prime\prime\prime\prime\prime}(x_{0})%
 +\mathcal{O}(h^{6})     Note that only the odd powers of h experienced a sign change. On an evenly spaced grid, the n th site on a computational grid corresponds to position    x  n     subscript  x  n    x_{n}   if the step-size between grid points are of length   h   h   h   (hence h should be small for the computation to be accurate). This means we have sampling points    (   x   n  -  1    ,   y   n  -  1    )      subscript  x    n  1     subscript  y    n  1      (x_{n-1},y_{n-1})   and    (   x   n  +  1    ,   y   n  +  1    )      subscript  x    n  1     subscript  y    n  1      (x_{n+1},y_{n+1})   . Taking the equations for    y   n  -  1      subscript  y    n  1     y_{n-1}   and    y   n  +  1      subscript  y    n  1     y_{n+1}   from continuous space to discrete space, we see that       y   n  +  1    =   y   (    x  n   +  h   )    =    y   (   x  n   )    +   h   y  ‚Ä≤    (   x  n   )    +     h  2    2  !     y  ‚Ä≤‚Ä≤    (   x  n   )    +     h  3    3  !     y  ‚Ä≤‚Ä≤‚Ä≤    (   x  n   )    +     h  4    4  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  n   )    +     h  5    5  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  n   )    +   ùí™   (   h  6   )            subscript  y    n  1      y     subscript  x  n   h             y   subscript  x  n      h   superscript  y  normal-‚Ä≤    subscript  x  n         superscript  h  2     2     superscript  y  ‚Ä≤‚Ä≤    subscript  x  n         superscript  h  3     3     superscript  y  ‚Ä≤‚Ä≤‚Ä≤    subscript  x  n         superscript  h  4     4     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  n         superscript  h  5     5     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  n      ùí™   superscript  h  6        y_{n+1}=y(x_{n}+h)=y(x_{n})+hy^{\prime}(x_{n})+\frac{h^{2}}{2!}y^{\prime\prime%
 }(x_{n})+\frac{h^{3}}{3!}y^{\prime\prime\prime}(x_{n})+\frac{h^{4}}{4!}y^{%
 \prime\prime\prime\prime}(x_{n})+\frac{h^{5}}{5!}y^{\prime\prime\prime\prime%
 \prime}(x_{n})+\mathcal{O}(h^{6})          y   n  -  1    =   y   (    x  n   -  h   )    =         y   (   x  n   )    -   h   y  ‚Ä≤    (   x  n   )     +     h  2    2  !     y  ‚Ä≤‚Ä≤    (   x  n   )     -     h  3    3  !     y  ‚Ä≤‚Ä≤‚Ä≤    (   x  n   )     +     h  4    4  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  n   )     -     h  5    5  !     y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (   x  n   )     +   ùí™   (   h  6   )            subscript  y    n  1      y     subscript  x  n   h                       y   subscript  x  n      h   superscript  y  normal-‚Ä≤    subscript  x  n          superscript  h  2     2     superscript  y  ‚Ä≤‚Ä≤    subscript  x  n          superscript  h  3     3     superscript  y  ‚Ä≤‚Ä≤‚Ä≤    subscript  x  n          superscript  h  4     4     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  n          superscript  h  5     5     superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤‚Ä≤    subscript  x  n       ùí™   superscript  h  6        y_{n-1}=y(x_{n}-h)=y(x_{n})-hy^{\prime}(x_{n})+\frac{h^{2}}{2!}y^{\prime\prime%
 }(x_{n})-\frac{h^{3}}{3!}y^{\prime\prime\prime}(x_{n})+\frac{h^{4}}{4!}y^{%
 \prime\prime\prime\prime}(x_{n})-\frac{h^{5}}{5!}y^{\prime\prime\prime\prime%
 \prime}(x_{n})+\mathcal{O}(h^{6})     The sum of those two equations gives        y   n  -  1    +   y   n  +  1     =    2   y  n    +    h  2    y  n  ‚Ä≤‚Ä≤    +     h  4   12    y  n  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    +   ùí™   (   h  6   )            subscript  y    n  1     subscript  y    n  1         2   subscript  y  n       superscript  h  2    subscript   superscript  y  ‚Ä≤‚Ä≤   n         superscript  h  4   12    subscript   superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤   n      ùí™   superscript  h  6       y_{n-1}+y_{n+1}=2y_{n}+{h^{2}}y^{\prime\prime}_{n}+\frac{h^{4}}{12}y^{\prime%
 \prime\prime\prime}_{n}+\mathcal{O}(h^{6})     We solve this equation for    y  n  ‚Ä≤‚Ä≤     subscript   superscript  y  ‚Ä≤‚Ä≤   n    y^{\prime\prime}_{n}   and replace it by the expression     y  n  ‚Ä≤‚Ä≤   =   -    a  n    y  n          subscript   superscript  y  ‚Ä≤‚Ä≤   n        subscript  a  n    subscript  y  n       y^{\prime\prime}_{n}=-a_{n}y_{n}   which we get from the defining differential equation.        h  2    a  n    y  n    =     2   y  n    -   y   n  -  1    -   y   n  +  1     +     h  4   12    y  n  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    +   ùí™   (   h  6   )            superscript  h  2    subscript  a  n    subscript  y  n          2   subscript  y  n     subscript  y    n  1     subscript  y    n  1          superscript  h  4   12    subscript   superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤   n      ùí™   superscript  h  6       h^{2}a_{n}y_{n}=2y_{n}-y_{n-1}-y_{n+1}+\frac{h^{4}}{12}y^{\prime\prime\prime%
 \prime}_{n}+\mathcal{O}(h^{6})     We take the second derivative of our defining differential equation and get        y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤    (  x  )    =   -     d  2    d   x  2      [   a   (  x  )   y   (  x  )    ]            superscript  y  ‚Ä≤‚Ä≤‚Ä≤‚Ä≤   x          superscript  d  2     d   superscript  x  2      delimited-[]    a  x  y  x        y^{\prime\prime\prime\prime}(x)=-\frac{d^{2}}{dx^{2}}\left[a(x)y(x)\right]   We replace the second derivative     d  2    d   x  2         superscript  d  2     d   superscript  x  2      \frac{d^{2}}{dx^{2}}   with the second order difference quotient and insert this into our equation for     a  n    y  n        subscript  a  n    subscript  y  n     a_{n}y_{n}   (note that we take the mixed forward and backward finite difference, not the double forward difference or the double backward difference)        h  2    a  n    y  n    =     2   y  n    -   y   n  -  1    -   y   n  +  1    -     h  4   12        a   n  -  1     y   n  -  1     -   2   a  n    y  n     +    a   n  +  1     y   n  +  1       h  2      +   ùí™   (   h  6   )            superscript  h  2    subscript  a  n    subscript  y  n          2   subscript  y  n     subscript  y    n  1     subscript  y    n  1         superscript  h  4   12            subscript  a    n  1     subscript  y    n  1       2   subscript  a  n    subscript  y  n        subscript  a    n  1     subscript  y    n  1       superscript  h  2        ùí™   superscript  h  6       h^{2}a_{n}y_{n}=2y_{n}-y_{n-1}-y_{n+1}-\frac{h^{4}}{12}\frac{a_{n-1}y_{n-1}-2a%
 _{n}y_{n}+a_{n+1}y_{n+1}}{h^{2}}+\mathcal{O}(h^{6})     We solve for    y   n  +  1      subscript  y    n  1     y_{n+1}   to get        y   n  +  1    =       (   2  -     5   h  2    6    a  n     )    y  n    -    (   1  +     h  2   12    a   n  -  1      )    y   n  -  1       1  +     h  2   12    a   n  +  1       +   ùí™   (   h  6   )      .       subscript  y    n  1              2        5   superscript  h  2    6    subscript  a  n      subscript  y  n        1       superscript  h  2   12    subscript  a    n  1       subscript  y    n  1        1       superscript  h  2   12    subscript  a    n  1         ùí™   superscript  h  6       y_{n+1}=\frac{\left(2-\frac{5h^{2}}{6}a_{n}\right)y_{n}-\left(1+\frac{h^{2}}{1%
 2}a_{n-1}\right)y_{n-1}}{1+\frac{h^{2}}{12}a_{n+1}}+\mathcal{O}(h^{6}).     This yields Numerov's method if we ignore the term of order    h  6     superscript  h  6    h^{6}   . It follows that the order of convergence (assuming stability) is 4.  References    . This book includes the following references:   .  .   External links  "  Category:Numerical differential equations   
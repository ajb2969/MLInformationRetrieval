   Probable prime      Probable prime   In number theory , a probable prime (PRP) is an integer that satisfies a specific condition that is satisfied by all prime numbers , but which is not satisfied by most composite numbers . Different types of probable primes have different specific conditions. While there may be probable primes that are composite (called pseudoprimes ), the condition is generally chosen in order to make such exceptions rare.  Fermat's test for compositeness, which is based on Fermat's little theorem , works as follows: given an integer n , choose some integer a  coprime to n and calculate a n − 1  modulo  n . If the result is different from 1, then n is composite. If the result is 1, then n is likely to be prime; n is then called a probable prime to base  a . A weak probable prime to base  a is an integer that is a probable prime to base a , but which is not a strong probable prime to base a (see below).  For a fixed base a , it is unusual for a composite number to be a probable prime (that is, a pseudoprime) to that base. For example, there are only 21853 pseudoprimes base 2 that are less than 25·10 9 (see page 1005 of 1 ).  Properties  Probable primality is a basis for efficient primality testing  algorithms , which find application in cryptography . These algorithms are usually probabilistic in nature. The idea is that while there are composite probable primes to base a for any fixed a , we may hope there exists some fixed P k'', and as this decreases exponentially, only moderate k is required to make this probability negligibly small (compared to, for example, the probability of computer hardware error).  This is unfortunately false for weak probable primes, because there exist Carmichael numbers ; but it is true for more refined notions of probable primality, such as strong probable primes ( P = 1/4, Miller–Rabin algorithm ), or Euler probable primes ( P = 1/2, Solovay–Strassen algorithm ).  Even when a deterministic primality proof is required, a useful first step is to test for probable primality. This can quickly eliminate (with certainty) most composites.  A PRP test is sometimes combined with a table of small pseudoprimes to quickly establish the primality of a given number smaller than some threshold.  Variations  An Euler probable prime to base  a is an integer that is indicated prime by the somewhat stronger theorem that for any prime p , a ( p − 1)/2 equals    (   a  p   )      a  p    (\tfrac{a}{p})   modulo p , where    (   a  p   )      a  p    (\tfrac{a}{p})   is the Legendre symbol . An Euler probable prime which is composite is called an Euler–Jacobi pseudoprime to base a . The smallest Euler-Jacobi pseudoprime to base 2 is 561 (see page 1004 of 2 ). There are 11347 Euler-Jacobi pseudoprimes base 2 that are less than 25·10 9 (page 1005 of 3 ).  This test may be improved by using the fact that the only square roots of 1 modulo a prime are 1 and −1. Write n = d · 2 s + 1, where d is odd. The number n is a strong probable prime (SPRP) to base  a if one of the following conditions holds:        a  d   ≡   1     (   mod  n   )     ,       superscript  a  d    annotated  1   pmod  n      a^{d}\equiv 1\;\;(\mathop{{\rm mod}}n),\;          a   d  ⋅   2  r     ≡  -  1   (   mod  n   )   for some  0  ≤  r  ≤  s  -   1.      fragments   superscript  a   normal-⋅  d   superscript  2  r       1   pmod  n   for some  0   r   s   1.    a^{d\cdot 2^{r}}\equiv-1\;\;(\mathop{{\rm mod}}n)\text{ for some }0\leq r\leq s%
 -1.\,     A composite strong probable prime to base a is called a strong pseudoprime to base a . Every strong probable prime to base a is also an Euler probable prime to the same base, but not vice versa.  The smallest strong pseudoprime base 2 is 2047 (page 1004 of 4 ). There are 4842 strong pseudoprimes base 2 that are less than 25·10 9 (page 1005 of 5 ).  There are also Lucas probable primes , which are based on Lucas sequences . A Lucas probable prime test can be used alone. The Baillie-PSW primality test combines a Lucas test with a strong probable prime test.  Example of SPRP  To test if 97 is probably prime:   Step 1: Find   d   d   d   and   s   s   s   for which    96  =   d  ⋅   2  s        96   normal-⋅  d   superscript  2  s      96=d\cdot 2^{s}   , where   d   d   d   is odd  Beginning with    s  =  0      s  0    s=0   ,   d   d   d   would be   96   96   96     Increasing   s   s   s   , we see that    d  =  3      d  3    d=3   and    s  =  5      s  5    s=5   , since    96  =   3  ⋅   2  5        96   normal-⋅  3   superscript  2  5      96=3\cdot 2^{5}      Step 2: Choose   a   a   a   , co-prime to   97   97   97   . We will choose   2   2   2     Step 3: Calculate     a  d      (   mod  n   )      annotated   superscript  a  d    pmod  n     a^{d}\;\;(\mathop{{\rm mod}}n)   , i.e.     2  3      (   mod  97   )      annotated   superscript  2  3    pmod  97     2^{3}\;\;(\mathop{{\rm mod}}97)   . Since it isn't congruent to    1     (   mod  97   )      annotated  1   pmod  97     1\;\;(\mathop{{\rm mod}}97)   , we continue to test the next condition  Step 4: Calculate     2   3  ⋅   2  r        (   mod  97   )      annotated   superscript  2   normal-⋅  3   superscript  2  r      pmod  97     2^{3\cdot 2^{r}}\;\;(\mathop{{\rm mod}}97)   for    0  ≤  r  <  s        0  r       s     0\leq r   . If it is congruent to    96     (   mod  97   )      annotated  96   pmod  97     96\;\;(\mathop{{\rm mod}}97)   ,   97   97   97   is probably prime. Otherwise,   97   97   97   is definitely composite       r  =  0   :    2  3   ≡   8     (   mod  97   )        normal-:    r  0      superscript  2  3    annotated  8   pmod  97       r=0:2^{3}\equiv 8\;\;(\mathop{{\rm mod}}97)          r  =  1   :    2  6   ≡   64     (   mod  97   )        normal-:    r  1      superscript  2  6    annotated  64   pmod  97       r=1:2^{6}\equiv 64\;\;(\mathop{{\rm mod}}97)          r  =  2   :    2  12   ≡   22     (   mod  97   )        normal-:    r  2      superscript  2  12    annotated  22   pmod  97       r=2:2^{12}\equiv 22\;\;(\mathop{{\rm mod}}97)          r  =  3   :    2  24   ≡   96     (   mod  97   )        normal-:    r  3      superscript  2  24    annotated  96   pmod  97       r=3:2^{24}\equiv 96\;\;(\mathop{{\rm mod}}97)      Therefore,   97   97   97   is probably prime.   See also   Baillie-PSW primality test  Euler–Jacobi pseudoprime  Carmichael number  Miller–Rabin primality test  Provable prime   External links   The prime glossary – Probable prime  The PRP Top 10000 (the largest known probable primes)   References  "  Category:Pseudoprimes     ↩         
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1871">Random permutation statistics</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Random permutation statistics</h1>
<hr/>

<p>The <strong>statistics of random permutations</strong>, such as the <a href="Permutation_group#Examples" title="wikilink">cycle structure</a> of a <a href="random_permutation" title="wikilink">random permutation</a> are of fundamental importance in the <a href="analysis_of_algorithms" title="wikilink">analysis of algorithms</a>, especially of sorting algorithms, which operate on random permutations. Suppose, for example, that we are using <a class="uri" href="quickselect" title="wikilink">quickselect</a> (a cousin of <a class="uri" href="quicksort" title="wikilink">quicksort</a>) to select a random element of a random permutation. Quickselect will perform a partial sort on the array, as it partitions the array according to the pivot. Hence a permutation will be less disordered after quickselect has been performed. The amount of disorder that remains may be analysed with generating functions. These generating functions depend in a fundamental way on the generating functions of random permutation statistics. Hence it is of vital importance to compute these generating functions.</p>

<p>The article on <a href="random_permutation" title="wikilink">random permutations</a> contains an introduction to random permutations.</p>
<h2 id="the-fundamental-relation">The fundamental relation</h2>

<p>Permutations are sets of labelled cycles. Using the labelled case of the <a href="Symbolic_combinatorics#The_Flajolet–Sedgewick_fundamental_theorem" title="wikilink">Flajolet–Sedgewick fundamental theorem</a> and writing 

<math display="inline" id="Random_permutation_statistics:0">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒫</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒫</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\mathcal{P}
  </annotation>
 </semantics>
</math>

 for the set of permutations and 

<math display="inline" id="Random_permutation_statistics:1">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒵</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒵</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\mathcal{Z}
  </annotation>
 </semantics>
</math>

 for the singleton set, we have</p>

<p>

<math display="block" id="Random_permutation_statistics:2">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>𝔓</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>ℭ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi class="ltx_font_mathcaligraphic">𝒵</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi class="ltx_font_mathcaligraphic">𝒫</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>𝔓</ci>
     <apply>
      <times></times>
      <ci>ℭ</ci>
      <ci>𝒵</ci>
     </apply>
    </apply>
    <ci>𝒫</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}(\mathfrak{C}(\mathcal{Z}))=\mathcal{P}.
  </annotation>
 </semantics>
</math>

</p>

<p>Translating into <a href="exponential_generating_function" title="wikilink">exponential generating functions</a> (EGFs), we have</p>

<p>

<math display="block" id="Random_permutation_statistics:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mi>log</mi>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mn>1</mn>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>z</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <exp></exp>
     <apply>
      <log></log>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\log\frac{1}{1-z}=\frac{1}{1-z}
  </annotation>
 </semantics>
</math>

</p>

<p>where we have used the fact that the EGF of the set of permutations (there are <em>n</em>! permutations of <em>n</em> elements) is</p>

<p>

<math display="block" id="Random_permutation_statistics:4">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <mfrac>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <geq></geq>
       <ci>n</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{n\geq 0}\frac{n!}{n!}z^{n}=\frac{1}{1-z}.
  </annotation>
 </semantics>
</math>

</p>

<p>This one equation will allow us to derive a surprising number of permutation statistics. Firstly, by dropping terms from 

<math display="inline" id="Random_permutation_statistics:5">
 <semantics>
  <mi>𝔓</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝔓</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\mathfrak{P}
  </annotation>
 </semantics>
</math>

, i.e. exp, we may constrain the <strong>number of cycles</strong> that a permutation contains, e.g. by restricting the EGF to 

<math display="inline" id="Random_permutation_statistics:6">
 <semantics>
  <msub>
   <mi>𝔓</mi>
   <mn>2</mn>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>𝔓</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\mathfrak{P}_{2}
  </annotation>
 </semantics>
</math>

 we obtain permutations containing two cycles. Secondly, note that the EGF of labelled cycles, i.e. of 

<math display="inline" id="Random_permutation_statistics:7">
 <semantics>
  <mrow>
   <mi>ℭ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi class="ltx_font_mathcaligraphic">𝒵</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ℭ</ci>
    <ci>𝒵</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle\mathfrak{C}(\mathcal{Z})
  </annotation>
 </semantics>
</math>

, is</p>

<p>

<math display="block" id="Random_permutation_statistics:8">
 <semantics>
  <mrow>
   <mrow>
    <mi>log</mi>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>≥</mo>
      <mn>1</mn>
     </mrow>
    </munder>
    <mfrac>
     <msup>
      <mi>z</mi>
      <mi>k</mi>
     </msup>
     <mi>k</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <log></log>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <geq></geq>
       <ci>k</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>k</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log\frac{1}{1-z}=\sum_{k\geq 1}\frac{z^{k}}{k}
  </annotation>
 </semantics>
</math>

</p>

<p>because there are <em>k</em>! / <em>k</em> labelled cycles.</p>

<p>This means that by dropping terms from this generating function, we may constrain the <strong>size of the cycles</strong> that occur in a permutation and obtain an EGF of the permutations containing only cycles of a given size.</p>

<p>Now instead of removing and selecting cycles, let's put different weights on different size cycles. If 

<math display="inline" id="Random_permutation_statistics:9">
 <semantics>
  <mrow>
   <mrow>
    <mi>b</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>k</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>ℕ</mi>
    <mo>→</mo>
    <mi>ℝ</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <apply>
     <times></times>
     <ci>b</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <ci>ℕ</ci>
     <ci>ℝ</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \scriptstyle b(k):\mathbb{N}\rightarrow\mathbb{R}
  </annotation>
 </semantics>
</math>

 is a weight function that depends only on the size <em>k</em> of the cycle and for brevity we write</p>

<p>

<math display="block" id="Random_permutation_statistics:10">
 <semantics>
  <mrow>
   <mrow>
    <mi>b</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>σ</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>c</mi>
      <mo>∈</mo>
      <mi>σ</mi>
     </mrow>
    </munder>
    <mrow>
     <mi>b</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>c</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>b</ci>
     <ci>σ</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>c</ci>
       <ci>σ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b(\sigma)=\sum_{c\in\sigma}b(c)
  </annotation>
 </semantics>
</math>

</p>

<p>the value of <em>b</em> for a permutation 

<math display="inline" id="Random_permutation_statistics:11">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

 to be the sum of its values on the cycles, then we may mark cycles of length <em>k</em> with <em>u</em><sup><em>b</em>(<em>k</em>)</sup> and obtain a bivariate generating function <em>g</em>(<em>z</em>, <em>u</em>) that describes the parameter, i.e.</p>

<p>

<math display="block" id="Random_permutation_statistics:12">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>+</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>≥</mo>
       <mn>1</mn>
      </mrow>
     </munder>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>σ</mi>
          <mo>∈</mo>
          <msub>
           <mi>S</mi>
           <mi>n</mi>
          </msub>
         </mrow>
        </munder>
        <msup>
         <mi>u</mi>
         <mrow>
          <mi>b</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>σ</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>n</mi>
       </msup>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>≥</mo>
       <mn>1</mn>
      </mrow>
     </munder>
     <mrow>
      <msup>
       <mi>u</mi>
       <mrow>
        <mi>b</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>k</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </msup>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>k</mi>
       </msup>
       <mi>k</mi>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <in></in>
           <ci>σ</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>S</ci>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <apply>
           <times></times>
           <ci>b</ci>
           <ci>σ</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <exp></exp>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <apply>
          <times></times>
          <ci>b</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=1+\sum_{n\geq 1}\left(\sum_{\sigma\in S_{n}}u^{b(\sigma)}\right)\frac{z%
^{n}}{n!}=\exp\sum_{k\geq 1}u^{b(k)}\frac{z^{k}}{k}
  </annotation>
 </semantics>
</math>

</p>

<p>This is a mixed generating function which is exponential in the permutation size and ordinary in the secondary parameter <em>u.</em> Differentiating and evaluating at <em>u</em> = 1, we have</p>

<p>

<math display="block" id="Random_permutation_statistics:13">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <mi>u</mi>
       </mrow>
      </mfrac>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mi>u</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <mi>u</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>≥</mo>
       <mn>1</mn>
      </mrow>
     </munder>
     <mrow>
      <mi>b</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>k</mi>
       </msup>
       <mi>k</mi>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>≥</mo>
      <mn>1</mn>
     </mrow>
    </munder>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>σ</mi>
         <mo>∈</mo>
         <msub>
          <mi>S</mi>
          <mi>n</mi>
         </msub>
        </mrow>
       </munder>
       <mrow>
        <mi>b</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>σ</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <in></in>
          <ci>σ</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>S</ci>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>b</ci>
         <ci>σ</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial u}g(z,u)\Bigg|_{u=1}=\frac{1}{1-z}\sum_{k\geq 1}b(k)%
\frac{z^{k}}{k}=\sum_{n\geq 1}\left(\sum_{\sigma\in S_{n}}b(\sigma)\right)%
\frac{z^{n}}{n!}
  </annotation>
 </semantics>
</math>

</p>

<p>i.e. the EGF of the sum of <em>b</em> over all permutations, or alternatively, the OGF, or more precisely, PGF (probability generating function) of the expectation of <em>b</em>.</p>

<p>This article uses the coefficient extraction operator [<em>z</em><sup><em>n</em></sup>], documented on the page for <a href="formal_power_series" title="wikilink">formal power series</a>.</p>
<h2 id="number-of-permutations-that-are-involutions">Number of permutations that are involutions</h2>

<p>An involution is a permutation σ so that σ<sup>2</sup> = 1 under permutation composition. It follows that σ may only contain cycles of length one or two, i.e. the EGF <em>g</em>(<em>z</em>) of these permutations is</p>

<p>

<math display="block" id="Random_permutation_statistics:14">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <ci>z</ci>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z)=\exp\left(z+\frac{1}{2}z^{2}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>This gives the explicit formula for the total number 

<math display="inline" id="Random_permutation_statistics:15">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>I</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I(n)
  </annotation>
 </semantics>
</math>

 of involutions among the permutations σ ∈ <em>S</em><sub><em>n</em></sub>:</p>

<p>

<math display="block" id="Random_permutation_statistics:16">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>I</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mo>+</mo>
         <mrow>
          <mn>2</mn>
          <mi>b</mi>
         </mrow>
        </mrow>
        <mo>=</mo>
        <mi>n</mi>
       </mrow>
      </munder>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mpadded width="+2.8pt">
         <msup>
          <mn>2</mn>
          <mi>b</mi>
         </msup>
        </mpadded>
        <mrow>
         <mi>b</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>b</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <mrow>
         <mi>n</mi>
         <mo>/</mo>
         <mn>2</mn>
        </mrow>
        <mo stretchy="false">⌋</mo>
       </mrow>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mrow>
            <mn>2</mn>
            <mi>b</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mpadded width="+2.8pt">
         <msup>
          <mn>2</mn>
          <mi>b</mi>
         </msup>
        </mpadded>
        <mrow>
         <mi>b</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>I</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>g</ci>
      <ci>z</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <apply>
          <plus></plus>
          <ci>a</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>b</ci>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <factorial></factorial>
          <ci>a</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cn type="float">2</cn>
          <ci>b</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>b</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>b</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <floor></floor>
         <apply>
          <divide></divide>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <factorial></factorial>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>b</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <cn type="float">2</cn>
          <ci>b</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>b</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I(n)=n![z^{n}]g(z)=n!\sum_{a+2b=n}\frac{1}{a!\;2^{b}\;b!}=n!\sum_{b=0}^{%
\lfloor n/2\rfloor}\frac{1}{(n-2b)!\;2^{b}\;b!}.
  </annotation>
 </semantics>
</math>

</p>

<p>Dividing by <em>n</em>! yields the probability that a random permutation is an involution. These numbers are known as <a href="Telephone_number_(mathematics)" title="wikilink">Telephone numbers</a>.</p>
<h2 id="number-of-permutations-that-are-mth-roots-of-unity">Number of permutations that are <em>m</em>th roots of unity</h2>

<p>This generalizes the concept of an involution. An <em>m</em>th root of unity is a permutation σ so that σ<sup><em>m</em></sup> = 1 under permutation composition. Now every time we apply σ we move one step in parallel along all of its cycles. A cycle of length <em>d</em> applied <em>d</em> times produces the identity permutation on <em>d</em> elements (<em>d</em> fixed points) and <em>d</em> is the smallest value to do so. Hence <em>m</em> must be a multiple of all cycle sizes <em>d</em>, i.e. the only possible cycles are those whose length <em>d</em> is a divisor of <em>m</em>. It follows that the EGF <em>g</em>(<em>x</em>) of these permutations is</p>

<p>

<math display="block" id="Random_permutation_statistics:17">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>d</mi>
         <mo>∣</mo>
         <mi>m</mi>
        </mrow>
       </munder>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>d</mi>
        </msup>
        <mi>d</mi>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">m</csymbol>
       </cerror>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>d</ci>
       </apply>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z)=\exp\left(\sum_{d\mid m}\frac{z^{d}}{d}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>When <em>m</em> = <em>p</em>, where <em>p</em> is prime, this simplifies to</p>

<p>

<math display="block" id="Random_permutation_statistics:18">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mo>+</mo>
         <mrow>
          <mi>p</mi>
          <mi>b</mi>
         </mrow>
        </mrow>
        <mo>=</mo>
        <mi>n</mi>
       </mrow>
      </munder>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mi>a</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mpadded width="+2.8pt">
         <msup>
          <mi>p</mi>
          <mi>b</mi>
         </msup>
        </mpadded>
        <mrow>
         <mi>b</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>b</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <mrow>
         <mi>n</mi>
         <mo>/</mo>
         <mi>p</mi>
        </mrow>
        <mo stretchy="false">⌋</mo>
       </mrow>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mrow>
            <mi>p</mi>
            <mi>b</mi>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mpadded width="+2.8pt">
         <msup>
          <mi>p</mi>
          <mi>b</mi>
         </msup>
        </mpadded>
        <mrow>
         <mi>b</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>g</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <apply>
          <plus></plus>
          <ci>a</ci>
          <apply>
           <times></times>
           <ci>p</ci>
           <ci>b</ci>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <factorial></factorial>
          <ci>a</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>p</ci>
          <ci>b</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>b</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>b</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <floor></floor>
         <apply>
          <divide></divide>
          <ci>n</ci>
          <ci>p</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <apply>
          <factorial></factorial>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <apply>
            <times></times>
            <ci>p</ci>
            <ci>b</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>p</ci>
          <ci>b</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>b</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]g(z)=n!\sum_{a+pb=n}\frac{1}{a!\;p^{b}\;b!}=n!\sum_{b=0}^{\lfloor n/p%
\rfloor}\frac{1}{(n-pb)!\;p^{b}\;b!}.
  </annotation>
 </semantics>
</math>

</p>
<h2 id="number-of-permutations-of-order-exactly-k">Number of permutations of order exactly <em>k</em></h2>

<p>This one can be done by <a href="Möbius_inversion" title="wikilink">Möbius inversion</a>. Working with the same concept as in the previous entry we note that the combinatorial species 

<math display="inline" id="Random_permutation_statistics:19">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒬</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒬</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Q}
  </annotation>
 </semantics>
</math>

 of permutations whose order divides <em>k</em> is given by</p>

<p>

<math display="block" id="Random_permutation_statistics:20">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒬</mi>
    <mo>=</mo>
    <mrow>
     <mi>𝔓</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>d</mi>
         <mo>∣</mo>
         <mi>k</mi>
        </mrow>
       </munder>
       <mrow>
        <msub>
         <mi>ℭ</mi>
         <mi>d</mi>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi class="ltx_font_mathcaligraphic">𝒵</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒬</ci>
    <apply>
     <times></times>
     <ci>𝔓</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">k</csymbol>
       </cerror>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ℭ</ci>
        <ci>d</ci>
       </apply>
       <ci>𝒵</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Q}=\mathfrak{P}\left(\sum_{d\mid k}\mathfrak{C}_{d}(\mathcal{Z})%
\right).
  </annotation>
 </semantics>
</math>

 Translation to exponential generating functions we obtain the EGF of permutations whose order divides <em>k</em>, which is</p>

<p>

<math display="block" id="Random_permutation_statistics:21">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>Q</mi>
      <mi>k</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>d</mi>
         <mo>∣</mo>
         <mi>k</mi>
        </mrow>
       </munder>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>d</mi>
        </msup>
        <mi>d</mi>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Q</ci>
      <ci>k</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">k</csymbol>
       </cerror>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>d</ci>
       </apply>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{k}(z)=\exp\left(\sum_{d\mid k}\frac{z^{d}}{d}\right).
  </annotation>
 </semantics>
</math>

 Now we can use this generating function to count permutations of order exactly <em>k</em>. Let 

<math display="inline" id="Random_permutation_statistics:22">
 <semantics>
  <msub>
   <mi>p</mi>
   <mrow>
    <mi>n</mi>
    <mo>,</mo>
    <mi>d</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>p</ci>
    <list>
     <ci>n</ci>
     <ci>d</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{n,d}
  </annotation>
 </semantics>
</math>


 be the number of permutations on <em>n</em> whose order is exactly <em>d</em> and 

<math display="inline" id="Random_permutation_statistics:23">
 <semantics>
  <msub>
   <mi>q</mi>
   <mrow>
    <mi>n</mi>
    <mo>,</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>q</ci>
    <list>
     <ci>n</ci>
     <ci>k</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q_{n,k}
  </annotation>
 </semantics>
</math>

 the number of permutations on <em>n</em> the permutation count whose order divides <em>k</em>. Then we have</p>

<p>

<math display="block" id="Random_permutation_statistics:24">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>d</mi>
       <mo stretchy="false">|</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <msub>
      <mi>p</mi>
      <mrow>
       <mi>n</mi>
       <mo>,</mo>
       <mi>d</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>q</mi>
     <mrow>
      <mi>n</mi>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">d</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">k</csymbol>
      </cerror>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <list>
       <ci>n</ci>
       <ci>d</ci>
      </list>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>q</ci>
     <list>
      <ci>n</ci>
      <ci>k</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{d|k}p_{n,d}=q_{n,k}.
  </annotation>
 </semantics>
</math>

 It follows by <a href="Möbius_inversion" title="wikilink">Möbius inversion</a> that</p>

<p>

<math display="block" id="Random_permutation_statistics:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>d</mi>
       <mo stretchy="false">|</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <mrow>
      <mrow>
       <msub>
        <mi>q</mi>
        <mrow>
         <mi>n</mi>
         <mo>,</mo>
         <mi>d</mi>
        </mrow>
       </msub>
       <mo>×</mo>
       <mi>μ</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>k</mi>
        <mo>/</mo>
        <mi>d</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mi>p</mi>
     <mrow>
      <mi>n</mi>
      <mo>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">d</csymbol>
       <ci>normal-|</ci>
       <csymbol cd="unknown">k</csymbol>
      </cerror>
     </apply>
     <apply>
      <times></times>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>q</ci>
        <list>
         <ci>n</ci>
         <ci>d</ci>
        </list>
       </apply>
       <ci>μ</ci>
      </apply>
      <apply>
       <divide></divide>
       <ci>k</ci>
       <ci>d</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <list>
      <ci>n</ci>
      <ci>k</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{d|k}q_{n,d}\times\mu(k/d)=p_{n,k}.
  </annotation>
 </semantics>
</math>

 Therefore we have the EGF</p>

<p>

<math display="block" id="Random_permutation_statistics:26">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>d</mi>
       <mo>∣</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <mrow>
      <mrow>
       <mrow>
        <mi>μ</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>/</mo>
          <mi>d</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>×</mo>
       <msub>
        <mi>Q</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>d</mi>
       <mo>∣</mo>
       <mi>k</mi>
      </mrow>
     </munder>
     <mrow>
      <mi>μ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>k</mi>
        <mo>/</mo>
        <mi>d</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <munder>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>m</mi>
           <mo>∣</mo>
           <mi>d</mi>
          </mrow>
         </munder>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mi>m</mi>
          </msup>
          <mi>m</mi>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>Q</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">k</csymbol>
       </cerror>
      </apply>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <times></times>
         <ci>μ</ci>
         <apply>
          <divide></divide>
          <ci>k</ci>
          <ci>d</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <ci>d</ci>
        </apply>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <cerror>
        <csymbol cd="ambiguous">fragments</csymbol>
        <csymbol cd="unknown">d</csymbol>
        <ci>normal-∣</ci>
        <csymbol cd="unknown">k</csymbol>
       </cerror>
      </apply>
      <apply>
       <times></times>
       <ci>μ</ci>
       <apply>
        <divide></divide>
        <ci>k</ci>
        <ci>d</ci>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <csymbol cd="unknown">m</csymbol>
           <ci>normal-∣</ci>
           <csymbol cd="unknown">d</csymbol>
          </cerror>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>m</ci>
          </apply>
          <ci>m</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(z)=\sum_{d\mid k}\mu(k/d)\times Q_{d}(z)=\sum_{d\mid k}\mu(k/d)\exp\left(%
\sum_{m\mid d}\frac{z^{m}}{m}\right).
  </annotation>
 </semantics>
</math>

 The desired count is then given by</p>

<p>

<math display="block" id="Random_permutation_statistics:27">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>Q</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]Q(z).
  </annotation>
 </semantics>
</math>

</p>

<p>This formula produces e.g. for <em>k</em> = 6 the EGF</p>

<p>

<math display="block" id="Random_permutation_statistics:28">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi mathvariant="normal">e</mi>
      <mi>z</mi>
     </msup>
     <mo>-</mo>
     <msup>
      <mi mathvariant="normal">e</mi>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>2</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
     </msup>
     <mo>-</mo>
     <msup>
      <mi mathvariant="normal">e</mi>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>3</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>3</mn>
        </msup>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <msup>
     <mi mathvariant="normal">e</mi>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>2</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>3</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>3</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>6</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>6</mn>
       </msup>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-e</ci>
       <ci>z</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-e</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-e</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">3</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-e</ci>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">6</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(z)={\rm e}^{z}-{\rm e}^{z+1/2\,z^{2}}-{\rm e}^{z+1/3\,z^{3}}+{\rm e}^{z+1/2%
\,z^{2}+1/3\,z^{3}+1/6\,z^{6}}
  </annotation>
 </semantics>
</math>

</p>

<p>with the sequence of values starting at <em>n</em> = 5</p>

<p>

<math display="block" id="Random_permutation_statistics:29">
 <semantics>
  <mrow>
   <mn>20</mn>
   <mo>,</mo>
   <mn>240</mn>
   <mo>,</mo>
   <mn>1470</mn>
   <mo>,</mo>
   <mn>10640</mn>
   <mo>,</mo>
   <mn>83160</mn>
   <mo>,</mo>
   <mn>584640</mn>
   <mo>,</mo>
   <mn>4496030</mn>
   <mo>,</mo>
   <mn>42658440</mn>
   <mo>,</mo>
   <mn>371762820</mn>
   <mo>,</mo>
   <mn>3594871280</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">20</cn>
    <cn type="integer">240</cn>
    <cn type="integer">1470</cn>
    <cn type="integer">10640</cn>
    <cn type="integer">83160</cn>
    <cn type="integer">584640</cn>
    <cn type="integer">4496030</cn>
    <cn type="integer">42658440</cn>
    <cn type="integer">371762820</cn>
    <cn type="integer">3594871280</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   20,240,1470,10640,83160,584640,4496030,42658440,371762820,3594871280,\ldots
  </annotation>
 </semantics>
</math>

 which is <a href="https://oeis.org/A061121">OEIS A061121</a>.</p>

<p>For <em>k</em> = 8 we get the EGF</p>

<p>

<math display="block" id="Random_permutation_statistics:30">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>-</mo>
     <msup>
      <mi mathvariant="normal">e</mi>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>2</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>4</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>4</mn>
        </msup>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <msup>
     <mi mathvariant="normal">e</mi>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>2</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>4</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>4</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>8</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>8</mn>
       </msup>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-e</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">4</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-e</ci>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">8</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">8</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(z)=-{\rm e}^{z+1/2\,z^{2}+1/4\,z^{4}}+{\rm e}^{z+1/2\,z^{2}+1/4\,z^{4}+1/8\,%
z^{8}}
  </annotation>
 </semantics>
</math>

 with the sequence of values starting at <em>n</em> = 8</p>

<p>

<math display="block" id="Random_permutation_statistics:31">
 <semantics>
  <mrow>
   <mn>5040</mn>
   <mo>,</mo>
   <mn>45360</mn>
   <mo>,</mo>
   <mn>453600</mn>
   <mo>,</mo>
   <mn>3326400</mn>
   <mo>,</mo>
   <mn>39916800</mn>
   <mo>,</mo>
   <mn>363242880</mn>
   <mo>,</mo>
   <mn>3874590720</mn>
   <mo>,</mo>
   <mn>34767532800</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">5040</cn>
    <cn type="integer">45360</cn>
    <cn type="integer">453600</cn>
    <cn type="integer">3326400</cn>
    <cn type="integer">39916800</cn>
    <cn type="integer">363242880</cn>
    <cn type="integer">3874590720</cn>
    <cn type="integer">34767532800</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   5040,45360,453600,3326400,39916800,363242880,3874590720,34767532800,\ldots
  </annotation>
 </semantics>
</math>

 which is <a href="https://oeis.org/A061122">OEIS A061122</a>.</p>

<p>Finally for <em>k</em> = 12 we get the EGF</p>

<p>

<math display="block" id="Random_permutation_statistics:32">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msup>
      <mi mathvariant="normal">e</mi>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>2</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mrow>
     </msup>
     <mo>-</mo>
     <msup>
      <mi mathvariant="normal">e</mi>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>2</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>4</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>4</mn>
        </msup>
       </mrow>
      </mrow>
     </msup>
     <mo>-</mo>
     <msup>
      <mi mathvariant="normal">e</mi>
      <mrow>
       <mi>z</mi>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>2</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>3</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>3</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mpadded width="+1.7pt">
          <mn>6</mn>
         </mpadded>
        </mrow>
        <msup>
         <mi>z</mi>
         <mn>6</mn>
        </msup>
       </mrow>
      </mrow>
     </msup>
    </mrow>
    <mo>+</mo>
    <msup>
     <mi mathvariant="normal">e</mi>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>2</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>3</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>3</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>4</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>4</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>6</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>6</mn>
       </msup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mpadded width="+1.7pt">
         <mn>12</mn>
        </mpadded>
       </mrow>
       <msup>
        <mi>z</mi>
        <mn>12</mn>
       </msup>
      </mrow>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-e</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-e</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">4</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>normal-e</ci>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">3</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <cn type="integer">6</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>normal-e</ci>
      <apply>
       <plus></plus>
       <ci>z</ci>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">6</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">12</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">12</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(z)={\rm e}^{z+1/2\,z^{2}}-{\rm e}^{z+1/2\,z^{2}+1/4\,z^{4}}-{\rm e}^{z+1/2\,%
z^{2}+1/3\,{z}^{3}+1/6\,z^{6}}+{\rm e}^{z+1/2\,z^{2}+1/3\,z^{3}+1/4\,z^{4}+1/6%
\,z^{6}+1/12\,z^{12}}
  </annotation>
 </semantics>
</math>

 with the sequence of values starting at <em>n</em> = 7</p>

<p>

<math display="block" id="Random_permutation_statistics:33">
 <semantics>
  <mrow>
   <mn>420</mn>
   <mo>,</mo>
   <mn>3360</mn>
   <mo>,</mo>
   <mn>30240</mn>
   <mo>,</mo>
   <mn>403200</mn>
   <mo>,</mo>
   <mn>4019400</mn>
   <mo>,</mo>
   <mn>80166240</mn>
   <mo>,</mo>
   <mn>965284320</mn>
   <mo>,</mo>
   <mn>12173441280</mn>
   <mo>,</mo>
   <mn>162850287600</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">420</cn>
    <cn type="integer">3360</cn>
    <cn type="integer">30240</cn>
    <cn type="integer">403200</cn>
    <cn type="integer">4019400</cn>
    <cn type="integer">80166240</cn>
    <cn type="integer">965284320</cn>
    <cn type="integer">12173441280</cn>
    <cn type="integer">162850287600</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   420,3360,30240,403200,4019400,80166240,965284320,12173441280,162850287600,\ldots
  </annotation>
 </semantics>
</math>

 which is <a href="https://oeis.org/A061125">OEIS A061125</a>.</p>
<h2 id="number-of-permutations-that-are-derangements">Number of permutations that are derangements</h2>

<p>Suppose there are <em>n</em> people at a party, each of whom brought an umbrella. At the end of the party everyone picks an umbrella out of the stack of umbrellas and leaves. What is the probability that no one left with his/her own umbrella? This problem is equivalent to counting permutations with no fixed points, and hence the EGF (subtract out fixed points by removing <em>z</em>) <em>g</em>(<em>x</em>) is</p>

<p>

<math display="block" id="Random_permutation_statistics:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>k</mi>
          <mo>≥</mo>
          <mn>1</mn>
         </mrow>
        </munder>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mi>k</mi>
         </msup>
         <mi>k</mi>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </msup>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <ci>z</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <minus></minus>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\left(-z+\sum_{k\geq 1}\frac{z^{k}}{k}\right)=\frac{e^{-z}}{1-z}.
  </annotation>
 </semantics>
</math>

</p>

<p>Now multiplication by 

<math display="inline" id="Random_permutation_statistics:35">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>z</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/(1-z)
  </annotation>
 </semantics>
</math>

 just sums coefficients, so that we have the following formula for 

<math display="inline" id="Random_permutation_statistics:36">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>D</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(n)
  </annotation>
 </semantics>
</math>

, the total number of derangements:</p>

<p>

<math display="block" id="Random_permutation_statistics:37">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mpadded width="+2.8pt">
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>k</mi>
        </msup>
        <mrow>
         <mi>k</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
      </mpadded>
     </mrow>
    </mrow>
    <mo rspace="5.3pt">≈</mo>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mi>e</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>D</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <ci>e</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(n)=n!\sum_{k=0}^{n}\frac{(-1)^{k}}{k!}\;\approx\;\frac{n!}{e}.
  </annotation>
 </semantics>
</math>

</p>

<p>Hence there are about 

<math display="inline" id="Random_permutation_statistics:38">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mo>/</mo>
   <mi>e</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!/e
  </annotation>
 </semantics>
</math>

 derangements and the probability that a random permutation is a derangement is 

<math display="inline" id="Random_permutation_statistics:39">
 <semantics>
  <mrow>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mi>e</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <ci>e</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/e.
  </annotation>
 </semantics>
</math>

</p>

<p>This result may also be proved by <a class="uri" href="inclusion-exclusion" title="wikilink">inclusion-exclusion</a>. Using the sets 

<math display="inline" id="Random_permutation_statistics:40">
 <semantics>
  <msub>
   <mi>A</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>A</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A_{p}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Random_permutation_statistics:41">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="center">
     <mrow>
      <mn>1</mn>
      <mo>≤</mo>
      <mi>p</mi>
      <mo>≤</mo>
      <mi>n</mi>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <and></and>
      <apply>
       <leq></leq>
       <cn type="integer">1</cn>
       <ci>p</ci>
      </apply>
      <apply>
       <leq></leq>
       <share href="#.cmml">
       </share>
       <ci>n</ci>
      </apply>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{matrix}1\leq p\leq n\end{matrix}
  </annotation>
 </semantics>
</math>

 to denote the set of permutations that fix <em>p</em>, we have</p>

<p>

<math display="inline" id="Random_permutation_statistics:42">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
       <mo rspace="8.1pt">-</mo>
       <mrow>
        <mrow>
         <mo>(</mo>
         <mstyle scriptlevel="+1">
          <mtable columnspacing="0.4em" rowspacing="0.2ex">
           <mtr>
            <mtd>
             <mi>n</mi>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mn>1</mn>
            </mtd>
           </mtr>
          </mtable>
         </mstyle>
         <mo>)</mo>
        </mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo rspace="8.1pt">+</mo>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mstyle scriptlevel="+1">
         <mtable columnspacing="0.4em" rowspacing="0.2ex">
          <mtr>
           <mtd>
            <mi>n</mi>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mn>2</mn>
           </mtd>
          </mtr>
         </mtable>
        </mstyle>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo rspace="8.1pt">-</mo>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mi>n</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mn>3</mn>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo rspace="8.1pt">+</mo>
    <mpadded width="+5.6pt">
     <mi mathvariant="normal">⋯</mi>
    </mpadded>
   </mrow>
   <mo rspace="8.1pt">±</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mstyle scriptlevel="+1">
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
      </mtable>
     </mstyle>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">plus-or-minus</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <factorial></factorial>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">binomial</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <factorial></factorial>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">binomial</csymbol>
        <ci>n</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>n</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!\;\;-\;\;{n\choose 1}(n-1)!\;\;+\;\;{n\choose 2}(n-2)!\;\;-\;\;{n\choose 3}(%
n-3)!\;\;+\;\;\cdots\;\;\pm\;\;{n\choose n}(n-n)!
  </annotation>
 </semantics>
</math>

</p>

<p>Hence the number of permutations with no fixed point is</p>

<p>

<math display="inline" id="Random_permutation_statistics:43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mn>1</mn>
            <mo lspace="0pt" rspace="3.5pt">!</mo>
           </mrow>
          </mfrac>
         </mrow>
         <mo>+</mo>
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mn>2</mn>
           <mo lspace="0pt" rspace="3.5pt">!</mo>
          </mrow>
         </mfrac>
        </mrow>
        <mo>-</mo>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>3</mn>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
      <mo>±</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>k</mi>
      </msup>
      <mrow>
       <mi>k</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">plus-or-minus</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <apply>
            <factorial></factorial>
            <cn type="integer">1</cn>
           </apply>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <factorial></factorial>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <factorial></factorial>
          <cn type="integer">3</cn>
         </apply>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!\left(1-\frac{1}{1!}+\frac{1}{2!}-\frac{1}{3!}+\cdots\pm\frac{1}{n!}\right)=%
n!\sum_{k=0}^{n}\frac{(-1)^{k}}{k!}
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="inline" id="Random_permutation_statistics:44">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>D</ci>
    <interval closure="open">
     <ci>n</ci>
     <ci>m</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(n,m)
  </annotation>
 </semantics>
</math>

</p>

<p>and we have the claim.</p>

<p>There is a generalization of these numbers, which is known as <a href="rencontres_numbers" title="wikilink">rencontres numbers</a>, i.e. the number 

<math display="inline" id="Random_permutation_statistics:45">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mi>n</mi>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [n]
  </annotation>
 </semantics>
</math>

 of permutations of 

<math display="inline" id="Random_permutation_statistics:46">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k=1
  </annotation>
 </semantics>
</math>

 containing <em>m</em> fixed points. The corresponding EGF is obtained by marking cycles of size one with the variable <em>u</em>, i.e. choosing <em>b</em>(<em>k</em>) equal to one for 

<math display="inline" id="Random_permutation_statistics:47">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)
  </annotation>
 </semantics>
</math>

 and zero otherwise, which yields the generating function 

<math display="block" id="Random_permutation_statistics:48">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>u</mi>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>k</mi>
          <mo>≥</mo>
          <mn>1</mn>
         </mrow>
        </munder>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mi>k</mi>
         </msup>
         <mi>k</mi>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </msup>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>u</mi>
       <mi>z</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>z</ci>
       </apply>
       <apply>
        <times></times>
        <ci>u</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <geq></geq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <times></times>
        <ci>u</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\exp\left(-z+uz+\sum_{k\geq 1}\frac{z^{k}}{k}\right)=\frac{e^{-z}}{1-z}%
e^{uz}.
  </annotation>
 </semantics>
</math>

 of the set of permutations by the number of fixed points:</p>

<p>

<math display="block" id="Random_permutation_statistics:49">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>u</mi>
      <mi>m</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>e</mi>
      <mrow>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </msup>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mfrac>
     <msup>
      <mi>z</mi>
      <mi>m</mi>
     </msup>
     <mrow>
      <mi>m</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [u^{m}]g(z,u)=\frac{e^{-z}}{1-z}\frac{z^{m}}{m!}
  </annotation>
 </semantics>
</math>

</p>

<p>It follows that</p>

<p>

<math display="block" id="Random_permutation_statistics:50">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo>,</mo>
      <mi>m</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>u</mi>
       <mi>m</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <mi>m</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>m</mi>
       </mrow>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mfrac>
      <msup>
       <mi>e</mi>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </msup>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <mi>m</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>0</mn>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>m</mi>
       </mrow>
      </munderover>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>k</mi>
       </msup>
       <mrow>
        <mi>k</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>D</ci>
      <interval closure="open">
       <ci>n</ci>
       <ci>m</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>e</ci>
        <apply>
         <minus></minus>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(n,m)=n![z^{n}][u^{m}]g(z,u)=\frac{n!}{m!}[z^{n-m}]\frac{e^{-z}}{1-z}=\frac{n%
!}{m!}\sum_{k=0}^{n-m}\frac{(-1)^{k}}{k!}.
  </annotation>
 </semantics>
</math>

</p>

<p>and hence</p>

<p>

<math display="block" id="Random_permutation_statistics:51">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo>,</mo>
     <mi>m</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mi>n</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>m</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mi>D</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>m</mi>
     </mrow>
     <mo>,</mo>
     <mn>0</mn>
     <mo rspace="8.1pt" stretchy="false">)</mo>
    </mrow>
    <mpadded width="+5.6pt">
     <mtext>and</mtext>
    </mpadded>
    <mfrac>
     <mrow>
      <mi>D</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo>,</mo>
       <mi>m</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mfrac>
   </mrow>
   <mo>≈</mo>
   <mfrac>
    <msup>
     <mi>e</mi>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mi>m</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>D</ci>
      <interval closure="open">
       <ci>n</ci>
       <ci>m</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
      <ci>D</ci>
      <interval closure="open">
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
       <cn type="integer">0</cn>
      </interval>
      <mtext>and</mtext>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>D</ci>
        <interval closure="open">
         <ci>n</ci>
         <ci>m</ci>
        </interval>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(n,m)={n\choose m}D(n-m,0)\;\;\mbox{ and }\;\;\frac{D(n,m)}{n!}\approx\frac{e%
^{-1}}{m!}
  </annotation>
 </semantics>
</math>

</p>

<p>This immediately implies that</p>

<p>

<math display="inline" id="Random_permutation_statistics:52">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>0</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}(n)
  </annotation>
 </semantics>
</math>

</p>

<p>for <em>n</em> large, <em>m</em> fixed.</p>
<h2 id="derangements-containing-an-even-and-an-odd-number-of-cycles">Derangements containing an even and an odd number of cycles</h2>

<p>We can use the same construction as in the previous section to compute the number of derangements 

<math display="inline" id="Random_permutation_statistics:53">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{1}(n)
  </annotation>
 </semantics>
</math>

 containing an even number of cycles and the number 

<math display="block" id="Random_permutation_statistics:54">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>u</mi>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>u</mi>
        <mrow>
         <mi>log</mi>
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mi>z</mi>
          </mrow>
         </mfrac>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>u</mi>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>u</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>u</ci>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>u</ci>
        <apply>
         <log></log>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <ci>u</ci>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\exp\left(-uz+u\log\frac{1}{1-z}\right)=\exp(-uz)\left(\frac{1}{1-z}%
\right)^{u}.
  </annotation>
 </semantics>
</math>

 containing an odd number of cycles. To do this we need to mark all cycles and subtract fixed points, giving</p>

<p>

<math display="inline" id="Random_permutation_statistics:55">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>q</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(z)
  </annotation>
 </semantics>
</math>

</p>

<p>Now some very basic reasoning shows that the EGF 

<math display="inline" id="Random_permutation_statistics:56">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>0</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}(n)
  </annotation>
 </semantics>
</math>

 of 

<math display="block" id="Random_permutation_statistics:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
       <mo>×</mo>
       <mi>g</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
       <mo>×</mo>
       <mi>g</mi>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mn>1</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>q</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>g</ci>
       </apply>
       <interval closure="open">
        <ci>z</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </interval>
      </apply>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <ci>g</ci>
       </apply>
       <interval closure="open">
        <ci>z</ci>
        <cn type="integer">1</cn>
       </interval>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <minus></minus>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <exp></exp>
        <ci>z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q(z)=\frac{1}{2}\times g(z,-1)+\frac{1}{2}\times g(z,1)=\frac{1}{2}\exp(-z)%
\frac{1}{1-z}+\frac{1}{2}\exp(z)(1-z).
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="block" id="Random_permutation_statistics:58">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>D</mi>
     <mn>0</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>k</mi>
        </msup>
        <mrow>
         <mi>k</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <cn type="integer">0</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>q</ci>
      <ci>z</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>k</ci>
            <cn type="integer">0</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <minus></minus>
            <cn type="integer">1</cn>
           </apply>
           <ci>k</ci>
          </apply>
          <apply>
           <factorial></factorial>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <factorial></factorial>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}(n)=n![z^{n}]q(z)=\frac{1}{2}n!\sum_{k=0}^{n}\frac{(-1)^{k}}{k!}+\frac{1}%
{2}n!\frac{1}{n!}-\frac{1}{2}n!\frac{1}{(n-1)!}
  </annotation>
 </semantics>
</math>

</p>

<p>We thus have</p>

<p>

<math display="block" id="Random_permutation_statistics:59">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>k</mi>
        </msup>
        <mrow>
         <mi>k</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>2</mn>
        <mi>e</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>e</ci>
       </apply>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{2}n!\sum_{k=0}^{n}\frac{(-1)^{k}}{k!}+\frac{1}{2}(1-n)\sim\frac{1}{2e%
}n!+\frac{1}{2}(1-n).
  </annotation>
 </semantics>
</math>

 which is</p>

<p>

<math display="inline" id="Random_permutation_statistics:60">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>0</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}(n)
  </annotation>
 </semantics>
</math>

</p>

<p>Subtracting 

<math display="inline" id="Random_permutation_statistics:61">
 <semantics>
  <mrow>
   <mi>D</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>D</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(n)
  </annotation>
 </semantics>
</math>

 from 

<math display="block" id="Random_permutation_statistics:62">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>D</mi>
      <mn>1</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>k</mi>
        </msup>
        <mrow>
         <mi>k</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>k</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{1}(n)=\frac{1}{2}n!\sum_{k=0}^{n}\frac{(-1)^{k}}{k!}-\frac{1}{2}(1-n).
  </annotation>
 </semantics>
</math>

, we find</p>

<p>

<math display="inline" id="Random_permutation_statistics:63">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>0</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">0</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{0}(n)
  </annotation>
 </semantics>
</math>

 The difference of these two (

<math display="inline" id="Random_permutation_statistics:64">
 <semantics>
  <mrow>
   <msub>
    <mi>D</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>D</ci>
     <cn type="integer">1</cn>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{1}(n)
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Random_permutation_statistics:65">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>-</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>n</ci>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n-1.
  </annotation>
 </semantics>
</math>

) is 

<math display="block" id="Random_permutation_statistics:66">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mrow>
        <mo>(</mo>
        <mstyle scriptlevel="+1">
         <mtable columnspacing="0.4em" rowspacing="0.2ex">
          <mtr>
           <mtd>
            <mn>99</mn>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mn>49</mn>
           </mtd>
          </mtr>
         </mtable>
        </mstyle>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>(</mo>
        <mstyle scriptlevel="+1">
         <mtable columnspacing="0.4em" rowspacing="0.2ex">
          <mtr>
           <mtd>
            <mn>100</mn>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mn>50</mn>
           </mtd>
          </mtr>
         </mtable>
        </mstyle>
        <mo>)</mo>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mn>100</mn>
    </msup>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mn>2</mn>
      <mn>100</mn>
     </msup>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <cn type="integer">99</cn>
       <cn type="integer">49</cn>
      </apply>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <cn type="integer">100</cn>
       <cn type="integer">50</cn>
      </apply>
     </apply>
     <cn type="integer">100</cn>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cn type="integer">2</cn>
      <cn type="integer">100</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{{99\choose 49}}{{100\choose 50}}\right)^{100}=\frac{1}{2^{100}},
  </annotation>
 </semantics>
</math>

</p>
<h2 id="one-hundred-prisoners">One hundred prisoners</h2>

<p>A prison warden wants to make room in his prison and is considering liberating one hundred prisoners, thereby freeing one hundred cells. He therefore assembles one hundred prisoners and asks them to play the following game: he lines up one hundred urns in a row, each containing the name of one prisoner, where every prisoner's name occurs exactly once. The game is played as follows: every prisoner is allowed to look inside fifty urns. If he or she does not find his or her name in one of the fifty urns, all prisoners will immediately be executed, otherwise the game continues. The prisoners have a few moments to decide on a strategy, knowing that once the game has begun, they will not be able to communicate with each other, mark the urns in any way or move the urns or the names inside them. Choosing urns at random, their chances of survival are almost zero, but there is a strategy giving them a 30% chance of survival, assuming that the names are assigned to urns randomly – what is it?</p>

<p>First of all, the survival probability using random choices is</p>

<p>

<math display="inline" id="Random_permutation_statistics:67">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2n
  </annotation>
 </semantics>
</math>

 so this is definitely not a practical strategy.</p>

<p>The 30% survival strategy is to consider the contents of the urns to be a permutation of the prisoners, and traverse cycles. To keep the notation simple, assign a number to each prisoner, for example by sorting their names alphabetically. The urns may thereafter be considered to contain numbers rather than names. Now clearly the contents of the urns define a permutation. The first prisoner opens the first urn. If he finds his name, he has finished and survives. Otherwise he opens the urn with the number he found in the first urn. The process repeats: the prisoner opens an urn and survives if he finds his name, otherwise he opens the urn with the number just retrieved, up to a limit of fifty urns. The second prisoner starts with urn number two, the third with urn number three, and so on. This strategy is precisely equivalent to a traversal of the cycles of the permutation represented by the urns. Every prisoner starts with the urn bearing his number and keeps on traversing his cycle up to a limit of fifty urns. The number of the urn that contains his number is the pre-image of that number under the permutation. Hence the prisoners survive if all cycles of the permutation contain at most fifty elements. We have to show that this probability is at least 30%.</p>

<p>Note that this assumes that the warden chooses the permutation randomly; if the warden anticipates this strategy, he can simply choose a permutation with a cycle of length 51. To overcome this, the prisoners may agree in advance on a random permutation of their names.</p>

<p>We consider the general case of 

<math display="inline" id="Random_permutation_statistics:68">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 prisoners and 

<math display="inline" id="Random_permutation_statistics:69">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 urns being opened. We first calculate the complementary probability, i.e. that there is a cycle of more than 

<math display="block" id="Random_permutation_statistics:70">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>z</mi>
      <mo>+</mo>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mn>2</mn>
       </msup>
       <mn>2</mn>
      </mfrac>
      <mo>+</mo>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mn>3</mn>
       </msup>
       <mn>3</mn>
      </mfrac>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
      <mo>+</mo>
      <mrow>
       <mi>u</mi>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>u</mi>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>2</mn>
         </mrow>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <ci>z</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">3</cn>
       </apply>
       <cn type="integer">3</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <times></times>
       <ci>u</ci>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>u</ci>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\exp\left(z+\frac{z^{2}}{2}+\frac{z^{3}}{3}+\cdots+u\frac{z^{n+1}}{n+1}%
+u\frac{z^{n+2}}{n+2}+\cdots\right)
  </annotation>
 </semantics>
</math>

 elements. With this in mind, we introduce</p>

<p>

<math display="block" id="Random_permutation_statistics:71">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>u</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mrow>
            <mi>n</mi>
            <mo>+</mo>
            <mn>1</mn>
           </mrow>
          </msup>
          <mrow>
           <mi>n</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
         </mfrac>
         <mo>+</mo>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mrow>
            <mi>n</mi>
            <mo>+</mo>
            <mn>2</mn>
           </mrow>
          </msup>
          <mrow>
           <mi>n</mi>
           <mo>+</mo>
           <mn>2</mn>
          </mrow>
         </mfrac>
         <mo>+</mo>
         <mi mathvariant="normal">⋯</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{1-z}\exp\left((u-1)\left(\frac{z^{n+1}}{n+1}+\frac{z^{n+2}}{n+2}+%
\cdots\right)\right),
  </annotation>
 </semantics>
</math>

 or</p>

<p>

<math display="block" id="Random_permutation_statistics:72">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>u</mi>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <ci>u</ci>
    </apply>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [z^{2n}][u]g(z,u),\,
  </annotation>
 </semantics>
</math>

 so that the desired probability is</p>

<p>

<math display="inline" id="Random_permutation_statistics:73">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 because the cycle of more than 

<math display="inline" id="Random_permutation_statistics:74">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>></mo>
   <mrow>
    <mn>2</mn>
    <mi>n</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <plus></plus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2(n+1)>2n
  </annotation>
 </semantics>
</math>

 elements will necessarily be unique. Using the fact that 

<math display="block" id="Random_permutation_statistics:75">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>u</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>u</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>u</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mfrac>
           <msup>
            <mi>z</mi>
            <mrow>
             <mi>n</mi>
             <mo>+</mo>
             <mn>1</mn>
            </mrow>
           </msup>
           <mrow>
            <mi>n</mi>
            <mo>+</mo>
            <mn>1</mn>
           </mrow>
          </mfrac>
          <mo>+</mo>
          <mfrac>
           <msup>
            <mi>z</mi>
            <mrow>
             <mi>n</mi>
             <mo>+</mo>
             <mn>2</mn>
            </mrow>
           </msup>
           <mrow>
            <mi>n</mi>
            <mo>+</mo>
            <mn>2</mn>
           </mrow>
          </mfrac>
          <mo>+</mo>
          <mi mathvariant="normal">⋯</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>u</ci>
     </apply>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <ci>u</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <apply>
           <plus></plus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <apply>
           <plus></plus>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <ci>normal-⋯</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [z^{2n}][u]g(z,u)=[z^{2n}][u]\frac{1}{1-z}\left(1+(u-1)\left(\frac{z^{n+1}}{n+%
1}+\frac{z^{n+2}}{n+2}+\cdots\right)\right),
  </annotation>
 </semantics>
</math>

, we find that</p>

<p>

<math display="block" id="Random_permutation_statistics:76">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>u</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mfrac>
       <mo>+</mo>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>2</mn>
         </mrow>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>2</mn>
        </mrow>
       </mfrac>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
     </munderover>
     <mfrac>
      <mn>1</mn>
      <mi>k</mi>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>H</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>u</ci>
      </apply>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [z^{2n}][u]g(z,u)=[z^{2n}]\frac{1}{1-z}\left(\frac{z^{n+1}}{n+1}+\frac{z^{n+2}%
}{n+2}+\cdots\right)=\sum_{k=n+1}^{2n}\frac{1}{k}=H_{2n}-H_{n}.
  </annotation>
 </semantics>
</math>

 which yields</p>

<p>

<math display="block" id="Random_permutation_statistics:77">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>H</mi>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>H</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>∼</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mi>log</mi>
           <mn>2</mn>
          </mrow>
          <mo>-</mo>
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mn>4</mn>
            <mi>n</mi>
           </mrow>
          </mfrac>
         </mrow>
         <mo>+</mo>
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mn>16</mn>
           <msup>
            <mi>n</mi>
            <mn>2</mn>
           </msup>
          </mrow>
         </mfrac>
        </mrow>
        <mo>-</mo>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>128</mn>
          <msup>
           <mi>n</mi>
           <mn>4</mn>
          </msup>
         </mrow>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>256</mn>
         <msup>
          <mi>n</mi>
          <mn>6</mn>
         </msup>
        </mrow>
       </mfrac>
      </mrow>
      <mo>-</mo>
      <mfrac>
       <mn>17</mn>
       <mrow>
        <mn>4096</mn>
        <msup>
         <mi>n</mi>
         <mn>8</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <log></log>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <apply>
            <times></times>
            <cn type="integer">4</cn>
            <ci>n</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <cn type="integer">16</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>n</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">128</cn>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>n</ci>
           <cn type="integer">4</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <cn type="integer">256</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>n</ci>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">17</cn>
       <apply>
        <times></times>
        <cn type="integer">4096</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">8</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{2n}-H_{n}\sim\log 2-\frac{1}{4n}+\frac{1}{16n^{2}}-\frac{1}{128n^{4}}+\frac%
{1}{256n^{6}}-\frac{17}{4096n^{8}}+\cdots,
  </annotation>
 </semantics>
</math>

</p>

<p>Finally, using an integral estimate such as <a href="Euler–MacLaurin_summation" title="wikilink">Euler–MacLaurin summation</a>, or the asymptotic expansion of the <em>n</em>th <a href="harmonic_number" title="wikilink">harmonic number</a>, we obtain</p>

<p>

<math display="block" id="Random_permutation_statistics:78">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">[</mo>
       <msup>
        <mi>z</mi>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
       </msup>
       <mo stretchy="false">]</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>u</mi>
       <mo stretchy="false">]</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mi>u</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo><</mo>
     <mrow>
      <mrow>
       <mi>log</mi>
       <mn>2</mn>
      </mrow>
      <mtext>and</mtext>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">[</mo>
        <msup>
         <mi>z</mi>
         <mrow>
          <mn>2</mn>
          <mi>n</mi>
         </mrow>
        </msup>
        <mo stretchy="false">]</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">[</mo>
        <mi>u</mi>
        <mo stretchy="false">]</mo>
       </mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo>></mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mi>log</mi>
       <mn>2</mn>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mn>0.30685281</mn>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <lt></lt>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <ci>u</ci>
      </apply>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <list>
      <apply>
       <log></log>
       <cn type="integer">2</cn>
      </apply>
      <mtext>and</mtext>
     </list>
    </apply>
    <apply>
     <and></and>
     <apply>
      <gt></gt>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>u</ci>
        </apply>
        <ci>g</ci>
        <interval closure="open">
         <ci>z</ci>
         <ci>u</ci>
        </interval>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <log></log>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <share href="#.cmml">
      </share>
      <cn type="float">0.30685281</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [z^{2n}][u]g(z,u)<\log 2\quad\mbox{and}\quad 1-[z^{2n}][u]g(z,u)>1-\log 2=0.30%
685281,
  </annotation>
 </semantics>
</math>

 so that</p>

<p>

<math display="inline" id="Random_permutation_statistics:79">
 <semantics>
  <mrow>
   <mn>2</mn>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="integer">2</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2n
  </annotation>
 </semantics>
</math>


 or at least 30%, as claimed.</p>

<p>A related result is that asymptotically, the expected length of the longest cycle is <em>λn,</em> where λ is the <a href="Golomb–Dickman_constant" title="wikilink">Golomb–Dickman constant</a>, approximately 0.62.</p>

<p>This example is due to Anna Gál and Peter Bro Miltersen; consult the paper by Peter Winkler for more information, and see the discussion on <em>Les-Mathematiques.net</em>. Consult the <a href="Random_permutation_statistics#100_prisoners" title="wikilink">references on 100 prisoners</a> for links to these references.</p>

<p>The above computation may be performed in a more simple and direct way, as follows: first note that a permutation of 

<math display="inline" id="Random_permutation_statistics:80">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 elements contains at most one cycle of length strictly greater than 

<math display="block" id="Random_permutation_statistics:81">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mi>Pr</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mtext>there is a cycle of length</mtext>
       <mi>k</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <ci>Pr</ci>
     <apply>
      <times></times>
      <mtext>there is a cycle of length</mtext>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=\Pr[\mbox{there is a cycle of length }k],
  </annotation>
 </semantics>
</math>

 . Thus, if we denote</p>

<p>

<math display="block" id="Random_permutation_statistics:82">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Pr</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mtext>there is a cycle of length</mtext>
       <mo>></mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
     </munderover>
     <msub>
      <mi>p</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Pr</ci>
     <apply>
      <gt></gt>
      <mtext>there is a cycle of length</mtext>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr[\mbox{there is a cycle of length}>n]=\sum_{k=n+1}^{2n}p_{k}.
  </annotation>
 </semantics>
</math>

 then</p>

<p>

<math display="inline" id="Random_permutation_statistics:83">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>></mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>k</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k>n
  </annotation>
 </semantics>
</math>

</p>

<p>For 

<math display="inline" id="Random_permutation_statistics:84">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>


, the number of permutations that contain a cycle of length exactly 

<math display="block" id="Random_permutation_statistics:85">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mtable columnspacing="0.4em" rowspacing="0.2ex">
      <mtr>
       <mtd>
        <mrow>
         <mn>2</mn>
         <mi>n</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>k</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>)</mo>
    </mrow>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mi>k</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mi>k</mi>
    </mfrac>
    <mo>⋅</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⋅</ci>
    <apply>
     <csymbol cd="latexml">binomial</csymbol>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <factorial></factorial>
      <ci>k</ci>
     </apply>
     <ci>k</ci>
    </apply>
    <apply>
     <factorial></factorial>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {{2n}\choose k}\cdot\frac{k!}{k}\cdot(2n-k)!.
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="inline" id="Random_permutation_statistics:86">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {{2n}\choose k}
  </annotation>
 </semantics>
</math>

 Explanation: 

<math display="inline" id="Random_permutation_statistics:87">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 is the number of ways of choosing the 

<math display="inline" id="Random_permutation_statistics:88">
 <semantics>
  <mfrac>
   <mrow>
    <mi>k</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mi>k</mi>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <factorial></factorial>
     <ci>k</ci>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{k!}{k}
  </annotation>
 </semantics>
</math>

 elements that comprise the cycle; 

<math display="inline" id="Random_permutation_statistics:89">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>


 is the number of ways of arranging 

<math display="inline" id="Random_permutation_statistics:90">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mn>2</mn>
      <mi>n</mi>
     </mrow>
     <mo>-</mo>
     <mi>k</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (2n-k)!
  </annotation>
 </semantics>
</math>

 items in a cycle; and 

<math display="block" id="Random_permutation_statistics:91">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mi>k</mi>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mrow>
            <mn>2</mn>
            <mi>n</mi>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mi>k</mi>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
       <mo>)</mo>
      </mrow>
      <mo>⋅</mo>
      <mfrac>
       <mrow>
        <mi>k</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
       <mi>k</mi>
      </mfrac>
      <mo>⋅</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>n</mi>
         </mrow>
         <mo>-</mo>
         <mi>k</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>n</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>k</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>p</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <csymbol cd="latexml">binomial</csymbol>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>n</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <factorial></factorial>
         <ci>k</ci>
        </apply>
        <ci>k</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>n</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <factorial></factorial>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{k}=\frac{{{2n}\choose k}\cdot\frac{k!}{k}\cdot(2n-k)!}{(2n)!}=\frac{1}{k}.
  </annotation>
 </semantics>
</math>

 is the number of ways to permute the remaining elements. Thus,</p>

<p>

<math display="block" id="Random_permutation_statistics:92">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Pr</mi>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mtext>there is a cycle of length</mtext>
       <mo>></mo>
       <mi>n</mi>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mrow>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
     </munderover>
     <mfrac>
      <mn>1</mn>
      <mi>k</mi>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>H</mi>
      <mrow>
       <mn>2</mn>
       <mi>n</mi>
      </mrow>
     </msub>
     <mo>-</mo>
     <msub>
      <mi>H</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>Pr</ci>
      <apply>
       <gt></gt>
       <mtext>there is a cycle of length</mtext>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Pr[\mbox{there is a cycle of length}>n]=\sum_{k=n+1}^{2n}\frac{1}{k}=H_{2n}-H%
_{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>We conclude that</p>

<p>

<math display="inline" id="Random_permutation_statistics:93">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒬</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒬</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Q}
  </annotation>
 </semantics>
</math>

</p>
<h2 id="a-variation-on-the-100-prisoners-problem-keys-and-boxes">A variation on the 100 prisoners problem (keys and boxes)</h2>

<p>There is a closely related problem that fits the method presented here quite nicely. Say you have <em>n</em> ordered boxes. Every box contains a key to some other box or possibly itself giving a permutation of the keys. You are allowed to select <em>k</em> of these <em>n</em> boxes all at once and break them open simultaneously, gaining access to <em>k</em> keys. What is the probability that using these keys you can open all <em>n</em> boxes, where you use a found key to open the box it belongs to and repeat.</p>

<p>The mathematical statement of this problem is as follows: pick a random permutation on <em>n</em> elements and <em>k</em> values from the range <em>1</em> to <em>n</em>, also at random, call these marks. What is the probability that there is at least one mark on every cycle of the permutation? The claim is this probability is <em>k/n</em>.</p>

<p>The species 

<math display="block" id="Random_permutation_statistics:94">
 <semantics>
  <mrow>
   <mrow>
    <mi class="ltx_font_mathcaligraphic">𝒬</mi>
    <mo>=</mo>
    <mrow>
     <mi>𝔓</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>q</mi>
         <mo>≥</mo>
         <mn>1</mn>
        </mrow>
       </munder>
       <mrow>
        <mrow>
         <msub>
          <mi>ℭ</mi>
          <mrow>
           <mi></mi>
           <mo>=</mo>
           <mi>q</mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi class="ltx_font_mathcaligraphic">𝒵</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>×</mo>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>p</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>q</mi>
         </munderover>
         <mrow>
          <mrow>
           <mo>(</mo>
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>q</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mi>p</mi>
             </mtd>
            </mtr>
           </mtable>
           <mo>)</mo>
          </mrow>
          <msup>
           <mi class="ltx_font_mathcaligraphic">𝒰</mi>
           <mi>p</mi>
          </msup>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>𝒬</ci>
    <apply>
     <times></times>
     <ci>𝔓</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ℭ</ci>
         <apply>
          <eq></eq>
          <csymbol cd="latexml">absent</csymbol>
          <ci>q</ci>
         </apply>
        </apply>
        <ci>𝒵</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>q</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>q</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>𝒰</ci>
          <ci>p</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Q}=\mathfrak{P}\left(\sum_{q\geq 1}\mathfrak{C}_{=q}(\mathcal{Z})%
\times\sum_{p=1}^{q}{q\choose p}\mathcal{U}^{p}\right).
  </annotation>
 </semantics>
</math>

 of permutations by cycles with some non-empty subset of every cycle being marked has the specification</p>

<p>

<math display="block" id="Random_permutation_statistics:95">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>q</mi>
         <mo>≥</mo>
         <mn>1</mn>
        </mrow>
       </munder>
       <mrow>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mi>q</mi>
         </msup>
         <mi>q</mi>
        </mfrac>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>p</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>q</mi>
         </munderover>
         <mrow>
          <mrow>
           <mo>(</mo>
           <mtable columnspacing="0.4em" rowspacing="0.2ex">
            <mtr>
             <mtd>
              <mi>q</mi>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mi>p</mi>
             </mtd>
            </mtr>
           </mtable>
           <mo>)</mo>
          </mrow>
          <msup>
           <mi>u</mi>
           <mi>p</mi>
          </msup>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>q</ci>
        </apply>
        <ci>q</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>p</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>q</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="latexml">binomial</csymbol>
          <ci>q</ci>
          <ci>p</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <ci>p</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(z,u)=\exp\left(\sum_{q\geq 1}\frac{z^{q}}{q}\sum_{p=1}^{q}{q\choose p}u^{p}%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>The index in the inner sum starts at one because we must have at least one mark on every cycle.</p>

<p>Translating the specification to generating functions we obtain the bivariate generating function</p>

<p>

<math display="block" id="Random_permutation_statistics:96">
 <semantics>
  <mrow>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>q</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>q</mi>
        </msup>
        <mi>q</mi>
       </mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>u</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>q</mi>
       </msup>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>q</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>q</mi>
       </msup>
       <mi>q</mi>
      </mfrac>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <exp></exp>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>q</ci>
        </apply>
        <ci>q</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <plus></plus>
         <ci>u</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>q</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>q</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>q</ci>
       </apply>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\left(\sum_{q\geq 1}\frac{z^{q}}{q}(u+1)^{q}-\sum_{q\geq 1}\frac{z^{q}}{q}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>This simplifies to</p>

<p>

<math display="block" id="Random_permutation_statistics:97">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>u</mi>
             <mo>+</mo>
             <mn>1</mn>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mi>z</mi>
          </mrow>
         </mrow>
        </mfrac>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>u</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>z</mi>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <exp></exp>
     <apply>
      <minus></minus>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <apply>
           <plus></plus>
           <ci>u</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\left(\log\frac{1}{1-(u+1)z}-\log\frac{1}{1-z}\right)=\frac{1-z}{1-(u+1)z}.
  </annotation>
 </semantics>
</math>

 or</p>

<p>

<math display="block" id="Random_permutation_statistics:98">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>q</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>u</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>q</mi>
      </msup>
      <msup>
       <mi>z</mi>
       <mi>q</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>z</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <geq></geq>
       <ci>q</ci>
       <cn type="integer">0</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <plus></plus>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>q</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>q</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1-z)\sum_{q\geq 0}(u+1)^{q}z^{q}.
  </annotation>
 </semantics>
</math>

 In order to extract coefficients from this re-write like so</p>

<p>

<math display="block" id="Random_permutation_statistics:99">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>u</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
    <mo>-</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>u</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>G</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <plus></plus>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [z^{n}]G(z,u)=(u+1)^{n}-(u+1)^{n-1}
  </annotation>
 </semantics>
</math>

 It now follows that</p>

<p>

<math display="block" id="Random_permutation_statistics:100">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>u</mi>
       <mi>k</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>G</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>G</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>n</ci>
      <ci>k</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [u^{k}][z^{n}]G(z,u)={n\choose k}-{n-1\choose k}.
  </annotation>
 </semantics>
</math>

 and hence</p>

<p>

<math display="inline" id="Random_permutation_statistics:101">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mstyle scriptlevel="+1">
    <mtable columnspacing="0.4em" rowspacing="0.2ex">
     <mtr>
      <mtd>
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mi>k</mi>
      </mtd>
     </mtr>
    </mtable>
   </mstyle>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">binomial</csymbol>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {n\choose k}
  </annotation>
 </semantics>
</math>

</p>

<p>Divide by 

<math display="block" id="Random_permutation_statistics:102">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
           <mo>-</mo>
           <mi>k</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <mrow>
         <mi>k</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mi>k</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
      <mi>n</mi>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mi>k</mi>
     <mi>n</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <factorial></factorial>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <factorial></factorial>
          <ci>k</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <factorial></factorial>
          <ci>k</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <ci>k</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>k</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <ci>k</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1-\frac{(n-1)!}{k!(n-1-k)!}\frac{k!(n-k)!}{n!}=1-\frac{n-k}{n}=\frac{k}{n}.
  </annotation>
 </semantics>
</math>

 to obtain</p>

<p>

<math display="inline" id="Random_permutation_statistics:103">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(z,u)
  </annotation>
 </semantics>
</math>

 We do not need to divide by <em>n!</em> because 

<math display="inline" id="Random_permutation_statistics:104">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>=</mo>
   <msub>
    <mi>S</mi>
    <mi>m</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G=S_{m}
  </annotation>
 </semantics>
</math>

 is exponential in <em>z</em>.</p>
<h2 id="number-of-permutations-containing-m-cycles">Number of permutations containing <em>m</em> cycles</h2>

<p>Applying the <a href="Symbolic_combinatorics#The_Flajolet–Sedgewick_fundamental_theorem" title="wikilink">Flajolet–Sedgewick fundamental theorem</a>, i.e. the labelled enumeration theorem with 

<math display="block" id="Random_permutation_statistics:105">
 <semantics>
  <mrow>
   <msub>
    <mi>𝔓</mi>
    <mi>m</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>ℭ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔓</ci>
     <ci>m</ci>
    </apply>
    <apply>
     <times></times>
     <ci>ℭ</ci>
     <ci>𝒵</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}_{m}(\mathfrak{C}(\mathcal{Z}))
  </annotation>
 </semantics>
</math>

, to the set</p>

<p>

<math display="block" id="Random_permutation_statistics:106">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>g</mi>
      <mi>m</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>S</mi>
        <mi>m</mi>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>m</mi>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>m</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>m</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>g</ci>
       <ci>m</ci>
      </apply>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <abs></abs>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <factorial></factorial>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{m}(z)=\frac{1}{|S_{m}|}\left(\log\frac{1}{1-z}\right)^{m}=\frac{1}{m!}\left%
(\log\frac{1}{1-z}\right)^{m}.
  </annotation>
 </semantics>
</math>

</p>

<p>we obtain the generating function</p>

<p>

<math display="block" id="Random_permutation_statistics:107">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mi>m</mi>
     </mrow>
    </msup>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <msub>
     <mi>g</mi>
     <mi>m</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>s</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo>,</mo>
     <mi>m</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>m</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <ci>s</ci>
     <interval closure="open">
      <ci>n</ci>
      <ci>m</ci>
     </interval>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (-1)^{n+m}n!\;[z^{n}]g_{m}(z)=s(n,m)
  </annotation>
 </semantics>
</math>

</p>

<p>The term</p>

<p>

<math display="inline" id="Random_permutation_statistics:108">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mi>m</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <ci>m</ci>
    </apply>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{m}(z)
  </annotation>
 </semantics>
</math>

</p>

<p>yields the signed <a href="Stirling_numbers#Stirling_numbers_of_the_first_kind" title="wikilink">Stirling numbers of the first kind</a>, and 

<math display="block" id="Random_permutation_statistics:109">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <msub>
      <mi>g</mi>
      <mi>m</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>[</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>n</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>m</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>m</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <ci>n</ci>
      </matrixrow>
      <matrixrow>
       <ci>m</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]g_{m}(z)=\left[\begin{matrix}n\\
m\end{matrix}\right].
  </annotation>
 </semantics>
</math>

 is the EGF of the unsigned Stirling numbers of the first kind, i.e.</p>

<p>

<math display="block" id="Random_permutation_statistics:110">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>s</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>m</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mi>s</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo>,</mo>
       <mi>m</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>w</mi>
       <mi>m</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>s</ci>
      <ci>n</ci>
     </apply>
     <ci>w</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>m</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>s</ci>
      <interval closure="open">
       <ci>n</ci>
       <ci>m</ci>
      </interval>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{n}(w)=\sum_{m=0}^{n}s(n,m)w^{m}.
  </annotation>
 </semantics>
</math>

</p>

<p>We can compute the OGF of the signed Stirling numbers for <em>n</em> fixed, i.e.</p>

<p>

<math display="block" id="Random_permutation_statistics:111">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>g</mi>
     <mi>m</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>n</mi>
      <mo>≥</mo>
      <mi>m</mi>
     </mrow>
    </munder>
    <mrow>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mi>m</mi>
       </mrow>
      </msup>
      <mrow>
       <mi>n</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <mi>s</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo>,</mo>
      <mi>m</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>m</ci>
     </apply>
     <ci>z</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <geq></geq>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>s</ci>
      <interval closure="open">
       <ci>n</ci>
       <ci>m</ci>
      </interval>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{m}(z)=\sum_{n\geq m}\frac{(-1)^{n+m}}{n!}s(n,m)z^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>Start with</p>

<p>

<math display="block" id="Random_permutation_statistics:112">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>m</mi>
     </msup>
     <msub>
      <mi>g</mi>
      <mi>m</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>w</mi>
      <mi>m</mi>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>≥</mo>
       <mi>m</mi>
      </mrow>
     </munder>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>n</mi>
       </msup>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <mi>s</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>n</mi>
       <mo>,</mo>
       <mi>m</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>w</mi>
       <mi>m</mi>
      </msup>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <ci>m</ci>
     </apply>
     <ci>z</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>w</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <geq></geq>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>s</ci>
      <interval closure="open">
       <ci>n</ci>
       <ci>m</ci>
      </interval>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (-1)^{m}g_{m}(z)w^{m}=\sum_{n\geq m}\frac{(-1)^{n}}{n!}s(n,m)w^{m}z^{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>which yields</p>

<p>

<math display="block" id="Random_permutation_statistics:113">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>m</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>m</mi>
      </msup>
      <msub>
       <mi>g</mi>
       <mi>m</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>w</mi>
       <mi>m</mi>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>m</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>n</mi>
        <mo>≥</mo>
        <mi>m</mi>
       </mrow>
      </munder>
      <mrow>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>n</mi>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
       <mi>s</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>n</mi>
        <mo>,</mo>
        <mi>m</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>w</mi>
        <mi>m</mi>
       </msup>
       <msup>
        <mi>z</mi>
        <mi>n</mi>
       </msup>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>n</mi>
       </msup>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>m</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <mrow>
        <mi>s</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>n</mi>
         <mo>,</mo>
         <mi>m</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <msup>
         <mi>w</mi>
         <mi>m</mi>
        </msup>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>m</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <ci>m</ci>
       </apply>
       <ci>z</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>w</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>m</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>n</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
        </apply>
        <ci>s</ci>
        <interval closure="open">
         <ci>n</ci>
         <ci>m</ci>
        </interval>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>w</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>m</ci>
           <cn type="integer">0</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <ci>s</ci>
         <interval closure="open">
          <ci>n</ci>
          <ci>m</ci>
         </interval>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>w</ci>
          <ci>m</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{m\geq 0}(-1)^{m}g_{m}(z)w^{m}=\sum_{m\geq 0}\sum_{n\geq m}\frac{(-1)^{n}%
}{n!}s(n,m)w^{m}z^{n}=\sum_{n\geq 0}\frac{(-1)^{n}}{n!}z^{n}\sum_{m=0}^{n}s(n,%
m)w^{m}.
  </annotation>
 </semantics>
</math>

</p>

<p>Summing this, we obtain</p>

<p>

<math display="inline" id="Random_permutation_statistics:114">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mi>m</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <ci>m</ci>
    </apply>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{m}(z)
  </annotation>
 </semantics>
</math>

</p>

<p>Using the formula involving the logarithm for 

<math display="inline" id="Random_permutation_statistics:115">
 <semantics>
  <mrow>
   <msub>
    <mi>s</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>s</ci>
     <ci>n</ci>
    </apply>
    <ci>w</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{n}(w)
  </annotation>
 </semantics>
</math>

 on the left, the definition of 

<math display="block" id="Random_permutation_statistics:116">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>w</mi>
    </msup>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>w</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mi>n</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>n</mi>
      </msup>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>n</mi>
       <mo>≥</mo>
       <mn>0</mn>
      </mrow>
     </munder>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>n</mi>
       </msup>
       <mrow>
        <mi>n</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <msub>
       <mi>s</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>w</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <ci>w</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">binomial</csymbol>
        <ci>w</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <geq></geq>
        <ci>n</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>s</ci>
        <ci>n</ci>
       </apply>
       <ci>w</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1-z)^{w}=\sum_{n\geq 0}{w\choose n}(-1)^{n}z^{n}=\sum_{n\geq 0}\frac{(-1)^{n}%
}{n!}s_{n}(w)z^{n}.
  </annotation>
 </semantics>
</math>

 on the right, and the <a href="binomial_theorem" title="wikilink">binomial theorem</a>, we obtain</p>

<p>

<math display="inline" id="Random_permutation_statistics:117">
 <semantics>
  <msup>
   <mi>z</mi>
   <mi>n</mi>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>z</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z^{n}
  </annotation>
 </semantics>
</math>

</p>

<p>Comparing the coefficients of 

<math display="block" id="Random_permutation_statistics:118">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>s</mi>
      <mi>n</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <mi>w</mi>
     </mpadded>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>w</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo rspace="5.3pt" stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>w</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo rspace="5.3pt" stretchy="false">)</mo>
     </mrow>
     <mpadded width="+2.8pt">
      <mi mathvariant="normal">⋯</mi>
     </mpadded>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>w</mi>
       <mo>-</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>w</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>s</ci>
       <ci>n</ci>
      </apply>
      <ci>w</ci>
     </apply>
     <apply>
      <times></times>
      <ci>w</ci>
      <apply>
       <minus></minus>
       <ci>w</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <ci>w</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>normal-⋯</ci>
      <apply>
       <minus></minus>
       <ci>w</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>w</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s_{n}(w)=w\;(w-1)\;(w-2)\;\cdots\;(w-(n-1))=(w)_{n},
  </annotation>
 </semantics>
</math>

, and using the definition of the <a href="binomial_coefficient" title="wikilink">binomial coefficient</a>, we finally have</p>

<p>

<math display="block" id="Random_permutation_statistics:119">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <mi>u</mi>
       </mrow>
      </mfrac>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mi>u</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <mi>u</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>≥</mo>
       <mn>1</mn>
      </mrow>
     </munder>
     <mrow>
      <mi>b</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>k</mi>
       </msup>
       <mi>k</mi>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mfrac>
     <msup>
      <mi>z</mi>
      <mi>m</mi>
     </msup>
     <mi>m</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>m</ci>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial u}g(z,u)\Bigg|_{u=1}=\frac{1}{1-z}\sum_{k\geq 1}b(k)%
\frac{z^{k}}{k}=\frac{1}{1-z}\frac{z^{m}}{m}
  </annotation>
 </semantics>
</math>

</p>

<p>a <a href="falling_factorial" title="wikilink">falling factorial</a>. The computation of the OGF of the unsigned Stirling numbers of the first kind works in a similar way.</p>
<h2 id="expected-number-of-cycles-of-a-given-size-m">Expected number of cycles of a given size <em>m</em></h2>

<p>In this problem we use a bivariate generating function <em>g</em>(<em>z</em>, <em>u</em>) as described in the introduction. The value of <em>b</em> for a cycle not of size <em>m</em> is zero, and one for a cycle of size <em>m</em>. We have</p>

<p>

<math display="block" id="Random_permutation_statistics:120">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
    <mpadded width="+2.8pt">
     <msup>
      <mi>z</mi>
      <mi>m</mi>
     </msup>
    </mpadded>
   </mrow>
   <mo rspace="5.3pt">+</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
    <mpadded width="+2.8pt">
     <msup>
      <mi>z</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mpadded>
   </mrow>
   <mo rspace="5.3pt">+</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
    <mpadded width="+2.8pt">
     <msup>
      <mi>z</mi>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>2</mn>
      </mrow>
     </msup>
    </mpadded>
   </mrow>
   <mo rspace="5.3pt">+</mo>
   <mi mathvariant="normal">⋯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <apply>
       <plus></plus>
       <ci>m</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <ci>normal-⋯</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{m}z^{m}\;+\;\frac{1}{m}z^{m+1}\;+\;\frac{1}{m}z^{m+2}\;+\;\cdots
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Random_permutation_statistics:121">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>k</mi>
       </msup>
       <mi>k</mi>
      </mfrac>
      <mtext>and</mtext>
      <mrow>
       <mo stretchy="false">[</mo>
       <msup>
        <mi>z</mi>
        <mi>n</mi>
       </msup>
       <mo stretchy="false">]</mo>
      </mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>m</mi>
    </msub>
    <mtext>for</mtext>
    <mi>n</mi>
   </mrow>
   <mo>≥</mo>
   <mi>m</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
        <mtext>and</mtext>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>n</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>k</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>m</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>k</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>H</ci>
       <ci>m</ci>
      </apply>
      <mtext>for</mtext>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <geq></geq>
     <share href="#.cmml">
     </share>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{1-z}\sum_{k=1}^{m}\frac{z^{k}}{k}\mbox{ and }[z^{n}]\frac{1}{1-z}\sum%
_{k=1}^{m}\frac{z^{k}}{k}=H_{m}\mbox{ for }n\geq m
  </annotation>
 </semantics>
</math>

</p>

<p>This means that the expected number of cycles of size <em>m</em> in a permutation of length <em>n</em> less than <em>m</em> is zero (obviously). A random permutation of length at least <em>m</em> contains on average 1/<em>m</em> cycles of length <em>m</em>. In particular, a random permutation contains about one fixed point.</p>

<p>The OGF of the expected number of cycles of length less than or equal to <em>m</em> is therefore</p>

<p>

<math display="inline" id="Random_permutation_statistics:122">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>H</em><sub><em>m</em></sub> is the <em>m</em>th <a href="harmonic_number" title="wikilink">harmonic number</a>. Hence the expected number of cycles of length at most <em>m</em> in a random permutation is about ln <em>m</em>.</p>
<h2 id="moments-of-fixed-points">Moments of fixed points</h2>

<p>The mixed GF 

<math display="block" id="Random_permutation_statistics:123">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>u</mi>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>u</mi>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>z</ci>
       </apply>
       <apply>
        <times></times>
        <ci>u</ci>
        <ci>z</ci>
       </apply>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>z</ci>
        </apply>
        <apply>
         <times></times>
         <ci>u</ci>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\exp\left(-z+uz+\log\frac{1}{1-z}\right)=\frac{1}{1-z}\exp(-z+uz).
  </annotation>
 </semantics>
</math>

 of the set of permutations by the number of fixed points is</p>

<p>

<math display="block" id="Random_permutation_statistics:124">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>X</mi>
       <mi>m</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>0</mn>
        </mrow>
        <mi>m</mi>
       </munderover>
       <mrow>
        <mrow>
         <mo>{</mo>
         <mtable displaystyle="true">
          <mtr>
           <mtd columnalign="center">
            <mi>m</mi>
           </mtd>
          </mtr>
          <mtr>
           <mtd columnalign="center">
            <mi>k</mi>
           </mtd>
          </mtr>
         </mtable>
         <mo>}</mo>
        </mrow>
        <msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>X</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo>{</mo>
       <mtable displaystyle="true">
        <mtr>
         <mtd columnalign="center">
          <mi>m</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd columnalign="center">
          <mi>k</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>}</mo>
      </mrow>
      <mi>E</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>X</mi>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <times></times>
        <set>
         <matrix>
          <matrixrow>
           <ci>m</ci>
          </matrixrow>
          <matrixrow>
           <ci>k</ci>
          </matrixrow>
         </matrix>
        </set>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <times></times>
       <set>
        <matrix>
         <matrixrow>
          <ci>m</ci>
         </matrixrow>
         <matrixrow>
          <ci>k</ci>
         </matrixrow>
        </matrix>
       </set>
       <ci>E</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(X^{m})=E\left(\sum_{k=0}^{m}\left\{\begin{matrix}m\\
k\end{matrix}\right\}(X)_{k}\right)=\sum_{k=0}^{m}\left\{\begin{matrix}m\\
k\end{matrix}\right\}E((X)_{k}),
  </annotation>
 </semantics>
</math>

</p>

<p>Let the random variable <em>X</em> be the number of fixed points of a random permutation. Using <a href="Stirling_number#Stirling_number_of_the_second_kind" title="wikilink">Stirling numbers of the second kind</a>, we have the following formula for the <em>m</em>th moment of <em>X</em>:</p>

<p>

<math display="inline" id="Random_permutation_statistics:125">
 <semantics>
  <msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (X)_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Random_permutation_statistics:126">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)
  </annotation>
 </semantics>
</math>

 is a <a href="falling_factorial" title="wikilink">falling factorial</a>. Using 

<math display="block" id="Random_permutation_statistics:127">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>X</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msub>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">[</mo>
        <msup>
         <mi>z</mi>
         <mi>n</mi>
        </msup>
        <mo stretchy="false">]</mo>
       </mrow>
       <msup>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mi>d</mi>
          <mrow>
           <mi>d</mi>
           <mi>u</mi>
          </mrow>
         </mfrac>
         <mo>)</mo>
        </mrow>
        <mi>k</mi>
       </msup>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">[</mo>
        <msup>
         <mi>z</mi>
         <mi>n</mi>
        </msup>
        <mo stretchy="false">]</mo>
       </mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mrow>
           <mo>-</mo>
           <mi>z</mi>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mi>u</mi>
           <mi>z</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mfrac>
      <msup>
       <mi>z</mi>
       <mi>k</mi>
      </msup>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>E</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <ci>d</ci>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>u</ci>
         </apply>
        </apply>
        <ci>k</ci>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <ci>z</ci>
         </apply>
         <apply>
          <times></times>
          <ci>u</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E((X)_{k})=[z^{n}]\left(\frac{d}{du}\right)^{k}g(z,u)\Bigg|_{u=1}=[z^{n}]\frac%
{z^{k}}{1-z}\exp(-z+uz)\Bigg|_{u=1}=[z^{n}]\frac{z^{k}}{1-z},
  </annotation>
 </semantics>
</math>

, we have</p>

<p>

<math display="inline" id="Random_permutation_statistics:128">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>></mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>k</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k>n
  </annotation>
 </semantics>
</math>

</p>

<p>which is zero when 

<math display="inline" id="Random_permutation_statistics:129">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>≤</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <ci>k</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k<=n
  </annotation>
 </semantics>
</math>

, and one otherwise. Hence only terms with 

<math display="block" id="Random_permutation_statistics:130">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>E</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msup>
       <mi>X</mi>
       <mi>m</mi>
      </msup>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mo>{</mo>
      <mtable displaystyle="true">
       <mtr>
        <mtd columnalign="center">
         <mi>m</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd columnalign="center">
         <mi>k</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>}</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>m</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <set>
      <matrix>
       <matrixrow>
        <ci>m</ci>
       </matrixrow>
       <matrixrow>
        <ci>k</ci>
       </matrixrow>
      </matrix>
     </set>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E(X^{m})=\sum_{k=0}^{n}\left\{\begin{matrix}m\\
k\end{matrix}\right\}.
  </annotation>
 </semantics>
</math>

 contribute to the sum. This yields</p>

<p>

<math display="inline" id="Random_permutation_statistics:131">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

</p>
<h2 id="expected-number-of-fixed-points-in-random-permutation-raised-to-some-power-k">Expected number of fixed points in random permutation raised to some power <em>k</em></h2>

<p>Suppose you pick a random permutation 

<math display="inline" id="Random_permutation_statistics:132">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>


 and raise it to some power 

<math display="inline" id="Random_permutation_statistics:133">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

, with 

<math display="inline" id="Random_permutation_statistics:134">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>F</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[F_{k}]
  </annotation>
 </semantics>
</math>

 a positive integer and ask about the expected number of fixed points in the result. Denote this value by 

<math display="inline" id="Random_permutation_statistics:135">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

.</p>

<p>For every divisor 

<math display="inline" id="Random_permutation_statistics:136">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 of 

<math display="inline" id="Random_permutation_statistics:137">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>


 a cycle of length 

<math display="inline" id="Random_permutation_statistics:138">
 <semantics>
  <mi>d</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>d</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d
  </annotation>
 </semantics>
</math>

 splits into 

<math display="inline" id="Random_permutation_statistics:139">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k.
  </annotation>
 </semantics>
</math>

 fixed points when raised to the power 

<math display="inline" id="Random_permutation_statistics:140">
 <semantics>
  <mrow>
   <msup>
    <mi>u</mi>
    <mi>d</mi>
   </msup>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>u</ci>
    <ci>d</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u^{d}.
  </annotation>
 </semantics>
</math>

 Hence we need to mark these cycles with 

<math display="inline" id="Random_permutation_statistics:141">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>F</mi>
      <mn>6</mn>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[F_{6}].
  </annotation>
 </semantics>
</math>

 To illustrate this consider 

<math display="block" id="Random_permutation_statistics:142">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mrow>
             <mrow>
              <mi>u</mi>
              <mi>z</mi>
             </mrow>
             <mo>-</mo>
             <mi>z</mi>
            </mrow>
            <mo>+</mo>
            <mrow>
             <msup>
              <mi>u</mi>
              <mn>2</mn>
             </msup>
             <mfrac>
              <msup>
               <mi>z</mi>
               <mn>2</mn>
              </msup>
              <mn>2</mn>
             </mfrac>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mn>2</mn>
            </msup>
            <mn>2</mn>
           </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msup>
            <mi>u</mi>
            <mn>3</mn>
           </msup>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mn>3</mn>
            </msup>
            <mn>3</mn>
           </mfrac>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mn>3</mn>
          </msup>
          <mn>3</mn>
         </mfrac>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>u</mi>
          <mn>6</mn>
         </msup>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mn>6</mn>
          </msup>
          <mn>6</mn>
         </mfrac>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mn>6</mn>
        </msup>
        <mn>6</mn>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>log</mi>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <plus></plus>
          <apply>
           <minus></minus>
           <apply>
            <plus></plus>
            <apply>
             <minus></minus>
             <apply>
              <times></times>
              <ci>u</ci>
              <ci>z</ci>
             </apply>
             <ci>z</ci>
            </apply>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>u</ci>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <divide></divide>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>z</ci>
               <cn type="integer">2</cn>
              </apply>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <cn type="integer">2</cn>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>u</ci>
            <cn type="integer">3</cn>
           </apply>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <cn type="integer">3</cn>
            </apply>
            <cn type="integer">3</cn>
           </apply>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <cn type="integer">3</cn>
          </apply>
          <cn type="integer">3</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <cn type="integer">6</cn>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <cn type="integer">6</cn>
          </apply>
          <cn type="integer">6</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">6</cn>
        </apply>
        <cn type="integer">6</cn>
       </apply>
      </apply>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\exp\left(uz-z+u^{2}\frac{z^{2}}{2}-\frac{z^{2}}{2}+u^{3}\frac{z^{3}}{3%
}-\frac{z^{3}}{3}+u^{6}\frac{z^{6}}{6}-\frac{z^{6}}{6}+\log\frac{1}{1-z}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>We get</p>

<p>

<math display="block" id="Random_permutation_statistics:143">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mrow>
             <mrow>
              <mi>u</mi>
              <mi>z</mi>
             </mrow>
             <mo>-</mo>
             <mi>z</mi>
            </mrow>
            <mo>+</mo>
            <mrow>
             <msup>
              <mi>u</mi>
              <mn>2</mn>
             </msup>
             <mfrac>
              <msup>
               <mi>z</mi>
               <mn>2</mn>
              </msup>
              <mn>2</mn>
             </mfrac>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mn>2</mn>
            </msup>
            <mn>2</mn>
           </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msup>
            <mi>u</mi>
            <mn>3</mn>
           </msup>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mn>3</mn>
            </msup>
            <mn>3</mn>
           </mfrac>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mn>3</mn>
          </msup>
          <mn>3</mn>
         </mfrac>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>u</mi>
          <mn>6</mn>
         </msup>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mn>6</mn>
          </msup>
          <mn>6</mn>
         </mfrac>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mn>6</mn>
        </msup>
        <mn>6</mn>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <minus></minus>
            <apply>
             <times></times>
             <ci>u</ci>
             <ci>z</ci>
            </apply>
            <ci>z</ci>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>u</ci>
             <cn type="integer">2</cn>
            </apply>
            <apply>
             <divide></divide>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>z</ci>
              <cn type="integer">2</cn>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">2</cn>
           </apply>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>u</ci>
           <cn type="integer">3</cn>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">3</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">3</cn>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">6</cn>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">6</cn>
         </apply>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">6</cn>
       </apply>
       <cn type="integer">6</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{1-z}\exp\left(uz-z+u^{2}\frac{z^{2}}{2}-\frac{z^{2}}{2}+u^{3}\frac{z^%
{3}}{3}-\frac{z^{3}}{3}+u^{6}\frac{z^{6}}{6}-\frac{z^{6}}{6}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>which is</p>

<p>

<math display="block" id="Random_permutation_statistics:144">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mrow>
      <mfrac>
       <mo>∂</mo>
       <mrow>
        <mo>∂</mo>
        <mi>u</mi>
       </mrow>
      </mfrac>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mi>u</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <mi>u</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mi>z</mi>
        <mo>+</mo>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>z</mi>
         <mn>3</mn>
        </msup>
        <mo>+</mo>
        <msup>
         <mi>z</mi>
         <mn>6</mn>
        </msup>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mrow>
             <mrow>
              <mrow>
               <mrow>
                <mi>u</mi>
                <mi>z</mi>
               </mrow>
               <mo>-</mo>
               <mi>z</mi>
              </mrow>
              <mo>+</mo>
              <mrow>
               <msup>
                <mi>u</mi>
                <mn>2</mn>
               </msup>
               <mfrac>
                <msup>
                 <mi>z</mi>
                 <mn>2</mn>
                </msup>
                <mn>2</mn>
               </mfrac>
              </mrow>
             </mrow>
             <mo>-</mo>
             <mfrac>
              <msup>
               <mi>z</mi>
               <mn>2</mn>
              </msup>
              <mn>2</mn>
             </mfrac>
            </mrow>
            <mo>+</mo>
            <mrow>
             <msup>
              <mi>u</mi>
              <mn>3</mn>
             </msup>
             <mfrac>
              <msup>
               <mi>z</mi>
               <mn>3</mn>
              </msup>
              <mn>3</mn>
             </mfrac>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mn>3</mn>
            </msup>
            <mn>3</mn>
           </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
           <msup>
            <mi>u</mi>
            <mn>6</mn>
           </msup>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mn>6</mn>
            </msup>
            <mn>6</mn>
           </mfrac>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mn>6</mn>
          </msup>
          <mn>6</mn>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <mi>u</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <partialdiff></partialdiff>
       <apply>
        <partialdiff></partialdiff>
        <ci>u</ci>
       </apply>
      </apply>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <apply>
      <eq></eq>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <ci>z</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">6</cn>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <plus></plus>
           <apply>
            <minus></minus>
            <apply>
             <plus></plus>
             <apply>
              <minus></minus>
              <apply>
               <times></times>
               <ci>u</ci>
               <ci>z</ci>
              </apply>
              <ci>z</ci>
             </apply>
             <apply>
              <times></times>
              <apply>
               <csymbol cd="ambiguous">superscript</csymbol>
               <ci>u</ci>
               <cn type="integer">2</cn>
              </apply>
              <apply>
               <divide></divide>
               <apply>
                <csymbol cd="ambiguous">superscript</csymbol>
                <ci>z</ci>
                <cn type="integer">2</cn>
               </apply>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <divide></divide>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>z</ci>
              <cn type="integer">2</cn>
             </apply>
             <cn type="integer">2</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>u</ci>
             <cn type="integer">3</cn>
            </apply>
            <apply>
             <divide></divide>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <ci>z</ci>
              <cn type="integer">3</cn>
             </apply>
             <cn type="integer">3</cn>
            </apply>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">3</cn>
           </apply>
           <cn type="integer">3</cn>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>u</ci>
           <cn type="integer">6</cn>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">6</cn>
           </apply>
           <cn type="integer">6</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">6</cn>
         </apply>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>u</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left.\frac{\partial}{\partial u}g(z,u)\right|_{u=1}=\left.\frac{z+z^{2}+z^{3}%
+z^{6}}{1-z}\exp\left(uz-z+u^{2}\frac{z^{2}}{2}-\frac{z^{2}}{2}+u^{3}\frac{z^{%
3}}{3}-\frac{z^{3}}{3}+u^{6}\frac{z^{6}}{6}-\frac{z^{6}}{6}\right)\right|_{u=1}
  </annotation>
 </semantics>
</math>

</p>

<p>Once more continuing as described in the introduction, we find</p>

<p>

<math display="block" id="Random_permutation_statistics:145">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>z</mi>
     <mo>+</mo>
     <msup>
      <mi>z</mi>
      <mn>2</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>z</mi>
      <mn>3</mn>
     </msup>
     <mo>+</mo>
     <msup>
      <mi>z</mi>
      <mn>6</mn>
     </msup>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>-</mo>
     <mi>z</mi>
    </mrow>
   </mfrac>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <plus></plus>
     <ci>z</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">3</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">6</cn>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{z+z^{2}+z^{3}+z^{6}}{1-z}.
  </annotation>
 </semantics>
</math>

</p>

<p>which is</p>

<p>

<math display="inline" id="Random_permutation_statistics:146">
 <semantics>
  <mrow>
   <mrow>
    <mi>E</mi>
    <mrow>
     <mo stretchy="false">[</mo>
     <msub>
      <mi>F</mi>
      <mn>6</mn>
     </msub>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>4</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>E</ci>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>F</ci>
       <cn type="integer">6</cn>
      </apply>
     </apply>
    </apply>
    <cn type="integer">4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[F_{6}]=4
  </annotation>
 </semantics>
</math>

 The conclusion is that 

<math display="inline" id="Random_permutation_statistics:147">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>≥</mo>
   <mn>6</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>n</ci>
    <cn type="integer">6</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\geq 6
  </annotation>
 </semantics>
</math>

 for 

<math display="block" id="Random_permutation_statistics:148">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>d</mi>
          <mo>∣</mo>
          <mi>k</mi>
         </mrow>
        </munder>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <msup>
            <mi>u</mi>
            <mi>d</mi>
           </msup>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mi>d</mi>
            </msup>
            <mi>d</mi>
           </mfrac>
          </mrow>
          <mo>-</mo>
          <mfrac>
           <msup>
            <mi>z</mi>
            <mi>d</mi>
           </msup>
           <mi>d</mi>
          </mfrac>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>d</mi>
          <mo>∣</mo>
          <mi>k</mi>
         </mrow>
        </munder>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <msup>
            <mi>u</mi>
            <mi>d</mi>
           </msup>
           <mfrac>
            <msup>
             <mi>z</mi>
             <mi>d</mi>
            </msup>
            <mi>d</mi>
           </mfrac>
          </mrow>
          <mo>-</mo>
          <mfrac>
           <msup>
            <mi>z</mi>
            <mi>d</mi>
           </msup>
           <mi>d</mi>
          </mfrac>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>g</ci>
      <interval closure="open">
       <ci>z</ci>
       <ci>u</ci>
      </interval>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <plus></plus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <csymbol cd="unknown">d</csymbol>
          <ci>normal-∣</ci>
          <csymbol cd="unknown">k</csymbol>
         </cerror>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>u</ci>
           <ci>d</ci>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <ci>d</ci>
           </apply>
           <ci>d</ci>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>d</ci>
          </apply>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <csymbol cd="unknown">d</csymbol>
          <ci>normal-∣</ci>
          <csymbol cd="unknown">k</csymbol>
         </cerror>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>u</ci>
           <ci>d</ci>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <ci>d</ci>
           </apply>
           <ci>d</ci>
          </apply>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>d</ci>
          </apply>
          <ci>d</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\exp\left(\sum_{d\mid k}\left(u^{d}\frac{z^{d}}{d}-\frac{z^{d}}{d}%
\right)+\log\frac{1}{1-z}\right)=\frac{1}{1-z}\exp\left(\sum_{d\mid k}\left(u^%
{d}\frac{z^{d}}{d}-\frac{z^{d}}{d}\right)\right).
  </annotation>
 </semantics>
</math>

 and there are four fixed points on average.</p>

<p>The general procedure is</p>

<p>

<math display="block" id="Random_permutation_statistics:149">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mo>∂</mo>
        <mrow>
         <mo>∂</mo>
         <mi>u</mi>
        </mrow>
       </mfrac>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mrow>
         <msub>
          <mo largeop="true" symmetric="true">∑</mo>
          <mrow>
           <mi>d</mi>
           <mo>∣</mo>
           <mi>k</mi>
          </mrow>
         </msub>
         <msup>
          <mi>z</mi>
          <mi>d</mi>
         </msup>
        </mrow>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <munder>
           <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
           <mrow>
            <mi>d</mi>
            <mo>∣</mo>
            <mi>k</mi>
           </mrow>
          </munder>
          <mrow>
           <mo>(</mo>
           <mrow>
            <mrow>
             <msup>
              <mi>u</mi>
              <mi>d</mi>
             </msup>
             <mfrac>
              <msup>
               <mi>z</mi>
               <mi>d</mi>
              </msup>
              <mi>d</mi>
             </mfrac>
            </mrow>
            <mo>-</mo>
            <mfrac>
             <msup>
              <mi>z</mi>
              <mi>d</mi>
             </msup>
             <mi>d</mi>
            </mfrac>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>d</mi>
        <mo>∣</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <msup>
       <mi>z</mi>
       <mi>d</mi>
      </msup>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <csymbol cd="unknown">d</csymbol>
           <ci>normal-∣</ci>
           <csymbol cd="unknown">k</csymbol>
          </cerror>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>d</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <csymbol cd="unknown">d</csymbol>
           <ci>normal-∣</ci>
           <csymbol cd="unknown">k</csymbol>
          </cerror>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>u</ci>
            <ci>d</ci>
           </apply>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <ci>d</ci>
            </apply>
            <ci>d</ci>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <ci>d</ci>
           </apply>
           <ci>d</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">d</csymbol>
         <ci>normal-∣</ci>
         <csymbol cd="unknown">k</csymbol>
        </cerror>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>d</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left.\frac{\partial}{\partial u}g(z,u)\right|_{u=1}=\left.\frac{\sum_{d\mid k%
}z^{d}}{1-z}\exp\left(\sum_{d\mid k}\left(u^{d}\frac{z^{d}}{d}-\frac{z^{d}}{d}%
\right)\right)\right|_{u=1}=\frac{\sum_{d\mid k}z^{d}}{1-z}.
  </annotation>
 </semantics>
</math>

 Once more continuing as before, we find</p>

<p>

<math display="inline" id="Random_permutation_statistics:150">
 <semantics>
  <mrow>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msub>
     <mi>F</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>E</ci>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>F</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   E[F_{k}]
  </annotation>
 </semantics>
</math>

 We have shown that the value of 

<math display="inline" id="Random_permutation_statistics:151">
 <semantics>
  <mrow>
   <mi>τ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>τ</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau(k)
  </annotation>
 </semantics>
</math>

 is equal to 

<math display="inline" id="Random_permutation_statistics:152">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 (the <a href="Divisor_function" title="wikilink">number of divisors</a> of 

<math display="inline" id="Random_permutation_statistics:153">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo>≥</mo>
    <mi>k</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>n</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\geq k.
  </annotation>
 </semantics>
</math>

) as soon as 

<math display="inline" id="Random_permutation_statistics:154">
 <semantics>
  <mn>1</mn>
  <annotation-xml encoding="MathML-Content">
   <cn type="integer">1</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1
  </annotation>
 </semantics>
</math>

 It starts out at 

<math display="inline" id="Random_permutation_statistics:155">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>n</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n=1
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Random_permutation_statistics:156">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 and increases by one every time 

<math display="inline" id="Random_permutation_statistics:157">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 hits a divisor of 

<math display="inline" id="Random_permutation_statistics:158">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 up to and including 

<math display="inline" id="Random_permutation_statistics:159">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)
  </annotation>
 </semantics>
</math>

 itself.</p>
<h2 id="expected-number-of-cycles-of-any-length-of-a-random-permutation">Expected number of cycles of any length of a random permutation</h2>

<p>We construct the bivariate generating function 

<math display="inline" id="Random_permutation_statistics:160">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>b</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b(k)
  </annotation>
 </semantics>
</math>

 using 

<math display="inline" id="Random_permutation_statistics:161">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>b</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b(k)
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Random_permutation_statistics:162">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)
  </annotation>
 </semantics>
</math>

 is one for all cycles (every cycle contributes one to the total number of cycles).</p>

<p>Note that 

<math display="block" id="Random_permutation_statistics:163">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mo>)</mo>
    </mrow>
    <mi>u</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\left(\frac{1}{1-z}\right)^{u}
  </annotation>
 </semantics>
</math>

 has the closed form</p>

<p>

<math display="block" id="Random_permutation_statistics:164">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mo>∂</mo>
        <mrow>
         <mo>∂</mo>
         <mi>u</mi>
        </mrow>
       </mfrac>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mrow>
       <mi>b</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>k</mi>
       </msup>
       <mi>k</mi>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mi>log</mi>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial u}g(z,u)\Bigg|_{u=1}=\frac{1}{1-z}\sum_{k\geq 1}b(k)%
\frac{z^{k}}{k}=\frac{1}{1-z}\sum_{k\geq 1}\frac{z^{k}}{k}=\frac{1}{1-z}\log%
\frac{1}{1-z}.
  </annotation>
 </semantics>
</math>

</p>

<p>and generates the unsigned <a href="Stirling_numbers#Stirling_numbers_of_the_first_kind" title="wikilink">Stirling numbers of the first kind</a>.</p>

<p>We have</p>

<p>

<math display="inline" id="Random_permutation_statistics:165">
 <semantics>
  <msub>
   <mi>H</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>H</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>Hence the expected number of cycles is 

<math display="inline" id="Random_permutation_statistics:166">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <log></log>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log n
  </annotation>
 </semantics>
</math>

, or about 

<math display="inline" id="Random_permutation_statistics:167">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="number-of-permutations-with-a-cycle-of-length-larger-than-n2">Number of permutations with a cycle of length larger than <em>n</em>/2</h2>

<p>(Note that Section <a href="Random_permutation_statistics#One_hundred_prisoners" title="wikilink">One hundred prisoners</a> contains exactly the same problem with a very similar calculation, plus also a simpler elementary proof.)</p>

<p>Once more, start with the exponential generating function 

<math display="inline" id="Random_permutation_statistics:168">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒫</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒫</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{P}
  </annotation>
 </semantics>
</math>

, this time of the class 

<math display="inline" id="Random_permutation_statistics:169">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>/</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n/2
  </annotation>
 </semantics>
</math>

 of permutations according to size where cycles of length more than 

<math display="inline" id="Random_permutation_statistics:170">
 <semantics>
  <mi>u</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>u</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   u
  </annotation>
 </semantics>
</math>

 are marked with the variable 

<math display="block" id="Random_permutation_statistics:171">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>u</mi>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>k</mi>
           <mo>></mo>
           <mrow>
            <mo stretchy="false">⌊</mo>
            <mfrac>
             <mi>n</mi>
             <mn>2</mn>
            </mfrac>
            <mo stretchy="false">⌋</mo>
           </mrow>
          </mrow>
          <mi mathvariant="normal">∞</mi>
         </munderover>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mi>k</mi>
          </msup>
          <mi>k</mi>
         </mfrac>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>k</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mo stretchy="false">⌊</mo>
          <mfrac>
           <mi>n</mi>
           <mn>2</mn>
          </mfrac>
          <mo stretchy="false">⌋</mo>
         </mrow>
        </munderover>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mi>k</mi>
         </msup>
         <mi>k</mi>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>u</ci>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <gt></gt>
           <ci>k</ci>
           <apply>
            <floor></floor>
            <apply>
             <divide></divide>
             <ci>n</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
         </apply>
         <infinity></infinity>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <floor></floor>
         <apply>
          <divide></divide>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\exp\left(u\sum_{k>\lfloor\frac{n}{2}\rfloor}^{\infty}\frac{z^{k}}{k}+%
\sum_{k=1}^{\lfloor\frac{n}{2}\rfloor}\frac{z^{k}}{k}\right).
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Random_permutation_statistics:172">
 <semantics>
  <mfrac>
   <mi>n</mi>
   <mn>2</mn>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{n}{2}
  </annotation>
 </semantics>
</math>

</p>

<p>There can only be one cycle of length more than 

<math display="block" id="Random_permutation_statistics:173">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mrow>
      <mi>u</mi>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mo stretchy="false">⌊</mo>
         <mfrac>
          <mi>n</mi>
          <mn>2</mn>
         </mfrac>
         <mo stretchy="false">⌋</mo>
        </mrow>
       </munderover>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>></mo>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <mfrac>
         <mi>n</mi>
         <mn>2</mn>
        </mfrac>
        <mo stretchy="false">⌋</mo>
       </mrow>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mfrac>
      <msup>
       <mi>z</mi>
       <mi>k</mi>
      </msup>
      <mi>k</mi>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <times></times>
       <ci>u</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <floor></floor>
         <apply>
          <divide></divide>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <gt></gt>
         <ci>k</ci>
         <apply>
          <floor></floor>
          <apply>
           <divide></divide>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>k</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![uz^{n}]g(z,u)=n![z^{n}]\exp\left(\sum_{k=1}^{\lfloor\frac{n}{2}\rfloor}%
\frac{z^{k}}{k}\right)\sum_{k>\lfloor\frac{n}{2}\rfloor}^{\infty}\frac{z^{k}}{k}
  </annotation>
 </semantics>
</math>

, hence the answer to the question is given by</p>

<p>

<math display="block" id="Random_permutation_statistics:174">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <msup>
     <mi>z</mi>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">]</mo>
   </mrow>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mi>log</mi>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>-</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>></mo>
         <mrow>
          <mo stretchy="false">⌊</mo>
          <mfrac>
           <mi>n</mi>
           <mn>2</mn>
          </mfrac>
          <mo stretchy="false">⌋</mo>
         </mrow>
        </mrow>
        <mi mathvariant="normal">∞</mi>
       </munderover>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>></mo>
      <mrow>
       <mo stretchy="false">⌊</mo>
       <mfrac>
        <mi>n</mi>
        <mn>2</mn>
       </mfrac>
       <mo stretchy="false">⌋</mo>
      </mrow>
     </mrow>
     <mi mathvariant="normal">∞</mi>
    </munderover>
    <mfrac>
     <msup>
      <mi>z</mi>
      <mi>k</mi>
     </msup>
     <mi>k</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <minus></minus>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <gt></gt>
          <ci>k</ci>
          <apply>
           <floor></floor>
           <apply>
            <divide></divide>
            <ci>n</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>k</ci>
        </apply>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <gt></gt>
        <ci>k</ci>
        <apply>
         <floor></floor>
         <apply>
          <divide></divide>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <infinity></infinity>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>k</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]\exp\left(\log\frac{1}{1-z}-\sum_{k>\lfloor\frac{n}{2}\rfloor}^{%
\infty}\frac{z^{k}}{k}\right)\sum_{k>\lfloor\frac{n}{2}\rfloor}^{\infty}\frac{%
z^{k}}{k}
  </annotation>
 </semantics>
</math>

 or</p>

<p>

<math display="block" id="Random_permutation_statistics:175">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mo>-</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
         <mrow>
          <mi>k</mi>
          <mo>></mo>
          <mrow>
           <mo stretchy="false">⌊</mo>
           <mfrac>
            <mi>n</mi>
            <mn>2</mn>
           </mfrac>
           <mo stretchy="false">⌋</mo>
          </mrow>
         </mrow>
         <mi mathvariant="normal">∞</mi>
        </munderover>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mi>k</mi>
         </msup>
         <mi>k</mi>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>></mo>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <mfrac>
         <mi>n</mi>
         <mn>2</mn>
        </mfrac>
        <mo stretchy="false">⌋</mo>
       </mrow>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mfrac>
      <msup>
       <mi>z</mi>
       <mi>k</mi>
      </msup>
      <mi>k</mi>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>m</mi>
       <mo>=</mo>
       <mn>0</mn>
      </mrow>
      <mi mathvariant="normal">∞</mi>
     </munderover>
     <mrow>
      <mfrac>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>m</mi>
       </msup>
       <mrow>
        <mi>m</mi>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>k</mi>
           <mo>></mo>
           <mrow>
            <mo stretchy="false">⌊</mo>
            <mfrac>
             <mi>n</mi>
             <mn>2</mn>
            </mfrac>
            <mo stretchy="false">⌋</mo>
           </mrow>
          </mrow>
          <mi mathvariant="normal">∞</mi>
         </munderover>
         <mfrac>
          <msup>
           <mi>z</mi>
           <mi>k</mi>
          </msup>
          <mi>k</mi>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mi>m</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <gt></gt>
           <ci>k</ci>
           <apply>
            <floor></floor>
            <apply>
             <divide></divide>
             <ci>n</ci>
             <cn type="integer">2</cn>
            </apply>
           </apply>
          </apply>
         </apply>
         <infinity></infinity>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <gt></gt>
         <ci>k</ci>
         <apply>
          <floor></floor>
          <apply>
           <divide></divide>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>k</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>m</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>m</ci>
        </apply>
        <apply>
         <factorial></factorial>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <gt></gt>
            <ci>k</ci>
            <apply>
             <floor></floor>
             <apply>
              <divide></divide>
              <ci>n</ci>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
          </apply>
          <infinity></infinity>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>z</ci>
           <ci>k</ci>
          </apply>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <plus></plus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]\frac{1}{1-z}\exp\left(-\sum_{k>\lfloor\frac{n}{2}\rfloor}^{\infty}%
\frac{z^{k}}{k}\right)\sum_{k>\lfloor\frac{n}{2}\rfloor}^{\infty}\frac{z^{k}}{%
k}=n![z^{n}]\frac{1}{1-z}\sum_{m=0}^{\infty}\frac{(-1)^{m}}{m!}\left(\sum_{k>%
\lfloor\frac{n}{2}\rfloor}^{\infty}\frac{z^{k}}{k}\right)^{m+1}
  </annotation>
 </semantics>
</math>

 which is</p>

<p>

<math display="inline" id="Random_permutation_statistics:176">
 <semantics>
  <mi>z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   z
  </annotation>
 </semantics>
</math>

</p>

<p>The exponent of 

<math display="inline" id="Random_permutation_statistics:177">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>m</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m+1
  </annotation>
 </semantics>
</math>

 in the term being raised to the power 

<math display="inline" id="Random_permutation_statistics:178">
 <semantics>
  <mrow>
   <mo stretchy="false">⌊</mo>
   <mfrac>
    <mi>n</mi>
    <mn>2</mn>
   </mfrac>
   <mo stretchy="false">⌋</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <floor></floor>
    <apply>
     <divide></divide>
     <ci>n</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lfloor\frac{n}{2}\rfloor
  </annotation>
 </semantics>
</math>

 is larger than 

<math display="inline" id="Random_permutation_statistics:179">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>></mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <gt></gt>
    <ci>m</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m>0
  </annotation>
 </semantics>
</math>

 and hence no value for 

<math display="inline" id="Random_permutation_statistics:180">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">[</mo>
    <msup>
     <mi>z</mi>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>z</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [z^{n}].
  </annotation>
 </semantics>
</math>

 can possibly contribute to 

<math display="block" id="Random_permutation_statistics:181">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>></mo>
        <mrow>
         <mo stretchy="false">⌊</mo>
         <mfrac>
          <mi>n</mi>
          <mn>2</mn>
         </mfrac>
         <mo stretchy="false">⌋</mo>
        </mrow>
       </mrow>
       <mi mathvariant="normal">∞</mi>
      </munderover>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mi>k</mi>
       </msup>
       <mi>k</mi>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mrow>
         <mrow>
          <mo stretchy="false">⌊</mo>
          <mfrac>
           <mi>n</mi>
           <mn>2</mn>
          </mfrac>
          <mo stretchy="false">⌋</mo>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mi>k</mi>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <gt></gt>
         <ci>k</ci>
         <apply>
          <floor></floor>
          <apply>
           <divide></divide>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <infinity></infinity>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>k</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <apply>
          <plus></plus>
          <apply>
           <floor></floor>
           <apply>
            <divide></divide>
            <ci>n</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]\frac{1}{1-z}\sum_{k>\lfloor\frac{n}{2}\rfloor}^{\infty}\frac{z^{k}}{%
k}=n!\sum_{k=\lfloor\frac{n}{2}\rfloor+1}^{n}\frac{1}{k}.
  </annotation>
 </semantics>
</math>

</p>

<p>It follows that the answer is</p>

<p>

<math display="block" id="Random_permutation_statistics:182">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mfrac>
      <mn>1</mn>
      <mi>k</mi>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mrow>
       <mo stretchy="false">⌊</mo>
       <mfrac>
        <mi>n</mi>
        <mn>2</mn>
       </mfrac>
       <mo stretchy="false">⌋</mo>
      </mrow>
     </munderover>
     <mfrac>
      <mn>1</mn>
      <mi>k</mi>
     </mfrac>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mfrac>
      <mn>1</mn>
      <mi>k</mi>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mn>2</mn>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mo stretchy="false">⌊</mo>
        <mfrac>
         <mi>n</mi>
         <mn>2</mn>
        </mfrac>
        <mo stretchy="false">⌋</mo>
       </mrow>
      </munderover>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>2</mn>
        <mi>k</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mrow>
           <mi>k</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mrow>
           <mpadded width="+2.8pt">
            <mi>k</mi>
           </mpadded>
           <mtext>even</mtext>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mi>n</mi>
     </munderover>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mn>2</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mfrac>
       <mn>1</mn>
       <mi>k</mi>
      </mfrac>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mrow>
           <mi>k</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mrow>
           <mpadded width="+2.8pt">
            <mi>k</mi>
           </mpadded>
           <mtext>odd</mtext>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mi>n</mi>
     </munderover>
     <mfrac>
      <mn>1</mn>
      <mi>k</mi>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <floor></floor>
         <apply>
          <divide></divide>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <floor></floor>
          <apply>
           <divide></divide>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <ci>STACKED</ci>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <times></times>
           <ci>k</ci>
           <mtext>even</mtext>
          </apply>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <ci>STACKED</ci>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <times></times>
           <ci>k</ci>
           <mtext>odd</mtext>
          </apply>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{k=1}^{n}\frac{1}{k}-\sum_{k=1}^{\lfloor\frac{n}{2}\rfloor}\frac{1}{k}=%
\sum_{k=1}^{n}\frac{1}{k}-2\sum_{k=1}^{\lfloor\frac{n}{2}\rfloor}\frac{1}{2k}=%
\sum_{k=1\atop k\;\text{even}}^{n}(1-2)\frac{1}{k}+\sum_{k=1\atop k\;\text{odd%
}}^{n}\frac{1}{k}
  </annotation>
 </semantics>
</math>

</p>

<p>The sum has an alternate representation that one encounters e.g. in the <a href="http://oeis.org/A024167">OEIS (A024167)</a>.</p>

<p>

<math display="block" id="Random_permutation_statistics:183">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>k</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mi>k</mi>
     </mfrac>
    </mrow>
   </mrow>
   <mo>∼</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mi>log</mi>
     <mn>2.</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <log></log>
      <cn type="float">2.</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!\sum_{k=1}^{n}\frac{(-1)^{k+1}}{k}\sim n!\log 2.
  </annotation>
 </semantics>
</math>

 finally giving</p>

<p>

<math display="inline" id="Random_permutation_statistics:184">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>1 2 34</mn>
   <mo rspace="4.2pt" stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="float">1 2 34</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1\;2\;34)\,
  </annotation>
 </semantics>
</math>

</p>
<h2 id="expected-number-of-transpositions-of-a-random-permutation">Expected number of transpositions of a random permutation</h2>

<p>We can use the disjoint cycle decomposition of a permutation to factorize it as a product of transpositions by replacing a cycle of length <em>k</em> by <em>k</em> − 1 transpositions. E.g. the cycle 

<math display="inline" id="Random_permutation_statistics:185">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>1 2</mn>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>2 3</mn>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>3 4</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="float">1 2</cn>
    <cn type="float">2 3</cn>
    <cn type="float">3 4</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1\;2)\;(2\;3)\;(3\;4)
  </annotation>
 </semantics>
</math>

 factors as 

<math display="inline" id="Random_permutation_statistics:186">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>b</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b(k)
  </annotation>
 </semantics>
</math>


. The function 

<math display="inline" id="Random_permutation_statistics:187">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>-</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <ci>k</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k-1
  </annotation>
 </semantics>
</math>

 for cycles is equal to 

<math display="block" id="Random_permutation_statistics:188">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mi>u</mi>
        <mi>z</mi>
       </mrow>
      </mrow>
     </mfrac>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mn>1</mn>
     <mo>/</mo>
     <mi>u</mi>
    </mrow>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>u</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)=\left(\frac{1}{1-uz}\right)^{1/u}
  </annotation>
 </semantics>
</math>

 and we obtain</p>

<p>

<math display="block" id="Random_permutation_statistics:189">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mo>∂</mo>
        <mrow>
         <mo>∂</mo>
         <mi>u</mi>
        </mrow>
       </mfrac>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>k</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mi>z</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mfrac>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mi>log</mi>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <ci>z</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial u}g(z,u)\Bigg|_{u=1}=\frac{1}{1-z}\sum_{k\geq 1}(k-1)%
\frac{z^{k}}{k}=\frac{z}{(1-z)^{2}}-\frac{1}{1-z}\log\frac{1}{1-z}.
  </annotation>
 </semantics>
</math>

</p>

<p>and</p>

<p>

<math display="inline" id="Random_permutation_statistics:190">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>n</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>T</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(n)
  </annotation>
 </semantics>
</math>

</p>

<p>Hence the expected number of transpositions 

<math display="block" id="Random_permutation_statistics:191">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>T</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <msub>
      <mi>H</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>T</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <ci>n</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>H</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T(n)=n-H_{n}.\,
  </annotation>
 </semantics>
</math>

 is</p>

<p>

<math display="inline" id="Random_permutation_statistics:192">
 <semantics>
  <mrow>
   <mi>log</mi>
   <mpadded width="+1.7pt">
    <mi>n</mi>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <log></log>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \log n\,
  </annotation>
 </semantics>
</math>

</p>

<p>We could also have obtained this formula by noting that the number of transpositions is obtained by adding the lengths of all cycles (which gives <em>n</em>) and subtracting one for every cycle (which gives 

<math display="inline" id="Random_permutation_statistics:193">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <interval closure="open">
     <ci>z</ci>
     <ci>u</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u)
  </annotation>
 </semantics>
</math>

 by the previous section).</p>

<p>Note that 

<math display="block" id="Random_permutation_statistics:194">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>m</mi>
    </msup>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>u</mi>
      <mi>m</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>m</mi>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>u</ci>
       <ci>m</ci>
      </apply>
     </apply>
     <ci>g</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>u</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <ci>n</ci>
      </matrixrow>
      <matrixrow>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (-1)^{m}n!\;[z^{n}][u^{m}]g(z,u)=\left[\begin{matrix}n\\
n-m\end{matrix}\right]
  </annotation>
 </semantics>
</math>

 again generates the unsigned <a href="Stirling_numbers#Stirling_numbers_of_the_first_kind" title="wikilink">Stirling numbers of the first kind</a>, but in reverse order. More precisely, we have</p>

<p>

<math display="block" id="Random_permutation_statistics:195">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <msub>
      <mrow>
       <mrow>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mi>m</mi>
         </mrow>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">[</mo>
         <msup>
          <mi>z</mi>
          <mi>n</mi>
         </msup>
         <mo stretchy="false">]</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">[</mo>
         <msup>
          <mi>u</mi>
          <mi>m</mi>
         </msup>
         <mo stretchy="false">]</mo>
        </mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>z</mi>
         <mo>,</mo>
         <mi>u</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo fence="true">|</mo>
      </mrow>
      <mrow>
       <mi>u</mi>
       <mo>=</mo>
       <mrow>
        <mn>1</mn>
        <mo>/</mo>
        <mi>u</mi>
       </mrow>
      </mrow>
     </msub>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <mi>z</mi>
     <mo>=</mo>
     <mrow>
      <mi>u</mi>
      <mi>z</mi>
     </mrow>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>[</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>n</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>m</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>]</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <factorial></factorial>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-[]</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>u</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>z</ci>
      <apply>
       <times></times>
       <ci>u</ci>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">delimited-[]</csymbol>
     <matrix>
      <matrixrow>
       <ci>n</ci>
      </matrixrow>
      <matrixrow>
       <ci>m</ci>
      </matrixrow>
     </matrix>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (-1)^{n+m}n!\;[z^{n}][u^{m}]g(z,u)|_{u=1/u}|_{z=uz}=\left[\begin{matrix}n\\
m\end{matrix}\right]
  </annotation>
 </semantics>
</math>

</p>

<p>To see this, note that the above is equivalent to</p>

<p>

<math display="block" id="Random_permutation_statistics:196">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <msub>
       <mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">[</mo>
          <msup>
           <mi>u</mi>
           <mi>m</mi>
          </msup>
          <mo stretchy="false">]</mo>
         </mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>z</mi>
          <mo>,</mo>
          <mi>u</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo fence="true">|</mo>
       </mrow>
       <mrow>
        <mi>u</mi>
        <mo>=</mo>
        <mrow>
         <mn>1</mn>
         <mo>/</mo>
         <mi>u</mi>
        </mrow>
       </mrow>
      </msub>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>z</mi>
      <mo>=</mo>
      <mrow>
       <mi>u</mi>
       <mi>z</mi>
      </mrow>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>u</mi>
       <mi>m</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>u</mi>
     </msup>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mi>m</mi>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mi>m</mi>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <csymbol cd="latexml">evaluated-at</csymbol>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <ci>m</ci>
         </apply>
        </apply>
        <ci>g</ci>
        <interval closure="open">
         <ci>z</ci>
         <ci>u</ci>
        </interval>
       </apply>
       <apply>
        <eq></eq>
        <ci>u</ci>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <ci>u</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>z</ci>
       <apply>
        <times></times>
        <ci>u</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <factorial></factorial>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [u^{m}]g(z,u)|_{u=1/u}|_{z=uz}=[u^{m}]\left(\frac{1}{1-z}\right)^{u}=\frac{1}{%
m!}\left(\log\frac{1}{1-z}\right)^{m},
  </annotation>
 </semantics>
</math>

</p>

<p>and that</p>

<p>

<math display="inline" id="Random_permutation_statistics:197">
 <semantics>
  <mi>σ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>σ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

</p>

<p>which we saw to be the EGF of the unsigned Stirling numbers of the first kind in the section on permutations consisting of precisely <em>m</em> cycles.</p>
<h2 id="expected-cycle-size-of-a-random-element">Expected cycle size of a random element</h2>

<p>We select a random element <em>q</em> of a random permutation 

<math display="inline" id="Random_permutation_statistics:198">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>b</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b(k)
  </annotation>
 </semantics>
</math>

 and ask about the expected size of the cycle that contains <em>q</em>. Here the function 

<math display="inline" id="Random_permutation_statistics:199">
 <semantics>
  <msup>
   <mi>k</mi>
   <mn>2</mn>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>k</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k^{2}
  </annotation>
 </semantics>
</math>

 is equal to 

<math display="block" id="Random_permutation_statistics:200">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mo>∂</mo>
        <mrow>
         <mo>∂</mo>
         <mi>u</mi>
        </mrow>
       </mfrac>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mrow>
       <msup>
        <mi>k</mi>
        <mn>2</mn>
       </msup>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mi>z</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mi>z</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>k</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>z</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <ci>z</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial u}g(z,u)\Bigg|_{u=1}=\frac{1}{1-z}\sum_{k\geq 1}k^{2}%
\frac{z^{k}}{k}=\frac{1}{1-z}\frac{z}{(1-z)^{2}}=\frac{z}{(1-z)^{3}}.
  </annotation>
 </semantics>
</math>

, because a cycle of length <em>k</em> contributes <em>k</em> elements that are on cycles of length <em>k</em>. Note that unlike the previous computations, we need to average out this parameter after we extract it from the generating function (divide by <em>n</em>). We have</p>

<p>

<math display="block" id="Random_permutation_statistics:201">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mfrac>
      <mi>z</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>3</mn>
      </msup>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>n</mi>
     </mfrac>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <ci>z</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{n}[z^{n}]\frac{z}{(1-z)^{3}}=\frac{1}{n}\frac{1}{2}n(n+1)=\frac{1}{2}%
(n+1).
  </annotation>
 </semantics>
</math>

</p>

<p>Hence the expected length of the cycle that contains <em>q</em> is</p>

<p>

<math display="inline" id="Random_permutation_statistics:202">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mi>n</mi>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [n]
  </annotation>
 </semantics>
</math>

</p>
<h2 id="probability-that-a-random-element-lies-on-a-cycle-of-size-m">Probability that a random element lies on a cycle of size <em>m</em></h2>

<p>This average parameter represents the probability that if we again select a random element of 

<math display="inline" id="Random_permutation_statistics:203">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>k</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>b</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b(k)
  </annotation>
 </semantics>
</math>

 of a random permutation, the element lies on a cycle of size <em>m</em>. The function 

<math display="inline" id="Random_permutation_statistics:204">
 <semantics>
  <mi>m</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>m</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m
  </annotation>
 </semantics>
</math>

 is equal to 

<math display="inline" id="Random_permutation_statistics:205">
 <semantics>
  <mrow>
   <mi>m</mi>
   <mo>=</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>m</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m=k
  </annotation>
 </semantics>
</math>

 for 

<math display="block" id="Random_permutation_statistics:206">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mo>∂</mo>
        <mrow>
         <mo>∂</mo>
         <mi>u</mi>
        </mrow>
       </mfrac>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mrow>
       <mi>b</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mpadded width="+2.8pt">
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </mpadded>
     <mpadded width="+2.8pt">
      <mi>m</mi>
     </mpadded>
     <mfrac>
      <msup>
       <mi>z</mi>
       <mi>m</mi>
      </msup>
      <mi>m</mi>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <msup>
      <mi>z</mi>
      <mi>m</mi>
     </msup>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>b</ci>
        <ci>k</ci>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <ci>m</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>m</ci>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial u}g(z,u)\Bigg|_{u=1}=\frac{1}{1-z}\sum_{k\geq 1}b(k)%
\frac{z^{k}}{k}=\frac{1}{1-z}\;m\;\frac{z^{m}}{m}=\frac{z^{m}}{1-z}.
  </annotation>
 </semantics>
</math>

 and zero otherwise, because only cycles of length <em>m</em> contribute, namely <em>m</em> elements that lie on a cycle of length <em>m</em>. We have</p>

<p>

<math display="block" id="Random_permutation_statistics:207">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mfrac>
     <msup>
      <mi>z</mi>
      <mi>m</mi>
     </msup>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <mi>z</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mn>1</mn>
          <mi>n</mi>
         </mfrac>
        </mstyle>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mtext>if</mtext>
         <mi>n</mi>
        </mrow>
        <mo>≥</mo>
        <mi>m</mi>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mn>0</mn>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mtext>otherwise.</mtext>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>n</ci>
     </apply>
     <apply>
      <geq></geq>
      <apply>
       <times></times>
       <mtext>if</mtext>
       <ci>n</ci>
      </apply>
      <ci>m</ci>
     </apply>
     <cn type="integer">0</cn>
     <mtext>otherwise.</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{n}[z^{n}]\frac{z^{m}}{1-z}=\begin{cases}\frac{1}{n},&\mbox{if }n\geq m%
\\
0,&\mbox{otherwise.}\end{cases}
  </annotation>
 </semantics>
</math>

</p>

<p>It follows that the probability that a random element lies on a cycle of length <em>m</em> is</p>

<p>

<math display="inline" id="Random_permutation_statistics:208">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="center">
     <mrow>
      <mo>(</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>k</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mi>m</mi>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mo>)</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>k</ci>
      <ci>m</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{matrix}{k\choose m}\end{matrix}
  </annotation>
 </semantics>
</math>


</p>
<h2 id="probability-that-a-random-subset-of-n-lies-on-the-same-cycle">Probability that a random subset of [<em>n</em>] lies on the same cycle</h2>

<p>Select a random subset <em>Q</em> of [<em>n</em>] containing <em>m</em> elements and a random permutation, and ask about the probability that all elements of <em>Q</em> lie on the same cycle. This is another average parameter. The function <em>b</em>(<em>k</em>) is equal to 

<math display="inline" id="Random_permutation_statistics:209">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="center">
     <mrow>
      <mo>(</mo>
      <mstyle scriptlevel="+1">
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>k</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mi>m</mi>
         </mtd>
        </mtr>
       </mtable>
      </mstyle>
      <mo>)</mo>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <ci>k</ci>
      <ci>m</ci>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{matrix}{k\choose m}\end{matrix}
  </annotation>
 </semantics>
</math>

, because a cycle of length <em>k</em> contributes 

<math display="inline" id="Random_permutation_statistics:210">
 <semantics>
  <mtable>
   <mtr>
    <mtd columnalign="center">
     <mrow>
      <mrow>
       <mo>(</mo>
       <mstyle scriptlevel="+1">
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mi>k</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mi>m</mi>
          </mtd>
         </mtr>
        </mtable>
       </mstyle>
       <mo>)</mo>
      </mrow>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
  <annotation-xml encoding="MathML-Content">
   <matrix>
    <matrixrow>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>k</ci>
       <ci>m</ci>
      </apply>
      <cn type="integer">0</cn>
     </apply>
    </matrixrow>
   </matrix>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \begin{matrix}{k\choose m}=0\end{matrix}
  </annotation>
 </semantics>
</math>

 subsets of size <em>m</em>, where 

<math display="block" id="Random_permutation_statistics:211">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mo>∂</mo>
        <mrow>
         <mo>∂</mo>
         <mi>u</mi>
        </mrow>
       </mfrac>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mi>u</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>u</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>≥</mo>
        <mi>m</mi>
       </mrow>
      </munder>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mtable columnspacing="0.4em" rowspacing="0.2ex">
         <mtr>
          <mtd>
           <mi>k</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mi>m</mi>
          </mtd>
         </mtr>
        </mtable>
        <mo>)</mo>
       </mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mi>k</mi>
        </msup>
        <mi>k</mi>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <mfrac>
      <msup>
       <mi>z</mi>
       <mi>m</mi>
      </msup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>m</mi>
      </msup>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <mfrac>
      <msup>
       <mi>z</mi>
       <mi>m</mi>
      </msup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>m</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <partialdiff></partialdiff>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <interval closure="open">
        <ci>z</ci>
        <ci>u</ci>
       </interval>
      </apply>
      <apply>
       <eq></eq>
       <ci>u</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="latexml">binomial</csymbol>
         <ci>k</ci>
         <ci>m</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>m</ci>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>m</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
        <apply>
         <plus></plus>
         <ci>m</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial}{\partial u}g(z,u)\Bigg|_{u=1}=\frac{1}{1-z}\sum_{k\geq m}{k%
\choose m}\frac{z^{k}}{k}=\frac{1}{1-z}\frac{1}{m}\frac{z^{m}}{(1-z)^{m}}=%
\frac{1}{m}\frac{z^{m}}{(1-z)^{m+1}}.
  </annotation>
 </semantics>
</math>

 for . This yields</p>

<p>

<math display="block" id="Random_permutation_statistics:212">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>m</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
    <mfrac>
     <msup>
      <mi>z</mi>
      <mi>m</mi>
     </msup>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mi>n</mi>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>m</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mi>m</mi>
      </mrow>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>m</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <plus></plus>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {n\choose m}^{-1}[z^{n}]\frac{1}{m}\frac{z^{m}}{(1-z)^{m+1}}={n\choose m}^{-1}%
\frac{1}{m}[z^{n-m}]\frac{1}{(1-z)^{m+1}}
  </annotation>
 </semantics>
</math>

</p>

<p>Averaging out we obtain that the probability of the elements of <em>Q</em> being on the same cycle is</p>

<p>

<math display="block" id="Random_permutation_statistics:213">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mtable columnspacing="0.4em" rowspacing="0.2ex">
        <mtr>
         <mtd>
          <mi>n</mi>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mi>m</mi>
         </mtd>
        </mtr>
       </mtable>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo>(</mo>
      <mtable columnspacing="0.4em" rowspacing="0.2ex">
       <mtr>
        <mtd>
         <mrow>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mi>n</mi>
            <mo>-</mo>
            <mi>m</mi>
           </mrow>
           <mo rspace="5.3pt" stretchy="false">)</mo>
          </mrow>
          <mo rspace="5.3pt">+</mo>
          <mi>m</mi>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mi>m</mi>
        </mtd>
       </mtr>
      </mtable>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>m</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>m</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="latexml">binomial</csymbol>
       <ci>n</ci>
       <ci>m</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">binomial</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <ci>m</ci>
       </apply>
       <ci>m</ci>
      </apply>
      <ci>m</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{m}{n\choose m}^{-1}{(n-m)\;+\;m\choose m}=\frac{1}{m}.
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Random_permutation_statistics:214">
 <semantics>
  <mrow>
   <mrow>
    <mi>𝔓</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>ℭ</mi>
       <mo>odd</mo>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msub>
     <mi>𝔓</mi>
     <mo>even</mo>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>ℭ</mi>
       <mo>even</mo>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔓</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <ci>odd</ci>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔓</ci>
     <ci>even</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <ci>even</ci>
     </apply>
     <ci>𝒵</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}(\mathfrak{C}_{\operatorname{odd}}(\mathcal{Z}))\mathfrak{P}_{%
\operatorname{even}}(\mathfrak{C}_{\operatorname{even}}(\mathcal{Z})).
  </annotation>
 </semantics>
</math>

</p>

<p>In particular, the probability that two elements  are on the same cycle is 1/2.</p>
<h2 id="number-of-permutations-containing-an-even-number-of-even-cycles">Number of permutations containing an even number of even cycles</h2>

<p>We may use the <a href="Symbolic_combinatorics#The_Flajolet–Sedgewick_fundamental_theorem" title="wikilink">Flajolet–Sedgewick fundamental theorem</a> directly and compute more advanced permutation statistics. (Check that page for an explanation of how the operators we will use are computed.) For example, the set of permutations containing an even number of even cycles is given by</p>

<p>

<math display="block" id="Random_permutation_statistics:215">
 <semantics>
  <mrow>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>log</mi>
       <mfrac>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mi>z</mi>
        </mrow>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mrow>
    <mi>cosh</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mi>log</mi>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <exp></exp>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <cosh></cosh>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\left(\frac{1}{2}\log\frac{1+z}{1-z}\right)\cosh\left(\frac{1}{2}\log\frac%
{1}{1-z^{2}}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Translating to <a href="exponential_generating_function" title="wikilink">exponential generating functions</a> (EGFs), we obtain</p>

<p>

<math display="block" id="Random_permutation_statistics:216">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <mi>log</mi>
           <mfrac>
            <mrow>
             <mn>1</mn>
             <mo>+</mo>
             <mi>z</mi>
            </mrow>
            <mrow>
             <mn>1</mn>
             <mo>-</mo>
             <mi>z</mi>
            </mrow>
           </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
           <mi>log</mi>
           <mfrac>
            <mn>1</mn>
            <mrow>
             <mn>1</mn>
             <mo>-</mo>
             <msup>
              <mi>z</mi>
              <mn>2</mn>
             </msup>
            </mrow>
           </mfrac>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mrow>
           <mi>log</mi>
           <mfrac>
            <mrow>
             <mn>1</mn>
             <mo>+</mo>
             <mi>z</mi>
            </mrow>
            <mrow>
             <mn>1</mn>
             <mo>-</mo>
             <mi>z</mi>
            </mrow>
           </mfrac>
          </mrow>
          <mo>-</mo>
          <mrow>
           <mi>log</mi>
           <mfrac>
            <mn>1</mn>
            <mrow>
             <mn>1</mn>
             <mo>-</mo>
             <msup>
              <mi>z</mi>
              <mn>2</mn>
             </msup>
            </mrow>
           </mfrac>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <log></log>
         <apply>
          <divide></divide>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <ci>z</ci>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <log></log>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <log></log>
         <apply>
          <divide></divide>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <ci>z</ci>
          </apply>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <log></log>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{2}\exp\left(\frac{1}{2}\left(\log\frac{1+z}{1-z}+\log\frac{1}{1-z^{2}%
}\right)\right)+\frac{1}{2}\exp\left(\frac{1}{2}\left(\log\frac{1+z}{1-z}-\log%
\frac{1}{1-z^{2}}\right)\right).
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="block" id="Random_permutation_statistics:217">
 <semantics>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mn>2</mn>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>log</mi>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mo>+</mo>
   <mfrac>
    <mn>1</mn>
    <mn>2</mn>
   </mfrac>
   <mi>exp</mi>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>log</mi>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo>+</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <log></log>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </apply>
    <exp></exp>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <log></log>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <cn type="integer">1</cn>
       <plus></plus>
       <csymbol cd="unknown">z</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{2}\exp\left(\frac{1}{2}\log\frac{1}{(1-z)^{2}}\right)+\frac{1}{2}\exp%
\left(\frac{1}{2}\log(1+z)^{2}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>This simplifies to</p>

<p>

<math display="block" id="Random_permutation_statistics:218">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>+</mo>
     <mi>z</mi>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mfrac>
       <msup>
        <mi>z</mi>
        <mn>2</mn>
       </msup>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <cn type="integer">1</cn>
     <ci>z</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{2}\frac{1}{1-z}+\frac{1}{2}(1+z)=1+z+\frac{1}{2}\frac{z^{2}}{1-z}.
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="inline" id="Random_permutation_statistics:219">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>≥</mo>
   <mn>2</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <ci>n</ci>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\geq 2
  </annotation>
 </semantics>
</math>

</p>

<p>This says that there is one permutation of size zero containing an even number of even cycles (the empty permutation, which contains zero cycles of even length), one such permutation of size one (the fixed point, which also contains zero cycles of even length), and that for 

<math display="inline" id="Random_permutation_statistics:220">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
   <mo>/</mo>
   <mpadded width="+1.7pt">
    <mn>2</mn>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <factorial></factorial>
     <ci>n</ci>
    </apply>
    <cn type="integer">2</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!/2\,
  </annotation>
 </semantics>
</math>

, there are 

<math display="inline" id="Random_permutation_statistics:221">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>1 8 9 11 13</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="float">1 8 9 11 13</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1\;8\;9\;11\;13)
  </annotation>
 </semantics>
</math>

 such permutations.</p>
<h2 id="permutations-that-are-squares">Permutations that are squares</h2>

<p>Consider what happens when we square a permutation. Fixed points are mapped to fixed points. Odd cycles are mapped to odd cycles in a one-to-one correspondence, e.g. 

<math display="inline" id="Random_permutation_statistics:222">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>1 9 13 8 11</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="float">1 9 13 8 11</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (1\;9\;13\;8\;11)
  </annotation>
 </semantics>
</math>

 turns into 

<math display="inline" id="Random_permutation_statistics:223">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mn>5 13 6 9</mn>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cn type="float">5 13 6 9</cn>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (5\;13\;6\;9)
  </annotation>
 </semantics>
</math>

. Even cycles split in two and produce a pair of cycles of half the size of the original cycle, e.g. 

<math display="inline" id="Random_permutation_statistics:224">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>5 6</mn>
    <mo rspace="5.3pt" stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mn>9 13</mn>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <cn type="float">5 6</cn>
    <cn type="float">9 13</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (5\;6)\;(9\;13)
  </annotation>
 </semantics>
</math>

 turns into 

<math display="block" id="Random_permutation_statistics:225">
 <semantics>
  <mrow>
   <mi>𝔓</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>ℭ</mi>
      <mo>odd</mo>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mi>𝔓</mi>
    <mo>even</mo>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>ℭ</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mi>𝔓</mi>
    <mo>even</mo>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>ℭ</mi>
      <mn>4</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msub>
    <mi>𝔓</mi>
    <mo>even</mo>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>ℭ</mi>
      <mn>6</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi mathvariant="normal">⋯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔓</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <ci>odd</ci>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔓</ci>
     <ci>even</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔓</ci>
     <ci>even</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔓</ci>
     <ci>even</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <cn type="integer">6</cn>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <ci>normal-⋯</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}(\mathfrak{C}_{\operatorname{odd}}(\mathcal{Z}))\mathfrak{P}_{%
\operatorname{even}}(\mathfrak{C}_{2}(\mathcal{Z}))\mathfrak{P}_{\operatorname%
{even}}(\mathfrak{C}_{4}(\mathcal{Z}))\mathfrak{P}_{\operatorname{even}}(%
\mathfrak{C}_{6}(\mathcal{Z}))\cdots
  </annotation>
 </semantics>
</math>

. Hence permutations that are squares may contain any number of odd cycles, and an even number of cycles of size two, an even number of cycles of size four etc., and are given by</p>

<p>

<math display="block" id="Random_permutation_statistics:226">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mrow>
         <mi>log</mi>
         <mfrac>
          <mrow>
           <mn>1</mn>
           <mo>+</mo>
           <mi>z</mi>
          </mrow>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mi>z</mi>
          </mrow>
         </mfrac>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>m</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mrow>
       <mi>cosh</mi>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mrow>
          <mn>2</mn>
          <mi>m</mi>
         </mrow>
        </msup>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </msqrt>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mrow>
        <mi>m</mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </munder>
      <mrow>
       <mi>cosh</mi>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mrow>
          <mn>2</mn>
          <mi>m</mi>
         </mrow>
        </msup>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <geq></geq>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <cosh></cosh>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <apply>
        <geq></geq>
        <ci>m</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <cosh></cosh>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\left(\frac{1}{2}\log\frac{1+z}{1-z}\right)\prod_{m\geq 1}\cosh\frac{z^{2m%
}}{2m}=\sqrt{\frac{1+z}{1-z}}\prod_{m\geq 1}\cosh\frac{z^{2m}}{2m}.
  </annotation>
 </semantics>
</math>

</p>

<p>which yields the EGF</p>

<p>

<math display="block" id="Random_permutation_statistics:227">
 <semantics>
  <mrow>
   <mi>𝔓</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>ℭ</mi>
      <mo>odd</mo>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>𝔓</mi>
       <mn>3</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>ℭ</mi>
         <mn>2</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi class="ltx_font_mathcaligraphic">𝒵</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>ℭ</mi>
       <mn>2</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>ℭ</mi>
       <mn>4</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>ℭ</mi>
       <mn>6</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔓</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <ci>odd</ci>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝔓</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ℭ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>𝒵</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>𝒵</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">6</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}(\mathfrak{C}_{\operatorname{odd}}(\mathcal{Z}))\left(\mathfrak{P}%
_{3}(\mathfrak{C}_{2}(\mathcal{Z}))+\mathfrak{C}_{2}(\mathcal{Z})\mathfrak{C}_%
{4}(\mathcal{Z})+\mathfrak{C}_{6}(\mathcal{Z})\right)
  </annotation>
 </semantics>
</math>

</p>
<h2 id="odd-cycle-invariants">Odd cycle invariants</h2>

<p>The types of permutations presented in the preceding two sections, i.e. permutations containing an even number of even cycles and permutations that are squares, are examples of so-called <strong>odd cycle invariants</strong>, studied by Sung and Zhang (see <a href="Random_permutation_statistics#External_links" title="wikilink">external links</a>). The term odd cycle invariant simply means that membership in the respective combinatorial class is independent of the size and number of odd cycles occurring in the permutation. In fact we can prove that all odd cycle invariants obey a simple recurrence, which we will derive. First, here are some more examples of odd cycle invariants.</p>
<h3 id="permutations-where-the-sum-of-the-lengths-of-the-even-cycles-is-six">Permutations where the sum of the lengths of the even cycles is six</h3>

<p>This class has the specification</p>

<p>

<math display="block" id="Random_permutation_statistics:228">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </msqrt>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mn>6</mn>
        </mfrac>
        <msup>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <msup>
            <mi>z</mi>
            <mn>2</mn>
           </msup>
           <mn>2</mn>
          </mfrac>
          <mo>)</mo>
         </mrow>
         <mn>3</mn>
        </msup>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
         <mn>2</mn>
        </mfrac>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
         <mn>4</mn>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mn>6</mn>
        </msup>
        <mn>6</mn>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>5</mn>
      <mn>16</mn>
     </mfrac>
     <msup>
      <mi>z</mi>
      <mn>6</mn>
     </msup>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </msqrt>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">6</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">6</cn>
       </apply>
       <cn type="integer">6</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">5</cn>
      <cn type="integer">16</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">6</cn>
     </apply>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{\frac{1+z}{1-z}}\left(\frac{1}{6}\left(\frac{z^{2}}{2}\right)^{3}+\frac{%
z^{2}}{2}\frac{z^{4}}{4}+\frac{z^{6}}{6}\right)=\frac{5}{16}z^{6}\sqrt{\frac{1%
+z}{1-z}}.
  </annotation>
 </semantics>
</math>

</p>

<p>and the generating function</p>

<p>

<math display="block" id="Random_permutation_statistics:229">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>,</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>0</mn>
   <mo>,</mo>
   <mn>225</mn>
   <mo>,</mo>
   <mn>1575</mn>
   <mo>,</mo>
   <mn>6300</mn>
   <mo>,</mo>
   <mn>56700</mn>
   <mo>,</mo>
   <mn>425250</mn>
   <mo>,</mo>
   <mn>4677750</mn>
   <mo>,</mo>
   <mn>46777500</mn>
   <mo>,</mo>
   <mn>608107500</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">0</cn>
    <cn type="integer">0</cn>
    <cn type="integer">0</cn>
    <cn type="integer">0</cn>
    <cn type="integer">0</cn>
    <cn type="integer">225</cn>
    <cn type="integer">1575</cn>
    <cn type="integer">6300</cn>
    <cn type="integer">56700</cn>
    <cn type="integer">425250</cn>
    <cn type="integer">4677750</cn>
    <cn type="integer">46777500</cn>
    <cn type="integer">608107500</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0,0,0,0,0,225,1575,6300,56700,425250,4677750,46777500,608107500,\ldots
  </annotation>
 </semantics>
</math>

</p>

<p>The first few values are</p>

<p>

<math display="block" id="Random_permutation_statistics:230">
 <semantics>
  <mrow>
   <mi>𝔓</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>ℭ</mi>
      <mo>odd</mo>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>𝔓</mi>
       <mrow>
        <mi></mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>ℭ</mi>
         <mn>2</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi class="ltx_font_mathcaligraphic">𝒵</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>𝔓</mi>
       <mrow>
        <mi></mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>ℭ</mi>
         <mn>4</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi class="ltx_font_mathcaligraphic">𝒵</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>𝔓</mi>
       <mrow>
        <mi></mi>
        <mo>≥</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mi>ℭ</mi>
         <mn>6</mn>
        </msub>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi class="ltx_font_mathcaligraphic">𝒵</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔓</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <ci>odd</ci>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝔓</ci>
       <apply>
        <geq></geq>
        <csymbol cd="latexml">absent</csymbol>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ℭ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>𝒵</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝔓</ci>
       <apply>
        <geq></geq>
        <csymbol cd="latexml">absent</csymbol>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ℭ</ci>
        <cn type="integer">4</cn>
       </apply>
       <ci>𝒵</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝔓</ci>
       <apply>
        <geq></geq>
        <csymbol cd="latexml">absent</csymbol>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ℭ</ci>
        <cn type="integer">6</cn>
       </apply>
       <ci>𝒵</ci>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}(\mathfrak{C}_{\operatorname{odd}}(\mathcal{Z}))\left(\mathfrak{P}%
_{\geq 1}(\mathfrak{C}_{2}(\mathcal{Z}))+\mathfrak{P}_{\geq 1}(\mathfrak{C}_{4%
}(\mathcal{Z}))+\mathfrak{P}_{\geq 1}(\mathfrak{C}_{6}(\mathcal{Z}))+\cdots\right)
  </annotation>
 </semantics>
</math>

</p>
<h3 id="permutations-where-all-even-cycles-have-the-same-length">Permutations where all even cycles have the same length</h3>

<p>This class has the specification</p>

<p>

<math display="block" id="Random_permutation_statistics:231">
 <semantics>
  <mrow>
   <mrow>
    <msqrt>
     <mfrac>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>z</mi>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
    </msqrt>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <mrow>
          <mrow>
           <mrow>
            <mi>exp</mi>
            <mrow>
             <mo>(</mo>
             <mfrac>
              <msup>
               <mi>z</mi>
               <mn>2</mn>
              </msup>
              <mn>2</mn>
             </mfrac>
             <mo>)</mo>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mpadded width="+1.7pt">
            <mn>1</mn>
           </mpadded>
          </mrow>
          <mo rspace="4.2pt">+</mo>
          <mrow>
           <mi>exp</mi>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <msup>
              <mi>z</mi>
              <mn>4</mn>
             </msup>
             <mn>4</mn>
            </mfrac>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>-</mo>
         <mpadded width="+1.7pt">
          <mn>1</mn>
         </mpadded>
        </mrow>
        <mo rspace="4.2pt">+</mo>
        <mrow>
         <mi>exp</mi>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <msup>
            <mi>z</mi>
            <mn>6</mn>
           </msup>
           <mn>6</mn>
          </mfrac>
          <mo>)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mpadded width="+1.7pt">
        <mn>1</mn>
       </mpadded>
      </mrow>
      <mo rspace="4.2pt">+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <exp></exp>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>z</ci>
             <cn type="integer">2</cn>
            </apply>
            <cn type="integer">2</cn>
           </apply>
          </apply>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <exp></exp>
          <apply>
           <divide></divide>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>z</ci>
            <cn type="integer">4</cn>
           </apply>
           <cn type="integer">4</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">6</cn>
         </apply>
         <cn type="integer">6</cn>
        </apply>
       </apply>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{\frac{1+z}{1-z}}\left(\exp\left(\frac{z^{2}}{2}\right)-1\,+\,\exp\left(%
\frac{z^{4}}{4}\right)-1\,+\,\exp\left(\frac{z^{6}}{6}\right)-1\,+\,\cdots%
\right).
  </annotation>
 </semantics>
</math>

</p>

<p>and the generating function</p>

<p>

<math display="block" id="Random_permutation_statistics:232">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>,</mo>
   <mn>1</mn>
   <mo>,</mo>
   <mn>3</mn>
   <mo>,</mo>
   <mn>15</mn>
   <mo>,</mo>
   <mn>75</mn>
   <mo>,</mo>
   <mn>405</mn>
   <mo>,</mo>
   <mn>2835</mn>
   <mo>,</mo>
   <mn>22155</mn>
   <mo>,</mo>
   <mn>199395</mn>
   <mo>,</mo>
   <mn>1828575</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">0</cn>
    <cn type="integer">1</cn>
    <cn type="integer">3</cn>
    <cn type="integer">15</cn>
    <cn type="integer">75</cn>
    <cn type="integer">405</cn>
    <cn type="integer">2835</cn>
    <cn type="integer">22155</cn>
    <cn type="integer">199395</cn>
    <cn type="integer">1828575</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0,1,3,15,75,405,2835,22155,199395,1828575,\ldots
  </annotation>
 </semantics>
</math>

</p>

<p>There is a semantic nuance here. We could consider permutations containing no even cycles as belonging to this class, since <a href="zero_is_even" title="wikilink">zero is even</a>. The first few values are</p>

<p>

<math display="block" id="Random_permutation_statistics:233">
 <semantics>
  <mrow>
   <mi>𝔓</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>ℭ</mi>
      <mo>odd</mo>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mi>𝔓</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>ℭ</mi>
       <mn>2</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>ℭ</mi>
       <mn>4</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔓</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <ci>odd</ci>
     </apply>
     <ci>𝒵</ci>
    </apply>
    <ci>𝔓</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}(\mathfrak{C}_{\operatorname{odd}}(\mathcal{Z}))\mathfrak{P}(%
\mathfrak{C}_{2}(\mathcal{Z})+\mathfrak{C}_{4}(\mathcal{Z}))
  </annotation>
 </semantics>
</math>

</p>
<h3 id="permutations-where-the-maximum-length-of-an-even-cycle-is-four">Permutations where the maximum length of an even cycle is four</h3>

<p>This class has the specification</p>

<p>

<math display="block" id="Random_permutation_statistics:234">
 <semantics>
  <mrow>
   <mrow>
    <msqrt>
     <mfrac>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>z</mi>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
    </msqrt>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mn>2</mn>
        </msup>
        <mn>2</mn>
       </mfrac>
       <mo>+</mo>
       <mfrac>
        <msup>
         <mi>z</mi>
         <mn>4</mn>
        </msup>
        <mn>4</mn>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <root></root>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <cn type="integer">4</cn>
       </apply>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{\frac{1+z}{1-z}}\exp\left(\frac{z^{2}}{2}+\frac{z^{4}}{4}\right).
  </annotation>
 </semantics>
</math>

</p>

<p>and the generating function</p>

<p>

<math display="block" id="Random_permutation_statistics:235">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>,</mo>
   <mn>2</mn>
   <mo>,</mo>
   <mn>6</mn>
   <mo>,</mo>
   <mn>24</mn>
   <mo>,</mo>
   <mn>120</mn>
   <mo>,</mo>
   <mn>600</mn>
   <mo>,</mo>
   <mn>4200</mn>
   <mo>,</mo>
   <mn>28560</mn>
   <mo>,</mo>
   <mn>257040</mn>
   <mo>,</mo>
   <mn>2207520</mn>
   <mo>,</mo>
   <mn>24282720</mn>
   <mo>,</mo>
   <mn>258128640</mn>
   <mo>,</mo>
   <mi mathvariant="normal">…</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <cn type="integer">1</cn>
    <cn type="integer">2</cn>
    <cn type="integer">6</cn>
    <cn type="integer">24</cn>
    <cn type="integer">120</cn>
    <cn type="integer">600</cn>
    <cn type="integer">4200</cn>
    <cn type="integer">28560</cn>
    <cn type="integer">257040</cn>
    <cn type="integer">2207520</cn>
    <cn type="integer">24282720</cn>
    <cn type="integer">258128640</cn>
    <ci>normal-…</ci>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1,2,6,24,120,600,4200,28560,257040,2207520,24282720,258128640,\ldots
  </annotation>
 </semantics>
</math>

</p>

<p>The first few values are</p>

<p>

<math display="inline" id="Random_permutation_statistics:236">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒵</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒵</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Z}
  </annotation>
 </semantics>
</math>

</p>
<h3 id="the-recurrence">The recurrence</h3>

<p>Observe carefully how the specifications of the even cycle component are constructed. It is best to think of them in terms of parse trees. These trees have three levels. The nodes at the lowest level represent sums of products of even-length cycles of the singleton 

<math display="block" id="Random_permutation_statistics:237">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msqrt>
      <mfrac>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </msqrt>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>z</ci>
     <apply>
      <root></root>
      <apply>
       <divide></divide>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z)=h(z)\sqrt{\frac{1+z}{1-z}},
  </annotation>
 </semantics>
</math>

. The nodes at the middle level represent restrictions of the set operator. Finally the node at the top level sums products of contributions from the middle level. Note that restrictions of the set operator, when applied to a generating function that is even, will preserve this feature, i.e. produce another even generating function. But all the inputs to the set operators are even since they arise from even-length cycles. The result is that all generating functions involved have the form</p>

<p>

<math display="inline" id="Random_permutation_statistics:238">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(z)
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="block" id="Random_permutation_statistics:239">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+2.8pt">
     <mfrac>
      <mn>1</mn>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>z</mi>
      </mrow>
     </mfrac>
    </mpadded>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo rspace="5.3pt" stretchy="false">)</mo>
    </mrow>
    <mfrac>
     <mn>1</mn>
     <msqrt>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <msup>
        <mi>z</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </msqrt>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
     <ci>g</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <ci>h</ci>
     <ci>z</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{1+z}\;g(z)=h(z)\;\frac{1}{\sqrt{1-z^{2}}}
  </annotation>
 </semantics>
</math>

 is an even function. This means that</p>

<p>

<math display="block" id="Random_permutation_statistics:240">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mpadded width="+2.8pt">
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mpadded>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mpadded width="+2.8pt">
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
       </mpadded>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mtext>or</mtext>
     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo rspace="5.3pt" stretchy="false">)</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mo rspace="5.3pt" stretchy="false">)</mo>
      </mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
      </apply>
      <ci>g</ci>
      <ci>z</ci>
     </apply>
     <list>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
       <ci>g</ci>
       <apply>
        <minus></minus>
        <ci>z</ci>
       </apply>
      </apply>
      <mtext>or</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <ci>g</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <ci>g</ci>
      <apply>
       <minus></minus>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{1+z}\;g(z)=\frac{1}{1-z}\;g(-z)\quad\mbox{ or }\quad(1-z)\;g(z)=(1+z)%
\;g(-z).
  </annotation>
 </semantics>
</math>

</p>

<p>is even, too, and hence</p>

<p>

<math display="inline" id="Random_permutation_statistics:241">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo rspace="4.2pt" stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>g</ci>
     <ci>z</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{n}=[z^{n}]g(z)\,
  </annotation>
 </semantics>
</math>

</p>

<p>Letting 

<math display="block" id="Random_permutation_statistics:242">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <msub>
       <mi>g</mi>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>m</mi>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
     <mo>-</mo>
     <mfrac>
      <msub>
       <mi>g</mi>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
      </msub>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mfrac>
        <msub>
         <mi>g</mi>
         <mrow>
          <mrow>
           <mn>2</mn>
           <mi>m</mi>
          </mrow>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mn>2</mn>
            <mi>m</mi>
           </mrow>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
      </mrow>
      <mo>+</mo>
      <mfrac>
       <msub>
        <mi>g</mi>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
       </msub>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mn>2</mn>
          <mi>m</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo lspace="0pt" rspace="3.5pt">!</mo>
       </mrow>
      </mfrac>
     </mrow>
     <mtext>or</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mfrac>
      <msub>
       <mi>g</mi>
       <mrow>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </msub>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mn>2</mn>
          <mi>m</mi>
         </mrow>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mfrac>
      <msub>
       <mi>g</mi>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
      </msub>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mn>2</mn>
         <mi>m</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo lspace="0pt" rspace="3.5pt">!</mo>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <minus></minus>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <list>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>g</ci>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>m</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <apply>
          <factorial></factorial>
          <apply>
           <plus></plus>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>m</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>g</ci>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
        </apply>
        <apply>
         <factorial></factorial>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <mtext>or</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <plus></plus>
         <apply>
          <times></times>
          <cn type="integer">2</cn>
          <ci>m</ci>
         </apply>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>g</ci>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
       <apply>
        <factorial></factorial>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <ci>m</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{g_{2m+1}}{(2m+1)!}-\frac{g_{2m}}{(2m)!}=-\frac{g_{2m+1}}{(2m+1)!}+\frac{%
g_{2m}}{(2m)!}\quad\mbox{ or }\quad 2\frac{g_{2m+1}}{(2m+1)!}=2\frac{g_{2m}}{(%
2m)!}
  </annotation>
 </semantics>
</math>

 and extracting coefficients, we find that</p>

<p>

<math display="block" id="Random_permutation_statistics:243">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>g</mi>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mi>m</mi>
      </mrow>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>g</mi>
       <mrow>
        <mn>2</mn>
        <mi>m</mi>
       </mrow>
      </msub>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>g</ci>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{2m+1}=(2m+1)g_{2m}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>which yields the recurrence</p>

<p>

<math display="block" id="Random_permutation_statistics:244">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>π</mi>
       <mo>∈</mo>
       <msub>
        <mi>S</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </munder>
     <mfrac>
      <mrow>
       <mi>σ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>π</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <mi>ν</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>π</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mfrac>
      <mi>n</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>π</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>σ</ci>
       <ci>π</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>ν</ci>
        <ci>π</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <ci>n</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{\pi\in S_{n}}\frac{\sigma(\pi)}{\nu(\pi)+1}=(-1)^{n+1}\frac{n}{n+1},
  </annotation>
 </semantics>
</math>

</p>
<h2 id="a-problem-from-the-2005-putnam-competition">A problem from the 2005 Putnam competition</h2>

<p>A link to the <a href="Putnam_competition" title="wikilink">Putnam competition</a> website appears in the section <a href="Random_permutation_statistics#External_links" title="wikilink">External links</a>. The problem asks for a proof that</p>

<p>

<math display="inline" id="Random_permutation_statistics:245">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo lspace="0pt" rspace="3.5pt">!</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <factorial></factorial>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!
  </annotation>
 </semantics>
</math>

</p>

<p>where the sum is over all 

<math display="inline" id="Random_permutation_statistics:246">
 <semantics>
  <mrow>
   <mo stretchy="false">[</mo>
   <mi>n</mi>
   <mo stretchy="false">]</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-[]</csymbol>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [n]
  </annotation>
 </semantics>
</math>

 permutations of 

<math display="inline" id="Random_permutation_statistics:247">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>σ</ci>
    <ci>π</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(\pi)
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Random_permutation_statistics:248">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 is the sign of 

<math display="inline" id="Random_permutation_statistics:249">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>π</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>σ</ci>
     <ci>π</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(\pi)=1
  </annotation>
 </semantics>
</math>

, i.e. 

<math display="inline" id="Random_permutation_statistics:250">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 if 

<math display="inline" id="Random_permutation_statistics:251">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>π</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>σ</ci>
     <ci>π</ci>
    </apply>
    <apply>
     <minus></minus>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(\pi)=-1
  </annotation>
 </semantics>
</math>

 is even and 

<math display="inline" id="Random_permutation_statistics:252">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 if 

<math display="inline" id="Random_permutation_statistics:253">
 <semantics>
  <mrow>
   <mi>ν</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ν</ci>
    <ci>π</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \nu(\pi)
  </annotation>
 </semantics>
</math>

 is odd, and 

<math display="inline" id="Random_permutation_statistics:254">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 is the number of fixed points of 

<math display="inline" id="Random_permutation_statistics:255">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

.</p>

<p>Now the sign of 

<math display="block" id="Random_permutation_statistics:256">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>σ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>π</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
      <mrow>
       <mi>c</mi>
       <mo>∈</mo>
       <mi>π</mi>
      </mrow>
     </munder>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">|</mo>
        <mi>c</mi>
        <mo stretchy="false">|</mo>
       </mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>σ</ci>
     <ci>π</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <in></in>
       <ci>c</ci>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <abs></abs>
        <ci>c</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(\pi)=\prod_{c\in\pi}(-1)^{|c|-1},
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="inline" id="Random_permutation_statistics:257">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

</p>

<p>where the product is over all cycles <em>c</em> of 

<math display="block" id="Random_permutation_statistics:258">
 <semantics>
  <mrow>
   <mi>𝔓</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mrow>
      <mo>-</mo>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒱</mi>
      <mi class="ltx_font_mathcaligraphic">𝒵</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>ℭ</mi>
       <mn>1</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi class="ltx_font_mathcaligraphic">𝒰</mi>
      <msub>
       <mi>ℭ</mi>
       <mn>2</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi class="ltx_font_mathcaligraphic">𝒰</mi>
       <mn>2</mn>
      </msup>
      <msub>
       <mi>ℭ</mi>
       <mn>3</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi class="ltx_font_mathcaligraphic">𝒰</mi>
       <mn>3</mn>
      </msup>
      <msub>
       <mi>ℭ</mi>
       <mn>4</mn>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi class="ltx_font_mathcaligraphic">𝒵</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mi mathvariant="normal">⋯</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔓</ci>
    <apply>
     <plus></plus>
     <apply>
      <minus></minus>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <times></times>
      <ci>𝒱</ci>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <times></times>
      <ci>𝒰</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝒰</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>𝒰</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ℭ</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>𝒵</ci>
     </apply>
     <ci>normal-⋯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{P}(-\mathcal{Z}+\mathcal{V}\mathcal{Z}+\mathfrak{C}_{1}(\mathcal{Z})%
+\mathcal{U}\mathfrak{C}_{2}(\mathcal{Z})+\mathcal{U}^{2}\mathfrak{C}_{3}(%
\mathcal{Z})+\mathcal{U}^{3}\mathfrak{C}_{4}(\mathcal{Z})+\cdots)
  </annotation>
 </semantics>
</math>

, as explained e.g. on the page on <a href="even_and_odd_permutations" title="wikilink">even and odd permutations</a>.</p>

<p>Hence we consider the combinatorial class</p>

<p>

<math display="inline" id="Random_permutation_statistics:259">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒰</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒰</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{U}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Random_permutation_statistics:260">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒱</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒱</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{V}
  </annotation>
 </semantics>
</math>

 marks one minus the length of a contributing cycle, and 

<math display="block" id="Random_permutation_statistics:261">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mi>v</mi>
       <mi>z</mi>
      </mrow>
      <mo>+</mo>
      <mrow>
       <munder>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>k</mi>
         <mo>≥</mo>
         <mn>1</mn>
        </mrow>
       </munder>
       <mrow>
        <msup>
         <mi>u</mi>
         <mrow>
          <mi>k</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mi>k</mi>
         </msup>
         <mi>k</mi>
        </mfrac>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>g</ci>
     <vector>
      <ci>z</ci>
      <ci>u</ci>
      <ci>v</ci>
     </vector>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>z</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <geq></geq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <apply>
          <minus></minus>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <ci>k</ci>
         </apply>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u,v)=\exp\left(-z+vz+\sum_{k\geq 1}u^{k-1}\frac{z^{k}}{k}\right)
  </annotation>
 </semantics>
</math>

 marks fixed points. Translating to generating functions, we obtain</p>

<p>

<math display="block" id="Random_permutation_statistics:262">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>v</mi>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mfrac>
         <mn>1</mn>
         <mi>u</mi>
        </mfrac>
        <mrow>
         <mi>log</mi>
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mrow>
            <mi>u</mi>
            <mi>z</mi>
           </mrow>
          </mrow>
         </mfrac>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>v</mi>
         <mi>z</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mrow>
          <mi>u</mi>
          <mi>z</mi>
         </mrow>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mi>u</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <apply>
       <minus></minus>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>u</ci>
       </apply>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <ci>u</ci>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <ci>z</ci>
       </apply>
       <apply>
        <times></times>
        <ci>v</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <times></times>
         <ci>u</ci>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>u</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\left(-z+vz+\frac{1}{u}\log\frac{1}{1-uz}\right)=\exp(-z+vz)\left(\frac{1}%
{1-uz}\right)^{1/u}.
  </annotation>
 </semantics>
</math>

 or</p>

<p>

<math display="block" id="Random_permutation_statistics:263">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>v</mi>
        <mi>z</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>z</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>π</mi>
      <mo>∈</mo>
      <msub>
       <mi>S</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </munder>
    <mrow>
     <mi>σ</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>π</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>v</mi>
      <mrow>
       <mi>ν</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>π</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>g</ci>
      <vector>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <ci>v</ci>
      </vector>
     </apply>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <ci>z</ci>
        </apply>
        <apply>
         <times></times>
         <ci>v</ci>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <in></in>
        <ci>π</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>S</ci>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>σ</ci>
       <ci>π</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>v</ci>
        <apply>
         <times></times>
         <ci>ν</ci>
         <ci>π</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]g(z,-1,v)=n![z^{n}]\exp(-z+vz)(1+z)=\sum_{\pi\in S_{n}}\sigma(\pi)v^{%
\nu(\pi)}
  </annotation>
 </semantics>
</math>

</p>

<p>Now we have</p>

<p>

<math display="block" id="Random_permutation_statistics:264">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∫</mo>
       <mn>0</mn>
       <mn>1</mn>
      </msubsup>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>z</mi>
        <mo>,</mo>
        <mrow>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo>,</mo>
        <mi>v</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <mi>v</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>π</mi>
       <mo>∈</mo>
       <msub>
        <mi>S</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </munder>
     <mfrac>
      <mrow>
       <mi>σ</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>π</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <mi>ν</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>π</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <int></int>
        <cn type="integer">0</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <vector>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>v</ci>
       </vector>
       <ci>d</ci>
       <ci>v</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>π</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>σ</ci>
       <ci>π</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>ν</ci>
        <ci>π</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]\int_{0}^{1}g(z,-1,v)dv=\sum_{\pi\in S_{n}}\frac{\sigma(\pi)}{\nu(\pi%
)+1}.
  </annotation>
 </semantics>
</math>

</p>

<p>and hence the desired quantity is given by</p>

<p>

<math display="block" id="Random_permutation_statistics:265">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∫</mo>
     <mn>0</mn>
     <mn>1</mn>
    </msubsup>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>d</mi>
     <mi>v</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mi>z</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>z</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mi>z</mi>
       </mfrac>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>z</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mfrac>
       <mn>1</mn>
       <mi>z</mi>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <cn type="integer">0</cn>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <vector>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <ci>v</ci>
      </vector>
      <ci>d</ci>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <ci>z</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <exp></exp>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \int_{0}^{1}g(z,-1,v)dv=\exp(-z)(1+z)\left(\frac{1}{z}\exp(z)-\frac{1}{z}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Doing the computation, we obtain</p>

<p>

<math display="block" id="Random_permutation_statistics:266">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mi>z</mi>
       </mfrac>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>z</mi>
      </mfrac>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>z</mi>
      </mfrac>
      <mrow>
       <mi>exp</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <exp></exp>
      <apply>
       <minus></minus>
       <ci>z</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <minus></minus>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{1}{z}+1\right)\left(1-\exp(-z)\right)=\frac{1}{z}+1-\exp(-z)-\frac%
{1}{z}\exp(-z).
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="inline" id="Random_permutation_statistics:267">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>/</mo>
   <mi>z</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <ci>z</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1/z
  </annotation>
 </semantics>
</math>

</p>

<p>Extracting coefficients, we find that the coefficient of 

<math display="inline" id="Random_permutation_statistics:268">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 is zero. The constant is one, which does not agree with the formula (should be zero). For 

<math display="block" id="Random_permutation_statistics:269">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mfrac>
        <mn>1</mn>
        <mi>z</mi>
       </mfrac>
       <mrow>
        <mi>exp</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mo>-</mo>
       <mrow>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>n</mi>
        </msup>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mi>n</mi>
          <mo lspace="0pt" rspace="3.5pt">!</mo>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>n</mi>
           <mo>+</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mo lspace="0pt" rspace="3.5pt">!</mo>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <exp></exp>
        <apply>
         <minus></minus>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <exp></exp>
        <apply>
         <minus></minus>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <factorial></factorial>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <factorial></factorial>
         <apply>
          <plus></plus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n![z^{n}]\left(-\exp(-z)-\frac{1}{z}\exp(-z)\right)=n!\left(-(-1)^{n}\frac{1}{%
n!}-(-1)^{n+1}\frac{1}{(n+1)!}\right)
  </annotation>
 </semantics>
</math>

 positive, however, we obtain</p>

<p>

<math display="block" id="Random_permutation_statistics:270">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mi>n</mi>
         <mo>+</mo>
         <mn>1</mn>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mfrac>
      <mi>n</mi>
      <mrow>
       <mi>n</mi>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <plus></plus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <ci>n</ci>
      <apply>
       <plus></plus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (-1)^{n+1}\left(1-\frac{1}{n+1}\right)=(-1)^{n+1}\frac{n}{n+1},
  </annotation>
 </semantics>
</math>

</p>

<p>or</p>

<p>

<math display="inline" id="Random_permutation_statistics:271">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <vector>
     <ci>z</ci>
     <ci>u</ci>
     <ci>v</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(z,u,v)
  </annotation>
 </semantics>
</math>

</p>

<p>which is the desired result.</p>

<p>As an interesting aside, we observe that 

<math display="inline" id="Random_permutation_statistics:272">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times n
  </annotation>
 </semantics>
</math>

 may be used to evaluate the following <a class="uri" href="determinant" title="wikilink">determinant</a> of an 

<math display="block" id="Random_permutation_statistics:273">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>A</mi>
       <mi>n</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>|</mo>
     <mtable displaystyle="true">
      <mtr>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋱</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋮</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>b</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi mathvariant="normal">⋯</mi>
       </mtd>
       <mtd columnalign="center">
        <mi></mi>
       </mtd>
       <mtd columnalign="center">
        <mi>a</mi>
       </mtd>
      </mtr>
     </mtable>
     <mo>|</mo>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <determinant></determinant>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>A</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <determinant></determinant>
      <matrix>
       <matrixrow>
        <ci>a</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋯</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
       </matrixrow>
       <matrixrow>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>a</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋯</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
       </matrixrow>
       <matrixrow>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>a</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋯</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
       </matrixrow>
       <matrixrow>
        <ci>normal-⋮</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋮</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋮</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋱</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋮</ci>
       </matrixrow>
       <matrixrow>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>b</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>normal-⋯</ci>
        <csymbol cd="latexml">absent</csymbol>
        <ci>a</ci>
       </matrixrow>
      </matrix>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(n)=\det(A_{n})=\begin{vmatrix}a&&b&&b&&\cdots&&b\\
b&&a&&b&&\cdots&&b\\
b&&b&&a&&\cdots&&b\\
\vdots&&\vdots&&\vdots&&\ddots&&\vdots\\
b&&b&&b&&\cdots&&a\end{vmatrix}.
  </annotation>
 </semantics>
</math>

 matrix:</p>

<p>

<math display="inline" id="Random_permutation_statistics:274">
 <semantics>
  <mrow>
   <mrow>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
   </mrow>
   <mo>≠</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <list>
     <ci>a</ci>
     <ci>b</ci>
    </list>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a,b\neq 0
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="block" id="Random_permutation_statistics:275">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo movablelimits="false">det</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>π</mi>
       <mo>∈</mo>
       <msub>
        <mi>S</mi>
        <mi>n</mi>
       </msub>
      </mrow>
     </munder>
     <mrow>
      <mi>σ</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>π</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <msub>
        <mi>A</mi>
        <mrow>
         <mi>i</mi>
         <mo>,</mo>
         <mrow>
          <mi>π</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>i</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <determinant></determinant>
     <ci>A</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <in></in>
       <ci>π</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>σ</ci>
      <ci>π</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>A</ci>
        <list>
         <ci>i</ci>
         <apply>
          <times></times>
          <ci>π</ci>
          <ci>i</ci>
         </apply>
        </list>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det(A)=\sum_{\pi\in S_{n}}\sigma(\pi)\prod_{i=1}^{n}A_{i,\pi(i)}.
  </annotation>
 </semantics>
</math>

. Recall the formula for the determinant:</p>

<p>

<math display="inline" id="Random_permutation_statistics:276">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

</p>

<p>Now the value of the product on the right for a permutation 

<math display="inline" id="Random_permutation_statistics:277">
 <semantics>
  <mrow>
   <msup>
    <mi>a</mi>
    <mi>f</mi>
   </msup>
   <mpadded width="+1.7pt">
    <msup>
     <mi>b</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>f</mi>
     </mrow>
    </msup>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>a</ci>
     <ci>f</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>b</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <ci>f</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a^{f}b^{n-f}\,
  </annotation>
 </semantics>
</math>

 is 

<math display="inline" id="Random_permutation_statistics:278">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

, where <em>f</em> is the number of fixed points of 

<math display="block" id="Random_permutation_statistics:279">
 <semantics>
  <mrow>
   <mrow>
    <mi>d</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>b</mi>
     <mi>n</mi>
    </msup>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mi>g</mi>
    <mrow>
     <mo>(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>,</mo>
     <mfrac>
      <mi>a</mi>
      <mi>b</mi>
     </mfrac>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mi>b</mi>
     <mi>n</mi>
    </msup>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <msup>
      <mi>z</mi>
      <mi>n</mi>
     </msup>
     <mo stretchy="false">]</mo>
    </mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mi>a</mi>
         <mo>-</mo>
         <mi>b</mi>
        </mrow>
        <mi>b</mi>
       </mfrac>
       <mi>z</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>z</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>g</ci>
      <vector>
       <ci>z</ci>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <divide></divide>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
      </vector>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <exp></exp>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <minus></minus>
          <ci>a</ci>
          <ci>b</ci>
         </apply>
         <ci>b</ci>
        </apply>
        <ci>z</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(n)=b^{n}n![z^{n}]g\left(z,-1,\frac{a}{b}\right)=b^{n}n![z^{n}]\exp\left(%
\frac{a-b}{b}z\right)(1+z)
  </annotation>
 </semantics>
</math>

. Hence</p>

<p>

<math display="block" id="Random_permutation_statistics:280">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>b</mi>
      <mi>n</mi>
     </msup>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>a</mi>
         <mo>-</mo>
         <mi>b</mi>
        </mrow>
        <mi>b</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>n</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>b</mi>
      <mi>n</mi>
     </msup>
     <mi>n</mi>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>a</mi>
         <mo>-</mo>
         <mi>b</mi>
        </mrow>
        <mi>b</mi>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>a</mi>
       <mo>-</mo>
       <mi>b</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
    <mo>+</mo>
    <mrow>
     <mi>n</mi>
     <mi>b</mi>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>-</mo>
        <mi>b</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>a</ci>
         <ci>b</ci>
        </apply>
        <ci>b</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>b</ci>
       <ci>n</ci>
      </apply>
      <ci>n</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>a</ci>
         <ci>b</ci>
        </apply>
        <ci>b</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>b</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>a</ci>
        <ci>b</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b^{n}\left(\frac{a-b}{b}\right)^{n}+b^{n}n\left(\frac{a-b}{b}\right)^{n-1}=(a-%
b)^{n}+nb(a-b)^{n-1}
  </annotation>
 </semantics>
</math>

</p>

<p>which yields</p>

<p>

<math display="block" id="Random_permutation_statistics:281">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>d</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>n</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>a</mi>
       <mo>+</mo>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>b</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>a</mi>
         <mo>-</mo>
         <mi>b</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mpadded>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <plus></plus>
      <ci>a</ci>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>b</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <ci>a</ci>
       <ci>b</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   d(n)=(a+(n-1)b)(a-b)^{n-1}\,.
  </annotation>
 </semantics>
</math>

</p>

<p>and finally</p>

<p>

<math display="block" id="Random_permutation_statistics:282">
 <semantics>
  <mrow>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>n</mi>
   </msup>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo lspace="0pt" rspace="3.5pt">!</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <factorial></factorial>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (-1)^{n}(n-2)!
  </annotation>
 </semantics>
</math>

</p>
<h2 id="the-difference-between-the-number-of-cycles-in-even-and-odd-permutations">The difference between the number of cycles in even and odd permutations</h2>

<p>Here we seek to show that this difference is given by</p>

<p>

<math display="inline" id="Random_permutation_statistics:283">
 <semantics>
  <mrow>
   <mi>σ</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>π</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>σ</ci>
    <ci>π</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(\pi)
  </annotation>
 </semantics>
</math>

</p>

<p>Recall that the sign 

<math display="inline" id="Random_permutation_statistics:284">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 of a permutation 

<math display="block" id="Random_permutation_statistics:285">
 <semantics>
  <mrow>
   <mrow>
    <mi>σ</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>π</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>c</mi>
      <mo>∈</mo>
      <mi>π</mi>
     </mrow>
    </munder>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">|</mo>
       <mi>c</mi>
       <mo stretchy="false">|</mo>
      </mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>σ</ci>
     <ci>π</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <apply>
       <in></in>
       <ci>c</ci>
       <ci>π</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <abs></abs>
        <ci>c</ci>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma(\pi)=\prod_{c\in\pi}(-1)^{|c|-1}
  </annotation>
 </semantics>
</math>

 is given by</p>

<p>

<math display="inline" id="Random_permutation_statistics:286">
 <semantics>
  <mi>π</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>π</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \pi
  </annotation>
 </semantics>
</math>

 where the product ranges over the cycles <em>c</em> from the disjoint cycle composition of 

<math display="inline" id="Random_permutation_statistics:287">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒬</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒬</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Q}
  </annotation>
 </semantics>
</math>

.</p>

<p>It follows that the combinatorial species 

<math display="block" id="Random_permutation_statistics:288">
 <semantics>
  <mrow>
   <mi class="ltx_font_mathcaligraphic">𝒬</mi>
   <mo>=</mo>
   <mi>𝔓</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi class="ltx_font_mathcaligraphic">𝒱</mi>
    <msub>
     <mi>ℭ</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi class="ltx_font_mathcaligraphic">𝒵</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>+</mo>
    <mi class="ltx_font_mathcaligraphic">𝒰</mi>
    <mi class="ltx_font_mathcaligraphic">𝒱</mi>
    <msub>
     <mi>ℭ</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi class="ltx_font_mathcaligraphic">𝒵</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msup>
    <mi class="ltx_font_mathcaligraphic">𝒰</mi>
    <mn>2</mn>
   </msup>
   <mi class="ltx_font_mathcaligraphic">𝒱</mi>
   <msub>
    <mi>ℭ</mi>
    <mn>3</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi class="ltx_font_mathcaligraphic">𝒵</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msup>
    <mi class="ltx_font_mathcaligraphic">𝒰</mi>
    <mn>3</mn>
   </msup>
   <mi class="ltx_font_mathcaligraphic">𝒱</mi>
   <msub>
    <mi>ℭ</mi>
    <mn>4</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi class="ltx_font_mathcaligraphic">𝒵</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <msup>
    <mi class="ltx_font_mathcaligraphic">𝒰</mi>
    <mn>4</mn>
   </msup>
   <mi class="ltx_font_mathcaligraphic">𝒱</mi>
   <msub>
    <mi>ℭ</mi>
    <mn>5</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi class="ltx_font_mathcaligraphic">𝒵</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>+</mo>
   <mi mathvariant="normal">⋯</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">Q</csymbol>
    <eq></eq>
    <csymbol cd="unknown">P</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">V</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <cn type="integer">1</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Z</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <plus></plus>
     <csymbol cd="unknown">U</csymbol>
     <csymbol cd="unknown">V</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ℭ</ci>
      <cn type="integer">2</cn>
     </apply>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Z</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝒰</ci>
     <cn type="integer">2</cn>
    </apply>
    <csymbol cd="unknown">V</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℭ</ci>
     <cn type="integer">3</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝒰</ci>
     <cn type="integer">3</cn>
    </apply>
    <csymbol cd="unknown">V</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℭ</ci>
     <cn type="integer">4</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>𝒰</ci>
     <cn type="integer">4</cn>
    </apply>
    <csymbol cd="unknown">V</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ℭ</ci>
     <cn type="integer">5</cn>
    </apply>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Z</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <plus></plus>
    <ci>normal-⋯</ci>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{Q}=\mathfrak{P}(\mathcal{V}\mathfrak{C}_{1}(\mathcal{Z})+\mathcal{U}%
\mathcal{V}\mathfrak{C}_{2}(\mathcal{Z}))+\mathcal{U}^{2}\mathcal{V}\mathfrak{%
C}_{3}(\mathcal{Z})+\mathcal{U}^{3}\mathcal{V}\mathfrak{C}_{4}(\mathcal{Z})+%
\mathcal{U}^{4}\mathcal{V}\mathfrak{C}_{5}(\mathcal{Z})+\cdots)
  </annotation>
 </semantics>
</math>

 that reflects the signs and the cycle count of the set of permutations is given by</p>

<p>

<math display="inline" id="Random_permutation_statistics:289">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒰</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒰</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{U}
  </annotation>
 </semantics>
</math>

 where we have used 

<math display="inline" id="Random_permutation_statistics:290">
 <semantics>
  <mi class="ltx_font_mathcaligraphic">𝒱</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>𝒱</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathcal{V}
  </annotation>
 </semantics>
</math>

 to mark signs and 

<math display="block" id="Random_permutation_statistics:291">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mi>v</mi>
        <mfrac>
         <mi>z</mi>
         <mn>1</mn>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>v</mi>
        <mi>u</mi>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mn>2</mn>
         </msup>
         <mn>2</mn>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>v</mi>
        <msup>
         <mi>u</mi>
         <mn>2</mn>
        </msup>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mn>3</mn>
         </msup>
         <mn>3</mn>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>v</mi>
        <msup>
         <mi>u</mi>
         <mn>3</mn>
        </msup>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mn>4</mn>
         </msup>
         <mn>4</mn>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>v</mi>
        <msup>
         <mi>u</mi>
         <mn>4</mn>
        </msup>
        <mfrac>
         <msup>
          <mi>z</mi>
          <mn>5</mn>
         </msup>
         <mn>5</mn>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <vector>
      <ci>z</ci>
      <ci>u</ci>
      <ci>v</ci>
     </vector>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <ci>v</ci>
       <apply>
        <divide></divide>
        <ci>z</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <ci>u</ci>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">4</cn>
        </apply>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>v</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>u</ci>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>z</ci>
         <cn type="integer">5</cn>
        </apply>
        <cn type="integer">5</cn>
       </apply>
      </apply>
      <ci>normal-⋯</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(z,u,v)=\exp\left(v\frac{z}{1}+vu\frac{z^{2}}{2}+vu^{2}\frac{z^{3}}{3}+vu^{3}%
\frac{z^{4}}{4}+vu^{4}\frac{z^{5}}{5}+\cdots\right).
  </annotation>
 </semantics>
</math>

 for the cycle count.</p>

<p>Translating to generating functions we have</p>

<p>

<math display="block" id="Random_permutation_statistics:292">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>u</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mi>v</mi>
       <mi>u</mi>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mrow>
          <mi>z</mi>
          <mi>u</mi>
         </mrow>
         <mn>1</mn>
        </mfrac>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <msup>
           <mi>z</mi>
           <mn>2</mn>
          </msup>
          <msup>
           <mi>u</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mn>2</mn>
        </mfrac>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <msup>
           <mi>z</mi>
           <mn>3</mn>
          </msup>
          <msup>
           <mi>u</mi>
           <mn>3</mn>
          </msup>
         </mrow>
         <mn>3</mn>
        </mfrac>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <msup>
           <mi>z</mi>
           <mn>4</mn>
          </msup>
          <msup>
           <mi>u</mi>
           <mn>4</mn>
          </msup>
         </mrow>
         <mn>4</mn>
        </mfrac>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <msup>
           <mi>z</mi>
           <mn>5</mn>
          </msup>
          <msup>
           <mi>u</mi>
           <mn>5</mn>
          </msup>
         </mrow>
         <mn>5</mn>
        </mfrac>
        <mo>+</mo>
        <mi mathvariant="normal">⋯</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <vector>
      <ci>z</ci>
      <ci>u</ci>
      <ci>v</ci>
     </vector>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>v</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>z</ci>
         <ci>u</ci>
        </apply>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">3</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <cn type="integer">3</cn>
         </apply>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">4</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <cn type="integer">4</cn>
         </apply>
        </apply>
        <cn type="integer">4</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>z</ci>
          <cn type="integer">5</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>u</ci>
          <cn type="integer">5</cn>
         </apply>
        </apply>
        <cn type="integer">5</cn>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(z,u,v)=\exp\left(\frac{v}{u}\left(\frac{zu}{1}+\frac{z^{2}u^{2}}{2}+\frac{z^%
{3}u^{3}}{3}+\frac{z^{4}u^{4}}{4}+\frac{z^{5}u^{5}}{5}+\cdots\right)\right)
  </annotation>
 </semantics>
</math>

 This simplifies to</p>

<p>

<math display="block" id="Random_permutation_statistics:293">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>exp</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <mi>v</mi>
        <mi>u</mi>
       </mfrac>
       <mrow>
        <mi>log</mi>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mrow>
           <mi>u</mi>
           <mi>z</mi>
          </mrow>
         </mrow>
        </mfrac>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mrow>
         <mi>u</mi>
         <mi>z</mi>
        </mrow>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mfrac>
      <mi>v</mi>
      <mi>u</mi>
     </mfrac>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <exp></exp>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>v</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <ci>u</ci>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>u</ci>
        <ci>z</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <ci>v</ci>
      <ci>u</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \exp\left(\frac{v}{u}\log\frac{1}{1-uz}\right)=\left(\frac{1}{1-uz}\right)^{%
\frac{v}{u}}.
  </annotation>
 </semantics>
</math>

 which is</p>

<p>

<math display="inline" id="Random_permutation_statistics:294">
 <semantics>
  <mrow>
   <msub>
    <mi>Q</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Q</ci>
     <cn type="integer">1</cn>
    </apply>
    <interval closure="open">
     <ci>z</ci>
     <ci>v</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{1}(z,v)
  </annotation>
 </semantics>
</math>

</p>

<p>Now the two generating functions 

<math display="inline" id="Random_permutation_statistics:295">
 <semantics>
  <mrow>
   <msub>
    <mi>Q</mi>
    <mn>2</mn>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>z</mi>
    <mo>,</mo>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Q</ci>
     <cn type="integer">2</cn>
    </apply>
    <interval closure="open">
     <ci>z</ci>
     <ci>v</ci>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{2}(z,v)
  </annotation>
 </semantics>
</math>

 and 

<math display="block" id="Random_permutation_statistics:296">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>Q</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mrow>
       <mo>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>-</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mi>v</mi>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>-</mo>
       <mi>v</mi>
      </mrow>
     </msup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">1</cn>
      </apply>
      <interval closure="open">
       <ci>z</ci>
       <ci>v</ci>
      </interval>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>Q</ci>
       <vector>
        <ci>z</ci>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
        </apply>
        <ci>v</ci>
       </vector>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>Q</ci>
       <vector>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>v</ci>
       </vector>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
        <ci>v</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{1}(z,v)=\frac{1}{2}Q(z,+1,v)+\frac{1}{2}Q(z,-1,v)=\frac{1}{2}\left(\frac{1}%
{1-z}\right)^{v}+\frac{1}{2}\left(\frac{1}{1+z}\right)^{-v}
  </annotation>
 </semantics>
</math>

 of even and odd permutations by cycle count are given by</p>

<p>

<math display="block" id="Random_permutation_statistics:297">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>Q</mi>
      <mn>2</mn>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>z</mi>
      <mo>,</mo>
      <mi>v</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>Q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mrow>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
       <mo>,</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mi>Q</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>z</mi>
       <mo>,</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo>,</mo>
       <mi>v</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msup>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mi>v</mi>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msup>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mn>1</mn>
         <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <mi>z</mi>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mo>-</mo>
        <mi>v</mi>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Q</ci>
       <cn type="integer">2</cn>
      </apply>
      <interval closure="open">
       <ci>z</ci>
       <ci>v</ci>
      </interval>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>Q</ci>
       <vector>
        <ci>z</ci>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
        </apply>
        <ci>v</ci>
       </vector>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <ci>Q</ci>
       <vector>
        <ci>z</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
        <ci>v</ci>
       </vector>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
        <ci>v</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q_{2}(z,v)=\frac{1}{2}Q(z,+1,v)-\frac{1}{2}Q(z,-1,v)=\frac{1}{2}\left(\frac{1}%
{1-z}\right)^{v}-\frac{1}{2}\left(\frac{1}{1+z}\right)^{-v}.
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="block" id="Random_permutation_statistics:298">
 <semantics>
  <mrow>
   <mrow>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>z</mi>
     <mo>,</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msub>
    <mrow>
     <mrow>
      <mfrac>
       <mi>d</mi>
       <mrow>
        <mi>d</mi>
        <mi>v</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <msub>
          <mi>Q</mi>
          <mn>1</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>z</mi>
          <mo>,</mo>
          <mi>v</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
         <msub>
          <mi>Q</mi>
          <mn>2</mn>
         </msub>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>z</mi>
          <mo>,</mo>
          <mi>v</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo fence="true">|</mo>
    </mrow>
    <mrow>
     <mi>v</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <interval closure="open">
      <ci>z</ci>
      <ci>v</ci>
     </interval>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>v</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <cn type="integer">1</cn>
        </apply>
        <interval closure="open">
         <ci>z</ci>
         <ci>v</ci>
        </interval>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>Q</ci>
         <cn type="integer">2</cn>
        </apply>
        <interval closure="open">
         <ci>z</ci>
         <ci>v</ci>
        </interval>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>v</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(z,v)=\left.\frac{d}{dv}(Q_{1}(z,v)-Q_{2}(z,v))\right|_{v=1}
  </annotation>
 </semantics>
</math>

</p>

<p>We require the quantity</p>

<p>

<math display="block" id="Random_permutation_statistics:299">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mrow>
       <mfrac>
        <mi>d</mi>
        <mrow>
         <mi>d</mi>
         <mi>v</mi>
        </mrow>
       </mfrac>
       <msup>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mn>1</mn>
           <mo>+</mo>
           <mi>z</mi>
          </mrow>
         </mfrac>
         <mo>)</mo>
        </mrow>
        <mrow>
         <mo>-</mo>
         <mi>v</mi>
        </mrow>
       </msup>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>v</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <msub>
      <mrow>
       <mrow>
        <mrow>
         <mi>log</mi>
         <mfrac>
          <mn>1</mn>
          <mrow>
           <mn>1</mn>
           <mo>+</mo>
           <mi>z</mi>
          </mrow>
         </mfrac>
        </mrow>
        <msup>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mi>z</mi>
           </mrow>
          </mfrac>
          <mo>)</mo>
         </mrow>
         <mrow>
          <mo>-</mo>
          <mi>v</mi>
         </mrow>
        </msup>
       </mrow>
       <mo fence="true">|</mo>
      </mrow>
      <mrow>
       <mi>v</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>log</mi>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>1</mn>
         <mo>+</mo>
         <mi>z</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="latexml">evaluated-at</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>d</ci>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>v</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>v</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <ci>v</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="latexml">evaluated-at</csymbol>
       <apply>
        <times></times>
        <apply>
         <log></log>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <ci>z</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <ci>z</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>v</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <ci>z</ci>
       </apply>
       <apply>
        <log></log>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <apply>
          <plus></plus>
          <cn type="integer">1</cn>
          <ci>z</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left.\frac{d}{dv}\left(\frac{1}{1+z}\right)^{-v}\right|_{v=1}=-\left.\log%
\frac{1}{1+z}\left(\frac{1}{1+z}\right)^{-v}\right|_{v=1}=-(1+z)\log\frac{1}{1%
+z}.
  </annotation>
 </semantics>
</math>

 which is</p>

<p>

<math display="block" id="Random_permutation_statistics:300">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <msup>
       <mi>z</mi>
       <mi>n</mi>
      </msup>
      <mo stretchy="false">]</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mn>1</mn>
       <mo>+</mo>
       <mi>z</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>log</mi>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mi>z</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>n</mi>
        </msup>
        <mi>n</mi>
       </mfrac>
       <mo>+</mo>
       <mfrac>
        <msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>z</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <cn type="integer">1</cn>
       <ci>z</ci>
      </apply>
      <apply>
       <log></log>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <plus></plus>
         <cn type="integer">1</cn>
         <ci>z</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -n![z^{n}](1+z)\log\frac{1}{1+z}=-n!\left(\frac{(-1)^{n}}{n}+\frac{(-1)^{n-1}}%
{n-1}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>Finally extracting coeffcients from this generating function we obtain</p>

<p>

<math display="block" id="Random_permutation_statistics:301">
 <semantics>
  <mrow>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mi>n</mi>
      <mo lspace="0pt" rspace="3.5pt">!</mo>
     </mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <mo>-</mo>
        <mfrac>
         <mn>1</mn>
         <mi>n</mi>
        </mfrac>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <factorial></factorial>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <cn type="integer">1</cn>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -n!(-1)^{n-1}\left(-\frac{1}{n}+\frac{1}{n-1}\right)=n!(-1)^{n}\frac{n-(n-1)}{%
n(n-1)}
  </annotation>
 </semantics>
</math>

 which is</p>

<p>

<math display="block" id="Random_permutation_statistics:302">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo lspace="0pt" rspace="3.5pt">!</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <factorial></factorial>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <factorial></factorial>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n!(-1)^{n}\frac{1}{n(n-1)}=(-1)^{n}(n-2)!
  </annotation>
 </semantics>
</math>

 which is in turn</p>

<p><span class="LaTeX">$$n! (-1)^n \frac{1}{n(n-1)} = (-1)^n (n-2)!$$</span> This concludes the proof.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Golomb–Dickman_constant" title="wikilink">Golomb–Dickman constant</a></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
<li></li>
<li>Marko Riedel et al., <em><a href="http://math.stackexchange.com/questions/495487/difference-of-number-of-cycles-of-even-and-odd-permutations">The difference of number of cycles of even and odd permutations</a></em></li>
<li>Marko Riedel et al., <em><a href="http://math.stackexchange.com/questions/73896/keys-inside-closed-boxes-a-question-on-probability">Keys inside closed boxes, a question on probability</a></em></li>
</ul>
<h3 id="prisoners">100 prisoners</h3>
<ul>
<li>Anna Gál, Peter Bro Miltersen, <em><a href="http://www.daimi.au.dk/~bromille/Papers/succinct.pdf">The cell probe complexity of succinct data structures</a></em></li>
<li>Various authors, <em><a href="http://math.stackexchange.com/questions/259351/permutations-with-a-cycle-fracn2">Permutations with a cycle &gt; n/2</a></em></li>
<li>Various authors, <em><a href="http://math.stackexchange.com/questions/347260/derangements-property">A property of derangements</a></em></li>
<li>Various authors, <em><a href="http://math.stackexchange.com/questions/349118/probability-permutations">Expected number of fixed points</a></em></li>
<li>Peter Winkler, <em><a href="http://www.math.dartmouth.edu/~pw/solutions.pdf">Seven puzzles you think you must not have heard correctly</a></em></li>
<li>Various authors, <em><a href="http://les-mathematiques.net">Les-Mathematiques.net</a></em>. <em><a href="http://les-mathematiques.u-strasbg.fr/phorum5/read.php?12,341672">Cent prisonniers</a></em> </li>
</ul>

<p>"</p>

<p><a class="uri" href="Category:Combinatorics" title="wikilink">Category:Combinatorics</a></p>
</body>
</html>

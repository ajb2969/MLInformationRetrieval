   Boomerang attack      Boomerang attack   In cryptography , the boomerang attack is a method for the cryptanalysis of block ciphers based on differential cryptanalysis . The attack was published in 1999 by David Wagner , who used it to break the COCONUT98 cipher.  The boomerang attack has allowed new avenues of attack for many ciphers previously deemed safe from differential cryptanalysis.  Refinements on the boomerang attack have been published: the amplified boomerang attack , then the rectangle attack .  The attack  The boomerang attack is based on differential cryptanalysis . In differential cryptanalysis, an attacker exploits how differences in the input to a cipher (the plaintext) can affect the resultant difference at the output (the ciphertext). A high-probability "differential" (that is, an input difference that will produce a likely output difference) is needed that covers all, or nearly all, of the cipher. The boomerang attack allows differentials to be used which cover only part of the cipher.  The attack attempts to generate a so-called "quartet" structure at a point halfway through the cipher. For this purpose, say that the encryption action, E , of the cipher can be split into two consecutive stages, E 0 and E 1 , so that E(M) = E 1 ( E 0 (M)), where M is some plaintext message. Suppose we have two differentials for the two stages; say,      Δ  →   Δ  *      normal-→  normal-Δ   superscript  normal-Δ      \Delta\to\Delta^{*}   for E 0 , and      ∇  →   ∇  *      normal-→  normal-∇   superscript  normal-∇      \nabla\to\nabla^{*}   for E 1 −1 (the decryption action of E 1 ).  The basic attack proceeds as follows:   Choose a random plaintext   P   P   P   and calculate     P  ′   =   P  ⊕  Δ        superscript  P  normal-′    direct-sum  P  normal-Δ     P^{\prime}=P\oplus\Delta   .  Request the encryptions of   P   P   P   and    P  ′     superscript  P  normal-′    P^{\prime}   to obtain    C  =   E   (  P  )        C    E  P     C=E(P)   and     C  ′   =   E   (   P  ′   )         superscript  C  normal-′     E   superscript  P  normal-′      C^{\prime}=E(P^{\prime})     Calculate    D  =   C  ⊕  ∇       D   direct-sum  C  normal-∇     D=C\oplus\nabla   and     D  ′   =    C  ′   ⊕  ∇        superscript  D  normal-′    direct-sum   superscript  C  normal-′   normal-∇     D^{\prime}=C^{\prime}\oplus\nabla     Request the decryptions of   D   D   D   and    D  ′     superscript  D  normal-′    D^{\prime}   to obtain    Q  =    E   -  1     (  D  )        Q     superscript  E    1    D     Q=E^{-1}(D)   and     Q  ′   =    E   -  1     (   D  ′   )         superscript  Q  normal-′      superscript  E    1     superscript  D  normal-′      Q^{\prime}=E^{-1}(D^{\prime})     Compare   Q   Q   Q   and    Q  ′     superscript  Q  normal-′    Q^{\prime}   ; when the differentials hold,     Q  ⊕   Q  ′    =  Δ       direct-sum  Q   superscript  Q  normal-′    normal-Δ    Q\oplus Q^{\prime}=\Delta   .   Application to specific ciphers  One attack on KASUMI , a block cipher used in 3GPP , is a related-key rectangle attack which breaks the full eight rounds of the cipher faster than exhaustive search (Biham et al., 2005). The attack requires 2 54.6 chosen plaintexts, each of which has been encrypted under one of four related keys, and has a time complexity equivalent to 2 76.1 KASUMI encryptions.  References    (Slides in PostScript)             External links   Boomerang attack — explained by John Savard  Nathan Keller's homepage   "  Category:Cryptographic attacks   
   Variational message passing      Variational message passing   Variational message passing (VMP) is an approximate inference technique for continuous- or discrete-valued Bayesian networks , with conjugate-exponential parents, developed by John Winn. VMP was developed as a means of generalizing the approximate variational methods used by such techniques as Latent Dirichlet allocation and works by updating an approximate distribution at each node through messages in the node's Markov blanket .  Likelihood Lower Bound  Given some set of hidden variables   H   H   H   and observed variables   V   V   V   , the goal of approximate inference is to lower-bound the probability that a graphical model is in the configuration   V   V   V   . Over some probability distribution   Q   Q   Q   (to be defined later),        ln  P    (  V  )    =    ‚àë  H    Q   (  H  )    ln    P   (  H  ,  V  )     P   (  H  |  V  )        =    ‚àë  H    Q   (  H  )    [    ln    P   (  H  ,  V  )     Q   (  H  )      -   ln    P   (  H  |  V  )     Q   (  H  )       ]               P   V     subscript   H     Q  H        P   H  V     fragments  P   fragments  normal-(  H  normal-|  V  normal-)               subscript   H     Q  H   delimited-[]          P   H  V      Q  H          fragments  P   fragments  normal-(  H  normal-|  V  normal-)      Q  H            \ln P(V)=\sum_{H}Q(H)\ln\frac{P(H,V)}{P(H|V)}=\sum_{H}Q(H)\Bigg[\ln\frac{P(H,V%
 )}{Q(H)}-\ln\frac{P(H|V)}{Q(H)}\Bigg]   .  So, if we define our lower bound to be       L   (  Q  )    =    ‚àë  H    Q   (  H  )    ln    P   (  H  ,  V  )     Q   (  H  )              L  Q     subscript   H     Q  H        P   H  V      Q  H         L(Q)=\sum_{H}Q(H)\ln\frac{P(H,V)}{Q(H)}   ,  then the likelihood is simply this bound plus the relative entropy between   P   P   P   and   Q   Q   Q   . Because the relative entropy is non-negative, the function   L   L   L   defined above is indeed a lower bound of the log likelihood of our observation   V   V   V   . The distribution   Q   Q   Q   will have a simpler character than that of   P   P   P   because marginalizing over   P   P   P   is intractable for all but the simplest of graphical models . In particular, VMP uses a factorized distribution   Q   Q   Q   :        Q   (  H  )    =    ‚àè  i     Q  i    (   H  i   )      ,        Q  H     subscript  product  i      subscript  Q  i    subscript  H  i       Q(H)=\prod_{i}Q_{i}(H_{i}),     where    H  i     subscript  H  i    H_{i}   is a disjoint part of the graphical model.  Determining the Update Rule  The likelihood estimate needs to be as large as possible; because it's a lower bound, getting closer    log  P      P    \log P   improves the approximation of the log likelihood. By substituting in the factorized version of   Q   Q   Q   ,    L   (  Q  )       L  Q    L(Q)   , parameterized over the hidden nodes    H  i     subscript  H  i    H_{i}   as above, is simply the negative relative entropy between    Q  j     subscript  Q  j    Q_{j}   and    Q  j  *     superscript   subscript  Q  j      Q_{j}^{*}   plus other terms independent of    Q  j     subscript  Q  j    Q_{j}   if    Q  j  *     superscript   subscript  Q  j      Q_{j}^{*}   is defined as        Q  j  *    (   H  j   )    =    1  Z    e    ùîº   -  j     {    ln  P    (  H  ,  V  )    }             superscript   subscript  Q  j      subscript  H  j        1  Z    superscript  e     subscript  ùîº    j         P    H  V          Q_{j}^{*}(H_{j})=\frac{1}{Z}e^{\mathbb{E}_{-j}\{\ln P(H,V)\}}   ,  where     ùîº   -  j     {    ln  P    (  H  ,  V  )    }        subscript  ùîº    j         P    H  V       \mathbb{E}_{-j}\{\ln P(H,V)\}   is the expectation over all distributions    Q  i     subscript  Q  i    Q_{i}   except    Q  j     subscript  Q  j    Q_{j}   . Thus, if we set    Q  j     subscript  Q  j    Q_{j}   to be    Q  j  *     superscript   subscript  Q  j      Q_{j}^{*}   , the bound   L   L   L   is maximized.  Messages in Variational Message Passing  Parents send their children the expectation of their sufficient statistic while children send their parents their natural parameter , which also requires messages to be sent from the co-parents of the node.  Relationship to Exponential Families  Because all nodes in VMP come from exponential families and all parents of nodes are conjugate to their children nodes, the expectation of the sufficient statistic can be computed from the normalization factor .  VMP Algorithm  The algorithm begins by computing the expected value of the sufficient statistics for that vector. Then, until the likelihood converges to a stable value (this is usually accomplished by setting a small threshold value and running the algorithm until it increases by less than that threshold value), do the following at each node:   Get all messages from parents  Get all messages from children (this might require the children to get messages from the co-parents)  Compute the expected value of the nodes sufficient statistics   Constraints  Because every child must be conjugate to its parent, this limits the types of distributions that can be used in the model. For example, the parents of a Gaussian distribution must be a Gaussian distribution (corresponding to the Mean ) and a gamma distribution (corresponding to the precision, or one over   œÉ   œÉ   \sigma   in more common parameterizations). Discrete variables can have Dirichlet parents, and Poisson and exponential nodes must have gamma parents. However, if the data can be modeled in this manner, VMP offers a generalized framework for providing inference.  External links   Infer.NET : an inference framework which includes an implementation of VMP with examples.  dimple : an open-source inference system supporting VMP.  An older implementation of VMP with usage examples.   References      "  Category:Bayesian networks   
   Wiener deconvolution      Wiener deconvolution   In mathematics , Wiener deconvolution is an application of the Wiener filter to the noise problems inherent in deconvolution . It works in the frequency domain , attempting to minimize the impact of deconvolved noise at frequencies which have a poor signal-to-noise ratio .  The Wiener deconvolution method has widespread use in image deconvolution applications, as the frequency spectrum of most visual images is fairly well behaved and may be estimated easily.  Wiener deconvolution is named after Norbert Wiener .  Definition  Given a system:        y    (  t  )    =     (   h  *  x   )    (  t  )    +   n   (  t  )           y  t         h  x   t     n  t      \ y(t)=(h*x)(t)+n(t)     where   *     *   denotes convolution and:        x    (  t  )       x  t    \ x(t)   is some input signal (unknown) at time    t    t   \ t   .       h    (  t  )       h  t    \ h(t)   is the known impulse response of a linear time-invariant system       n    (  t  )       n  t    \ n(t)   is some unknown additive noise, independent of     x    (  t  )       x  t    \ x(t)          y    (  t  )       y  t    \ y(t)   is our observed signal   Our goal is to find some     g    (  t  )       g  t    \ g(t)   so that we can estimate     x    (  t  )       x  t    \ x(t)   as follows:         x  ^     (  t  )    =    (   g  *  y   )    (  t  )           normal-^  x   t       g  y   t     \ \hat{x}(t)=(g*y)(t)     where      x  ^     (  t  )        normal-^  x   t    \ \hat{x}(t)   is an estimate of     x    (  t  )       x  t    \ x(t)   that minimizes the mean square error .  The Wiener deconvolution filter provides such a     g    (  t  )       g  t    \ g(t)   . The filter is most easily described in the frequency domain :        G    (  f  )    =     H  *    (  f  )   S   (  f  )        |   H   (  f  )    |   2   S   (  f  )    +   N   (  f  )            G  f        superscript  H    f  S  f        superscript      H  f    2   S  f     N  f       \ G(f)=\frac{H^{*}(f)S(f)}{|H(f)|^{2}S(f)+N(f)}     where:        G    (  f  )       G  f    \ G(f)   and     H    (  f  )       H  f    \ H(f)   are the Fourier transforms of    g    g   \ g   and    h    h   \ h   , respectively at frequency    f    f   \ f   .       S    (  f  )       S  f    \ S(f)   is the mean power spectral density of the input signal     x    (  t  )       x  t    \ x(t)          N    (  f  )       N  f    \ N(f)   is the mean power spectral density of the noise     n    (  t  )       n  t    \ n(t)     the superscript     *        {}^{*}   denotes complex conjugation .   The filtering operation may either be carried out in the time-domain, as above, or in the frequency domain:         X  ^     (  f  )    =   G   (  f  )   Y   (  f  )           normal-^  X   f     G  f  Y  f     \ \hat{X}(f)=G(f)Y(f)     (where      X  ^     (  f  )        normal-^  X   f    \ \hat{X}(f)   and     Y    (  f  )       Y  f    \ Y(f)   are the Fourier transforms of     x  ^    (  t  )        normal-^  x   t    \hat{x}(t)   and    y   (  t  )       y  t    y(t)   , respectively) and then performing an inverse Fourier transform on      X  ^     (  f  )        normal-^  X   f    \ \hat{X}(f)   to obtain      x  ^     (  t  )        normal-^  x   t    \ \hat{x}(t)   .  Note that in the case of images, the arguments    t    t   \ t   and    f    f   \ f   above become two-dimensional; however the result is the same.  Interpretation  The operation of the Wiener filter becomes apparent when the filter equation above is rewritten:      G   (  f  )       G  f    \displaystyle G(f)     Here,     1  /  H    (  f  )         1  H   f    \ 1/H(f)   is the inverse of the original system, and      SNR    (  f  )    =     S   (  f  )    /  N    (  f  )          SNR  f         S  f   N   f     \ \mathrm{SNR}(f)=S(f)/N(f)   is the signal-to-noise ratio . When there is zero noise (i.e. infinite signal-to-noise), the term inside the square brackets equals 1, which means that the Wiener filter is simply the inverse of the system, as we might expect. However, as the noise at certain frequencies increases, the signal-to-noise ratio drops, so the term inside the square brackets also drops. This means that the Wiener filter attenuates frequencies dependent on their signal-to-noise ratio.  The Wiener filter equation above requires us to know the spectral content of a typical image, and also that of the noise. Often, we do not have access to these exact quantities, but we may be in a situation where good estimates can be made. For instance, in the case of photographic images, the signal (the original image) typically has strong low frequencies and weak high frequencies, and in many cases the noise content will be relatively flat with frequency.  Derivation  As mentioned above, we want to produce an estimate of the original signal that minimizes the mean square error, which may be expressed:        ϵ    (  f  )    =   𝔼    |    X   (  f  )    -    X  ^    (  f  )     |   2          ϵ  f     𝔼   superscript        X  f      normal-^  X   f     2      \ \epsilon(f)=\mathbb{E}\left|X(f)-\hat{X}(f)\right|^{2}     where    𝔼    𝔼   \ \mathbb{E}   denotes expectation .  If we substitute in the expression for      X  ^     (  f  )        normal-^  X   f    \ \hat{X}(f)   , the above can be rearranged to      ϵ   (  f  )       ϵ  f    \displaystyle\epsilon(f)     If we expand the quadratic, we get the following:      ϵ   (  f  )       ϵ  f    \displaystyle\epsilon(f)     However, we are assuming that the noise is independent of the signal, therefore:        𝔼    {   X   (  f  )    V  *    (  f  )    }    =   𝔼   {   V   (  f  )    X  *    (  f  )    }    =  0          𝔼     X  f   superscript  V    f       𝔼     V  f   superscript  X    f          0     \ \mathbb{E}\Big\{X(f)V^{*}(f)\Big\}=\mathbb{E}\Big\{V(f)X^{*}(f)\Big\}=0     Also, we are defining the power spectral densities as follows:        S    (  f  )    =   𝔼    |   X   (  f  )    |   2          S  f     𝔼   superscript      X  f    2      \ S(f)=\mathbb{E}|X(f)|^{2}           N    (  f  )    =   𝔼    |   V   (  f  )    |   2          N  f     𝔼   superscript      V  f    2      \ N(f)=\mathbb{E}|V(f)|^{2}     Therefore, we have:       ϵ   (  f  )    =     [   1  -   G   (  f  )   H   (  f  )     ]     [   1  -   G   (  f  )   H   (  f  )     ]   *   S   (  f  )    +   G   (  f  )    G  *    (  f  )   N   (  f  )           ϵ  f        delimited-[]    1    G  f  H  f      superscript   delimited-[]    1    G  f  H  f       S  f     G  f   superscript  G    f  N  f      \epsilon(f)=\Big[1-G(f)H(f)\Big]\Big[1-G(f)H(f)\Big]^{*}S(f)+G(f)G^{*}(f)N(f)     To find the minimum error value, we calculate the Wirtinger derivative with respect to     G    (  f  )       G  f    \ G(f)   and set it equal to zero.         d  ϵ   (  f  )     d  G   (  f  )      =     G  *    (  f  )   N   (  f  )    -   H   (  f  )     [   1  -   G   (  f  )   H   (  f  )     ]   *   S   (  f  )     =  0            d  ϵ  f     d  G  f         superscript  G    f  N  f     H  f   superscript   delimited-[]    1    G  f  H  f       S  f         0     \ \frac{d\epsilon(f)}{dG(f)}=G^{*}(f)N(f)-H(f)\Big[1-G(f)H(f)\Big]^{*}S(f)=0     This final equality can be rearranged to give the Wiener filter.  See also   Deconvolution  Wiener filter  Point spread function  Blind deconvolution  Fourier transform   References   Rafael Gonzalez, Richard Woods, and Steven Eddins. Digital Image Processing Using Matlab . Prentice Hall, 2003.   External links   Comparison of different deconvolution methods.  Deconvolution with a Wiener filter   "  Category:Signal processing  Category:Image noise reduction techniques  Category:Estimation theory   
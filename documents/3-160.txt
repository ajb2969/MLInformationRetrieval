   Radon–Nikodym theorem      Radon–Nikodym theorem   In mathematics , the Radon–Nikodym theorem is a result in measure theory which states that, given a measurable space     (  X  ,  Σ  )     X  normal-Σ    (X,\Sigma)   , if a σ-finite measure    ν   ν   \nu   on    (  X  ,  Σ  )     X  normal-Σ    (X,\Sigma)   is absolutely continuous with respect to a σ-finite measure   μ   μ   μ   on    (  X  ,  Σ  )     X  normal-Σ    (X,\Sigma)   , then there is a measurable function     f  :   X  →   [  0  ,  ∞  )       normal-:  f   normal-→  X   0       f:X\rightarrow[0,\infty)   , such that for any measurable subset    A  ⊂  X      A  X    A\subset X   :       ν   (  A  )    =    ∫  A     f   d  μ          ν  A     subscript   A     f  d  μ      \nu(A)=\int_{A}f\,d\mu     The function   f   f   f   is called the Radon–Nikodym derivative and denoted by     d  ν    d  μ         d  ν     d  μ     \frac{d\nu}{d\mu}   .  The theorem is named after Johann Radon , who proved the theorem for the special case where the underlying space is in 1913, and for Otto Nikodym who proved the general case in 1930. 1 In 1936 Hans Freudenthal further generalized the Radon–Nikodym theorem by proving the Freudenthal spectral theorem , a result in Riesz space theory, which contains the Radon–Nikodym theorem as a special case. 2  If   Y   Y   Y   is a Banach space and the generalization of the Radon–Nikodym theorem also holds for functions with values in   Y   Y   Y   ( mutatis mutandis ), then   Y   Y   Y   is said to have the Radon–Nikodym property . All Hilbert spaces have the Radon–Nikodym property.  Radon–Nikodym derivative  The function   f   f   f   satisfying the above equality is uniquely defined up to a   μ   μ   μ   - null set , that is, if   g   g   g   is another function which satisfies the same property, then    f  =  g      f  g    f=g      μ   μ   μ   - almost everywhere .   f   f   f   is commonly written      d  ν    d  μ          d  ν     d  μ     \scriptstyle\frac{d\nu}{d\mu}   and is called the Radon–Nikodym derivative . The choice of notation and the name of the function reflects the fact that the function is analogous to a derivative in calculus in the sense that it describes the rate of change of density of one measure with respect to another (the way the Jacobian determinant is used in multivariable integration). A similar theorem can be proven for signed and complex measures : namely, that if   μ   μ   μ   is a nonnegative σ-finite measure, and ν is a finite-valued signed or complex measure such that ν ≪ μ , i.e. ν is absolutely continuous with respect to   μ   μ   μ   , then there is a   μ   μ   μ   -integrable real- or complex-valued function   g   g   g   on   X   X   X   such that for every measurable set   A   A   A   ,        ν   (  A  )    =    ∫  A     g   d  μ     .        ν  A     subscript   A     g  d  μ      \nu(A)=\int_{A}g\,d\mu.     Applications  The theorem is very important in extending the ideas of probability theory from probability masses and probability densities defined over real numbers to probability measures defined over arbitrary sets. It tells if and how it is possible to change from one probability measure to another. Specifically, the probability density function of a random variable is the Radon–Nikodym derivative of the induced measure with respect to some base measure (usually the Lebesgue measure for continuous random variables ).  For example, it can be used to prove the existence of conditional expectation for probability measures. The latter itself is a key concept in probability theory , as conditional probability is just a special case of it.  Amongst other fields, financial mathematics uses the theorem extensively. Such changes of probability measure are the cornerstone of the rational pricing of derivatives and are used for converting actual probabilities into those of the risk neutral probabilities .  Properties   Let ν , μ , and λ be σ-finite measures on the same measure space. If ν ≪ λ and μ ≪ λ ( ν and μ are absolutely continuous with respect to λ , then            d   (   ν  +  μ   )     d  λ    =      d  ν    d  λ    +    d  μ    d  λ      λ  -almost everywhere     .          d    ν  μ      d  λ           d  ν     d  λ        d  μ     d  λ       λ  -almost everywhere      \frac{d(\nu+\mu)}{d\lambda}=\frac{d\nu}{d\lambda}+\frac{d\mu}{d\lambda}\quad%
 \lambda\text{-almost everywhere}.         If ν ≪ μ ≪ λ , then            d  ν    d  λ    =      d  ν    d  μ      d  μ    d  λ      λ  -almost everywhere     .          d  ν     d  λ           d  ν     d  μ        d  μ     d  λ       λ  -almost everywhere      \frac{d\nu}{d\lambda}=\frac{d\nu}{d\mu}\frac{d\mu}{d\lambda}\quad\lambda\text{%
 -almost everywhere}.         In particular, if μ ≪ ν and ν ≪ μ , then            d  μ    d  ν    =     (    d  ν    d  μ    )    -  1     ν  -almost everywhere     .          d  μ     d  ν      superscript      d  ν     d  μ      1      ν  -almost everywhere      \frac{d\mu}{d\nu}=\left(\frac{d\nu}{d\mu}\right)^{-1}\quad\nu\text{-almost %
 everywhere}.         If μ ≪ λ and   g   g   g   is a μ -integrable function, then            ∫  X     g   d  μ    =    ∫  X    g     d  μ    d  λ     d  λ     .        subscript   X     g  d  μ      subscript   X     g      d  μ     d  λ    d  λ      \int_{X}g\,d\mu=\int_{X}g\frac{d\mu}{d\lambda}\,d\lambda.         If ν is a finite signed or complex measure, then            d   |  ν  |     d  μ    =   |    d  ν    d  μ    |    .          d    ν      d  μ          d  ν     d  μ       {d|\nu|\over d\mu}=\left|{d\nu\over d\mu}\right|.        Further applications  Information divergences  If μ and ν are measures over   X   X   X   , and μ ≪ ν   The Kullback–Leibler divergence from μ to ν is defined to be          D  KL    (  μ  ∥  ν  )   =   ∫  X   log   (    d  μ    d  ν    )   d  μ  .     fragments   subscript  D  KL    fragments  normal-(  μ  parallel-to  ν  normal-)     subscript   X     fragments  normal-(      d  μ     d  ν    normal-)   d  μ  normal-.    D_{\mathrm{KL}}(\mu\|\nu)=\int_{X}\log\left(\frac{d\mu}{d\nu}\right)\;d\mu.         For α > 0 , α ≠ 1 the Rényi divergence of order α from μ to ν is defined to be          D  α    (  μ  ∥  ν  )   =   1   α  -  1    log   (   ∫  X      (    d  μ    d  ν    )    α  -  1     d  μ  )   .     fragments   subscript  D  α    fragments  normal-(  μ  parallel-to  ν  normal-)      1    α  1      fragments  normal-(   subscript   X    superscript   fragments  normal-(      d  μ     d  ν    normal-)     α  1    d  μ  normal-)   normal-.    D_{\alpha}(\mu\|\nu)=\frac{1}{\alpha-1}\log\left(\int_{X}\left(\frac{d\mu}{d%
 \nu}\right)^{\alpha-1}\;d\mu\right).        The assumption of σ-finiteness  The Radon–Nikodym theorem makes the assumption that the measure μ with respect to which one computes the rate of change of ν is σ-finite. Here is an example when μ is not σ-finite and the Radon–Nikodym theorem fails to hold.  Consider the Borel σ-algebra on the real line . Let the counting measure ,   μ   μ   μ   , of a Borel set   A   A   A   be defined as the number of elements of   A   A   A   if   A   A   A   is finite, and   ∞   normal-∞   ∞   otherwise. One can check that   μ   μ   μ   is indeed a measure. It is not   σ   σ   σ   -finite, as not every Borel set is at most a countable union of finite sets. Let   ν   ν   ν   be the usual Lebesgue measure on this Borel algebra. Then,   ν   ν   ν   is absolutely continuous with respect to   μ   μ   μ   , since for a set   A   A   A   one has     μ   (  A  )    =  0        μ  A   0    μ(A)=0   only if   A   A   A   is the empty set , and then    ν   (  A  )       ν  A    ν(A)   is also zero.  Assume that the Radon–Nikodym theorem holds, that is, for some measurable function   f   f   f   one has       ν   (  A  )    =    ∫  A     f   d  μ          ν  A     subscript   A     f  d  μ      \nu(A)=\int_{A}f\,d\mu     for all Borel sets. Taking   A   A   A   to be a singleton set ,  and using the above equality, one finds      0  =   f   (  a  )        0    f  a     0=f(a)     for all real numbers   a   a   a   . This implies that the function   f   f   f   , and therefore the Lebesgue measure   ν   ν   ν   , is zero, which is a contradiction.  Proof  This section gives a measure-theoretic proof of the theorem. There is also a functional-analytic proof, using Hilbert space methods, that was first given by von Neumann .  For finite measures   μ   μ   μ   and   ν   ν   ν   , the idea is to consider functions   f   f   f   with    f   d  μ  ≤  d  ν      f  normal-  d  μ  normal-≤  d  ν    f dμ≤dν   . The supremum of all such functions, along with the monotone convergence theorem, then furnishes the Radon–Nikodym derivative. The fact that the remaining part of   μ   μ   μ   is singular with respect to   ν   ν   ν   follows from a technical fact about finite measures. Once the result is established for finite measures, extending to   σ   σ   σ   -finite, signed, and complex measures can be done naturally. The details are given below.  For finite measures  First, suppose   μ   μ   μ   and   ν   ν   ν   are both finite-valued nonnegative measures. Let   F   F   F   be the set of those measurable functions     f  :  X  →  0  ,  ∞  )   )     fragments   fragments  f  normal-:  X  →  0  normal-,  ∞  normal-)   normal-)    f:X→0,∞))   such that:      ∀  A  ∈  Σ  :   ∫  A    f   d  μ  ≤  ν   (  A  )      fragments  for-all  A   Σ  normal-:  italic-   subscript   A   f  d  μ   ν   fragments  normal-(  A  normal-)     \forall A\in\Sigma:\qquad\int_{A}f\,d\mu\leq\nu(A)       F  ≠  ∅      F  normal-≠  normal-∅    F≠∅   , since it contains at least the zero function. Now let , and suppose   A   A   A   be an arbitrary measurable set, and define:      A  1     subscript  A  1    \displaystyle A_{1}     Then one has         ∫  A     max   {   f  1   ,   f  2   }    d  μ    =     ∫   A  1       f  1    d  μ    +    ∫   A  2       f  2    d  μ     ≤    ν   (   A  1   )    +   ν   (   A  2   )     =   ν   (  A  )     ,          subscript   A        subscript  f  1    subscript  f  2    d  μ        subscript    subscript  A  1       subscript  f  1   d  μ      subscript    subscript  A  2       subscript  f  2   d  μ              ν   subscript  A  1      ν   subscript  A  2            ν  A      \int_{A}\max\{f_{1},f_{2}\}\,d\mu=\int_{A_{1}}f_{1}\,d\mu+\int_{A_{2}}f_{2}\,d%
 \mu\leq\nu(A_{1})+\nu(A_{2})=\nu(A),     and therefore, .  Now, let be a sequence of functions in   F   F   F   such that         lim   n  →  ∞      ∫  X      f  n    d  μ     =    sup   f  ∈  F      ∫  X     f   d  μ      .        subscript    normal-→  n       subscript   X      subscript  f  n   d  μ       subscript  supremum    f  F      subscript   X     f  d  μ       \lim_{n\to\infty}\int_{X}f_{n}\,d\mu=\sup_{f\in F}\int_{X}f\,d\mu.     By replacing with the maximum of the first   n   n   n   functions, one can assume that the sequence  is increasing. Let   g   g   g   be a function defined as        g   (  x  )    :=    lim   n  →  ∞      f  n    (  x  )      .     assign    g  x     subscript    normal-→  n        subscript  f  n   x      g(x):=\lim_{n\to\infty}f_{n}(x).     By Lebesgue's monotone convergence theorem , one has        ∫  A     g   d  μ    =    lim   n  →  ∞      ∫  A      f  n    d  μ     ≤   ν   (  A  )            subscript   A     g  d  μ      subscript    normal-→  n       subscript   A      subscript  f  n   d  μ            ν  A      \int_{A}g\,d\mu=\lim_{n\to\infty}\int_{A}f_{n}\,d\mu\leq\nu(A)     for each    A  ∈  Σ      A  normal-∈  normal-Σ    A∈Σ   , and hence,    g  ∈  F      g  normal-∈  F    g∈F   . Also, by the construction of   g   g   g   ,         ∫  X     g   d  μ    =    sup   f  ∈  F      ∫  X     f   d  μ      .        subscript   X     g  d  μ      subscript  supremum    f  F      subscript   X     f  d  μ       \int_{X}g\,d\mu=\sup_{f\in F}\int_{X}f\,d\mu.     Now, since    g  ∈  F      g  normal-∈  F    g∈F   ,        ν  0    (  A  )    :=    ν   (  A  )    -    ∫  A     g   d  μ        assign     subscript  ν  0   A       ν  A     subscript   A     g  d  μ       \nu_{0}(A):=\nu(A)-\int_{A}g\,d\mu     defines a nonnegative measure on   Σ   normal-Σ   Σ   . Suppose ; then, since   μ   μ   μ   is finite, there is an    ε  >  0      ε  0    ε>0   such that . Let ( P , N ) be a Hahn decomposition for the signed measure . Note that for every    A  ∈  Σ      A  normal-∈  normal-Σ    A∈Σ   one has , and hence,      ν   (  A  )       ν  A    \displaystyle\nu(A)     Also, note that     μ   (  P  )    >  0        μ  P   0    μ(P)>0   ; for if     μ   (  P  )    =  0        μ  P   0    μ(P)=0   , then (since   ν   ν   ν   is absolutely continuous in relation to   μ   μ   μ   ) 0}} , so 0}} and          ν  0    (  X  )    -   ε  μ   (  X  )     =    (    ν  0   -   ε  μ    )    (  N  )    ≤  0   ,             subscript  ν  0   X     ε  μ  X         subscript  ν  0     ε  μ    N        0     \nu_{0}(X)-\varepsilon\mu(X)=(\nu_{0}-\varepsilon\mu)(N)\leq 0,     contradicting the fact that .  Then, since         ∫  X     (   g  +   ε   1  P     )   d  μ    ≤   ν   (  X  )    <   +  ∞    ,          subscript   X       g    ε   subscript  1  P     d  μ      ν  X               \int_{X}(g+\varepsilon 1_{P})\,d\mu\leq\nu(X)<+\infty,    and satisfies         ∫  X     (   g  +   ε   1  P     )   d  μ    >    ∫  X     g   d  μ    =    sup   f  ∈  F      ∫  X     f   d  μ      .          subscript   X       g    ε   subscript  1  P     d  μ      subscript   X     g  d  μ           subscript  supremum    f  F      subscript   X     f  d  μ        \int_{X}(g+\varepsilon 1_{P})\,d\mu>\int_{X}g\,d\mu=\sup_{f\in F}\int_{X}f\,d\mu.     This is impossible , therefore, the initial assumption that must be false. So 0}} , as desired.  Now, since   g   g   g   is   μ   μ   μ   -integrable, the set is   μ   μ   μ   - null . Therefore, if a   f   f   f   is defined as       f   (  x  )    =   {      g   (  x  )        if  g   (  x  )    <  ∞       0    otherwise,            f  x    cases    g  x       if  g  x     0  otherwise,     f(x)=\begin{cases}g(x)&\text{if }g(x)<\infty\\
 0&\text{otherwise,}\end{cases}     then   f   f   f   has the desired properties.  As for the uniqueness, let     f  ,  g  :  X  →  0  ,  ∞  )   )     fragments   fragments  f  normal-,  g  normal-:  X  →  0  normal-,  ∞  normal-)   normal-)    f,g:X→0,∞))   be measurable functions satisfying       ν   (  A  )    =    ∫  A     f   d  μ    =    ∫  A     g   d  μ            ν  A     subscript   A     f  d  μ           subscript   A     g  d  μ       \nu(A)=\int_{A}f\,d\mu=\int_{A}g\,d\mu     for every measurable set   A   A   A   . Then,    g  −  f      g  normal-−  f    g−f   is   μ   μ   μ   -integrable, and        ∫  A     (   g  -  f   )   d  μ    =  0.        subscript   A       g  f   d  μ    0.    \int_{A}(g-f)\,d\mu=0.     In particular, for  or  It follows that         ∫  X       (   g  -  f   )   +    d  μ    =  0  =    ∫  X       (   g  -  f   )   -    d  μ     ,          subscript   X      superscript    g  f     d  μ    0         subscript   X      superscript    g  f     d  μ       \int_{X}(g-f)^{+}\,d\mu=0=\int_{X}(g-f)^{-}\,d\mu,     and so, that 0}}    μ   μ   μ   -almost everywhere; the same is true for , and thus,    f  =  g      f  g    f=g      μ   μ   μ   -almost everywhere, as desired.  For   σ   σ   σ   -finite positive measures  If   μ   μ   μ   and   ν   ν   ν   are   σ   σ   σ   -finite, then   X   X   X   can be written as the union of a sequence  of disjoint sets in   Σ   normal-Σ   Σ   , each of which has finite measure under both   μ   μ   μ   and   ν   ν   ν   . For each   n   n   n   , there is a   Σ   normal-Σ   Σ   -measurable function such that       ν   (  A  )    =    ∫  A      f  n    d  μ          ν  A     subscript   A      subscript  f  n   d  μ      \nu(A)=\int_{A}f_{n}\,d\mu     for each   Σ   normal-Σ   Σ   -measurable subset   A   A   A   of . The union    f   f   f   of those functions is then the required function.  As for the uniqueness, since each of the is   μ   μ   μ   -almost everywhere unique, then so is   f   f   f   .  For signed and complex measures  If   ν   ν   ν   is a   σ   σ   σ   -finite signed measure, then it can be Hahn–Jordan decomposed as  ν + − ν − }} where one of the measures is finite. Applying the previous result to those two measures, one obtains two functions,     g  ,  h  :  X  →  0  ,  ∞  )   )     fragments   fragments  g  normal-,  h  normal-:  X  →  0  normal-,  ∞  normal-)   normal-)    g,h:X→0,∞))   , satisfying the Radon–Nikodym theorem for and respectively, at least one of which is   μ   μ   μ   -integrable (i.e., its integral with respect to   μ   μ   μ   is finite). It is clear then that    f  =   g  −  h       f    g  normal-−  h     f=g−h   satisfies the required properties, including uniqueness, since both   g   g   g   and   h   h   h   are unique up to   μ   μ   μ   -almost everywhere equality.  If   ν   ν   ν   is a complex measure , it can be decomposed as  ν 1 + iν 2 }} , where both and are finite-valued signed measures. Applying the above argument, one obtains two functions,     g  ,  h  :  X  →  0  ,  ∞  )   )     fragments   fragments  g  normal-,  h  normal-:  X  →  0  normal-,  ∞  normal-)   normal-)    g,h:X→0,∞))   , satisfying the required properties for and , respectively. Clearly,    f  =   g  +   i  h        f    g    i  h      f=g+ih   is the required function.  See also   Girsanov theorem   Notes  References    Contains a proof for vector measures assuming values in a Banach space.   Contains a lucid proof in case the measure ν is not σ-finite.     "  Category:Theorems in measure theory  Category:Articles containing proofs  Category:Generalizations of the derivative  Category:Integral representations     ↩  ↩     
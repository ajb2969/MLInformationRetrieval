   Horvitz–Thompson estimator      Horvitz–Thompson estimator   In statistics , the Horvitz–Thompson estimator , named after Daniel G. Horvitz and Donovan J. Thompson, 1 is a method for estimating the total 2 and mean of a superpopulation in a stratified sample . Inverse probability weighting is applied to account for different proportions of observations within strata in a target population. The Horvitz–Thompson estimator is frequently applied in survey analyses and can be used to account for missing data .  The method  Formally, let       Y  i   ,  i   =  1   ,   2  ,  …  ,  n      formulae-sequence      subscript  Y  i   i   1    2  normal-…  n     Y_{i},i=1,2,\ldots,n   be an independent sample from n of N ≥ n distinct strata with a common mean μ . Suppose further that    π  i     subscript  π  i    \pi_{i}   is the inclusion probability that a randomly sampled individual in a superpopulation belongs to the i th stratum. The Horvitz–Thompson estimate of the total is given by:         Y  ^    H  T    =    ∑   i  =  1   n     π  i   -  1     Y  i      ,       subscript   normal-^  Y     H  T      superscript   subscript     i  1    n      superscript   subscript  π  i     1     subscript  Y  i       \hat{Y}_{HT}=\sum_{i=1}^{n}\pi_{i}^{-1}Y_{i},     and the estimate of the mean is given by:         μ  ^    H  T    =    N   -  1      Y  ^    H  T     =    N   -  1      ∑   i  =  1   n     π  i   -  1     Y  i       .         subscript   normal-^  μ     H  T       superscript  N    1     subscript   normal-^  Y     H  T             superscript  N    1      superscript   subscript     i  1    n      superscript   subscript  π  i     1     subscript  Y  i         \hat{\mu}_{HT}=N^{-1}\hat{Y}_{HT}=N^{-1}\sum_{i=1}^{n}\pi_{i}^{-1}Y_{i}.     In a Bayesian probabilistic framework    π  i     subscript  π  i    \pi_{i}   is considered the proportion of individuals in a target population belonging to the i th stratum. Hence,     π  i   -  1     Y  i        superscript   subscript  π  i     1     subscript  Y  i     \pi_{i}^{-1}Y_{i}   could be thought of as an estimate of the complete sample of persons within the i th stratum. The Horvitz–Thompson estimator can also be expressed as the limit of a weighted bootstrap  resampling estimate of the mean. It can also be viewed as a special case of multiple imputation approaches. 3  For post-stratified study designs, estimation of   π   π   \pi   and   μ   μ   \mu   are done in distinct steps. In such cases, computating the variance of     μ  ^    H  T      subscript   normal-^  μ     H  T     \hat{\mu}_{HT}   is not straightforward. Resampling techniques such as the bootstrap or the jackknife can be applied to gain consistent estimates of the variance of the Horvitz–Thompson estimator. The Survey package for R conducts analyses for post-stratified data using the Horvitz–Thompson estimator.  References  External links   Survey Package Website for R   "  Category:Sampling (statistics)  Category:Survey methodology  Category:Missing data     Horvitz, D. G.; Thompson, D. J. (1952) "A generalization of sampling without replacement from a finite universe", Journal of the American Statistical Association , 47, 663–685, . ↩  William G. Cochran (1977), Sampling Techniques , 3rd Edition, Wiley. ISBN 0-471-16240-X ↩  Roderick J.A. Little, Donald B. Rubin (2002) Statistical Analysis With Missing Data , 2nd ed., Wiley. ISBN 0-471-18386-5 ↩     
<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1060">Metaballs</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Metaballs</h1>
<hr/>

<p> <strong>Metaballs</strong> are, in <a href="computer_graphics" title="wikilink">computer graphics</a>, organic-looking n-dimensional objects. The technique for <a href="rendering_(computer_graphics)" title="wikilink">rendering</a> metaballs was invented by <a href="Jim_Blinn" title="wikilink">Jim Blinn</a> in the early 1980s.</p>

<p>Each metaball is defined as a <a href="function_(mathematics)" title="wikilink">function</a> in <em>n</em>-dimensions (i.e. for three dimensions, 

<math display="inline" id="Metaballs:0">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <vector>
     <ci>x</ci>
     <ci>y</ci>
     <ci>z</ci>
    </vector>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y,z)
  </annotation>
 </semantics>
</math>

; three-dimensional metaballs tend to be most common, with two-dimensional implementations popular as well). A thresholding value is also chosen, to define a solid volume. Then,</p>

<p>

<math display="block" id="Metaballs:1">
 <semantics>
  <mrow>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <msub>
      <mtext>metaball</mtext>
      <mi>i</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>,</mo>
      <mi>y</mi>
      <mo>,</mo>
      <mi>z</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>≤</mo>
   <mtext>threshold</mtext>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <leq></leq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <mtext>metaball</mtext>
       <ci>i</ci>
      </apply>
      <vector>
       <ci>x</ci>
       <ci>y</ci>
       <ci>z</ci>
      </vector>
     </apply>
    </apply>
    <mtext>threshold</mtext>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sum_{i=0}^{n}\mbox{metaball}_{i}(x,y,z)\leq\mbox{threshold}
  </annotation>
 </semantics>
</math>

 represents whether the volume enclosed by the surface defined by 

<math display="inline" id="Metaballs:2">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 metaballs is filled at 

<math display="inline" id="Metaballs:3">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mi>x</mi>
   <mo>,</mo>
   <mi>y</mi>
   <mo>,</mo>
   <mi>z</mi>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <ci>x</ci>
    <ci>y</ci>
    <ci>z</ci>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y,z)
  </annotation>
 </semantics>
</math>

 or not.</p>

<p>A typical function chosen for metaballs is 

<math display="inline" id="Metaballs:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo>,</mo>
     <mi>z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>x</mi>
         <mo>-</mo>
         <msub>
          <mi>x</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>y</mi>
         <mo>-</mo>
         <msub>
          <mi>y</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo>+</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>z</mi>
         <mo>-</mo>
         <msub>
          <mi>z</mi>
          <mn>0</mn>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <vector>
      <ci>x</ci>
      <ci>y</ci>
      <ci>z</ci>
     </vector>
    </apply>
    <apply>
     <divide></divide>
     <cn type="integer">1</cn>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>x</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>y</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <minus></minus>
        <ci>z</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>z</ci>
         <cn type="integer">0</cn>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(x,y,z)=1/((x-x_{0})^{2}+(y-y_{0})^{2}+(z-z_{0})^{2})
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Metaballs:5">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <msub>
    <mi>x</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>y</mi>
    <mn>0</mn>
   </msub>
   <mo>,</mo>
   <msub>
    <mi>z</mi>
    <mn>0</mn>
   </msub>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>z</ci>
     <cn type="integer">0</cn>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{0},y_{0},z_{0})
  </annotation>
 </semantics>
</math>

 is the center of the metaball. However, due to the divide, it is <a href="computationally_expensive" title="wikilink">computationally expensive</a>. For this reason, approximate <a href="polynomial_function" title="wikilink">polynomial functions</a> are typically used.</p>

<p>When seeking a more efficient falloff function, several qualities are desired:</p>
<ul>
<li><a href="Finite_support" title="wikilink">Finite support</a>. A function with finite support goes to zero at a maximum radius. When evaluating the metaball field, any points beyond their maximum radius from the sample point can be ignored. A hierarchical <a class="uri" href="culling" title="wikilink">culling</a> system can thus ensure only the closest metaballs will need to be evaluated regardless of the total number in the field.</li>
<li><a class="uri" href="Smoothness" title="wikilink">Smoothness</a>. Because the <a class="uri" href="isosurface" title="wikilink">isosurface</a> is the result of adding the fields together, its smoothness is dependent on the smoothness of the falloff curves.</li>
</ul>

<p>The simplest falloff curve that satisfies these criteria is

<math display="block" id="Metaballs:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>r</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>-</mo>
      <msup>
       <mi>r</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>r</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(r)=(1-r^{2})^{2}
  </annotation>
 </semantics>
</math>

, where r is the distance to the point. This formulation avoids expensive <a href="square_root" title="wikilink">square root</a> calls.</p>

<p>More complicated models use a <a class="uri" href="Gaussian" title="wikilink">Gaussian</a> potential constrained to a finite radius or a mixture of polynomials to achieve smoothness. The Soft Object model by the Wyvill brothers provides higher degree of smoothness and still avoids square roots.</p>

<p>A simple generalization of metaballs is to apply the falloff curve to distance-from-lines or distance-from-surfaces.</p>

<p>There are a number of ways to render the metaballs to the screen. In the case of three dimensional metaballs, the two most common are <a href="raycasting" title="wikilink">brute force raycasting</a> and the <a href="marching_cubes" title="wikilink">marching cubes</a> algorithm.</p>

<p>2D metaballs were a very common <a href="demo_effect" title="wikilink">demo effect</a> in the 1990s. The effect is also available as an <a class="uri" href="XScreensaver" title="wikilink">XScreensaver</a> module.</p>

<p> {{-}}</p>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://local.wasp.uwa.edu.au/~pbourke/miscellaneous/implicitsurf/">Implicit Surfaces article</a> by Paul Bourke</li>
<li><a href="https://www.blender.org/manual/modeling/metas/introduction.html">Meta Objects article</a> from <a href="Blender_(software)" title="wikilink">Blender</a> wiki</li>
<li><a href="http://www.siggraph.org/education/materials/HyperGraph/modeling/metaballs/metaballs.htm">Metaballs article</a> from <a class="uri" href="SIGGRAPH" title="wikilink">SIGGRAPH</a> website</li>
<li><a href="http://www.gamedev.net/page/resources/_//feature/fprogramming/exploring-metaballs-and-isosurfaces-in-2d-r2556">Exploring Metaballs and Isosurfaces in 2D</a> by Stephen Whitmore (gamedev article)</li>
<li><a href="http://www.digitalartform.com/archives/2009/06/simulating_2d_m.html">Simulating 2D Metaball Blobbies with Photoshop</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="http://steve.hollasch.net/cgindex/misc/metaballs.html">Intro to Metaballs</a></li>
</ul>

<p>"</p>

<p><a href="Category:3D_computer_graphics" title="wikilink">Category:3D computer graphics</a> <a href="Category:Demo_effects" title="wikilink">Category:Demo effects</a></p>
</body>
</html>

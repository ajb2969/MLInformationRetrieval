   Geometric integrator      Geometric integrator   In the mathematical field of numerical ordinary differential equations , a geometric integrator is a numerical method that preserves geometric properties of the exact flow of a differential equation.  Pendulum example  We can motivate the study of geometric integrators by considering the motion of a pendulum .  Assume that we have a pendulum whose bob has mass    m  =  1      m  1    m=1   and whose rod is massless of length    ‚Ñì  =  1      normal-‚Ñì  1    \ell=1   . Take the acceleration due to gravity to be    g  =  1      g  1    g=1   . Denote by    q   (  t  )       q  t    q(t)   the angular displacement of the rod from the vertical, and by    p   (  t  )       p  t    p(t)   the pendulum's momentum. The Hamiltonian of the system, the sum of its kinetic and potential energies, is        H   (  q  ,  p  )    =    T   (  p  )    +   U   (  q  )     =     1  2    p  2    -   cos  q     ,          H   q  p        T  p     U  q               1  2    superscript  p  2      q       H(q,p)=T(p)+U(q)=\frac{1}{2}p^{2}-\cos q,     which gives Hamilton's equations        (   q  Àô   ,   p  Àô   )   =   (  p  ,   -   sin  q    )    .        normal-Àô  q    normal-Àô  p     p      q       (\dot{q},\dot{p})=(p,-\sin q).\,     It is natural to take the configuration space    Q   Q   Q   of all   q   q   q   to be the unit circle    ùïä  1     superscript  ùïä  1    \mathbb{S}^{1}   , so that    (  q  ,  p  )     q  p    (q,p)   lies on the cylinder     ùïä  1   √ó  ‚Ñù       superscript  ùïä  1   ‚Ñù    \mathbb{S}^{1}\times\mathbb{R}   . However, we will take     (  q  ,  p  )   ‚àà   ‚Ñù  2        q  p    superscript  ‚Ñù  2     (q,p)\in\mathbb{R}^{2}   , simply because    (  q  ,  p  )     q  p    (q,p)   -space is then easier to plot. Define     z   (  t  )    =    (   q   (  t  )    ,   p   (  t  )    )   T         z  t    superscript     q  t     p  t    normal-T     z(t)=(q(t),p(t))^{\mathrm{T}}   and     f   (  z  )    =    (  p  ,   -   sin  q    )   T         f  z    superscript   p      q     normal-T     f(z)=(p,-\sin q)^{\mathrm{T}}   . Let us experiment by using some simple numerical methods to integrate this system. As usual, we select a constant step size,   h   h   h   , and for an aribtrary non-negative integer   k   k   k   we write     z  k   :=   z   (   k  h   )       assign   subscript  z  k     z    k  h      z_{k}:=z(kh)   . We use the following methods.       z   k  +  1    =    z  k   +   h  f   (   z  k   )          subscript  z    k  1       subscript  z  k     h  f   subscript  z  k       z_{k+1}=z_{k}+hf(z_{k})\,   ( explicit Euler ),       z   k  +  1    =    z  k   +   h  f   (   z   k  +  1    )          subscript  z    k  1       subscript  z  k     h  f   subscript  z    k  1        z_{k+1}=z_{k}+hf(z_{k+1})\,   ( implicit Euler ),       z   k  +  1    =    z  k   +   h  f   (   q  k   ,   p   k  +  1    )          subscript  z    k  1       subscript  z  k     h  f    subscript  q  k    subscript  p    k  1         z_{k+1}=z_{k}+hf(q_{k},p_{k+1})\,   ( symplectic Euler ),       z   k  +  1    =    z  k   +   h  f   (    (    z   k  +  1    +   z  k    )   /  2   )          subscript  z    k  1       subscript  z  k     h  f       subscript  z    k  1     subscript  z  k    2       z_{k+1}=z_{k}+hf((z_{k+1}+z_{k})/2)\,   ( implicit midpoint rule ).  (Note that the symplectic Euler method treats q by the explicit and   p   p   p   by the implicit Euler method.)  The observation that   H   H   H   is constant along the solution curves of the Hamilton's equations allows us to describe the exact trajectories of the system: they are the level curves of      p  2   /  2   -   cos  q          superscript  p  2   2     q     p^{2}/2-\cos q   . We plot, in    ‚Ñù  2     superscript  ‚Ñù  2    \mathbb{R}^{2}   , the exact trajectories and the numerical solutions of the system. For the explicit and implicit Euler methods we take    h  =  0.2      h  0.2    h=0.2   , and z 0 =¬†(0.5,¬†0) and (1.5,¬†0) respectively; for the other two methods we take    h  =  0.3      h  0.3    h=0.3   , and z 0 =¬†(0,¬†0.7), (0,¬†1.4) and (0,¬†2.1).  The explicit (resp. implicit) Euler method spirals out from (resp. in to) the origin. The other two methods show the correct qualitative behaviour, with the implicit midpoint rule agreeing with the exact solution to a greater degree than the symplectic Euler method.  Recall that the exact flow    œï  t     subscript  œï  t    \phi_{t}   of a Hamiltonian system with one degree of freedom is area-preserving, in the sense that       det    ‚àÇ   œï  t     ‚àÇ   (   q  0   ,   p  0   )      =  1             subscript  œï  t       subscript  q  0    subscript  p  0      1    \det\frac{\partial\phi_{t}}{\partial(q_{0},p_{0})}=1   for all   t   t   t   . This formula is easily verified by hand. For our pendulum example we see that the numerical flow     Œ¶   eE  ,  h    :    z  k   ‚Ü¶   z   k  +  1        normal-:   subscript  normal-Œ¶   eE  h     maps-to   subscript  z  k    subscript  z    k  1       \Phi_{{\mathrm{eE}},h}:z_{k}\mapsto z_{k+1}   of the explicit Euler method is not area-preserving; viz.,        det    ‚àÇ   ‚àÇ   (   q  0   ,   p  0   )      Œ¶   eE  ,  h     (   z  0   )     =   |     1     h  ;        -   h   cos   q  0        1     |   =   1  +    h  2    cos   q  0       .                  subscript  q  0    subscript  p  0      subscript  normal-Œ¶   eE  h     subscript  z  0         1  h        h     subscript  q  0      1            1     superscript  h  2      subscript  q  0         \det\frac{\partial}{\partial(q_{0},p_{0})}\Phi_{{\mathrm{eE}},h}(z_{0})=\begin%
 {vmatrix}1&h\\
 -h\cos q_{0}&1\end{vmatrix}=1+h^{2}\cos q_{0}.     A similar calculation can be carried out for the implicit Euler method, where the determinant is        det    ‚àÇ   ‚àÇ   (   q  0   ,   p  0   )      Œ¶   iE  ,  h     (   z  0   )     =    (   1  +    h  2    cos   q  1      )    -  1     .                subscript  q  0    subscript  p  0      subscript  normal-Œ¶   iE  h     subscript  z  0      superscript    1     superscript  h  2      subscript  q  1        1      \det\frac{\partial}{\partial(q_{0},p_{0})}\Phi_{{\mathrm{iE}},h}(z_{0})=(1+h^{%
 2}\cos q_{1})^{-1}.     However, the symplectic Euler method is area-preserving:         (     1     -  h       0    1     )    ‚àÇ   ‚àÇ   (   q  0   ,   p  0   )      Œ¶   sE  ,  h     (   z  0   )    =   (     1    0       -   h   cos   q  0        1     )    ,          1    h     0  1          subscript  q  0    subscript  p  0      subscript  normal-Œ¶   sE  h     subscript  z  0      1  0        h     subscript  q  0      1      \begin{pmatrix}1&-h\\
 0&1\end{pmatrix}\frac{\partial}{\partial(q_{0},p_{0})}\Phi_{{\mathrm{sE}},h}(z%
 _{0})=\begin{pmatrix}1&0\\
 -h\cos q_{0}&1\end{pmatrix},     thus     det   (    ‚àÇ   Œ¶   sE  ,  h     /   ‚àÇ   (   q  0   ,   p  0   )     )    =  1             subscript  normal-Œ¶   sE  h        subscript  q  0    subscript  p  0      1    \det(\partial\Phi_{{\mathrm{sE}},h}/\partial(q_{0},p_{0}))=1   . The implicit midpoint rule has similar geometric properties.  To summarize: the pendulum example shows that, besides the explicit and implicit Euler methods not being good choices of method to solve the problem, the symplectic Euler method and implicit midpoint rule agree well with the exact flow of the system, with the midpoint rule agreeing more closely. Furthermore, these latter two methods are area-preserving, just as the exact flow is; they are two examples of geometric (in fact, symplectic ) integrators.  Moving frame method  The moving frame method can be used to construct numerical methods which preserve Lie  symmetries of the ODE. Existing methods such as Runge-Kutta can be modified using moving frame method to produce invariant versions. 1  See also   Energy drift   References     Ernst Hairer, Christian Lubich and Gerhard Wanner, Geometric Numerical Integration: Structure-Preserving Algorithms for Ordinary Differential Equations. Springer, Berlin, 2002. ISBN 3-540-43003-2.  Ben Leimkuhler and Sebastian Reich, Simulating Hamiltonian Dynamics. Cambridge University Press, 2005. ISBN 0-521-77290-7.   "  Category:Numerical differential equations     Invariantization of Numerical Schemes Using Moving Frames , Pilwon Kim, 2006, BIT Numerical Mathematics, 2007 ‚Äì Springer ‚Ü©     
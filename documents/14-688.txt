   Coppersmith's Attack      Coppersmith's Attack   Coppersmith's attack describes a class of attacks on the public-key cryptosystem  RSA based on Coppersmith's theorem (see below). The public key in the RSA system is a tuple of integers     (  N  ,  e  )     N  e    (N,e)   , where N is the product of two primes p and q . The secret key is given by an integer d satisfying     e  d   ≡   1  mod    (   p  -  1   )    (   q  -  1   )           e  d    modulo  1      p  1     q  1       ed\equiv 1\bmod\ (p-1)(q-1)   ; equivalently, the secret key may be given by     d  p   ≡   d  mod   (   p  -  1   )         subscript  d  p    modulo  d    p  1      d_{p}\equiv d\bmod(p-1)   and     d  q   ≡   d  mod   (   q  -  1   )         subscript  d  q    modulo  d    q  1      d_{q}\equiv d\bmod(q-1)   if the Chinese remainder theorem is used to improve the speed of decryption, see CRT-RSA . Encryption of a message  M produces the ciphertext     C  ≡    M  e   mod  N       C   modulo   superscript  M  e   N     C\equiv M^{e}\bmod N   which can be decrypted using   d   d   d   by computing     C  d   ≡   M  mod  N        superscript  C  d    modulo  M  N     C^{d}\equiv M\bmod N   .  Coppersmith's theorem has many applications in attacking RSA specifically if the public exponent e is small or if partial knowledge of the secret key is available.  Low Public Exponent Attack  In order to reduce encryption or signature - verification time, it is useful to use a small public exponent (   e   e   e   ). In practice, common choices for   e   e   e   are 3, 17 and 65537    (    2  16   +  1   )       superscript  2  16   1    (2^{16}+1)   . 1 These values for e are Fermat primes , sometimes referred to as     F  0   ,   F  2       subscript  F  0    subscript  F  2     F_{0},F_{2}   and    F  4     subscript  F  4    F_{4}   respectively    (    F  x   =    2   2  x    +  1    )       subscript  F  x      superscript  2   superscript  2  x    1     (F_{x}=2^{2^{x}}+1)   . They are chosen because they make the modular exponentiation operation faster. Also, having chosen such   e   e   e   , it is simpler to test whether     gcd   (  e  ,   p  -  1   )    =  1        e    p  1    1    \gcd(e,p-1)=1   and     gcd   (  e  ,   q  -  1   )    =  1        e    q  1    1    \gcd(e,q-1)=1   while generating and testing the primes in step 1 of the key generation . Values of   p   p   p   or   q   q   q   that fail this test can be rejected there and then. (Even better: if e is prime and greater than 2 then the test      p   mod  e   ≠  1       modulo  p  e   1    p\,\bmod\,e\neq 1   can replace the more expensive test     gcd   (   p  -  1   ,  e  )    =  1          p  1   e   1    \gcd(p-1,e)=1   .) If the public exponent is small and the plaintext    m   m   m   is very short, then the RSA function may be easy to invert which makes certain attacks possible. Padding schemes ensure that messages have full lengths but additionally choosing public exponent    e  =    2  16   +  1       e     superscript  2  16   1     e=2^{16}+1   is recommended. When this value is used, signature-verification requires 17 multiplications, as opposed to about 25 when a random   e   e   e   of similar size is used. Unlike low private exponent (see Wiener's Attack ), attacks that apply when a small   e   e   e   is used are far from a total break which would recover the secret key d . The most powerful attacks on low public exponent RSA are based on the following theorem which is due to Don Coppersmith .  Theorem 1 (Coppersmith) 2   Let N be an integer and    f  ∈   ℤ   [  x  ]        f    ℤ   delimited-[]  x      f\in{\mathbb{Z}}[x]   be a monic polynomial of degree   d   d   d   over the integers. Set    X  =   N    1  d   -  ϵ        X   superscript  N      1  d   ϵ      X=N^{\frac{1}{d}-\epsilon}   for     1  d   >  ϵ  >  0          1  d   ϵ       0     \frac{1}{d}>\epsilon>0   . Then, given    ⟨  N  ,  f  ⟩     N  f    \left\langle N,f\right\rangle   attacker, Eve, can efficiently find all integers     x  0   <  X       subscript  x  0   X    x_{0}   satisfying     f   (   x  0   )    =    0   mod  N         f   subscript  x  0     modulo  0  N     f(x_{0})=0\,\bmod\,N   . The running time is dominated by the time it takes to run the LLL algorithm on a lattice of dimension  O     (  w  )    w   (w)   with    w  =   min   (   1  ϵ   ,    log  2   N   )        w    min     1  ϵ     subscript   2   N       w={\rm min}(\frac{1}{\epsilon},\log_{2}N)   .   This theorem states the existence of an algorithm which can efficiently find all roots of   f   f   f   modulo   N   N   N   that are smaller than    X  =   N   1  d        X   superscript  N    1  d      X=N^{\frac{1}{d}}   . As   X   X   X   gets smaller, the algorithm's runtime will decrease. This theorem's strength is the ability to find all small roots of polynomials modulo a composite   N   N   N   .   Håstad's Broadcast Attack  The simplest form of Håstad's attack is presented to ease understanding. The general case uses Coppersmith's theorem.  How does it work? 3  Suppose one sender sends the same message   M   M   M   in encrypted form to a number of people     P  1   ;   P  2   ;  …  ;   P  k       subscript  P  1    subscript  P  2   normal-…   subscript  P  k     P_{1};P_{2};\dots;P_{k}   , each using the same small public exponent   e   e   e   , say    e  =  3      e  3    e=3   , and different moduli    ⟨   N  i   ,   e  i   ⟩      subscript  N  i    subscript  e  i     \left\langle N_{i},e_{i}\right\rangle   . A simple argument shows that as soon as    k  ≥  3      k  3    k\geq 3   ciphertexts are known, the message   M   M   M   is no longer secure: Suppose Eve intercepts     C  1   ,   C  2       subscript  C  1    subscript  C  2     C_{1},C_{2}   , and    C  3     subscript  C  3    C_{3}   , where     C  i   ≡     M  3    mod   N  i         subscript  C  i    modulo   superscript  M  3    subscript  N  i      C_{i}\equiv M^{3}\,\bmod\,N_{i}   . We may assume     gcd   (   N  i   ,   N  j   )    =  1         subscript  N  i    subscript  N  j    1    \gcd(N_{i},N_{j})=1   for all    i  ,  j     i  j    i,j   (otherwise, it is possible to compute a factor of one of the    N  i     subscript  N  i    N_{i}   ’s by computing    gcd   (   N  i   ,   N  j   )        subscript  N  i    subscript  N  j     \gcd(N_{i},N_{j})   .) By the Chinese Remainder Theorem , she may compute    C  ∈   ℤ    N  1    N  2    N  3    *       C   subscript   superscript  ℤ       subscript  N  1    subscript  N  2    subscript  N  3       C\in\mathbb{Z}^{*}_{N_{1}N_{2}N_{3}}   such that     C  i   ≡    C   mod   N  i         subscript  C  i    modulo  C   subscript  N  i      C_{i}\equiv C\,\bmod\,N_{i}   . Then    C  ≡     M  3    mod    N  1    N  2    N  3         C   modulo   superscript  M  3      subscript  N  1    subscript  N  2    subscript  N  3       C\equiv M^{3}\,\bmod\,N_{1}N_{2}N_{3}   ; however, since    M  <   N  i       M   subscript  N  i     M   for all   i   i   i   ', we have     M  3   <    N  1    N  2    N  3         superscript  M  3      subscript  N  1    subscript  N  2    subscript  N  3      M^{3}   . Thus    C  =   M  3       C   superscript  M  3     C=M^{3}   holds over the integers, and Eve can compute the cube root of   C   C   C   to obtain   M   M   M   .  For larger values of   e   e   e   more ciphertexts are needed, particularly,   e   e   e   ciphertexts are sufficient.  Generalizations  Håstad also showed that applying a linear - padding to   M   M   M   prior to encryption does not protect against this attack. Assume the attacker learns that     C  i   =    f  i     (  M  )   e         subscript  C  i      subscript  f  i    superscript  M  e      C_{i}=f_{i}(M)^{e}   for    1  ≤  i  ≤  k        1  i       k     1\leq i\leq k   and some linear function    f  i     subscript  f  i    f_{i}   , i.e., Bob applies a pad to the message    M   M   M   prior to encrypting it so that the recipients receive slightly different messages. For instance, if   M   M   M   is   m   m   m   bits long, Bob might encrypt      M  i   =    i   2  m    +  M        subscript  M  i       i   superscript  2  m    M     M_{i}=i2^{m}+M   and send this to the i -th recipient.  If a large enough group of people is involved, the attacker can recover the plaintext     M  i     subscript  M  i    M_{i}   from all the ciphertext with similar methods. In more generality, Håstad proved that a system of univariate  equations  modulo  relatively prime composites, such as applying any fixed polynomial       g  1    (  M  )    =  0         subscript  g  1   M   0    g_{1}(M)=0   mod    N  i     subscript  N  i    N_{i}   , could be solved if sufficiently many equations are provided. This attack suggests that randomized padding should be used in RSA encryption .  Theorem 2 (Håstad)   Suppose     N  1   ,  …  ,   N  k       subscript  N  1   normal-…   subscript  N  k     N_{1},\dots,N_{k}   are relatively prime  integers and set     N  min   =    min  i    {   N  i   }         subscript  N  min      subscript  min  i     subscript  N  i       N_{\rm min}={\rm min}_{i}\{N_{i}\}   . Let      g  i    (  x  )    ∈    ℤ  /   N  i     [  x  ]           subscript  g  i   x       ℤ   subscript  N  i     delimited-[]  x      g_{i}(x)\in\mathbb{Z}/N_{i}\left[x\right]   be k  polynomials of maximum degree    q   q   q   . Suppose there exists a unique    M  <   N  min       M   subscript  N  min     M   satisfying      g  i    (  M  )    =  0         subscript  g  i   M   0    g_{i}(M)=0   (mod    N  i     subscript  N  i    N_{i}   ) for all    i  ∈   {  1  ,  …  ,  k  }       i   1  normal-…  k     i\in\left\{1,\dots,k\right\}   . Furthermore suppose    k  >  q      k  q    k>q   . There is an efficient algorithm which, given    ⟨   N  i   ,    g  i    (  x  )    ⟩      subscript  N  i      subscript  g  i   x     \left\langle N_{i},g_{i}\left(x\right)\right\rangle   for all   i   i   i   , computes   M   M   M   .   Proof : Since the    N  i     subscript  N  i    N_{i}   are relatively prime the Chinese Remainder Theorem might be used to compute coefficients     T  i     subscript  T  i    T_{i}   satisfying     T  i   ≡   1  mod    N  i    (   i   s  1    )          subscript  T  i    modulo  1     subscript  N  i     i   subscript  s  1        T_{i}\equiv 1\bmod N_{i}(is_{1})   and     T  i   ≡   0  mod   N  j         subscript  T  i    modulo  0   subscript  N  j      T_{i}\equiv 0\bmod\ N_{j}   for all    i  ≠  j      i  j    i\neq j   . Setting     g   (  x  )    =   ∑    i  ⋅   T  i   ⋅   g  i     (  x  )           g  x        normal-⋅  i   subscript  T  i    subscript  g  i    x      g(x)=\sum i\cdot T_{i}\cdot g_{i}(x)   we know that     g   (  M  )    ≡   0  mod   ∏   N  i           g  M    modulo  0   product   subscript  N  i       g(M)\equiv 0\bmod\ \prod N_{i}   . Since the    T  i     subscript  T  i    T_{i}   are nonzero we have that    g   (  x  )       g  x    g\left(x\right)   is also nonzero. The degree of    g   (  x  )       g  x    g\left(x\right)   is at most   q   q   q   . By Coppersmith’s Theorem, we may compute all integer roots    x  0     subscript  x  0    x_{0}   satisfying     g   (   x  0   )    ≡   0  mod   ∏   N  i           g   subscript  x  0     modulo  0   product   subscript  N  i       g(x_{0})\equiv 0\bmod\prod N_{i}   and     |   x  0   |   <    (   ∏   N  i    )    1  q           subscript  x  0     superscript   product   subscript  N  i      1  q      \left|x_{0}\right|<\left(\prod N_{i}\right)^{\frac{1}{q}}   . However, we know that    M  <   N  min   <    (   ∏   N  1    )    1  k    <    (   ∏   N  1    )    1  q          M   subscript  N  min         superscript   product   subscript  N  1      1  k          superscript   product   subscript  N  1      1  q       M   , so   M   M   M   is among the roots found by Coppersmith's theorem. This theorem can be applied to the problem of broadcast RSA in the following manner: Suppose the i -th plaintext is padded with a polynomial     f  i    (  x  )        subscript  f  i   x    f_{i}\left(x\right)   , so that     N  i   =      (    f  i    (  x  )    )    e  i    -   C  i    mod   N  i         subscript  N  i    modulo     superscript     subscript  f  i   x    subscript  e  i     subscript  C  i     subscript  N  i      N_{i}=\left(f_{i}\left(x\right)\right)^{e_{i}}-C_{i}\bmod\ N_{i}   . Then the polynomials     g  i   =      (    f  i    (  x  )    )    e  i    -   C  i    mod   N  i         subscript  g  i    modulo     superscript     subscript  f  i   x    subscript  e  i     subscript  C  i     subscript  N  i      g_{i}=\left(f_{i}\left(x\right)\right)^{e_{i}}-C_{i}\bmod N_{i}   satisfy that relation. The attack succeeds once    k  >    max  i    (    e  i   ⋅   deg   f  i     )        k     subscript  max  i    normal-⋅   subscript  e  i    degree   subscript  f  i        k>{\rm max}_{i}(e_{i}\cdot\deg f_{i})   . The original result used the Håstad method instead of the full Coppersmith method. Its result was required    k  =   O   (   q  2   )        k    O   superscript  q  2      k=O(q^{2})   messages, where    q  =   max  i    (   e  i   .  deg   f  i   )      fragments  q    subscript  max  i    fragments  normal-(   subscript  e  i   normal-.  degree   subscript  f  i   normal-)     q={\rm max}_{i}(e_{i}.\deg f_{i})   . 4   Franklin-Reiter Related Message Attack  Franklin-Reiter identified a new attack against RSA with public exponent     e  =  3      e  3    e=3   . If two messages differ only by a known fixed difference between the two messages and are RSA  encrypted under the same RSA  modulus    N   N   N   , then it is possible to recover both of them.  How does it work?  Let    ⟨  N  ;   e  i   ⟩     N   subscript  e  i     \left\langle N;e_{i}\right\rangle   be Alice's public key. Suppose      M  1   ;   M  2    ∈   ℤ  N         subscript  M  1    subscript  M  2     subscript  ℤ  N     M_{1};M_{2}\in\mathbb{Z}_{N}   are two distinct messages satisfying     M  1   ≡    f   (   M  2   )    mod  N        subscript  M  1    modulo    f   subscript  M  2    N     M_{1}\equiv f(M_{2})\,\bmod\,N   for some publicly known polynomial     f  ∈    ℤ  N    [  x  ]        f     subscript  ℤ  N    delimited-[]  x      f\in\mathbb{Z}_{N}[x]   . To send    M  1     subscript  M  1    M_{1}   and    M  2     subscript  M  2    M_{2}   to Alice, Bob may naively encrypt the messages and transmit the resulting ciphertexts      C  1   ;   C  2       subscript  C  1    subscript  C  2     C_{1};C_{2}   . Eve can easily recover     M  1   ;   M  2       subscript  M  1    subscript  M  2     M_{1};M_{2}   given     C  1   ;   C  2       subscript  C  1    subscript  C  2     C_{1};C_{2}   , by using the following theorem:  Theorem 3 (Franklin-Reiter) 5   Set    e  =  3      e  3    e=3   and let    ⟨  N  ,  e  ⟩     N  e    \left\langle N,e\right\rangle   be an RSA public key. Let     M  1   ≠   M  2   ∈   ℤ  N  *          subscript  M  1    subscript  M  2         subscript   superscript  ℤ    N      M_{1}\neq M_{2}\in\mathbb{Z}^{*}_{N}   satisfy     M  1   ≡    f   (   M  2   )    mod  N        subscript  M  1    modulo    f   subscript  M  2    N     M_{1}\equiv f(M_{2})\,\bmod\,N   for some linear polynomial     f  =    a  x   +  b   ∈    ℤ  N    [  x  ]          f      a  x   b           subscript  ℤ  N    delimited-[]  x       f=ax+b\in\mathbb{Z}_{N}[x]   with    b  ≠  0      b  0    b\neq 0   . Then, given    ⟨  N  ,  e  ,   C  1   ,   C  2   ,  f  ⟩     N  e   subscript  C  1    subscript  C  2   f    \left\langle N,e,C_{1},C_{2},f\right\rangle   , attacker, Eve, can recover     M  1   ,   M  2       subscript  M  1    subscript  M  2     M_{1},M_{2}   in time quadratic in     log  2   N      subscript   2   N    \log_{2}N   .   For an arbitrary    e   e   e   (rather than restricting to    e  =  3      e  3    e=3   ) the time required is quadratic in   e   e   e   and     log  2   N      subscript   2   N    \log_{2}N   ).  Proof : Since     C  1   =     M  1  e    mod  N        subscript  C  1    modulo   superscript   subscript  M  1   e   N     C_{1}=M_{1}^{e}\,\bmod\,N   , we know that    M  2     subscript  M  2    M_{2}   is a root of the polynomial       g  1    (  x  )    =    f    (  x  )   e    -   C  1    ∈    ℤ  N    [  x  ]             subscript  g  1   x       f   superscript  x  e     subscript  C  1            subscript  ℤ  N    delimited-[]  x       g_{1}(x)=f(x)^{e}-C_{1}\in\mathbb{Z}_{N}[x]   . Similarly,    M  2     subscript  M  2    M_{2}   is a root of      g  2    (  x  )    =    x  e   -   C  2    ∈    ℤ  N    [  x  ]             subscript  g  2   x      superscript  x  e    subscript  C  2            subscript  ℤ  N    delimited-[]  x       g_{2}(x)=x^{e}-C_{2}\in\mathbb{Z}_{N}[x]   . The linear factor    x  -   M  2       x   subscript  M  2     x-M_{2}   divides both polynomials . Therefore, Eve calculates the greatest common divisor (gcd) of    g  1     subscript  g  1    g_{1}   and    g  2     subscript  g  2    g_{2}   , if the gcd turns out to be linear,    M  2     subscript  M  2    M_{2}   is found. The gcd can be computed in quadratic time in   e   e   e   and     log  2   N      subscript   2   N    \log_{2}N   using the Euclidean algorithm .  Coppersmith’s Short Pad Attack  Like Håstad’s and Franklin-Reiter’s attack, this attack exploits a weakness of RSA with public exponent    e  =  3      e  3    e=3   . Coppersmith showed that if randomized padding suggested by Håstad is used improperly then RSA  encryption is not secure.  How does it work?  Suppose Bob sends a message   M   M   M   to Alice using a small random padding before encrypting it. An attacker, Eve, intercepts the ciphertext and prevents it from reaching its destination. Bob decides to resend   M   M   M   to Alice because Alice did not respond to his message. He randomly pads   M   M   M   again and transmits the resulting ciphertext. Eve now has two ciphertexts corresponding to two encryptions of the same message using two different random pads.  Even though Eve does not know the random pad being used, she still can recover the message   M   M   M   by using the following theorem, if the random padding is too short.  Theorem 4 (Coppersmith)   Let    ⟨  N  ,  e  ⟩     N  e    \left\langle N,e\right\rangle   be a public RSA key where   N   N   N   is   n   n   n   -bits long. Set    m  =   ⌊   n   e  2    ⌋       m      n   superscript  e  2       m=\lfloor\frac{n}{e^{2}}\rfloor   . Let    M  ∈   ℤ  N  *       M   subscript   superscript  ℤ    N     M\in\mathbb{Z}^{*}_{N}   be a message of length at most    n  -  m      n  m    n-m   bits. Define     M  1   =     2  m   M   +   r  1         subscript  M  1        superscript  2  m   M    subscript  r  1      M_{1}=2^{m}M+r_{1}   and     M  2   =     2  m   M   +   r  2         subscript  M  2        superscript  2  m   M    subscript  r  2      M_{2}=2^{m}M+r_{2}   , where    r  1     subscript  r  1    r_{1}   and    r  2     subscript  r  2    r_{2}   are distinct  integers with     0  ≤   r  1    ,    r  2   <   2  m       formulae-sequence    0   subscript  r  1       subscript  r  2    superscript  2  m      0\leq r_{1},r_{2}<2^{m}   . If Eve is given    ⟨  N  ,  e  ⟩     N  e    \left\langle N,e\right\rangle   and the encryptions     C  1   ,   C  2       subscript  C  1    subscript  C  2     C_{1},C_{2}   of     M  1   ,   M  2       subscript  M  1    subscript  M  2     M_{1},M_{2}   (but is not given    r  1     subscript  r  1    r_{1}   or    r  2     subscript  r  2    r_{2}   , she can efficiently recover   M   M   M   .   Proof 6 Define      g  1    (  x  ,  y  )    =    x  e   -   C  1           subscript  g  1    x  y       superscript  x  e    subscript  C  1      g_{1}(x,y)=x^{e}-C_{1}   and      g  2    (  x  ,  y  )    =     (   x  +  y   )   e   -   C  2           subscript  g  2    x  y       superscript    x  y   e    subscript  C  2      g_{2}(x,y)=(x+y)^{e}-C_{2}   . We know that when    y  =    r  2   -   r  1        y     subscript  r  2    subscript  r  1      y=r_{2}-r_{1}   , these polynomials have    x  =   M  1       x   subscript  M  1     x=M_{1}   as a common root. In other words,    △  =    r  2   -   r  1        normal-△     subscript  r  2    subscript  r  1      \vartriangle=r_{2}-r_{1}   is a root of the resultant      h   (  y  )    =    res  x    (   g  1   ,   g  2   )    ∈    ℤ  N    [  y  ]            h  y      subscript  res  x     subscript  g  1    subscript  g  2             subscript  ℤ  N    delimited-[]  y       h(y)={\rm res}_{x}(g_{1},g_{2})\in\mathbb{Z}_{N}[y]   . Furthermore,     |  △  |   <   2  m   <   N   1   e  2             normal-△    superscript  2  m         superscript  N    1   superscript  e  2        \left|\vartriangle\right|<2^{m}   . Hence,   △   normal-△   \vartriangle   is a small root of   h   h   h   modulo   N   N   N   , and Eve can efficiently find it using Theorem 1 (Coppersmith) . Once   △   normal-△   \vartriangle   is known, the Franklin-Reiter attack can be used to recover    M  2     subscript  M  2    M_{2}   and consequently   M   M   M   .   See also  Coppersmith method  References  "  Category:Attacks on public-key cryptosystems     Imad Khaled Salah,Abdullah Darwish and Saleh Oqeili. Mathematical Attacks on RSA Cryptosystem ↩  D. Boneh. Twenty years of attacks on the RSA cryptosystem ↩  Glenn Durfee. CRYPTANALYSIS OF RSA USING ALGEBRAIC AND LATTICE METHODS ↩   D. Boneh. Twenty years of attacks on the RSA cryptosystem ↩      
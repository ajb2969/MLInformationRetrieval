<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="703">Waveshaper</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Waveshaper</h1>
<hr/>

<p>In <a href="electronic_music" title="wikilink">electronic music</a> <strong>waveshaping</strong> is a type of <a href="distortion_synthesis" title="wikilink">distortion synthesis</a> in which complex <a href="Spectrum" title="wikilink">spectra</a> are produced from simple tones by altering the shape of the <a href="waveform" title="wikilink">waveforms</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="uses">Uses</h2>

<p>Waveshapers are used mainly by <a href="electronic_musician" title="wikilink">electronic musicians</a> to achieve an extra-abrasive sound. This effect is most used to enhance the sound of a music <a class="uri" href="synthesizer" title="wikilink">synthesizer</a> by altering the waveform or vowel. Rock musicians may also use a waveshaper for heavy <a class="uri" href="distortion" title="wikilink">distortion</a> of a guitar or bass. Some synthesizers or virtual software instruments have built-in waveshapers. The effect can make instruments sound noisy or <a href="Distortion_(music)" title="wikilink">overdriven</a>.</p>

<p>In digital modeling of analog audio equipment such as <a href="tube_amplifiers" title="wikilink">tube amplifiers</a>, waveshaping is used to introduce a static, or memoryless, nonlinearity to approximate the transfer characteristic of a <a href="vacuum_tube" title="wikilink">vacuum tube</a> or <a class="uri" href="diode" title="wikilink">diode</a> limiter.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="how-it-works">How it works</h2>

<p>A waveshaper is an <a href="audio_signal_processing" title="wikilink">audio effect</a> that changes an audio signal by mapping an input signal to the output signal by applying a fixed or variable mathematical function, called the <em>shaping function</em> or <em>transfer function</em>, to the input signal (the term shaping function is preferred to avoid confusion with the <a href="transfer_function" title="wikilink">transfer function</a> from systems theory).<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> The function can be any function at all.</p>

<p>Mathematically, the operation is defined by the <em>waveshaper equation</em></p>

<p>
<math display="block" id="Waveshaper:0">
<semantics>
<mrow>
<mi>y</mi>
<mo>=</mo>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>a</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
<mi>x</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<ci>y</ci>
<apply>
<times></times>
<ci>f</ci>
<apply>
<times></times>
<ci>a</ci>
<ci>t</ci>
<ci>x</ci>
<ci>t</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   y=f(a(t)x(t))
  </annotation>
</semantics>
</math>

 where <em>f</em> is the shaping function, <em>x(t)</em> is the input function, and <em>a(t)</em> is the <em>index function</em>, which in general may vary as a function of time.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> This parameter <em>a</em> is often used as a constant gain factor called the <em>distortion index</em>.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> In practice, the input to the waveshaper, x, is considered on [-1,1] for digitally sampled signals, and f will be designed such that y is also on [-1,1] to prevent unwanted clipping in software.</p>
<h2 id="commonly-used-shaping-functions">Commonly used shaping functions</h2>

<p>Sin, arctan, polynomial functions, or piecewise functions (such as the hard clipping function) are commonly used as waveshaping transfer functions. It is also possible to use table-driven functions, consisting of discrete points with some degree of interpolation or linear segments.</p>
<h3 id="polynomials">Polynomials</h3>

<p>A <a class="uri" href="polynomial" title="wikilink">polynomial</a> is a function of the form</p>

<p>
<math display="inline" id="Waveshaper:1">
<semantics>
<mrow>
<mrow>
<mi>f</mi>
<mrow>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mi>x</mi>
<mi>n</mi>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<msub>
<mi>a</mi>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msub>
<msup>
<mi>x</mi>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mrow>
<mo>+</mo>
<mi mathvariant="normal">⋯</mi>
<mo>+</mo>
<mrow>
<msub>
<mi>a</mi>
<mn>2</mn>
</msub>
<msup>
<mi>x</mi>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<msub>
<mi>a</mi>
<mn>1</mn>
</msub>
<mi>x</mi>
</mrow>
<mo>+</mo>
<msub>
<mi>a</mi>
<mn>0</mn>
</msub>
</mrow>
<mo>=</mo>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∑</mo>
<mrow>
<mi>n</mi>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mi>N</mi>
</msubsup>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mi>x</mi>
<mi>n</mi>
</msup>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<and></and>
<apply>
<eq></eq>
<apply>
<times></times>
<ci>f</ci>
<ci>x</ci>
</apply>
<apply>
<plus></plus>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<ci>n</ci>
</apply>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<apply>
<minus></minus>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<apply>
<minus></minus>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<ci>normal-⋯</ci>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<cn type="integer">2</cn>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<cn type="integer">2</cn>
</apply>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<cn type="integer">1</cn>
</apply>
<ci>x</ci>
</apply>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<cn type="integer">0</cn>
</apply>
</apply>
</apply>
<apply>
<eq></eq>
<share href="#.cmml">
</share>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>n</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<ci>N</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<ci>n</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   f(x)=a_{n}x^{n}+a_{n-1}x^{n-1}+\cdots+a_{2}x^{2}+a_{1}x+a_{0}=\sum_{n=0}^{N}a_%
{n}x^{n}
  </annotation>
</semantics>
</math>
</p>

<p>Polynomial functions are convenient as shaping functions because, when given a single sinusoid as input, a polynomial of degree <em>N</em> will only introduce up to the <em>N</em>th harmonic of the sinusoid. To prove this, consider a sinusoid used as input to the general polynomial.</p>

<p>
<math display="block" id="Waveshaper:2">
<semantics>
<mrow>
<munderover>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mi>n</mi>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mi>N</mi>
</munderover>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>α</mi>
<mi>c</mi>
<mi>o</mi>
<mi>s</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mi>n</mi>
</msup>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>n</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<ci>N</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<times></times>
<ci>α</ci>
<ci>c</ci>
<ci>o</ci>
<ci>s</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
<ci>n</ci>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \sum_{n=0}^{N}a_{n}(\alpha cos(\omega t+\phi))^{n}
  </annotation>
</semantics>
</math>
</p>

<p>Next, use the inverse <a href="Euler's_formula" title="wikilink">Euler's formula</a> to obtain complex sinusoids.</p>

<p>
<math display="block" id="Waveshaper:3">
<semantics>
<mrow>
<mrow>
<munderover>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mi>n</mi>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mi>N</mi>
</munderover>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mrow>
<mo maxsize="260%" minsize="260%">(</mo>
<mrow>
<mi>α</mi>
<mfrac>
<mrow>
<msup>
<mi>e</mi>
<mrow>
<mi>j</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msup>
<mo>+</mo>
<msup>
<mi>e</mi>
<mrow>
<mo>-</mo>
<mrow>
<mi>j</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</msup>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
<mo maxsize="260%" minsize="260%">)</mo>
</mrow>
<mi>n</mi>
</msup>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mi>a</mi>
<mn>0</mn>
</msub>
<mo>+</mo>
<mrow>
<munderover>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mi>n</mi>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mi>N</mi>
</munderover>
<mrow>
<mfrac>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mi>α</mi>
<mi>n</mi>
</msup>
</mrow>
<msup>
<mn>2</mn>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mfrac>
<mfrac>
<msup>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<msup>
<mi>e</mi>
<mrow>
<mi>j</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msup>
<mo>+</mo>
<msup>
<mi>e</mi>
<mrow>
<mo>-</mo>
<mrow>
<mi>j</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</msup>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mi>n</mi>
</msup>
<mn>2</mn>
</mfrac>
</mrow>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>n</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<ci>N</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<times></times>
<ci>α</ci>
<apply>
<divide></divide>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>e</ci>
<apply>
<times></times>
<ci>j</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>e</ci>
<apply>
<minus></minus>
<apply>
<times></times>
<ci>j</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
<ci>n</ci>
</apply>
</apply>
</apply>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<cn type="integer">0</cn>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>N</ci>
</apply>
<apply>
<times></times>
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>α</ci>
<ci>n</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<cn type="integer">2</cn>
<apply>
<minus></minus>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>e</ci>
<apply>
<times></times>
<ci>j</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>e</ci>
<apply>
<minus></minus>
<apply>
<times></times>
<ci>j</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
<ci>n</ci>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \sum_{n=0}^{N}a_{n}\Bigg(\alpha\frac{e^{j(\omega t+\phi)}+e^{-j(\omega t+\phi)%
}}{2}\Bigg)^{n}=a_{0}+\sum_{n=1}^{N}\frac{a_{n}\alpha^{n}}{2^{n-1}}\frac{(e^{j%
(\omega t+\phi)}+e^{-j(\omega t+\phi)})^{n}}{2}
  </annotation>
</semantics>
</math>
</p>

<p>Finally, use the <a href="binomial_formula" title="wikilink">binomial formula</a> to transform back to trigonometric form and find coefficients for each harmonic.</p>

<p>
<math display="block" id="Waveshaper:4">
<semantics>
<mrow>
<mrow>
<msub>
<mi>a</mi>
<mn>0</mn>
</msub>
<mo>+</mo>
<mrow>
<munderover>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mi>n</mi>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mi>N</mi>
</munderover>
<mrow>
<mo maxsize="260%" minsize="260%">[</mo>
<mrow>
<mfrac>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mi>α</mi>
<mi>n</mi>
</msup>
</mrow>
<msup>
<mn>2</mn>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mfrac>
<mrow>
<munderover>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mi>k</mi>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mi>n</mi>
</munderover>
<mrow>
<mrow>
<mo>(</mo>
<mtable columnspacing="0.4em" rowspacing="0.2ex">
<mtr>
<mtd>
<mi>n</mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>k</mi>
</mtd>
</mtr>
</mtable>
<mo>)</mo>
</mrow>
<mfrac>
<mrow>
<msup>
<mi>e</mi>
<mrow>
<mi>j</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mi>k</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msup>
<msup>
<mi>e</mi>
<mrow>
<mo>-</mo>
<mrow>
<mi>j</mi>
<mi>k</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</msup>
</mrow>
<mn>2</mn>
</mfrac>
</mrow>
</mrow>
</mrow>
<mo maxsize="260%" minsize="260%">]</mo>
</mrow>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<msub>
<mi>a</mi>
<mn>0</mn>
</msub>
<mo>+</mo>
<mrow>
<munderover>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mi>n</mi>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mi>N</mi>
</munderover>
<mrow>
<mo maxsize="260%" minsize="260%">[</mo>
<mrow>
<mfrac>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mi>α</mi>
<mi>n</mi>
</msup>
</mrow>
<msup>
<mn>2</mn>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mfrac>
<mrow>
<munderover>
<mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
<mrow>
<mi>k</mi>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mi>n</mi>
</munderover>
<mrow>
<mrow>
<mo>(</mo>
<mtable columnspacing="0.4em" rowspacing="0.2ex">
<mtr>
<mtd>
<mi>n</mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>k</mi>
</mtd>
</mtr>
</mtable>
<mo>)</mo>
</mrow>
<mfrac>
<msup>
<mi>e</mi>
<mrow>
<mi>j</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mrow>
<mn>2</mn>
<mi>k</mi>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</msup>
<mn>2</mn>
</mfrac>
</mrow>
</mrow>
</mrow>
<mo maxsize="260%" minsize="260%">]</mo>
</mrow>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<cn type="integer">0</cn>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>N</ci>
</apply>
<apply>
<csymbol cd="latexml">delimited-[]</csymbol>
<apply>
<times></times>
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>α</ci>
<ci>n</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<cn type="integer">2</cn>
<apply>
<minus></minus>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>k</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<ci>n</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="latexml">binomial</csymbol>
<ci>n</ci>
<ci>k</ci>
</apply>
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>e</ci>
<apply>
<times></times>
<ci>j</ci>
<apply>
<minus></minus>
<ci>n</ci>
<ci>k</ci>
</apply>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>e</ci>
<apply>
<minus></minus>
<apply>
<times></times>
<ci>j</ci>
<ci>k</ci>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<cn type="integer">0</cn>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>N</ci>
</apply>
<apply>
<csymbol cd="latexml">delimited-[]</csymbol>
<apply>
<times></times>
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>α</ci>
<ci>n</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<cn type="integer">2</cn>
<apply>
<minus></minus>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>k</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<ci>n</ci>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="latexml">binomial</csymbol>
<ci>n</ci>
<ci>k</ci>
</apply>
<apply>
<divide></divide>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>e</ci>
<apply>
<times></times>
<ci>j</ci>
<apply>
<minus></minus>
<ci>n</ci>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>k</ci>
</apply>
</apply>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   a_{0}+\sum_{n=1}^{N}\Bigg[{\frac{a_{n}\alpha^{n}}{2^{n-1}}\sum_{k=0}^{n}{{n%
\choose k}\frac{e^{j(n-k)(\omega t+\phi)}e^{-jk(\omega t+\phi)}}{2}}\Bigg]}%
\par
=a_{0}+\sum_{n=1}^{N}\Bigg[{\frac{a_{n}\alpha^{n}}{2^{n-1}}\sum_{k=0}^{n}%
{{n\choose k}\frac{e^{j(n-2k)(\omega t+\phi)}}{2}}\Bigg]}
  </annotation>
</semantics>
</math>
<math display="inline" id="Waveshaper:5">
<semantics>
<mrow>
<mi></mi>
<mo>=</mo>
<mrow>
<msub>
<mi>a</mi>
<mn>0</mn>
</msub>
<mo>+</mo>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∑</mo>
<mrow>
<mi>n</mi>
<mo>=</mo>
<mn>1</mn>
</mrow>
<mi>N</mi>
</msubsup>
<mrow>
<mo maxsize="260%" minsize="260%">[</mo>
<mrow>
<mfrac>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mi>α</mi>
<mi>n</mi>
</msup>
</mrow>
<msup>
<mn>2</mn>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mfrac>
<mrow>
<msubsup>
<mo largeop="true" symmetric="true">∑</mo>
<mrow>
<mi>k</mi>
<mo>=</mo>
<mn>0</mn>
</mrow>
<mrow>
<mo stretchy="false">⌊</mo>
<mrow>
<mi>n</mi>
<mo>/</mo>
<mn>2</mn>
</mrow>
<mo stretchy="false">⌋</mo>
</mrow>
</msubsup>
<mrow>
<mrow>
<mo>(</mo>
<mstyle scriptlevel="+1">
<mtable columnspacing="0.4em" rowspacing="0.2ex">
<mtr>
<mtd>
<mi>n</mi>
</mtd>
</mtr>
<mtr>
<mtd>
<mi>k</mi>
</mtd>
</mtr>
</mtable>
</mstyle>
<mo>)</mo>
</mrow>
<mrow>
<mi>cos</mi>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mrow>
<mn>2</mn>
<mi>k</mi>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
<mrow>
<mo stretchy="false">(</mo>
<mrow>
<mrow>
<mi>ω</mi>
<mi>t</mi>
</mrow>
<mo>+</mo>
<mi>ϕ</mi>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
<mo stretchy="false">)</mo>
</mrow>
</mrow>
</mrow>
</mrow>
</mrow>
<mo maxsize="260%" minsize="260%">]</mo>
</mrow>
</mrow>
</mrow>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<eq></eq>
<csymbol cd="latexml">absent</csymbol>
<apply>
<plus></plus>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<cn type="integer">0</cn>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
<ci>N</ci>
</apply>
<apply>
<csymbol cd="latexml">delimited-[]</csymbol>
<apply>
<times></times>
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>α</ci>
<ci>n</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<cn type="integer">2</cn>
<apply>
<minus></minus>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
<apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<sum></sum>
<apply>
<eq></eq>
<ci>k</ci>
<cn type="integer">0</cn>
</apply>
</apply>
<apply>
<floor></floor>
<apply>
<divide></divide>
<ci>n</ci>
<cn type="integer">2</cn>
</apply>
</apply>
</apply>
<apply>
<times></times>
<apply>
<csymbol cd="latexml">binomial</csymbol>
<ci>n</ci>
<ci>k</ci>
</apply>
<apply>
<cos></cos>
<apply>
<times></times>
<apply>
<minus></minus>
<ci>n</ci>
<apply>
<times></times>
<cn type="integer">2</cn>
<ci>k</ci>
</apply>
</apply>
<apply>
<plus></plus>
<apply>
<times></times>
<ci>ω</ci>
<ci>t</ci>
</apply>
<ci>ϕ</ci>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   =a_{0}+\sum_{n=1}^{N}\Bigg[{\frac{a_{n}\alpha^{n}}{2^{n-1}}\sum_{k=0}^{\lfloor
n%
/2\rfloor}{{n\choose k}\cos{((n-2k)(\omega t+\phi))}}\Bigg]}
  </annotation>
</semantics>
</math>
</p>

<p>From the above equation, several observations can be made about the effect of a polynomial shaping function on a single sinusoid:</p>
<ul>
<li>All of the sinusoids generated are harmonically related to the original input.</li>
</ul>
<ul>
<li>The frequency never exceeds 

<math display="inline" id="Waveshaper:6">
<semantics>
<mrow>
<mi>N</mi>
<mi>ω</mi>
</mrow>
<annotation-xml encoding="MathML-Content">
<apply>
<times></times>
<ci>N</ci>
<ci>ω</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   N\omega
  </annotation>
</semantics>
</math>

.</li>
</ul>
<ul>
<li>All odd monomial terms 

<math display="inline" id="Waveshaper:7">
<semantics>
<msup>
<mi>x</mi>
<mi>n</mi>
</msup>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>x</ci>
<ci>n</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   x^{n}
  </annotation>
</semantics>
</math>

 generate odd harmonics from <em>n</em> down to the fundamental, and all even monomial terms generate even harmonics from <em>n</em> down to DC (0 frequency).</li>
</ul>
<ul>
<li>The shape of the spectrum produced by each monomial term is fixed and determined by the binomial coefficients .</li>
</ul>
<ul>
<li>The weight of that spectrum in the overall output is determined solely by its 

<math display="inline" id="Waveshaper:8">
<semantics>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<annotation-xml encoding="MathML-Content">
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   a_{n}
  </annotation>
</semantics>
</math>

 coefficient and the amplitude of the input by 

<math display="inline" id="Waveshaper:9">
<semantics>
<mfrac>
<mrow>
<msub>
<mi>a</mi>
<mi>n</mi>
</msub>
<msup>
<mi>α</mi>
<mi>n</mi>
</msup>
</mrow>
<msup>
<mn>2</mn>
<mrow>
<mi>n</mi>
<mo>-</mo>
<mn>1</mn>
</mrow>
</msup>
</mfrac>
<annotation-xml encoding="MathML-Content">
<apply>
<divide></divide>
<apply>
<times></times>
<apply>
<csymbol cd="ambiguous">subscript</csymbol>
<ci>a</ci>
<ci>n</ci>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<ci>α</ci>
<ci>n</ci>
</apply>
</apply>
<apply>
<csymbol cd="ambiguous">superscript</csymbol>
<cn type="integer">2</cn>
<apply>
<minus></minus>
<ci>n</ci>
<cn type="integer">1</cn>
</apply>
</apply>
</apply>
</annotation-xml>
<annotation encoding="application/x-tex">
   \frac{a_{n}\alpha^{n}}{2^{n-1}}
  </annotation>
</semantics>
</math>
</li>
</ul>
<h2 id="problems-associated-with-waveshapers">Problems associated with waveshapers</h2>

<p>The sound produced by digital waveshapers tends to be harsh and unattractive, because of problems with aliasing. Waveshaping is a non-linear operation, so it's hard to generalize about the effect of a waveshaping function on an input signal. The mathematics of non-linear operations on audio signals is difficult, and not well understood. The effect will be amplitude-dependent, among other things. But generally, waveshapers—particularly those with sharp corners (e.g., some derivatives are discontinuous) -- tend to introduce large numbers of high frequency harmonics. If these introduced harmonics exceed the <a href="nyquist_limit" title="wikilink">nyquist limit</a>, then they will be heard as harsh inharmonic content with a distinctly metallic sound in the output signal. <a class="uri" href="Supersampling" title="wikilink">Supersampling</a> can somewhat but not completely alleviate this problem, depending on how fast the introduced harmonics fall off. Supersampling involves the following procedure:</p>
<ul>
<li><a class="uri" href="Upsample" title="wikilink">Upsample</a> the signal to a high sample rate and interpolate using a low-pass filter.</li>
<li>Apply the waveshaping function to the supersampled signal.</li>
<li>Filter the supersampled signal to remove harmonic content above the <a href="Nyquist_limit" title="wikilink">Nyquist limit</a> of the original sample rate, preferably with a fairly steep filter.</li>
<li><a class="uri" href="Downsample" title="wikilink">Downsample</a> the signal to the original sample rate.</li>
</ul>

<p>With relatively simple, and relatively smooth waveshaping functions (sin(a*x), atan(a*x), polynomial functions, for example), this procedure may reduce aliased content in the harmonic signal to the point that it is musically acceptable. But waveshaping functions other than polynomial waveshaping functions will introduce an infinite number of harmonics into the signal, some which may audibly alias even at the supersampled frequency.</p>
<h2 id="sources">Sources</h2>

<p>"</p>

<p><a href="Category:Electronic_music" title="wikilink">Category:Electronic music</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Charles Dodge and Thomas A. Jersey (1997). <em>Computer Music: Synthesis, Composition, and Performance</em>, "Glossary", p.438. ISBN 0-02-864682-7.<a href="#fnref1">↩</a></li>
<li id="fn2">Yeh, David T. and Pakarinen, Jyri (2009). "A Review of Digital Techniques for Modeling Vacuum-Tube Guitar Amplifiers", <em>Computer Music Journal</em>, 33:2, pp. 89-90<a href="#fnref2">↩</a></li>
<li id="fn3"><a class="uri" href="http://www.music.mcgill.ca/~gary/courses/2012/307/week12/node2.html">http://www.music.mcgill.ca/~gary/courses/2012/307/week12/node2.html</a><a href="#fnref3">↩</a></li>
<li id="fn4">Le Brun, Marc (1979). "Digital Waveshaping Synthesis", <em>Journal of the Audio Engineering Society</em>, 27:4, p. 250<a href="#fnref4">↩</a></li>
<li id="fn5"><a class="uri" href="http://www.music.mcgill.ca/~gary/courses/2012/307/week12/node4.html">http://www.music.mcgill.ca/~gary/courses/2012/307/week12/node4.html</a><a href="#fnref5">↩</a></li>
</ol>
</section>
</body>
</html>

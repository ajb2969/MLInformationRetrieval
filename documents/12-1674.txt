   Maximum spacing estimation      Maximum spacing estimation   (Figure)  The maximum spacing method tries to find a distribution function such that the spacings, D ( i ) , are all approximately of the same length. This is done by maximizing their geometric mean .   In statistics , maximum spacing estimation ( MSE or MSP ), or maximum product of spacing estimation (MPS) , is a method for estimating the parameters of a univariate statistical model . 1 The method requires maximization of the geometric mean of spacings in the data, which are the differences between the values of the cumulative distribution function at neighbouring data points.  The concept underlying the method is based on the probability integral transform , in that a set of independent random samples derived from any random variable should on average be uniformly distributed with respect to the cumulative distribution function of the random variable. The MPS method chooses the parameter values that make the observed data as uniform as possible, according to a specific quantitative measure of uniformity.  One of the most common methods for estimating the parameters of a distribution from data, the method of maximum likelihood (MLE), can break down in various cases, such as involving certain mixtures of continuous distributions. 2 In these cases the method of maximum spacing estimation may be successful.  Apart from its use in pure mathematics and statistics, the trial applications of the method have been reported using data from fields such as hydrology , 3  econometrics , 4  magnetic resonance imaging , 5 and others. 6  History and usage  The MSE method was derived independently by Russel Cheng and Nik Amin at the University of Wales Institute of Science and Technology , and Bo Ranneby at the Swedish University of Agricultural Sciences . 7 The authors explained that due to the probability integral transform at the true parameter, the “spacing” between each observation should be uniformly distributed. This would imply that the difference between the values of the cumulative distribution function at consecutive observations should be equal. This is the case that maximizes the geometric mean of such spacings, so solving for the parameters that maximize the geometric mean would achieve the “best” fit as defined this way.  justified the method by demonstrating that it is an estimator of the Kullback–Leibler divergence , similar to maximum likelihood estimation , but with more robust properties for various classes of problems.  There are certain distributions, especially those with three or more parameters, whose likelihoods may become infinite along certain paths in the parameter space . Using maximum likelihood to estimate these parameters often breaks down, with one parameter tending to the specific value that causes the likelihood to be infinite, rendering the other parameters inconsistent. The method of maximum spacings, however, being dependent on the difference between points on the cumulative distribution function and not individual likelihood points, does not have this issue, and will return valid results over a much wider array of distributions. 8  The distributions that tend to have likelihood issues are often those used to model physical phenomena.  seek to analyze flood alleviation methods, which requires accurate models of river flood effects. The distributions that better model these effects are all three-parameter models, which suffer from the infinite likelihood issue described above, leading to Hall’s investigation of the maximum spacing procedure. , when comparing the method to maximum likelihood, use various data sets ranging from a set on the oldest ages at death in Sweden between 1905 and 1958 to a set containing annual maximum wind speeds.  Definition  Given an iid  random sample { x 1 , …, x n } of size n from a univariate distribution with the cumulative distribution function F ( x ; θ 0 ), where θ 0 ∈ Θ is an unknown parameter to be estimated , let { x (1) , …, x ( n ) } be the corresponding ordered sample, that is the result of sorting of all observations from smallest to largest. For convenience also denote x (0) = −∞ and x ( n +1) = +∞.  Define the spacings as the “gaps” between the values of the distribution function at adjacent ordered points: 9         D  i    (  θ  )    =    F   (   x   (  i  )    ;  θ  )    -   F   (   x   (   i  -  1   )    ;  θ  )      ,   i  =   1  ,  …  ,   n  +  1.        formulae-sequence       subscript  D  i   θ       F    subscript  x  i   θ      F    subscript  x    i  1    θ        i   1  normal-…    n  1.       D_{i}(\theta)=F(x_{(i)};\,\theta)-F(x_{(i-1)};\,\theta),\quad i=1,\ldots,n+1.     Then the maximum spacing estimator of θ 0 is defined as a value that maximizes the logarithm of the geometric mean of sample spacings:         θ  ^   =       arg   max    θ  ∈  Θ      S  n    (  θ  )     ,     where    S  n    (  θ  )    =    ln      D  1    D  2   ⋯   D   n  +  1      n  +  1     =    1   n  +  1      ∑   i  =  1    n  +  1      ln   D  i     (  θ  )        .     formulae-sequence     normal-^  θ        θ  normal-Θ     arg  max     subscript  S  n   θ          where   subscript  S  n   θ          n  1       subscript  D  1    subscript  D  2   normal-⋯   subscript  D    n  1                1    n  1      superscript   subscript     i  1      n  1         subscript  D  i    θ         \hat{\theta}=\underset{\theta\in\Theta}{\operatorname{arg\,max}}\;S_{n}(\theta%
 ),\quad\text{where }\ S_{n}(\theta)=\ln\!\!\sqrt[n+1]{D_{1}D_{2}\cdots D_{n+1}%
 }=\frac{1}{n+1}\sum_{i=1}^{n+1}\ln{D_{i}}(\theta).     By the inequality of arithmetic and geometric means , function S n ( θ ) is bounded from above by −ln( n +1), and thus the maximum has to exist at least in the supremum sense.  Note that some authors define the function S n ( θ ) somewhat differently. In particular,  multiplies each D i by a factor of ( n +1), whereas  omit the    n  /  +  1     fragments  n    1    {n}/{+1}   factor in front of the sum and add the “−” sign in order to turn the maximization into minimization. As these are constants with respect to θ , the modifications do not alter the location of the maximum of the function S n .  Examples  This section presents two examples of calculating the maximum spacing estimator.  Example 1  (Figure)  Plots of the log value of λ for the simplistic example under both likelihood and spacing estimation. The values for which both likelihood and spacing are maximized, the maximum likelihood and maximum spacing estimates, are identified.   Suppose two values x (1) = 2, x (2) = 4 were sampled from the exponential distribution  F ( x ; λ ) = 1 − e − xλ , x ≥ 0 with unknown parameter λ > 0. In order to construct the MSE we have to first find the spacings:       i   F ( x ( i ) )   F ( x ( i −1) )   D i = F ( x ( i ) ) − F ( x ( i −1) )       1   1 − e −2 λ   0   1 − e −2 λ     2   1 − e −4 λ   1 − e −2 λ   e −2 λ − e −4 λ     3   1   1 − e −4 λ   e −4 λ      The process continues by finding the λ that maximizes the geometric mean of the “difference” column. Using the convention that ignores taking the ( n +1)st root, this turns into the maximization of the following product: (1 − e −2 λ ) · (e −2 λ − e −4 λ ) · (e −4 λ ). Letting μ = e −2 λ , the problem becomes finding the maximum of μ 5 −2 μ 4 + μ 3 . Differentiating, the μ has to satisfy 5 μ 4 −8 μ 3 +3 μ 2 = 0. This equation has roots 0, 0.6, and 1. As μ is actually e −2 λ , it has to be greater than zero but less than one. Therefore, the only acceptable solution is        μ  =   0.6  ⇒      λ  MSE   =    ln  0.6    -  2    ≈  0.255    ,     formulae-sequence    μ   0.6  normal-⇒         subscript  λ  MSE       0.6     2         0.255      \mu=0.6\quad\Rightarrow\quad\lambda_{\text{MSE}}=\frac{\ln 0.6}{-2}\approx 0.2%
 55,   which corresponds to an exponential distribution with a mean of    1  /  λ      1  λ    {1}/{λ}   ≈ 3.915. For comparison, the maximum likelihood estimate of λ is the inverse of the sample mean, 3, so λ MLE = ⅓ ≈ 0.333.  Example 2  Suppose { x (1) , …, x ( n ) } is the ordered sample from a uniform distribution  U ( a , b ) with unknown endpoints a and b . The cumulative distribution function is F ( x ; a , b ) = ( x − a )/( b − a ) when x ∈[ a , b ]. Therefore individual spacings are given by         D  1   =     x   (  1  )    -  a    b  -  a     ,    D  i   =       x   (  i  )    -   x   (   i  -  1   )      b  -  a     for  i   =  2    ,    …  ,  n  ,   D   n  +  1     =     b  -   x   (  n  )      b  -  a         formulae-sequence   formulae-sequence     subscript  D  1        subscript  x  1   a     b  a          subscript  D  i          subscript  x  i    subscript  x    i  1       b  a    for  i        2        normal-…  n   subscript  D    n  1         b   subscript  x  n      b  a       D_{1}=\frac{x_{(1)}-a}{b-a},\ \ D_{i}=\frac{x_{(i)}-x_{(i-1)}}{b-a}\ \text{for%
  }i=2,\ldots,n,\ \ D_{n+1}=\frac{b-x_{(n)}}{b-a}\     Calculating the geometric mean and then taking the logarithm, statistic S n will be equal to        S  n    (  a  ,  b  )    =        1   n  +  1      ln   (    x   (  1  )    -  a   )     +     1   n  +  1      ln   (   b  -   x   (  n  )     )      -   ln   (   b  -  a   )     +    ∑   i  =  2   n    ln   (    x   (  i  )    -   x   (   i  -  1   )     )             subscript  S  n    a  b              1    n  1         subscript  x  1   a         1    n  1        b   subscript  x  n           b  a       superscript   subscript     i  2    n        subscript  x  i    subscript  x    i  1          S_{n}(a,b)=\tfrac{1}{n+1}\ln(x_{(1)}-a)+\tfrac{1}{n+1}\ln(b-x_{(n)})-\ln(b-a)+%
 \sum_{i=2}^{n}\ln(x_{(i)}-x_{(i-1)})   Here only the first three terms depend on the parameters a and b . Differentiating with respect to those parameters and solving the resulting linear system, the maximum spacing estimates will be      \hat{a} = \frac{nx_{(1)} - x_{(n)}}{n-1},\ \ \hat{b} = \frac{nx_{(n)}-x_{(1)}}{n-1}.    These are known to be the uniformly minimum variance unbiased (UMVU) estimators for the continuous uniform distribution. 10 In comparison, the maximum likelihood estimates for this problem     a  ^   =   x   (  1  )         normal-^  a    subscript  x  1     \scriptstyle\hat{a}=x_{(1)}   and     b  ^   =   x   (  n  )         normal-^  b    subscript  x  n     \scriptstyle\hat{b}=x_{(n)}   are biased and have higher mean-squared error .  Properties  Consistency and efficiency  The maximum spacing estimator is a consistent estimator in that it converges in probability to the true value of the parameter, θ 0 , as the sample size increases to infinity. 11 The consistency of maximum spacing estimation holds under much more general conditions than for maximum likelihood estimators. In particular, in cases where the underlying distribution is J-shaped, maximum likelihood will fail where MSE succeeds. 12 An example of a J-shaped density is the Weibull distribution , specifically a shifted Weibull , with a shape parameter less than 1. The density will tend to infinity as x approaches the location parameter rendering estimates of the other parameters inconsistent.  Maximum spacing estimators are also at least as asymptotically efficient as maximum likelihood estimators, where the latter exist. However, MSEs may exist in cases where MLEs do not. 13  Sensitivity  Maximum spacing estimators are sensitive to closely spaced observations, and especially ties. 14 Given        X   i  +  k    =   X    i  +  k   -  1    =  ⋯  =   X  i    ,         subscript  X    i  k     subscript  X      i  k   1         normal-⋯        subscript  X  i      X_{i+k}=X_{i+k-1}=\cdots=X_{i},\,   we get        D   i  +  k     (  θ  )    =    D    i  +  k   -  1     (  θ  )    =  ⋯  =    D   i  +  1     (  θ  )    =   0.            subscript  D    i  k    θ      subscript  D      i  k   1    θ        normal-⋯          subscript  D    i  1    θ        0.     D_{i+k}(\theta)=D_{i+k-1}(\theta)=\cdots=D_{i+1}(\theta)=0.\,     When the ties are due to multiple observations, the repeated spacings (those that would otherwise be zero) should be replaced by the corresponding likelihood. 15 That is, one should substitute     f  i    (  θ  )        subscript  f  i   θ    f_{i}(\theta)   for     D  i    (  θ  )        subscript  D  i   θ    D_{i}(\theta)   , as         lim    x  i   →   x   i  -  1         ∫   x   i  -  1     x  i     f   (  t  ;  θ  )   d  t      x  i   -   x   i  -  1       =   f   (   x   i  -  1    ,  θ  )    =   f   (   x  i   ,  θ  )     ,          subscript    normal-→   subscript  x  i    subscript  x    i  1          superscript   subscript    subscript  x    i  1      subscript  x  i      f   t  θ   d  t       subscript  x  i    subscript  x    i  1         f    subscript  x    i  1    θ           f    subscript  x  i   θ       \lim_{x_{i}\to x_{i-1}}\frac{\int_{x_{i-1}}^{x_{i}}f(t;\theta)\,dt}{x_{i}-x_{i%
 -1}}=f(x_{i-1},\theta)=f(x_{i},\theta),   since     x  i   =   x   i  -  1         subscript  x  i    subscript  x    i  1      x_{i}=x_{i-1}   .  When ties are due to rounding error,  suggest another method to remove the effects. 16 Given r tied observations from x i to x i + r −1 , let δ represent the round-off error . All of the true values should then fall in the range    x  ±  δ     plus-or-minus  x  δ    x\pm\delta   . The corresponding points on the distribution should now fall between     y  L   =   F   (   x  -  δ   ,   θ  ^   )         subscript  y  L     F     x  δ    normal-^  θ       y_{L}=F(x-\delta,\hat{\theta})   and     y  U   =   F   (   x  +  δ   ,   θ  ^   )         subscript  y  U     F     x  δ    normal-^  θ       y_{U}=F(x+\delta,\hat{\theta})   . Cheng and Stephens suggest assuming that the rounded values are uniformly spaced in this interval, by defining       D  j   =     y  U   -   y  L     r  -  1     (  j  =  i  +  1  ,  …  ,  i  +  r  -  1  )   .     fragments   subscript  D  j         subscript  y  U    subscript  y  L      r  1      fragments  normal-(  j   i   1  normal-,  normal-…  normal-,  i   r   1  normal-)   normal-.    D_{j}=\frac{y_{U}-y_{L}}{r-1}\quad(j=i+1,\ldots,i+r-1).     The MSE method is also sensitive to secondary clustering. 17 One example of this phenomenon is when a set of observations is thought to come from a single normal distribution , but in fact comes from a mixture normals with different means. A second example is when the data is thought to come from an exponential distribution , but actually comes from a gamma distribution . In the latter case, smaller spacings may occur in the lower tail. A high value of M ( θ ) would indicate this secondary clustering effect, and suggesting a closer look at the data is required. 18  Goodness of fit  The statistic S n ( θ ) is also a form of Moran or Moran-Darling statistic, M ( θ ), which can be used to test goodness of fit . 19 It has been shown that the statistic, when defined as         S  n    (  θ  )    =    M  n    (  θ  )    =   -    ∑   j  =  1    n  +  1      ln   D  j     (  θ  )       ,           subscript  S  n   θ      subscript  M  n   θ            superscript   subscript     j  1      n  1         subscript  D  j    θ        S_{n}(\theta)=M_{n}(\theta)=-\sum_{j=1}^{n+1}\ln{D_{j}(\theta)},   is asymptotically normal , and that a chi-squared approximation exists for small samples. 20 In the case where we know the true parameter    θ  0     superscript  θ  0    \theta^{0}   ,  show that the statistic     M  n    (  θ  )        subscript  M  n   θ    \scriptstyle M_{n}(\theta)   has a normal distribution with      μ  M     subscript  μ  M    \displaystyle\mu_{M}   where γ is the Euler–Mascheroni constant which is approximately 0.57722. 21  The distribution can also be approximated by that of   A   A   A   , where      A  =    C  1   +    C  2     χ  n  2          A     subscript  C  1      subscript  C  2    subscript   superscript  χ  2   n       A=C_{1}+C_{2}\chi^{2}_{n}\,   , in which      C  1     subscript  C  1    \displaystyle C_{1}   and where    χ  n  2     subscript   superscript  χ  2   n    \chi^{2}_{n}   follows a chi-squared distribution with   n   n   n    degrees of freedom . Therefore, to test the hypothesis    H  0     subscript  H  0    H_{0}   that a random sample of   n   n   n   values comes from the distribution    F   (  x  ,  θ  )       F   x  θ     F(x,\theta)   , the statistic     T   (  θ  )    =     M   (  θ  )    -   C  1     C  2          T  θ         M  θ    subscript  C  1     subscript  C  2      T(\theta)=\frac{M(\theta)-C_{1}}{C_{2}}   can be calculated. Then    H  0     subscript  H  0    H_{0}   should be rejected with significance    α   α   \alpha   if the value is greater than the critical value of the appropriate chi-squared distribution. 22  Where θ 0 is being estimated by    θ  ^     normal-^  θ    \hat{\theta}   ,  showed that      S  n    (   θ  ^   )    =    M  n    (   θ  ^   )           subscript  S  n    normal-^  θ       subscript  M  n    normal-^  θ      S_{n}(\hat{\theta})=M_{n}(\hat{\theta})   has the same asymptotic mean and variance as in the known case. However, the test statistic to be used requires the addition of a bias correction term and is:        T   (   θ  ^   )    =      M   (   θ  ^   )    +   k  2    -   C  1     C  2     ,        T   normal-^  θ            M   normal-^  θ      k  2     subscript  C  1     subscript  C  2      T(\hat{\theta})=\frac{M(\hat{\theta})+\frac{k}{2}-C_{1}}{C_{2}},   where   k   k   k   is the number of parameters in the estimate.  Generalized maximum spacing  Alternate measures and spacings  generalized the MSE method to approximate other measures besides the Kullback–Leibler measure.  further expanded the method to investigate properties of estimators using higher order spacings, where an m -order spacing would be defined as     F   (   X   j  +  m    )    -   F   (   X  j   )          F   subscript  X    j  m       F   subscript  X  j      F(X_{j+m})-F(X_{j})   .  Multivariate distributions  discuss extended maximum spacing methods to the multivariate case. As there is no natural order for     ℝ  k    (  k  >  1  )      fragments   superscript  ℝ  k    fragments  normal-(  k   1  normal-)     \mathbb{R}^{k}(k>1)   , they discuss two alternative approaches: a geometric approach based on Dirichlet cells and a probabilistic approach based on a “nearest neighbor ball” metric.  See also   Kullback–Leibler divergence  Maximum likelihood  Probability distribution   Notes  References  Works cited     Note: linked paper is an updated 2001 version.             "  Category:Estimation theory  Category:Fitting probability distributions     ↩  ↩  ↩  ↩  ↩  ↩    ↩      ↩   There appear to be some minor typographical errors in the paper. For example, in section 4.2, equation (4.1), the rounding replacement for    D  j     subscript  D  j    D_{j}   , should not have the log term. In section 1, equation (1.2),    D  j     subscript  D  j    D_{j}   is defined to be the spacing itself, and    M   (  θ  )       M  θ    M(\theta)   is the negative sum of the logs of    D  j     subscript  D  j    D_{j}   . If    D  j     subscript  D  j    D_{j}   is logged at this step, the result is always ≤ 0, as the difference between two adjacent points on a cumulative distribution is always ≤ 1, and strictly \textstyle\tilde{\sigma^2} which has MPS estimate of 6.87, not the standard deviation    σ  ~     normal-~  σ    \textstyle\tilde{\sigma}   . – Editor ↩    The literature refers to related statistics as Moran or Moran-Darling statistics. For example,  analyze the form     M   (  θ  )    =   -    ∑   j  =  1    n  +  1      log   D  i     (  θ  )            M  θ       superscript   subscript     j  1      n  1         subscript  D  i    θ       \scriptstyle M(\theta)=-\sum_{j=1}^{n+1}\log{D_{i}(\theta)}   where     D  i    (  θ  )        subscript  D  i   θ    \scriptstyle D_{i}(\theta)   is defined as above.  use the same form as well. However,  uses the form     M  n   =   -    ∑   j  =  0   n    ln   (    (   n  +  1   )    (    X   n  ,   i  +  1     -   X   n  ,  i     )    )           subscript  M  n       superscript   subscript     j  0    n         n  1      subscript  X   n    i  1      subscript  X   n  i           \scriptstyle M_{n}=-\sum_{j=0}^{n}\ln{((n+1)(X_{n,i+1}-X_{n,i}))}   , with the additional factor of    (   n  +  1   )      n  1    (n+1)   inside the logged summation. The extra factors will make a difference in terms of the expected mean and variance of the statistic. For consistency, this article will continue to use the Cheng & Amin/Wong & Li form. -- Editor ↩   leave out the Euler–Mascheroni constant from their description. -- Editor ↩      
   Linear-quadratic-Gaussian control      Linear-quadratic-Gaussian control   In control theory , the linear-quadratic-Gaussian (LQG) control problem is one of the most fundamental optimal control problems. It concerns uncertain linear systems disturbed by additive white Gaussian noise , having incomplete state information (i.e. not all the state variables are measured and available for feedback) and undergoing control subject to quadratic costs . Moreover the solution is unique and constitutes a linear dynamic feedback control law that is easily computed and implemented. Finally the LQG controller is also fundamental to the optimal control of perturbed non-linear systems. 1  The LQG controller is simply the combination of a Kalman filter i.e. a linear-quadratic estimator (LQE) with a linear-quadratic regulator (LQR). The separation principle guarantees that these can be designed and computed independently. LQG control applies to both linear time-invariant systems as well as linear time-varying systems. The application to linear time-invariant systems is well known. The application to linear time-varying systems enables the design of linear feedback controllers for non-linear uncertain systems.  The LQG controller itself is a dynamic system like the system it controls. Both systems have the same state dimension. Therefore implementing the LQG controller may be problematic if the dimension of the system state is large. The reduced-order LQG problem (fixed-order LQG problem) overcomes this by fixing a-priori the number of states of the LQG controller. This problem is more difficult to solve because it is no longer separable. Also the solution is no longer unique. Despite these facts numerical algorithms are available 2 3 4 5 to solve the associated optimal projection equations 6 7 which constitute necessary and sufficient conditions for a locally optimal reduced-order LQG controller. 8  Finally, a word of caution. LQG optimality does not automatically ensure good robustness properties. 9 The robust stability of the closed loop system must be checked separately after the LQG controller has been designed. To promote robustness some of the system parameters may be assumed stochastic instead of deterministic. The associated more difficult control problem leads to a similar optimal controller of which only the controller parameters are different. 10  Mathematical description of the problem and solution  Continuous time  Consider the continuous-time linear dynamic system         𝐱  ˙    (  t  )    =    A   (  t  )   𝐱   (  t  )    +   B   (  t  )   𝐮   (  t  )    +   𝐯   (  t  )      ,         normal-˙  𝐱   t       A  t  𝐱  t     B  t  𝐮  t     𝐯  t      \dot{\mathbf{x}}(t)=A(t)\mathbf{x}(t)+B(t)\mathbf{u}(t)+\mathbf{v}(t),           𝐲   (  t  )    =    C   (  t  )   𝐱   (  t  )    +   𝐰   (  t  )      ,        𝐲  t       C  t  𝐱  t     𝐰  t      \mathbf{y}(t)=C(t)\mathbf{x}(t)+\mathbf{w}(t),     where   𝐱   𝐱   {\mathbf{x}}   represents the vector of state variables of the system,   𝐮   𝐮   {\mathbf{u}}   the vector of control inputs and   𝐲   𝐲   {\mathbf{y}}   the vector of measured outputs available for feedback. Both additive white Gaussian system noise    𝐯   (  t  )       𝐯  t    \mathbf{v}(t)   and additive white Gaussian measurement noise    𝐰   (  t  )       𝐰  t    \mathbf{w}(t)   affect the system. Given this system the objective is to find the control input history    𝐮   (  t  )       𝐮  t    {\mathbf{u}}(t)   which at every time   t   t   {\mathbf{}}t   may depend only on the past measurements      𝐲   (   t  ′   )    ,  0   ≤   t  ′   <  t           𝐲   superscript  t  normal-′    0    superscript  t  normal-′        t     {\mathbf{y}}(t^{\prime}),0\leq t^{\prime}   such that the following cost function is minimized:       J  =   E   (     𝐱  T    (  T  )   F  𝐱   (  T  )    +    ∫  0  T     𝐱  T    (  t  )   Q   (  t  )   𝐱   (  t  )     +    𝐮  T    (  t  )   R   (  t  )   𝐮   (  t  )   d  t    )     ,      J    E       superscript  𝐱  normal-T   T  F  𝐱  T     superscript   subscript   0   T      superscript  𝐱  normal-T   t  Q  t  𝐱  t       superscript  𝐮  normal-T   t  R  t  𝐮  t  d  t       J=E\left({\mathbf{x}^{\mathrm{T}}}(T)F{\mathbf{x}}(T)+\int_{0}^{T}{\mathbf{x}^%
 {\mathrm{T}}}(t)Q(t){\mathbf{x}}(t)+{\mathbf{u}^{\mathrm{T}}}(t)R(t){\mathbf{u%
 }}(t)\,dt\right),           F  ≥  0   ,     Q   (  t  )    ≥  0   ,    R   (  t  )    >  0     ,     formulae-sequence    F  0    formulae-sequence      Q  t   0       R  t   0      F\geq 0,\quad Q(t)\geq 0,\quad R(t)>0,     where   E   E   {\mathbf{}}E   denotes the expected value . The final time (horizon)   T   T   {\mathbf{}}T   may be either finite or infinite. If the horizon tends to infinity the first term     𝐱  T    (  T  )   F  𝐱   (  T  )        superscript  𝐱  normal-T   T  F  𝐱  T    {\mathbf{x}}^{\mathrm{T}}(T)F{\mathbf{x}}(T)   of the cost function becomes negligible and irrelevant to the problem. Also to keep the costs finite the cost function has to be taken to be    J  /  T      J  T    {\mathbf{}}J/T   .  The LQG controller that solves the LQG control problem is specified by the following equations:           𝐱  ^   ˙    (  t  )    =    A   (  t  )    𝐱  ^    (  t  )    +   B   (  t  )   𝐮   (  t  )    +   K   (  t  )    (    𝐲   (  t  )    -   C   (  t  )    𝐱  ^    (  t  )     )      ,     𝐱  ^    (  0  )    =   E   (   𝐱   (  0  )    )      ,     formulae-sequence       normal-˙   normal-^  𝐱    t       A  t   normal-^  𝐱   t     B  t  𝐮  t     K  t      𝐲  t     C  t   normal-^  𝐱   t            normal-^  𝐱   0     E    𝐱  0       \dot{\hat{\mathbf{x}}}(t)=A(t)\hat{\mathbf{x}}(t)+B(t){\mathbf{u}}(t)+K(t)%
 \left({\mathbf{y}}(t)-C(t)\hat{\mathbf{x}}(t)\right),\hat{\mathbf{x}}(0)=E%
 \left({\mathbf{x}}(0)\right),           𝐮   (  t  )    =   -   L   (  t  )    𝐱  ^    (  t  )      .        𝐮  t       L  t   normal-^  𝐱   t      {\mathbf{u}}(t)=-L(t)\hat{\mathbf{x}}(t).     The matrix    K   (  t  )       K  t    {\mathbf{}}K(t)   is called the Kalman gain of the associated Kalman filter represented by the first equation. At each time   t   t   {\mathbf{}}t   this filter generates estimates     𝐱  ^    (  t  )        normal-^  𝐱   t    \hat{\mathbf{x}}(t)   of the state    𝐱   (  t  )       𝐱  t    {\mathbf{x}}(t)   using the past measurements and inputs. The Kalman gain    K   (  t  )       K  t    {\mathbf{}}K(t)   is computed from the matrices     A   (  t  )    ,   C   (  t  )         A  t     C  t     {\mathbf{}}A(t),C(t)   , the two intensity matrices     V   (  t  )    ,   W   (  t  )         V  t     W  t     \mathbf{}V(t),W(t)   associated to the white Gaussian noises    𝐯   (  t  )       𝐯  t    \mathbf{v}(t)   and    𝐰   (  t  )       𝐰  t    \mathbf{w}(t)   and finally    E   (   𝐱   (  0  )    𝐱  T    (  0  )    )       E    𝐱  0   superscript  𝐱  normal-T   0     E\left({\mathbf{x}}(0){\mathbf{x}}^{\mathrm{T}}(0)\right)   . These five matrices determine the Kalman gain through the following associated matrix Riccati differential equation:         P  ˙    (  t  )    =      A   (  t  )   P   (  t  )    +   P   (  t  )    A  T    (  t  )     -   P   (  t  )    C  T    (  t  )    W   -  1     (  t  )   C   (  t  )   P   (  t  )     +   V   (  t  )      ,         normal-˙  P   t           A  t  P  t     P  t   superscript  A  normal-T   t      P  t   superscript  C  normal-T   t   superscript  W    1    t  C  t  P  t      V  t      \dot{P}(t)=A(t)P(t)+P(t)A^{\mathrm{T}}(t)-P(t)C^{\mathrm{T}}(t){\mathbf{}}W^{-%
 1}(t)C(t)P(t)+V(t),           P   (  0  )    =   E   (   𝐱   (  0  )    𝐱  T    (  0  )    )     .        P  0     E    𝐱  0   superscript  𝐱  normal-T   0      P(0)=E\left({\mathbf{x}}(0){\mathbf{x}}^{\mathrm{T}}(0)\right).     Given the solution      P   (  t  )    ,  0   ≤  t  ≤  T           P  t   0   t       T     P(t),0\leq t\leq T   the Kalman gain equals        K   (  t  )    =   P   (  t  )    C  T    (  t  )    W   -  1     (  t  )     .        K  t     P  t   superscript  C  normal-T   t   superscript  W    1    t     {\mathbf{}}K(t)=P(t)C^{\mathrm{T}}(t)W^{-1}(t).     The matrix    L   (  t  )       L  t    {\mathbf{}}L(t)   is called the feedback gain matrix. This matrix is determined by the matrices     A   (  t  )    ,   B   (  t  )    ,   Q   (  t  )    ,   R   (  t  )         A  t     B  t     Q  t     R  t     {\mathbf{}}A(t),B(t),Q(t),R(t)   and   F   F   {\mathbf{}}F   through the following associated matrix Riccati differential equation:        -    S  ˙    (  t  )     =       A  T    (  t  )   S   (  t  )    +   S   (  t  )   A   (  t  )     -   S   (  t  )   B   (  t  )    R   -  1     (  t  )    B  T    (  t  )   S   (  t  )     +   Q   (  t  )      ,           normal-˙  S   t             superscript  A  normal-T   t  S  t     S  t  A  t      S  t  B  t   superscript  R    1    t   superscript  B  normal-T   t  S  t      Q  t      -\dot{S}(t)=A^{\mathrm{T}}(t)S(t)+S(t)A(t)-S(t)B(t)R^{-1}(t)B^{\mathrm{T}}(t)S%
 (t)+Q(t),           S   (  T  )    =  F   .        S  T   F    {\mathbf{}}S(T)=F.     Given the solution      S   (  t  )    ,  0   ≤  t  ≤  T           S  t   0   t       T     {\mathbf{}}S(t),0\leq t\leq T   the feedback gain equals        L   (  t  )    =    R   -  1     (  t  )    B  T    (  t  )   S   (  t  )     .        L  t      superscript  R    1    t   superscript  B  normal-T   t  S  t     {\mathbf{}}L(t)=R^{-1}(t)B^{\mathrm{T}}(t)S(t).     Observe the similarity of the two matrix Riccati differential equations, the first one running forward in time, the second one running backward in time. This similarity is called duality . The first matrix Riccati differential equation solves the linear-quadratic estimation problem (LQE). The second matrix Riccati differential equation solves the linear-quadratic regulator problem (LQR). These problems are dual and together they solve the linear-quadratic-Gaussian control problem (LQG). So the LQG problem separates into the LQE and LQR problem that can be solved independently. Therefore the LQG problem is called separable .  When     A   (  t  )    ,   B   (  t  )    ,   C   (  t  )    ,   Q   (  t  )    ,   R   (  t  )         A  t     B  t     C  t     Q  t     R  t     {\mathbf{}}A(t),B(t),C(t),Q(t),R(t)   and the noise intensity matrices    V   (  t  )       V  t    \mathbf{}V(t)   ,    W   (  t  )       W  t    \mathbf{}W(t)   do not depend on   t   t   {\mathbf{}}t   and when   T   T   {\mathbf{}}T   tends to infinity the LQG controller becomes a time-invariant dynamic system. In that case both matrix Riccati differential equations may be replaced by the two associated algebraic Riccati equations .  Discrete time  Since the discrete-time LQG control problem is similar to the one in continuous-time, the description below focuses on the mathematical equations.  The discrete-time linear system equations are        𝐱   i  +  1    =     A  i    𝐱  i    +    B  i    𝐮  i    +   𝐯  i     ,       subscript  𝐱    i  1         subscript  A  i    subscript  𝐱  i       subscript  B  i    subscript  𝐮  i     subscript  𝐯  i      {\mathbf{x}}_{i+1}=A_{i}\mathbf{x}_{i}+B_{i}\mathbf{u}_{i}+\mathbf{v}_{i},           𝐲  i   =     C  i    𝐱  i    +   𝐰  i     .       subscript  𝐲  i        subscript  C  i    subscript  𝐱  i     subscript  𝐰  i      \mathbf{y}_{i}=C_{i}\mathbf{x}_{i}+\mathbf{w}_{i}.     Here   i   i   \mathbf{}i   represents the discrete time index and     𝐯  i   ,   𝐰  i       subscript  𝐯  i    subscript  𝐰  i     \mathbf{v}_{i},\mathbf{w}_{i}   represent discrete-time Gaussian white noise processes with covariance matrices     V  i   ,   W  i       subscript  V  i    subscript  W  i     \mathbf{}V_{i},W_{i}   respectively.  The quadratic cost function to be minimized is       J  =   E   (     𝐱  N  T   F   𝐱  N    +    ∑   i  =  0    N  -  1      𝐱  i  T    Q  i    𝐱  i     +    𝐮  i  T    R  i    𝐮  i     )     ,      J    E       subscript   superscript  𝐱  normal-T   N   F   subscript  𝐱  N      superscript   subscript     i  0      N  1       superscript   subscript  𝐱  i   normal-T    subscript  Q  i    subscript  𝐱  i        superscript   subscript  𝐮  i   normal-T    subscript  R  i    subscript  𝐮  i        J=E\left({\mathbf{x}}^{\mathrm{T}}_{N}F{\mathbf{x}}_{N}+\sum_{i=0}^{N-1}%
 \mathbf{x}_{i}^{\mathrm{T}}Q_{i}\mathbf{x}_{i}+\mathbf{u}_{i}^{\mathrm{T}}R_{i%
 }\mathbf{u}_{i}\right),          F  ≥  0   ,     Q  i   ≥  0   ,    R  i   >   0.        formulae-sequence    F  0    formulae-sequence     subscript  Q  i   0      subscript  R  i   0.      F\geq 0,Q_{i}\geq 0,R_{i}>0.\,     The discrete-time LQG controller is         𝐱  ^    i  +  1    =     A  i     𝐱  ^   i    +    B  i    𝐮  i    +    K  i    (    𝐲  i   -    C  i     𝐱  ^   i     )      ,     𝐱  ^   0   =   E   (   𝐱  0   )        formulae-sequence     subscript   normal-^  𝐱     i  1         subscript  A  i    subscript   normal-^  𝐱   i       subscript  B  i    subscript  𝐮  i       subscript  K  i      subscript  𝐲  i      subscript  C  i    subscript   normal-^  𝐱   i           subscript   normal-^  𝐱   0     E   subscript  𝐱  0       \hat{\mathbf{x}}_{i+1}=A_{i}\hat{\mathbf{x}}_{i}+B_{i}{\mathbf{u}}_{i}+K_{i}%
 \left({\mathbf{y}}_{i}-C_{i}{\hat{\mathbf{x}}}_{i}\right),\hat{\mathbf{x}}_{0}%
 =E({\mathbf{x}}_{0})   ,        𝐮  i   =   -    L  i     𝐱  ^   i      .       subscript  𝐮  i        subscript  L  i    subscript   normal-^  𝐱   i       \mathbf{u}_{i}=-L_{i}\hat{\mathbf{x}}_{i}.\,     The Kalman gain equals        K  i   =    P  i    C  i  T     (     C  i    P  i    C  i  T    +   W  i    )    -  1      ,       subscript  K  i      subscript  P  i    subscript   superscript  C  normal-T   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-T   i     subscript  W  i      1       {\mathbf{}}K_{i}=P_{i}C^{\mathrm{T}}_{i}(C_{i}P_{i}C^{\mathrm{T}}_{i}+W_{i})^{%
 -1},     where    P  i     subscript  P  i    {\mathbf{}}P_{i}   is determined by the following matrix Riccati difference equation that runs forward in time:         P   i  +  1    =     A  i    (    P  i   -    P  i    C  i  T     (     C  i    P  i    C  i  T    +   W  i    )    -  1     C  i    P  i     )    A  i  T    +   V  i     ,    P  0   =   E   (    𝐱  0   -    𝐱  ^   0    )     (    𝐱  0   -    𝐱  ^   0    )   T      .     formulae-sequence     subscript  P    i  1         subscript  A  i      subscript  P  i      subscript  P  i    subscript   superscript  C  normal-T   i    superscript       subscript  C  i    subscript  P  i    subscript   superscript  C  normal-T   i     subscript  W  i      1     subscript  C  i    subscript  P  i      subscript   superscript  A  normal-T   i     subscript  V  i        subscript  P  0     E     subscript  𝐱  0    subscript   normal-^  𝐱   0     superscript     subscript  𝐱  0    subscript   normal-^  𝐱   0    normal-T       P_{i+1}=A_{i}\left(P_{i}-P_{i}C^{\mathrm{T}}_{i}\left(C_{i}P_{i}C^{\mathrm{T}}%
 _{i}+W_{i}\right)^{-1}C_{i}P_{i}\right)A^{\mathrm{T}}_{i}+V_{i},P_{0}=E\left({%
 \mathbf{x}}_{0}-\hat{\mathbf{x}}_{0}\right)\left({\mathbf{x}}_{0}-\hat{\mathbf%
 {x}}_{0}\right)^{\mathrm{T}}.     The feedback gain matrix equals       L  i   =     (     B  i  T    S   i  +  1     B  i    +   R  i    )    -  1     B  i  T    S   i  +  1     A  i         subscript  L  i      superscript       subscript   superscript  B  normal-T   i    subscript  S    i  1     subscript  B  i     subscript  R  i      1     subscript   superscript  B  normal-T   i    subscript  S    i  1     subscript  A  i      {\mathbf{}}L_{i}=(B^{\mathrm{T}}_{i}S_{i+1}B_{i}+R_{i})^{-1}B^{\mathrm{T}}_{i}%
 S_{i+1}A_{i}     where    S  i     subscript  S  i    {\mathbf{}}S_{i}   is determined by the following matrix Riccati difference equation that runs backward in time:         S  i   =     A  i  T    (    S   i  +  1    -    S   i  +  1     B  i     (     B  i  T    S   i  +  1     B  i    +   R  i    )    -  1     B  i  T    S   i  +  1      )    A  i    +   Q  i     ,    S  N   =  F    .     formulae-sequence     subscript  S  i        subscript   superscript  A  normal-T   i      subscript  S    i  1       subscript  S    i  1     subscript  B  i    superscript       subscript   superscript  B  normal-T   i    subscript  S    i  1     subscript  B  i     subscript  R  i      1     subscript   superscript  B  normal-T   i    subscript  S    i  1       subscript  A  i     subscript  Q  i        subscript  S  N   F     S_{i}=A^{\mathrm{T}}_{i}\left(S_{i+1}-S_{i+1}B_{i}\left(B^{\mathrm{T}}_{i}S_{i%
 +1}B_{i}+R_{i}\right)^{-1}B^{\mathrm{T}}_{i}S_{i+1}\right)A_{i}+Q_{i},S_{N}=F.     If all the matrices in the problem formulation are time-invariant and if the horizon   N   N   {\mathbf{}}N   tends to infinity the discrete-time LQG controller becomes time-invariant. In that case the matrix Riccati difference equations may be replaced by their associated discrete-time algebraic Riccati equations . These determine the time-invarant linear-quadratic estimator and the time-invariant linear-quadratic regulator in discrete-time. To keep the costs finite instead of   J   J   {\mathbf{}}J   one has to consider    J  /  N      J  N    {\mathbf{}}J/N   in this case.  See also   Stochastic control  Witsenhausen's counterexample   References  "  Category:Optimal control  Category:Control theory  Category:Stochastic control     ↩  [ http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=19948&objectType; ;=file Associated software download from Matlab Central]. ↩  [ http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=20014&objectType; ;=FILE Associated software download from Matlab Central]. ↩  ↩  ↩  ↩  ↩   Green, Limebeer: Linear Robust Control, p. 27 ↩      
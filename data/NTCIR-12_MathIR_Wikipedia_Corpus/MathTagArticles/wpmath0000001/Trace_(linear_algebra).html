<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1411">Trace (linear algebra)</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Trace (linear algebra)</h1>
<hr/>

<p>In <a href="linear_algebra" title="wikilink">linear algebra</a>, the <strong>trace</strong> of an <em>n</em>-by-<em>n</em> <a href="square_matrix" title="wikilink">square matrix</a> <em>A</em> is defined to be the sum of the elements on the <a href="main_diagonal" title="wikilink">main diagonal</a> (the diagonal from the upper left to the lower right) of <em>A</em>, i.e.,</p>

<p>

<math display="block" id="Trace_(linear_algebra):0">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mn>11</mn>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>a</mi>
     <mn>22</mn>
    </msub>
    <mo>+</mo>
    <mi mathvariant="normal">…</mi>
    <mo>+</mo>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>n</mi>
      <mi>n</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>i</mi>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">11</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <cn type="integer">22</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>n</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A)=a_{11}+a_{22}+\dots+a_{nn}=\sum_{i=1}^{n}a_{ii}
  </annotation>
 </semantics>
</math>

 where <em>a<sub>nn</sub></em> denotes the entry on the <em>n</em>-th row and <em>n</em>-th column of <em>A</em>. The trace of a matrix is the sum of the (complex) <a href="eigenvalue" title="wikilink">eigenvalues</a>, and it is <a href="Invariants_of_tensors" title="wikilink">invariant</a> with respect to a <a href="change_of_basis" title="wikilink">change of basis</a>. This characterization can be used to define the trace of a linear operator in general. Note that the trace is only defined for a square matrix (i.e., ).</p>

<p>The trace is related to the derivative of the <a class="uri" href="determinant" title="wikilink">determinant</a> (see <a href="Jacobi's_formula" title="wikilink">Jacobi's formula</a>).</p>

<p>The term <strong>trace</strong> is a <a class="uri" href="calque" title="wikilink">calque</a> from the German <em><a href="wikt:Spur#German" title="wikilink">Spur</a></em> (<a class="uri" href="cognate" title="wikilink">cognate</a> with the English <em><a href="Wiktionary:spoor" title="wikilink">spoor</a></em>), which, as a function in mathematics, is often abbreviated to "tr".</p>
<h2 id="example">Example</h2>

<p>Let <em>A</em> be a matrix, with</p>

<p>

<math display="block" id="Trace_(linear_algebra):1">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mi>a</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>b</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>c</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>d</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>e</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>f</mi>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mi>g</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>h</mi>
      </mtd>
      <mtd columnalign="center">
       <mi>i</mi>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <matrix>
     <matrixrow>
      <ci>a</ci>
      <ci>b</ci>
      <ci>c</ci>
     </matrixrow>
     <matrixrow>
      <ci>d</ci>
      <ci>e</ci>
      <ci>f</ci>
     </matrixrow>
     <matrixrow>
      <ci>g</ci>
      <ci>h</ci>
      <ci>i</ci>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\begin{pmatrix}a&b&c\\
d&e&f\\
g&h&i\end{pmatrix}
  </annotation>
 </semantics>
</math>

.</p>

<p>Then</p>

<p>

<math display="block" id="Trace_(linear_algebra):2">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>a</mi>
    <mo>+</mo>
    <mi>e</mi>
    <mo>+</mo>
    <mi>i</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <ci>e</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A)=a+e+i
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="properties">Properties</h2>
<h3 id="basic-properties">Basic properties</h3>

<p>The trace is a <a href="linear_operator" title="wikilink">linear mapping</a>. That is,</p>

<p>

<math display="block" id="Trace_(linear_algebra):3">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mo>+</mo>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>B</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <plus></plus>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <ci>tr</ci>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A+B)=\operatorname{tr}(A)+\operatorname{tr}(B)
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Trace_(linear_algebra):4">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>c</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>c</mi>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>A</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(cA)=c\operatorname{tr}(A)
  </annotation>
 </semantics>
</math>

.</p>

<p>for all square matrices <em>A</em> and <em>B</em>, and all <a href="scalar_(mathematics)" title="wikilink">scalars</a> <em>c</em>.</p>

<p>A matrix and its <a class="uri" href="transpose" title="wikilink">transpose</a> have the same trace:</p>

<p>

<math display="block" id="Trace_(linear_algebra):5">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>A</mi>
      <mi mathvariant="normal">T</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <ci>tr</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A)=\operatorname{tr}(A^{\mathrm{T}})
  </annotation>
 </semantics>
</math>

.</p>

<p>This follows immediately from the fact that transposing a square matrix does not affect elements along the main diagonal.</p>
<h3 id="trace-of-a-product">Trace of a product</h3>

<p>The trace of a product can be rewritten as the sum of entry-wise products of elements:</p>

<p>

<math display="block" id="Trace_(linear_algebra):6">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>Y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>X</mi>
      <msup>
       <mi>Y</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>Y</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>X</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>Y</mi>
      <msup>
       <mi>X</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
     </mrow>
    </munder>
    <mrow>
     <msub>
      <mi>X</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mi>Y</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>Y</ci>
      </apply>
     </apply>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>X</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>Y</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>X</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>Y</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>i</ci>
        <ci>j</ci>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Y</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(X^{\mathrm{T}}Y)=\operatorname{tr}(XY^{\mathrm{T}})=%
\operatorname{tr}(Y^{\mathrm{T}}X)=\operatorname{tr}(YX^{\mathrm{T}})=\sum_{i,%
j}X_{ij}Y_{ij}
  </annotation>
 </semantics>
</math>

.</p>

<p>This means that the trace of a product of matrices functions similarly to a <a href="dot_product" title="wikilink">dot product</a> of vectors. For this reason, generalizations of vector operations to matrices (e.g. in <a href="matrix_calculus" title="wikilink">matrix calculus</a> and <a class="uri" href="statistics" title="wikilink">statistics</a>) often involve a trace of matrix products.</p>

<p>The trace of a product can also be written in the following forms:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>

<math display="block" id="Trace_(linear_algebra):7">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>X</mi>
       <mi mathvariant="normal">T</mi>
      </msup>
      <mi>Y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mo>∘</mo>
       <mi>Y</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mi>i</mi>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>X</ci>
       <ci>normal-T</ci>
      </apply>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <compose></compose>
       <ci>X</ci>
       <ci>Y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(X^{\mathrm{T}}Y)=\sum_{i}(X\circ Y)_{ii}
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;"><dl>
<dd><dl>
<dd>(using the <a href="Matrix_multiplication#Hadamard_product" title="wikilink">Hadamard product</a>, i.e. entry-wise product).
</dd>
</dl>
</dd>
</dl></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>

<math display="block" id="Trace_(linear_algebra):8">
 <semantics>
  <mrow>
   <mo>tr</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>vec</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mo>vec</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>X</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mo>vec</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">T</mi>
   </msup>
   <mo>vec</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <ci>tr</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>vec</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">Y</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-T</ci>
    </apply>
    <ci>vec</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">X</csymbol>
     <ci>normal-)</ci>
    </cerror>
    <eq></eq>
    <ci>vec</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">X</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <ci>normal-T</ci>
    </apply>
    <ci>vec</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Y</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(X^{\mathrm{T}}Y)=\operatorname{vec}(Y)^{\mathrm{T}}%
\operatorname{vec}(X)=\operatorname{vec}(X)^{\mathrm{T}}\operatorname{vec}(Y)
  </annotation>
 </semantics>
</math>

</p></td>
<td style="text-align: left;"><dl>
<dd><dl>
<dd>(using the <a href="vectorization_(mathematics)" title="wikilink">vectorization</a> operator).
</dd>
</dl>
</dd>
</dl></td>
</tr>
</tbody>
</table>

<p>The matrices in a trace of a product can be switched: If <em>A</em> is an <em>m</em>×<em>n</em> matrix and <em>B</em> is an <em>n</em>×<em>m</em> matrix, then</p>

<p>

<math display="block" id="Trace_(linear_algebra):9">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(AB)=\operatorname{tr}(BA)
  </annotation>
 </semantics>
</math>

.<ref>This is immediate from the definition of the <a href="matrix_product" title="wikilink">matrix product</a>:</ref></p>

<p>

<math display="block" id="Trace_(linear_algebra):10">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>m</mi>
    </munderover>
    <msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>A</mi>
       <mi>B</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>i</mi>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>m</mi>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>A</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>B</mi>
       <mrow>
        <mi>j</mi>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>i</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>B</mi>
       <mrow>
        <mi>j</mi>
        <mi>i</mi>
       </mrow>
      </msub>
      <msub>
       <mi>A</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>B</mi>
       <mi>A</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mi>j</mi>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>B</ci>
       </apply>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>m</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>j</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <apply>
          <times></times>
          <ci>j</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>m</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <apply>
          <times></times>
          <ci>j</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>A</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <times></times>
        <ci>B</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <times></times>
        <ci>j</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>B</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(AB)=\sum_{i=1}^{m}\left(AB\right)_{ii}=\sum_{i=1}^{m}\sum_{j%
=1}^{n}A_{ij}B_{ji}=\sum_{j=1}^{n}\sum_{i=1}^{m}B_{ji}A_{ij}=\sum_{j=1}^{n}%
\left(BA\right)_{jj}=\operatorname{tr}(BA)
  </annotation>
 </semantics>
</math>

.</p>

<p>Equivalently, the trace is <em>invariant under <a href="cyclic_permutation" title="wikilink">cyclic permutations</a></em>, i.e.,</p>

<p>

<math display="block" id="Trace_(linear_algebra):11">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
      <mi>C</mi>
      <mi>D</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mi>C</mi>
      <mi>D</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>C</mi>
      <mi>D</mi>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>D</mi>
      <mi>A</mi>
      <mi>B</mi>
      <mi>C</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>A</ci>
       <ci>B</ci>
       <ci>C</ci>
       <ci>D</ci>
      </apply>
     </apply>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>B</ci>
       <ci>C</ci>
       <ci>D</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>C</ci>
       <ci>D</ci>
       <ci>A</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>D</ci>
       <ci>A</ci>
       <ci>B</ci>
       <ci>C</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(ABCD)=\operatorname{tr}(BCDA)=\operatorname{tr}(CDAB)=%
\operatorname{tr}(DABC)
  </annotation>
 </semantics>
</math>

.</p>

<p>This is known as the <em>cyclic property</em>.</p>

<p>Note that arbitrary permutations are not allowed: in general,</p>

<p>

<math display="block" id="Trace_(linear_algebra):12">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
      <mi>C</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≠</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>C</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
      <ci>C</ci>
     </apply>
    </apply>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>C</ci>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(ABC)\neq\operatorname{tr}(ACB)
  </annotation>
 </semantics>
</math>

.</p>

<p>However, if products of three <a href="symmetric_matrix" title="wikilink">symmetric</a> matrices are considered, any permutation is allowed. (Proof: tr(<em>ABC</em>) = tr(<em>A</em><sup>T</sup> <em>B</em><sup>T</sup> <em>C</em><sup>T</sup>) = tr(<em>A</em><sup>T</sup>(<em>CB</em>)<sup>T</sup>) = tr((<em>CB</em>)<sup>T</sup><em>A</em><sup>T</sup>) = tr((<em>ACB</em>)<sup>T</sup>) = tr(<em>ACB</em>), where the last equality is because the traces of a matrix and its transpose are equal.) For more than three factors this is not true.</p>

<p>Unlike the <a class="uri" href="determinant" title="wikilink">determinant</a>, the trace of the product is not the product of traces. What is true is that the trace of the <a href="tensor_product" title="wikilink">tensor product</a> of two matrices is the product of their traces:</p>

<p>

<math display="block" id="Trace_(linear_algebra):13">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>X</mi>
      <mo>⊗</mo>
      <mi>Y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>tr</ci>
      <ci>X</ci>
     </apply>
     <apply>
      <ci>tr</ci>
      <ci>Y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(X\otimes Y)=\operatorname{tr}(X)\operatorname{tr}(Y)
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="other-properties">Other properties</h3>

<p>The following three properties:</p>

<p>

<math display="block" id="Trace_(linear_algebra):14">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mo>+</mo>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>B</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <plus></plus>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <ci>tr</ci>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A+B)=\operatorname{tr}(A)+\operatorname{tr}(B)
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Trace_(linear_algebra):15">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>c</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>c</mi>
    <mo>⋅</mo>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>c</ci>
      <ci>A</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <ci>c</ci>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(cA)=c\cdot\operatorname{tr}(A)
  </annotation>
 </semantics>
</math>

,</p>

<p>

<math display="block" id="Trace_(linear_algebra):16">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(AB)=\operatorname{tr}(BA)
  </annotation>
 </semantics>
</math>

,</p>

<p>characterize the trace completely in the sense that follows. Let <em>f</em> be a <a href="linear_functional" title="wikilink">linear functional</a> on the space of square matrices satisfying . Then <em>f</em> and tr are proportional.<ref>Proof:</ref></p>

<p>

<math display="block" id="Trace_(linear_algebra):17">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>e</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(e_{ij})=0
  </annotation>
 </semantics>
</math>

 if and only if 

<math display="inline" id="Trace_(linear_algebra):18">
 <semantics>
  <mrow>
   <mi>i</mi>
   <mo>≠</mo>
   <mi>j</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <ci>i</ci>
    <ci>j</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i\neq j
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trace_(linear_algebra):19">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>e</mi>
      <mrow>
       <mi>j</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>e</mi>
      <mn>11</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <apply>
       <times></times>
       <ci>j</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>e</ci>
      <cn type="integer">11</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(e_{jj})=f(e_{11})
  </annotation>
 </semantics>
</math>

 (with the standard basis 

<math display="inline" id="Trace_(linear_algebra):20">
 <semantics>
  <msub>
   <mi>e</mi>
   <mrow>
    <mi>i</mi>
    <mi>j</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>e</ci>
    <apply>
     <times></times>
     <ci>i</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{ij}
  </annotation>
 </semantics>
</math>

), and thus</p>

<p>

<math display="block" id="Trace_(linear_algebra):21">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
     </mrow>
    </munder>
    <mrow>
     <msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>A</mi>
       <mo stretchy="false">]</mo>
      </mrow>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>e</mi>
       <mrow>
        <mi>i</mi>
        <mi>j</mi>
       </mrow>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <mrow>
     <msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>A</mi>
       <mo stretchy="false">]</mo>
      </mrow>
      <mrow>
       <mi>i</mi>
       <mi>i</mi>
      </mrow>
     </msub>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>e</mi>
       <mn>11</mn>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>e</mi>
      <mn>11</mn>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>i</ci>
        <ci>j</ci>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>A</ci>
        </apply>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>i</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-[]</csymbol>
         <ci>A</ci>
        </apply>
        <apply>
         <times></times>
         <ci>i</ci>
         <ci>i</ci>
        </apply>
       </apply>
       <ci>f</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>e</ci>
        <cn type="integer">11</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <cn type="integer">11</cn>
      </apply>
      <apply>
       <ci>tr</ci>
       <ci>A</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(A)=\sum_{i,j}[A]_{ij}f(e_{ij})=\sum_{i}[A]_{ii}f(e_{11})=f(e_{11})%
\operatorname{tr}(A)
  </annotation>
 </semantics>
</math>

.</p>

<p>More abstractly, this corresponds to the decomposition 

<math display="inline" id="Trace_(linear_algebra):22">
 <semantics>
  <mrow>
   <msub>
    <mi>𝑔𝑙</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝑠𝑙</mi>
     <mi>n</mi>
    </msub>
    <mo>⊕</mo>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝑔𝑙</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝑠𝑙</ci>
      <ci>n</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathit{gl}_{n}=\mathit{sl}_{n}\oplus k
  </annotation>
 </semantics>
</math>

, as tr(<em>AB</em>) = tr(<em>BA</em>) (equivalently, 

<math display="inline" id="Trace_(linear_algebra):23">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>B</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <interval closure="closed">
      <ci>A</ci>
      <ci>B</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}([A,B])=0
  </annotation>
 </semantics>
</math>

) defines the trace on <em>sl</em><sub><em>n</em></sub>, which has complement the scalar matrices, and leaves one degree of freedom: any such map is determined by its value on scalars, which is one scalar parameter and hence all are multiple of the trace, a non-zero such map.</p>

<p>The trace is <a href="similarity_invariance" title="wikilink">similarity-invariant</a>, which means that <em>A</em> and <em>P</em><sup>−1</sup><em>AP</em> have the same trace. This is because</p>

<p>

<math display="block" id="Trace_(linear_algebra):24">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>P</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mi>A</mi>
      <mi>P</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>P</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>A</mi>
        <mi>P</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>A</mi>
        <mi>P</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msup>
       <mi>P</mi>
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>P</mi>
        <msup>
         <mi>P</mi>
         <mrow>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>P</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>A</ci>
       <ci>P</ci>
      </apply>
     </apply>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>P</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>P</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <ci>A</ci>
        <ci>P</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>P</ci>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <apply>
       <times></times>
       <ci>A</ci>
       <apply>
        <times></times>
        <ci>P</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>P</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(P^{-1}AP)=\operatorname{tr}(P^{-1}(AP))=\operatorname{tr}((%
AP)P^{-1})=\operatorname{tr}(A(PP^{-1}))=\operatorname{tr}(A)
  </annotation>
 </semantics>
</math>

.</p>

<p>If <em>A</em> is <a href="symmetric_matrix" title="wikilink">symmetric</a> and <em>B</em> is <a href="skew-symmetric_matrix" title="wikilink">antisymmetric</a>, then</p>

<p>

<math display="block" id="Trace_(linear_algebra):25">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(AB)=0
  </annotation>
 </semantics>
</math>

.</p>

<p>The trace of the <a href="identity_matrix" title="wikilink">identity matrix</a> is the dimension of the space; this leads to <a href="Dimension_(vector_space)#Trace" title="wikilink">generalizations of dimension using trace</a>. The trace of an <a href="idempotent_matrix" title="wikilink">idempotent matrix</a> <em>A</em> (for which <em>A</em><sup>2</sup> = <em>A</em>) is the <a href="rank_(linear_algebra)" title="wikilink">rank</a> of <em>A</em>. The trace of a <a href="nilpotent_matrix" title="wikilink">nilpotent matrix</a> is zero.</p>

<p>More generally, if <mtpl></mtpl> is the <a href="characteristic_polynomial" title="wikilink">characteristic polynomial</a> of a matrix <em>A</em>, then</p>

<p>

<math display="block" id="Trace_(linear_algebra):26">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>d</mi>
      <mn>1</mn>
     </msub>
     <msub>
      <mi>λ</mi>
      <mn>1</mn>
     </msub>
    </mrow>
    <mo>+</mo>
    <mi mathvariant="normal">⋯</mi>
    <mo>+</mo>
    <mrow>
     <msub>
      <mi>d</mi>
      <mi>k</mi>
     </msub>
     <msub>
      <mi>λ</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <cn type="integer">1</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-⋯</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>d</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A)=d_{1}\lambda_{1}+\cdots+d_{k}\lambda_{k}
  </annotation>
 </semantics>
</math>

.</p>

<p>When both <em>A</em> and <em>B</em> are <em>n</em>-by-<em>n</em>, the trace of the (ring-theoretic) <a class="uri" href="commutator" title="wikilink">commutator</a> of <em>A</em> and <em>B</em> vanishes: tr([<em>A</em>, <em>B</em>]) = 0; one can state this as "the trace is a map of Lie algebras 

<math display="inline" id="Trace_(linear_algebra):27">
 <semantics>
  <mrow>
   <mrow>
    <mi>g</mi>
    <msub>
     <mi>l</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>→</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <times></times>
     <ci>g</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>l</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   gl_{n}\to k
  </annotation>
 </semantics>
</math>

 from operators to scalars", as the commutator of scalars is trivial (it is an abelian Lie algebra). In particular, using similarity invariance, it follows that the identity matrix is never similar to the commutator of any pair of matrices.</p>

<p>Conversely, any square matrix with zero trace is a linear combinations of the commutators of pairs of matrices.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Moreover, any square matrix with zero trace is <a href="Bounded_operator" title="wikilink">unitarily equivalent</a> to a square matrix with diagonal consisting of all zeros.</p>

<p>The trace of any power of a <a href="nilpotent_matrix" title="wikilink">nilpotent matrix</a> is zero. When the characteristic of the base field is zero, the converse also holds: if 

<math display="inline" id="Trace_(linear_algebra):28">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>x</mi>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(x^{k})=0
  </annotation>
 </semantics>
</math>

 for all 

<math display="inline" id="Trace_(linear_algebra):29">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Trace_(linear_algebra):30">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

 is nilpotent.</p>

<p>The trace of a <a href="Hermitian_matrix" title="wikilink">Hermitian matrix</a> is real, because the elements on the diagonal are real.</p>

<p>The trace of a <a href="projection_matrix" title="wikilink">projection matrix</a> is the dimension of the target space. If</p>
<dl>
<dd><dl>
<dd>

<math display="inline" id="Trace_(linear_algebra):31">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>X</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mi>X</mi>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>X</mi>
        <mi mathvariant="normal">T</mi>
       </msup>
       <mi>X</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <msup>
     <mi>X</mi>
     <mi mathvariant="normal">T</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <times></times>
     <ci>X</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>X</ci>
        <ci>normal-T</ci>
       </apply>
       <ci>X</ci>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>X</ci>
      <ci>normal-T</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{X}=X\left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}
  </annotation>
 </semantics>
</math>

,
</dd>
</dl>
</dd>
<dd>then

<p>

<math display="block" id="Trace_(linear_algebra):32">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>P</mi>
      <mi>X</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>rank</mo>
    <mrow>
     <mo>(</mo>
     <mi>X</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>P</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <ci>rank</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}\left(P_{X}\right)=\operatorname{rank}\left(X\right)
  </annotation>
 </semantics>
</math>

.</p>
</dd>
</dl>
<h2 id="exponential-trace">Exponential trace</h2>

<p>Expressions like exp(tr(<em>A</em>)), where <em>A</em> is a square matrix, occur so often in some fields (e.g. multivariate statistical theory), that a shorthand notation has become common:</p>

<p>

<math display="block" id="Trace_(linear_algebra):33">
 <semantics>
  <mrow>
   <mrow>
    <mo>etr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>tr</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">assign</csymbol>
    <apply>
     <ci>etr</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{etr}(A):=\exp(\operatorname{tr}(A))
  </annotation>
 </semantics>
</math>

.</p>

<p>This is sometimes referred to as the <strong>exponential trace</strong> function; it is used in the <a href="Golden–Thompson_inequality" title="wikilink">Golden–Thompson inequality</a>.</p>
<h2 id="trace-of-a-linear-operator">Trace of a linear operator</h2>

<p>Given some linear map  (<em>V</em> is a finite-<a href="dimension_(linear_algebra)" title="wikilink">dimensional</a> <a href="vector_space" title="wikilink">vector space</a>) generally, we can define the trace of this map by considering the trace of <a href="Representation_theory" title="wikilink">matrix representation</a> of <em>f</em>, that is, choosing a <a href="basis_(linear_algebra)" title="wikilink">basis</a> for <em>V</em> and describing <em>f</em> as a matrix relative to this basis, and taking the trace of this square matrix. The result will not depend on the basis chosen, since different bases will give rise to <a href="matrix_similarity" title="wikilink">similar matrices</a>, allowing for the possibility of a basis-independent definition for the trace of a linear map.</p>

<p>Such a definition can be given using the <a href="natural_isomorphism" title="wikilink">canonical isomorphism</a> between the space End(<em>V</em>) of linear maps on <em>V</em> and <mtpl></mtpl>, where <em>V</em><sup>*</sup> is the <a href="dual_space" title="wikilink">dual space</a> of <em>V</em>. Let <em>v</em> be in <em>V</em> and let <em>f</em> be in <em>V</em><sup>*</sup>. Then the trace of the decomposable element  is defined to be <em>f</em>(<em>v</em>); the trace of a general element is defined by linearity. Using an explicit basis for <em>V</em> and the corresponding dual basis for <em>V</em><sup>*</sup>, one can show that this gives the same definition of the trace as given above.</p>
<h3 id="eigenvalue-relationships">Eigenvalue relationships</h3>

<p>If <em>A</em> is a square <em>n</em>-by-<em>n</em> matrix with <a href="real_number" title="wikilink">real</a> or <a href="complex_number" title="wikilink">complex</a> entries and if λ<sub>1</sub>,...,λ<sub><em>n</em></sub> are the <a href="eigenvalue" title="wikilink">eigenvalues</a> of <em>A</em> (listed according to their <a href="algebraic_multiplicity" title="wikilink">algebraic multiplicities</a>), then</p>

<p>

<math display="block" id="Trace_(linear_algebra):34">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <msub>
     <mi>λ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A)=\sum_{i}\lambda_{i}
  </annotation>
 </semantics>
</math>

.</p>

<p>This follows from the fact that <em>A</em> is always <a href="similar_matrix" title="wikilink">similar</a> to its <a href="Jordan_form" title="wikilink">Jordan form</a>, an upper <a href="triangular_matrix" title="wikilink">triangular matrix</a> having λ<sub>1</sub>,...,λ<sub><em>n</em></sub> on the main diagonal. In contrast, the <a class="uri" href="determinant" title="wikilink">determinant</a> of 

<math display="inline" id="Trace_(linear_algebra):35">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 is the <em>product</em> of its eigenvalues; i.e.,</p>

<p>

<math display="block" id="Trace_(linear_algebra):36">
 <semantics>
  <mrow>
   <mrow>
    <mo>det</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mi>i</mi>
    </munder>
    <msub>
     <mi>λ</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>det</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>λ</ci>
      <ci>i</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{det}(A)=\prod_{i}\lambda_{i}
  </annotation>
 </semantics>
</math>

.</p>

<p>More generally,</p>

<p>

<math display="block" id="Trace_(linear_algebra):37">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <msup>
      <mi>A</mi>
      <mi>k</mi>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mi>i</mi>
    </munder>
    <msubsup>
     <mi>λ</mi>
     <mi>i</mi>
     <mi>k</mi>
    </msubsup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>λ</ci>
       <ci>i</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A^{k})=\sum_{i}\lambda_{i}^{k}
  </annotation>
 </semantics>
</math>

.</p>
<h3 id="derivatives">Derivatives</h3>

<p>The trace corresponds to the derivative of the determinant: it is the <a href="Lie_algebra" title="wikilink">Lie algebra</a> analog of the (<a href="Lie_group" title="wikilink">Lie group</a>) map of the determinant. This is made precise in <a href="Jacobi's_formula" title="wikilink">Jacobi's formula</a> for the <a class="uri" href="derivative" title="wikilink">derivative</a> of the <a class="uri" href="determinant" title="wikilink">determinant</a>.</p>

<p>As a particular case, <em>at the identity</em>, the derivative of the determinant actually amounts to the trace

<math display="block" id="Trace_(linear_algebra):38">
 <semantics>
  <mrow>
   <mo>tr</mo>
   <mo>=</mo>
   <msubsup>
    <mo>det</mo>
    <mi>I</mi>
    <mo>′</mo>
   </msubsup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>tr</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>det</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>I</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}=\operatorname{det}^{\prime}_{I}
  </annotation>
 </semantics>
</math>

. From this (or from the connection between the trace and the eigenvalues), one can derive a connection between the trace function, the exponential map between a Lie algebra and its Lie group (or concretely, the <a href="matrix_exponential" title="wikilink">matrix exponential</a> function), and the <a class="uri" href="determinant" title="wikilink">determinant</a>:</p>

<p>

<math display="block" id="Trace_(linear_algebra):39">
 <semantics>
  <mrow>
   <mrow>
    <mo movablelimits="false">det</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>exp</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>exp</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo>tr</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <determinant></determinant>
     <apply>
      <exp></exp>
      <ci>A</ci>
     </apply>
    </apply>
    <apply>
     <exp></exp>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \det(\exp(A))=\exp(\operatorname{tr}(A))
  </annotation>
 </semantics>
</math>

.</p>

<p>For example, consider the one-parameter family of linear transformations given by rotation through angle θ,</p>

<p>

<math display="block" id="Trace_(linear_algebra):40">
 <semantics>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi>θ</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mrow>
         <mi>sin</mi>
         <mi>θ</mi>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mrow>
        <mi>sin</mi>
        <mi>θ</mi>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mi>cos</mi>
        <mi>θ</mi>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>R</ci>
     <ci>θ</ci>
    </apply>
    <matrix>
     <matrixrow>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <sin></sin>
        <ci>θ</ci>
       </apply>
      </apply>
     </matrixrow>
     <matrixrow>
      <apply>
       <sin></sin>
       <ci>θ</ci>
      </apply>
      <apply>
       <cos></cos>
       <ci>θ</ci>
      </apply>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R_{\theta}=\left(\begin{array}[]{cc}\cos\theta&-\sin\theta\\
\sin\theta&\cos\theta\end{array}\right)
  </annotation>
 </semantics>
</math>

.</p>

<p>These transformations all have determinant 1, so they preserve area. The derivative of this family at θ = 0, the identity rotation, is the antisymmetric matrix</p>

<p>

<math display="block" id="Trace_(linear_algebra):41">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mo>(</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
      <mtd columnalign="center">
       <mrow>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="center">
       <mn>1</mn>
      </mtd>
      <mtd columnalign="center">
       <mn>0</mn>
      </mtd>
     </mtr>
    </mtable>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <matrix>
     <matrixrow>
      <cn type="integer">0</cn>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
      </apply>
     </matrixrow>
     <matrixrow>
      <cn type="integer">1</cn>
      <cn type="integer">0</cn>
     </matrixrow>
    </matrix>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\left(\begin{array}[]{cc}0&-1\\
1&0\end{array}\right)
  </annotation>
 </semantics>
</math>

</p>

<p>which clearly has trace zero, indicating that this matrix represents an infinitesimal transformation which preserves area.</p>

<p>A related characterization of the trace applies to linear vector fields. Given a matrix <em>A</em>, define a vector field <em>F</em> on ℝ<sup><em>n</em></sup> by . The components of this vector field are linear functions (given by the rows of <em>A</em>). Its <a class="uri" href="divergence" title="wikilink">divergence</a>  is a constant function, whose value is equal to tr(<em>A</em>). By the <a href="divergence_theorem" title="wikilink">divergence theorem</a>, one can interpret this in terms of flows: if <em>F</em>(<em>x</em>) represents the velocity of a fluid at location <em>x</em> and <em>U</em> is a region in ℝ<sup><em>n</em></sup>, the <a href="flow_network" title="wikilink">net flow</a> of the fluid out of <em>U</em> is given by , where vol(<em>U</em>) is the <a class="uri" href="volume" title="wikilink">volume</a> of <em>U</em>.</p>

<p>The trace is a linear operator, hence it commutes with the derivative:</p>

<p>

<math display="block" id="Trace_(linear_algebra):42">
 <semantics>
  <mrow>
   <mrow>
    <mo>d</mo>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo rspace="0.8pt">d</mo>
      <mi>X</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-d</ci>
     <apply>
      <ci>tr</ci>
      <ci>X</ci>
     </apply>
    </apply>
    <apply>
     <ci>tr</ci>
     <apply>
      <ci>normal-d</ci>
      <ci>X</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{d}\operatorname{tr}(X)=\operatorname{tr}(\operatorname{d\!}X)
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="applications">Applications</h2>

<p>The trace of a 2-by-2 complex matrix is used to classify <a href="Möbius_transformation" title="wikilink">Möbius transformations</a>. First the matrix is normalized to make its <a class="uri" href="determinant" title="wikilink">determinant</a> equal to one. Then, if the square of the trace is 4, the corresponding transformation is <em>parabolic</em>. If the square is in the interval [0,4), it is <em>elliptic</em>. Finally, if the square is greater than 4, the transformation is <em>loxodromic</em>. See <a href="Möbius_transformation#Classification" title="wikilink">classification of Möbius transformations</a>.</p>

<p>The trace is used to define <a href="character_(mathematics)" title="wikilink">characters</a> of <a href="group_representation" title="wikilink">group representations</a>. Two representations 

<math display="inline" id="Trace_(linear_algebra):43">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>,</mo>
    <mi>B</mi>
   </mrow>
   <mo>:</mo>
   <mrow>
    <mi>G</mi>
    <mo>→</mo>
    <mrow>
     <mi>𝐺𝐿</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>V</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <list>
     <ci>A</ci>
     <ci>B</ci>
    </list>
    <apply>
     <ci>normal-→</ci>
     <ci>G</ci>
     <apply>
      <times></times>
      <ci>𝐺𝐿</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A,B:G\to\mathit{GL}(V)
  </annotation>
 </semantics>
</math>

 of a group <em>G</em> are equivalent (up to change of basis on <em>V</em>) if 

<math display="inline" id="Trace_(linear_algebra):44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>tr</mo>
     <mi>A</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo>tr</mo>
     <mi>B</mi>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>g</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
     <ci>g</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>tr</ci>
      <ci>B</ci>
     </apply>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}A(g)=\operatorname{tr}B(g)
  </annotation>
 </semantics>
</math>

 for all .</p>

<p>The trace also plays a central role in the distribution of <a href="Quadratic_form_(statistics)" title="wikilink">quadratic forms</a>.</p>
<h2 id="lie-algebra">Lie algebra</h2>

<p>The trace is a map of Lie algebras 

<math display="inline" id="Trace_(linear_algebra):45">
 <semantics>
  <mrow>
   <mo>tr</mo>
   <mo>:</mo>
   <mrow>
    <msub>
     <mi>𝑔𝑙</mi>
     <mi>n</mi>
    </msub>
    <mo>→</mo>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>tr</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝑔𝑙</ci>
      <ci>n</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}\colon\mathit{gl}_{n}\to k
  </annotation>
 </semantics>
</math>

 from the Lie algebra <em>gl</em><sub><em>n</em></sub> of operators on a <em>n</em>-dimensional space ( matrices) to the Lie algebra <em>k</em> of scalars; as <em>k</em> is abelian (the Lie bracket vanishes), the fact that this is a map of Lie algebras is exactly the statement that the trace of a bracket vanishes:</p>

<p>

<math display="block" id="Trace_(linear_algebra):46">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mo stretchy="false">[</mo>
      <mi>A</mi>
      <mo>,</mo>
      <mi>B</mi>
      <mo stretchy="false">]</mo>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <interval closure="closed">
      <ci>A</ci>
      <ci>B</ci>
     </interval>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}([A,B])=0
  </annotation>
 </semantics>
</math>

.</p>

<p>The kernel of this map, a matrix whose trace is <a href="0_(number)" title="wikilink">zero</a>, is often said to be <strong></strong> or <strong></strong>, and these matrices form the <a href="simple_Lie_algebra" title="wikilink">simple Lie algebra</a> <em>sl</em><sub><em>n</em></sub>, which is the <a href="Lie_algebra" title="wikilink">Lie algebra</a> of the <a href="special_linear_group" title="wikilink">special linear group</a> of matrices with determinant 1. The special linear group consists of the matrices which do not change volume, while the special linear algebra is the matrices which <em>infinitesimally</em> do not change volume.</p>

<p>In fact, there is an internal <a href="Direct_sum_of_Lie_algebras" title="wikilink">direct sum</a> decomposition 

<math display="inline" id="Trace_(linear_algebra):47">
 <semantics>
  <mrow>
   <msub>
    <mi>𝑔𝑙</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>𝑠𝑙</mi>
     <mi>n</mi>
    </msub>
    <mo>⊕</mo>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝑔𝑙</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝑠𝑙</ci>
      <ci>n</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathit{gl}_{n}=\mathit{sl}_{n}\oplus k
  </annotation>
 </semantics>
</math>

 of operators/matrices into traceless operators/matrices and scalars operators/matrices. The projection map onto scalar operators can be expressed in terms of the trace, concretely as:</p>

<p>

<math display="block" id="Trace_(linear_algebra):48">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>↦</mo>
   <mrow>
    <mrow>
     <mstyle displaystyle="false">
      <mfrac>
       <mn>1</mn>
       <mi>n</mi>
      </mfrac>
     </mstyle>
     <mrow>
      <mo>tr</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>A</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>⋅</mo>
    <mi>I</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <ci>A</ci>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>n</ci>
      </apply>
      <apply>
       <ci>tr</ci>
       <ci>A</ci>
      </apply>
     </apply>
     <ci>I</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\mapsto\textstyle{\frac{1}{n}}\operatorname{tr}(A)\cdot I
  </annotation>
 </semantics>
</math>

.</p>

<p>Formally, one can compose the trace (the <a class="uri" href="counit" title="wikilink">counit</a> map) with the unit map 

<math display="inline" id="Trace_(linear_algebra):49">
 <semantics>
  <mrow>
   <mi>k</mi>
   <mo>→</mo>
   <msub>
    <mi>𝑔𝑙</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <ci>k</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝑔𝑙</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k\to\mathit{gl}_{n}
  </annotation>
 </semantics>
</math>

 of "inclusion of <a href="scalar_transformation" title="wikilink">scalars</a>" to obtain a map 

<math display="inline" id="Trace_(linear_algebra):50">
 <semantics>
  <mrow>
   <msub>
    <mi>𝑔𝑙</mi>
    <mi>n</mi>
   </msub>
   <mo>→</mo>
   <msub>
    <mi>𝑔𝑙</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝑔𝑙</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝑔𝑙</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathit{gl}_{n}\to\mathit{gl}_{n}
  </annotation>
 </semantics>
</math>

 mapping onto scalars, and multiplying by <em>n</em>. Dividing by <em>n</em> makes this a projection, yielding the formula above.</p>

<p>In terms of <a href="short_exact_sequence" title="wikilink">short exact sequences</a>, one has</p>

<p>

<math display="block" id="Trace_(linear_algebra):51">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>→</mo>
   <msub>
    <mi>𝑠𝑙</mi>
    <mi>n</mi>
   </msub>
   <mo>→</mo>
   <mrow>
    <msub>
     <mi>𝑔𝑙</mi>
     <mi>n</mi>
    </msub>
    <mover accent="true">
     <mo>→</mo>
     <mo>tr</mo>
    </mover>
    <mi>k</mi>
   </mrow>
   <mo>→</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-→</ci>
     <cn type="integer">0</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝑠𝑙</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝑔𝑙</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <ci>tr</ci>
       <ci>normal-→</ci>
      </apply>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <share href="#.cmml">
     </share>
     <cn type="integer">0</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\to\mathit{sl}_{n}\to\mathit{gl}_{n}\overset{\operatorname{tr}}{\to}k\to 0
  </annotation>
 </semantics>
</math>

 which is analogous to</p>

<p>

<math display="block" id="Trace_(linear_algebra):52">
 <semantics>
  <mrow>
   <mn>1</mn>
   <mo>→</mo>
   <msub>
    <mi>𝑆𝐿</mi>
    <mi>n</mi>
   </msub>
   <mo>→</mo>
   <mrow>
    <msub>
     <mi>𝐺𝐿</mi>
     <mi>n</mi>
    </msub>
    <mover accent="true">
     <mo>→</mo>
     <mo>det</mo>
    </mover>
    <msup>
     <mi>K</mi>
     <mo>*</mo>
    </msup>
   </mrow>
   <mo>→</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <ci>normal-→</ci>
     <cn type="integer">1</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>𝑆𝐿</ci>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>𝐺𝐿</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <ci>det</ci>
       <ci>normal-→</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>K</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <share href="#.cmml">
     </share>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   1\to\mathit{SL}_{n}\to\mathit{GL}_{n}\overset{\operatorname{det}}{\to}K^{*}\to
1
  </annotation>
 </semantics>
</math>

 for Lie groups. However, the trace splits naturally (via 

<math display="inline" id="Trace_(linear_algebra):53">
 <semantics>
  <mfrac>
   <mn>1</mn>
   <mi>n</mi>
  </mfrac>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <cn type="integer">1</cn>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\frac{1}{n}}
  </annotation>
 </semantics>
</math>

 times scalars) so 

<math display="inline" id="Trace_(linear_algebra):54">
 <semantics>
  <mrow>
   <msub>
    <mi>𝑔𝑙</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>s</mi>
     <msub>
      <mi>l</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo>⊕</mo>
    <mi>k</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝑔𝑙</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <apply>
      <times></times>
      <ci>s</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>l</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathit{gl}_{n}=sl_{n}\oplus k
  </annotation>
 </semantics>
</math>

, but the splitting of the determinant would be as the <em>n</em>th root times scalars, and this does not in general define a function, so the determinant does not split and the general linear group does not decompose

<math display="block" id="Trace_(linear_algebra):55">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>𝐺𝐿</mi>
     <mi>n</mi>
    </msub>
    <mo>≠</mo>
    <mrow>
     <mrow>
      <mi>S</mi>
      <msub>
       <mi>L</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo>×</mo>
     <msup>
      <mi>K</mi>
      <mo>*</mo>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝐺𝐿</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <times></times>
      <ci>S</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>L</ci>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>K</ci>
      <times></times>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathit{GL}_{n}\neq SL_{n}\times K^{*}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="bilinear-forms">Bilinear forms</h3>

<p>The <a href="bilinear_form" title="wikilink">bilinear form</a></p>

<p>

<math display="block" id="Trace_(linear_algebra):56">
 <semantics>
  <mrow>
   <mrow>
    <mi>B</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo>,</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mo>tr</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mo>ad</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mrow>
         <mo>ad</mo>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>y</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mtext>where</mtext>
    </mrow>
    <mrow>
     <mrow>
      <mo>ad</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mi>y</mi>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">[</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>x</mi>
     <mi>y</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>y</mi>
     <mi>x</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>B</ci>
      <interval closure="open">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <apply>
        <ci>tr</ci>
        <apply>
         <times></times>
         <apply>
          <ci>ad</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <ci>ad</ci>
          <ci>y</ci>
         </apply>
        </apply>
       </apply>
       <mtext>where</mtext>
      </apply>
      <apply>
       <apply>
        <ci>ad</ci>
        <ci>x</ci>
       </apply>
       <ci>y</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <interval closure="closed">
      <ci>x</ci>
      <ci>y</ci>
     </interval>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>x</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>y</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B(x,y)=\operatorname{tr}(\operatorname{ad}(x)\operatorname{ad}(y))\text{ where%
 }\operatorname{ad}(x)y=[x,y]=xy-yx
  </annotation>
 </semantics>
</math>

</p>

<p>is called the <a href="Killing_form" title="wikilink">Killing form</a>, which is used for the classification of Lie algebras.</p>

<p>The trace defines a bilinear form:</p>

<p>

<math display="block" id="Trace_(linear_algebra):57">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>↦</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">maps-to</csymbol>
    <interval closure="open">
     <ci>x</ci>
     <ci>y</ci>
    </interval>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x,y)\mapsto\operatorname{tr}(xy)
  </annotation>
 </semantics>
</math>

</p>

<p>(<em>x</em>, <em>y</em> square matrices).</p>

<p>The form is symmetric, non-degenerate<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> and associative in the sense that:</p>

<p>

<math display="block" id="Trace_(linear_algebra):58">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>y</mi>
       <mo>,</mo>
       <mi>z</mi>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>x</mi>
       <mo>,</mo>
       <mi>y</mi>
       <mo stretchy="false">]</mo>
      </mrow>
      <mi>z</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <interval closure="closed">
       <ci>y</ci>
       <ci>z</ci>
      </interval>
     </apply>
    </apply>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <interval closure="closed">
       <ci>x</ci>
       <ci>y</ci>
      </interval>
      <ci>z</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(x[y,z])=\operatorname{tr}([x,y]z)
  </annotation>
 </semantics>
</math>

.</p>

<p>For a complex simple Lie algebra (e.g., 

<math display="inline" id="Trace_(linear_algebra):59">
 <semantics>
  <mrow>
   <mi>𝔰</mi>
   <msub>
    <mi>𝔩</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔰</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔩</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{sl}_{n}
  </annotation>
 </semantics>
</math>

), every such bilinear form is proportional to each other; in particular, to the Killing form.</p>

<p>Two matrices <em>x</em> and <em>y</em> are said to be <em>trace orthogonal</em> if</p>

<p>

<math display="block" id="Trace_(linear_algebra):60">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mi>y</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>x</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(xy)=0
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="inner-product">Inner product</h2>

<p>For an <em>m</em>-by-<em>n</em> matrix <em>A</em> with complex (or real) entries and <sup>*</sup> being the conjugate transpose, we have</p>

<p>

<math display="block" id="Trace_(linear_algebra):61">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>A</mi>
       <mo>*</mo>
      </msup>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≥</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <geq></geq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <times></times>
      </apply>
      <ci>A</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A^{*}A)\geq 0
  </annotation>
 </semantics>
</math>

</p>

<p>with equality if and only if . The assignment</p>

<p>

<math display="block" id="Trace_(linear_algebra):62">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">⟨</mo>
    <mi>A</mi>
    <mo>,</mo>
    <mi>B</mi>
    <mo stretchy="false">⟩</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>B</mi>
       <mo>*</mo>
      </msup>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <list>
     <ci>A</ci>
     <ci>B</ci>
    </list>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>B</ci>
       <times></times>
      </apply>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle A,B\rangle=\operatorname{tr}(B^{*}A)
  </annotation>
 </semantics>
</math>

</p>

<p>yields an <a href="inner_product" title="wikilink">inner product</a> on the space of all complex (or real) <em>m</em>-by-<em>n</em> matrices.</p>

<p>The <a href="norm_(mathematics)" title="wikilink">norm</a> induced by the above inner product is called the <a href="Frobenius_norm" title="wikilink">Frobenius norm</a>. Indeed it is simply the <a href="Euclidean_norm" title="wikilink">Euclidean norm</a> if the matrix is considered as a vector of length <em>m</em> <em>n</em>.</p>

<p>It follows that if <em>A</em> and <em>B</em> are <a href="Positive_definite_matrix" title="wikilink">positive semi-definite matrices</a> of the same size then</p>

<p>

<math display="block" id="Trace_(linear_algebra):63">
 <semantics>
  <mrow>
   <mn>0</mn>
   <mo>≤</mo>
   <mo>tr</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mi>B</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>≤</mo>
   <mo>tr</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>A</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>tr</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <msup>
     <mi>B</mi>
     <mn>2</mn>
    </msup>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>≤</mo>
   <mo>tr</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo>tr</mo>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>B</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <cn type="integer">0</cn>
    <leq></leq>
    <ci>tr</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">A</csymbol>
      <csymbol cd="unknown">B</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cn type="integer">2</cn>
    </apply>
    <leq></leq>
    <ci>tr</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>A</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <ci>tr</ci>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>B</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-)</ci>
    </cerror>
    <leq></leq>
    <ci>tr</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">A</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cn type="integer">2</cn>
    </apply>
    <ci>tr</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">B</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <cn type="integer">2</cn>
    </apply>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   0\leq\operatorname{tr}(AB)^{2}\leq\operatorname{tr}(A^{2})\operatorname{tr}(B^%
{2})\leq\operatorname{tr}(A)^{2}\operatorname{tr}(B)^{2}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h2 id="generalization">Generalization</h2>

<p>The concept of trace of a matrix is generalised to the <a href="trace_class" title="wikilink">trace class</a> of <a href="compact_operator" title="wikilink">compact operators</a> on <a href="Hilbert_space" title="wikilink">Hilbert spaces</a>, and the analog of the Frobenius norm is called the <a href="Hilbert–Schmidt_operator" title="wikilink">Hilbert–Schmidt</a> norm.</p>

<p>The <a href="partial_trace" title="wikilink">partial trace</a> is another generalization of the trace that is operator-valued. The trace of a linear operator 

<math display="inline" id="Trace_(linear_algebra):64">
 <semantics>
  <mi>Z</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Z</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Z
  </annotation>
 </semantics>
</math>

 which lives on a product space 

<math display="inline" id="Trace_(linear_algebra):65">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>⊗</mo>
   <mi>B</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>A</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A\otimes B
  </annotation>
 </semantics>
</math>

 is equal to the partial traces over 

<math display="inline" id="Trace_(linear_algebra):66">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trace_(linear_algebra):67">
 <semantics>
  <mi>B</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>B</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B
  </annotation>
 </semantics>
</math>



<math display="block" id="Trace_(linear_algebra):68">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>Z</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo>tr</mo>
     <mi>A</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mo>tr</mo>
       <mi>B</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo>tr</mo>
     <mi>B</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mo>tr</mo>
       <mi>A</mi>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>Z</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>tr</ci>
      <ci>Z</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>tr</ci>
       <ci>A</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>tr</ci>
        <ci>B</ci>
       </apply>
       <ci>Z</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>tr</ci>
       <ci>B</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>tr</ci>
        <ci>A</ci>
       </apply>
       <ci>Z</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(Z)=\operatorname{tr}_{A}(\operatorname{tr}_{B}(Z))=%
\operatorname{tr}_{B}(\operatorname{tr}_{A}(Z))
  </annotation>
 </semantics>
</math>

.</p>

<p>If <em>A</em> is a general <a href="associative_algebra" title="wikilink">associative algebra</a> over a field <em>k</em>, then a trace on <em>A</em> is often defined to be any map tr:  which vanishes on commutators:  for all . Such a trace is not uniquely defined; it can always at least be modified by multiplication by a nonzero scalar.</p>

<p>A <a class="uri" href="supertrace" title="wikilink">supertrace</a> is the generalization of a trace to the setting of <a href="superalgebra" title="wikilink">superalgebras</a>.</p>

<p>The operation of <a href="tensor_contraction" title="wikilink">tensor contraction</a> generalizes the trace to arbitrary tensors.</p>
<h2 id="coordinate-free-definition">Coordinate-free definition</h2>

<p>We can identify the space of linear operators on a vector space <em>V</em> with the space 

<math display="inline" id="Trace_(linear_algebra):69">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mo>⊗</mo>
   <msup>
    <mi>V</mi>
    <mo>*</mo>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <ci>V</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>V</ci>
     <times></times>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V\otimes V^{*}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Trace_(linear_algebra):70">
 <semantics>
  <mrow>
   <mi>v</mi>
   <mo>⊗</mo>
   <mi>h</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>w</mi>
    <mo>↦</mo>
    <mi>h</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>w</mi>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>v</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <csymbol cd="unknown">v</csymbol>
    <csymbol cd="latexml">tensor-product</csymbol>
    <csymbol cd="unknown">h</csymbol>
    <eq></eq>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">w</csymbol>
     <csymbol cd="latexml">maps-to</csymbol>
     <csymbol cd="unknown">h</csymbol>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <ci>normal-(</ci>
      <csymbol cd="unknown">w</csymbol>
      <ci>normal-)</ci>
     </cerror>
     <csymbol cd="unknown">v</csymbol>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v\otimes h=(w\mapsto h(w)v)
  </annotation>
 </semantics>
</math>

. We also have a canonical bilinear function 

<math display="inline" id="Trace_(linear_algebra):71">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mo>×</mo>
     <msup>
      <mi>V</mi>
      <mo>*</mo>
     </msup>
    </mrow>
    <mo>→</mo>
    <mi>F</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>t</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <times></times>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <times></times>
      </apply>
     </apply>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t\colon V\times V^{*}\to F
  </annotation>
 </semantics>
</math>

 that consists of applying an element <em>w</em><sup>*</sup> of <em>V</em><sup>*</sup> to an element <em>v</em> of <em>V</em> to get an element of <em>F</em>, in symbols 

<math display="inline" id="Trace_(linear_algebra):72">
 <semantics>
  <mrow>
   <mrow>
    <mi>t</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo>,</mo>
     <msup>
      <mi>w</mi>
      <mo>*</mo>
     </msup>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>:=</mo>
   <mrow>
    <msup>
     <mi>w</mi>
     <mo>*</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>v</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∈</mo>
   <mi>F</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <csymbol cd="latexml">assign</csymbol>
     <apply>
      <times></times>
      <ci>t</ci>
      <interval closure="open">
       <ci>v</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>w</ci>
        <times></times>
       </apply>
      </interval>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>w</ci>
       <times></times>
      </apply>
      <ci>v</ci>
     </apply>
    </apply>
    <apply>
     <in></in>
     <share href="#.cmml">
     </share>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(v,w^{*}):=w^{*}(v)\in F
  </annotation>
 </semantics>
</math>

. This induces a linear function on the <a href="tensor_product" title="wikilink">tensor product</a> (by <a href="Tensor_product#Characterization_by_a_universal_property" title="wikilink">its universal property</a>) 

<math display="inline" id="Trace_(linear_algebra):73">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>:</mo>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mo>⊗</mo>
     <msup>
      <mi>V</mi>
      <mo>*</mo>
     </msup>
    </mrow>
    <mo>→</mo>
    <mi>F</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-:</ci>
    <ci>t</ci>
    <apply>
     <ci>normal-→</ci>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <times></times>
      </apply>
     </apply>
     <ci>F</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t\colon V\otimes V^{*}\to F
  </annotation>
 </semantics>
</math>

, which, as it turns out, when that tensor product is viewed as the space of operators, is equal to the trace.</p>

<p>This also clarifies why 

<math display="inline" id="Trace_(linear_algebra):74">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(AB)=\operatorname{tr}(BA)
  </annotation>
 </semantics>
</math>

 and why 

<math display="inline" id="Trace_(linear_algebra):75">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≠</mo>
   <mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>B</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <ci>tr</ci>
      <ci>B</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(AB)\neq\operatorname{tr}(A)\operatorname{tr}(B)
  </annotation>
 </semantics>
</math>

, as composition of operators (multiplication of matrices) and trace can be interpreted as <em>the same</em> pairing. Viewing 

<math display="inline" id="Trace_(linear_algebra):76">
 <semantics>
  <mrow>
   <mrow>
    <mo>End</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>V</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>≅</mo>
   <mrow>
    <mi>V</mi>
    <mo>⊗</mo>
    <msup>
     <mi>V</mi>
     <mo>*</mo>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <ci>End</ci>
     <ci>V</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <ci>V</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <times></times>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{End}(V)\cong V\otimes V^{*}
  </annotation>
 </semantics>
</math>

, one may interpret the composition map 

<math display="inline" id="Trace_(linear_algebra):77">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>End</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>V</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>×</mo>
    <mrow>
     <mo>End</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>V</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>→</mo>
   <mrow>
    <mo>End</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>V</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <times></times>
     <apply>
      <ci>End</ci>
      <ci>V</ci>
     </apply>
     <apply>
      <ci>End</ci>
      <ci>V</ci>
     </apply>
    </apply>
    <apply>
     <ci>End</ci>
     <ci>V</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{End}(V)\times\operatorname{End}(V)\to\operatorname{End}(V)
  </annotation>
 </semantics>
</math>

 as</p>

<p>

<math display="block" id="Trace_(linear_algebra):78">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>V</mi>
      <mo>⊗</mo>
      <msup>
       <mi>V</mi>
       <mo>*</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>×</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>V</mi>
      <mo>⊗</mo>
      <msup>
       <mi>V</mi>
       <mo>*</mo>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>→</mo>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>V</mi>
     <mo>⊗</mo>
     <msup>
      <mi>V</mi>
      <mo>*</mo>
     </msup>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <times></times>
      </apply>
     </apply>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <ci>V</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <times></times>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (V\otimes V^{*})\times(V\otimes V^{*})\to(V\otimes V^{*})
  </annotation>
 </semantics>
</math>

 coming from the pairing 

<math display="inline" id="Trace_(linear_algebra):79">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>V</mi>
     <mo>*</mo>
    </msup>
    <mo>×</mo>
    <mi>V</mi>
   </mrow>
   <mo>→</mo>
   <mi>F</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-→</ci>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>V</ci>
      <times></times>
     </apply>
     <ci>V</ci>
    </apply>
    <ci>F</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V^{*}\times V\to F
  </annotation>
 </semantics>
</math>

 on the middle terms. Taking the trace of the product then comes from pairing on the outer terms, while taking the product in the opposite order and then taking the trace just switches which pairing is applied first. On the other hand, taking the trace of <em>A</em> and the trace of <em>B</em> corresponds to applying the pairing on the left terms and on the right terms (rather than on inner and outer), and is thus different.</p>

<p>In coordinates, this corresponds to indexes: multiplication is given by 

<math display="inline" id="Trace_(linear_algebra):80">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mi>i</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>j</mi>
    </msub>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mi>b</mi>
      <mrow>
       <mi>j</mi>
       <mi>k</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>j</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{(AB)_{ik}=\sum_{j}a_{ij}b_{jk}}
  </annotation>
 </semantics>
</math>

, so 

<math display="inline" id="Trace_(linear_algebra):81">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>A</mi>
      <mi>B</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mi>b</mi>
      <mrow>
       <mi>j</mi>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>A</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\operatorname{tr}(AB)=\sum_{ij}a_{ij}b_{ji}}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Trace_(linear_algebra):82">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <msub>
      <mi>b</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>j</mi>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <ci>B</ci>
      <ci>A</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>b</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>j</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\operatorname{tr}(BA)=\sum_{ij}b_{ij}a_{ji}}
  </annotation>
 </semantics>
</math>

 which is the same, while 

<math display="inline" id="Trace_(linear_algebra):83">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>A</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⋅</mo>
    <mrow>
     <mo>tr</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>B</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">∑</mo>
     <mi>i</mi>
    </msub>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>i</mi>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo>⋅</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">∑</mo>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>b</mi>
       <mrow>
        <mi>j</mi>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <ci>tr</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <ci>tr</ci>
      <ci>B</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>i</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <ci>j</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>b</ci>
        <apply>
         <times></times>
         <ci>j</ci>
         <ci>j</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle{\operatorname{tr}(A)\cdot\operatorname{tr}(B)=\sum_{i}a_{ii}\cdot%
\sum_{j}b_{jj}}
  </annotation>
 </semantics>
</math>

, which is different.</p>

<p>For 

<math display="inline" id="Trace_(linear_algebra):84">
 <semantics>
  <mi>V</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>V</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V
  </annotation>
 </semantics>
</math>

 finite-dimensional, with basis 

<math display="inline" id="Trace_(linear_algebra):85">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msub>
    <mi>e</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <ci>i</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{e_{i}\}
  </annotation>
 </semantics>
</math>

 and dual basis 

<math display="inline" id="Trace_(linear_algebra):86">
 <semantics>
  <mrow>
   <mo stretchy="false">{</mo>
   <msup>
    <mi>e</mi>
    <mi>i</mi>
   </msup>
   <mo stretchy="false">}</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <set>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <ci>i</ci>
    </apply>
   </set>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \{e^{i}\}
  </annotation>
 </semantics>
</math>

, then 

<math display="inline" id="Trace_(linear_algebra):87">
 <semantics>
  <mrow>
   <msub>
    <mi>e</mi>
    <mi>i</mi>
   </msub>
   <mo>⊗</mo>
   <msup>
    <mi>e</mi>
    <mi>j</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">tensor-product</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>e</ci>
     <ci>i</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <ci>j</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   e_{i}\otimes e^{j}
  </annotation>
 </semantics>
</math>

 is the <em>ij</em>'-entry of the matrix of the operator with respect to that basis. Any operator 

<math display="inline" id="Trace_(linear_algebra):88">
 <semantics>
  <mi>A</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>A</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A
  </annotation>
 </semantics>
</math>

 is therefore a sum of the form 

<math display="inline" id="Trace_(linear_algebra):89">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>a</mi>
      <mrow>
       <mi>i</mi>
       <mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mi>e</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>⊗</mo>
    <msup>
     <mi>e</mi>
     <mi>j</mi>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <csymbol cd="latexml">tensor-product</csymbol>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>a</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <ci>i</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <ci>j</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=a_{ij}e_{i}\otimes e^{j}
  </annotation>
 </semantics>
</math>

. With 

<math display="inline" id="Trace_(linear_algebra):90">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 defined as above, 

<math display="inline" id="Trace_(linear_algebra):91">
 <semantics>
  <mrow>
   <mrow>
    <mi>t</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>A</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>a</mi>
     <mrow>
      <mi>i</mi>
      <mi>j</mi>
     </mrow>
    </msub>
    <mi>t</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>e</mi>
       <mi>i</mi>
      </msub>
      <mo>⊗</mo>
      <msup>
       <mi>e</mi>
       <mi>j</mi>
      </msup>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>a</ci>
      <apply>
       <times></times>
       <ci>i</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>t</ci>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>e</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(A)=a_{ij}t(e_{i}\otimes e^{j})
  </annotation>
 </semantics>
</math>

. The latter, however, is just the <a href="Kronecker_delta" title="wikilink">Kronecker delta</a>, being 1 if  and 0 otherwise. This shows that 

<math display="inline" id="Trace_(linear_algebra):92">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>A</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>t</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t(A)
  </annotation>
 </semantics>
</math>

 is simply the sum of the coefficients along the diagonal. This method, however, makes coordinate invariance an immediate consequence of the definition.</p>
<h3 id="dual">Dual</h3>

<p>Further, one may dualize this map, obtaining a map 

<math display="inline" id="Trace_(linear_algebra):93">
 <semantics>
  <mrow>
   <msup>
    <mi>F</mi>
    <mo>*</mo>
   </msup>
   <mo>=</mo>
   <mi>F</mi>
   <mo>→</mo>
   <mrow>
    <mi>V</mi>
    <mo>⊗</mo>
    <msup>
     <mi>V</mi>
     <mo>*</mo>
    </msup>
   </mrow>
   <mo>≅</mo>
   <mrow>
    <mo>End</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>V</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>F</ci>
      <times></times>
     </apply>
     <ci>F</ci>
    </apply>
    <apply>
     <ci>normal-→</ci>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">tensor-product</csymbol>
      <ci>V</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>V</ci>
       <times></times>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <apply>
      <ci>End</ci>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F^{*}=F\to V\otimes V^{*}\cong\operatorname{End}(V)
  </annotation>
 </semantics>
</math>

. This map is precisely the inclusion of <a href="scalar_transformation" title="wikilink">scalars</a>, sending  to the identity matrix: "trace is dual to scalars". In the language of <a href="bialgebra" title="wikilink">bialgebras</a>, scalars are the <em>unit</em>, while trace is the <em><a class="uri" href="counit" title="wikilink">counit</a></em>.</p>

<p>One can then compose these, 

<math display="inline" id="Trace_(linear_algebra):94">
 <semantics>
  <mrow>
   <mi>F</mi>
   <mover accent="true">
    <mo>→</mo>
    <mo>𝐼</mo>
   </mover>
   <mrow>
    <mrow>
     <mo>End</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>V</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mrow>
     <mover accent="true">
      <mo>→</mo>
      <mo>tr</mo>
     </mover>
     <mi>F</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>F</ci>
    <apply>
     <ci>I</ci>
     <ci>normal-→</ci>
    </apply>
    <apply>
     <apply>
      <ci>End</ci>
      <ci>V</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>tr</ci>
       <ci>normal-→</ci>
      </apply>
      <ci>F</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F\overset{I}{\to}\operatorname{End}(V)\overset{\operatorname{tr}}{\to}F
  </annotation>
 </semantics>
</math>

, which yields multiplication by <em>n</em>, as the trace of the identity is the dimension of the vector space.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Scalar_curvature#Definition" title="wikilink">Trace of a tensor with respect to a metric tensor</a></li>
<li><a href="Characteristic_function_(probability_theory)#Matrix-valued_random_variables" title="wikilink">Characteristic function</a></li>
<li><a href="Field_trace" title="wikilink">Field trace</a></li>
<li><a href="Golden–Thompson_inequality" title="wikilink">Golden–Thompson inequality</a></li>
<li><a href="Specht's_theorem" title="wikilink">Specht's theorem</a></li>
<li><a href="Trace_class" title="wikilink">Trace class</a></li>
<li><a href="Trace_inequalities" title="wikilink">Trace inequalities</a></li>
<li><a href="von_Neumann's_trace_inequality" title="wikilink">von Neumann's trace inequality</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Linear_algebra" title="wikilink">Category:Linear algebra</a> <a href="Category:Matrix_theory" title="wikilink">Category:Matrix theory</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">Proof

<math display="block" id="Trace_(linear_algebra):95">
 <semantics>
  <mrow>
   <mi>𝔰</mi>
   <msub>
    <mi>𝔩</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>𝔰</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>𝔩</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathfrak{sl}_{n}
  </annotation>
 </semantics>
</math>

 is a <a href="semisimple_Lie_algebra" title="wikilink">semisimple Lie algebra</a> and thus every element in it is a linear combination of commutators of some pairs of elements, otherwise the <a href="derived_algebra" title="wikilink">derived algebra</a> would be a proper ideal.<a href="#fnref1">↩</a></li>
<li id="fn2">This follows from the fact that 

<math display="inline" id="Trace_(linear_algebra):96">
 <semantics>
  <mrow>
   <mrow>
    <mo>tr</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msup>
       <mi>A</mi>
       <mo>*</mo>
      </msup>
      <mi>A</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>tr</ci>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>A</ci>
       <times></times>
      </apply>
      <ci>A</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{tr}(A^{*}A)=0
  </annotation>
 </semantics>
</math>

 if and only if 

<math display="inline" id="Trace_(linear_algebra):97">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=0
  </annotation>
 </semantics>
</math>

<a href="#fnref2">↩</a></li>
<li id="fn3">Can be proven with the <a href="Cauchy–Schwarz_inequality" title="wikilink">Cauchy–Schwarz inequality</a>.<a href="#fnref3">↩</a></li>
</ol>
</section>
</body>
</html>

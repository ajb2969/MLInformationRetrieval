<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1977">Ulam spiral</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Ulam spiral</h1>
<hr/>

<p> The <strong>Ulam spiral</strong>, or <strong>prime spiral</strong> (in other languages also called the <strong>Ulam Cloth</strong>) is a simple method of visualizing the <a href="prime_number" title="wikilink">prime numbers</a> that reveals the apparent tendency of certain quadratic polynomials to generate unusually large numbers of primes. It was discovered by the <a class="uri" href="mathematician" title="wikilink">mathematician</a> <a href="Stanislaw_Ulam" title="wikilink">Stanislaw Ulam</a> in 1963, while he was <a href="Doodle" title="wikilink">doodling</a> during the presentation of a "long and very boring paper" at a scientific meeting. Shortly afterwards, in an early application of computer graphics, Ulam with collaborators Myron Stein and Mark Wells used <a href="MANIAC_II" title="wikilink">MANIAC II</a> at <a href="Los_Alamos_National_Laboratory" title="wikilink">Los Alamos Scientific Laboratory</a> to produce pictures of the spiral for numbers up to 65,000. In March of the following year, <a href="Martin_Gardner" title="wikilink">Martin Gardner</a> wrote about the Ulam spiral in his <em><a href="Recreational_mathematics" title="wikilink">Mathematical Games</a></em> column; the Ulam spiral featured on the front cover of the issue of <em><a href="Scientific_American" title="wikilink">Scientific American</a></em> in which the column appeared.</p>

<p>In an addendum to the <em>Scientific American</em> column, Gardner mentions work of the <a class="uri" href="herpetologist" title="wikilink">herpetologist</a> <a href="Laurence_Monroe_Klauber" title="wikilink">Laurence M. Klauber</a> on two dimensional arrays of prime numbers for finding prime-rich quadratic polynomials which was presented at a meeting of the <a href="Mathematical_Association_of_America" title="wikilink">Mathematical Association of America</a> in 1932—more than thirty years prior to Ulam's discovery. Unlike Ulam's array, Klauber's was not a spiral. Its shape was also triangular rather than square.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h2 id="construction">Construction</h2>

<p>Ulam constructed the spiral by writing down a regular <a href="rectangle" title="wikilink">rectangular</a> <a href="Lattice_graph" title="wikilink">grid</a> of numbers, starting with 1 at the center, and <a href="spiral" title="wikilink">spiraling</a> out:</p>
<figure><b>(Figure)</b>
<figcaption>Numbers from 1 to 49 placed in spiral order</figcaption>
</figure>

<p>He then circled all of the prime numbers and he got the following picture:</p>
<figure><b>(Figure)</b>
<figcaption>Small Ulam spiral</figcaption>
</figure>

<p>To his surprise, the circled numbers tended to line up along <a class="uri" href="diagonal" title="wikilink">diagonal</a> lines. In the 200×200 Ulam spiral shown above, diagonal lines are clearly visible, confirming the pattern. Horizontal and vertical lines, while less prominent, are also evident.</p>

<p>All prime numbers, except for the number 2, are odd numbers. Since in the Ulam spiral adjacent diagonals are alternatively odd and even numbers, it is no surprise that all prime numbers lie in alternate diagonals of the Ulam spiral. What is startling is the tendency of prime numbers to lie on some diagonals more than others.</p>

<p>Tests so far confirm that there are diagonal lines even when many numbers are plotted. The pattern also seems to appear even if the number at the center is not 1 (and can, in fact, be much larger than 1). This implies that there are many integer constants <em>b</em> and <em>c</em> such that the <a href="Function_(mathematics)" title="wikilink">function</a>:</p>

<p>

<math display="block" id="Ulam_spiral:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>4</mn>
     <msup>
      <mi>n</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <mi>n</mi>
    </mrow>
    <mo>+</mo>
    <mi>c</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">4</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>n</ci>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(n)=4n^{2}+bn+c
  </annotation>
 </semantics>
</math>

</p>

<p>generates, as <em>n</em> counts up {1, 2, 3, ...}, a number of primes that is large by comparison with the proportion of primes among numbers of similar magnitude.</p>

<p>In a passage from his 1956 novel <em><a href="The_City_and_the_Stars" title="wikilink">The City and the Stars</a></em>, author <a href="Arthur_C._Clarke" title="wikilink">Arthur C. Clarke</a> describes the prime spiral seven years before it was discovered by Ulam. Clarke did not notice the pattern revealed by the prime spiral because he never actually performed the experiment.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="hardy-and-littlewoods-conjecture-f">Hardy and Littlewood's Conjecture F</h2>

<p>In their 1923 paper on the <a href="Goldbach's_conjecture" title="wikilink">Goldbach Conjecture</a>, <a href="G._H._Hardy" title="wikilink">Hardy</a> and <a href="John_Edensor_Littlewood" title="wikilink">Littlewood</a> stated a series of conjectures, one of which, if true, would explain some of the striking features of the Ulam spiral. This conjecture, which Hardy and Littlewood called "Conjecture F", is a special case of the <a href="Bateman–Horn_conjecture" title="wikilink">Bateman–Horn conjecture</a> and asserts an asymptotic formula for the number of primes of the form <em>ax</em><sup>2</sup> + <em>bx</em> + <em>c</em>. Rays emanating from the central region of the Ulam spiral making angles of 45° with the horizontal and vertical correspond to numbers of the form 4<em>x</em><sup>2</sup> + <em>bx</em> + <em>c</em> with <em>b</em> even; horizontal and vertical rays correspond to numbers of the same form with <em>b</em> odd. Conjecture F provides a formula that can be used to estimate the density of primes along such rays. It implies that there will be considerable variability in the density along different rays. In particular, the density is highly sensitive to the <a class="uri" href="discriminant" title="wikilink">discriminant</a> of the polynomial, <em>b</em><sup>2</sup> − 16<em>c</em>.</p>

<p> Conjecture F is concerned with polynomials of the form <em>ax</em><sup>2</sup> + <em>bx</em> + <em>c</em> where <em>a</em>, <em>b</em>, and <em>c</em> are integers and <em>a</em> is positive. If the coefficients contain a common factor greater than 1 or if the discriminant Δ = <em>b</em><sup>2</sup> − 4<em>ac</em> is a <a href="square_number" title="wikilink">perfect square</a>, the polynomial factorizes and therefore produces <a href="composite_numbers" title="wikilink">composite numbers</a> as <em>x</em> takes the values 0, 1, 2, ... (except possibly for one or two values of <em>x</em> where one of the factors equals 1). Moreover, if <em>a</em> + <em>b</em> and <em>c</em> are both even, the polynomial produces only even values, and is therefore composite except possibly for the value 2. Hardy and Littlewood assert that, apart from these situations, <em>ax</em><sup>2</sup> + <em>bx</em> + <em>c</em> takes prime values infinitely often as <em>x</em> takes the values 0, 1, 2, ... This statement is a special case of an earlier <a href="Bunyakovsky_conjecture" title="wikilink">conjecture of Bunyakovsky</a> and remains open. Hardy and Littlewood further assert that, asymptotically, the number <em>P</em>(<em>n</em>) of primes of the form <em>ax</em><sup>2</sup> + <em>bx</em> + <em>c</em> and less than <em>n</em> is given by</p>

<p>

<math display="block" id="Ulam_spiral:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>P</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>n</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>∼</mo>
   <mrow>
    <mi>A</mi>
    <mfrac>
     <mn>1</mn>
     <msqrt>
      <mi>a</mi>
     </msqrt>
    </mfrac>
    <mfrac>
     <msqrt>
      <mi>n</mi>
     </msqrt>
     <mrow>
      <mi>log</mi>
      <mi>n</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <apply>
     <times></times>
     <ci>P</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <times></times>
     <ci>A</ci>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <root></root>
       <ci>n</ci>
      </apply>
      <apply>
       <log></log>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P(n)\sim A\frac{1}{\sqrt{a}}\frac{\sqrt{n}}{\log n}
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>A</em> depends on <em>a</em>, <em>b</em>, and <em>c</em> but not on <em>n</em>. By the <a href="prime_number_theorem" title="wikilink">prime number theorem</a>, this formula with <em>A</em> set equal to one is the asymptotic number of primes less than <em>n</em> expected in a random set of numbers having the same density as the set of numbers of the form <em>ax</em><sup>2</sup> + <em>bx</em> + <em>c</em>. But since <em>A</em> can take values bigger or smaller than 1, some polynomials, according to the conjecture, will be especially rich in primes, and others especially poor. An unusually rich polynomial is 4<em>x</em><sup>2</sup> − 2<em>x</em> + 41 which forms a visible line in the Ulam spiral. The constant <em>A</em> for this polynomial is approximately 6.6, meaning that the numbers it generates are almost seven times as likely to be prime as random numbers of comparable size, according to the conjecture. This particular polynomial is related to Euler's <a href="Formula_for_primes#Prime_formulas_and_polynomial_functions" title="wikilink">prime-generating polynomial</a> <em>x</em><sup>2</sup> − <em>x</em> + 41 by replacing <em>x</em> with 2<em>x</em>, or equivalently, by restricting <em>x</em> to the even numbers. Hardy and Littlewood's formula for the constant <em>A</em> is</p>

<p>

<math display="block" id="Ulam_spiral:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>A</mi>
    <mo>=</mo>
    <mrow>
     <mi>ε</mi>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
       <mi>p</mi>
      </munder>
      <mrow>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mi>p</mi>
         <mrow>
          <mi>p</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mrow>
        <munder>
         <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
         <mi>ϖ</mi>
        </munder>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mrow>
           <mfrac>
            <mn>1</mn>
            <mrow>
             <mi>ϖ</mi>
             <mo>-</mo>
             <mn>1</mn>
            </mrow>
           </mfrac>
           <mrow>
            <mo>(</mo>
            <mfrac>
             <mi mathvariant="normal">Δ</mi>
             <mi>ϖ</mi>
            </mfrac>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <times></times>
     <ci>ε</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <csymbol cd="latexml">product</csymbol>
       <ci>p</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <ci>p</ci>
        <apply>
         <minus></minus>
         <ci>p</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <csymbol cd="latexml">product</csymbol>
         <ci>ϖ</ci>
        </apply>
        <apply>
         <minus></minus>
         <cn type="integer">1</cn>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <cn type="integer">1</cn>
           <apply>
            <minus></minus>
            <ci>ϖ</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <apply>
           <divide></divide>
           <ci>normal-Δ</ci>
           <ci>ϖ</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\varepsilon\prod_{p}\left(\frac{p}{p-1}\right)\prod_{\varpi}\left(1-\frac{1}%
{\varpi-1}\left(\frac{\Delta}{\varpi}\right)\right).
  </annotation>
 </semantics>
</math>

</p>

<p>A simpler, but obviously equivalent formula is given by:</p>

<p>

<math display="inline" id="Ulam_spiral:3">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mi>p</mi>
    </munder>
    <mpadded width="+3.3pt">
     <mfrac>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mfrac>
        <mrow>
         <mi>ω</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>p</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mi>p</mi>
       </mfrac>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>-</mo>
       <mfrac>
        <mn>1</mn>
        <mi>p</mi>
       </mfrac>
      </mrow>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <csymbol cd="latexml">product</csymbol>
      <ci>p</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>ω</ci>
         <ci>p</ci>
        </apply>
        <ci>p</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <cn type="integer">1</cn>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\prod\limits_{p}\frac{1-\frac{\omega(p)}{p}}{1-\frac{1}{p}}~{}
  </annotation>
 </semantics>
</math>

, where 

<math display="inline" id="Ulam_spiral:4">
 <semantics>
  <mi>p</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>p</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p
  </annotation>
 </semantics>
</math>

 runs over all primes, and 

<math display="inline" id="Ulam_spiral:5">
 <semantics>
  <mrow>
   <mi>ω</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>p</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>ω</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \omega(p)
  </annotation>
 </semantics>
</math>

 — is number of zeros of the quadratic polynomials modulus 'p'.</p>

<p>In the first formula, explanation is a little bit more complex. There, in the first product, <em>p</em> is an odd prime dividing both <em>a</em> and <em>b</em>; in the second product, 

<math display="inline" id="Ulam_spiral:6">
 <semantics>
  <mi>ϖ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>ϖ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \varpi
  </annotation>
 </semantics>
</math>

 is an odd prime not dividing <em>a</em>. The quantity ε is defined to be 1 if <em>a</em> + <em>b</em> is odd and 2 if <em>a</em> + <em>b</em> is even. The symbol 

<math display="inline" id="Ulam_spiral:7">
 <semantics>
  <mrow>
   <mo>(</mo>
   <mfrac>
    <mi mathvariant="normal">Δ</mi>
    <mi>ϖ</mi>
   </mfrac>
   <mo>)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>normal-Δ</ci>
    <ci>ϖ</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{\Delta}{\varpi}\right)
  </annotation>
 </semantics>
</math>

 is the <a href="Legendre_symbol" title="wikilink">Legendre symbol</a>. A quadratic polynomial with <em>A</em> ≈ 11.3, currently the highest known value, has been discovered by Jacobson and Williams.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>
<h2 id="variants">Variants</h2>

<p> Klauber's 1932 paper describes a triangle in which row <em>n</em> contains the numbers (<em>n</em>  −  1)<sup>2</sup> + 1 through <em>n</em><sup>2</sup>. As in the Ulam spiral, quadratic polynomials generate numbers that lie in straight lines. Vertical lines correspond to numbers of the form <em>k</em><sup>2</sup> − <em>k</em> + <em>M</em>. Vertical and diagonal lines with a high density of prime numbers are evident in the figure.</p>

<p> Robert Sacks devised a variant of the Ulam spiral in 1994. In the Sacks spiral, the non-negative integers are plotted on an <a href="Archimedean_spiral" title="wikilink">Archimedean spiral</a> rather than the square spiral used by Ulam, and are spaced so that one <a href="square_number" title="wikilink">perfect square</a> occurs in each full rotation. (In the Ulam spiral, two squares occur in each rotation.) Euler's prime-generating polynomial, <em>x</em><sup>2</sup> − <em>x</em> + 41, now appears as a single curve as <em>x</em> takes the values 0, 1, 2, ... This curve asymptotically approaches a horizontal line in the left half of the figure. (In the Ulam spiral, Euler's polynomial forms two diagonal lines, one in the top half of the figure, corresponding to even values of <em>x</em> in the sequence, the other in the bottom half of the figure corresponding to odd values of <em>x</em> in the sequence.)</p>

<p> Additional structure may be seen when <a href="composite_number" title="wikilink">composite numbers</a> are also included in the Ulam spiral. The number 1 has only a single factor, itself; each prime number has two factors, itself and 1; composite numbers are divisible by at least three different factors. Using the size of the dot representing an integer to indicate the number of factors and coloring prime numbers red and composite numbers blue produces the figure shown.</p>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li>

<p></p></li>
<li></li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.youtube.com/watch?v=iFuR97YcSLM">Prime Spirals - Numberphile</a>, YouTube video with Dr. James Grime and the <a href="University_of_Nottingham" title="wikilink">University of Nottingham</a></li>
<li><a href="http://www.youtube.com/watch?v=3K-12i0jclM">41 and more Ulam's Spiral - Numberphile</a>, YouTube video with Dr. James Clewett and the University of Nottingham</li>
<li><a href="http://www.alpertron.com.ar/ULAM.HTM">Ulam spiral</a>, Interactive Javascript application that displays the prime numbers up to 10<sup>17</sup>.</li>
</ul>

<p>"</p>

<p><a href="Category:Prime_numbers" title="wikilink">Category:Prime numbers</a> <a class="uri" href="Category:Spirals" title="wikilink">Category:Spirals</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">.<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
</ol>
</section>
</body>
</html>

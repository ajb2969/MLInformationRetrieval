<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="833">Pentium FDIV bug</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Pentium FDIV bug</h1>
<hr/>

<p> The <strong>Pentium FDIV bug</strong> is a <a href="computer_bug" title="wikilink">bug</a> in the <a class="uri" href="Intel" title="wikilink">Intel</a> <a href="P5_(microarchitecture)" title="wikilink">P5</a> <a href="Pentium_(brand)" title="wikilink">Pentium</a> <a href="floating_point_unit" title="wikilink">floating point unit</a> (FPU). Because of the bug, the processor can return incorrect decimal results, an issue troublesome for the precise calculations needed in fields like math and science. Discovered by Professor Thomas R. Nicely at <a href="Lynchburg_College" title="wikilink">Lynchburg College</a>,<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Intel attributed the error to missing entries in the lookup table used by the floating-point division circuitry.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>Though rarely encountered by average users (<em><a href="Byte_(magazine)" title="wikilink">Byte</a></em> magazine estimated that 1 in 9 billion floating point divides with random parameters would produce inaccurate results),<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> both the flaw and Intel's initial handling of the matter were heavily criticized. Intel ultimately <a href="product_recall" title="wikilink">recalled</a> the defective processors.</p>
<h2 id="chronology">Chronology</h2>

<p>Thomas Nicely, a professor of mathematics at Lynchburg College, had written code to enumerate <a href="prime_number" title="wikilink">primes</a>, <a href="twin_prime" title="wikilink">twin primes</a>, <a href="prime_triplet" title="wikilink">prime triplets</a>, and <a href="prime_quadruplet" title="wikilink">prime quadruplets</a>. Nicely noticed some inconsistencies in the calculations on June 13, 1994, shortly after adding a Pentium system to his group of computers, but was unable to eliminate other factors (such as programming errors, <a class="uri" href="motherboard" title="wikilink">motherboard</a> chipsets, etc.) until October 19, 1994. On October 24, 1994, he reported the issue to Intel. According to Nicely, his contact person at Intel later admitted that Intel had been aware of the problem since May 1994, when the flaw was discovered by Tom Kraljevic, a Purdue co-op student working for Intel in Hillsboro, OR, during testing of the FPU for its new <a href="P6_(microarchitecture)" title="wikilink">P6</a> core, first used in the <a href="Pentium_Pro" title="wikilink">Pentium Pro</a>.</p>

<p>On October 30, 1994, Nicely sent an email describing the error he had discovered in the Pentium floating point unit to various contacts, requesting reports of testing for the flaw on <a href="Intel_80486DX4" title="wikilink">486-DX4s</a>, Pentiums and <a href="Pentium_compatible_processor" title="wikilink">Pentium clones</a>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a></p>

<p>This flaw in the Pentium FPU was quickly verified by other people around the <a class="uri" href="Internet" title="wikilink">Internet</a>, and became known as the Pentium FDIV bug (FDIV is the <a href="x86_instruction_listings" title="wikilink">x86 assembly language mnemonic</a> for <strong>f</strong>loating-point <strong>div</strong>ision). One example was found where the division result returned by the Pentium was off by about 61 parts per million.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a></p>

<p>The story first appeared in the press on November 7, 1994, in an article in <em><a href="Electronic_Engineering_Times" title="wikilink">Electronic Engineering Times</a></em>, "Intel fixes a Pentium FPU glitch" by Alexander Wolfe.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>

<p>The story was subsequently picked up by <a class="uri" href="CNN" title="wikilink">CNN</a> in a segment aired on November 21, 1994.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> This brought it into widespread public prominence.</p>

<p>Publicly, Intel acknowledged the floating-point flaw, but claimed that it was not serious and would not affect most users. Intel offered to replace processors to users who could prove that they were affected. However, although most independent estimates found the bug to be of little importance and would have negligible effect on most users, it caused a great public outcry. Companies like <a href="International_Business_Machines" title="wikilink">IBM</a> (whose <a href="IBM_5x86C" title="wikilink">IBM 5x86C</a> <a class="uri" href="microprocessor" title="wikilink">microprocessor</a> competed at that time with the Intel Pentium line) joined the condemnation.</p>

<p>On December 20, 1994, Intel offered to replace all flawed Pentium processors on the basis of request, in response to mounting public pressure.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> Although it turned out that only a small fraction of Pentium owners bothered to get their chips replaced, the financial impact on the company was significant. On January 17, 1995, Intel announced a pre-tax charge of $475 million against earnings, ostensibly the total cost associated with replacement of the flawed processors.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> Some of the defective chips were later turned into <a href="Keychain" title="wikilink">key rings</a> by Intel.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>A 1995 article in <em><a href="Science_(journal)" title="wikilink">Science</a></em> describes the value of number theory problems in discovering computer bugs and gives the mathematical background and history of <a href="Brun's_constant" title="wikilink">Brun's constant</a>, the problem Nicely was working on when he discovered the bug.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>
<h2 id="affected-models">Affected models</h2>

<p>This problem occurs only on some models of the original Pentium processor.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Any Pentium family processor with a clock speed of at least 120 MHz is new enough not to have this bug.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> On affected models, the Intel Processor Frequency ID Utility checks for the presence of this bug.</p>

<p>The ten affected processors are listed below. The 39 S-spec of those processors are not listed in the Intel processor specification finder web page.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Pentium P5 800 nm 5V</p></td>
<td style="text-align: left;">
<p>Family</p></td>
<td style="text-align: left;">
<p>Model</p></td>
<td style="text-align: left;">
<p>Stepping</p></td>
<td style="text-align: left;">
<p>Core stepping</p></td>
<td style="text-align: left;">
<p>Clock rate</p></td>
<td style="text-align: left;">
<p><a href="Front_side_bus" title="wikilink">FSB</a> speed</p></td>
<td style="text-align: left;">
<p>S-spec</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>B1</p></td>
<td style="text-align: left;">
<p>60 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>60 MHz</p></td>
<td style="text-align: left;">
<p>Q0352, Q0412, SX753</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>3</p></td>
<td style="text-align: left;">
<p>B1</p></td>
<td style="text-align: left;">
<p>66 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>66 MHz</p></td>
<td style="text-align: left;">
<p>Q0353, Q0413, SX754</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>C1</p></td>
<td style="text-align: left;">
<p>60 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>60 MHz</p></td>
<td style="text-align: left;">
<p>Q0466, SX835, SZ949</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>C1</p></td>
<td style="text-align: left;">
<p>66 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>66 MHz</p></td>
<td style="text-align: left;">
<p>Q0467, SX837, SZ950</p></td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">
<p>Pentium P54C 600 nm 3.3V</p></td>
<td style="text-align: left;">
<p>Family</p></td>
<td style="text-align: left;">
<p>Model</p></td>
<td style="text-align: left;">
<p>Stepping</p></td>
<td style="text-align: left;">
<p>Core stepping</p></td>
<td style="text-align: left;">
<p>Clock rate</p></td>
<td style="text-align: left;">
<p>FSB speed</p></td>
<td style="text-align: left;">
<p>S-spec</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>B1</p></td>
<td style="text-align: left;">
<p>75 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>50 MHz</p></td>
<td style="text-align: left;">
<p>Q0601</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>B1</p></td>
<td style="text-align: left;">
<p>90 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>60 MHz</p></td>
<td style="text-align: left;">
<p>Q0542, Q0613, Q0543, SX879, SX885, SX909, SX874</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>1</p></td>
<td style="text-align: left;">
<p>B1</p></td>
<td style="text-align: left;">
<p>100 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>66 MHz</p></td>
<td style="text-align: left;">
<p>Q0563, Q0587, Q0614, SX886, SX910</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>B3</p></td>
<td style="text-align: left;">
<p>75 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>50 MHz</p></td>
<td style="text-align: left;">
<p>Q0606, SX951</p></td>
</tr>
<tr class="even">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>B3</p></td>
<td style="text-align: left;">
<p>90 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>60 MHz</p></td>
<td style="text-align: left;">
<p>Q0628, Q0611, Q0612, SX923, SX922, SX921, SX942, SX943, SX944, SZ951</p></td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<p>5</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>2</p></td>
<td style="text-align: left;">
<p>B3</p></td>
<td style="text-align: left;">
<p>100 <a href="Hertz" title="wikilink">MHz</a></p></td>
<td style="text-align: left;">
<p>66 MHz</p></td>
<td style="text-align: left;">
<p>Q0677, SX960</p></td>
</tr>
</tbody>
</table>
<h2 id="example-symptoms">Example symptoms</h2>

<p>The presence of the bug can be checked manually by performing the following calculation in any application that uses native floating point numbers, including the <a href="Calculator_(Windows)" title="wikilink">Windows Calculator</a> or <a href="Microsoft_Excel" title="wikilink">Microsoft Excel</a> in <a href="Windows_95" title="wikilink">Windows 95</a>/<a href="Windows_98" title="wikilink">98</a>.</p>

<p>The correct value is:</p>

<p>

<math display="block" id="Pentium_FDIV_bug:0">
 <semantics>
  <mrow>
   <mstyle displaystyle="false">
    <mfrac>
     <mrow>
      <mn>4</mn>
      <mo>,</mo>
      <mn>195</mn>
      <mo>,</mo>
      <mn>835</mn>
     </mrow>
     <mrow>
      <mn>3</mn>
      <mo>,</mo>
      <mn>145</mn>
      <mo>,</mo>
      <mn>727</mn>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mn>1.333820449136241002</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <list>
      <cn type="integer">4</cn>
      <cn type="integer">195</cn>
      <cn type="integer">835</cn>
     </list>
     <list>
      <cn type="integer">3</cn>
      <cn type="integer">145</cn>
      <cn type="integer">727</cn>
     </list>
    </apply>
    <cn type="float">1.333820449136241002</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\frac{4,195,835}{3,145,727}=1.333820449136241002
  </annotation>
 </semantics>
</math>

</p>

<p>When converted to the hexadecimal value used by the processor, 4,195,835 = 0x4005FB and 3,145,727 = 0x2FFFFF. The '5' in 0x4005 triggers the fault in the FPU control logic. as a result the value returned by a flawed Pentium processor is incorrect at or beyond four digits:<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a></p>

<p>

<math display="block" id="Pentium_FDIV_bug:1">
 <semantics>
  <mrow>
   <mstyle displaystyle="false">
    <mfrac>
     <mrow>
      <mn>4</mn>
      <mo>,</mo>
      <mn>195</mn>
      <mo>,</mo>
      <mn>835</mn>
     </mrow>
     <mrow>
      <mn>3</mn>
      <mo>,</mo>
      <mn>145</mn>
      <mo>,</mo>
      <mn>727</mn>
     </mrow>
    </mfrac>
   </mstyle>
   <mo>=</mo>
   <mrow>
    <mn>1.333</mn>
    <merror class="ltx_ERROR undefined undefined">
     <mtext>\color</mtext>
    </merror>
    <mi>R</mi>
    <mi>e</mi>
    <mi>d</mi>
    <mn>739068902037589</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <list>
      <cn type="integer">4</cn>
      <cn type="integer">195</cn>
      <cn type="integer">835</cn>
     </list>
     <list>
      <cn type="integer">3</cn>
      <cn type="integer">145</cn>
      <cn type="integer">727</cn>
     </list>
    </apply>
    <apply>
     <times></times>
     <cn type="float">1.333</cn>
     <mtext>\color</mtext>
     <ci>R</ci>
     <ci>e</ci>
     <ci>d</ci>
     <cn type="integer">739068902037589</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\frac{4,195,835}{3,145,727}=1.333{\color{Red}{739068902037589}}
  </annotation>
 </semantics>
</math>

</p>

<p>Another way of detecting the bug is using the <code>pentnt</code> utility included with <a href="Windows_NT_3.51" title="wikilink">Windows NT 3.51</a>, <a href="Windows_NT_4.0" title="wikilink">NT 4.0</a>, <a href="Windows_2000" title="wikilink">2000</a>, and <a href="Windows_XP" title="wikilink">XP</a>.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Pentium_F00F_bug" title="wikilink">Pentium F00F bug</a></li>
<li><a href="Software_bug" title="wikilink">Software bug</a></li>
<li><a href="MOS_Technology_6502#Bugs_and_quirks" title="wikilink">MOS Technology 6502 bugs and quirks</a></li>
<li><a href="Floating_point#Accuracy_problems" title="wikilink">Accuracy problems in floating point operations</a></li>
<li><a href="Division_algorithm#SRT_division" title="wikilink">SRT division</a></li>
<li><a href="Hardware_Trojan" title="wikilink">Hardware Trojan</a></li>
<li><a href="Kill_switch" title="wikilink">Kill switch</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.trnicely.net/#PENT">Personal website of Dr. Nicely, who discovered the bug</a></li>
<li><a href="http://www.cs.earlham.edu/~dusko/cs63/fdiv.html">A page with precise information, also about the cause</a></li>
<li><a href="http://www.maa.org/mathland/mathland_5_12.html">Ivars Peterson's Mathland on the bug</a></li>
<li><a href="http://www.mathworks.com/company/newsletters/news_notes/pdf/win95cleve.pdf">A Tale of Two Numbers</a>, by <a href="Cleve_Moler" title="wikilink">Cleve Moler</a> of <a class="uri" href="MathWorks" title="wikilink">MathWorks</a>
<ul>
<li>[<a class="uri" href="http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=1666&amp;objectType">http://www.mathworks.com/matlabcentral/fileexchange/loadFile.do?objectId=1666&amp;objectType;</a>;=file ZIP-file containing more details] (See <a href="ZIP_file_format" title="wikilink">ZIP file format</a> for details on the file)</li>
</ul></li>
<li><a href="http://support.intel.com/support/processors/pentium/fdiv/">Intel's official site</a></li>
<li><a href="http://www.cpucollection.se/details.php?image_id=784">Unopened Intel CPU box from the FDIV replacement program</a></li>
</ul>

<p>"</p>

<p><a href="Category:X86_architecture" title="wikilink">Category:X86 architecture</a> <a href="Category:Hardware_bugs" title="wikilink">Category:Hardware bugs</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><mtpl></mtpl> <a href="#fnref3">↩</a></li>
<li id="fn4"></li>
<li id="fn5"></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
</ol>
</section>
</body>
</html>

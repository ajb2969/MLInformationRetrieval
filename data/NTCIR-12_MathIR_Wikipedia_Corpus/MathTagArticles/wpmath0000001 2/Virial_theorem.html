<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1093">Virial theorem</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Virial theorem</h1>
<hr/>

<p>In <a class="uri" href="mechanics" title="wikilink">mechanics</a>, the <strong>virial theorem</strong> provides a general equation that relates the average over time of the total <a href="kinetic_energy" title="wikilink">kinetic energy</a>, 

<math display="inline" id="Virial_theorem:0">
 <semantics>
  <mrow>
   <mo>âŸ¨</mo>
   <mi>T</mi>
   <mo>âŸ©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle T\right\rangle
  </annotation>
 </semantics>
</math>

, of a stable system consisting of <em>N</em> particles, bound by potential forces, with that of the total potential energy, 

<math display="inline" id="Virial_theorem:1">
 <semantics>
  <mrow>
   <mo>âŸ¨</mo>
   <msub>
    <mi>V</mi>
    <mtext>TOT</mtext>
   </msub>
   <mo>âŸ©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <mtext>TOT</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle V_{\text{TOT}}\right\rangle
  </annotation>
 </semantics>
</math>

, where angle brackets represent the average over time of the enclosed quantity. Mathematically, the <a class="uri" href="theorem" title="wikilink">theorem</a> states</p>

<p>

<math display="block" id="Virial_theorem:2">
 <semantics>
  <mrow>
   <mrow>
    <mo>âŸ¨</mo>
    <mi>T</mi>
    <mo>âŸ©</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
     </mpadded>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mo>âŸ¨</mo>
       <mrow>
        <msub>
         <mi>ğ…</mi>
         <mi>k</mi>
        </msub>
        <mo>â‹…</mo>
        <msub>
         <mi>ğ«</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo>âŸ©</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
     <ci>T</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <apply>
         <ci>normal-â‹…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ…</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle T\right\rangle=-\frac{1}{2}\,\sum_{k=1}^{N}\left\langle\mathbf{F}%
_{k}\cdot\mathbf{r}_{k}\right\rangle
  </annotation>
 </semantics>
</math>

</p>

<p>where <strong>F</strong><sub><em>k</em></sub> represents the <a class="uri" href="force" title="wikilink">force</a> on the <em>k</em>th particle, which is located at position <strong>r</strong><sub><em>k</em></sub>. The word <strong>virial</strong> for the right-hand side of the equation derives from <em>vis</em>, the <a class="uri" href="Latin" title="wikilink">Latin</a> word for "force" or "energy", and was given its technical definition by <a href="Rudolf_Clausius" title="wikilink">Rudolf Clausius</a> in 1870.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>The significance of the virial theorem is that it allows the average total kinetic energy to be calculated even for very complicated systems that defy an exact solution, such as those considered in <a href="statistical_mechanics" title="wikilink">statistical mechanics</a>; this average total kinetic energy is related to the <a class="uri" href="temperature" title="wikilink">temperature</a> of the system by the <a href="equipartition_theorem" title="wikilink">equipartition theorem</a>. However, the virial theorem does not depend on the notion of <a class="uri" href="temperature" title="wikilink">temperature</a> and holds even for systems that are not in <a href="thermal_equilibrium" title="wikilink">thermal equilibrium</a>. The virial theorem has been generalized in various ways, most notably to a <a class="uri" href="tensor" title="wikilink">tensor</a> form.</p>

<p>If the force between any two particles of the system results from a <a href="potential_energy" title="wikilink">potential energy</a> <em>V</em>(<em>r</em>) = <em>Î±r<sup>Â n</sup></em> that is proportional to some power <em>n</em> of the <a href="mean_inter-particle_distance" title="wikilink">inter-particle distance</a> <em>r</em>, the virial theorem takes the simple form</p>

<p>

<math display="block" id="Virial_theorem:3">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">âŸ¨</mo>
      <mi>T</mi>
      <mo stretchy="false">âŸ©</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mi>n</mi>
     <mrow>
      <mo stretchy="false">âŸ¨</mo>
      <msub>
       <mi>V</mi>
       <mtext>TOT</mtext>
      </msub>
      <mo stretchy="false">âŸ©</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>n</ci>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <mtext>TOT</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\langle T\rangle=n\langle V_{\text{TOT}}\rangle.
  </annotation>
 </semantics>
</math>

</p>

<p>Thus, twice the average total kinetic energy 

<math display="inline" id="Virial_theorem:4">
 <semantics>
  <mrow>
   <mo>âŸ¨</mo>
   <mi>T</mi>
   <mo>âŸ©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle T\right\rangle
  </annotation>
 </semantics>
</math>

 equals <em>n</em> times the average total potential energy 

<math display="inline" id="Virial_theorem:5">
 <semantics>
  <mrow>
   <mo>âŸ¨</mo>
   <msub>
    <mi>V</mi>
    <mtext>TOT</mtext>
   </msub>
   <mo>âŸ©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>V</ci>
     <mtext>TOT</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle V_{\text{TOT}}\right\rangle
  </annotation>
 </semantics>
</math>

. Whereas <em>V</em>(<em>r</em>) represents the potential energy between two particles, <em>V</em><sub>TOT</sub> represents the total potential energy of the system, i.e., the sum of the potential energy <em>V</em>(<em>r</em>) over all pairs of particles in the system. A common example of such a system is a star held together by its own gravity, where <em>n</em> equals âˆ’1.</p>

<p>Although the virial theorem depends on averaging the total kinetic and potential energies, the presentation here postpones the averaging to the last step.</p>
<h2 id="history">History</h2>

<p>In 1870, <a href="Rudolf_Clausius" title="wikilink">Rudolf Clausius</a> delivered the lecture "On a Mechanical Theorem Applicable to Heat" to the Association for Natural and Medical Sciences of the Lower Rhine, following a 20 year study of thermodynamics. The lecture stated that the mean <a href="vis_viva" title="wikilink">vis viva</a> of the system is equal to its virial, or that the average kinetic energy is equal to 1/2 the average potential energy. The virial theorem can be obtained directly from <a href="Lagrange's_identity" title="wikilink">Lagrange's Identity</a> as applied in classical gravitational dynamics, the original form of which was included in Lagrange's "Essay on the Problem of Three Bodies" published in 1772. <a href="Carl_Gustav_Jacob_Jacobi" title="wikilink">Karl Jacobi's</a> generalization of the identity to <em>n</em>Â bodies and to the present form of Laplace's identity closely resembles the classical virial theorem. However, the interpretations leading to the development of the equations were very different, since at the time of development, statistical dynamics had not yet unified the separate studies of thermodynamics and classical dynamics.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> The theorem was later utilized, popularized, generalized and further developed by <a href="James_Clerk_Maxwell" title="wikilink">James Clerk Maxwell</a>, <a href="John_Strutt,_3rd_Baron_Rayleigh" title="wikilink">Lord Rayleigh</a>, <a href="Henri_PoincarÃ©" title="wikilink">Henri PoincarÃ©</a>, <a href="Subrahmanyan_Chandrasekhar" title="wikilink">Subrahmanyan Chandrasekhar</a>, <a href="Enrico_Fermi" title="wikilink">Enrico Fermi</a>, <a href="Paul_Ledoux" title="wikilink">Paul Ledoux</a> and <a href="Eugene_Parker" title="wikilink">Eugene Parker</a>. <a href="Fritz_Zwicky" title="wikilink">Fritz Zwicky</a> was the first to use the virial theorem to deduce the existence of unseen matter, which is now called <a href="dark_matter" title="wikilink">dark matter</a>. As another example of its many applications, the virial theorem has been used to derive the <a href="Chandrasekhar_limit" title="wikilink">Chandrasekhar limit</a> for the stability of <a href="white_dwarf" title="wikilink">white dwarf</a> <a href="star" title="wikilink">stars</a>.</p>
<h2 id="statement-and-derivation">Statement and derivation</h2>

<p>For a collection of <em>N</em> point particles, the <a href="scalar_(physics)" title="wikilink">scalar</a> <a href="moment_of_inertia" title="wikilink">moment of inertia</a> <em>I</em> about the <a href="origin_(mathematics)" title="wikilink">origin</a> is defined by the equation</p>

<p>

<math display="block" id="Virial_theorem:6">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>m</mi>
      <mi>k</mi>
     </msub>
     <msup>
      <mrow>
       <mo stretchy="false">|</mo>
       <msub>
        <mi>ğ«</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">|</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>m</mi>
      <mi>k</mi>
     </msub>
     <msubsup>
      <mi>r</mi>
      <mi>k</mi>
      <mn>2</mn>
     </msubsup>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>I</ci>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <abs></abs>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <ci>k</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I=\sum_{k=1}^{N}m_{k}|\mathbf{r}_{k}|^{2}=\sum_{k=1}^{N}m_{k}r_{k}^{2}
  </annotation>
 </semantics>
</math>

 where <em>m</em><sub><em>k</em></sub> and <strong>r</strong><sub><em>k</em></sub> represent the mass and position of the <em>k</em>th particle. <em>r</em><sub><em>k</em></sub>=|<strong>r</strong><sub><em>k</em></sub>| is the position vector magnitude. The scalar <em>G</em> is defined by the equation</p>

<p>

<math display="block" id="Virial_theorem:7">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>ğ©</mi>
      <mi>k</mi>
     </msub>
     <mo>â‹…</mo>
     <msub>
      <mi>ğ«</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>G</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <ci>normal-â‹…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ©</ci>
       <ci>k</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ«</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G=\sum_{k=1}^{N}\mathbf{p}_{k}\cdot\mathbf{r}_{k}
  </annotation>
 </semantics>
</math>

 where <strong>p</strong><sub><em>k</em></sub> is the <a class="uri" href="momentum" title="wikilink">momentum</a> <a href="vector_(geometry)" title="wikilink">vector</a> of the <em>k</em>th particle. Assuming that the masses are constant, <em>G</em> is one-half the time derivative of this moment of inertia</p>

<p>

<math display="block" id="Virial_theorem:8">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>I</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mfrac>
      <mi>d</mi>
      <mrow>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mrow>
        <mpadded width="+1.7pt">
         <msub>
          <mi>m</mi>
          <mi>k</mi>
         </msub>
        </mpadded>
        <msub>
         <mi>ğ«</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo>â‹…</mo>
       <msub>
        <mi>ğ«</mi>
        <mi>k</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <mrow>
       <mpadded width="+1.7pt">
        <msub>
         <mi>m</mi>
         <mi>k</mi>
        </msub>
       </mpadded>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>ğ«</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>t</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo>â‹…</mo>
      <msub>
       <mi>ğ«</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>N</mi>
     </munderover>
     <mrow>
      <msub>
       <mi>ğ©</mi>
       <mi>k</mi>
      </msub>
      <mo>â‹…</mo>
      <msub>
       <mi>ğ«</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <mi>G</mi>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>I</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <ci>normal-â‹…</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ«</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <ci>normal-â‹…</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ğ«</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ«</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <ci>normal-â‹…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ©</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ«</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <ci>G</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{2}\frac{dI}{dt}=\frac{1}{2}\frac{d}{dt}\sum_{k=1}^{N}m_{k}\,\mathbf{r%
}_{k}\cdot\mathbf{r}_{k}=\sum_{k=1}^{N}m_{k}\,\frac{d\mathbf{r}_{k}}{dt}\cdot%
\mathbf{r}_{k}=\sum_{k=1}^{N}\mathbf{p}_{k}\cdot\mathbf{r}_{k}=G\,.
  </annotation>
 </semantics>
</math>

 In turn, the time derivative of <em>G</em> can be written</p>

<p>

<math display="inline" id="Virial_theorem:9">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>G</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>G</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{dG}{dt}
  </annotation>
 </semantics>
</math>


 where <em>m</em><sub><em>k</em></sub> is the mass of the <em>k</em>-th particle, 

<math display="inline" id="Virial_theorem:10">
 <semantics>
  <mrow>
   <msub>
    <mi>ğ…</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <msub>
      <mi>ğ©</mi>
      <mi>k</mi>
     </msub>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ğ…</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>ğ©</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{k}=\frac{d\mathbf{p}_{k}}{dt}
  </annotation>
 </semantics>
</math>

 is the net force on that particle, and <em>T</em> is the total <a href="kinetic_energy" title="wikilink">kinetic energy</a> of the system</p>

<p>

<math display="block" id="Virial_theorem:11">
 <semantics>
  <mrow>
   <mrow>
    <mi>T</mi>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <msub>
        <mi>m</mi>
        <mi>k</mi>
       </msub>
       <msubsup>
        <mi>v</mi>
        <mi>k</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <mrow>
       <mrow>
        <msub>
         <mi>m</mi>
         <mi>k</mi>
        </msub>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <msub>
           <mi>ğ«</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mrow>
       <mo>â‹…</mo>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>ğ«</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>t</mi>
        </mrow>
       </mfrac>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>T</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>m</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <ci>k</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <ci>normal-â‹…</ci>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>m</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ğ«</ci>
            <ci>k</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>ğ«</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>t</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=\frac{1}{2}\sum_{k=1}^{N}m_{k}v_{k}^{2}=\frac{1}{2}\sum_{k=1}^{N}m_{k}\frac{%
d\mathbf{r}_{k}}{dt}\cdot\frac{d\mathbf{r}_{k}}{dt}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="connection-with-the-potential-energy-between-particles">Connection with the potential energy between particles</h3>

<p>The total force 

<math display="inline" id="Virial_theorem:12">
 <semantics>
  <msub>
   <mi>ğ…</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ğ…</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{k}
  </annotation>
 </semantics>
</math>

 on particle <em>k</em> is the sum of all the forces from the other particles <em>j</em> in the system</p>

<p>

<math display="block" id="Virial_theorem:13">
 <semantics>
  <mrow>
   <msub>
    <mi>ğ…</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>N</mi>
    </munderover>
    <msub>
     <mi>ğ…</mi>
     <mrow>
      <mi>j</mi>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ğ…</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>j</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ğ…</ci>
      <apply>
       <times></times>
       <ci>j</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{k}=\sum_{j=1}^{N}\mathbf{F}_{jk}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Virial_theorem:14">
 <semantics>
  <msub>
   <mi>ğ…</mi>
   <mrow>
    <mi>j</mi>
    <mi>k</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>ğ…</ci>
    <apply>
     <times></times>
     <ci>j</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{jk}
  </annotation>
 </semantics>
</math>

 is the force applied by particle <em>j</em> on particle <em>k</em>. Hence, the virial can be written</p>

<p>

<math display="block" id="Virial_theorem:15">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mpadded>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <mrow>
        <msub>
         <mi>ğ…</mi>
         <mi>k</mi>
        </msub>
        <mo>â‹…</mo>
        <msub>
         <mi>ğ«</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mpadded>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>N</mi>
        </munderover>
        <mrow>
         <msub>
          <mi>ğ…</mi>
          <mrow>
           <mi>j</mi>
           <mi>k</mi>
          </mrow>
         </msub>
         <mo>â‹…</mo>
         <msub>
          <mi>ğ«</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <ci>normal-â‹…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ…</ci>
         <ci>k</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ«</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>N</ci>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>j</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <ci>normal-â‹…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ…</ci>
          <apply>
           <times></times>
           <ci>j</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -\frac{1}{2}\,\sum_{k=1}^{N}\mathbf{F}_{k}\cdot\mathbf{r}_{k}=-\frac{1}{2}\,%
\sum_{k=1}^{N}\sum_{j=1}^{N}\mathbf{F}_{jk}\cdot\mathbf{r}_{k}.
  </annotation>
 </semantics>
</math>

</p>

<p>Since no particle acts on itself (i.e., 

<math display="inline" id="Virial_theorem:16">
 <semantics>
  <mrow>
   <msub>
    <mi>ğ…</mi>
    <mrow>
     <mi>j</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ğ…</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{jk}=0
  </annotation>
 </semantics>
</math>

 whenever 

<math display="inline" id="Virial_theorem:17">
 <semantics>
  <mrow>
   <mi>j</mi>
   <mo>=</mo>
   <mi>k</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>j</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j=k
  </annotation>
 </semantics>
</math>

), we have</p>

<p>

<math display="block" id="Virial_theorem:18">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>ğ…</mi>
     <mrow>
      <mi>j</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mo>âˆ‡</mo>
       <msub>
        <mi>ğ«</mi>
        <mi>k</mi>
       </msub>
      </msub>
      <mi>V</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>V</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>r</mi>
       </mrow>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <msub>
          <mi>ğ«</mi>
          <mi>k</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>ğ«</mi>
          <mi>j</mi>
         </msub>
        </mrow>
        <msub>
         <mi>r</mi>
         <mrow>
          <mi>j</mi>
          <mi>k</mi>
         </mrow>
        </msub>
       </mfrac>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ğ…</ci>
      <apply>
       <times></times>
       <ci>j</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>normal-âˆ‡</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>ğ«</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <ci>V</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>V</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>r</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>j</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>r</ci>
         <apply>
          <times></times>
          <ci>j</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{jk}=-\nabla_{\mathbf{r}_{k}}V=-\frac{dV}{dr}\left(\frac{\mathbf{r}%
_{k}-\mathbf{r}_{j}}{r_{jk}}\right),
  </annotation>
 </semantics>
</math>

 (equal and opposite reaction).</p>

<p>It often happens that the forces can be derived from a potential energy <em>V</em> that is a function only of the distance <em>r</em><sub><em>jk</em></sub> between the point particles <em>j</em> and <em>k</em>. Since the force is the negative gradient of the potential energy, we have in this case</p>

<p>

<math display="inline" id="Virial_theorem:19">
 <semantics>
  <mrow>
   <msub>
    <mi>ğ…</mi>
    <mrow>
     <mi>k</mi>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <msub>
      <mo>âˆ‡</mo>
      <msub>
       <mi>ğ«</mi>
       <mi>j</mi>
      </msub>
     </msub>
     <mi>V</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ğ…</ci>
     <apply>
      <times></times>
      <ci>k</ci>
      <ci>j</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>normal-âˆ‡</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>ğ«</ci>
        <ci>j</ci>
       </apply>
      </apply>
      <ci>V</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{kj}=-\nabla_{\mathbf{r}_{j}}V
  </annotation>
 </semantics>
</math>

</p>

<p>which is clearly equal and opposite to 

<math display="inline" id="Virial_theorem:20">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

, the force applied by particle 

<math display="block" id="Virial_theorem:21">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>G</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mfrac>
     <mrow>
      <msup>
       <mi>d</mi>
       <mn>2</mn>
      </msup>
      <mi>I</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <msup>
       <mi>t</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>T</mi>
    </mrow>
    <mo>+</mo>
    <msub>
     <mi>V</mi>
     <mtext>TOT</mtext>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>G</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>I</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <ci>T</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <mtext>TOT</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dG}{dt}=\frac{1}{2}\frac{d^{2}I}{dt^{2}}=2T+V_{\text{TOT}}
  </annotation>
 </semantics>
</math>

 on particle <em>j</em>, as may be confirmed by explicit calculation. Hence,</p>

<p>

<math display="block" id="Virial_theorem:22">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>âŸ¨</mo>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>G</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mo>âŸ©</mo>
     </mrow>
     <mi>Ï„</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>Ï„</mi>
     </mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">âˆ«</mo>
       <mn>0</mn>
       <mi>Ï„</mi>
      </msubsup>
      <mrow>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mi>d</mi>
          <mi>G</mi>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mpadded>
       <mi>d</mi>
       <mi>t</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mi>Ï„</mi>
     </mfrac>
     <mrow>
      <mpadded width="+1.7pt">
       <msubsup>
        <mo largeop="true" symmetric="true">âˆ«</mo>
        <mrow>
         <mi>G</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mn>0</mn>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mrow>
         <mi>G</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>Ï„</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msubsup>
      </mpadded>
      <mrow>
       <mi>d</mi>
       <mi>G</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mi>G</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>Ï„</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>G</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mi>Ï„</mi>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>G</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>t</ci>
        </apply>
       </apply>
      </apply>
      <ci>Ï„</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>Ï„</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <cn type="integer">0</cn>
        </apply>
        <ci>Ï„</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>G</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>t</ci>
         </apply>
        </apply>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>Ï„</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <int></int>
         <apply>
          <times></times>
          <ci>G</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>G</ci>
         <ci>Ï„</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>G</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>G</ci>
        <ci>Ï„</ci>
       </apply>
       <apply>
        <times></times>
        <ci>G</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
      <ci>Ï„</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\frac{dG}{dt}\right\rangle_{\tau}=\frac{1}{\tau}\int_{0}^{\tau}%
\frac{dG}{dt}\,dt=\frac{1}{\tau}\int_{G(0)}^{G(\tau)}\,dG=\frac{G(\tau)-G(0)}{%
\tau},
  </annotation>
 </semantics>
</math>

</p>

<p>where the coefficient Î± and the exponent <em>n</em> are constants. In such cases, the virial is given by the equation</p>

<p>

<math display="block" id="Virial_theorem:23">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo>âŸ¨</mo>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>G</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>t</mi>
       </mrow>
      </mfrac>
      <mo>âŸ©</mo>
     </mrow>
     <mi>Ï„</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mn>2</mn>
      <msub>
       <mrow>
        <mo>âŸ¨</mo>
        <mi>T</mi>
        <mo>âŸ©</mo>
       </mrow>
       <mi>Ï„</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <msub>
       <mrow>
        <mo>âŸ¨</mo>
        <mrow>
         <msub>
          <mi>ğ…</mi>
          <mi>k</mi>
         </msub>
         <mo>â‹…</mo>
         <msub>
          <mi>ğ«</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>âŸ©</mo>
       </mrow>
       <mi>Ï„</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>G</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <ci>Ï„</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <ci>T</ci>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <apply>
         <ci>normal-â‹…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ…</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle\frac{dG}{dt}\right\rangle_{\tau}=2\left\langle T\right\rangle_{%
\tau}+\sum_{k=1}^{N}\left\langle\mathbf{F}_{k}\cdot\mathbf{r}_{k}\right\rangle%
_{\tau}.
  </annotation>
 </semantics>
</math>

</p>

<p>For gravitating systems the exponent <em>n</em> equals âˆ’1, giving <strong>Lagrange's identity</strong></p>

<p>

<math display="inline" id="Virial_theorem:24">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>âŸ¨</mo>
     <mrow>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mi>G</mi>
       </mrow>
       <mo>/</mo>
       <mi>d</mi>
      </mrow>
      <mi>t</mi>
     </mrow>
     <mo>âŸ©</mo>
    </mrow>
    <mi>Ï„</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>G</ci>
        </apply>
        <ci>d</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>Ï„</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle{dG}/{dt}\right\rangle_{\tau}=0
  </annotation>
 </semantics>
</math>

</p>

<p>which was derived by Lagrange and extended by Jacobi.</p>
<h3 id="time-averaging">Time averaging</h3>

<p>The average of this derivative over a time, <em>Ï„</em>, is defined as</p>

<p>

<math display="block" id="Virial_theorem:25">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <msub>
      <mrow>
       <mo>âŸ¨</mo>
       <mi>T</mi>
       <mo>âŸ©</mo>
      </mrow>
      <mi>Ï„</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
       <mrow>
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>N</mi>
      </munderover>
      <msub>
       <mrow>
        <mo>âŸ¨</mo>
        <mrow>
         <msub>
          <mi>ğ…</mi>
          <mi>k</mi>
         </msub>
         <mo>â‹…</mo>
         <msub>
          <mi>ğ«</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo>âŸ©</mo>
       </mrow>
       <mi>Ï„</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <ci>T</ci>
      </apply>
      <ci>Ï„</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>N</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <apply>
         <ci>normal-â‹…</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ…</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>ğ«</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\left\langle T\right\rangle_{\tau}=-\sum_{k=1}^{N}\left\langle\mathbf{F}_{k}%
\cdot\mathbf{r}_{k}\right\rangle_{\tau}.
  </annotation>
 </semantics>
</math>

</p>

<p>from which we obtain the exact equation</p>

<p>

<math display="inline" id="Virial_theorem:26">
 <semantics>
  <mrow>
   <msub>
    <mrow>
     <mo>âŸ¨</mo>
     <mrow>
      <mrow>
       <mrow>
        <mi>d</mi>
        <mi>G</mi>
       </mrow>
       <mo>/</mo>
       <mi>d</mi>
      </mrow>
      <mi>t</mi>
     </mrow>
     <mo>âŸ©</mo>
    </mrow>
    <mi>Ï„</mi>
   </msub>
   <mo>=</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>G</ci>
        </apply>
        <ci>d</ci>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
     <ci>Ï„</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left\langle{dG}/{dt}\right\rangle_{\tau}=0
  </annotation>
 </semantics>
</math>

</p>

<p>The <strong>virial theorem</strong> states that, <strong>if</strong> 

<math display="block" id="Virial_theorem:27">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>Ï„</mi>
      <mo>â†’</mo>
      <mi mathvariant="normal">âˆ</mi>
     </mrow>
    </munder>
    <mrow>
     <mo>|</mo>
     <msub>
      <mrow>
       <mo>âŸ¨</mo>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <msup>
          <mi>G</mi>
          <mi>bound</mi>
         </msup>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>t</mi>
        </mrow>
       </mfrac>
       <mo>âŸ©</mo>
      </mrow>
      <mi>Ï„</mi>
     </msub>
     <mo>|</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>Ï„</mi>
      <mo>â†’</mo>
      <mi mathvariant="normal">âˆ</mi>
     </mrow>
    </munder>
    <mrow>
     <mo>|</mo>
     <mfrac>
      <mrow>
       <mrow>
        <mi>G</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>Ï„</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>G</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mn>0</mn>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mi>Ï„</mi>
     </mfrac>
     <mo>|</mo>
    </mrow>
   </mrow>
   <mo>â‰¤</mo>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>Ï„</mi>
      <mo>â†’</mo>
      <mi mathvariant="normal">âˆ</mi>
     </mrow>
    </munder>
    <mfrac>
     <mrow>
      <msub>
       <mi>G</mi>
       <mi>max</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mi>G</mi>
       <mi>min</mi>
      </msub>
     </mrow>
     <mi>Ï„</mi>
    </mfrac>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-â†’</ci>
        <ci>Ï„</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>G</ci>
            <ci>bound</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>t</ci>
          </apply>
         </apply>
        </apply>
        <ci>Ï„</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-â†’</ci>
        <ci>Ï„</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <abs></abs>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>G</ci>
          <ci>Ï„</ci>
         </apply>
         <apply>
          <times></times>
          <ci>G</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
        <ci>Ï„</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <leq></leq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-â†’</ci>
        <ci>Ï„</ci>
        <infinity></infinity>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <max></max>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>G</ci>
         <min></min>
        </apply>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <cn type="float">0.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{\tau\rightarrow\infty}\left|\left\langle\frac{dG^{\mathrm{bound}}}{dt}%
\right\rangle_{\tau}\right|=\lim_{\tau\rightarrow\infty}\left|\frac{G(\tau)-G(%
0)}{\tau}\right|\leq\lim_{\tau\rightarrow\infty}\frac{G_{\max}-G_{\min}}{\tau}%
=0.
  </annotation>
 </semantics>
</math>

, then</p>

<p>

<math display="block" id="Virial_theorem:28">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo stretchy="false">âŸ¨</mo>
      <mi>T</mi>
      <mo stretchy="false">âŸ©</mo>
     </mrow>
     <mi>Ï„</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <msub>
        <mrow>
         <mo stretchy="false">âŸ¨</mo>
         <mrow>
          <msub>
           <mi>ğ…</mi>
           <mi>k</mi>
          </msub>
          <mo>â‹…</mo>
          <msub>
           <mi>ğ«</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mo stretchy="false">âŸ©</mo>
        </mrow>
        <mi>Ï„</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mi>n</mi>
      <mn>2</mn>
     </mfrac>
     <msub>
      <mrow>
       <mo stretchy="false">âŸ¨</mo>
       <msub>
        <mi>V</mi>
        <mtext>TOT</mtext>
       </msub>
       <mo stretchy="false">âŸ©</mo>
      </mrow>
      <mi>Ï„</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <ci>T</ci>
      </apply>
      <ci>Ï„</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <cn type="integer">1</cn>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
          <apply>
           <ci>normal-â‹…</ci>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ğ…</ci>
            <ci>k</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>ğ«</ci>
            <ci>k</ci>
           </apply>
          </apply>
         </apply>
         <ci>Ï„</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <mtext>TOT</mtext>
        </apply>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle T\rangle_{\tau}=-\frac{1}{2}\sum_{k=1}^{N}\langle\mathbf{F}_{k}\cdot%
\mathbf{r}_{k}\rangle_{\tau}=\frac{n}{2}\langle V_{\text{TOT}}\rangle_{\tau}.
  </annotation>
 </semantics>
</math>

</p>

<p>There are many reasons why the average of the time derivative might vanish, i.e., 

<math display="block" id="Virial_theorem:29">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mo stretchy="false">âŸ¨</mo>
      <mi>T</mi>
      <mo stretchy="false">âŸ©</mo>
     </mrow>
     <mi>Ï„</mi>
    </msub>
    <mo>=</mo>
    <mrow>
     <mo>-</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msub>
       <mrow>
        <mo stretchy="false">âŸ¨</mo>
        <msub>
         <mi>V</mi>
         <mtext>TOT</mtext>
        </msub>
        <mo stretchy="false">âŸ©</mo>
       </mrow>
       <mi>Ï„</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <ci>T</ci>
     </apply>
     <ci>Ï„</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <mtext>TOT</mtext>
        </apply>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle T\rangle_{\tau}=-\frac{1}{2}\langle V_{\text{TOT}}\rangle_{\tau}.
  </annotation>
 </semantics>
</math>

. One often-cited reason applies to <em>stably bound systems</em>, i.e., systems that hang together forever and whose parameters are finite. In that case, velocities and coordinates of the particles of the system have upper and lower limits so that <em>G</em><sup>bound</sup>, is bounded between two extremes, <em>G</em><sub>min</sub> and <em>G</em><sub>max</sub>, and the average goes to zero in the limit of very long times <em>Ï„</em></p>

<p>

<math display="inline" id="Virial_theorem:30">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>V</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mo stretchy="false">{</mo>
       <msub>
        <mi>X</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy="false">}</mo>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
     <msub>
      <mo largeop="true" symmetric="true">âˆ‘</mo>
      <mi>n</mi>
     </msub>
     <mrow>
      <mrow>
       <msubsup>
        <mi>P</mi>
        <mi>n</mi>
        <mn>2</mn>
       </msubsup>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
      <mi>m</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>H</ci>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <ci>V</ci>
      <set>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>i</ci>
       </apply>
      </set>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>n</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>m</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H=V(\{X_{i}\})+\sum_{n}P_{n}^{2}/2m
  </annotation>
 </semantics>
</math>

</p>

<p>Even if the average of the time derivative of <em>G</em> is only approximately zero, the virial theorem holds to the same degree of approximation.</p>

<p>For power-law forces with an exponent <em>n</em>, the general equation holds</p>

<p>

<math display="inline" id="Virial_theorem:31">
 <semantics>
  <mrow>
   <msub>
    <mi>X</mi>
    <mi>n</mi>
   </msub>
   <msub>
    <mi>P</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>X</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{n}P_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>For <a href="gravitation" title="wikilink">gravitational attraction</a>, <em>n</em> equals âˆ’1 and the average kinetic energy equals half of the average negative potential energy</p>

<p>

<math display="inline" id="Virial_theorem:32">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{n}
  </annotation>
 </semantics>
</math>

</p>

<p>This general result is useful for complex gravitating systems such as <a href="solar_system" title="wikilink">solar systems</a> or <a href="galaxy" title="wikilink">galaxies</a>.</p>

<p>A simple application of the virial theorem concerns galaxy clusters. If a region of space is unusually full of galaxies, it is safe to assume that they have been together for a long time, and the virial theorem can be applied. Doppler measurements give lower bounds for their relative velocities, and the virial theorem gives a lower bound for the total mass of the cluster, including any dark matter.</p>

<p>The averaging need not be taken over time; an <a href="ensemble_average" title="wikilink">ensemble average</a> can also be taken, with equivalent results.</p>
<h2 id="in-quantum-mechanics">In quantum mechanics</h2>

<p>Although originally derived for classical mechanics, the virial theorem also holds for quantum mechanics, as first shown by Fock.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>Evaluate the <a class="uri" href="commutator" title="wikilink">commutator</a> of the <a href="Hamiltonian_(quantum_mechanics)" title="wikilink">Hamiltonian</a> 

<math display="inline" id="Virial_theorem:33">
 <semantics>
  <mrow>
   <msub>
    <mi>P</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>i</mi>
       <mi mathvariant="normal">â„</mi>
       <mi>d</mi>
      </mrow>
      <mo>/</mo>
      <mi>d</mi>
     </mrow>
     <msub>
      <mi>X</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>P</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>i</ci>
        <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
        <ci>d</ci>
       </apply>
       <ci>d</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   P_{n}=-i\hbar d/dX_{n}
  </annotation>
 </semantics>
</math>

 and the product 

<math display="inline" id="Virial_theorem:34">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 of the position operator 

<math display="block" id="Virial_theorem:35">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>H</mi>
     <mo>,</mo>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>n</mi>
      </msub>
      <msub>
       <mi>P</mi>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo stretchy="false">]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>H</mi>
       <mo>,</mo>
       <msub>
        <mi>P</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">]</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">[</mo>
       <mi>H</mi>
       <mo>,</mo>
       <msub>
        <mi>X</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">]</mo>
      </mrow>
      <msub>
       <mi>P</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>i</mi>
      <mi mathvariant="normal">â„</mi>
      <msub>
       <mi>X</mi>
       <mi>n</mi>
      </msub>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>V</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>X</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>i</mi>
      <mi mathvariant="normal">â„</mi>
      <mfrac>
       <msubsup>
        <mi>P</mi>
        <mi>n</mi>
        <mn>2</mn>
       </msubsup>
       <mi>m</mi>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <interval closure="closed">
      <ci>H</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </interval>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <interval closure="closed">
        <ci>H</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>n</ci>
        </apply>
       </interval>
      </apply>
      <apply>
       <times></times>
       <interval closure="closed">
        <ci>H</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>X</ci>
         <ci>n</ci>
        </apply>
       </interval>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>P</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>i</ci>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>V</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <ci>i</ci>
       <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>P</ci>
          <ci>n</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   [H,X_{n}P_{n}]=X_{n}[H,P_{n}]+[H,X_{n}]P_{n}=i\hbar X_{n}\frac{dV}{dX_{n}}-i%
\hbar\frac{P_{n}^{2}}{m},
  </annotation>
 </semantics>
</math>

 and the momentum operator 

<math display="inline" id="Virial_theorem:36">
 <semantics>
  <mrow>
   <mi>Q</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">âˆ‘</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <msub>
      <mi>X</mi>
      <mi>n</mi>
     </msub>
     <msub>
      <mi>P</mi>
      <mi>n</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>Q</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>X</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>P</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q=\sum_{n}X_{n}P_{n}
  </annotation>
 </semantics>
</math>

 of particle 

<math display="block" id="Virial_theorem:37">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mi>i</mi>
     <mi mathvariant="normal">â„</mi>
    </mfrac>
    <mrow>
     <mo stretchy="false">[</mo>
     <mi>H</mi>
     <mo>,</mo>
     <mi>Q</mi>
     <mo stretchy="false">]</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mi>T</mi>
    </mrow>
    <mo>-</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
      <mi>n</mi>
     </munder>
     <mrow>
      <msub>
       <mi>X</mi>
       <mi>n</mi>
      </msub>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>V</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msub>
         <mi>X</mi>
         <mi>n</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>i</ci>
      <csymbol cd="latexml">Planck-constant-over-2-pi</csymbol>
     </apply>
     <interval closure="closed">
      <ci>H</ci>
      <ci>Q</ci>
     </interval>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>T</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>V</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{i}{\hbar}[H,Q]=2T-\sum_{n}X_{n}\frac{dV}{dX_{n}}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="inline" id="Virial_theorem:38">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <msub>
     <mo largeop="true" symmetric="true">âˆ‘</mo>
     <mi>n</mi>
    </msub>
    <mrow>
     <mrow>
      <msubsup>
       <mi>P</mi>
       <mi>n</mi>
       <mn>2</mn>
      </msubsup>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mi>m</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>T</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>P</ci>
         <ci>n</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <ci>m</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=\sum_{n}P_{n}^{2}/2m
  </annotation>
 </semantics>
</math>

 so summing over all particles one finds for 

<math display="inline" id="Virial_theorem:39">
 <semantics>
  <mrow>
   <mo>-</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mi>Q</mi>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>t</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>Q</ci>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   -dQ/dt
  </annotation>
 </semantics>
</math>

 the commutator</p>

<p>

<math display="inline" id="Virial_theorem:40">
 <semantics>
  <mrow>
   <mo stretchy="false">âŸ¨</mo>
   <mrow>
    <mrow>
     <mrow>
      <mi>d</mi>
      <mi>Q</mi>
     </mrow>
     <mo>/</mo>
     <mi>d</mi>
    </mrow>
    <mi>t</mi>
   </mrow>
   <mo stretchy="false">âŸ©</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>Q</ci>
      </apply>
      <ci>d</ci>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \langle dQ/dt\rangle
  </annotation>
 </semantics>
</math>

 with kinetic energy 

<math display="block" id="Virial_theorem:41">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo stretchy="false">âŸ¨</mo>
      <mi>T</mi>
      <mo stretchy="false">âŸ©</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
      <mi>n</mi>
     </munder>
     <mrow>
      <mo stretchy="false">âŸ¨</mo>
      <mrow>
       <msub>
        <mi>X</mi>
        <mi>n</mi>
       </msub>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>V</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <msub>
          <mi>X</mi>
          <mi>n</mi>
         </msub>
        </mrow>
       </mfrac>
      </mrow>
      <mo stretchy="false">âŸ©</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <ci>T</ci>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>X</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>V</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>X</ci>
          <ci>n</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\langle T\rangle=\sum_{n}\langle X_{n}\frac{dV}{dX_{n}}\rangle.
  </annotation>
 </semantics>
</math>

. The left-hand side of this equation is just 

<math display="inline" id="Virial_theorem:42">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <mi>ğ©</mi>
    </mrow>
    <mo>â‹…</mo>
    <mi>ğ¯</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>T</ci>
    <apply>
     <ci>normal-â‹…</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <ci>ğ©</ci>
     </apply>
     <ci>ğ¯</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=\frac{1}{2}\mathbf{p}\cdot\mathbf{v}
  </annotation>
 </semantics>
</math>

, according to the <a href="Heisenberg_equation" title="wikilink">Heisenberg equation</a> of motion. The expectation value 

<math display="inline" id="Virial_theorem:43">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>Î³</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>m</mi>
    <mpadded width="+1.7pt">
     <msup>
      <mi>c</mi>
      <mn>2</mn>
     </msup>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>T</ci>
    <apply>
     <times></times>
     <apply>
      <minus></minus>
      <ci>Î³</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>m</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>c</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=(\gamma-1)mc^{2}\,
  </annotation>
 </semantics>
</math>

 of that time derivative vanishes in a stationary state, hence we obtain the quantum virial theorem</p>

<p>

<math display="inline" id="Virial_theorem:44">
 <semantics>
  <mrow>
   <mrow>
    <mstyle displaystyle="true">
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </mstyle>
    <mi>ğ©</mi>
   </mrow>
   <mo>â‹…</mo>
   <mi>ğ¯</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-â‹…</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
     </apply>
     <ci>ğ©</ci>
    </apply>
    <ci>ğ¯</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{1}{2}\mathbf{p}\cdot\mathbf{v}
  </annotation>
 </semantics>
</math>


</p>
<h2 id="in-special-relativity">In special relativity</h2>

<p>For a single particle in special relativity, it is not the case that 

<math display="inline" id="Virial_theorem:45">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msqrt>
       <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
         <mi>Î²</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </msqrt>
     </mrow>
     <mn>2</mn>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <cn type="integer">1</cn>
      <apply>
       <root></root>
       <apply>
        <minus></minus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>Î²</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{1+\sqrt{1-\beta^{2}}}{2}\right)T
  </annotation>
 </semantics>
</math>

. Instead, it is true that 

<math display="inline" id="Virial_theorem:46">
 <semantics>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mfrac>
     <mrow>
      <mi>Î³</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>Î³</mi>
     </mrow>
    </mfrac>
    <mo>)</mo>
   </mrow>
   <mi>T</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <ci>Î³</ci>
      <cn type="integer">1</cn>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>Î³</ci>
     </apply>
    </apply>
    <ci>T</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left(\frac{\gamma+1}{2\gamma}\right)T
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="inline" id="Virial_theorem:47">
 <semantics>
  <mrow>
   <msub>
    <mi>ğ…</mi>
    <mrow>
     <mi>j</mi>
     <mi>k</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <mo>-</mo>
    <msub>
     <mi>ğ…</mi>
     <mrow>
      <mi>k</mi>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>ğ…</ci>
     <apply>
      <times></times>
      <ci>j</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>ğ…</ci>
      <apply>
       <times></times>
       <ci>k</ci>
       <ci>j</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathbf{F}_{jk}=-\mathbf{F}_{kj}
  </annotation>
 </semantics>
</math>

 The last expression can be simplified to either 

<math display="inline" id="Virial_theorem:48">
 <semantics>
  <mi>N</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>N</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   N
  </annotation>
 </semantics>
</math>

 or 

<math display="block" id="Virial_theorem:49">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mi>n</mi>
      <mn>2</mn>
     </mfrac>
     <msub>
      <mrow>
       <mo stretchy="false">âŸ¨</mo>
       <msub>
        <mi>V</mi>
        <mi>TOT</mi>
       </msub>
       <mo stretchy="false">âŸ©</mo>
      </mrow>
      <mi>Ï„</mi>
     </msub>
    </mrow>
    <mo>=</mo>
    <msub>
     <mrow>
      <mo>âŸ¨</mo>
      <mrow>
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
        <mrow>
         <mi>k</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </munderover>
       <mrow>
        <mrow>
         <mo>(</mo>
         <mfrac>
          <mrow>
           <mn>1</mn>
           <mo>+</mo>
           <msqrt>
            <mrow>
             <mn>1</mn>
             <mo>-</mo>
             <msubsup>
              <mi>Î²</mi>
              <mi>k</mi>
              <mn>2</mn>
             </msubsup>
            </mrow>
           </msqrt>
          </mrow>
          <mn>2</mn>
         </mfrac>
         <mo>)</mo>
        </mrow>
        <msub>
         <mi>T</mi>
         <mi>k</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>âŸ©</mo>
     </mrow>
     <mi>Ï„</mi>
    </msub>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <msub>
      <mrow>
       <mo>âŸ¨</mo>
       <mrow>
        <munderover>
         <mo largeop="true" movablelimits="false" symmetric="true">âˆ‘</mo>
         <mrow>
          <mi>k</mi>
          <mo>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>N</mi>
        </munderover>
        <mrow>
         <mrow>
          <mo>(</mo>
          <mfrac>
           <mrow>
            <msub>
             <mi>Î³</mi>
             <mi>k</mi>
            </msub>
            <mo>+</mo>
            <mn>1</mn>
           </mrow>
           <mrow>
            <mn>2</mn>
            <msub>
             <mi>Î³</mi>
             <mi>k</mi>
            </msub>
           </mrow>
          </mfrac>
          <mo>)</mo>
         </mrow>
         <msub>
          <mi>T</mi>
          <mi>k</mi>
         </msub>
        </mrow>
       </mrow>
       <mo>âŸ©</mo>
      </mrow>
      <mi>Ï„</mi>
     </msub>
    </mpadded>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>n</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <ci>TOT</ci>
        </apply>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <plus></plus>
           <cn type="integer">1</cn>
           <apply>
            <root></root>
            <apply>
             <minus></minus>
             <cn type="integer">1</cn>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>Î²</ci>
               <ci>k</ci>
              </apply>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
          </apply>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>T</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>Ï„</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>k</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <apply>
           <plus></plus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>Î³</ci>
            <ci>k</ci>
           </apply>
           <cn type="integer">1</cn>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">2</cn>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>Î³</ci>
            <ci>k</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>T</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
      </apply>
      <ci>Ï„</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{n}{2}\langle V_{\mathrm{TOT}}\rangle_{\tau}=\left\langle\sum_{k=1}^{N}%
\left(\frac{1+\sqrt{1-\beta_{k}^{2}}}{2}\right)T_{k}\right\rangle_{\tau}=\left%
\langle\sum_{k=1}^{N}\left(\frac{\gamma_{k}+1}{2\gamma_{k}}\right)T_{k}\right%
\rangle_{\tau}\,.
  </annotation>
 </semantics>
</math>

.</p>

<p>Thus, under the conditions described in earlier sections (including <a href="Newton's_third_law_of_motion" title="wikilink">Newton's third law of motion</a>, 

<math display="block" id="Virial_theorem:50">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mn>2</mn>
      <mrow>
       <mo stretchy="false">âŸ¨</mo>
       <msub>
        <mi>T</mi>
        <mi>TOT</mi>
       </msub>
       <mo stretchy="false">âŸ©</mo>
      </mrow>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mrow>
       <mo stretchy="false">âŸ¨</mo>
       <msub>
        <mi>V</mi>
        <mi>TOT</mi>
       </msub>
       <mo stretchy="false">âŸ©</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>âˆˆ</mo>
    <mrow>
     <mo>[</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo rspace="4.2pt">]</mo>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <in></in>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>T</ci>
        <ci>TOT</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>V</ci>
        <ci>TOT</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <interval closure="closed">
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
    </interval>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{2\langle T_{\mathrm{TOT}}\rangle}{n\langle V_{\mathrm{TOT}}\rangle}\in%
\left[1,2\right]\,,
  </annotation>
 </semantics>
</math>

, despite relativity), the time average for 

<math display="inline" id="Virial_theorem:51">
 <semantics>
  <mrow>
   <mrow>
    <mn>2</mn>
    <mrow>
     <munder>
      <mo movablelimits="false">lim</mo>
      <mrow>
       <mi>Ï„</mi>
       <mo>â†’</mo>
       <mrow>
        <mo>+</mo>
        <mi mathvariant="normal">âˆ</mi>
       </mrow>
      </mrow>
     </munder>
     <msub>
      <mrow>
       <mo stretchy="false">âŸ¨</mo>
       <mi>T</mi>
       <mo stretchy="false">âŸ©</mo>
      </mrow>
      <mi>Ï„</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>Ï„</mi>
      <mo>â†’</mo>
      <mrow>
       <mo>+</mo>
       <mi mathvariant="normal">âˆ</mi>
      </mrow>
     </mrow>
    </munder>
    <msub>
     <mrow>
      <mo stretchy="false">âŸ¨</mo>
      <mi>U</mi>
      <mo stretchy="false">âŸ©</mo>
     </mrow>
     <mi>Ï„</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <cn type="integer">2</cn>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <limit></limit>
       <apply>
        <ci>normal-â†’</ci>
        <ci>Ï„</ci>
        <apply>
         <plus></plus>
         <infinity></infinity>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <ci>T</ci>
       </apply>
       <ci>Ï„</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-â†’</ci>
       <ci>Ï„</ci>
       <apply>
        <plus></plus>
        <infinity></infinity>
       </apply>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
       <ci>U</ci>
      </apply>
      <ci>Ï„</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   2\lim\limits_{\tau\rightarrow+\infty}\langle T\rangle_{\tau}=\lim\limits_{\tau%
\rightarrow+\infty}\langle U\rangle_{\tau}
  </annotation>
 </semantics>
</math>

 particles with a power law potential is</p>

<p>

<math display="inline" id="Virial_theorem:52">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>Ï„</mi>
      <mo>â†’</mo>
      <mrow>
       <mo>+</mo>
       <mi mathvariant="normal">âˆ</mi>
      </mrow>
     </mrow>
    </munder>
    <mrow>
     <msup>
      <mi>Ï„</mi>
      <mrow>
       <mo>-</mo>
       <mn>2</mn>
      </mrow>
     </msup>
     <mi>I</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>Ï„</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>0.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-â†’</ci>
       <ci>Ï„</ci>
       <apply>
        <plus></plus>
        <infinity></infinity>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Ï„</ci>
       <apply>
        <minus></minus>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>I</ci>
      <ci>Ï„</ci>
     </apply>
    </apply>
    <cn type="float">0.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim\limits_{\tau\rightarrow+\infty}{\tau}^{-2}I(\tau)=0.
  </annotation>
 </semantics>
</math>

 In particular, the ratio of kinetic energy to potential energy is no longer fixed, but necessarily falls into an interval:</p>

<p>

<math display="block" id="Virial_theorem:53">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mfrac>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>2</mn>
        </msup>
        <mi>I</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>t</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mo largeop="true" symmetric="true">âˆ«</mo>
       <mi>V</mi>
      </msub>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mpadded width="+1.7pt">
        <mfrac>
         <mrow>
          <mo>âˆ‚</mo>
          <msub>
           <mi>G</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mrow>
          <mo>âˆ‚</mo>
          <mi>t</mi>
         </mrow>
        </mfrac>
       </mpadded>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <mi>r</mi>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mn>2</mn>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>T</mi>
         <mo>+</mo>
         <mi>U</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>+</mo>
      <msup>
       <mi>W</mi>
       <mi>E</mi>
      </msup>
      <mo>+</mo>
      <msup>
       <mi>W</mi>
       <mi>M</mi>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mo largeop="true" symmetric="true">âˆ«</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>p</mi>
          <mrow>
           <mi>i</mi>
           <mi>k</mi>
          </mrow>
         </msub>
         <mo>+</mo>
         <msub>
          <mi>T</mi>
          <mrow>
           <mi>i</mi>
           <mi>k</mi>
          </mrow>
         </msub>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <mi>d</mi>
       <msub>
        <mi>S</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>I</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>t</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <int></int>
       <ci>V</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>G</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>t</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>d</ci>
        <cn type="integer">3</cn>
       </apply>
       <ci>r</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <apply>
        <plus></plus>
        <ci>T</ci>
        <ci>U</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>W</ci>
       <ci>E</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>W</ci>
       <ci>M</ci>
      </apply>
     </apply>
     <apply>
      <int></int>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>p</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>T</ci>
         <apply>
          <times></times>
          <ci>i</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <ci>d</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>S</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{1}{2}\frac{d^{2}I}{dt^{2}}+\int_{V}x_{k}\frac{\partial G_{k}}{\partial t%
}\,d^{3}r=2(T+U)+W^{E}+W^{M}-\int x_{k}(p_{ik}+T_{ik})\,dS_{i},
  </annotation>
 </semantics>
</math>

 where the more relativistic systems exhibit the larger ratios.</p>
<h2 id="generalizations">Generalizations</h2>

<p>Lord Rayleigh published a generalization of the virial theorem in 1903.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> <a href="Henri_PoincarÃ©" title="wikilink">Henri PoincarÃ©</a> applied a form of the virial theorem in 1911 to the problem of determining cosmological stability.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> A variational form of the virial theorem was developed in 1945 by Ledoux.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> A <a class="uri" href="tensor" title="wikilink">tensor</a> form of the virial theorem was developed by Parker,<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> Chandrasekhar<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> and Fermi.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> The following generalization of the virial theorem has been established by Pollard in 1964 for the case of the inverse square law:<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a><a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> the statement 

<math display="block" id="Virial_theorem:54">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>p</mi>
     <mrow>
      <mi>i</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi mathvariant="normal">Î£</mi>
      <msup>
       <mi>n</mi>
       <mi>Ïƒ</mi>
      </msup>
      <msup>
       <mi>m</mi>
       <mi>Ïƒ</mi>
      </msup>
      <msup>
       <mrow>
        <mo stretchy="false">âŸ¨</mo>
        <mrow>
         <msub>
          <mi>v</mi>
          <mi>i</mi>
         </msub>
         <msub>
          <mi>v</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <mo stretchy="false">âŸ©</mo>
       </mrow>
       <mi>Ïƒ</mi>
      </msup>
     </mrow>
     <mo>-</mo>
     <mrow>
      <msub>
       <mi>V</mi>
       <mi>i</mi>
      </msub>
      <msub>
       <mi>V</mi>
       <mi>k</mi>
      </msub>
      <mi mathvariant="normal">Î£</mi>
      <msup>
       <mi>m</mi>
       <mi>Ïƒ</mi>
      </msup>
      <msup>
       <mi>n</mi>
       <mi>Ïƒ</mi>
      </msup>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>p</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>normal-Î£</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <ci>Ïƒ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <ci>Ïƒ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="latexml">delimited-âŸ¨âŸ©</csymbol>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>v</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <ci>Ïƒ</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>V</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-Î£</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>m</ci>
       <ci>Ïƒ</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>n</ci>
       <ci>Ïƒ</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   p_{ik}=\Sigma n^{\sigma}m^{\sigma}\langle v_{i}v_{k}\rangle^{\sigma}-V_{i}V_{k%
}\Sigma m^{\sigma}n^{\sigma},
  </annotation>
 </semantics>
</math>

 is true if and only if 

<math display="block" id="Virial_theorem:55">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>T</mi>
     <mrow>
      <mi>i</mi>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mrow>
          <msub>
           <mi>Îµ</mi>
           <mn>0</mn>
          </msub>
          <msup>
           <mi>E</mi>
           <mn>2</mn>
          </msup>
         </mrow>
         <mn>2</mn>
        </mfrac>
        <mo>+</mo>
        <mfrac>
         <msup>
          <mi>B</mi>
          <mn>2</mn>
         </msup>
         <mrow>
          <mn>2</mn>
          <msub>
           <mi>Î¼</mi>
           <mn>0</mn>
          </msub>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <msub>
       <mi>Î´</mi>
       <mrow>
        <mi>i</mi>
        <mi>k</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mrow>
        <msub>
         <mi>Îµ</mi>
         <mn>0</mn>
        </msub>
        <msub>
         <mi>E</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>E</mi>
         <mi>k</mi>
        </msub>
       </mrow>
       <mo>+</mo>
       <mfrac>
        <mrow>
         <msub>
          <mi>B</mi>
          <mi>i</mi>
         </msub>
         <msub>
          <mi>B</mi>
          <mi>k</mi>
         </msub>
        </mrow>
        <msub>
         <mi>Î¼</mi>
         <mn>0</mn>
        </msub>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>T</ci>
     <apply>
      <times></times>
      <ci>i</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <apply>
       <plus></plus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Îµ</ci>
          <cn type="integer">0</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>E</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>B</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>Î¼</ci>
          <cn type="integer">0</cn>
         </apply>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Î´</ci>
       <apply>
        <times></times>
        <ci>i</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Îµ</ci>
        <cn type="integer">0</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>E</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>B</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>Î¼</ci>
        <cn type="integer">0</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T_{ik}=\left(\frac{\varepsilon_{0}E^{2}}{2}+\frac{B^{2}}{2\mu_{0}}\right)%
\delta_{ik}-\left(\varepsilon_{0}E_{i}E_{k}+\frac{B_{i}B_{k}}{\mu_{0}}\right).
  </annotation>
 </semantics>
</math>

 A <em>boundary</em> term otherwise must be added, such as in Ref.<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a></p>
<h2 id="inclusion-of-electromagnetic-fields">Inclusion of electromagnetic fields</h2>

<p>The virial theorem can be extended to include electric and magnetic fields. The result is<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>

<math display="block" id="Virial_theorem:56">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <mi>Ï„</mi>
    </mpadded>
    <mo>âˆ¼</mo>
    <mrow>
     <mi>R</mi>
     <mo>/</mo>
     <msub>
      <mi>c</mi>
      <mi>s</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="latexml">similar-to</csymbol>
    <ci>Ï„</ci>
    <apply>
     <divide></divide>
     <ci>R</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>c</ci>
      <ci>s</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \tau\,\sim R/c_{s},
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>I</em> is the <a href="moment_of_inertia" title="wikilink">moment of inertia</a>, <em>G</em> is the <a href="Poynting_vector" title="wikilink">momentum density of the electromagnetic field</a>, <em>T</em> is the <a href="kinetic_energy" title="wikilink">kinetic energy</a> of the "fluid", <em>U</em> is the random "thermal" energy of the particles, <em>W<sup>E</sup></em> and <em>W<sup>M</sup></em> are the electric and magnetic energy content of the volume considered. Finally, <em>p<sub>ik</sub></em> is the fluid-pressure tensor expressed in the local moving coordinate system</p>

<p>

<math display="block" id="Virial_theorem:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mn>3</mn>
      <mn>5</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <mi>G</mi>
       <mi>M</mi>
      </mrow>
      <mi>R</mi>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>3</mn>
      <mn>2</mn>
     </mfrac>
     <mfrac>
      <mrow>
       <msub>
        <mi>k</mi>
        <mi>B</mi>
       </msub>
       <mi>T</mi>
      </mrow>
      <msub>
       <mi>m</mi>
       <mi>p</mi>
      </msub>
     </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
     <msup>
      <mi>v</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">5</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>G</ci>
        <ci>M</ci>
       </apply>
       <ci>R</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>B</ci>
        </apply>
        <ci>T</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <ci>p</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{3}{5}\frac{GM}{R}=\frac{3}{2}\frac{k_{B}T}{m_{p}}=\frac{1}{2}v^{2},
  </annotation>
 </semantics>
</math>

</p>

<p>and <em>T<sub>ik</sub></em> is the electromagnetic stress tensor,</p>

<p>

<math display="inline" id="Virial_theorem:58">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

</p>

<p>A <a class="uri" href="plasmoid" title="wikilink">plasmoid</a> is a finite configuration of magnetic fields and plasma. With the virial theorem it is easy to see that any such configuration will expand if not contained by external forces. In a finite configuration without pressure-bearing walls or magnetic coils, the surface integral will vanish. Since all the other terms on the right hand side are positive, the acceleration of the moment of inertia will also be positive. It is also easy to estimate the expansion time Ï„. If a total mass <em>M</em> is confined within a radius <em>R</em>, then the moment of inertia is roughly <em>MR</em><sup>2</sup>, and the left hand side of the virial theorem is <em>MR</em><sup>2</sup>/Ï„<sup>2</sup>. The terms on the right hand side add up to about <em>pR</em><sup>3</sup>, where <em>p</em> is the larger of the plasma pressure or the magnetic pressure. Equating these two terms and solving for Ï„, we find</p>

<p>

<math display="inline" id="Virial_theorem:59">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

</p>

<p>where <em>c<sub>s</sub></em> is the speed of the <a href="ion_acoustic_wave" title="wikilink">ion acoustic wave</a> (or the <a href="AlfvÃ©n_wave" title="wikilink">AlfvÃ©n wave</a>, if the magnetic pressure is higher than the plasma pressure). Thus the lifetime of a plasmoid is expected to be on the order of the acoustic (or AlfvÃ©n) transit time.</p>
<h2 id="in-astrophysics">In astrophysics</h2>

<p>The virial theorem is frequently applied in astrophysics, especially relating the <a href="potential_energy#Gravitational_potential_energy" title="wikilink">gravitational potential energy</a> of a system to its <a href="kinetic_energy" title="wikilink">kinetic</a> or <a href="thermal_energy" title="wikilink">thermal energy</a>. Some common virial relations are,</p>

<p>

<math display="inline" id="Virial_theorem:60">
 <semantics>
  <mi>v</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>v</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   v
  </annotation>
 </semantics>
</math>

</p>

<p>for a mass 

<math display="inline" id="Virial_theorem:61">
 <semantics>
  <mi>T</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>T</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T
  </annotation>
 </semantics>
</math>

, radius 

<math display="inline" id="Virial_theorem:62">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

, velocity 

<math display="inline" id="Virial_theorem:63">
 <semantics>
  <msub>
   <mi>k</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>k</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k_{B}
  </annotation>
 </semantics>
</math>

, and temperature 

<math display="inline" id="Virial_theorem:64">
 <semantics>
  <msub>
   <mi>m</mi>
   <mi>p</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <ci>p</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{p}
  </annotation>
 </semantics>
</math>

. And the constants are <a href="Gravitational_constant" title="wikilink">Newton's constant</a> 

<math display="inline" id="Virial_theorem:65">
 <semantics>
  <mi>Ïƒ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Ïƒ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma
  </annotation>
 </semantics>
</math>

, the <a href="Boltzmann_constant" title="wikilink">Boltzmann constant</a> 

<math display="inline" id="Virial_theorem:66">
 <semantics>
  <mrow>
   <mi>T</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>1</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>v</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>âˆ¼</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mn>3</mn>
      <mo>/</mo>
      <mn>2</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>Ïƒ</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>T</ci>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>v</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">similar-to</csymbol>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>Ïƒ</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   T=(1/2)v^{2}\sim(3/2)\sigma^{2}
  </annotation>
 </semantics>
</math>

, and proton mass 

<math display="block" id="Virial_theorem:67">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>G</mi>
      <mi>M</mi>
     </mrow>
     <mi>R</mi>
    </mfrac>
    <mo>â‰ˆ</mo>
    <msup>
     <mi>Ïƒ</mi>
     <mn>2</mn>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>G</ci>
      <ci>M</ci>
     </apply>
     <ci>R</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>Ïƒ</ci>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{GM}{R}\approx\sigma^{2}.
  </annotation>
 </semantics>
</math>

. Note that these relations are only approximate, and often the leading numerical factors (e.g. 3/5 or 1/2) are neglected entirely.</p>
<h3 id="galaxies-and-cosmology-virial-mass-and-radius">Galaxies and cosmology (virial mass and radius)</h3>

<p>In <a class="uri" href="astronomy" title="wikilink">astronomy</a>, the mass and size of a galaxy (or general overdensity) is often defined in terms of the "virial radius" and "<a href="virial_mass" title="wikilink">virial mass</a>" respectively. Because galaxies and overdensities in continuous fluids can be highly extended (even to infinity in some modelsâ€”e.g. an <a href="singular_isothermal_sphere" title="wikilink">isothermal sphere</a>), it can be hard to define specific, finite measures of their mass and size. The virial theorem, and related concepts, provide an often convenient means by which to quantify these properties.</p>

<p>In galaxy dynamics, the mass of a galaxy is often inferred by measuring the <a href="rotation_velocity" title="wikilink">rotation velocity</a> of its gas and stars, assuming <a href="circular_orbit" title="wikilink">circular Keplerian orbits</a>. Using the virial theorem, the <a href="Velocity_dispersion" title="wikilink">dispersion velocity</a> 

<math display="inline" id="Virial_theorem:68">
 <semantics>
  <mi>R</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>R</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   R
  </annotation>
 </semantics>
</math>

 can be used in a similar way. Taking the kinetic energy (per particle) of the system as, 

<math display="inline" id="Virial_theorem:69">
 <semantics>
  <mi>M</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>M</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M
  </annotation>
 </semantics>
</math>

, and the potential energy (per particle) as, <em>U</em> ~ (3/5)(<em>GM</em>/<em>R</em>), we can write</p>

<p>

<math display="block" id="Virial_theorem:70">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>G</mi>
      <msub>
       <mi>M</mi>
       <mtext>vir</mtext>
      </msub>
     </mrow>
     <msub>
      <mi>R</mi>
      <mtext>vir</mtext>
     </msub>
    </mfrac>
    <mo>â‰ˆ</mo>
    <msubsup>
     <mi>Ïƒ</mi>
     <mi>max</mi>
     <mn>2</mn>
    </msubsup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>G</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <mtext>vir</mtext>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>R</ci>
      <mtext>vir</mtext>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Ïƒ</ci>
      <max></max>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{GM_{\text{vir}}}{R_{\text{vir}}}\approx\sigma_{\max}^{2}.
  </annotation>
 </semantics>
</math>

</p>

<p>Here 

<math display="inline" id="Virial_theorem:71">
 <semantics>
  <mrow>
   <msub>
    <mi>Ï</mi>
    <mtext>crit</mtext>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mn>3</mn>
     <msup>
      <mi>H</mi>
      <mn>2</mn>
     </msup>
    </mrow>
    <mrow>
     <mn>8</mn>
     <mi>Ï€</mi>
     <mi>G</mi>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>Ï</ci>
     <mtext>crit</mtext>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>H</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">8</cn>
      <ci>Ï€</ci>
      <ci>G</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \rho_{\text{crit}}=\frac{3H^{2}}{8\pi G}
  </annotation>
 </semantics>
</math>

 is the radius at which the velocity dispersion is being measured, and 

<math display="inline" id="Virial_theorem:72">
 <semantics>
  <mi>H</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>H</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H
  </annotation>
 </semantics>
</math>

 is the mass within that radius. The virial mass and radius are generally defined for the radius at which the velocity dispersion is a maximum, i.e.</p>

<p>

<math display="inline" id="Virial_theorem:73">
 <semantics>
  <mi>G</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>G</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G
  </annotation>
 </semantics>
</math>

</p>

<p>As numerous approximations have been made, in addition to the approximate nature of these definitions, order-unity proportionality constants are often omitted (as in the above equations). These relations are thus only accurate in an <a href="order_of_magnitude" title="wikilink">order of magnitude</a> sense, or when used self-consistently.</p>

<p>An alternate definition of the virial mass and radius is often used in cosmology where it is used to refer to the radius of a sphere, centered on a <a class="uri" href="galaxy" title="wikilink">galaxy</a> or a <a href="galaxy_cluster" title="wikilink">galaxy cluster</a>, within which virial equilibrium holds. Since this radius is difficult to determine observationally, it is often approximated as the radius within which the average density is greater, by a specified factor, than the <a href="Critical_density_(cosmology)" title="wikilink">critical density</a>, 

<math display="inline" id="Virial_theorem:74">
 <semantics>
  <mrow>
   <msub>
    <mi>r</mi>
    <mtext>vir</mtext>
   </msub>
   <mo>â‰ˆ</mo>
   <msub>
    <mi>r</mi>
    <mn>200</mn>
   </msub>
   <mo>=</mo>
   <mi>r</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>Ï</mi>
    <mo>=</mo>
    <mn>200</mn>
    <mo>â‹…</mo>
    <msub>
     <mi>Ï</mi>
     <mtext>crit</mtext>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <mtext>vir</mtext>
    </apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>r</ci>
     <cn type="integer">200</cn>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">r</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-(</ci>
     <csymbol cd="unknown">Ï</csymbol>
     <eq></eq>
     <cn type="integer">200</cn>
     <ci>normal-â‹…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Ï</ci>
      <mtext>crit</mtext>
     </apply>
     <ci>normal-)</ci>
    </cerror>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   r_{\text{vir}}\approx r_{200}=r(\rho=200\cdot\rho_{\text{crit}})
  </annotation>
 </semantics>
</math>

. Where 

<math display="inline" id="Virial_theorem:75">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mtext>vir</mtext>
   </msub>
   <mo>â‰ˆ</mo>
   <msub>
    <mi>M</mi>
    <mn>200</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>4</mn>
        <mo>/</mo>
        <mn>3</mn>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>Ï€</mi>
      <msubsup>
       <mi>r</mi>
       <mn>200</mn>
       <mn>3</mn>
      </msubsup>
     </mrow>
     <mo>â‹…</mo>
     <mn>200</mn>
    </mrow>
    <msub>
     <mi>Ï</mi>
     <mtext>crit</mtext>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <approx></approx>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <mtext>vir</mtext>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <cn type="integer">200</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <ci>normal-â‹…</ci>
       <apply>
        <times></times>
        <apply>
         <divide></divide>
         <cn type="integer">4</cn>
         <cn type="integer">3</cn>
        </apply>
        <ci>Ï€</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>r</ci>
          <cn type="integer">200</cn>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <cn type="integer">200</cn>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>Ï</ci>
       <mtext>crit</mtext>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{\text{vir}}\approx M_{200}=(4/3)\pi r_{200}^{3}\cdot 200\rho_{\text{crit}}
  </annotation>
 </semantics>
</math>

 is the <a href="Hubble's_law" title="wikilink">Hubble parameter</a> and <span class="LaTeX">$G$</span> is the <a href="gravitational_constant" title="wikilink">gravitational constant</a>. A common (although mostly arbitrary) choice for the factor is 200, in which case the virial radius is approximated as <span class="LaTeX">$r_\text{vir} \approx r_{200}= r(\rho = 200 \cdot \rho_\text{crit})$</span>. The virial mass is then defined relative to this radius as <span class="LaTeX">$M_\text{vir} \approx M_{200} = (4/3)\pi r_{200}^3 \cdot 200 \rho_\text{crit}$</span>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Virial_coefficient" title="wikilink">Virial coefficient</a></li>
<li><a href="Virial_stress" title="wikilink">Virial stress</a></li>
<li><a href="Virial_mass" title="wikilink">Virial mass</a></li>
<li><a href="Derrick's_theorem" title="wikilink">Derrick's theorem (Pohozaev's identity)</a></li>
<li><a href="Equipartition_theorem" title="wikilink">Equipartition theorem</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="further-reading">Further reading</h2>
<ul>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.mathpages.com/home/kmath572/kmath572.htm">The Virial Theorem</a> at MathPages</li>
<li><em><a href="http://hyperphysics.phy-astr.gsu.edu/hbase/astro/gravc.html#c2">Gravitational Contraction and Star Formation</a></em>, Georgia State University</li>
</ul>

<p>"</p>

<p><a href="Category:Physics_theorems" title="wikilink">Category:Physics theorems</a> <a href="Category:Dynamics_(mechanics)" title="wikilink">Category:Dynamics (mechanics)</a> <a href="Category:Solid_mechanics" title="wikilink">Category:Solid mechanics</a> <a href="Category:Concepts_in_physics" title="wikilink">Category:Concepts in physics</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">â†©</a></li>
<li id="fn2">Collins, G. W. (1978). The Virial Theorem in Stellar Astrophysics. Pachart Press. Introduction<a href="#fnref2">â†©</a></li>
<li id="fn3"><a href="#fnref3">â†©</a></li>
<li id="fn4"><a href="#fnref4">â†©</a></li>
<li id="fn5"><a href="#fnref5">â†©</a></li>
<li id="fn6"><a href="#fnref6">â†©</a></li>
<li id="fn7"><a href="#fnref7">â†©</a></li>
<li id="fn8"><a href="#fnref8">â†©</a></li>
<li id="fn9"><a href="#fnref9">â†©</a></li>
<li id="fn10"><a href="#fnref10">â†©</a></li>
<li id="fn11"><a href="#fnref11">â†©</a></li>
<li id="fn12"><a href="#fnref12">â†©</a></li>
<li id="fn13"><a href="#fnref13">â†©</a></li>
</ol>
</section>
</body>
</html>

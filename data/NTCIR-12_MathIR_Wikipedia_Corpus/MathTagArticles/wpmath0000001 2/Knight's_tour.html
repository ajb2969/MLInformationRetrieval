<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1178">Knight's tour</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Knight's tour</h1>
<hr/>

<p>A <strong>knight's tour</strong> is a sequence of moves of a knight on a <a class="uri" href="chessboard" title="wikilink">chessboard</a> such that the knight visits every square only once. If the knight ends on a square that is one knight's move from the beginning square (so that it could tour the board again immediately, following the same path), the tour is <em>closed</em>, otherwise it is <em>open</em>.</p>

<p>The <strong>knight's tour problem</strong> is the <a href="Mathematical_chess_problem" title="wikilink">mathematical problem</a> of finding a knight's tour. Creating a program to find a knight's tour is a common problem given to <a href="computer_science" title="wikilink">computer science</a> students.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> Variations of the knight's tour problem involve chessboards of different sizes than the usual 8 × 8, as well as irregular (non-rectangular) boards.</p>
<h2 id="theory">Theory</h2>
<figure><b>(Figure)</b>
<figcaption><a href="Knight's_graph" title="wikilink">Knight's graph</a> showing all possible paths for a knight's tour on a standard 8×8 chessboard. The numbers on each node indicate the number of possible moves that can be made from that position.</figcaption>
</figure>

<p>The knight's tour problem is an instance of the more general <a href="Hamiltonian_path_problem" title="wikilink">Hamiltonian path problem</a> in <a href="graph_theory" title="wikilink">graph theory</a>. The problem of finding a closed knight's tour is similarly an instance of the <a href="Hamiltonian_cycle_problem" title="wikilink">Hamiltonian cycle problem</a>. Unlike the general <a href="Hamiltonian_path_problem" title="wikilink">Hamiltonian path problem</a>, the knight's tour problem can be solved in <a href="linear_time" title="wikilink">linear time</a>.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> </p>
<h2 id="history">History</h2>
<figure><b>(Figure)</b>
<figcaption>The knight's tour as solved by <a href="the_Turk" title="wikilink">the Turk</a>, a chess-playing machine hoax. This particular solution is closed (circular), and can thus be completed from any point on the board.</figcaption>
</figure>

<p>The earliest known reference to the knight's tour problem dates back to the 9th century AD. In Rudraṭa's <em><a class="uri" href="Kavyalankara" title="wikilink">Kavyalankara</a></em><a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> (5.15), a Sanskrit work on Poetics, the pattern of a knight's tour on a half-board has been presented as an elaborate poetic figure ("citra-alaṅkāra") called the "turagapadabandha" or 'arrangement in the steps of a horse.' The same verse in four lines of eight syllables each can be read from left to right or by following the path of the knight on tour. Since the Indic writing systems used for Sanskrit are syllabic, each syllable can be thought of as representing a square on a chess board. Rudrata's example is as follows:</p>

<p>से ना ली ली ली ना ना ना ली</p>

<p>ली ना ना ना ना ली ली ली ली</p>

<p>न ली ना ली ली ले ना ली ना</p>

<p>ली ली ली ना ना ना ना ना ली</p>

<p>se nā lī lī lī nā nā lī</p>

<p>lī nā nā nā nā lī lī lī</p>

<p>na lī nā lī le nā lī nā</p>

<p>lī lī lī nā nā nā nā lī</p>

<p>For example, the first line can be read from left to right or by moving from the first square to second line, third syllable (2.3) and then to 1.5 to 2.7 to 4.8 to 3.6 to 4.4 to 3.2.</p>

<p>One of the first mathematicians to investigate the knight's tour was <a href="Leonhard_Euler" title="wikilink">Leonhard Euler</a>. The first procedure for completing the Knight's Tour was <a href="Knight's_Tour#Warnsdorf's_rule" title="wikilink">Warnsdorf's rule</a>, first described in 1823 by H. C. von Warnsdorf.</p>

<p>In the 20th century, the <a class="uri" href="Oulipo" title="wikilink">Oulipo</a> group of writers used it among many others. The most notable example is the  Knight's Tour which sets the order of the chapters in <a href="Georges_Perec" title="wikilink">Georges Perec</a>'s novel <em><a href="Life:_A_User's_Manual" title="wikilink">Life: A User's Manual</a></em>. The sixth game of the <a href="2010_World_Chess_Championship" title="wikilink">2010 World Chess Championship</a> between <a href="Viswanathan_Anand" title="wikilink">Viswanathan Anand</a> and <a href="Veselin_Topalov" title="wikilink">Veselin Topalov</a> saw Anand making 13 consecutive knight moves (albeit using both knights); online commentors jested that Anand was trying to solve the Knight's Tour problem during the game.</p>
<h2 id="existence">Existence</h2>

<p>Schwenk<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> proved that for any  board with <em>m</em> ≤ <em>n</em>, a closed knight's tour is always possible <em>unless</em> one or more of these three conditions are met:</p>
<ol>
<li><em>m</em> and <em>n</em> are both odd</li>
<li><em>m</em> = 1, 2, or 4</li>
<li><em>m</em> = 3 and <em>n</em> = 4, 6, or 8.</li>
</ol>

<p>Cull <em>et al.</em> and Conrad <em>et al.</em> proved that on any rectangular board whose smaller dimension is at least 5, there is a (possibly open) knight's tour.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<h2 id="number-of-tours">Number of tours</h2>

<p>On an  board, there are exactly 26,534,728,821,064 <a href="Glossary_of_graph_theory#Direction" title="wikilink">directed</a> closed tours (i.e. two tours along the same path that travel in opposite directions are counted separately, as are rotations and reflections).<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> The number of <em><a href="Glossary_of_graph_theory#Direction" title="wikilink">undirected</a></em> closed tours is half this number, since every tour can be traced in reverse. There are 9,862 undirected closed tours on a  board.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>The number of directed open tours on an 

<math display="inline" id="Knight's_tour:0">
 <semantics>
  <mrow>
   <mi>n</mi>
   <mo>×</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>n</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n\times n
  </annotation>
 </semantics>
</math>

 board for <em>n</em> = 1, 2, … are:</p>
<dl>
<dd>1, 0, 0, 0, 1728, 6637920, 165575218320, 19591828170979904. .
</dd>
</dl>
<h2 id="finding-tours-with-computers">Finding tours with computers</h2>

<p>There are quite a number of ways to find a knight's tour on a given board with a computer. Some of these methods are <a class="uri" href="algorithms" title="wikilink">algorithms</a> while others are <a class="uri" href="heuristics" title="wikilink">heuristics</a>.</p>
<h3 id="brute-force-algorithms">Brute force algorithms</h3>

<p>A <a href="brute-force_search" title="wikilink">brute-force search</a> for a knight's tour is impractical on all but the smallest boards;<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a> for example, on an 8x8 board there are approximately 4×10<sup>51</sup> possible move sequences,<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> and it is well beyond the capacity of modern computers (or networks of computers) to perform operations on such a large set. However the size of this number gives a misleading impression of the difficulty of the problem, which can be solved "by using human insight and ingenuity ... without much difficulty."<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>
<h3 id="divide-and-conquer-algorithms">Divide and conquer algorithms</h3>

<p>By dividing the board into smaller pieces, constructing tours on each piece, and patching the pieces together, one can construct tours on most rectangular boards in <a href="Time_complexity#Polynomial_time" title="wikilink">polynomial time</a>.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a></p>
<h3 id="neural-network-solutions">Neural network solutions</h3>

<p> The Knight's Tour problem also lends itself to being solved by a <a href="neural_network" title="wikilink">neural network</a> implementation.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> The network is set up such that every legal knight's move is represented by a <a href="Artificial_neuron" title="wikilink">neuron</a>, and each neuron is initialized randomly to be either "active" or "inactive" (output of 1 or 0), with 1 implying that the neuron is part of the final solution. Each neuron also has a state function (described below) which is initialized to 0.</p>

<p>When the network is allowed to run, each neuron can change its state and output based on the states and outputs of its neighbors (those exactly one knight's move away) according to the following transition rules:</p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>U_{t+1} (N_{i,j}) = U_t(N_{i,j}) + 2 - \sum_{N \in G(N_{i,j})} V_t(N) </p>
<dl>
<dd><dl>
<dd><math>
</math></dd>
</dl>
</dd>
</dl>

<p>V_{t+1} (N_{i,j}) = \left\{ \begin{array}{ll} 1 &amp; \mbox{if}\,\, U_{t+1}(N_{i,j}) &gt; 3\\ 0 &amp; \mbox{if}\,\, U_{t+1}(N_{i,j}) </p>

<p>where 

<math display="inline" id="Knight's_tour:1">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 represents discrete intervals of time, 

<math display="inline" id="Knight's_tour:2">
 <semantics>
  <mrow>
   <mi>U</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>N</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>U</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   U(N_{i,j})
  </annotation>
 </semantics>
</math>

 is the state of the neuron connecting square 

<math display="inline" id="Knight's_tour:3">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 to square 

<math display="inline" id="Knight's_tour:4">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Knight's_tour:5">
 <semantics>
  <mrow>
   <mi>V</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>N</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>V</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   V(N_{i,j})
  </annotation>
 </semantics>
</math>

 is the output of the neuron from 

<math display="inline" id="Knight's_tour:6">
 <semantics>
  <mi>i</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>i</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   i
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Knight's_tour:7">
 <semantics>
  <mi>j</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>j</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   j
  </annotation>
 </semantics>
</math>

, and 

<math display="inline" id="Knight's_tour:8">
 <semantics>
  <mrow>
   <mi>G</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>N</mi>
     <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>G</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>N</ci>
     <list>
      <ci>i</ci>
      <ci>j</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(N_{i,j})
  </annotation>
 </semantics>
</math>

 is the set of neighbors of the neuron.</p>

<p>Although divergent cases are possible, the network should eventually converge, which occurs when no neuron changes its state from time 

<math display="inline" id="Knight's_tour:9">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

 to 

<math display="inline" id="Knight's_tour:10">
 <semantics>
  <mrow>
   <mi>t</mi>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>t</ci>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t+1
  </annotation>
 </semantics>
</math>

. When the network converges, either the network encodes a knight's tour or a series of two or more independent circuits within the same board.</p>
<h3 id="warnsdorfs-rule">Warnsdorf's rule</h3>
<figure><b>(Figure)</b>
<figcaption>A very large (130x130) square open Knight's Tour created using Warnsdorff's Rule.</figcaption>
</figure>

<p>Warnsdorf's rule is a <a class="uri" href="heuristic" title="wikilink">heuristic</a> for finding a knight's tour. We move the knight so that we always proceed to the square from which the knight will have the <em>fewest</em> onward moves. When calculating the number of onward moves for each candidate square, we do not count moves that revisit any square already visited. It is, of course, possible to have two or more choices for which the number of onward moves is equal; there are various methods for breaking such ties, including one devised by Pohl <a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> and another by Squirrel and Cull.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>This rule may also more generally be applied to any graph. In graph-theoretic terms, each move is made to the adjacent vertex with the least <a href="degree_(graph_theory)" title="wikilink">degree</a>. Although the <a href="Hamiltonian_path_problem" title="wikilink">Hamiltonian path problem</a> is <a class="uri" href="NP-hard" title="wikilink">NP-hard</a> in general, on many graphs that occur in practice this heuristic is able to successfully locate a solution in <a href="linear_time" title="wikilink">linear time</a>.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> The knight's tour is a special case.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></p>

<p>The <a class="uri" href="heuristic" title="wikilink">heuristic</a> was first described in "Des Rösselsprungs einfachste und allgemeinste Lösung" by H. C. von Warnsdorf in 1823.<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> A computer program that finds a Knight's Tour for any starting position using Warnsdorf's rule can be found in the book 'Century/Acorn User Book of Computer Puzzles' edited by Simon Dally (ISBN 071260541X).</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Abu-Bakr_Muhammad_ben_Yahya_as-Suli" title="wikilink">Abu-Bakr Muhammad ben Yahya as-Suli</a></li>
<li><a href="George_Koltanowski" title="wikilink">George Koltanowski</a></li>
<li><a href="Longest_uncrossed_knight's_path" title="wikilink">Longest uncrossed knight's path</a></li>
<li><a href="Eight_queens_puzzle" title="wikilink">Eight queens puzzle</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>

<p>[<a class="uri" href="http://books.google.co.uk/books?id=w5FZAAAAYAAJ&amp;printsec">http://books.google.co.uk/books?id=w5FZAAAAYAAJ&amp;printsec;</a>;=frontcover&amp;dq;=h.+c.+von+warnsdorf&amp;hl;=en&amp;sa;=X&amp;ei;=2QZmU9-jJIaXO8-hgKgL&amp;ved;=0CDEQ6AEwAA#v=onepage&amp;q;=h.%20c.%20von%20warnsdorf&amp;f;=false H. C. von Warnsdorf 1823 in Google Books] "</p>

<p><a href="Category:Graph_algorithms" title="wikilink">Category:Graph algorithms</a> <a href="Category:Mathematical_chess_problems" title="wikilink">Category:Mathematical chess problems</a> <a href="Category:Chess_problems" title="wikilink">Category:Chess problems</a> <a href="Category:Hamiltonian_paths_and_cycles" title="wikilink">Category:Hamiltonian paths and cycles</a> <a href="Category:Mathematical_problems" title="wikilink">Category:Mathematical problems</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1">H. M. Deitel, P. J. Deitel. "Java How To Program Fifth Edition." <em>Prentice Hall</em>, Upper Saddle River, New Jersey, pp. 326–328. 2003.<a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"></li>
<li id="fn6"></li>
<li id="fn7"> <strong>Remark:</strong> The authors later <a href="http://www.combinatorics.org/ojs/index.php/eljc/article/view/v3i1r5/comment">admitted</a> that the announced number is incorrect. According to McKay's report, the correct number is 13,267,364,410,532 and this number is repeated in Wegener's 2000 book.<a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"><mtpl></mtpl><a href="#fnref11">↩</a></li>
<li id="fn12"><a href="#fnref12">↩</a></li>
<li id="fn13"></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16">Y. Takefuji, K. C. Lee. "Neural network computing for knight's tour problems." <em>Neurocomputing</em>, 4(5):249–254, 1992.<a href="#fnref16">↩</a></li>
<li id="fn17"></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1366">Total harmonic distortion</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Total harmonic distortion</h1>
<hr/>

<p>The <strong>total harmonic distortion</strong>, or <strong>THD</strong>, of a <a href="Signal_(electronics)" title="wikilink">signal</a> is a measurement of the <a href="harmonic_distortion" title="wikilink">harmonic distortion</a> present and is defined as the ratio of the sum of the powers of all harmonic components to the power of the <a href="fundamental_frequency" title="wikilink">fundamental frequency</a>. THD is used to characterize the linearity of audio systems and the power quality of electric power systems. <strong>Distortion factor</strong> is a closely related term, sometimes used as a synonym.</p>

<p>In audio systems, lower distortion means the components in a loudspeaker, amplifier or microphone or other equipment produce a more accurate reproduction of an audio recording.</p>

<p>In radiocommunications, lower THD means pure signal emission without causing interferences to other electronic devices. Moreover, the problem of distorted and not eco-friendly radio emissions appear to be also very important in the context of spectrum sharing and spectrum sensing.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>

<p>In power systems, lower THD means reduction in peak currents, heating, emissions, and core loss in motors.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>
<h2 id="definitions-and-examples">Definitions and examples</h2>

<p>To understand a system with an input and an output, such as an audio amplifier, we start with an ideal system where the <a href="Transfer_Function" title="wikilink">transfer function</a> is <a href="LTI_system_theory" title="wikilink">linear and time-invariant</a>. When a signal passes through a non-ideal, non-linear device, additional content is added at the harmonics of the original frequencies. THD is a measurement of the extent of that distortion.</p>

<p>When the main performance criterion is the ″purity″ of the original sine wave (in other words, the contribution of the original frequency with respect to its harmonics), the measurement is most commonly defined as the ratio of the RMS amplitude of a set of higher <a class="uri" href="harmonic" title="wikilink">harmonic</a> frequencies to the RMS amplitude of the first harmonic, or <a href="fundamental_frequency" title="wikilink">fundamental</a>, frequency<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a><a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a><a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a><a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a><a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a></p>

<p>

<math display="block" id="Total_harmonic_distortion:0">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">F</mi>
    </msub>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mfrac>
    <msqrt>
     <mrow>
      <msubsup>
       <mi>V</mi>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>V</mi>
       <mn>3</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <msubsup>
       <mi>V</mi>
       <mn>4</mn>
       <mn>2</mn>
      </msubsup>
      <mo>+</mo>
      <mi mathvariant="normal">⋯</mi>
     </mrow>
    </msqrt>
    <msub>
     <mi>V</mi>
     <mn>1</mn>
    </msub>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>THD</ci>
     <ci>normal-F</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <root></root>
      <apply>
       <plus></plus>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">3</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>V</ci>
         <cn type="integer">4</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-⋯</ci>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>V</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,=\,\frac{\sqrt{V_{2}^{2}+V_{3}^{2}+V_{4}^{2}+\cdots}}{V_{1}}
  </annotation>
 </semantics>
</math>

 where <em>V<sub>n</sub></em> is the RMS voltage of <em>n</em>th harmonic and <em>n</em> = 1 is the fundamental frequency.</p>

<p>In practice, the THD<sub>F</sub> is commonly used in audio distortion specifications (percentage THD); however, THD is a non-standardized specification and the results between manufacturers are not easily comparable. Since individual harmonic amplitudes are measured, it is required that the manufacturer disclose the test signal frequency range, level and gain conditions, and number of measurements taken. It is possible to measure the full 20–20 kHz range using a sweep (though distortion for a fundamental above 10 kHz is inaudible). For all signal processing equipment, except <a href="Preamplifier" title="wikilink">microphone preamplifiers</a>, the preferred gain setting is unity. For microphone preamplifiers, standard practice is to use maximum gain.</p>

<p>Measurements for calculating the THD are made at the <a class="uri" href="output" title="wikilink">output</a> of a device under specified conditions. The THD is usually expressed in <a class="uri" href="percent" title="wikilink">percent</a> or in <a href="Decibel" title="wikilink">dB</a> relative to the fundamental as distortion attenuation.</p>

<p>A variant definition uses the fundamental plus harmonics as the reference, though usage is discouraged:<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a><a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>

<math display="block" id="Total_harmonic_distortion:1">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">R</mi>
    </msub>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mpadded width="+1.7pt">
    <mfrac>
     <msqrt>
      <mrow>
       <msubsup>
        <mi>V</mi>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>V</mi>
        <mn>3</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>V</mi>
        <mn>4</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </msqrt>
     <msqrt>
      <mrow>
       <msubsup>
        <mi>V</mi>
        <mn>1</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>V</mi>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <msubsup>
        <mi>V</mi>
        <mn>3</mn>
        <mn>2</mn>
       </msubsup>
       <mo>+</mo>
       <mi mathvariant="normal">⋯</mi>
      </mrow>
     </msqrt>
    </mfrac>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mfrac>
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">F</mi>
    </msub>
    <msqrt>
     <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <msubsup>
       <mi>THD</mi>
       <mi mathvariant="normal">F</mi>
       <mn>2</mn>
      </msubsup>
     </mrow>
    </msqrt>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>THD</ci>
      <ci>normal-R</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <cn type="integer">3</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <cn type="integer">4</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
       </apply>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <cn type="integer">1</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>V</ci>
          <cn type="integer">3</cn>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>normal-⋯</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>THD</ci>
       <ci>normal-F</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <cn type="integer">1</cn>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>THD</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>normal-F</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{R}}\,=\,\frac{\sqrt{V_{2}^{2}+V_{3}^{2}+V_{4}^{2}+\cdots}}{\sqrt{%
V_{1}^{2}+V_{2}^{2}+V_{3}^{2}+\cdots}}\,=\,\frac{\mathrm{THD_{F}}}{\sqrt{1+%
\mathrm{THD}^{2}_{\mathrm{F}}}}
  </annotation>
 </semantics>
</math>

 These can be distinguished as <strong>THD<sub>F</sub></strong> (for "fundamental"), and <strong>THD<sub>R</sub></strong> (for "root mean square").<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a><a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> THD<sub>R</sub> cannot exceed 100%. At low distortion levels, the difference between the two calculation methods is negligible. For instance, a signal with THD<sub>F</sub> of 10% has a very similar THD<sub>R</sub> of 9.95%. However, at higher distortion levels the discrepancy becomes large. For instance, a signal with THD<sub>F</sub> 266% has a THD<sub>R</sub> of 94%.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> A pure <a href="square_wave" title="wikilink">square wave</a> with infinite harmonics has THD<sub>F</sub> of 48.3%,<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a><a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a><a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> or THD<sub>R</sub> of 43.5%.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a><a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a></p>

<p>Some use the term "distortion factor" as a synonym for THD<sub>R</sub>,<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> while others use it as a synonym for THD<sub>F</sub>.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a><a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a></p>
<h2 id="thdn">THD+N</h2>

<p><strong>THD+N</strong> means total harmonic distortion plus noise. This measurement is much more common and more comparable between devices. It is usually measured by inputting a <a href="sine_wave" title="wikilink">sine wave</a>, <a href="notch_filter" title="wikilink">notch filtering</a> the output, and comparing the ratio between the output signal with and without the sine wave:<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a></p>

<p>

<math display="block" id="Total_harmonic_distortion:2">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="-3.4pt">
     <mi>THD</mi>
    </mpadded>
    <mo rspace="0pt">+</mo>
    <mi mathvariant="normal">N</mi>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mstyle displaystyle="true">
       <munderover>
        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
        <mrow>
         <mi>n</mi>
         <mo>=</mo>
         <mn>2</mn>
        </mrow>
        <mi mathvariant="normal">∞</mi>
       </munderover>
      </mstyle>
      <mtext>harmonics</mtext>
     </mrow>
     <mo>+</mo>
     <mtext>noise</mtext>
    </mrow>
    <mtext>fundamental</mtext>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <ci>THD</ci>
     <ci>normal-N</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <infinity></infinity>
       </apply>
       <mtext>harmonics</mtext>
      </apply>
      <mtext>noise</mtext>
     </apply>
     <mtext>fundamental</mtext>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD\!\!+\!\!N}=\frac{\displaystyle\sum_{n=2}^{\infty}{\text{harmonics}%
}+\text{noise}}{\text{fundamental}}
  </annotation>
 </semantics>
</math>

</p>

<p>Like the THD measurement, this is a ratio of RMS amplitudes,<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a><a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a> and can be measured as THD<sub>F</sub> (bandpassed or calculated fundamental as the denominator) or, more commonly, as THD<sub>R</sub> (total distorted signal as the denominator). Audio Precision measurements are THD<sub>R</sub>, for instance.<a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a></p>

<p>A meaningful measurement must include the <a href="Bandwidth_(signal_processing)" title="wikilink">bandwidth</a> of measurement. This measurement includes effects from <a href="Ground_loop_(electricity)" title="wikilink">ground loop</a> power line hum, high-frequency interference, <a href="intermodulation_distortion" title="wikilink">intermodulation distortion</a> between these tones and the fundamental, and so on, in addition to harmonic distortion. For psychoacoustic measurements, a weighting curve is applied such as <a class="uri" href="A-weighting" title="wikilink">A-weighting</a> or <a href="ITU-R_BS.468" title="wikilink">ITU-R BS.468</a>, which is intended to accentuate what is most audible to the human ear, contributing to a more accurate measurement.</p>

<p>For a given input frequency and amplitude, THD+N is equal to <a class="uri" href="SINAD" title="wikilink">SINAD</a>, provided that both measurements are made over the same bandwidth.<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a></p>
<h2 id="measurement">Measurement</h2>

<p>The distortion of a waveform relative to a pure sinewave can be measured either by using a <a href="THD_analyzer" title="wikilink">THD analyzer</a> to <a href="Fourier_analysis" title="wikilink">analyse the output wave into its constituent harmonics</a> and noting the amplitude of each relative to the fundamental; or by cancelling out the fundamental with a <a href="notch_filter" title="wikilink">notch filter</a> and measuring the remaining signal, which will be total aggregate harmonic distortion plus noise.</p>

<p>Given a sinewave generator of very low inherent distortion, it can be used as input to amplification equipment, whose distortion at different frequencies and signal levels can be measured by examining the output waveform.</p>

<p>There is electronic equipment both to generate sinewaves and to measure distortion; but a general-purpose <a href="digital_computer" title="wikilink">digital computer</a> equipped with a <a href="sound_card" title="wikilink">sound card</a> can carry out harmonic analysis with suitable software. Different software can be used to generate sinewaves, but the inherent distortion may be too high for measurement of very low-distortion amplifiers.</p>
<h3 id="interpretation">Interpretation</h3>

<p>For many purposes different types of harmonics are not equivalent. For instance, crossover distortion at a given THD is much more audible than clipping distortion at the same THD, since the harmonics produced are at higher frequencies, which are not as easily <a href="Auditory_masking" title="wikilink">masked</a> by the fundamental.<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a> A single THD number is inadequate to specify audibility, and must be interpreted with care. Taking THD measurements at different output levels would expose whether the distortion is clipping (which increases with level) or crossover (which decreases with level).</p>

<p>THD is an average of a number of harmonics equally weighted, even though research performed decades ago identifies that lower order harmonics are harder to hear at the same level, compared with higher order ones. In addition, even order harmonics are said to be generally harder to hear than odd order. A number of formulas that attempt to correlate THD with actual audibility have been published, however none have gained mainstream use.</p>
<h2 id="examples">Examples</h2>

<p>For many standard signals, the above criterion may be calculated analytically in a closed-form.<a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a> For example, a pure <a href="square_wave" title="wikilink">square wave</a> has THD<sub>F</sub> equal to</p>

<p>

<math display="block" id="Total_harmonic_distortion:3">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">F</mi>
    </msub>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <msqrt>
    <mrow>
     <mfrac>
      <msup>
       <mpadded lspace="1.7pt" width="+1.7pt">
        <mi>π</mi>
       </mpadded>
       <mn>2</mn>
      </msup>
      <mn>8</mn>
     </mfrac>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <mn>1</mn>
     </mpadded>
    </mrow>
   </msqrt>
   <mo>≈</mo>
   <mpadded width="+1.7pt">
    <mn>0.483</mn>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mn>48.3</mn>
    <mo lspace="0pt" rspace="3.5pt">%</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>THD</ci>
      <ci>normal-F</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>π</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">8</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">0.483</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">percent</csymbol>
      <cn type="float">48.3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,=\,\sqrt{\frac{\,\pi^{2}}{8}-1\,}\approx\,0.483\,=\,48.3\%
  </annotation>
 </semantics>
</math>

 The <a href="Sawtooth_wave" title="wikilink">sawtooth signal</a> possesses</p>

<p>

<math display="block" id="Total_harmonic_distortion:4">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">F</mi>
    </msub>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <msqrt>
    <mrow>
     <mfrac>
      <msup>
       <mpadded lspace="1.7pt" width="+1.7pt">
        <mi>π</mi>
       </mpadded>
       <mn>2</mn>
      </msup>
      <mn>6</mn>
     </mfrac>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <mn>1</mn>
     </mpadded>
    </mrow>
   </msqrt>
   <mo>≈</mo>
   <mpadded width="+1.7pt">
    <mn>0.803</mn>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mn>80.3</mn>
    <mo lspace="0pt" rspace="3.5pt">%</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>THD</ci>
      <ci>normal-F</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>π</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">6</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">0.803</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">percent</csymbol>
      <cn type="float">80.3</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,=\,\sqrt{\frac{\,\pi^{2}}{6}-1\,}\approx\,0.803\,=\,80.3\%
  </annotation>
 </semantics>
</math>

 The pure symmetrical <a href="triangle_wave" title="wikilink">triangle wave</a> has THD<sub>F</sub> of</p>

<p>

<math display="block" id="Total_harmonic_distortion:5">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">F</mi>
    </msub>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <msqrt>
    <mrow>
     <mfrac>
      <msup>
       <mpadded lspace="1.7pt" width="+1.7pt">
        <mi>π</mi>
       </mpadded>
       <mn>4</mn>
      </msup>
      <mn>96</mn>
     </mfrac>
     <mo>-</mo>
     <mpadded width="+1.7pt">
      <mn>1</mn>
     </mpadded>
    </mrow>
   </msqrt>
   <mo>≈</mo>
   <mpadded width="+1.7pt">
    <mn>0.121</mn>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mn>12.1</mn>
    <mo lspace="0pt" rspace="3.5pt">%</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>THD</ci>
      <ci>normal-F</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>π</ci>
         <cn type="integer">4</cn>
        </apply>
        <cn type="integer">96</cn>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">0.121</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">percent</csymbol>
      <cn type="float">12.1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,=\,\sqrt{\frac{\,\pi^{4}}{96}-1\,}\approx\,0.121\,=\,12.1\%
  </annotation>
 </semantics>
</math>

 For the rectangular <a href="pulse_train" title="wikilink">pulse train</a> with the <em><a href="duty_cycle" title="wikilink">duty cycle</a></em> <em>μ</em> (called sometimes the <em>cyclic ratio</em>), the THD<sub>F</sub> has the form</p>

<p>

<math display="block" id="Total_harmonic_distortion:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mpadded width="+1.7pt">
      <msub>
       <mi>THD</mi>
       <mi mathvariant="normal">F</mi>
      </msub>
     </mpadded>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>μ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mpadded width="+1.7pt">
     <msqrt>
      <mrow>
       <mfrac>
        <mrow>
         <mi>μ</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mi>μ</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mpadded width="+1.7pt">
          <msup>
           <mi>π</mi>
           <mn>2</mn>
          </msup>
         </mpadded>
        </mrow>
        <mrow>
         <mn>2</mn>
         <mrow>
          <msup>
           <mi>sin</mi>
           <mn>2</mn>
          </msup>
          <mrow>
           <mi>π</mi>
           <mi>μ</mi>
          </mrow>
         </mrow>
        </mrow>
       </mfrac>
       <mo>-</mo>
       <mpadded width="+2.8pt">
        <mn>1</mn>
       </mpadded>
      </mrow>
     </msqrt>
    </mpadded>
   </mrow>
   <mo rspace="22.5pt">,</mo>
   <mrow>
    <mn>0</mn>
    <mo><</mo>
    <mi>μ</mi>
    <mo><</mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>THD</ci>
       <ci>normal-F</ci>
      </apply>
      <ci>μ</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>μ</ci>
         <apply>
          <minus></minus>
          <cn type="integer">1</cn>
          <ci>μ</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>π</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <times></times>
         <cn type="integer">2</cn>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <ci>π</ci>
           <ci>μ</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <and></and>
     <apply>
      <lt></lt>
      <cn type="integer">0</cn>
      <ci>μ</ci>
     </apply>
     <apply>
      <lt></lt>
      <share href="#.cmml">
      </share>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,(\mu)=\sqrt{\frac{\mu(1-\mu)\pi^{2}\,}{2\sin^{2}\pi\mu}-1\;}%
\,,\qquad 0<\mu<1
  </annotation>
 </semantics>
</math>

 and logically, reaches the minimum (≈0.483) when the signal becomes symmetrical <em>μ</em>=0.5, <em>i.e.</em> the pure <a href="square_wave" title="wikilink">square wave</a>.<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a> Appropriate filtering of these signals may drastically reduce the resulting THD. For instance, the pure <a href="square_wave" title="wikilink">square wave</a> filtered by the <a href="Butterworth_filter" title="wikilink">Butterworth low-pass filter</a> of the second-order (with the <a href="cutoff_frequency" title="wikilink">cutoff frequency</a> set equal to the fundamental frequency) has THD<sub>F</sub> of 5.3%, while the same signal filtered by the fourth-order filter has THD<sub>F</sub> of 0.6%.<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a> However, analytic computation of the THD<sub>F</sub> for complicated waveforms and filters often represents a difficult task, and the resulting expressions may be quite laborious to obtain. For example, the closed-form expression for the THD<sub>F</sub> of the <a href="sawtooth_wave" title="wikilink">sawtooth wave</a> filtered by the first-order <a href="Butterworth_filter" title="wikilink">Butterworth low-pass filter</a> is simply</p>

<p>

<math display="block" id="Total_harmonic_distortion:7">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">F</mi>
    </msub>
   </mpadded>
   <mo rspace="4.2pt">=</mo>
   <mpadded width="+1.7pt">
    <msqrt>
     <mrow>
      <mfrac>
       <msup>
        <mpadded lspace="1.7pt" width="+1.7pt">
         <mi>π</mi>
        </mpadded>
        <mn>2</mn>
       </msup>
       <mn>3</mn>
      </mfrac>
      <mo>-</mo>
      <mrow>
       <mi>π</mi>
       <mrow>
        <mi>coth</mi>
        <mpadded width="+1.7pt">
         <mi>π</mi>
        </mpadded>
       </mrow>
      </mrow>
     </mrow>
    </msqrt>
   </mpadded>
   <mo>≈</mo>
   <mpadded width="+1.7pt">
    <mn>0.370</mn>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mn>37.0</mn>
    <mo lspace="0pt" rspace="3.5pt">%</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>THD</ci>
      <ci>normal-F</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>π</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <times></times>
        <ci>π</ci>
        <apply>
         <csymbol cd="latexml">hyperbolic-cotangent</csymbol>
         <ci>π</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">0.370</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">percent</csymbol>
      <cn type="float">37.0</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,=\,\sqrt{\frac{\,\pi^{2}}{3}-\pi\coth\pi\,}\,\approx\,0.370%
\,=\,37.0\%
  </annotation>
 </semantics>
</math>

 while that for the same signal filtered by the second-order <a href="Butterworth_filter" title="wikilink">Butterworth filter</a> is given by a rather cumbersome formula<a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a></p>

<p>

<math display="block" id="Total_harmonic_distortion:8">
 <semantics>
  <mrow>
   <mpadded width="+1.7pt">
    <msub>
     <mi>THD</mi>
     <mi mathvariant="normal">F</mi>
    </msub>
   </mpadded>
   <mo>=</mo>
   <mpadded width="+2.8pt">
    <msqrt>
     <mrow>
      <mrow>
       <mrow>
        <mpadded width="+1.7pt">
         <mi>π</mi>
        </mpadded>
        <mpadded width="+1.7pt">
         <mfrac>
          <mrow>
           <mrow>
            <mrow>
             <mpadded lspace="2.8pt" width="+2.8pt">
              <mi>cot</mi>
             </mpadded>
             <mstyle displaystyle="true">
              <mfrac>
               <mi>π</mi>
               <msqrt>
                <mpadded width="+1.7pt">
                 <mn>2</mn>
                </mpadded>
               </msqrt>
              </mfrac>
             </mstyle>
            </mrow>
            <mo>⋅</mo>
            <mrow>
             <msup>
              <mi>coth</mi>
              <mpadded width="-1.7pt">
               <mn>2</mn>
              </mpadded>
             </msup>
             <mstyle displaystyle="true">
              <mfrac>
               <mi>π</mi>
               <msqrt>
                <mpadded width="+1.7pt">
                 <mn>2</mn>
                </mpadded>
               </msqrt>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mrow>
            <mrow>
             <msup>
              <mi>cot</mi>
              <mpadded width="-1.7pt">
               <mn>2</mn>
              </mpadded>
             </msup>
             <mstyle displaystyle="true">
              <mfrac>
               <mi>π</mi>
               <msqrt>
                <mpadded width="+1.7pt">
                 <mn>2</mn>
                </mpadded>
               </msqrt>
              </mfrac>
             </mstyle>
            </mrow>
            <mo>⋅</mo>
            <mrow>
             <mi>coth</mi>
             <mstyle displaystyle="true">
              <mfrac>
               <mi>π</mi>
               <msqrt>
                <mpadded width="+1.7pt">
                 <mn>2</mn>
                </mpadded>
               </msqrt>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mrow>
            <mi>cot</mi>
            <mstyle displaystyle="true">
             <mfrac>
              <mi>π</mi>
              <msqrt>
               <mpadded width="+1.7pt">
                <mn>2</mn>
               </mpadded>
              </msqrt>
             </mfrac>
            </mstyle>
           </mrow>
           <mo>-</mo>
           <mrow>
            <mi>coth</mi>
            <mpadded width="+2.8pt">
             <mstyle displaystyle="true">
              <mfrac>
               <mi>π</mi>
               <msqrt>
                <mpadded width="+1.7pt">
                 <mn>2</mn>
                </mpadded>
               </msqrt>
              </mfrac>
             </mstyle>
            </mpadded>
           </mrow>
          </mrow>
          <mrow>
           <msqrt>
            <mpadded width="+1.7pt">
             <mn>2</mn>
            </mpadded>
           </msqrt>
           <mrow>
            <mo rspace="0.8pt">(</mo>
            <mrow>
             <mrow>
              <msup>
               <mi>cot</mi>
               <mpadded width="-1.7pt">
                <mn>2</mn>
               </mpadded>
              </msup>
              <mstyle displaystyle="true">
               <mfrac>
                <mi>π</mi>
                <msqrt>
                 <mpadded width="+1.7pt">
                  <mn>2</mn>
                 </mpadded>
                </msqrt>
               </mfrac>
              </mstyle>
             </mrow>
             <mo>+</mo>
             <mrow>
              <msup>
               <mi>coth</mi>
               <mpadded width="-1.7pt">
                <mn>2</mn>
               </mpadded>
              </msup>
              <mpadded width="-1.7pt">
               <mstyle displaystyle="true">
                <mfrac>
                 <mi>π</mi>
                 <msqrt>
                  <mpadded width="+1.7pt">
                   <mn>2</mn>
                  </mpadded>
                 </msqrt>
                </mfrac>
               </mstyle>
              </mpadded>
             </mrow>
            </mrow>
            <mo>)</mo>
           </mrow>
          </mrow>
         </mfrac>
        </mpadded>
       </mrow>
       <mo rspace="4.2pt">+</mo>
       <mpadded width="+1.7pt">
        <mfrac>
         <msup>
          <mpadded lspace="1.7pt" width="+1.7pt">
           <mi>π</mi>
          </mpadded>
          <mn>2</mn>
         </msup>
         <mn>3</mn>
        </mfrac>
       </mpadded>
      </mrow>
      <mo>-</mo>
      <mpadded width="+2.8pt">
       <mn>1</mn>
      </mpadded>
     </mrow>
    </msqrt>
   </mpadded>
   <mo>≈</mo>
   <mpadded width="+1.7pt">
    <mn>0.181</mn>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mn>18.1</mn>
    <mo lspace="0pt" rspace="3.5pt">%</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>THD</ci>
      <ci>normal-F</ci>
     </apply>
     <apply>
      <root></root>
      <apply>
       <minus></minus>
       <apply>
        <plus></plus>
        <apply>
         <times></times>
         <ci>π</ci>
         <apply>
          <divide></divide>
          <apply>
           <minus></minus>
           <apply>
            <ci>normal-⋅</ci>
            <apply>
             <cot></cot>
             <apply>
              <divide></divide>
              <ci>π</ci>
              <apply>
               <root></root>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <csymbol cd="latexml">hyperbolic-cotangent</csymbol>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <divide></divide>
              <ci>π</ci>
              <apply>
               <root></root>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <ci>normal-⋅</ci>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <cot></cot>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <divide></divide>
              <ci>π</ci>
              <apply>
               <root></root>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <csymbol cd="latexml">hyperbolic-cotangent</csymbol>
             <apply>
              <divide></divide>
              <ci>π</ci>
              <apply>
               <root></root>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <cot></cot>
            <apply>
             <divide></divide>
             <ci>π</ci>
             <apply>
              <root></root>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
           <apply>
            <csymbol cd="latexml">hyperbolic-cotangent</csymbol>
            <apply>
             <divide></divide>
             <ci>π</ci>
             <apply>
              <root></root>
              <cn type="integer">2</cn>
             </apply>
            </apply>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <root></root>
            <cn type="integer">2</cn>
           </apply>
           <apply>
            <plus></plus>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <cot></cot>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <divide></divide>
              <ci>π</ci>
              <apply>
               <root></root>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <csymbol cd="latexml">hyperbolic-cotangent</csymbol>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <divide></divide>
              <ci>π</ci>
              <apply>
               <root></root>
               <cn type="integer">2</cn>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>π</ci>
          <cn type="integer">2</cn>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <cn type="float">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <approx></approx>
     <share href="#.cmml">
     </share>
     <cn type="float">0.181</cn>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <csymbol cd="latexml">percent</csymbol>
      <cn type="float">18.1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,=\sqrt{\pi\,\frac{\;\cot\dfrac{\pi}{\sqrt{2\,}}\cdot\coth^{2%
\!}\dfrac{\pi}{\sqrt{2\,}}-\cot^{2\!}\dfrac{\pi}{\sqrt{2\,}}\cdot\coth\dfrac{%
\pi}{\sqrt{2\,}}-\cot\dfrac{\pi}{\sqrt{2\,}}-\coth\dfrac{\pi}{\sqrt{2\,}}\;}{%
\sqrt{2\,}\left(\!\cot^{2\!}\dfrac{\pi}{\sqrt{2\,}}+\coth^{2\!}\dfrac{\pi}{%
\sqrt{2\,}}\!\right)}\,+\,\frac{\,\pi^{2}}{3}\,-\,1\;}\;\approx\;0.181\,=\,18.1\%
  </annotation>
 </semantics>
</math>

 Yet, the closed-form expression for the THD<sub>F</sub> of the <a href="pulse_train" title="wikilink">pulse train</a> filtered by the <em>p</em>th-order <a href="Butterworth_filter" title="wikilink">Butterworth low-pass filter</a> is even more complicated and has the following form</p>

<p>

<math display="block" id="Total_harmonic_distortion:9">
 <semantics>
  <mrow>
   <mrow>
    <mpadded width="+1.7pt">
     <msub>
      <mi>THD</mi>
      <mi mathvariant="normal">F</mi>
     </msub>
    </mpadded>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>μ</mi>
     <mo>,</mo>
     <mi>p</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>csc</mi>
    <mrow>
     <mrow>
      <mi>π</mi>
      <mpadded width="+1.7pt">
       <mi>μ</mi>
      </mpadded>
     </mrow>
     <mo rspace="0.8pt">⋅</mo>
     <msqrt>
      <mrow>
       <mrow>
        <mrow>
         <mi>μ</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mn>1</mn>
           <mo>-</mo>
           <mi>μ</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <msup>
          <mi>π</mi>
          <mn>2</mn>
         </msup>
        </mrow>
        <mo rspace="4.2pt">-</mo>
        <mrow>
         <mpadded width="-1.7pt">
          <msup>
           <mi>sin</mi>
           <mn>2</mn>
          </msup>
         </mpadded>
         <mrow>
          <mi>π</mi>
          <mpadded width="+1.7pt">
           <mi>μ</mi>
          </mpadded>
         </mrow>
        </mrow>
        <mo rspace="4.2pt">-</mo>
        <mrow>
         <mfrac>
          <mpadded lspace="1.7pt" width="+1.7pt">
           <mi>π</mi>
          </mpadded>
          <mn>2</mn>
         </mfrac>
         <mrow>
          <munderover>
           <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
           <mrow>
            <mi>s</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mrow>
            <mn>2</mn>
            <mi>p</mi>
           </mrow>
          </munderover>
          <mrow>
           <mfrac>
            <mrow>
             <mi>cot</mi>
             <mrow>
              <mi>π</mi>
              <msub>
               <mi>z</mi>
               <mi>s</mi>
              </msub>
             </mrow>
            </mrow>
            <msubsup>
             <mi>z</mi>
             <mi>s</mi>
             <mn>2</mn>
            </msubsup>
           </mfrac>
           <mrow>
            <mpadded width="-1.7pt">
             <munderover>
              <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
              <mstyle scriptlevel="+1">
               <mtable columnspacing="0.4em" rowspacing="0.2ex">
                <mtr>
                 <mtd>
                  <mrow>
                   <mi>l</mi>
                   <mo>=</mo>
                   <mn>1</mn>
                  </mrow>
                 </mtd>
                </mtr>
                <mtr>
                 <mtd>
                  <mrow>
                   <mi>l</mi>
                   <mo>≠</mo>
                   <mi>s</mi>
                  </mrow>
                 </mtd>
                </mtr>
               </mtable>
              </mstyle>
              <mrow>
               <mn>2</mn>
               <mi>p</mi>
              </mrow>
             </munderover>
            </mpadded>
            <mpadded width="+1.7pt">
             <mfrac>
              <mn>1</mn>
              <mrow>
               <msub>
                <mpadded lspace="1.7pt" width="+1.7pt">
                 <mi>z</mi>
                </mpadded>
                <mi>s</mi>
               </msub>
               <mo>-</mo>
               <mpadded width="+1.7pt">
                <msub>
                 <mi>z</mi>
                 <mi>l</mi>
                </msub>
               </mpadded>
              </mrow>
             </mfrac>
            </mpadded>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
       <mo rspace="4.2pt">+</mo>
       <mrow>
        <mpadded width="+1.7pt">
         <mfrac>
          <mpadded lspace="1.7pt" width="+1.7pt">
           <mi>π</mi>
          </mpadded>
          <mn>2</mn>
         </mfrac>
        </mpadded>
        <mi>Re</mi>
        <mrow>
         <munderover>
          <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
          <mrow>
           <mi>s</mi>
           <mo>=</mo>
           <mn>1</mn>
          </mrow>
          <mrow>
           <mn>2</mn>
           <mi>p</mi>
          </mrow>
         </munderover>
         <mrow>
          <mfrac>
           <msup>
            <mi>e</mi>
            <mrow>
             <mi>i</mi>
             <mi>π</mi>
             <msub>
              <mi>z</mi>
              <mi>s</mi>
             </msub>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mrow>
                <mn>2</mn>
                <mi>μ</mi>
               </mrow>
               <mo>-</mo>
               <mn>1</mn>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </msup>
           <mrow>
            <msubsup>
             <mi>z</mi>
             <mi>s</mi>
             <mn>2</mn>
            </msubsup>
            <mrow>
             <mi>sin</mi>
             <mrow>
              <mi>π</mi>
              <msub>
               <mi>z</mi>
               <mi>s</mi>
              </msub>
             </mrow>
            </mrow>
           </mrow>
          </mfrac>
          <mrow>
           <mpadded width="-1.7pt">
            <munderover>
             <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
             <mstyle scriptlevel="+1">
              <mtable columnspacing="0.4em" rowspacing="0.2ex">
               <mtr>
                <mtd>
                 <mrow>
                  <mi>l</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                 </mrow>
                </mtd>
               </mtr>
               <mtr>
                <mtd>
                 <mrow>
                  <mi>l</mi>
                  <mo>≠</mo>
                  <mi>s</mi>
                 </mrow>
                </mtd>
               </mtr>
              </mtable>
             </mstyle>
             <mrow>
              <mn>2</mn>
              <mi>p</mi>
             </mrow>
            </munderover>
           </mpadded>
           <mpadded width="+1.7pt">
            <mfrac>
             <mn>1</mn>
             <mrow>
              <msub>
               <mpadded lspace="1.7pt" width="+1.7pt">
                <mi>z</mi>
               </mpadded>
               <mi>s</mi>
              </msub>
              <mo>-</mo>
              <mpadded width="+1.7pt">
               <msub>
                <mi>z</mi>
                <mi>l</mi>
               </msub>
              </mpadded>
             </mrow>
            </mfrac>
           </mpadded>
          </mrow>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
     </msqrt>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>THD</ci>
      <ci>normal-F</ci>
     </apply>
     <interval closure="open">
      <ci>μ</ci>
      <ci>p</ci>
     </interval>
    </apply>
    <apply>
     <csc></csc>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <ci>π</ci>
       <ci>μ</ci>
      </apply>
      <apply>
       <root></root>
       <apply>
        <plus></plus>
        <apply>
         <minus></minus>
         <apply>
          <times></times>
          <ci>μ</ci>
          <apply>
           <minus></minus>
           <cn type="integer">1</cn>
           <ci>μ</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>π</ci>
           <cn type="integer">2</cn>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <sin></sin>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <ci>π</ci>
           <ci>μ</ci>
          </apply>
         </apply>
         <apply>
          <times></times>
          <apply>
           <divide></divide>
           <ci>π</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <apply>
             <csymbol cd="ambiguous">subscript</csymbol>
             <sum></sum>
             <apply>
              <eq></eq>
              <ci>s</ci>
              <cn type="integer">1</cn>
             </apply>
            </apply>
            <apply>
             <times></times>
             <cn type="integer">2</cn>
             <ci>p</ci>
            </apply>
           </apply>
           <apply>
            <times></times>
            <apply>
             <divide></divide>
             <apply>
              <cot></cot>
              <apply>
               <times></times>
               <ci>π</ci>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>z</ci>
                <ci>s</ci>
               </apply>
              </apply>
             </apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>z</ci>
               <ci>s</ci>
              </apply>
              <cn type="integer">2</cn>
             </apply>
            </apply>
            <apply>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <csymbol cd="latexml">product</csymbol>
               <apply>
                <ci>STACKED</ci>
                <apply>
                 <eq></eq>
                 <ci>l</ci>
                 <cn type="integer">1</cn>
                </apply>
                <apply>
                 <neq></neq>
                 <ci>l</ci>
                 <ci>s</ci>
                </apply>
               </apply>
              </apply>
              <apply>
               <times></times>
               <cn type="integer">2</cn>
               <ci>p</ci>
              </apply>
             </apply>
             <apply>
              <divide></divide>
              <cn type="integer">1</cn>
              <apply>
               <minus></minus>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>z</ci>
                <ci>s</ci>
               </apply>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>z</ci>
                <ci>l</ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <divide></divide>
          <ci>π</ci>
          <cn type="integer">2</cn>
         </apply>
         <ci>Re</ci>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>s</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <apply>
            <times></times>
            <cn type="integer">2</cn>
            <ci>p</ci>
           </apply>
          </apply>
          <apply>
           <times></times>
           <apply>
            <divide></divide>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <ci>e</ci>
             <apply>
              <times></times>
              <ci>i</ci>
              <ci>π</ci>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>z</ci>
               <ci>s</ci>
              </apply>
              <apply>
               <minus></minus>
               <apply>
                <times></times>
                <cn type="integer">2</cn>
                <ci>μ</ci>
               </apply>
               <cn type="integer">1</cn>
              </apply>
             </apply>
            </apply>
            <apply>
             <times></times>
             <apply>
              <csymbol cd="ambiguous">superscript</csymbol>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>z</ci>
               <ci>s</ci>
              </apply>
              <cn type="integer">2</cn>
             </apply>
             <apply>
              <sin></sin>
              <apply>
               <times></times>
               <ci>π</ci>
               <apply>
                <csymbol cd="ambiguous">subscript</csymbol>
                <ci>z</ci>
                <ci>s</ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
           <apply>
            <apply>
             <csymbol cd="ambiguous">superscript</csymbol>
             <apply>
              <csymbol cd="ambiguous">subscript</csymbol>
              <csymbol cd="latexml">product</csymbol>
              <apply>
               <ci>STACKED</ci>
               <apply>
                <eq></eq>
                <ci>l</ci>
                <cn type="integer">1</cn>
               </apply>
               <apply>
                <neq></neq>
                <ci>l</ci>
                <ci>s</ci>
               </apply>
              </apply>
             </apply>
             <apply>
              <times></times>
              <cn type="integer">2</cn>
              <ci>p</ci>
             </apply>
            </apply>
            <apply>
             <divide></divide>
             <cn type="integer">1</cn>
             <apply>
              <minus></minus>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>z</ci>
               <ci>s</ci>
              </apply>
              <apply>
               <csymbol cd="ambiguous">subscript</csymbol>
               <ci>z</ci>
               <ci>l</ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{THD_{F}}\,(\mu,p)=\csc\pi\mu\,\cdot\!\sqrt{\mu(1-\mu)\pi^{2}-\,\sin^{2%
}\!\pi\mu\,-\,\frac{\,\pi}{2}\sum_{s=1}^{2p}\frac{\cot\pi z_{s}}{z_{s}^{2}}%
\prod\limits_{\scriptstyle l=1\atop\scriptstyle l\neq s}^{2p}\!\frac{1}{\,z_{s%
}-z_{l}\,}\,+\,\frac{\,\pi}{2}\,\mathrm{Re}\sum_{s=1}^{2p}\frac{e^{i\pi z_{s}(%
2\mu-1)}}{z_{s}^{2}\sin\pi z_{s}}\prod\limits_{\scriptstyle l=1\atop%
\scriptstyle l\neq s}^{2p}\!\frac{1}{\,z_{s}-z_{l}\,}\,}
  </annotation>
 </semantics>
</math>

 where <em>μ</em> is the <a href="duty_cycle" title="wikilink">duty cycle</a>, 0 z_l\equiv \exp{\frac{i\pi(2l-1)}{2p}}\,, \qquad l=1, 2,\ldots, 2p  see<a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a> for more details.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Audio_system_measurements" title="wikilink">Audio system measurements</a></li>
<li><a href="Signal-to-noise_ratio" title="wikilink">Signal-to-noise ratio</a></li>
<li><a class="uri" href="Timbre" title="wikilink">Timbre</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.sengpielaudio.com/calculator-thd.htm">Conversion: Distortion attenuation in dB to distortion factor THD in %</a></li>
<li><a href="http://www.rohde-schwarz.com/appnote/1GA56">Swept Harmonic Distortion Measurements</a></li>
<li><a href="http://www.rohde-schwarz.com/appnote/1GA55">Harmonic Distortion Measurements in the Presence of Noise</a></li>
</ul>

<p>"</p>

<p><a href="Category:Electrical_parameters" title="wikilink">Category:Electrical parameters</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="http://www.researchgate.net/publication/260672713_Analytic_Method_for_the_Computation_of_the_Total_Harmonic_Distortion_by_the_Cauchy_Method_of_Residues">Iaroslav Blagouchine and Eric Moreau. <em>Analytic Method for the Computation of the Total Harmonic Distortion by the Cauchy Method of Residues.</em> IEEE Transactions on Communications, vol. 59, no. 9, pp. 2478—2491, September 2011.</a><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="http://www.aspowertechnologies.com/resources/pdf/Total%20Harmonic%20Distortion.pdf">Total Harmonic Distortion and Effects in Electrical Power Systems - Associated Power Technologies</a><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"><a href="http://www.eng.tau.ac.il/~shmilo/10.pdf">On the Definition of Total Harmonic Distortion and Its Effect on Measurement Interpretation</a>, Doron Shmilovitz<a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="http://www.dogstar.dantimax.dk/tubestuf/thdconv.htm">THD Measurement and Conversion</a> "This number indicates the RMS voltage equivalent of total harmonic distortion power, as a percentage of the total output RMS voltage."<a href="#fnref7">↩</a></li>
<li id="fn8"></li>
<li id="fn9">IEEE 519 and other standards (<a href="http://grouper.ieee.org/groups/harmonic/single/docs/P1495D2.doc">draft</a>): "distortion factor: The ratio of the root-mean-square of the harmonic content to the root-mean-square value of the fundamental quantity, often expressed as a percent of the fundamental. Also referred to as total harmonic distortion."<a href="#fnref9">↩</a></li>
<li id="fn10"><a href="http://static.schneider-electric.us/assets/consultingengineer/appguidedocs/section11_0307.pdf">Section 11: Power Quality Considerations Bill Brown, P.E., Square D Engineering Services</a><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12"><a href="http://www.icrepq.com/pdfs/BAPTISTA317.pdf">VOLTAGE WAVE QUALITY IN LOW VOLTAGE POWER SYSTEMS José M. R. Baptista, Manuel R. Cordeiro, and A. Machado e Moura</a><a href="#fnref12">↩</a></li>
<li id="fn13">[<a class="uri" href="http://books.google.com/books?id=xxbvM40Wwa8C&amp;dq">http://books.google.com/books?id=xxbvM40Wwa8C&amp;dq;</a>;=thdf+thdr&amp;source;=gbs_navlinks_s The Power Electronics Handbook] edited by Timothy L. Skvarenina "This definition is used by the Canadian Standards Association and the IEC"<a href="#fnref13">↩</a></li>
<li id="fn14"><a href="http://panelmeters.weschler.com/Asset/AEMC-605-UserManual.pdf">AEMC 605 User Manual</a> "THDf: Total harmonic distortion with respect to the fundamental. THDr: Total harmonic distortion with respect to the true RMS value of the signal."<a href="#fnref14">↩</a></li>
<li id="fn15"><a href="http://www.atecorp.com/ATECorp/media/pdfs/data-sheets/Fluke-39-41B_Datasheet.pdf">39/41B Power Meter Glossary</a><a href="#fnref15">↩</a></li>
<li id="fn16"></li>
<li id="fn17"></li>
<li id="fn18"><a href="http://www.eletrica.ufpr.br/edu/artigos/TeD2004_artigo282.pdf">Total Harmonic Distortion Calculation by Filtering for Power Quality Monitoring</a><a href="#fnref18">↩</a></li>
<li id="fn19">[<a class="uri" href="http://books.google.com/books?id=_LhFxN7sUXEC&amp;lpg">http://books.google.com/books?id=_LhFxN7sUXEC&amp;lpg;</a>;=PA178&amp;ots;=ovMKpXD1QA&amp;dq;=43.5%20%22square%20wave%22%20THD&amp;pg;=PA178#v=onepage&amp;q;=43.5%20%22square%20wave%22%20THD&amp;f;=false Electric Machines By Charles A. Gross]<a href="#fnref19">↩</a></li>
<li id="fn20">[<a href="http://www.wolframalpha.com/input/?i=sqrt%28%281%2F3%29^2%2B%281%2F5%29^2%2B%281%2F7%29^2%2B%281%2F9%29^2%2B">http://www.wolframalpha.com/input/?i=sqrt%28%281%2F3%29^2%2B%281%2F5%29^2%2B%281%2F7%29^2%2B%281%2F9%29^2%2B</a>...%29%2Fsqrt%281^2+%2B+%281%2F3%29^2%2B%281%2F5%29^2%2B%281%2F7%29^2%2B%281%2F9%29^2%2B...%29+in+percent Calculation of harmonic amplitude sum]<a href="#fnref20">↩</a></li>
<li id="fn21"><a href="http://web.archive.org/web/20120911204258/http://vk1od.net/measurement/SquareWave/THD.htm">Total Harmonic Distortion of a square wave</a><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="http://www.amplifier.cd/Tutorial/Klirrfaktor/distortion_factor.htm">Distortion factor</a><a href="#fnref22">↩</a></li>
<li id="fn23">IEEE 519<a href="#fnref23">↩</a></li>
<li id="fn24"><a href="http://energylogix.ca/harmonics_and_ieee.pdf">Harmonics and IEEE 519</a><a href="#fnref24">↩</a></li>
<li id="fn25"><a href="http://www.rane.com/note145.html">Rane audio's definition of both THD and THD+N</a><a href="#fnref25">↩</a></li>
<li id="fn26"></li>
<li id="fn27"><a href="http://www.analog.com/static/imported-files/tutorials/MT-053.pdf">Op Amp Distortion: HD, THD, THD + N, IMD, SFDR, MTPR</a><a href="#fnref27">↩</a></li>
<li id="fn28"><a href="http://www.ap.com/solutions/introtoaudiotest/thd+n">Introduction to the Basic Six Audio Tests</a> "Since the sum of the distortion products will always be less than the total signal, the THD+N Ratio will always be a negative decibel value, or a percent value less than 100%."<a href="#fnref28">↩</a></li>
<li id="fn29"><a href="#fnref29">↩</a></li>
<li id="fn30"><a href="http://sound.westhost.com/valves/valve-trans.html#s33">Distortion - Valves vs. Transistors</a><a href="#fnref30">↩</a></li>
<li id="fn31"></li>
<li id="fn32"></li>
<li id="fn33"></li>
<li id="fn34"></li>
<li id="fn35"></li>
</ol>
</section>
</body>
</html>

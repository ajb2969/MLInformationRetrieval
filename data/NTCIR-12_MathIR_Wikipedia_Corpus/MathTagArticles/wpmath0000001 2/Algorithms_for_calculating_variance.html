<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="14">Algorithms for calculating variance</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Algorithms for calculating variance</h1>
<style>
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
<style>
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</body></html>
<body>
<hr/>

<p><strong>Algorithms for calculating variance</strong> play a major role in <a href="computational_statistics" title="wikilink">computational statistics</a>. A key problem in the design of good <a href="algorithm" title="wikilink">algorithms</a> for this problem is that formulas for the <a class="uri" href="variance" title="wikilink">variance</a> may involve sums of squares, which can lead to <a href="numerical_instability" title="wikilink">numerical instability</a> as well as to <a href="arithmetic_overflow" title="wikilink">arithmetic overflow</a> when dealing with large values.</p>
<h2 id="naïve-algorithm">Naïve algorithm</h2>

<p>A formula for calculating the variance of an entire <a href="statistical_population" title="wikilink">population</a> of size <em>N</em> is:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:0">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>σ</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mrow>
     <mover accent="true">
      <mrow>
       <mo stretchy="false">(</mo>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo stretchy="false">¯</mo>
     </mover>
     <mo>-</mo>
     <msup>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>N</mi>
       </msubsup>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>N</mi>
          </msubsup>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>/</mo>
       <mi>N</mi>
      </mrow>
     </mrow>
     <mi>N</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <ci>normal-¯</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>N</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>N</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
        <ci>N</ci>
       </apply>
      </apply>
      <ci>N</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}=\bar{(x^{2})}-\bar{x}^{2}=\displaystyle\frac{\sum_{i=1}^{N}x_{i}^{2%
}-(\sum_{i=1}^{N}x_{i})^{2}/N}{N}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>Using <a href="Bessel's_correction" title="wikilink">Bessel's correction</a> to calculate an <a href="estimator_bias" title="wikilink">unbiased</a> estimate of the population variance from a finite <a href="statistical_sample" title="wikilink">sample</a> of <em>n</em> observations, the formula is:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:1">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>s</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </msubsup>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </msubsup>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>/</mo>
       <mi>n</mi>
      </mrow>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>s</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s^{2}=\displaystyle\frac{\sum_{i=1}^{n}x_{i}^{2}-(\sum_{i=1}^{n}x_{i})^{2}/n}{%
n-1}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>Therefore, a naive algorithm to calculate the estimated variance is given by the following:</p>
<div style="margin-left: 35px; width: 600px">
<ul>
<li>Let 

<math display="inline" id="Algorithms_for_calculating_variance:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mi mathvariant="normal">←</mi>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>m</mi>
    <mi mathvariant="normal">←</mi>
    <mn>0</mn>
   </mrow>
   <mo>,</mo>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>m</mi>
    <mi>S</mi>
    <mi>q</mi>
    <mi mathvariant="normal">←</mi>
    <mn>0</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>normal-←</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
     <ci>normal-←</ci>
     <cn type="integer">0</cn>
    </apply>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
     <ci>S</ci>
     <ci>q</ci>
     <ci>normal-←</ci>
     <cn type="integer">0</cn>
    </apply>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n←0,Sum←0,SumSq←0
  </annotation>
 </semantics>
</math>

</li>
<li>For each datum 

<math display="inline" id="Algorithms_for_calculating_variance:3">
 <semantics>
  <mi>x</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>x</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x
  </annotation>
 </semantics>
</math>

:
<ul>
<li>

<math display="inline" id="Algorithms_for_calculating_variance:4">
 <semantics>
  <mrow>
   <mrow>
    <mi>n</mi>
    <mi mathvariant="normal">←</mi>
    <mi>n</mi>
   </mrow>
   <mo>+</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>n</ci>
     <ci>normal-←</ci>
     <ci>n</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n←n+1
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Algorithms_for_calculating_variance:5">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>m</mi>
    <mi mathvariant="normal">←</mi>
    <mi>S</mi>
    <mi>u</mi>
    <mi>m</mi>
   </mrow>
   <mo>+</mo>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
     <ci>normal-←</ci>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Sum←Sum+x
  </annotation>
 </semantics>
</math>

</li>
<li>

<math display="inline" id="Algorithms_for_calculating_variance:6">
 <semantics>
  <mrow>
   <mrow>
    <mi>S</mi>
    <mi>u</mi>
    <mi>m</mi>
    <mi>S</mi>
    <mi>q</mi>
    <mi mathvariant="normal">←</mi>
    <mi>S</mi>
    <mi>u</mi>
    <mi>m</mi>
    <mi>S</mi>
    <mi>q</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>x</mi>
    <mi mathvariant="normal">×</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
     <ci>S</ci>
     <ci>q</ci>
     <ci>normal-←</ci>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
     <ci>S</ci>
     <ci>q</ci>
    </apply>
    <apply>
     <times></times>
     <ci>x</ci>
     <ci>normal-×</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SumSq←SumSq+x×x
  </annotation>
 </semantics>
</math>

</li>
</ul></li>
<li>

<math display="inline" id="Algorithms_for_calculating_variance:7">
 <semantics>
  <mrow>
   <mrow>
    <mi>V</mi>
    <mi>a</mi>
    <mi>r</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>S</mi>
       <mi>u</mi>
       <mi>m</mi>
       <mi>S</mi>
       <mi>q</mi>
       <mi mathvariant="normal">−</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>S</mi>
         <mi>u</mi>
         <mi>m</mi>
         <mi mathvariant="normal">×</mi>
         <mi>S</mi>
         <mi>u</mi>
         <mi>m</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>/</mo>
      <mi>n</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>/</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>n</mi>
      <mi mathvariant="normal">−</mi>
      <mn>1</mn>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>V</ci>
     <ci>a</ci>
     <ci>r</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>S</ci>
       <ci>u</ci>
       <ci>m</ci>
       <ci>S</ci>
       <ci>q</ci>
       <ci>normal-−</ci>
       <apply>
        <times></times>
        <ci>S</ci>
        <ci>u</ci>
        <ci>m</ci>
        <ci>normal-×</ci>
        <ci>S</ci>
        <ci>u</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <ci>n</ci>
      <ci>normal-−</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Var=(SumSq−(Sum×Sum)/n)/(n−1)
  </annotation>
 </semantics>
</math>

</li>
</ul>
</div>

<p>This algorithm can easily be adapted to compute the variance of a finite population: simply divide by <em>N</em> instead of <em>n</em> − 1 on the last line.</p>

<p>Because 

<math display="inline" id="Algorithms_for_calculating_variance:8">
 <semantics>
  <mrow>
   <mi>S</mi>
   <mi>u</mi>
   <mi>m</mi>
   <mi>S</mi>
   <mi>q</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>S</ci>
    <ci>u</ci>
    <ci>m</ci>
    <ci>S</ci>
    <ci>q</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   SumSq
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Algorithms_for_calculating_variance:9">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>S</mi>
     <mi>u</mi>
     <mi>m</mi>
     <mi mathvariant="normal">×</mi>
     <mi>S</mi>
     <mi>u</mi>
     <mi>m</mi>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>/</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
     <ci>normal-×</ci>
     <ci>S</ci>
     <ci>u</ci>
     <ci>m</ci>
    </apply>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (Sum×Sum)/n
  </annotation>
 </semantics>
</math>

 can be very similar numbers, <a href="Loss_of_significance" title="wikilink">cancellation</a> can lead to the <a href="precision_(arithmetic)" title="wikilink">precision</a> of the result to be much less than the inherent precision of the <a class="uri" href="floating-point" title="wikilink">floating-point</a> arithmetic used to perform the computation. Thus this algorithm should not be used in practice.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a><a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> This is particularly bad if the standard deviation is small relative to the mean. However, the algorithm can be improved by adopting the method of the <a href="assumed_mean" title="wikilink">assumed mean</a>.</p>
<h3 id="computing-shifted-data">Computing shifted data</h3>

<p>We can use a property of the variance to avoid the catastrophic cancellation in this formula, namely the variance is <a href="Invariant_(mathematics)" title="wikilink">invariant</a> with respect to changes in a <a href="location_parameter" title="wikilink">location parameter</a></p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:10">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mo>-</mo>
       <mi>k</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>Var</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Var</ci>
     <apply>
      <minus></minus>
      <ci>X</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <ci>Var</ci>
     <ci>X</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Var}(X-k)=\operatorname{Var}(X).
  </annotation>
 </semantics>
</math>

</p>

<p>with 

<math display="inline" id="Algorithms_for_calculating_variance:11">
 <semantics>
  <mi>k</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>k</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   k
  </annotation>
 </semantics>
</math>

 any constant, which leads to the new formula</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:12">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>s</mi>
     <mn>2</mn>
    </msup>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </msubsup>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <mi>K</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>-</mo>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mi>x</mi>
             <mi>i</mi>
            </msub>
            <mo>-</mo>
            <mi>K</mi>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo>/</mo>
       <mi>n</mi>
      </mrow>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>s</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <ci>K</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
          <ci>K</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s^{2}=\displaystyle\frac{\sum_{i=1}^{n}(x_{i}-K)^{2}-(\sum_{i=1}^{n}(x_{i}-K))%
^{2}/n}{n-1}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>the closer 

<math display="inline" id="Algorithms_for_calculating_variance:13">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 is to the mean value the more accurate the result will be, but just choosing a value inside the samples range will guarantee the desired stability. If the values 

<math display="inline" id="Algorithms_for_calculating_variance:14">
 <semantics>
  <mrow>
   <mo stretchy="false">(</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>-</mo>
    <mi>K</mi>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
    <ci>K</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (x_{i}-K)
  </annotation>
 </semantics>
</math>

 are small then there are no problems with the sum of its squares, on the contrary, if they are large it necessarily means that the variance is large as well. In any case the second term in the formula is always smaller than the first one therefore no cancellation may occur.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>

<p>If we take just the first sample as 

<math display="inline" id="Algorithms_for_calculating_variance:15">
 <semantics>
  <mi>K</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>K</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K
  </annotation>
 </semantics>
</math>

 the algorithm can be written in <a href="Python_(programming_language)" title="wikilink">Python programming language</a> as</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> shifted_data_variance(data):
   <span class="cf">if</span> <span class="bu">len</span>(data) <span class="op">==</span> <span class="dv">0</span>:
      <span class="cf">return</span> <span class="dv">0</span>
   K <span class="op">=</span> data[<span class="dv">0</span>]
   n <span class="op">=</span> <span class="dv">0</span>
   Sum <span class="op">=</span> <span class="dv">0</span>
   Sum_sqr <span class="op">=</span> <span class="dv">0</span>
   <span class="cf">for</span> x <span class="op">in</span> data:
      n <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span>
      Sum <span class="op">+=</span> x <span class="op">-</span> K
      Sum_sqr <span class="op">+=</span> (x <span class="op">-</span> K) <span class="op">*</span> (x <span class="op">-</span> K)
   variance <span class="op">=</span> (Sum_sqr <span class="op">-</span> (Sum <span class="op">*</span> Sum)<span class="op">/</span>n)<span class="op">/</span>(n <span class="op">-</span> <span class="dv">1</span>)
   <span class="co"># use n instead of (n-1) if want to compute the exact variance of the given data</span>
   <span class="co"># use (n-1) if data are samples of a larger population</span>
   <span class="cf">return</span> variance</code></pre></div>

<p>this formula facilitates as well the incremental computation, that can be expressed as</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">K <span class="op">=</span> <span class="dv">0</span>
n <span class="op">=</span> <span class="dv">0</span>
Ex <span class="op">=</span> <span class="dv">0</span>
Ex2 <span class="op">=</span> <span class="dv">0</span>
 
<span class="kw">def</span> add_variable(x):
    <span class="cf">if</span> (n <span class="op">==</span> <span class="dv">0</span>):
      K <span class="op">=</span> x
    n <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span>
    Ex <span class="op">+=</span> x <span class="op">-</span> K
    Ex2 <span class="op">+=</span> (x <span class="op">-</span> K) <span class="op">*</span> (x <span class="op">-</span> K)
 
<span class="kw">def</span> remove_variable(x):
    n <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span>
    Ex <span class="op">-=</span> (x <span class="op">-</span> K)
    Ex2 <span class="op">-=</span> (x <span class="op">-</span> K) <span class="op">*</span> (x <span class="op">-</span> K)
 
<span class="kw">def</span> get_meanvalue():
   <span class="cf">return</span> K <span class="op">+</span> Ex <span class="op">/</span> n

<span class="kw">def</span> get_variance():
    <span class="cf">return</span> (Ex2 <span class="op">-</span> (Ex<span class="op">*</span>Ex)<span class="op">/</span>n) <span class="op">/</span> (n<span class="dv">-1</span>)</code></pre></div>
<h2 id="two-pass-algorithm">Two-pass algorithm</h2>

<p>An alternative approach, using a different formula for the variance, first computes the sample mean,</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:16">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <msubsup>
      <mo largeop="true" symmetric="true">∑</mo>
      <mrow>
       <mi>j</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </msubsup>
     <msub>
      <mi>x</mi>
      <mi>j</mi>
     </msub>
    </mrow>
    <mi>n</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>j</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>j</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\displaystyle\frac{\sum_{j=1}^{n}x_{j}}{n}
  </annotation>
 </semantics>
</math>

, and then computes the sum of the squares of the differences from the mean,</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:17">
 <semantics>
  <mrow>
   <mi>variance</mi>
   <mo>=</mo>
   <msup>
    <mi>s</mi>
    <mn>2</mn>
   </msup>
   <mo>=</mo>
   <mpadded width="-1.7pt">
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </mfrac>
   </mpadded>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <ci>variance</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>s</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mathrm{variance}=s^{2}=\displaystyle\frac{\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}}{%
n-1}\!
  </annotation>
 </semantics>
</math>

, where s is the standard deviation. This is given by the following pseudocode:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> two_pass_variance(data):
    n    <span class="op">=</span> <span class="dv">0</span>
    sum1 <span class="op">=</span> <span class="dv">0</span>
    sum2 <span class="op">=</span> <span class="dv">0</span>
    
    <span class="cf">for</span> x <span class="op">in</span> data:
        n    <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span>
        sum1 <span class="op">=</span> sum1 <span class="op">+</span> x
    
    mean <span class="op">=</span> sum1 <span class="op">/</span> n

    <span class="cf">for</span> x <span class="op">in</span> data:
        sum2 <span class="op">=</span> sum2 <span class="op">+</span> (x <span class="op">-</span> mean)<span class="op">*</span>(x <span class="op">-</span> mean)
    
    variance <span class="op">=</span> sum2 <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>)
    <span class="cf">return</span> variance</code></pre></div>

<p>This algorithm is numerically stable if <em>n</em> is small.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> However, the results of both of these simple algorithms (I and II) can depend inordinately on the ordering of the data and can give poor results for very large data sets due to repeated roundoff error in the accumulation of the sums. Techniques such as <a href="compensated_summation" title="wikilink">compensated summation</a> can be used to combat this error to a degree.</p>
<h3 id="compensated-variant">Compensated variant</h3>

<p>The compensated-summation version of the algorithm above reads:<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> compensated_variance(data):
    n <span class="op">=</span> <span class="dv">0</span>
    sum1 <span class="op">=</span> <span class="dv">0</span>
    <span class="cf">for</span> x <span class="op">in</span> data:
        n <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span>
        sum1 <span class="op">=</span> sum1 <span class="op">+</span> x
    mean <span class="op">=</span> sum1<span class="op">/</span>n
     
    sum2 <span class="op">=</span> <span class="dv">0</span>
    sum3 <span class="op">=</span> <span class="dv">0</span>
    <span class="cf">for</span> x <span class="op">in</span> data:
        sum2 <span class="op">=</span> sum2 <span class="op">+</span> (x <span class="op">-</span> mean)<span class="op">**</span><span class="dv">2</span>
        sum3 <span class="op">=</span> sum3 <span class="op">+</span> (x <span class="op">-</span> mean)
    variance <span class="op">=</span> (sum2 <span class="op">-</span> sum3<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n)<span class="op">/</span>(n <span class="op">-</span> <span class="dv">1</span>)
    <span class="cf">return</span> variance</code></pre></div>
<h2 id="online-algorithm">Online algorithm</h2>

<p>It is often useful to be able to compute the variance in a single pass, inspecting each value 

<math display="inline" id="Algorithms_for_calculating_variance:18">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>i</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{i}
  </annotation>
 </semantics>
</math>

 only once; for example, when the data are being collected without enough storage to keep all the values, or when costs of memory access dominate those of computation. For such an <a href="online_algorithm" title="wikilink">online algorithm</a>, a <a href="recurrence_relation" title="wikilink">recurrence relation</a> is required between quantities from which the required statistics can be calculated in a numerically stable fashion.</p>

<p>The following formulas can be used to update the <a class="uri" href="mean" title="wikilink">mean</a> and (estimated) variance of the sequence, for an additional element 

<math display="inline" id="Algorithms_for_calculating_variance:19">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>new</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>new</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{\mathrm{new}}
  </annotation>
 </semantics>
</math>

. Here, <em>

<math display="inline" id="Algorithms_for_calculating_variance:20">
 <semantics>
  <mover accent="true">
   <mi>x</mi>
   <mo>¯</mo>
  </mover>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-¯</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \overline{x}
  </annotation>
 </semantics>
</math>

<sub>n</sub></em> denotes the sample mean of the first <em>n</em> samples (<em>x</em><sub>1</sub>, ..., <em>x<sub>n</sub></em>), <em>s</em><sup>2</sup><sub><em>n</em></sub> their sample variance, and <em>σ</em><sup>2</sup><sub><em>n</em></sub> their population variance.</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:21">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mo rspace="4.2pt" stretchy="false">)</mo>
      </mrow>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo>+</mo>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
    </mrow>
    <mi>n</mi>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>+</mo>
    <mpadded width="-1.7pt">
     <mfrac>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mi>n</mi>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{n}=\frac{(n-1)\,\bar{x}_{n-1}+x_{n}}{n}=\bar{x}_{n-1}+\frac{x_{n}-%
\bar{x}_{n-1}}{n}\!
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:22">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>s</mi>
     <mi>n</mi>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mpadded width="+1.7pt">
       <mfrac>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mfrac>
      </mpadded>
      <msubsup>
       <mi>s</mi>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mo>+</mo>
     <mfrac>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mi>n</mi>
     </mfrac>
    </mrow>
   </mrow>
   <mo rspace="12.5pt">,</mo>
   <mrow>
    <mi>n</mi>
    <mo>></mo>
    <mn>1</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>s</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>s</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <apply>
           <ci>normal-¯</ci>
           <ci>x</ci>
          </apply>
          <apply>
           <minus></minus>
           <ci>n</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <gt></gt>
     <ci>n</ci>
     <cn type="integer">1</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s^{2}_{n}=\frac{(n-2)}{(n-1)}\,s^{2}_{n-1}+\frac{(x_{n}-\bar{x}_{n-1})^{2}}{n}%
,\quad n>1
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:23">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>σ</mi>
     <mi>n</mi>
     <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo rspace="4.2pt" stretchy="false">)</mo>
       </mrow>
       <msubsup>
        <mi>σ</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>+</mo>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mrow>
           <mi>n</mi>
           <mo>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>n</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mover accent="true">
           <mi>x</mi>
           <mo stretchy="false">¯</mo>
          </mover>
          <mi>n</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mi>n</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>σ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{n}=\frac{(n-1)\,\sigma^{2}_{n-1}+(x_{n}-\bar{x}_{n-1})(x_{n}-\bar{%
x}_{n})}{n}.
  </annotation>
 </semantics>
</math>

</p>

<p>These formulas suffer from numerical instability. A better quantity for updating is the sum of squares of differences from the (current) mean, 

<math display="inline" id="Algorithms_for_calculating_variance:24">
 <semantics>
  <mrow>
   <msubsup>
    <mo largeop="true" symmetric="true">∑</mo>
    <mrow>
     <mi>i</mi>
     <mo>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </msubsup>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mi>n</mi>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <sum></sum>
      <apply>
       <eq></eq>
       <ci>i</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <cn type="integer">2</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\sum_{i=1}^{n}(x_{i}-\bar{x}_{n})^{2}
  </annotation>
 </semantics>
</math>

, here denoted 

<math display="inline" id="Algorithms_for_calculating_variance:25">
 <semantics>
  <msub>
   <mi>M</mi>
   <mrow>
    <mn>2</mn>
    <mo>,</mo>
    <mi>n</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <list>
     <cn type="integer">2</cn>
     <ci>n</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{2,n}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:26">
 <semantics>
  <mrow>
   <mpadded width="-1.7pt">
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>2</mn>
      <mo>,</mo>
      <mi>n</mi>
     </mrow>
    </msub>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>2</mn>
      <mo>,</mo>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </mrow>
    </msub>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <list>
      <cn type="integer">2</cn>
      <ci>n</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">2</cn>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{2,n}\!=M_{2,n-1}+(x_{n}-\bar{x}_{n-1})(x_{n}-\bar{x}_{n})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:27">
 <semantics>
  <mrow>
   <msubsup>
    <mi>s</mi>
    <mi>n</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>2</mn>
      <mo>,</mo>
      <mi>n</mi>
     </mrow>
    </msub>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>s</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </list>
     </apply>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   s^{2}_{n}=\frac{M_{2,n}}{n-1}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:28">
 <semantics>
  <mrow>
   <msubsup>
    <mi>σ</mi>
    <mi>n</mi>
    <mn>2</mn>
   </msubsup>
   <mo>=</mo>
   <mfrac>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>2</mn>
      <mo>,</mo>
      <mi>n</mi>
     </mrow>
    </msub>
    <mi>n</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">2</cn>
       <ci>n</ci>
      </list>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sigma^{2}_{n}=\frac{M_{2,n}}{n}
  </annotation>
 </semantics>
</math>

</p>

<p>A numerically stable algorithm for the sample variance is given below. It also computes the mean. This algorithm is due to Knuth,<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> who cites Welford,<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> and it has been thoroughly analyzed.<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a><a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> It is also common to denote 

<math display="inline" id="Algorithms_for_calculating_variance:29">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>k</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{k}=\bar{x}_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Algorithms_for_calculating_variance:30">
 <semantics>
  <mrow>
   <msub>
    <mi>S</mi>
    <mi>k</mi>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>M</mi>
    <mrow>
     <mn>2</mn>
     <mo>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>S</ci>
     <ci>k</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <list>
      <cn type="integer">2</cn>
      <ci>k</ci>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   S_{k}=M_{2,k}
  </annotation>
 </semantics>
</math>

.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> online_variance(data):
    n <span class="op">=</span> <span class="dv">0</span>
    mean <span class="op">=</span> <span class="fl">0.0</span>
    M2 <span class="op">=</span> <span class="fl">0.0</span>
     
    <span class="cf">for</span> x <span class="op">in</span> data:
        n <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span>
        delta <span class="op">=</span> x <span class="op">-</span> mean
        mean <span class="op">=</span> mean <span class="op">+</span> delta<span class="op">/</span>n
        M2 <span class="op">=</span> M2 <span class="op">+</span> delta<span class="op">*</span>(x <span class="op">-</span> mean)

    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:
        <span class="cf">return</span> <span class="bu">float</span>(<span class="st">'nan'</span>)<span class="op">;</span>
    <span class="cf">else</span>:
        <span class="cf">return</span> M2 <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>)</code></pre></div>

<p>This algorithm is much less prone to loss of precision due to <a href="Catastrophic_cancellation" title="wikilink">massive cancellation</a>, but might not be as efficient because of the division operation inside the loop. For a particularly robust two-pass algorithm for computing the variance, first compute and subtract an estimate of the mean, and then use this algorithm on the residuals.</p>

<p>The <a href="Algorithms_for_calculating_variance#Parallel_algorithm" title="wikilink">parallel algorithm</a> below illustrates how to merge multiple sets of statistics calculated online.</p>
<h2 id="weighted-incremental-algorithm">Weighted incremental algorithm</h2>

<p>The algorithm can be extended to handle unequal sample weights, replacing the simple counter <em>n</em> with the sum of weights seen so far. West (1979)<a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> suggests this incremental algorithm:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> weighted_incremental_variance(dataWeightPairs):
    sumweight <span class="op">=</span> <span class="dv">0</span>
    mean <span class="op">=</span> <span class="dv">0</span>
    M2 <span class="op">=</span> <span class="dv">0</span>

    <span class="cf">for</span> x, weight <span class="op">in</span> dataWeightPairs:  <span class="co"># Alternatively "for x, weight in zip(data, weights):"</span>
        temp <span class="op">=</span> weight <span class="op">+</span> sumweight
        delta <span class="op">=</span> x <span class="op">-</span> mean
        R <span class="op">=</span> delta <span class="op">*</span> weight <span class="op">/</span> temp
        mean <span class="op">=</span> mean <span class="op">+</span> R
        M2 <span class="op">=</span> M2 <span class="op">+</span> sumweight <span class="op">*</span> delta <span class="op">*</span> R  <span class="co"># Alternatively, "M2 = M2 + weight * delta * (x−mean)"</span>
        sumweight <span class="op">=</span> temp

    variance_n <span class="op">=</span> M2<span class="op">/</span>sumweight
    variance <span class="op">=</span> variance_n <span class="op">*</span> <span class="bu">len</span>(dataWeightPairs)<span class="op">/</span>(<span class="bu">len</span>(dataWeightPairs) <span class="op">-</span> <span class="dv">1</span>)</code></pre></div>
<h2 id="parallel-algorithm">Parallel algorithm</h2>

<p>Chan et al.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a> note that the above online algorithm III is a special case of an algorithm that works for any partition of the sample 

<math display="inline" id="Algorithms_for_calculating_variance:31">
 <semantics>
  <mi>X</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>X</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X
  </annotation>
 </semantics>
</math>

 into sets 

<math display="inline" id="Algorithms_for_calculating_variance:32">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>A</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>A</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{A}
  </annotation>
 </semantics>
</math>

, 

<math display="inline" id="Algorithms_for_calculating_variance:33">
 <semantics>
  <msub>
   <mi>X</mi>
   <mi>B</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>X</ci>
    <ci>B</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   X_{B}
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:34">
 <semantics>
  <mrow>
   <mpadded width="-1.7pt">
    <mi>δ</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>B</mi>
    </msub>
    <mo>-</mo>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>A</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>δ</ci>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <ci>B</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <ci>A</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\!=\bar{x}_{B}-\bar{x}_{A}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:35">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>X</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mi>A</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mi>δ</mi>
     <mo>⋅</mo>
     <mfrac>
      <msub>
       <mi>n</mi>
       <mi>B</mi>
      </msub>
      <msub>
       <mi>n</mi>
       <mi>X</mi>
      </msub>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <ci>X</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <ci>A</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <ci>δ</ci>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>B</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>X</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{X}=\bar{x}_{A}+\delta\cdot\frac{n_{B}}{n_{X}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:36">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mrow>
     <mn>2</mn>
     <mo>,</mo>
     <mi>X</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>2</mn>
      <mo>,</mo>
      <mi>A</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>2</mn>
      <mo>,</mo>
      <mi>B</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>δ</mi>
      <mn>2</mn>
     </msup>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>A</mi>
       </msub>
       <msub>
        <mi>n</mi>
        <mi>B</mi>
       </msub>
      </mrow>
      <msub>
       <mi>n</mi>
       <mi>X</mi>
      </msub>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <list>
      <cn type="integer">2</cn>
      <ci>X</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">2</cn>
       <ci>A</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">2</cn>
       <ci>B</ci>
      </list>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>δ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>X</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{2,X}=M_{2,A}+M_{2,B}+\delta^{2}\cdot\frac{n_{A}n_{B}}{n_{X}}
  </annotation>
 </semantics>
</math>

. This may be useful when, for example, multiple processing units may be assigned to discrete parts of the input.</p>

<p>Chan's method for estimating the mean is numerically unstable when 

<math display="inline" id="Algorithms_for_calculating_variance:37">
 <semantics>
  <mrow>
   <msub>
    <mi>n</mi>
    <mi>A</mi>
   </msub>
   <mo>≈</mo>
   <msub>
    <mi>n</mi>
    <mi>B</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <approx></approx>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>A</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>B</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{A}\approx n_{B}
  </annotation>
 </semantics>
</math>

 and both are large, because the numerical error in 

<math display="inline" id="Algorithms_for_calculating_variance:38">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>B</mi>
   </msub>
   <mo>-</mo>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>A</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <minus></minus>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <ci>B</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{B}-\bar{x}_{A}
  </annotation>
 </semantics>
</math>

 is not scaled down in the way that it is in the 

<math display="inline" id="Algorithms_for_calculating_variance:39">
 <semantics>
  <mrow>
   <msub>
    <mi>n</mi>
    <mi>B</mi>
   </msub>
   <mo>=</mo>
   <mn>1</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>n</ci>
     <ci>B</ci>
    </apply>
    <cn type="integer">1</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n_{B}=1
  </annotation>
 </semantics>
</math>

 case. In such cases, prefer 

<math display="inline" id="Algorithms_for_calculating_variance:40">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>X</mi>
   </msub>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>A</mi>
      </msub>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mi>A</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi>B</mi>
      </msub>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mi>B</mi>
      </msub>
     </mrow>
    </mrow>
    <mrow>
     <msub>
      <mi>n</mi>
      <mi>A</mi>
     </msub>
     <mo>+</mo>
     <msub>
      <mi>n</mi>
      <mi>B</mi>
     </msub>
    </mrow>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <ci>X</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>A</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
        <ci>A</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>B</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
        <ci>B</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>A</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>n</ci>
       <ci>B</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{X}=\frac{n_{A}\bar{x}_{A}+n_{B}\bar{x}_{B}}{n_{A}+n_{B}}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="example">Example</h2>

<p>Assume that all floating point operations use the standard <a href="IEEE_754#Double-precision_64_bit" title="wikilink">IEEE 754 double-precision</a> arithmetic. Consider the sample (4, 7, 13, 16) from an infinite population. Based on this sample, the estimated population mean is 10, and the unbiased estimate of population variance is 30. Both Algorithm I and Algorithm II compute these values correctly. Next consider the sample (10<sup>8</sup> + 4, 10<sup>8</sup> + 7, 10<sup>8</sup> + 13, 10<sup>8</sup> + 16), which gives rise to the same estimated variance as the first sample. Algorithm II computes this variance estimate correctly, but Algorithm I returns 29.333333333333332 instead of 30. While this loss of precision may be tolerable and viewed as a minor flaw of Algorithm I, it is easy to find data that reveal a major flaw in the naive algorithm: Take the sample to be (10<sup>9</sup> + 4, 10<sup>9</sup> + 7, 10<sup>9</sup> + 13, 10<sup>9</sup> + 16). Again the estimated population variance of 30 is computed correctly by Algorithm II, but the naive algorithm now computes it as −170.66666666666666. This is a serious problem with Algorithm I and is due to <a href="catastrophic_cancellation" title="wikilink">catastrophic cancellation</a> in the subtraction of two similar numbers at the final stage of the algorithm.</p>
<h2 id="higher-order-statistics">Higher-order statistics</h2>

<p>Terriberry<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> extends Chan's formulae to calculating the third and fourth <a href="central_moment" title="wikilink">central moments</a>, needed for example when estimating <a class="uri" href="skewness" title="wikilink">skewness</a> and <a class="uri" href="kurtosis" title="wikilink">kurtosis</a>:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:41">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mrow>
     <mn>3</mn>
     <mo>,</mo>
     <mi>X</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>3</mn>
      <mo>,</mo>
      <mi>A</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>3</mn>
      <mo>,</mo>
      <mi>B</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>δ</mi>
      <mn>3</mn>
     </msup>
     <mfrac>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>A</mi>
       </msub>
       <msub>
        <mi>n</mi>
        <mi>B</mi>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>n</mi>
          <mi>A</mi>
         </msub>
         <mo>-</mo>
         <msub>
          <mi>n</mi>
          <mi>B</mi>
         </msub>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <msubsup>
       <mi>n</mi>
       <mi>X</mi>
       <mn>2</mn>
      </msubsup>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mn>3</mn>
     <mi>δ</mi>
     <mfrac>
      <mrow>
       <mrow>
        <msub>
         <mi>n</mi>
         <mi>A</mi>
        </msub>
        <msub>
         <mi>M</mi>
         <mrow>
          <mn>2</mn>
          <mo>,</mo>
          <mi>B</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>-</mo>
       <mrow>
        <msub>
         <mi>n</mi>
         <mi>B</mi>
        </msub>
        <msub>
         <mi>M</mi>
         <mrow>
          <mn>2</mn>
          <mo>,</mo>
          <mi>A</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <msub>
       <mi>n</mi>
       <mi>X</mi>
      </msub>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <list>
      <cn type="integer">3</cn>
      <ci>X</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">3</cn>
       <ci>A</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">3</cn>
       <ci>B</ci>
      </list>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>δ</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>B</ci>
        </apply>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>A</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>B</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>X</ci>
        </apply>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <ci>δ</ci>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>A</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>M</ci>
          <list>
           <cn type="integer">2</cn>
           <ci>B</ci>
          </list>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>n</ci>
          <ci>B</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>M</ci>
          <list>
           <cn type="integer">2</cn>
           <ci>A</ci>
          </list>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>X</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{3,X}=M_{3,A}+M_{3,B}+\delta^{3}\frac{n_{A}n_{B}(n_{A}-n_{B})}{n_{X}^{2}}+3%
\delta\frac{n_{A}M_{2,B}-n_{B}M_{2,A}}{n_{X}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="inline" id="Algorithms_for_calculating_variance:42">
 <semantics>
  <mrow>
   <msub>
    <mi>M</mi>
    <mrow>
     <mn>4</mn>
     <mo>,</mo>
     <mi>X</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>4</mn>
      <mo>,</mo>
      <mi>A</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>M</mi>
     <mrow>
      <mn>4</mn>
      <mo>,</mo>
      <mi>B</mi>
     </mrow>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>M</ci>
     <list>
      <cn type="integer">4</cn>
      <ci>X</ci>
     </list>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">4</cn>
       <ci>A</ci>
      </list>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <list>
       <cn type="integer">4</cn>
       <ci>B</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle M_{4,X}=M_{4,A}+M_{4,B}
  </annotation>
 </semantics>
</math>


</p>

<p>Here the 

<math display="inline" id="Algorithms_for_calculating_variance:43">
 <semantics>
  <msub>
   <mi>M</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>M</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{k}
  </annotation>
 </semantics>
</math>

 are again the sums of powers of differences from the mean 

<math display="inline" id="Algorithms_for_calculating_variance:44">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Σ</mi>
   <msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mover accent="true">
       <mi>x</mi>
       <mo>¯</mo>
      </mover>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>k</mi>
   </msup>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Σ</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Sigma(x-\overline{x})^{k}
  </annotation>
 </semantics>
</math>


, giving</p>
<dl>
<dd>skewness

<math display="block" id="Algorithms_for_calculating_variance:45">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>g</mi>
     <mn>1</mn>
    </msub>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msqrt>
       <mi>n</mi>
      </msqrt>
      <msub>
       <mi>M</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <msubsup>
      <mi>M</mi>
      <mn>2</mn>
      <mrow>
       <mn>3</mn>
       <mo>/</mo>
       <mn>2</mn>
      </mrow>
     </msubsup>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <root></root>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">3</cn>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{1}=\frac{\sqrt{n}M_{3}}{M_{2}^{3/2}},
  </annotation>
 </semantics>
</math>


</dd>
<dd>kurtosis

<math display="block" id="Algorithms_for_calculating_variance:46">
 <semantics>
  <mrow>
   <msub>
    <mi>g</mi>
    <mn>2</mn>
   </msub>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <msub>
       <mi>M</mi>
       <mn>4</mn>
      </msub>
     </mrow>
     <msubsup>
      <mi>M</mi>
      <mn>2</mn>
      <mn>2</mn>
     </msubsup>
    </mfrac>
    <mo>-</mo>
    <mn>3.</mn>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>g</ci>
     <cn type="integer">2</cn>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>n</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <cn type="integer">4</cn>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <cn type="integer">2</cn>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <cn type="float">3.</cn>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g_{2}=\frac{nM_{4}}{M_{2}^{2}}-3.
  </annotation>
 </semantics>
</math>


</dd>
</dl>

<p>For the incremental case (i.e., 

<math display="inline" id="Algorithms_for_calculating_variance:47">
 <semantics>
  <mrow>
   <mi>B</mi>
   <mo>=</mo>
   <mrow>
    <mo stretchy="false">{</mo>
    <mi>x</mi>
    <mo stretchy="false">}</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>B</ci>
    <set>
     <ci>x</ci>
    </set>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   B=\{x\}
  </annotation>
 </semantics>
</math>

), this simplifies to:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:48">
 <semantics>
  <mrow>
   <mpadded width="-1.7pt">
    <mi>δ</mi>
   </mpadded>
   <mo>=</mo>
   <mrow>
    <mi>x</mi>
    <mo>-</mo>
    <mi>m</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>δ</ci>
    <apply>
     <minus></minus>
     <ci>x</ci>
     <ci>m</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta\!=x-m
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:49">
 <semantics>
  <mrow>
   <msup>
    <mi>m</mi>
    <mo>′</mo>
   </msup>
   <mo>=</mo>
   <mrow>
    <mi>m</mi>
    <mo>+</mo>
    <mfrac>
     <mi>δ</mi>
     <mi>n</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>m</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <plus></plus>
     <ci>m</ci>
     <apply>
      <divide></divide>
      <ci>δ</ci>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m^{\prime}=m+\frac{\delta}{n}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:50">
 <semantics>
  <mrow>
   <msubsup>
    <mi>M</mi>
    <mn>2</mn>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>M</mi>
     <mn>2</mn>
    </msub>
    <mo>+</mo>
    <mrow>
     <msup>
      <mi>δ</mi>
      <mn>2</mn>
     </msup>
     <mfrac>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
      <mi>n</mi>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <cn type="integer">2</cn>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>δ</ci>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{2}^{\prime}=M_{2}+\delta^{2}\frac{n-1}{n}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:51">
 <semantics>
  <mrow>
   <msubsup>
    <mi>M</mi>
    <mn>3</mn>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>M</mi>
      <mn>3</mn>
     </msub>
     <mo>+</mo>
     <mrow>
      <msup>
       <mi>δ</mi>
       <mn>3</mn>
      </msup>
      <mfrac>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>n</mi>
          <mo>-</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <msup>
        <mi>n</mi>
        <mn>2</mn>
       </msup>
      </mfrac>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mn>3</mn>
      <mi>δ</mi>
      <msub>
       <mi>M</mi>
       <mn>2</mn>
      </msub>
     </mrow>
     <mi>n</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <cn type="integer">3</cn>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <cn type="integer">3</cn>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>δ</ci>
        <cn type="integer">3</cn>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">2</cn>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>n</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">3</cn>
       <ci>δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{3}^{\prime}=M_{3}+\delta^{3}\frac{(n-1)(n-2)}{n^{2}}-\frac{3\delta M_{2}}{n}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:52">
 <semantics>
  <mrow>
   <msubsup>
    <mi>M</mi>
    <mn>4</mn>
    <mo>′</mo>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mrow>
     <msub>
      <mi>M</mi>
      <mn>4</mn>
     </msub>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <msup>
        <mi>δ</mi>
        <mn>4</mn>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <msup>
           <mi>n</mi>
           <mn>2</mn>
          </msup>
          <mo>-</mo>
          <mrow>
           <mn>3</mn>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo>+</mo>
         <mn>3</mn>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <msup>
       <mi>n</mi>
       <mn>3</mn>
      </msup>
     </mfrac>
     <mo>+</mo>
     <mfrac>
      <mrow>
       <mn>6</mn>
       <msup>
        <mi>δ</mi>
        <mn>2</mn>
       </msup>
       <msub>
        <mi>M</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <msup>
       <mi>n</mi>
       <mn>2</mn>
      </msup>
     </mfrac>
    </mrow>
    <mo>-</mo>
    <mfrac>
     <mrow>
      <mn>4</mn>
      <mi>δ</mi>
      <msub>
       <mi>M</mi>
       <mn>3</mn>
      </msub>
     </mrow>
     <mi>n</mi>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>M</ci>
      <cn type="integer">4</cn>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>M</ci>
       <cn type="integer">4</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>δ</ci>
         <cn type="integer">4</cn>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
        <apply>
         <plus></plus>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>n</ci>
           <cn type="integer">2</cn>
          </apply>
          <apply>
           <times></times>
           <cn type="integer">3</cn>
           <ci>n</ci>
          </apply>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <cn type="integer">6</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>δ</ci>
         <cn type="integer">2</cn>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>M</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>n</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <cn type="integer">4</cn>
       <ci>δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>M</ci>
        <cn type="integer">3</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   M_{4}^{\prime}=M_{4}+\frac{\delta^{4}(n-1)(n^{2}-3n+3)}{n^{3}}+\frac{6\delta^{%
2}M_{2}}{n^{2}}-\frac{4\delta M_{3}}{n}
  </annotation>
 </semantics>
</math>

</p>

<p>By preserving the value 

<math display="inline" id="Algorithms_for_calculating_variance:53">
 <semantics>
  <mrow>
   <mi>δ</mi>
   <mo>/</mo>
   <mi>n</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <ci>δ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \delta/n
  </annotation>
 </semantics>
</math>

, only one division operation is needed and the higher-order statistics can thus be calculated for little incremental cost.</p>

<p>An example of the online algorithm for kurtosis implemented as described is:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> online_kurtosis(data):
    n <span class="op">=</span> <span class="dv">0</span>
    mean <span class="op">=</span> <span class="dv">0</span>
    M2 <span class="op">=</span> <span class="dv">0</span>
    M3 <span class="op">=</span> <span class="dv">0</span>
    M4 <span class="op">=</span> <span class="dv">0</span>

    <span class="cf">for</span> x <span class="op">in</span> data:
        n1 <span class="op">=</span> n
        n <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span>
        delta <span class="op">=</span> x <span class="op">-</span> mean
        delta_n <span class="op">=</span> delta <span class="op">/</span> n
        delta_n2 <span class="op">=</span> delta_n <span class="op">*</span> delta_n
        term1 <span class="op">=</span> delta <span class="op">*</span> delta_n <span class="op">*</span> n1
        mean <span class="op">=</span> mean <span class="op">+</span> delta_n
        M4 <span class="op">=</span> M4 <span class="op">+</span> term1 <span class="op">*</span> delta_n2 <span class="op">*</span> (n<span class="op">*</span>n <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>n <span class="op">+</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">6</span> <span class="op">*</span> delta_n2 <span class="op">*</span> M2 <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> delta_n <span class="op">*</span> M3
        M3 <span class="op">=</span> M3 <span class="op">+</span> term1 <span class="op">*</span> delta_n <span class="op">*</span> (n <span class="op">-</span> <span class="dv">2</span>) <span class="op">-</span> <span class="dv">3</span> <span class="op">*</span> delta_n <span class="op">*</span> M2
        M2 <span class="op">=</span> M2 <span class="op">+</span> term1

    kurtosis <span class="op">=</span> (n<span class="op">*</span>M4) <span class="op">/</span> (M2<span class="op">*</span>M2) <span class="op">-</span> <span class="dv">3</span>
    <span class="cf">return</span> kurtosis</code></pre></div>

<p>Pébay<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> further extends these results to arbitrary-order <a href="central_moment" title="wikilink">central moments</a>, for the incremental and the pairwise cases. One can also find there similar formulas for <a class="uri" href="covariance" title="wikilink">covariance</a>.</p>

<p>Choi and Sweetman <a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a> offer two alternative methods to compute the skewness and kurtosis, each of which can save substantial computer memory requirements and CPU time in certain applications. The first approach is to compute the statistical moments by separating the data into bins and then computing the moments from the geometry of the resulting histogram, which effectively becomes a <a href="one-pass_algorithm" title="wikilink">one-pass algorithm</a> for higher moments. One benefit is that the statistical moment calculations can be carried out to arbitrary accuracy such that the computations can be tuned to the precision of, e.g., the data storage format or the original measurement hardware. A relative histogram of a random variable can be constructed in the conventional way: the range of potential values is divided into bins and the number of occurrences within each bin are counted and plotted such that the area of each rectangle equals the portion of the sample values within that bin:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:54">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mfrac>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mi>A</mi>
   </mfrac>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>H</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <ci>A</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(x_{k})=\frac{h(x_{k})}{A}
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Algorithms_for_calculating_variance:55">
 <semantics>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>h</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h(x_{k})
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Algorithms_for_calculating_variance:56">
 <semantics>
  <mrow>
   <mi>H</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>H</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>k</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(x_{k})
  </annotation>
 </semantics>
</math>

 represent the frequency and the relative frequency at bin 

<math display="inline" id="Algorithms_for_calculating_variance:57">
 <semantics>
  <msub>
   <mi>x</mi>
   <mi>k</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>x</ci>
    <ci>k</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x_{k}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Algorithms_for_calculating_variance:58">
 <semantics>
  <mrow>
   <mi>A</mi>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>K</mi>
    </msubsup>
    <mrow>
     <mi>h</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mo rspace="4.2pt" stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>A</ci>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>k</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>K</ci>
     </apply>
     <apply>
      <times></times>
      <ci>h</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
      <ci>normal-Δ</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>k</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   A=\sum_{k=1}^{K}h(x_{k})\,\Delta x_{k}
  </annotation>
 </semantics>
</math>

 is the total area of the histogram. After this normalization, the 

<math display="inline" id="Algorithms_for_calculating_variance:59">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 raw moments and central moments of 

<math display="inline" id="Algorithms_for_calculating_variance:60">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>x</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x(t)
  </annotation>
 </semantics>
</math>

 can be calculated from the relative histogram:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:61">
 <semantics>
  <mrow>
   <msubsup>
    <mi>m</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>h</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>K</mi>
    </munderover>
    <mrow>
     <mpadded width="+1.7pt">
      <msubsup>
       <mi>x</mi>
       <mi>k</mi>
       <mi>n</mi>
      </msubsup>
     </mpadded>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>A</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </munderover>
     <mrow>
      <mpadded width="+1.7pt">
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>n</mi>
       </msubsup>
      </mpadded>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">Δ</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>m</ci>
       <ci>n</ci>
      </apply>
      <ci>h</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>H</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>A</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>K</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>h</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{n}^{(h)}=\sum_{k=1}^{K}x_{k}^{n}\,H(x_{k})\Delta x_{k}=\frac{1}{A}\sum_{k=1%
}^{K}x_{k}^{n}\,h(x_{k})\Delta x_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:62">
 <semantics>
  <mrow>
   <msubsup>
    <mi>θ</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>h</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>K</mi>
    </munderover>
    <mrow>
     <mpadded width="+1.7pt">
      <msup>
       <mrow>
        <mo maxsize="160%" minsize="160%">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>k</mi>
         </msub>
         <mo>-</mo>
         <msubsup>
          <mi>m</mi>
          <mn>1</mn>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>h</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </msubsup>
        </mrow>
        <mo maxsize="160%" minsize="160%">)</mo>
       </mrow>
       <mi>n</mi>
      </msup>
     </mpadded>
     <mi>H</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi mathvariant="normal">Δ</mi>
     <msub>
      <mi>x</mi>
      <mi>k</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>A</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </munderover>
     <mrow>
      <mpadded width="+1.7pt">
       <msup>
        <mrow>
         <mo maxsize="160%" minsize="160%">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
          <mo>-</mo>
          <msubsup>
           <mi>m</mi>
           <mn>1</mn>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>h</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </msubsup>
         </mrow>
         <mo maxsize="160%" minsize="160%">)</mo>
        </mrow>
        <mi>n</mi>
       </msup>
      </mpadded>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi mathvariant="normal">Δ</mi>
      <msub>
       <mi>x</mi>
       <mi>k</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <ci>n</ci>
      </apply>
      <ci>h</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>h</ci>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>H</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
       <ci>normal-Δ</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <ci>A</ci>
      </apply>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>k</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>K</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>k</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>m</ci>
            <cn type="integer">1</cn>
           </apply>
           <ci>h</ci>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <ci>h</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-Δ</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{n}^{(h)}=\sum_{k=1}^{K}\Big(x_{k}-m_{1}^{(h)}\Big)^{n}\,H(x_{k})\Delta
x%
_{k}=\frac{1}{A}\sum_{k=1}^{K}\Big(x_{k}-m_{1}^{(h)}\Big)^{n}\,h(x_{k})\Delta x%
_{k}
  </annotation>
 </semantics>
</math>

</p>

<p>where the superscript 

<math display="inline" id="Algorithms_for_calculating_variance:63">
 <semantics>
  <msup>
   <mi></mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}^{(h)}
  </annotation>
 </semantics>
</math>

 indicates the moments are calculated from the histogram. For constant bin width 

<math display="inline" id="Algorithms_for_calculating_variance:64">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <msub>
     <mi>x</mi>
     <mi>k</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>k</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta x_{k}=\Delta x
  </annotation>
 </semantics>
</math>

 these two expressions can be simplified using 

<math display="inline" id="Algorithms_for_calculating_variance:65">
 <semantics>
  <mrow>
   <mi>I</mi>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>A</mi>
     <mo>/</mo>
     <mi mathvariant="normal">Δ</mi>
    </mrow>
    <mi>x</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>I</ci>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <ci>A</ci>
      <ci>normal-Δ</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I=A/\Delta x
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:66">
 <semantics>
  <mrow>
   <msubsup>
    <mi>m</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>h</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>I</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </munderover>
     <mrow>
      <mpadded width="+1.7pt">
       <msubsup>
        <mi>x</mi>
        <mi>k</mi>
        <mi>n</mi>
       </msubsup>
      </mpadded>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <ci>n</ci>
     </apply>
     <ci>h</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>I</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>k</ci>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>h</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{n}^{(h)}=\frac{1}{I}{\sum_{k=1}^{K}x_{k}^{n}\,h(x_{k})}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:67">
 <semantics>
  <mrow>
   <msubsup>
    <mi>θ</mi>
    <mi>n</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>h</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </msubsup>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>I</mi>
    </mfrac>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi>k</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>K</mi>
     </munderover>
     <mrow>
      <mpadded width="+1.7pt">
       <msup>
        <mrow>
         <mo maxsize="160%" minsize="160%">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>k</mi>
          </msub>
          <mo>-</mo>
          <msubsup>
           <mi>m</mi>
           <mn>1</mn>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>h</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </msubsup>
         </mrow>
         <mo maxsize="160%" minsize="160%">)</mo>
        </mrow>
        <mi>n</mi>
       </msup>
      </mpadded>
      <mi>h</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>θ</ci>
      <ci>n</ci>
     </apply>
     <ci>h</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>I</ci>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>K</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <minus></minus>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>k</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>m</ci>
           <cn type="integer">1</cn>
          </apply>
          <ci>h</ci>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <ci>h</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>k</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{n}^{(h)}=\frac{1}{I}{\sum_{k=1}^{K}\Big(x_{k}-m_{1}^{(h)}\Big)^{n}\,h(%
x_{k})}
  </annotation>
 </semantics>
</math>

</p>

<p>The second approach from Choi and Sweetman <a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> is an analytical methodology to combine statistical moments from individual segments of a time-history such that the resulting overall moments are those of the complete time-history. This methodology could be used for parallel computation of statistical moments with subsequent combination of those moments, or for combination of statistical moments computed at sequential times.</p>

<p>If 

<math display="inline" id="Algorithms_for_calculating_variance:68">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

 sets of statistical moments are known: 

<math display="inline" id="Algorithms_for_calculating_variance:69">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <msub>
     <mi>γ</mi>
     <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mi>q</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>μ</mi>
     <mi>q</mi>
    </msub>
    <mo>,</mo>
    <msubsup>
     <mi>σ</mi>
     <mi>q</mi>
     <mn>2</mn>
    </msubsup>
    <mo>,</mo>
    <msub>
     <mi>α</mi>
     <mrow>
      <mn>3</mn>
      <mo>,</mo>
      <mi>q</mi>
     </mrow>
    </msub>
    <mo>,</mo>
    <msub>
     <mi>α</mi>
     <mrow>
      <mn>4</mn>
      <mo>,</mo>
      <mi>q</mi>
     </mrow>
    </msub>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <vector>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>γ</ci>
     <list>
      <cn type="integer">0</cn>
      <ci>q</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>μ</ci>
     <ci>q</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>σ</ci>
      <cn type="integer">2</cn>
     </apply>
     <ci>q</ci>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <list>
      <cn type="integer">3</cn>
      <ci>q</ci>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>α</ci>
     <list>
      <cn type="integer">4</cn>
      <ci>q</ci>
     </list>
    </apply>
   </vector>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (\gamma_{0,q},\mu_{q},\sigma^{2}_{q},\alpha_{3,q},\alpha_{4,q})\quad
  </annotation>
 </semantics>
</math>

 for 

<math display="inline" id="Algorithms_for_calculating_variance:70">
 <semantics>
  <mrow>
   <mi>q</mi>
   <mo>=</mo>
   <mrow>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi mathvariant="normal">…</mi>
    <mo>,</mo>
    <mi>Q</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>q</ci>
    <list>
     <cn type="integer">1</cn>
     <cn type="integer">2</cn>
     <ci>normal-…</ci>
     <ci>Q</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q=1,2,...,Q
  </annotation>
 </semantics>
</math>

, then each 

<math display="inline" id="Algorithms_for_calculating_variance:71">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{n}
  </annotation>
 </semantics>
</math>

 can be expressed in terms of the equivalent 

<math display="inline" id="Algorithms_for_calculating_variance:72">
 <semantics>
  <mi>n</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>n</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   n
  </annotation>
 </semantics>
</math>

 raw moments:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:73">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>γ</mi>
     <mrow>
      <mi>n</mi>
      <mo>,</mo>
      <mi>q</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msub>
       <mi>m</mi>
       <mrow>
        <mi>n</mi>
        <mo>,</mo>
        <mi>q</mi>
       </mrow>
      </msub>
      <msub>
       <mi>γ</mi>
       <mrow>
        <mn>0</mn>
        <mo>,</mo>
        <mi>q</mi>
       </mrow>
      </msub>
     </mrow>
     <mtext>for</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mrow>
     <mi>n</mi>
     <mo>=</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mn>2</mn>
      <mo>,</mo>
      <mn>3</mn>
      <mo>,</mo>
      <mn>4</mn>
      <mtext>and</mtext>
     </mrow>
    </mrow>
    <mrow>
     <mi>q</mi>
     <mo>=</mo>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mn>2</mn>
      <mo>,</mo>
      <mi mathvariant="normal">…</mi>
      <mo>,</mo>
      <mi>Q</mi>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>γ</ci>
      <list>
       <ci>n</ci>
       <ci>q</ci>
      </list>
     </apply>
     <list>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>m</ci>
        <list>
         <ci>n</ci>
         <ci>q</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>γ</ci>
        <list>
         <cn type="integer">0</cn>
         <ci>q</ci>
        </list>
       </apply>
      </apply>
      <mtext>for</mtext>
     </list>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <ci>n</ci>
      <list>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
       <cn type="integer">3</cn>
       <cn type="integer">4</cn>
       <mtext>and</mtext>
      </list>
     </apply>
     <apply>
      <eq></eq>
      <ci>q</ci>
      <list>
       <cn type="integer">1</cn>
       <cn type="integer">2</cn>
       <ci>normal-…</ci>
       <ci>Q</ci>
      </list>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{n,q}=m_{n,q}\gamma_{0,q}\qquad\quad\textrm{for}\quad n=1,2,3,4\quad%
\text{ and }\quad q=1,2,\dots,Q
  </annotation>
 </semantics>
</math>

</p>

<p>where 

<math display="inline" id="Algorithms_for_calculating_variance:74">
 <semantics>
  <msub>
   <mi>γ</mi>
   <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mi>q</mi>
   </mrow>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>γ</ci>
    <list>
     <cn type="integer">0</cn>
     <ci>q</ci>
    </list>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{0,q}
  </annotation>
 </semantics>
</math>

 is generally taken to be the duration of the 

<math display="inline" id="Algorithms_for_calculating_variance:75">
 <semantics>
  <msup>
   <mi>q</mi>
   <mrow>
    <mi>t</mi>
    <mi>h</mi>
   </mrow>
  </msup>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">superscript</csymbol>
    <ci>q</ci>
    <apply>
     <times></times>
     <ci>t</ci>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   q^{th}
  </annotation>
 </semantics>
</math>

 time-history, or the number of points if 

<math display="inline" id="Algorithms_for_calculating_variance:76">
 <semantics>
  <mrow>
   <mi mathvariant="normal">Δ</mi>
   <mi>t</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>normal-Δ</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t
  </annotation>
 </semantics>
</math>

 is constant.</p>

<p>The benefit of expressing the statistical moments in terms of 

<math display="inline" id="Algorithms_for_calculating_variance:77">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

 is that the 

<math display="inline" id="Algorithms_for_calculating_variance:78">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>


 sets can be combined by addition, and there is no upper limit on the value of 

<math display="inline" id="Algorithms_for_calculating_variance:79">
 <semantics>
  <mi>Q</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>Q</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q
  </annotation>
 </semantics>
</math>

.</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:80">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>γ</mi>
     <mrow>
      <mi>n</mi>
      <mo>,</mo>
      <mi>c</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munderover>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>q</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>Q</mi>
      </munderover>
      <msub>
       <mi>γ</mi>
       <mrow>
        <mi>n</mi>
        <mo>,</mo>
        <mi>q</mi>
       </mrow>
      </msub>
     </mrow>
     <mtext>for</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mrow>
     <mn>0</mn>
     <mo>,</mo>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mn>3</mn>
     <mo>,</mo>
     <mn>4</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>γ</ci>
      <list>
       <ci>n</ci>
       <ci>c</ci>
      </list>
     </apply>
     <list>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>q</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>Q</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>γ</ci>
        <list>
         <ci>n</ci>
         <ci>q</ci>
        </list>
       </apply>
      </apply>
      <mtext>for</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <list>
      <cn type="integer">0</cn>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
      <cn type="integer">3</cn>
      <cn type="integer">4</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma_{n,c}=\sum_{q=1}^{Q}\gamma_{n,q}\quad\quad\textrm{for}\quad n=0,1,2,3,4
  </annotation>
 </semantics>
</math>

</p>

<p>where the subscript 

<math display="inline" id="Algorithms_for_calculating_variance:81">
 <semantics>
  <msub>
   <mi></mi>
   <mi>c</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>c</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   {}_{c}
  </annotation>
 </semantics>
</math>

 represents the concatenated time-history or combined 

<math display="inline" id="Algorithms_for_calculating_variance:82">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>

. These combined values of 

<math display="inline" id="Algorithms_for_calculating_variance:83">
 <semantics>
  <mi>γ</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>γ</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \gamma
  </annotation>
 </semantics>
</math>


 can then be inversely transformed into raw moments representing the complete concatenated time-history</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:84">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>m</mi>
     <mrow>
      <mi>n</mi>
      <mo>,</mo>
      <mi>c</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <msub>
       <mi>γ</mi>
       <mrow>
        <mi>n</mi>
        <mo>,</mo>
        <mi>c</mi>
       </mrow>
      </msub>
      <msub>
       <mi>γ</mi>
       <mrow>
        <mn>0</mn>
        <mo>,</mo>
        <mi>c</mi>
       </mrow>
      </msub>
     </mfrac>
     <mtext>for</mtext>
    </mrow>
   </mrow>
   <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mrow>
     <mn>1</mn>
     <mo>,</mo>
     <mn>2</mn>
     <mo>,</mo>
     <mn>3</mn>
     <mo>,</mo>
     <mn>4</mn>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <list>
       <ci>n</ci>
       <ci>c</ci>
      </list>
     </apply>
     <list>
      <apply>
       <divide></divide>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>γ</ci>
        <list>
         <ci>n</ci>
         <ci>c</ci>
        </list>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>γ</ci>
        <list>
         <cn type="integer">0</cn>
         <ci>c</ci>
        </list>
       </apply>
      </apply>
      <mtext>for</mtext>
     </list>
    </apply>
    <apply>
     <eq></eq>
     <ci>n</ci>
     <list>
      <cn type="integer">1</cn>
      <cn type="integer">2</cn>
      <cn type="integer">3</cn>
      <cn type="integer">4</cn>
     </list>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{n,c}=\frac{\gamma_{n,c}}{\gamma_{0,c}}\quad\textrm{for}\quad n=1,2,3,4
  </annotation>
 </semantics>
</math>

</p>

<p>Known relationships between the raw moments (

<math display="inline" id="Algorithms_for_calculating_variance:85">
 <semantics>
  <msub>
   <mi>m</mi>
   <mi>n</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>m</ci>
    <ci>n</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   m_{n}
  </annotation>
 </semantics>
</math>

) and the central moments (

<math display="inline" id="Algorithms_for_calculating_variance:86">
 <semantics>
  <mrow>
   <msub>
    <mi>θ</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mi>E</mi>
   <mrow>
    <mo stretchy="false">[</mo>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo>-</mo>
      <mi>μ</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>n</mi>
    </msup>
    <mo stretchy="false">]</mo>
   </mrow>
   <mo stretchy="false">)</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <cerror>
    <csymbol cd="ambiguous">fragments</csymbol>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>θ</ci>
     <ci>n</ci>
    </apply>
    <eq></eq>
    <csymbol cd="unknown">E</csymbol>
    <cerror>
     <csymbol cd="ambiguous">fragments</csymbol>
     <ci>normal-[</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <ci>normal-(</ci>
       <csymbol cd="unknown">x</csymbol>
       <minus></minus>
       <csymbol cd="unknown">μ</csymbol>
       <ci>normal-)</ci>
      </cerror>
      <ci>n</ci>
     </apply>
     <ci>normal-]</ci>
    </cerror>
    <ci>normal-)</ci>
   </cerror>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \theta_{n}=E[(x-\mu)^{n}])
  </annotation>
 </semantics>
</math>

) are then used to compute the central moments of the concatenated time-history. Finally, the statistical moments of the concatenated history are computed from the central moments:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:87">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>μ</mi>
     <mi>c</mi>
    </msub>
    <mo>=</mo>
    <msub>
     <mi>m</mi>
     <mrow>
      <mn>1</mn>
      <mo>,</mo>
      <mi>c</mi>
     </mrow>
    </msub>
   </mrow>
   <mrow>
    <mrow>
     <msubsup>
      <mi>σ</mi>
      <mi>c</mi>
      <mn>2</mn>
     </msubsup>
     <mo>=</mo>
     <msub>
      <mi>θ</mi>
      <mrow>
       <mn>2</mn>
       <mo>,</mo>
       <mi>c</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <mrow>
      <msub>
       <mi>α</mi>
       <mrow>
        <mn>3</mn>
        <mo>,</mo>
        <mi>c</mi>
       </mrow>
      </msub>
      <mo>=</mo>
      <mfrac>
       <msub>
        <mi>θ</mi>
        <mrow>
         <mn>3</mn>
         <mo>,</mo>
         <mi>c</mi>
        </mrow>
       </msub>
       <msubsup>
        <mi>σ</mi>
        <mi>c</mi>
        <mn>3</mn>
       </msubsup>
      </mfrac>
     </mrow>
     <mrow>
      <msub>
       <mi>α</mi>
       <mrow>
        <mn>4</mn>
        <mo>,</mo>
        <mi>c</mi>
       </mrow>
      </msub>
      <mo>=</mo>
      <mrow>
       <mfrac>
        <msub>
         <mi>θ</mi>
         <mrow>
          <mn>4</mn>
          <mo>,</mo>
          <mi>c</mi>
         </mrow>
        </msub>
        <msubsup>
         <mi>σ</mi>
         <mi>c</mi>
         <mn>4</mn>
        </msubsup>
       </mfrac>
       <mo>-</mo>
       <mn>3</mn>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">formulae-sequence</csymbol>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>μ</ci>
      <ci>c</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>m</ci>
      <list>
       <cn type="integer">1</cn>
       <ci>c</ci>
      </list>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">formulae-sequence</csymbol>
     <apply>
      <eq></eq>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>σ</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>c</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>θ</ci>
       <list>
        <cn type="integer">2</cn>
        <ci>c</ci>
       </list>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">formulae-sequence</csymbol>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <list>
         <cn type="integer">3</cn>
         <ci>c</ci>
        </list>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>θ</ci>
         <list>
          <cn type="integer">3</cn>
          <ci>c</ci>
         </list>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>σ</ci>
          <ci>c</ci>
         </apply>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <eq></eq>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>α</ci>
        <list>
         <cn type="integer">4</cn>
         <ci>c</ci>
        </list>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <divide></divide>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>θ</ci>
          <list>
           <cn type="integer">4</cn>
           <ci>c</ci>
          </list>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>σ</ci>
           <ci>c</ci>
          </apply>
          <cn type="integer">4</cn>
         </apply>
        </apply>
        <cn type="integer">3</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \mu_{c}=m_{1,c}\ \ \ \ \ \sigma^{2}_{c}=\theta_{2,c}\ \ \ \ \ \alpha_{3,c}=%
\frac{\theta_{3,c}}{\sigma_{c}^{3}}\ \ \ \ \ \alpha_{4,c}={\frac{\theta_{4,c}}%
{\sigma_{c}^{4}}}-3
  </annotation>
 </semantics>
</math>

</p>
<h2 id="covariance">Covariance</h2>

<p>Very similar algorithms can be used to compute the <a class="uri" href="covariance" title="wikilink">covariance</a>. The naive algorithm is:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:88">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </msubsup>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </msubsup>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </msubsup>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>/</mo>
       <mi>n</mi>
      </mrow>
     </mrow>
     <mi>n</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Cov</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <sum></sum>
         <apply>
          <eq></eq>
          <ci>i</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
        </apply>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <sum></sum>
           <apply>
            <eq></eq>
            <ci>i</ci>
            <cn type="integer">1</cn>
           </apply>
          </apply>
          <ci>n</ci>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>y</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Cov}(X,Y)=\displaystyle\frac{\sum_{i=1}^{n}x_{i}y_{i}-(\sum_{i=1%
}^{n}x_{i})(\sum_{i=1}^{n}y_{i})/n}{n}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>For the algorithm above, one could use the following pseudocode:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> naive_covariance(data1, data2):
    n <span class="op">=</span> <span class="bu">len</span>(data1)
    sum12 <span class="op">=</span> <span class="dv">0</span>
    sum1 <span class="op">=</span> <span class="bu">sum</span>(data1)
    sum2 <span class="op">=</span> <span class="bu">sum</span>(data2)

    <span class="cf">for</span> i <span class="op">in</span> <span class="bu">range</span>(n):
        sum12 <span class="op">+=</span> data1[i]<span class="op">*</span>data2[i]

    covariance <span class="op">=</span> (sum12 <span class="op">-</span> sum1<span class="op">*</span>sum2 <span class="op">/</span> n) <span class="op">/</span> n
    <span class="cf">return</span> covariance</code></pre></div>

<p>As for the variance, the covariance of two random variables is also shift-invariant, so given that 

<math display="inline" id="Algorithms_for_calculating_variance:89">
 <semantics>
  <msub>
   <mi>K</mi>
   <mi>x</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{x}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Algorithms_for_calculating_variance:90">
 <semantics>
  <msub>
   <mi>K</mi>
   <mi>y</mi>
  </msub>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <csymbol cd="ambiguous">subscript</csymbol>
    <ci>K</ci>
    <ci>y</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   K_{y}
  </annotation>
 </semantics>
</math>

 are whatever two constant values it can be written:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:91">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mo>Cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>X</mi>
       <mo>-</mo>
       <msub>
        <mi>k</mi>
        <mi>x</mi>
       </msub>
      </mrow>
      <mo>,</mo>
      <mrow>
       <mi>Y</mi>
       <mo>-</mo>
       <msub>
        <mi>k</mi>
        <mi>y</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msubsup>
        <mo largeop="true" symmetric="true">∑</mo>
        <mrow>
         <mi>i</mi>
         <mo>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </msubsup>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>K</mi>
           <mi>x</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
          <mo>-</mo>
          <msub>
           <mi>K</mi>
           <mi>y</mi>
          </msub>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mi>x</mi>
             <mi>i</mi>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>K</mi>
             <mi>x</mi>
            </msub>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <msubsup>
           <mo largeop="true" symmetric="true">∑</mo>
           <mrow>
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
           </mrow>
           <mi>n</mi>
          </msubsup>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <msub>
             <mi>y</mi>
             <mi>i</mi>
            </msub>
            <mo>-</mo>
            <msub>
             <mi>K</mi>
             <mi>y</mi>
            </msub>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>/</mo>
       <mi>n</mi>
      </mrow>
     </mrow>
     <mi>n</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <ci>Cov</ci>
      <ci>X</ci>
      <ci>Y</ci>
     </apply>
     <apply>
      <ci>Cov</ci>
      <apply>
       <minus></minus>
       <ci>X</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>Y</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <sum></sum>
          <apply>
           <eq></eq>
           <ci>i</ci>
           <cn type="integer">1</cn>
          </apply>
         </apply>
         <ci>n</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>K</ci>
           <ci>x</ci>
          </apply>
         </apply>
         <apply>
          <minus></minus>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>y</ci>
           <ci>i</ci>
          </apply>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>K</ci>
           <ci>y</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>x</ci>
            <ci>i</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>K</ci>
            <ci>x</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <sum></sum>
            <apply>
             <eq></eq>
             <ci>i</ci>
             <cn type="integer">1</cn>
            </apply>
           </apply>
           <ci>n</ci>
          </apply>
          <apply>
           <minus></minus>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>y</ci>
            <ci>i</ci>
           </apply>
           <apply>
            <csymbol cd="ambiguous">subscript</csymbol>
            <ci>K</ci>
            <ci>y</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Cov}(X,Y)=\operatorname{Cov}(X-k_{x},Y-k_{y})=\displaystyle\frac%
{\sum_{i=1}^{n}(x_{i}-K_{x})(y_{i}-K_{y})-(\sum_{i=1}^{n}(x_{i}-K_{x}))(\sum_{%
i=1}^{n}(y_{i}-K_{y}))/n}{n}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>and again choosing a value inside the range of values will stabilize the formula against catastrophic cancellation as well as make it more robust against big sums. Taking the first value of each data set, the algorithm can be written as:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> shifted_data_covariance(dataX, dataY):
   n <span class="op">=</span> <span class="bu">len</span>(dataX)
   <span class="cf">if</span> (n <span class="op">&lt;</span> <span class="dv">2</span>):
     <span class="cf">return</span> <span class="dv">0</span>
   Kx <span class="op">=</span> dataX[<span class="dv">0</span>]
   Ky <span class="op">=</span> dataY[<span class="dv">0</span>]
   Ex <span class="op">=</span> <span class="dv">0</span>
   Ey <span class="op">=</span> <span class="dv">0</span>
   Exy <span class="op">=</span> <span class="dv">0</span>
   <span class="cf">for</span> i <span class="op">in</span> <span class="bu">range</span>(n):
      Ex <span class="op">+=</span> dataX[i] <span class="op">-</span> Kx
      Ey <span class="op">+=</span> dataY[i] <span class="op">-</span> Ky
      Exy <span class="op">+=</span> (dataX[i] <span class="op">-</span> Kx) <span class="op">*</span> (dataY[i] <span class="op">-</span> Ky)
   <span class="cf">return</span> (Exy <span class="op">-</span> Ex <span class="op">*</span> Ey <span class="op">/</span> n) <span class="op">/</span> n</code></pre></div>

<p>The two-pass algorithm first computes the sample means, and then the covariance:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:92">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>x</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>/</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}=\displaystyle\sum_{i=1}^{n}x_{i}/n
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:93">
 <semantics>
  <mrow>
   <mover accent="true">
    <mi>y</mi>
    <mo stretchy="false">¯</mo>
   </mover>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo>/</mo>
     <mi>n</mi>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>normal-¯</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>i</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{y}=\displaystyle\sum_{i=1}^{n}y_{i}/n
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:94">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mo>Cov</mo>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>X</mi>
      <mo>,</mo>
      <mi>Y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <msubsup>
       <mo largeop="true" symmetric="true">∑</mo>
       <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </msubsup>
      <mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <msub>
          <mi>y</mi>
          <mi>i</mi>
         </msub>
         <mo>-</mo>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mi>n</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <ci>Cov</ci>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <sum></sum>
        <apply>
         <eq></eq>
         <ci>i</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>i</ci>
        </apply>
        <apply>
         <ci>normal-¯</ci>
         <ci>y</ci>
        </apply>
       </apply>
      </apply>
     </apply>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \operatorname{Cov}(X,Y)=\displaystyle\frac{\sum_{i=1}^{n}(x_{i}-\bar{x})(y_{i}%
-\bar{y})}{n}.\!
  </annotation>
 </semantics>
</math>

</p>

<p>The two-pass algorithm may be written as:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> two_pass_covariance(data1, data2):
    n <span class="op">=</span> <span class="bu">len</span>(data1)

    mean1 <span class="op">=</span> <span class="bu">sum</span>(data1) <span class="op">/</span> n
    mean2 <span class="op">=</span> <span class="bu">sum</span>(data2) <span class="op">/</span> n

    covariance <span class="op">=</span> <span class="dv">0</span>

    <span class="cf">for</span> i <span class="op">in</span> <span class="bu">range</span>(n):
        a <span class="op">=</span> data1[i] <span class="op">-</span> mean1
        b <span class="op">=</span> data2[i] <span class="op">-</span> mean2
        covariance <span class="op">+=</span> a<span class="op">*</span>b <span class="op">/</span> n

    <span class="cf">return</span> covariance</code></pre></div>

<p>A slightly more accurate compensated version performs the full naive algorithm on the residuals. The final sums 

<math display="inline" id="Algorithms_for_calculating_variance:95">
 <semantics>
  <mrow>
   <mo largeop="true" symmetric="true">∑</mo>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <sum></sum>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>x</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\sum x_{i}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Algorithms_for_calculating_variance:96">
 <semantics>
  <mrow>
   <mo largeop="true" symmetric="true">∑</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <sum></sum>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>y</ci>
     <ci>i</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\sum y_{i}
  </annotation>
 </semantics>
</math>

 <em>should</em> be zero, but the second pass compensates for any small error.</p>

<p>A stable one-pass algorithm exists, similar to the one above, that computes co-moment 

<math display="inline" id="Algorithms_for_calculating_variance:97">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mo largeop="true" symmetric="true">∑</mo>
     <mrow>
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </msubsup>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>y</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>n</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>i</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>i</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>y</ci>
        </apply>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle C_{n}=\sum_{i=1}^{n}(x_{i}-\bar{x}_{n})(y_{i}-\bar{y}_{n})
  </annotation>
 </semantics>
</math>

:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:98">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>x</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>x</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>+</mo>
    <mpadded width="-1.7pt">
     <mfrac>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mi>n</mi>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>x</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>x</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{x}_{n}=\bar{x}_{n-1}+\frac{x_{n}-\bar{x}_{n-1}}{n}\!
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:99">
 <semantics>
  <mrow>
   <msub>
    <mover accent="true">
     <mi>y</mi>
     <mo stretchy="false">¯</mo>
    </mover>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mover accent="true">
      <mi>y</mi>
      <mo stretchy="false">¯</mo>
     </mover>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>+</mo>
    <mpadded width="-1.7pt">
     <mfrac>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>y</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mi>n</mi>
     </mfrac>
    </mpadded>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <apply>
      <ci>normal-¯</ci>
      <ci>y</ci>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>n</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <apply>
         <ci>normal-¯</ci>
         <ci>y</ci>
        </apply>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \bar{y}_{n}=\bar{y}_{n-1}+\frac{y_{n}-\bar{y}_{n-1}}{n}\!
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:100">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mi>n</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>y</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>y</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mi>n</mi>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo>-</mo>
       <msub>
        <mover accent="true">
         <mi>x</mi>
         <mo stretchy="false">¯</mo>
        </mover>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>C</ci>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
         <ci>n</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>n</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{n}=C_{n-1}+(x_{n}-\bar{x}_{n})(y_{n}-\bar{y}_{n-1})=C_{n-1}+(y_{n}-\bar{y}_%
{n})(x_{n}-\bar{x}_{n-1})
  </annotation>
 </semantics>
</math>

 The apparent asymmetry in that last equation is due to the fact that 

<math display="inline" id="Algorithms_for_calculating_variance:101">
 <semantics>
  <mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mi>n</mi>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </mfrac>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <msub>
       <mi>x</mi>
       <mi>n</mi>
      </msub>
      <mo>-</mo>
      <msub>
       <mover accent="true">
        <mi>x</mi>
        <mo stretchy="false">¯</mo>
       </mover>
       <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mn>1</mn>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <ci>n</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>n</ci>
     </apply>
     <apply>
      <minus></minus>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <apply>
        <ci>normal-¯</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <minus></minus>
        <ci>n</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle(x_{n}-\bar{x}_{n})=\frac{n-1}{n}(x_{n}-\bar{x}_{n-1})
  </annotation>
 </semantics>
</math>

, so both update terms are equal to 

<math display="inline" id="Algorithms_for_calculating_variance:102">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </mfrac>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>n</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mover accent="true">
       <mi>x</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>n</mi>
     </msub>
     <mo>-</mo>
     <msub>
      <mover accent="true">
       <mi>y</mi>
       <mo stretchy="false">¯</mo>
      </mover>
      <mrow>
       <mi>n</mi>
       <mo>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
     <ci>n</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>x</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>y</ci>
      <ci>n</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <apply>
       <ci>normal-¯</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <minus></minus>
       <ci>n</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \textstyle\frac{n-1}{n}(x_{n}-\bar{x}_{n-1})(y_{n}-\bar{y}_{n-1})
  </annotation>
 </semantics>
</math>

. Even greater accuracy can be achieved by first computing the means, then using the stable one-pass algorithm on the residuals.</p>

<p>Thus we can compute the covariance as</p>

<p>

<math display="inline" id="Algorithms_for_calculating_variance:103">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mo>Cov</mo>
     <mi>N</mi>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>X</mi>
     <mo>,</mo>
     <mi>Y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mstyle displaystyle="true">
    <mfrac>
     <msub>
      <mi>C</mi>
      <mi>N</mi>
     </msub>
     <mi>N</mi>
    </mfrac>
   </mstyle>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>Cov</ci>
      <ci>N</ci>
     </apply>
     <ci>X</ci>
     <ci>Y</ci>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>N</ci>
     </apply>
     <ci>N</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\operatorname{Cov}_{N}(X,Y)=\frac{C_{N}}{N}
  </annotation>
 </semantics>
</math>


</p>

<p>Likewise, there is a formula for combining the covariances of two sets that can be used to parallelize the computation:</p>

<p>

<math display="block" id="Algorithms_for_calculating_variance:104">
 <semantics>
  <mrow>
   <msub>
    <mi>C</mi>
    <mi>X</mi>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>C</mi>
     <mi>A</mi>
    </msub>
    <mo>+</mo>
    <msub>
     <mi>C</mi>
     <mi>B</mi>
    </msub>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mi>A</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>x</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mi>B</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <msub>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mi>A</mi>
        </msub>
        <mo>-</mo>
        <msub>
         <mover accent="true">
          <mi>y</mi>
          <mo stretchy="false">¯</mo>
         </mover>
         <mi>B</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <msub>
        <mi>n</mi>
        <mi>A</mi>
       </msub>
       <msub>
        <mi>n</mi>
        <mi>B</mi>
       </msub>
      </mrow>
      <msub>
       <mi>n</mi>
       <mi>X</mi>
      </msub>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>C</ci>
     <ci>X</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>A</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>C</ci>
      <ci>B</ci>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>x</ci>
         </apply>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <minus></minus>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <apply>
          <ci>normal-¯</ci>
          <ci>y</ci>
         </apply>
         <ci>B</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>A</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>n</ci>
         <ci>B</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>n</ci>
        <ci>X</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   C_{X}=C_{A}+C_{B}+(\bar{x}_{A}-\bar{x}_{B})(\bar{y}_{A}-\bar{y}_{B})\cdot\frac%
{n_{A}n_{B}}{n_{X}}
  </annotation>
 </semantics>
</math>

.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Algebraic_formula_for_the_variance" title="wikilink">Algebraic formula for the variance</a></li>
<li><a href="Kahan_summation_algorithm" title="wikilink">Kahan summation algorithm</a></li>
</ul>
<h2 id="references">References</h2>
<references>
</references>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
</ul>

<p>"</p>

<p><a href="Category:Statistical_algorithms" title="wikilink">Category:Statistical algorithms</a> <a href="Category:Statistical_deviation_and_dispersion" title="wikilink">Category:Statistical deviation and dispersion</a> <a href="Category:Articles_with_example_pseudocode" title="wikilink">Category:Articles with example pseudocode</a> <a href="Category:Articles_with_example_Python_code" title="wikilink">Category:Articles with example Python code</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"></li>
<li id="fn4"></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"></li>
<li id="fn7"><a href="Donald_E._Knuth" title="wikilink">Donald E. Knuth</a> (1998). <em><a href="The_Art_of_Computer_Programming" title="wikilink">The Art of Computer Programming</a></em>, volume 2: <em>Seminumerical Algorithms</em>, 3rd edn., p. 232. Boston: Addison-Wesley.<a href="#fnref7">↩</a></li>
<li id="fn8">B. P. Welford (1962).<a href="http://www.jstor.org/stable/1266577">"Note on a method for calculating corrected sums of squares and products"</a>. <em><a class="uri" href="Technometrics" title="wikilink">Technometrics</a></em> 4(3):419–420.<a href="#fnref8">↩</a></li>
<li id="fn9">Chan, Tony F.; Golub, Gene H.; LeVeque, Randall J. (1983). Algorithms for Computing the Sample Variance: Analysis and Recommendations. The American Statistician 37, 242-247. <a class="uri" href="http://www.jstor.org/stable/2683386">http://www.jstor.org/stable/2683386</a><a href="#fnref9">↩</a></li>
<li id="fn10">Ling, Robert F. (1974). Comparison of Several Algorithms for Computing Sample Means and Variances. Journal of the American Statistical Association, Vol. 69, No. 348, 859-866. <a href="#fnref10">↩</a></li>
<li id="fn11"><a class="uri" href="http://www.johndcook.com/standard_deviation.html">http://www.johndcook.com/standard_deviation.html</a><a href="#fnref11">↩</a></li>
<li id="fn12">D. H. D. West (1979). <em><a href="Communications_of_the_ACM" title="wikilink">Communications of the ACM</a></em>, 22, 9, 532-535: <em>Updating Mean and Variance Estimates: An Improved Method</em><a href="#fnref12">↩</a></li>
<li id="fn13">.<a href="#fnref13">↩</a></li>
<li id="fn14"><a href="#fnref14">↩</a></li>
<li id="fn15"><a href="#fnref15">↩</a></li>
<li id="fn16"><a href="#fnref16">↩</a></li>
<li id="fn17"></li>
</ol>
</section>
</body>


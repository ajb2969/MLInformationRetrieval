<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="631">MD5</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>MD5</h1>
<hr/>

<p>The <strong>MD5 message-digest algorithm</strong> is a widely used <a href="cryptographic_hash_function" title="wikilink">cryptographic hash function</a> producing a 128-<a class="uri" href="bit" title="wikilink">bit</a> (16-byte) <a href="hash_value" title="wikilink">hash value</a>, typically expressed in text format as a 32 digit <a class="uri" href="hexadecimal" title="wikilink">hexadecimal</a> number. MD5 has been utilized in a wide variety of cryptographic applications, and is also commonly used to verify <a href="data_integrity" title="wikilink">data integrity</a>.</p>

<p>MD5 was designed by <a href="Ronald_Rivest" title="wikilink">Ronald Rivest</a> in 1991 to replace an earlier hash function, <a class="uri" href="MD4" title="wikilink">MD4</a>.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> The source code in RFC 1321 contains a "by attribution" RSA license.</p>

<p>In 1996 a flaw was found in the design of MD5. While it was not deemed a fatal weakness at the time, cryptographers began recommending the use of other algorithms, such as <a class="uri" href="SHA-1" title="wikilink">SHA-1</a>—which has since been found to be vulnerable as well.<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> In 2004 it was shown that MD5 is not <a href="collision_resistant" title="wikilink">collision resistant</a>.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a> As such, MD5 is not suitable for applications like <a href="Transport_Layer_Security" title="wikilink">SSL</a> <a href="public_key_certificate" title="wikilink">certificates</a> or <a href="digital_signature" title="wikilink">digital signatures</a> that rely on this property for digital security. Also in 2004 more serious flaws were discovered in MD5, making further use of the algorithm for security purposes questionable; specifically, a group of researchers described how to create a pair of files that share the same MD5 <a class="uri" href="checksum" title="wikilink">checksum</a>.<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a><a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> Further advances were made in breaking MD5 in 2005, 2006, and 2007.<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> In December 2008, a group of researchers used this technique to fake SSL certificate validity.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a><a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a> As of 2010, the <a href="CMU_Software_Engineering_Institute" title="wikilink">CMU Software Engineering Institute</a> considers MD5 "cryptographically broken and unsuitable for further use",<a class="footnoteRef" href="#fn9" id="fnref9"><sup>9</sup></a> and most U.S. government applications now require the <a class="uri" href="SHA-2" title="wikilink">SHA-2</a> family of hash functions.<a class="footnoteRef" href="#fn10" id="fnref10"><sup>10</sup></a> In 2012, the <a href="Flame_(malware)" title="wikilink">Flame</a> malware exploited the weaknesses in MD5 to fake a Microsoft <a href="digital_signature" title="wikilink">digital signature</a>.</p>
<h2 id="history-and-cryptanalysis">History and cryptanalysis</h2>

<p>MD5 is one in a series of <a href="message_digest" title="wikilink">message digest</a> algorithms designed by Professor <a href="Ronald_Rivest" title="wikilink">Ronald Rivest</a> of <a href="Massachusetts_Institute_of_Technology" title="wikilink">MIT</a> (Rivest, 1992). When analytic work indicated that MD5's predecessor <a class="uri" href="MD4" title="wikilink">MD4</a> was likely to be insecure, Rivest designed MD5 in 1991 as a secure replacement. (<a href="Hans_Dobbertin" title="wikilink">Hans Dobbertin</a> did indeed later find weaknesses in MD4.)</p>

<p>In 1993, Den Boer and Bosselaers gave an early, although limited, result of finding a "<a href="hash_collision" title="wikilink">pseudo-collision</a>" of the MD5 <a href="One-way_compression_function" title="wikilink">compression function</a>; that is, two different <a href="initialization_vector" title="wikilink">initialization vectors</a> which produce an identical digest.</p>

<p>In 1996, Dobbertin announced a collision of the compression function of MD5 (Dobbertin, 1996). While this was not an attack on the full MD5 hash function, it was close enough for cryptographers to recommend switching to a replacement, such as <a class="uri" href="SHA-1" title="wikilink">SHA-1</a> or <a class="uri" href="RIPEMD-160" title="wikilink">RIPEMD-160</a>.</p>

<p>The size of the hash value (128 bits) is small enough to contemplate a <a href="birthday_attack" title="wikilink">birthday attack</a>. <a class="uri" href="MD5CRK" title="wikilink">MD5CRK</a> was a <a href="distributed_computing" title="wikilink">distributed project</a> started in March 2004 with the aim of demonstrating that MD5 is practically insecure by finding a collision using a birthday attack.</p>

<p>MD5CRK ended shortly after 17 August 2004, when <a href="hash_collision" title="wikilink">collisions</a> for the full MD5 were announced by <a href="Xiaoyun_Wang" title="wikilink">Xiaoyun Wang</a>, Dengguo Feng, <a href="Xuejia_Lai" title="wikilink">Xuejia Lai</a>, and Hongbo Yu.<a class="footnoteRef" href="#fn11" id="fnref11"><sup>11</sup></a><a class="footnoteRef" href="#fn12" id="fnref12"><sup>12</sup></a> Their analytical attack was reported to take only one hour on an <a href="IBM_p690" title="wikilink">IBM p690</a> cluster.<a class="footnoteRef" href="#fn13" id="fnref13"><sup>13</sup></a></p>

<p>On 1 March 2005, <a href="Arjen_Lenstra" title="wikilink">Arjen Lenstra</a>, <a href="Xiaoyun_Wang" title="wikilink">Xiaoyun Wang</a>, and <a href="Benne_de_Weger" title="wikilink">Benne de Weger</a> demonstrated construction of two <a class="uri" href="X.509" title="wikilink">X.509</a> certificates with different public keys and the same MD5 hash value, a demonstrably practical collision.<a class="footnoteRef" href="#fn14" id="fnref14"><sup>14</sup></a> The construction included private keys for both public keys. A few days later, <a href="Vlastimil_Klima" title="wikilink">Vlastimil Klima</a> described an improved algorithm, able to construct MD5 collisions in a few hours on a single notebook computer.<a class="footnoteRef" href="#fn15" id="fnref15"><sup>15</sup></a> On 18 March 2006, Klima published an algorithm that can find a collision within one minute on a single notebook computer, using a method he calls tunneling.<a class="footnoteRef" href="#fn16" id="fnref16"><sup>16</sup></a></p>

<p>Various MD5-related <a href="Request_for_Comments#Obtaining_RFCs" title="wikilink">RFC errata</a> have been published.<a class="footnoteRef" href="#fn17" id="fnref17"><sup>17</sup></a> In 2009, the <a href="United_States_Cyber_Command" title="wikilink">United States Cyber Command</a> used an MD5 hash value of their mission statement as a part of their official emblem.<a class="footnoteRef" href="#fn18" id="fnref18"><sup>18</sup></a></p>

<p>On 24 December 2010, Tao Xie and Dengguo Feng announced the first published single-block (512 bit) MD5 collision.<a class="footnoteRef" href="#fn19" id="fnref19"><sup>19</sup></a> (Previous collision discoveries had relied on multi-block attacks.) For "security reasons", Xie and Feng did not disclose the new attack method. They issued a challenge to the cryptographic community, offering a US$10,000 reward to the first finder of a different 64-byte collision before 1 January 2013. Marc Stevens responded to the challenge and published colliding single-block messages as well as the construction algorithm and sources.<a class="footnoteRef" href="#fn20" id="fnref20"><sup>20</sup></a></p>

<p>In 2011 an informational RFC 6151<a class="footnoteRef" href="#fn21" id="fnref21"><sup>21</sup></a> was approved to update the security considerations in MD5<a class="footnoteRef" href="#fn22" id="fnref22"><sup>22</sup></a> and HMAC-MD5.<a class="footnoteRef" href="#fn23" id="fnref23"><sup>23</sup></a></p>
<h2 id="security">Security</h2>

<p>The security of the MD5 hash function is severely compromised. A <a href="collision_attack" title="wikilink">collision attack</a> exists that can find collisions within seconds on a computer with a 2.6 GHz Pentium 4 processor (complexity of 2<sup>24.1</sup>).<a class="footnoteRef" href="#fn24" id="fnref24"><sup>24</sup></a> Further, there is also a <a href="chosen-prefix_collision_attack" title="wikilink">chosen-prefix collision attack</a> that can produce a collision for two inputs with specified prefixes within hours, using off-the-shelf computing hardware (complexity 2<sup>39</sup>).<a class="footnoteRef" href="#fn25" id="fnref25"><sup>25</sup></a> The ability to find collisions has been greatly aided by the use of off-the-shelf <a href="Graphics_processing_unit" title="wikilink">GPUs</a>. On an NVIDIA GeForce 8400GS graphics processor, 16–18 million hashes per second can be computed. An NVIDIA GeForce 8800 Ultra can calculate more than 200 million hashes per second.<a class="footnoteRef" href="#fn26" id="fnref26"><sup>26</sup></a></p>

<p>These hash and collision attacks have been demonstrated in the public in various situations, including colliding document files<a class="footnoteRef" href="#fn27" id="fnref27"><sup>27</sup></a><a class="footnoteRef" href="#fn28" id="fnref28"><sup>28</sup></a> and <a href="digital_certificate" title="wikilink">digital certificates</a>.<a class="footnoteRef" href="#fn29" id="fnref29"><sup>29</sup></a> As of 2015 however MD5 was demonstrated to be still quite widely used, most notably by security research and antivirus companies.<a class="footnoteRef" href="#fn30" id="fnref30"><sup>30</sup></a></p>
<h3 id="collision-vulnerabilities">Collision vulnerabilities</h3>

<p>In 1996, collisions were found in the compression function of MD5, and <a href="Hans_Dobbertin" title="wikilink">Hans Dobbertin</a> wrote in the <a href="RSA_Laboratories" title="wikilink">RSA Laboratories</a> technical newsletter, "The presented attack does not yet threaten practical applications of MD5, but it comes rather close ... in the future MD5 should no longer be implemented...where a collision-resistant hash function is required."<a class="footnoteRef" href="#fn31" id="fnref31"><sup>31</sup></a></p>

<p>In 2005, researchers were able to create pairs of <a class="uri" href="PostScript" title="wikilink">PostScript</a> documents<a class="footnoteRef" href="#fn32" id="fnref32"><sup>32</sup></a> and <a class="uri" href="X.509" title="wikilink">X.509</a> certificates<a class="footnoteRef" href="#fn33" id="fnref33"><sup>33</sup></a> with the same hash. Later that year, MD5's designer Ron Rivest wrote, "md5 and sha1 are both clearly broken (in terms of collision-resistance)."<a class="footnoteRef" href="#fn34" id="fnref34"><sup>34</sup></a></p>

<p>On 30 December 2008, a group of researchers announced at the 25th <a href="Chaos_Communication_Congress" title="wikilink">Chaos Communication Congress</a> how they had used MD5 collisions to create an intermediate certificate authority certificate which appeared to be legitimate when checked via its MD5 hash.<a class="footnoteRef" href="#fn35" id="fnref35"><sup>35</sup></a> The researchers used a cluster of <a class="uri" href="Sony" title="wikilink">Sony</a> <a href="PlayStation_3" title="wikilink">PlayStation 3</a> units at the <a class="uri" href="EPFL" title="wikilink">EPFL</a> in Lausanne, Switzerland<a class="footnoteRef" href="#fn36" id="fnref36"><sup>36</sup></a> to change a normal SSL certificate issued by <a class="uri" href="RapidSSL" title="wikilink">RapidSSL</a> into a working <a href="CA_certificate" title="wikilink">CA certificate</a> for that issuer, which could then be used to create other certificates that would appear to be legitimate and issued by RapidSSL. <a class="uri" href="VeriSign" title="wikilink">VeriSign</a>, the issuers of RapidSSL certificates, said they stopped issuing new certificates using MD5 as their checksum algorithm for RapidSSL once the vulnerability was announced.<a class="footnoteRef" href="#fn37" id="fnref37"><sup>37</sup></a> Although Verisign declined to revoke existing certificates signed using MD5, their response was considered adequate by the authors of the exploit (<a href="Alexander_Sotirov" title="wikilink">Alexander Sotirov</a>, Marc Stevens, <a href="Jacob_Appelbaum" title="wikilink">Jacob Appelbaum</a>, <a href="Arjen_Lenstra" title="wikilink">Arjen Lenstra</a>, David Molnar, Dag Arne Osvik, and Benne de Weger).<a class="footnoteRef" href="#fn38" id="fnref38"><sup>38</sup></a> Bruce Schneier wrote of the attack that "we already knew that MD5 is a broken hash function" and that "no one should be using MD5 anymore".<a class="footnoteRef" href="#fn39" id="fnref39"><sup>39</sup></a> The SSL researchers wrote, "Our desired impact is that Certification Authorities will stop using MD5 in issuing new certificates. We also hope that use of MD5 in other applications will be reconsidered as well."<a class="footnoteRef" href="#fn40" id="fnref40"><sup>40</sup></a></p>

<p>In 2012, according to <a class="uri" href="Microsoft" title="wikilink">Microsoft</a>, the authors of the <a href="Flame_(malware)" title="wikilink">Flame</a> malware used an MD5 collision to forge a Windows code-signing certificate.<a class="footnoteRef" href="#fn41" id="fnref41"><sup>41</sup></a></p>

<p>MD5 uses the <a href="Merkle–Damgård_construction" title="wikilink">Merkle–Damgård construction</a>, so if two prefixes with the same hash can be constructed, a common suffix can be added to both to make the collision more likely to be accepted as valid data by the application using it. Furthermore, current collision-finding techniques allow to specify an arbitrary <em>prefix</em>: an attacker can create two colliding files that both begin with the same content. All the attacker needs to generate two colliding files is a template file with a 128-byte block of data, aligned on a 64-byte boundary that can be changed freely by the collision-finding algorithm. An example MD5 collision, with the two messages differing in 6 bits, is:</p>

<p><code>d131dd02c5e6eec4 693d9a0698aff95c 2fcab5</code><code>712467eab 4004583eb8fb7f89</code><br/>
<code>55ad340609f4b302 83e4888325</code><code>1415a 085125e8f7cdc99f d91dbd</code><code>280373c5b</code><br/>
<code>d8823e3156348f5b ae6dacd436c919c6 dd53e2</code><code>487da03fd 02396306d248cda0</code><br/>
<code>e99f33420f577ee8 ce54b67080</code><code>80d1e c69821bcb6a88393 96f965</code><code>b6ff72a70</code></p>

<p><code>d131dd02c5e6eec4 693d9a0698aff95c 2fcab5</code><code>712467eab 4004583eb8fb7f89</code><br/>
<code>55ad340609f4b302 83e4888325</code><code>1415a 085125e8f7cdc99f d91dbd</code><code>280373c5b</code><br/>
<code>d8823e3156348f5b ae6dacd436c919c6 dd53e2</code><code>487da03fd 02396306d248cda0</code><br/>
<code>e99f33420f577ee8 ce54b67080</code><code>80d1e c69821bcb6a88393 96f965</code><code>b6ff72a70</code></p>

<p>Both produce the MD5 hash 79054025255fb1a26e4bc422aef54eb4.<a class="footnoteRef" href="#fn42" id="fnref42"><sup>42</sup></a> The difference between the two samples is the leading bit in each <a class="uri" href="nibble" title="wikilink">nibble</a> has been flipped. For example, the 20th byte (offset 0x13) in the top sample, 0x87, is 10000111 in binary. The leading bit in the byte (also the leading bit in the first nibble) is flipped to make 00000111, which is 0x07 as shown in the lower sample.</p>

<p>Later it was also found to be possible to construct collisions between two files with separately chosen prefixes. This technique was used in the creation of the rogue CA certificate in 2008. A new variant of parallelized collision searching using <a href="Message_Passing_Interface" title="wikilink">MPI</a> was proposed by Anton Kuznetsov in 2014 which allowed to find a collision in 11 hours on a computing cluster.<a class="footnoteRef" href="#fn43" id="fnref43"><sup>43</sup></a></p>
<h3 id="preimage-vulnerability">Preimage vulnerability</h3>

<p>In April 2009, a <a href="preimage_attack" title="wikilink">preimage attack</a> against MD5 was published that breaks MD5's preimage resistance. This attack is only theoretical, with a computational complexity of 2<sup>123.4</sup> for full preimage.<a class="footnoteRef" href="#fn44" id="fnref44"><sup>44</sup></a><a class="footnoteRef" href="#fn45" id="fnref45"><sup>45</sup></a></p>
<h3 id="other-vulnerabilities">Other vulnerabilities</h3>

<p>A number of projects have published MD5 <a href="rainbow_table" title="wikilink">rainbow tables</a> online, which can be used to reverse many MD5 hashes into strings that collide with the original input, usually for the purposes of <a class="uri" href="password" title="wikilink">password</a> cracking.</p>

<p>The use of MD5 in some websites' <a href="Uniform_Resource_Locator" title="wikilink">URLs</a> means that <a href="search_engine" title="wikilink">search engines</a> such as <a class="uri" href="Google" title="wikilink">Google</a> can also sometimes function as a limited tool for reverse lookup of MD5 hashes.<a class="footnoteRef" href="#fn46" id="fnref46"><sup>46</sup></a></p>

<p>Both these techniques are rendered ineffective by the use of a sufficiently long <a href="Salt_(cryptography)" title="wikilink">salt</a>.</p>
<h2 id="applications">Applications</h2>

<p>MD5 digests have been widely used in the <a class="uri" href="software" title="wikilink">software</a> world to provide some assurance that a transferred file has arrived intact. For example, file servers often provide a pre-computed MD5 (known as <a class="uri" href="Md5sum" title="wikilink">Md5sum</a>) <a class="uri" href="checksum" title="wikilink">checksum</a> for the files, so that a user can compare the checksum of the downloaded file to it. Most unix-based operating systems include MD5 sum utilities in their distribution packages; Windows users may install a Microsoft utility,<a class="footnoteRef" href="#fn47" id="fnref47"><sup>47</sup></a><a class="footnoteRef" href="#fn48" id="fnref48"><sup>48</sup></a> or use third-party applications. Android ROMs also utilize this type of checksum.</p>
<figure><b>(Figure)</b>
<figcaption>Diagram showing use of MD5 hashing in file transmission</figcaption>
</figure>

<p>However, now that it is easy to generate MD5 collisions, it is possible for the person who created the file to create a second file with the same checksum, so this technique cannot protect against some forms of malicious tampering. Also, in some cases, the checksum cannot be trusted (for example, if it was obtained over the same channel as the downloaded file), in which case MD5 can only provide error-checking functionality: it will recognize a corrupt or incomplete download, which becomes more likely when downloading larger files.</p>

<p>MD5 can be used to store a one-way hash of a <a href="Password#Form_of_stored_passwords" title="wikilink">password</a>, often with <a href="key_stretching" title="wikilink">key stretching</a>.<a class="footnoteRef" href="#fn49" id="fnref49"><sup>49</sup></a><a class="footnoteRef" href="#fn50" id="fnref50"><sup>50</sup></a> Along with other hash functions, it is also used in the field of <a href="electronic_discovery" title="wikilink">electronic discovery</a>, in order to provide a unique identifier for each document that is exchanged during the legal discovery process. This method can be used to replace the <a href="Bates_numbering" title="wikilink">Bates stamp</a> numbering system that has been used for decades during the exchange of paper documents.</p>
<h2 id="algorithm">Algorithm</h2>
<figure><b>(Figure)</b>
<figcaption>Figure 1. One MD5 operation. MD5 consists of 64 of these operations, grouped in four rounds of 16 operations. <em>F</em> is a nonlinear function; one function is used in each round. <em>M<sub>i</sub></em> denotes a 32-bit block of the message input, and <em>K<sub>i</sub></em> denotes a 32-bit constant, different for each operation. <a href="Image:lll.png" title="wikilink">left shift</a><sub><em>s</em></sub> denotes a left bit rotation by <em>s</em> places; <em>s</em> varies for each operation.  denotes addition modulo 2<sup>32</sup>.</figcaption>
</figure>

<p>MD5 processes a variable-length message into a fixed-length output of 128 bits. The input message is broken up into chunks of 512-bit blocks (sixteen 32-bit words); the message is <a href="padding_(cryptography)" title="wikilink">padded</a> so that its length is divisible by 512. The padding works as follows: first a single bit, 1, is appended to the end of the message. This is followed by as many zeros as are required to bring the length of the message up to 64 bits fewer than a multiple of 512. The remaining bits are filled up with 64 bits representing the length of the original message, modulo 2<sup>64</sup>.</p>

<p>The main MD5 algorithm operates on a 128-bit state, divided into four 32-bit words, denoted <em>A</em>, <em>B</em>, <em>C</em>, and <em>D</em>. These are initialized to certain fixed constants. The main algorithm then uses each 512-bit message block in turn to modify the state. The processing of a message block consists of four similar stages, termed <em>rounds</em>; each round is composed of 16 similar operations based on a non-linear function <em>F</em>, <a href="modular_addition" title="wikilink">modular addition</a>, and left rotation. Figure 1 illustrates one operation within a round. There are four possible functions <em>F</em>; a different one is used in each round:</p>

<p>

<math display="block" id="MD5:0">
 <semantics>
  <mrow>
   <mrow>
    <mi>F</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>B</mi>
     <mo>,</mo>
     <mi>C</mi>
     <mo>,</mo>
     <mi>D</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mo>∧</mo>
      <mi>C</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∨</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi mathvariant="normal">¬</mi>
       <mi>B</mi>
      </mrow>
      <mo>∧</mo>
      <mi>D</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>F</ci>
     <vector>
      <ci>B</ci>
      <ci>C</ci>
      <ci>D</ci>
     </vector>
    </apply>
    <apply>
     <or></or>
     <apply>
      <and></and>
      <ci>B</ci>
      <ci>C</ci>
     </apply>
     <apply>
      <and></and>
      <apply>
       <times></times>
       <not></not>
       <ci>B</ci>
      </apply>
      <ci>D</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F(B,C,D)=(B\wedge{C})\vee(\neg{B}\wedge{D})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="MD5:1">
 <semantics>
  <mrow>
   <mrow>
    <mi>G</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>B</mi>
     <mo>,</mo>
     <mi>C</mi>
     <mo>,</mo>
     <mi>D</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mo>∧</mo>
      <mi>D</mi>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mo>∨</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>C</mi>
      <mo>∧</mo>
      <mrow>
       <mi mathvariant="normal">¬</mi>
       <mi>D</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>G</ci>
     <vector>
      <ci>B</ci>
      <ci>C</ci>
      <ci>D</ci>
     </vector>
    </apply>
    <apply>
     <or></or>
     <apply>
      <and></and>
      <ci>B</ci>
      <ci>D</ci>
     </apply>
     <apply>
      <and></and>
      <ci>C</ci>
      <apply>
       <times></times>
       <not></not>
       <ci>D</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   G(B,C,D)=(B\wedge{D})\vee(C\wedge\neg{D})
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="MD5:2">
 <semantics>
  <mrow>
   <mrow>
    <mi>H</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>B</mi>
     <mo>,</mo>
     <mi>C</mi>
     <mo>,</mo>
     <mi>D</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>B</mi>
    <mo>⊕</mo>
    <mi>C</mi>
    <mo>⊕</mo>
    <mi>D</mi>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>H</ci>
     <vector>
      <ci>B</ci>
      <ci>C</ci>
      <ci>D</ci>
     </vector>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>B</ci>
     <ci>C</ci>
     <ci>D</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   H(B,C,D)=B\oplus C\oplus D
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="MD5:3">
 <semantics>
  <mrow>
   <mrow>
    <mi>I</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>B</mi>
     <mo>,</mo>
     <mi>C</mi>
     <mo>,</mo>
     <mi>D</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mi>C</mi>
    <mo>⊕</mo>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>B</mi>
      <mo>∨</mo>
      <mrow>
       <mi mathvariant="normal">¬</mi>
       <mi>D</mi>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>I</ci>
     <vector>
      <ci>B</ci>
      <ci>C</ci>
      <ci>D</ci>
     </vector>
    </apply>
    <apply>
     <csymbol cd="latexml">direct-sum</csymbol>
     <ci>C</ci>
     <apply>
      <or></or>
      <ci>B</ci>
      <apply>
       <times></times>
       <not></not>
       <ci>D</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   I(B,C,D)=C\oplus(B\vee\neg{D})
  </annotation>
 </semantics>
</math>

 

<math display="inline" id="MD5:4">
 <semantics>
  <mrow>
   <mo>⊕</mo>
   <mo>,</mo>
   <mo>∧</mo>
   <mo>,</mo>
   <mo>∨</mo>
   <mo>,</mo>
   <mi mathvariant="normal">¬</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <list>
    <csymbol cd="latexml">direct-sum</csymbol>
    <and></and>
    <or></or>
    <not></not>
   </list>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \oplus,\wedge,\vee,\neg
  </annotation>
 </semantics>
</math>

 denote the <a class="uri" href="XOR" title="wikilink">XOR</a>, <a href="Logical_conjunction" title="wikilink">AND</a>, <a href="Logical_disjunction" title="wikilink">OR</a> and <a href="Negation" title="wikilink">NOT</a> operations respectively.</p>

<p>{{-}}</p>
<h3 id="pseudocode">Pseudocode</h3>

<p>The MD5 hash is calculated according to this algorithm. All values are in <a href="Endianness" title="wikilink">little-endian</a>.</p>

<p><span style="color:green;"><code>//</code><em><code>Note:</code> <code>All</code> <code>variables</code> <code>are</code> <code>unsigned</code> <code>32</code> <code>bit</code> <code>and</code> <code>wrap</code> <code>modulo</code> <code>2^32</code> <code>when</code> <code>calculating</code></em></span><br/>
<strong><code>var</code></strong><code> </code><em><code>int</code></em><code>[64] s, K</code><br/>
<br/>
<span style="color:green;"><code>//</code><em><code>s</code> <code>specifies</code> <code>the</code> <code>per-round</code> <code>shift</code> <code>amounts</code></em></span><br/>
<code>s[ 0..15] := { 7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22 }</code><br/>
<code>s[16..31] := { 5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20 }</code><br/>
<code>s[32..47] := { 4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23 }</code><br/>
<code>s[48..63] := { 6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21 }</code><br/>
<br/>
<span style="color:green;"><code>//</code><em><code>Use</code> <code>binary</code> <code>integer</code> <code>part</code> <code>of</code> <code>the</code> <code>sines</code> <code>of</code> <code>integers</code> <code>(Radians)</code> <code>as</code> <code>constants:</code></em></span><br/>
<strong><code>for</code></strong><code> i </code><strong><code>from</code></strong><code> 0 </code><strong><code>to</code></strong><code> 63</code><br/>
<code>    K[i] := floor(abs(sin(i + 1)) × (2 </code><strong><code>pow</code></strong><code> 32))</code><br/>
<strong><code>end</code> <code>for</code></strong><br/>
<span style="color:green;"><code>//</code><em><code>(Or</code> <code>just</code> <code>use</code> <code>the</code> <code>following</code> <code>table):</code></em></span><br/>
<code>K[ 0.. 3] := { 0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee }</code><br/>
<code>K[ 4.. 7] := { 0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501 }</code><br/>
<code>K[ 8..11] := { 0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be }</code><br/>
<code>K[12..15] := { 0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821 }</code><br/>
<code>K[16..19] := { 0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa }</code><br/>
<code>K[20..23] := { 0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8 }</code><br/>
<code>K[24..27] := { 0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed }</code><br/>
<code>K[28..31] := { 0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a }</code><br/>
<code>K[32..35] := { 0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c }</code><br/>
<code>K[36..39] := { 0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70 }</code><br/>
<code>K[40..43] := { 0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05 }</code><br/>
<code>K[44..47] := { 0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665 }</code><br/>
<code>K[48..51] := { 0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039 }</code><br/>
<code>K[52..55] := { 0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1 }</code><br/>
<code>K[56..59] := { 0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1 }</code><br/>
<code>K[60..63] := { 0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391 }</code><br/>
<br/>
<span style="color:green;"><code>//</code><em><code>Initialize</code> <code>variables:</code></em></span><br/>
<strong><code>var</code></strong><code> </code><em><code>int</code></em><code> a0 := 0x67452301   </code><span style="color:green;"><code>//A</code></span><br/>
<strong><code>var</code></strong><code> </code><em><code>int</code></em><code> b0 := 0xefcdab89   </code><span style="color:green;"><code>//B</code></span><br/>
<strong><code>var</code></strong><code> </code><em><code>int</code></em><code> c0 := 0x98badcfe   </code><span style="color:green;"><code>//C</code></span><br/>
<strong><code>var</code></strong><code> </code><em><code>int</code></em><code> d0 := 0x10325476   </code><span style="color:green;"><code>//D</code></span></p>

<p><span style="color:green;">//<em>Pre-processing: adding a single 1 bit</em></span></p>

<p><strong><code>append</code></strong><code> "1" bit </code><strong><code>to</code></strong><code> message</code></p>

<p><span style="color:green;"></span></p>

<p><code>/* Notice: the input bytes are considered as bits strings,</code><br/>
<code>  where the first bit is the most significant bit of the byte.</code><a class="footnoteRef" href="#fn51" id="fnref51"><sup>51</sup></a></p>

<p> <span style="color:green;">//<em>Pre-processing: padding with zeros</em></span></p>

<p><strong><code>append</code></strong><code> "0" bit </code><strong><code>until</code></strong><code> message length in bits ≡ 448 (mod 512)</code><br/>
<strong><code>append</code></strong><code> original length in bits </code><strong><code>mod</code></strong><code> (2 </code><strong><code>pow</code></strong><code> 64) </code><strong><code>to</code></strong><code> message</code><br/>
</p>

<p><span style="color:green;">//<em>Process the message in successive 512-bit chunks:</em></span></p>

<p><strong><code>for</code> <code>each</code></strong><code> </code><em><code>512-bit</code></em><code> chunk </code><strong><code>of</code></strong><code> message</code><br/>
<code>    break chunk into sixteen 32-bit words M[j], 0 ≤ j ≤ 15</code><br/>
<span style="color:green;"><code>//</code><em><code>Initialize</code> <code>hash</code> <code>value</code> <code>for</code> <code>this</code> <code>chunk:</code></em></span><br/>
<code>    </code><strong><code>var</code></strong><code> </code><em><code>int</code></em><code> A := a0</code><br/>
<code>    </code><strong><code>var</code></strong><code> </code><em><code>int</code></em><code> B := b0</code><br/>
<code>    </code><strong><code>var</code></strong><code> </code><em><code>int</code></em><code> C := c0</code><br/>
<code>    </code><strong><code>var</code></strong><code> </code><em><code>int</code></em><code> D := d0</code><br/>
<span style="color:green;"><code>//</code><em><code>Main</code> <code>loop:</code></em></span><br/>
<code>    </code><strong><code>for</code></strong><code> i </code><strong><code>from</code></strong><code> 0 </code><strong><code>to</code></strong><code> 63</code><br/>
<code>        </code><strong><code>if</code></strong><code> 0 ≤ i ≤ 15 </code><strong><code>then</code></strong><br/>
<code>            F := (B </code><strong><code>and</code></strong><code> C) </code><strong><code>or</code></strong><code> ((</code><strong><code>not</code></strong><code> B) </code><strong><code>and</code></strong><code> D)</code><br/>
<code>            g := i</code><br/>
<code>        </code><strong><code>else</code> <code>if</code></strong><code> 16 ≤ i ≤ 31</code><br/>
<code>            F := (D </code><strong><code>and</code></strong><code> B) </code><strong><code>or</code></strong><code> ((</code><strong><code>not</code></strong><code> D) </code><strong><code>and</code></strong><code> C)</code><br/>
<code>            g := (5×i + 1) </code><strong><code>mod</code></strong><code> 16</code><br/>
<code>        </code><strong><code>else</code> <code>if</code></strong><code> 32 ≤ i ≤ 47</code><br/>
<code>            F := B </code><strong><code>xor</code></strong><code> C </code><strong><code>xor</code></strong><code> D</code><br/>
<code>            g := (3×i + 5) </code><strong><code>mod</code></strong><code> 16</code><br/>
<code>        </code><strong><code>else</code> <code>if</code></strong><code> 48 ≤ i ≤ 63</code><br/>
<code>            F := C </code><strong><code>xor</code></strong><code> (B </code><strong><code>or</code></strong><code> (</code><strong><code>not</code></strong><code> D))</code><br/>
<code>            g := (7×i) </code><strong><code>mod</code></strong><code> 16</code><br/>
<code>        dTemp := D</code><br/>
<code>        D := C</code><br/>
<code>        C := B</code><br/>
<code>        B := B + </code><strong><code>leftrotate</code></strong><code>((A + F + K[i] + M[g]), s[i])</code><br/>
<code>        A := dTemp</code><br/>
<code>    </code><strong><code>end</code> <code>for</code></strong><br/>
<span style="color:green;"><code>//</code><em><code>Add</code> <code>this</code> <code>chunk's</code> <code>hash</code> <code>to</code> <code>result</code> <code>so</code> <code>far:</code></em></span><br/>
<code>    a0 := a0 + A</code><br/>
<code>    b0 := b0 + B</code><br/>
<code>    c0 := c0 + C</code><br/>
<code>    d0 := d0 + D</code><br/>
<strong><code>end</code> <code>for</code></strong><br/>
<br/>
<strong><code>var</code></strong><code> </code><em><code>char</code></em><code> digest[16] := a0 </code><strong><code>append</code></strong><code> b0 </code><strong><code>append</code></strong><code> c0 </code><strong><code>append</code></strong><code> d0 </code><span style="color:green;"><code>//</code><em><code>(Output</code> <code>is</code> <code>in</code> <code>little-endian)</code></em></span></p>

<p><span style="color:green;">//<em>leftrotate function definition</em></span></p>

<p><strong><code>leftrotate</code></strong><code> (x, c)</code><br/>
<code>    </code><strong><code>return</code></strong><code> (x </code><code>&gt; (32-c));</code></p>

<p><em>Note: Instead of the formulation from the original RFC 1321 shown, the following may be used for improved efficiency (useful if assembly language is being used – otherwise, the compiler will generally optimize the above code. Since each computation is dependent on another in these formulations, this is often slower than the above method where the nand/and can be parallelised):</em></p>

<p><code>( 0 ≤ i ≤ 15): F := D </code><strong><code>xor</code></strong><code> (B </code><strong><code>and</code></strong><code> (C </code><strong><code>xor</code></strong><code> D))</code><br/>
<code>(16 ≤ i ≤ 31): F := C </code><strong><code>xor</code></strong><code> (D </code><strong><code>and</code></strong><code> (B </code><strong><code>xor</code></strong><code> C))</code></p>
<h2 id="md5-hashes">MD5 hashes</h2>

<p>The 128-bit (16-byte) MD5 hashes (also termed <em>message digests</em>) are typically represented as a sequence of 32 <a class="uri" href="hexadecimal" title="wikilink">hexadecimal</a> digits. The following demonstrates a 43-byte <a class="uri" href="ASCII" title="wikilink">ASCII</a> input and the corresponding MD5 hash:</p>

<p><code>MD5("</code><a href="The_quick_brown_fox_jumps_over_the_lazy_dog" title="wikilink"><code>The</code> <code>quick</code> <code>brown</code> <code>fox</code> <code>jumps</code> <code>over</code> <code>the</code> <code>lazy</code> <code>dog</code></a><code>") =</code><br/>
<code>9e107d9d372bb6826bd81d3542a419d6</code></p>

<p>Even a small change in the message will (with overwhelming probability) result in a mostly different hash, due to the <a href="avalanche_effect" title="wikilink">avalanche effect</a>. For example, adding a period to the end of the sentence:</p>

<p><code>MD5("</code><a href="The_quick_brown_fox_jumps_over_the_lazy_dog" title="wikilink"><code>The</code> <code>quick</code> <code>brown</code> <code>fox</code> <code>jumps</code> <code>over</code> <code>the</code> <code>lazy</code> <code>dog</code></a><code>") = </code><br/>
<code>e4d909c290d0fb1ca068ffaddf22cbd0</code></p>

<p>The hash of the zero-length string is:</p>

<p><code>MD5("") = </code><br/>
<code>d41d8cd98f00b204e9800998ecf8427e</code></p>

<p>The MD5 algorithm is specified for messages consisting of any number of bits; it is not limited to multiples of eight bit (<a href="Octet_(computing)" title="wikilink">octets</a>, <a href="byte" title="wikilink">bytes</a>) as shown in the examples above. Some MD5 implementations such as <a class="uri" href="md5sum" title="wikilink">md5sum</a> might be limited to octets, or they might not support <em>streaming</em> for messages of an initially undetermined length</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Comparison_of_cryptographic_hash_functions" title="wikilink">Comparison of cryptographic hash functions</a></li>
<li><a class="uri" href="HashClash" title="wikilink">HashClash</a></li>
<li><a class="uri" href="md5deep" title="wikilink">md5deep</a></li>
<li><a class="uri" href="md5sum" title="wikilink">md5sum</a></li>
<li><a class="uri" href="MD6" title="wikilink">MD6</a></li>
</ul>
<h2 id="notes">Notes</h2>
<h2 id="references">References</h2>
<ul>
<li></li>
<li></li>
<li>Hans Dobbertin, Cryptanalysis of MD5 compress. Announcement on Internet, May 1996. </li>
<li></li>
<li></li>
</ul>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.w3.org/TR/1998/REC-DSig-label/MD5-1_0">W3C recommendation on MD5</a></li>
</ul>

<p>"</p>

<p><a href="Category:Articles_with_example_pseudocode" title="wikilink">Category:Articles with example pseudocode</a> <a href="Category:Checksum_algorithms" title="wikilink">Category:Checksum algorithms</a> <a href="Category:Broken_hash_functions" title="wikilink">Category:Broken hash functions</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4">Xiaoyun Wang, Dengguo ,k.,m.,m, HAVAL-128 and <a class="uri" href="RIPEMD" title="wikilink">RIPEMD</a>, Cryptology ePrint Archive Report 2004/199, 16 August 2004, revised 17 August 2004. Retrieved 27 July 2008.<a href="#fnref4">↩</a></li>
<li id="fn5">J. Black, M. Cochran, T. Highland: <a href="http://www.cs.colorado.edu/~jrblack/papers/md5e-full.pdf">A Study of the MD5 Attacks: Insights and Improvements</a>, 3 March 2006. Retrieved 27 July 2008.<a href="#fnref5">↩</a></li>
<li id="fn6">Marc Stevens, Arjen Lenstra, Benne de Weger: <a href="http://www.win.tue.nl/hashclash/SoftIntCodeSign/">Vulnerability of software integrity and code signing applications to chosen-prefix collisions for MD5</a>, 30 November 2007. Retrieved 27 July 2008.<a href="#fnref6">↩</a></li>
<li id="fn7"> <a href="http://events.ccc.de/congress/2008/Fahrplan/events/3023.en.html">Announced</a> at the 25th <a href="Chaos_Communication_Congress" title="wikilink">Chaos Communication Congress</a>.<a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
<li id="fn9"><a href="#fnref9">↩</a></li>
<li id="fn10"><a href="#fnref10">↩</a></li>
<li id="fn11"></li>
<li id="fn12">Philip Hawkes and Michael Paddon and Gregory G. Rose: <a href="http://eprint.iacr.org/2004/264">Musings on the Wang et al. MD5 Collision</a>, 13 October 2004. Retrieved 27 July 2008.<a href="#fnref12">↩</a></li>
<li id="fn13"><a href="#fnref13">↩</a></li>
<li id="fn14">Arjen Lenstra, Xiaoyun Wang, Benne de Weger: <a href="http://eprint.iacr.org/2005/067">Colliding X.509 Certificates</a>, Cryptology ePrint Archive Report 2005/067, 1 March 2005, revised 6 May 2005. Retrieved 27 July 2008.<a href="#fnref14">↩</a></li>
<li id="fn15">Vlastimil Klima: <a href="http://eprint.iacr.org/2005/075">Finding MD5 Collisions – a Toy For a Notebook</a>, Cryptology ePrint Archive Report 2005/075, 5 March 2005, revised 8 March 2005. Retrieved 27 July 2008.<a href="#fnref15">↩</a></li>
<li id="fn16">Vlastimil Klima: <a href="http://eprint.iacr.org/2006/105">Tunnels in Hash Functions: MD5 Collisions Within a Minute</a>, Cryptology ePrint Archive Report 2006/105, 18 March 2006, revised 17 April 2006. Retrieved 27 July 2008.<a href="#fnref16">↩</a></li>
<li id="fn17"><a href="#fnref17">↩</a></li>
<li id="fn18"><a href="#fnref18">↩</a></li>
<li id="fn19"><a href="#fnref19">↩</a></li>
<li id="fn20"><a href="#fnref20">↩</a></li>
<li id="fn21"><a href="#fnref21">↩</a></li>
<li id="fn22"><a href="#fnref22">↩</a></li>
<li id="fn23"><a href="#fnref23">↩</a></li>
<li id="fn24"><mtpl></mtpl><a href="#fnref24">↩</a></li>
<li id="fn25"><a href="#fnref25">↩</a></li>
<li id="fn26"><a href="#fnref26">↩</a></li>
<li id="fn27"><a href="#fnref27">↩</a></li>
<li id="fn28"><a href="#fnref28">↩</a></li>
<li id="fn29"></li>
<li id="fn30"><a href="#fnref30">↩</a></li>
<li id="fn31"><a href="#fnref31">↩</a></li>
<li id="fn32"><a href="#fnref32">↩</a></li>
<li id="fn33"><a href="#fnref33">↩</a></li>
<li id="fn34"><a href="#fnref34">↩</a></li>
<li id="fn35"></li>
<li id="fn36"><a href="#fnref36">↩</a></li>
<li id="fn37"><a href="#fnref37">↩</a></li>
<li id="fn38"></li>
<li id="fn39"><a href="#fnref39">↩</a></li>
<li id="fn40"></li>
<li id="fn41"><a href="#fnref41">↩</a></li>
<li id="fn42"><a href="#fnref42">↩</a></li>
<li id="fn43"><a href="#fnref43">↩</a></li>
<li id="fn44"><a href="#fnref44">↩</a></li>
<li id="fn45"><a href="#fnref45">↩</a></li>
<li id="fn46">Steven J. Murdoch: <a href="http://www.lightbluetouchpaper.org/2007/11/16/google-as-a-password-cracker/">Google as a password cracker</a>, Light Blue Touchpaper Blog Archive, 16 November 2007. Retrieved 27 July 2008.<a href="#fnref46">↩</a></li>
<li id="fn47"><a href="#fnref47">↩</a></li>
<li id="fn48"><a href="#fnref48">↩</a></li>
<li id="fn49"><a href="#fnref49">↩</a></li>
<li id="fn50"><a href="#fnref50">↩</a></li>
<li id="fn51"><code>RFC</code> <code>1321,</code> <code>section</code> <code>2,</code> <code>"Terminology</code> <code>and</code> <code>Notation",</code> <code>Page</code> <code>2.</code><a href="#fnref51">↩</a></li>
</ol>
</section>
</body>
</html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="180">Chain rule</title>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript">
</script>
</head>
<body>
<h1>Chain rule</h1>
<hr/>

<p>In <a class="uri" href="calculus" title="wikilink">calculus</a>, the <strong>chain rule</strong> is a <a class="uri" href="formula" title="wikilink">formula</a> for computing the <a class="uri" href="derivative" title="wikilink">derivative</a> of the <a href="Function_composition" title="wikilink">composition</a> of two or more <a href="function_(mathematics)" title="wikilink">functions</a>. That is, if <em>f</em> and <em>g</em> are functions, then the chain rule expresses the derivative of their composition  (the function which maps <em>x</em> to <em>f</em>(<em>g</em>(<em>x</em>)) in terms of the derivatives of <em>f</em> and <em>g</em> and the <a href="pointwise_product" title="wikilink">product of functions</a> as follows:</p>

<p>

<math display="block" id="Chain_rule:0">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>′</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>⋅</mo>
     <msup>
      <mi>g</mi>
      <mo>′</mo>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <compose></compose>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>g</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g)^{\prime}=(f^{\prime}\circ g)\cdot g^{\prime}.
  </annotation>
 </semantics>
</math>

</p>

<p>This can be written more explicitly in terms of the variable. Let , or equivalently,  for all <em>x</em>. Then one can also write</p>

<p>

<math display="block" id="Chain_rule:1">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>F</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>f</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>g</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>F</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   F^{\prime}(x)=f^{\prime}(g(x))g^{\prime}(x).
  </annotation>
 </semantics>
</math>

</p>

<p>The chain rule may be written, in <a href="Leibniz's_notation" title="wikilink">Leibniz's notation</a>, in the following way. We consider <em>z</em> to be a function of the variable <em>y</em>, which is itself a function of <em>x</em> (<em>y</em> and <em>z</em> are therefore <a href="dependent_variable" title="wikilink">dependent variables</a>), and so, <em>z</em> becomes a function of <em>x</em> as well:</p>

<p>

<math display="block" id="Chain_rule:2">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>z</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>z</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>z</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dz}{dx}=\frac{dz}{dy}\cdot\frac{dy}{dx}.
  </annotation>
 </semantics>
</math>

</p>

<p>In <a href="integral" title="wikilink">integration</a>, the counterpart to the chain rule is the <a href="substitution_rule" title="wikilink">substitution rule</a>.</p>
<h2 id="history">History</h2>

<p>The chain rule seems to have first been used by <a href="Gottfried_Wilhelm_Leibniz" title="wikilink">Leibniz</a>. He used it to calculate the derivative of 

<math display="inline" id="Chain_rule:3">
 <semantics>
  <msqrt>
   <mrow>
    <mi>a</mi>
    <mo>+</mo>
    <mrow>
     <mi>b</mi>
     <mi>z</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mi>c</mi>
     <msup>
      <mi>z</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mrow>
  </msqrt>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <root></root>
    <apply>
     <plus></plus>
     <ci>a</ci>
     <apply>
      <times></times>
      <ci>b</ci>
      <ci>z</ci>
     </apply>
     <apply>
      <times></times>
      <ci>c</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>z</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \sqrt{a+bz+cz^{2}}
  </annotation>
 </semantics>
</math>


 as the composite of the square root function and the function 

<math display="inline" id="Chain_rule:4">
 <semantics>
  <mrow>
   <mi>a</mi>
   <mo>+</mo>
   <mrow>
    <mi>b</mi>
    <mi>z</mi>
   </mrow>
   <mo>+</mo>
   <mrow>
    <mi>c</mi>
    <msup>
     <mi>z</mi>
     <mn>2</mn>
    </msup>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <ci>a</ci>
    <apply>
     <times></times>
     <ci>b</ci>
     <ci>z</ci>
    </apply>
    <apply>
     <times></times>
     <ci>c</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>z</ci>
      <cn type="integer">2</cn>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   a+bz+cz^{2}
  </annotation>
 </semantics>
</math>

. He first mentioned it in a 1676 memoir (with a sign error in the calculation). The common notation of chain rule is due to Leibniz.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a> <a href="Guillaume_de_l'Hôpital" title="wikilink">L'Hôpital</a> uses the chain rule implicitly in his <em><a href="Analyse_des_infiniment_petits" title="wikilink">Analyse des infiniment petits</a></em>. The chain rule does not appear in any of <a href="Leonhard_Euler" title="wikilink">Leonhard Euler</a>'s analysis books, even though they were written over a hundred years after Leibniz's discovery.</p>
<h2 id="one-dimension">One dimension</h2>
<h3 id="first-example">First example</h3>

<p>Suppose that a skydiver jumps from an aircraft. Assume that <em>t</em> seconds after his jump, his height above sea level in meters is given by <mtpl></mtpl>. One model for the <a href="atmospheric_pressure" title="wikilink">atmospheric pressure</a> at a height <em>h</em> is <mtpl></mtpl>. These two equations can be differentiated and combined in various ways to produce the following data:</p>
<ul>
<li>

<p>is the velocity of the skydiver at time <em>t</em>.</p></li>
<li><mtpl></mtpl> is the rate of change in atmospheric pressure with respect to height at the height <em>h</em> and is proportional to the <a href="buoyancy" title="wikilink">buoyant force</a> on the skydiver at <em>h</em> meters above sea level. (The true buoyant force depends on the volume of the skydiver.)</li>
<li>

<p>is the atmospheric pressure the skydiver experiences <em>t</em> seconds after his jump.</p></li>
<li>

<p>is the rate of change in atmospheric pressure with respect to time at <em>t</em> seconds after the skydiver's jump and is proportional to the buoyant force on the skydiver at <em>t</em> seconds after his jump.</p></li>
</ul>

<p>The chain rule gives a method for computing  in terms of  and . While it is always possible to directly apply the definition of the derivative to compute the derivative of a composite function, this is usually very difficult. The utility of the chain rule is that it turns a complicated derivative into several easy derivatives.</p>

<p>The chain rule states that, under appropriate conditions,</p>

<p>

<math display="block" id="Chain_rule:5">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>f</mi>
        <mo>∘</mo>
        <mi>g</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>t</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mi>g</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <compose></compose>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g)^{\prime}(t)=f^{\prime}(g(t))\cdot g^{\prime}(t).
  </annotation>
 </semantics>
</math>

 In this example, this equals</p>

<p>

<math display="block" id="Chain_rule:6">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>f</mi>
        <mo>∘</mo>
        <mi>g</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo maxsize="120%" minsize="120%">(</mo>
      <mrow>
       <mi mathvariant="normal">-</mi>
       <mn>10.1325</mn>
       <msup>
        <mi>e</mi>
        <mrow>
         <mo>-</mo>
         <mrow>
          <mn>0.0001</mn>
          <mrow>
           <mo stretchy="false">(</mo>
           <mrow>
            <mn>4000</mn>
            <mo>-</mo>
            <mrow>
             <mn>4.9</mn>
             <msup>
              <mi>t</mi>
              <mn>2</mn>
             </msup>
            </mrow>
           </mrow>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </msup>
      </mrow>
      <mo maxsize="120%" minsize="120%">)</mo>
     </mrow>
     <mo>⋅</mo>
     <mrow>
      <mo maxsize="120%" minsize="120%">(</mo>
      <mrow>
       <mi mathvariant="normal">-</mi>
       <mn>9.8</mn>
       <mi>t</mi>
      </mrow>
      <mo maxsize="120%" minsize="120%">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <compose></compose>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <ci>t</ci>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <times></times>
      <minus></minus>
      <cn type="float">10.1325</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <minus></minus>
        <apply>
         <times></times>
         <cn type="float">0.0001</cn>
         <apply>
          <minus></minus>
          <cn type="integer">4000</cn>
          <apply>
           <times></times>
           <cn type="float">4.9</cn>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>t</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <minus></minus>
      <cn type="float">9.8</cn>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g)^{\prime}(t)=\big(\mathord{-}10.1325e^{-0.0001(4000-4.9t^{2})}\big)%
\cdot\big(\mathord{-}9.8t\big).
  </annotation>
 </semantics>
</math>

</p>

<p>In the statement of the chain rule, <em>f</em> and <em>g</em> play slightly different roles because <em>f</em>′ is evaluated at <em>g</em>(<em>t</em>) whereas <em>g</em>′ is evaluated at <em>t</em>. This is necessary to make the units work out correctly. For example, suppose that we want to compute the rate of change in atmospheric pressure ten seconds after the skydiver jumps. This is  and has units of <a href="Pascal_(unit)" title="wikilink">Pascals</a> per second. The factor <em>g</em>′(10) in the chain rule is the velocity of the skydiver ten seconds after his jump, and it is expressed in meters per second. <em>f</em>′(<em>g</em>(10)) is the change in pressure with respect to height at the height <em>g</em>(10) and is expressed in Pascals per meter. The product of <em>f</em>′(<em>g</em>(10)) and <em>g</em>′(10) therefore has the correct units of Pascals per second. It is not possible to evaluate <em>f</em> anywhere else. For instance, because the 10 in the problem represents ten seconds, the expression <em>f</em>′(10) represents the change in pressure at a height of ten seconds, which is nonsense. Similarly, because  meters per second, the expression <em>f</em>′(<em>g</em>′(10)) represents the change in pressure at a height of −98 meters per second, which is also nonsense. However, <em>g</em>(10) is 3020 meters above sea level, the height of the skydiver ten seconds after his jump. This has the correct units for an input to <em>f</em>.</p>
<h3 id="statement">Statement</h3>

<p>The simplest form of the chain rule is for real-valued functions of one <a href="real_number" title="wikilink">real</a> variable. It says that if <em>g</em> is a function that is differentiable at a point <em>c</em> (i.e. the derivative <em>g</em>′(<em>c</em>) exists) and <em>f</em> is a function that is differentiable at <em>g</em>(<em>c</em>), then the composite function <em>f</em> ∘ <em>g</em> is differentiable at <em>c</em>, and the derivative is<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a></p>

<p>

<math display="block" id="Chain_rule:7">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>f</mi>
        <mo>∘</mo>
        <mi>g</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>c</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>c</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mi>g</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>c</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <compose></compose>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <ci>c</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>c</ci>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>normal-′</ci>
      </apply>
     </apply>
     <ci>c</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g)^{\prime}(c)=f^{\prime}(g(c))\cdot g^{\prime}(c).
  </annotation>
 </semantics>
</math>

</p>

<p>The rule is sometimes abbreviated as</p>

<p>

<math display="block" id="Chain_rule:8">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>′</mo>
    </msup>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <mo>⋅</mo>
     <msup>
      <mi>g</mi>
      <mo>′</mo>
     </msup>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <compose></compose>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>g</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>normal-′</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g)^{\prime}=(f^{\prime}\circ g)\cdot g^{\prime}.\,
  </annotation>
 </semantics>
</math>

</p>

<p>If  and , then this abbreviated form is written in <a href="Leibniz_notation" title="wikilink">Leibniz notation</a> as:</p>

<p>

<math display="block" id="Chain_rule:9">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>u</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>u</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>u</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dy}{dx}=\frac{dy}{du}\cdot\frac{du}{dx}.
  </annotation>
 </semantics>
</math>

</p>

<p>The points where the derivatives are evaluated may also be stated explicitly:</p>

<p>

<math display="block" id="Chain_rule:10">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mrow>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>y</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>x</mi>
       </mrow>
      </mfrac>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo>=</mo>
      <mi>c</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <msub>
     <mrow>
      <mrow>
       <msub>
        <mrow>
         <mfrac>
          <mrow>
           <mi>d</mi>
           <mi>y</mi>
          </mrow>
          <mrow>
           <mi>d</mi>
           <mi>u</mi>
          </mrow>
         </mfrac>
         <mo fence="true">|</mo>
        </mrow>
        <mrow>
         <mi>u</mi>
         <mo>=</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>c</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </msub>
       <mo>⋅</mo>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>u</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>x</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo>=</mo>
      <mi>c</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>x</ci>
      <ci>c</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="latexml">evaluated-at</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>y</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>u</ci>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>u</ci>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>c</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>x</ci>
      <ci>c</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \left.\frac{dy}{dx}\right|_{x=c}=\left.\frac{dy}{du}\right|_{u=g(c)}\cdot\left%
.\frac{du}{dx}\right|_{x=c}.\,
  </annotation>
 </semantics>
</math>

</p>
<h3 id="further-examples">Further examples</h3>
<h4 id="absence-of-formulas">Absence of formulas</h4>

<p>It may be possible to apply the chain rule even when there are no formulas for the functions which are being differentiated. This can happen when the derivatives are measured directly. Suppose that a car is driving up a tall mountain. The car's speedometer measures its speed directly. If the <a href="grade_(slope)" title="wikilink">grade</a> is known, then the rate of ascent can be calculated using <a class="uri" href="trigonometry" title="wikilink">trigonometry</a>. Suppose that the car is ascending at . Standard models for the Earth's atmosphere imply that the temperature drops about  per kilometer ascended (called the <a href="lapse_rate" title="wikilink">lapse rate</a>). To find the temperature drop per hour, we apply the chain rule. Let the function 

<math display="inline" id="Chain_rule:11">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>t</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>t</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(t)
  </annotation>
 </semantics>
</math>

 be the altitude of the car at time 

<math display="inline" id="Chain_rule:12">
 <semantics>
  <mi>t</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>t</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   t
  </annotation>
 </semantics>
</math>

, and let the function 

<math display="inline" id="Chain_rule:13">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>h</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>h</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(h)
  </annotation>
 </semantics>
</math>


 be the temperature 

<math display="inline" id="Chain_rule:14">
 <semantics>
  <mi>h</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>h</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   h
  </annotation>
 </semantics>
</math>

 kilometers above sea level. 

<math display="inline" id="Chain_rule:15">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Chain_rule:16">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 are not known exactly: For example, the altitude where the car starts is not known and the temperature on the mountain is not known. However, their derivatives are known: 

<math display="inline" id="Chain_rule:17">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mi mathvariant="normal">′</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f′
  </annotation>
 </semantics>
</math>

 is , and 

<math display="inline" id="Chain_rule:18">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mi mathvariant="normal">′</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g′
  </annotation>
 </semantics>
</math>


 is . The chain rule says that the derivative of the composite function is the product of the derivative of 

<math display="inline" id="Chain_rule:19">
 <semantics>
  <mi>f</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>f</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f
  </annotation>
 </semantics>
</math>

 and the derivative of 

<math display="inline" id="Chain_rule:20">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

. This is 

<math display="inline" id="Chain_rule:21">
 <semantics>
  <mrow>
   <mi mathvariant="normal">⋅</mi>
   <mo>=</mo>
   <mi></mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>normal-⋅</ci>
    <csymbol cd="latexml">absent</csymbol>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   ⋅=
  </annotation>
 </semantics>
</math>

.</p>

<p>One of the reasons why this computation is possible is because 

<math display="inline" id="Chain_rule:22">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mi mathvariant="normal">′</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f′
  </annotation>
 </semantics>
</math>

 is a constant function. This is because the above model is very simple. A more accurate description of how the temperature near the car varies over time would require an accurate model of how the temperature varies at different altitudes. This model may not have a constant derivative. To compute the temperature change in such a model, it would be necessary to know 

<math display="inline" id="Chain_rule:23">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>


 and not just 

<math display="inline" id="Chain_rule:24">
 <semantics>
  <mrow>
   <mi>g</mi>
   <mi mathvariant="normal">′</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>g</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g′
  </annotation>
 </semantics>
</math>

, because without knowing 

<math display="inline" id="Chain_rule:25">
 <semantics>
  <mi>g</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>g</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g
  </annotation>
 </semantics>
</math>

 it is not possible to know where to evaluate 

<math display="inline" id="Chain_rule:26">
 <semantics>
  <mrow>
   <mi>f</mi>
   <mi mathvariant="normal">′</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <ci>f</ci>
    <ci>normal-′</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f′
  </annotation>
 </semantics>
</math>

.</p>
<h4 id="composites-of-more-than-two-functions">Composites of more than two functions</h4>

<p>The chain rule can be applied to composites of more than two functions. To take the derivative of a composite of more than two functions, notice that the composite of <em>f</em>, <em>g</em>, and <em>h</em> (in that order) is the composite of <em>f</em> with . The chain rule says that to compute the derivative of , it is sufficient to compute the derivative of <em>f</em> and the derivative of . The derivative of <em>f</em> can be calculated directly, and the derivative of  can be calculated by applying the chain rule again.</p>

<p>For concreteness, consider the function</p>

<p>

<math display="block" id="Chain_rule:27">
 <semantics>
  <mrow>
   <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <msup>
     <mi>e</mi>
     <mrow>
      <mi>sin</mi>
      <msup>
       <mi>x</mi>
       <mn>2</mn>
      </msup>
     </mrow>
    </msup>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>e</ci>
     <apply>
      <sin></sin>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=e^{\sin{x^{2}}}.
  </annotation>
 </semantics>
</math>

 This can be decomposed as the composite of three functions:</p>

<p>

<math display="inline" id="Chain_rule:28">
 <semantics>
  <mi>y</mi>
  <annotation-xml encoding="MathML-Content">
   <ci>y</ci>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle y
  </annotation>
 </semantics>
</math>


 Their derivatives are:</p>

<p>

<math display="inline" id="Chain_rule:29">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>u</mi>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <times></times>
     <ci>d</ci>
     <ci>u</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{dy}{du}
  </annotation>
 </semantics>
</math>


 The chain rule says that the derivative of their composite at the point  is:</p>

<p>

<math display="block" id="Chain_rule:30">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>f</mi>
        <mo>∘</mo>
        <mi>g</mi>
        <mo>∘</mo>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>g</mi>
           <mo>∘</mo>
           <mi>h</mi>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>g</mi>
         <mo>∘</mo>
         <mi>h</mi>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
       <mo>′</mo>
      </msup>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <msup>
          <mi>f</mi>
          <mo>′</mo>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>g</mi>
             <mo>∘</mo>
             <mi>h</mi>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>a</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>⋅</mo>
        <msup>
         <mi>g</mi>
         <mo>′</mo>
        </msup>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>h</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mi>h</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <compose></compose>
        <ci>f</ci>
        <ci>g</ci>
        <ci>h</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <ci>a</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <compose></compose>
          <ci>g</ci>
          <ci>h</ci>
         </apply>
         <ci>a</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <compose></compose>
         <ci>g</ci>
         <ci>h</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>f</ci>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <times></times>
           <apply>
            <compose></compose>
            <ci>g</ci>
            <ci>h</ci>
           </apply>
           <ci>a</ci>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>g</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>a</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g\circ h)^{\prime}(a)=f^{\prime}((g\circ h)(a))\cdot(g\circ h)^{\prime%
}(a)=f^{\prime}((g\circ h)(a))\cdot g^{\prime}(h(a))\cdot h^{\prime}(a).
  </annotation>
 </semantics>
</math>

 In Leibniz notation, this is:</p>

<p>

<math display="block" id="Chain_rule:31">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <msub>
     <mrow>
      <mrow>
       <msub>
        <mrow>
         <mrow>
          <msub>
           <mrow>
            <mfrac>
             <mrow>
              <mi>d</mi>
              <mi>y</mi>
             </mrow>
             <mrow>
              <mi>d</mi>
              <mi>u</mi>
             </mrow>
            </mfrac>
            <mo fence="true">|</mo>
           </mrow>
           <mrow>
            <mi>u</mi>
            <mo>=</mo>
            <mrow>
             <mi>g</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <mrow>
               <mi>h</mi>
               <mrow>
                <mo stretchy="false">(</mo>
                <mi>a</mi>
                <mo stretchy="false">)</mo>
               </mrow>
              </mrow>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
           </mrow>
          </msub>
          <mo>⋅</mo>
          <mfrac>
           <mrow>
            <mi>d</mi>
            <mi>u</mi>
           </mrow>
           <mrow>
            <mi>d</mi>
            <mi>v</mi>
           </mrow>
          </mfrac>
         </mrow>
         <mo fence="true">|</mo>
        </mrow>
        <mrow>
         <mi>v</mi>
         <mo>=</mo>
         <mrow>
          <mi>h</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
       </msub>
       <mo>⋅</mo>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>v</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>x</mi>
        </mrow>
       </mfrac>
      </mrow>
      <mo fence="true">|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo>=</mo>
      <mi>a</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="latexml">evaluated-at</csymbol>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <csymbol cd="latexml">evaluated-at</csymbol>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <csymbol cd="latexml">evaluated-at</csymbol>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>y</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <ci>u</ci>
          </apply>
         </apply>
         <apply>
          <eq></eq>
          <ci>u</ci>
          <apply>
           <times></times>
           <ci>g</ci>
           <apply>
            <times></times>
            <ci>h</ci>
            <ci>a</ci>
           </apply>
          </apply>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>u</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>v</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <eq></eq>
        <ci>v</ci>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>a</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>v</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>x</ci>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dy}{dx}=\left.\frac{dy}{du}\right|_{u=g(h(a))}\cdot\left.\frac{du}{dv}%
\right|_{v=h(a)}\cdot\left.\frac{dv}{dx}\right|_{x=a},
  </annotation>
 </semantics>
</math>

 or for short,</p>

<p>

<math display="block" id="Chain_rule:32">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>u</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>u</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>v</mi>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>v</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>u</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>v</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>v</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dy}{dx}=\frac{dy}{du}\cdot\frac{du}{dv}\cdot\frac{dv}{dx}.
  </annotation>
 </semantics>
</math>

 The derivative function is therefore:</p>

<p>

<math display="block" id="Chain_rule:33">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>sin</mi>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </msup>
     <mo>⋅</mo>
     <mrow>
      <mi>cos</mi>
      <mrow>
       <mrow>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
        <mo>⋅</mo>
        <mn>2</mn>
       </mrow>
       <mi>x</mi>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>e</ci>
      <apply>
       <sin></sin>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>x</ci>
        <cn type="integer">2</cn>
       </apply>
      </apply>
     </apply>
     <apply>
      <cos></cos>
      <apply>
       <times></times>
       <apply>
        <ci>normal-⋅</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
        <cn type="integer">2</cn>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dy}{dx}=e^{\sin{x^{2}}}\cdot\cos{x^{2}}\cdot 2x.
  </annotation>
 </semantics>
</math>

</p>

<p>Another way of computing this derivative is to view the composite function  as the composite of  and <em>h</em>. Applying the chain rule to this situation gives:</p>

<p>

<math display="block" id="Chain_rule:34">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>f</mi>
        <mo>∘</mo>
        <mi>g</mi>
        <mo>∘</mo>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>f</mi>
          <mo>∘</mo>
          <mi>g</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>h</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mi>h</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mrow>
        <mrow>
         <msup>
          <mi>f</mi>
          <mo>′</mo>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>g</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mrow>
             <mi>h</mi>
             <mrow>
              <mo stretchy="false">(</mo>
              <mi>a</mi>
              <mo stretchy="false">)</mo>
             </mrow>
            </mrow>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>⋅</mo>
        <msup>
         <mi>g</mi>
         <mo>′</mo>
        </msup>
       </mrow>
       <mrow>
        <mo stretchy="false">(</mo>
        <mrow>
         <mi>h</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <msup>
       <mi>h</mi>
       <mo>′</mo>
      </msup>
     </mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <compose></compose>
        <ci>f</ci>
        <ci>g</ci>
        <ci>h</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <ci>a</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <compose></compose>
          <ci>f</ci>
          <ci>g</ci>
         </apply>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>a</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <apply>
       <ci>normal-⋅</ci>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>f</ci>
           <ci>normal-′</ci>
          </apply>
          <apply>
           <times></times>
           <ci>g</ci>
           <apply>
            <times></times>
            <ci>h</ci>
            <ci>a</ci>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>g</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <ci>h</ci>
         <ci>a</ci>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>h</ci>
        <ci>normal-′</ci>
       </apply>
      </apply>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g\circ h)^{\prime}(a)=(f\circ g)^{\prime}(h(a))\cdot h^{\prime}(a)=f^{%
\prime}(g(h(a)))\cdot g^{\prime}(h(a))\cdot h^{\prime}(a).
  </annotation>
 </semantics>
</math>

 This is the same as what was computed above. This should be expected because .</p>

<p>Sometimes it is necessary to differentiate an arbitrarily long composition of the form 

<math display="inline" id="Chain_rule:35">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mn>1</mn>
   </msub>
   <mo>∘</mo>
   <msub>
    <mi>f</mi>
    <mn>2</mn>
   </msub>
   <mo>∘</mo>
   <mi mathvariant="normal">…</mi>
   <mo>∘</mo>
   <msub>
    <mi>f</mi>
    <mrow>
     <mi>n</mi>
     <mo>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo>∘</mo>
   <msub>
    <mi>f</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <compose></compose>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">1</cn>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cn type="integer">2</cn>
    </apply>
    <ci>normal-…</ci>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <apply>
      <minus></minus>
      <ci>n</ci>
      <cn type="integer">1</cn>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>n</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{1}\circ f_{2}\circ\ldots\circ f_{n-1}\circ f_{n}
  </annotation>
 </semantics>
</math>

. In this case, define</p>

<p>

<math display="block" id="Chain_rule:36">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mrow>
     <mi>a</mi>
     <mo>.</mo>
     <mo>.</mo>
     <mi>b</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>a</mi>
    </msub>
    <mo>∘</mo>
    <msub>
     <mi>f</mi>
     <mrow>
      <mi>a</mi>
      <mo>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>∘</mo>
    <mi mathvariant="normal">…</mi>
    <mo>∘</mo>
    <msub>
     <mi>f</mi>
     <mrow>
      <mi>b</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo>∘</mo>
    <msub>
     <mi>f</mi>
     <mi>b</mi>
    </msub>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-.</ci>
      <ci>normal-.</ci>
      <csymbol cd="unknown">b</csymbol>
     </cerror>
    </apply>
    <apply>
     <compose></compose>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <ci>normal-…</ci>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <apply>
       <minus></minus>
       <ci>b</ci>
       <cn type="integer">1</cn>
      </apply>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <ci>b</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a..b}=f_{a}\circ f_{a+1}\circ\ldots\circ f_{b-1}\circ f_{b}
  </annotation>
 </semantics>
</math>

 where 

<math display="inline" id="Chain_rule:37">
 <semantics>
  <mrow>
   <msub>
    <mi>f</mi>
    <mrow>
     <mi>a</mi>
     <mo>.</mo>
     <mo>.</mo>
     <mi>a</mi>
    </mrow>
   </msub>
   <mo>=</mo>
   <msub>
    <mi>f</mi>
    <mi>a</mi>
   </msub>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <cerror>
      <csymbol cd="ambiguous">fragments</csymbol>
      <csymbol cd="unknown">a</csymbol>
      <ci>normal-.</ci>
      <ci>normal-.</ci>
      <csymbol cd="unknown">a</csymbol>
     </cerror>
    </apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>f</ci>
     <ci>a</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a..a}=f_{a}
  </annotation>
 </semantics>
</math>

 and 

<math display="inline" id="Chain_rule:38">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>f</mi>
     <mrow>
      <mi>a</mi>
      <mo>.</mo>
      <mo>.</mo>
      <mi>b</mi>
     </mrow>
    </msub>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mi>x</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>f</ci>
      <cerror>
       <csymbol cd="ambiguous">fragments</csymbol>
       <csymbol cd="unknown">a</csymbol>
       <ci>normal-.</ci>
       <ci>normal-.</ci>
       <csymbol cd="unknown">b</csymbol>
      </cerror>
     </apply>
     <ci>x</ci>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{a..b}(x)=x
  </annotation>
 </semantics>
</math>

 when 

<math display="inline" id="Chain_rule:39">
 <semantics>
  <mrow>
   <mi>b</mi>
   <mo><</mo>
   <mi>a</mi>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <lt></lt>
    <ci>b</ci>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   b<a
  </annotation>
 </semantics>
</math>

. Then the chain rule takes the form</p>

<p>

<math display="block" id="Chain_rule:40">
 <semantics>
  <mrow>
   <mrow>
    <mi>D</mi>
    <msub>
     <mi>f</mi>
     <mrow>
      <mn>1..</mn>
      <mi>n</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>D</mi>
       <msub>
        <mi>f</mi>
        <mn>1</mn>
       </msub>
      </mrow>
      <mo>∘</mo>
      <msub>
       <mi>f</mi>
       <mrow>
        <mn>2..</mn>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>D</mi>
       <msub>
        <mi>f</mi>
        <mn>2</mn>
       </msub>
      </mrow>
      <mo>∘</mo>
      <msub>
       <mi>f</mi>
       <mrow>
        <mn>3..</mn>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi mathvariant="normal">…</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mrow>
       <mi>D</mi>
       <msub>
        <mi>f</mi>
        <mrow>
         <mi>n</mi>
         <mo>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
      </mrow>
      <mo>∘</mo>
      <msub>
       <mi>f</mi>
       <mrow>
        <mi>n</mi>
        <mo>.</mo>
        <mo>.</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <mi>D</mi>
    <msub>
     <mi>f</mi>
     <mi>n</mi>
    </msub>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mrow>
       <mi>D</mi>
       <msub>
        <mi>f</mi>
        <mi>k</mi>
       </msub>
      </mrow>
      <mo>∘</mo>
      <msub>
       <mi>f</mi>
       <mrow>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>k</mi>
         <mo>+</mo>
         <mn>1</mn>
         <mo stretchy="false">)</mo>
        </mrow>
        <mo>.</mo>
        <mo>.</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <ci>D</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <apply>
        <times></times>
        <cn type="float">1..</cn>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <compose></compose>
       <apply>
        <times></times>
        <ci>D</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <apply>
         <times></times>
         <cn type="float">2..</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <compose></compose>
       <apply>
        <times></times>
        <ci>D</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <apply>
         <times></times>
         <cn type="float">3..</cn>
         <ci>n</ci>
        </apply>
       </apply>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <compose></compose>
       <apply>
        <times></times>
        <ci>D</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <apply>
          <minus></minus>
          <ci>n</ci>
          <cn type="integer">1</cn>
         </apply>
        </apply>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">n</csymbol>
         <ci>normal-.</ci>
         <ci>normal-.</ci>
         <csymbol cd="unknown">n</csymbol>
        </cerror>
       </apply>
      </apply>
      <ci>D</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>f</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <csymbol cd="latexml">delimited-[]</csymbol>
       <apply>
        <compose></compose>
        <apply>
         <times></times>
         <ci>D</ci>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>f</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <cerror>
          <csymbol cd="ambiguous">fragments</csymbol>
          <cerror>
           <csymbol cd="ambiguous">fragments</csymbol>
           <ci>normal-(</ci>
           <csymbol cd="unknown">k</csymbol>
           <plus></plus>
           <cn type="integer">1</cn>
           <ci>normal-)</ci>
          </cerror>
          <ci>normal-.</ci>
          <ci>normal-.</ci>
          <csymbol cd="unknown">n</csymbol>
         </cerror>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Df_{1..n}=(Df_{1}\circ f_{2..n})(Df_{2}\circ f_{3..n})\ldots(Df_{n-1}\circ f_{%
n..n})Df_{n}=\prod_{k=1}^{n}\left[Df_{k}\circ f_{(k+1)..n}\right]
  </annotation>
 </semantics>
</math>

 or, in the Lagrange notation,</p>

<p>

<math display="block" id="Chain_rule:41">
 <semantics>
  <mrow>
   <mrow>
    <msubsup>
     <mi>f</mi>
     <mrow>
      <mn>1..</mn>
      <mi>n</mi>
     </mrow>
     <mo>′</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <msubsup>
     <mi>f</mi>
     <mn>1</mn>
     <mo>′</mo>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>f</mi>
       <mrow>
        <mn>2..</mn>
        <mi>n</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo rspace="5.3pt">)</mo>
    </mrow>
    <msubsup>
     <mi>f</mi>
     <mn>2</mn>
     <mo>′</mo>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>f</mi>
       <mrow>
        <mn>3..</mn>
        <mi>n</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo rspace="5.3pt">)</mo>
    </mrow>
    <mpadded width="+2.8pt">
     <mi mathvariant="normal">…</mi>
    </mpadded>
    <msubsup>
     <mi>f</mi>
     <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mn>1</mn>
     </mrow>
     <mo>′</mo>
    </msubsup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>f</mi>
       <mrow>
        <mi>n</mi>
        <mo>.</mo>
        <mo>.</mo>
        <mi>n</mi>
       </mrow>
      </msub>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo rspace="5.3pt">)</mo>
    </mrow>
    <msubsup>
     <mi>f</mi>
     <mi>n</mi>
     <mo>′</mo>
    </msubsup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <munderover>
     <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
     <mrow>
      <mi>k</mi>
      <mo>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mrow>
     <msubsup>
      <mi>f</mi>
      <mi>k</mi>
      <mo>′</mo>
     </msubsup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>k</mi>
          <mo>+</mo>
          <mrow>
           <mn>1..</mn>
           <mi>n</mi>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </msub>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <apply>
         <times></times>
         <cn type="float">1..</cn>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <apply>
         <times></times>
         <cn type="float">2..</cn>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cn type="integer">2</cn>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <apply>
         <times></times>
         <cn type="float">3..</cn>
         <ci>n</ci>
        </apply>
       </apply>
       <ci>x</ci>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <apply>
         <minus></minus>
         <ci>n</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <cerror>
         <csymbol cd="ambiguous">fragments</csymbol>
         <csymbol cd="unknown">n</csymbol>
         <ci>normal-.</ci>
         <ci>normal-.</ci>
         <csymbol cd="unknown">n</csymbol>
        </cerror>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>f</ci>
        <ci>n</ci>
       </apply>
       <ci>normal-′</ci>
      </apply>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <csymbol cd="latexml">product</csymbol>
        <apply>
         <eq></eq>
         <ci>k</ci>
         <cn type="integer">1</cn>
        </apply>
       </apply>
       <ci>n</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <ci>k</ci>
        </apply>
        <ci>normal-′</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>f</ci>
         <apply>
          <plus></plus>
          <ci>k</ci>
          <apply>
           <times></times>
           <cn type="float">1..</cn>
           <ci>n</ci>
          </apply>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f_{1..n}^{\prime}(x)=f_{1}^{\prime}\left(f_{2..n}(x)\right)\;f_{2}^{\prime}%
\left(f_{3..n}(x)\right)\;\ldots\;f_{n-1}^{\prime}\left(f_{n..n}(x)\right)\;f_%
{n}^{\prime}(x)=\prod_{k=1}^{n}f_{k}^{\prime}\left(f_{(k+1..n)}(x)\right)
  </annotation>
 </semantics>
</math>

</p>
<h4 id="quotient-rule">Quotient rule</h4>

<p>The chain rule can be used to derive some well-known differentiation rules. For example, the quotient rule is a consequence of the chain rule and the <a href="product_rule" title="wikilink">product rule</a>. To see this, write the function <em>f</em>(<em>x</em>)/<em>g</em>(<em>x</em>) as the product . First apply the product rule:</p>

<p>

<math display="inline" id="Chain_rule:42">
 <semantics>
  <mrow>
   <mstyle displaystyle="true">
    <mfrac>
     <mi>d</mi>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
   </mstyle>
   <mrow>
    <mo>(</mo>
    <mstyle displaystyle="true">
     <mfrac>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mstyle>
    <mo>)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <divide></divide>
     <ci>d</ci>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{d}{dx}\left(\frac{f(x)}{g(x)}\right)
  </annotation>
 </semantics>
</math>


 To compute the derivative of 1/<em>g</em>(<em>x</em>), notice that it is the composite of <em>g</em> with the reciprocal function, that is, the function that sends <em>x</em> to 1/<em>x</em>. The derivative of the reciprocal function is −1/<em>x</em><sup>2</sup>. By applying the chain rule, the last expression becomes:</p>

<p>

<math display="block" id="Chain_rule:43">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mrow>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>⋅</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>-</mo>
        <mrow>
         <mrow>
          <mfrac>
           <mn>1</mn>
           <mrow>
            <mi>g</mi>
            <msup>
             <mrow>
              <mo stretchy="false">(</mo>
              <mi>x</mi>
              <mo stretchy="false">)</mo>
             </mrow>
             <mn>2</mn>
            </msup>
           </mrow>
          </mfrac>
          <mo>⋅</mo>
          <msup>
           <mi>g</mi>
           <mo>′</mo>
          </msup>
         </mrow>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>x</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mrow>
      <mrow>
       <msup>
        <mi>f</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <msup>
        <mi>g</mi>
        <mo>′</mo>
       </msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mi>g</mi>
      <msup>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
    </mfrac>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <plus></plus>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>x</ci>
      </apply>
      <apply>
       <divide></divide>
       <cn type="integer">1</cn>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <ci>normal-⋅</ci>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <apply>
         <ci>normal-⋅</ci>
         <apply>
          <divide></divide>
          <cn type="integer">1</cn>
          <apply>
           <times></times>
           <ci>g</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>x</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <ci>g</ci>
          <ci>normal-′</ci>
         </apply>
        </apply>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>f</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>x</ci>
       <ci>g</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <ci>f</ci>
       <ci>x</ci>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <ci>g</ci>
        <ci>normal-′</ci>
       </apply>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{\prime}(x)\cdot\frac{1}{g(x)}+f(x)\cdot\left(-\frac{1}{g(x)^{2}}\cdot g^{%
\prime}(x)\right)=\frac{f^{\prime}(x)g(x)-f(x)g^{\prime}(x)}{g(x)^{2}},
  </annotation>
 </semantics>
</math>

 which is the usual formula for the quotient rule.</p>
<h4 id="derivatives-of-inverse-functions">Derivatives of inverse functions</h4>

<p>Suppose that  has an <a href="inverse_function" title="wikilink">inverse function</a>. Call its inverse function <em>f</em> so that we have . There is a formula for the derivative of <em>f</em> in terms of the derivative of <em>g</em>. To see this, note that <em>f</em> and <em>g</em> satisfy the formula</p>

<p>

<math display="block" id="Chain_rule:44">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mi>x</mi>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>f</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <ci>x</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(g(x))=x.
  </annotation>
 </semantics>
</math>

 Because the functions <em>f</em>(<em>g</em>(<em>x</em>)) and <em>x</em> are equal, their derivatives must be equal. The derivative of <em>x</em> is the constant function with value 1, and the derivative of <em>f</em>(<em>g</em>(<em>x</em>)) is determined by the chain rule. Therefore we have:</p>

<p>

<math display="block" id="Chain_rule:45">
 <semantics>
  <mrow>
   <mrow>
    <msup>
     <mi>f</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>x</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo stretchy="false">)</mo>
    </mrow>
    <msup>
     <mi>g</mi>
     <mo>′</mo>
    </msup>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mn>1.</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>x</ci>
    </apply>
    <cn type="float">1.</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{\prime}(g(x))g^{\prime}(x)=1.
  </annotation>
 </semantics>
</math>

 To express <em>f</em>′ as a function of an independent variable <em>y</em>, we substitute <em>f</em>(<em>y</em>) for <em>x</em> wherever it appears. Then we can solve for <em>f</em>′.</p>

<p>

<math display="inline" id="Chain_rule:46">
 <semantics>
  <mrow>
   <msup>
    <mi>f</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>y</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
   <msup>
    <mi>g</mi>
    <mo>′</mo>
   </msup>
   <mrow>
    <mo stretchy="false">(</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>f</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>g</ci>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>y</ci>
     </apply>
    </apply>
    <apply>
     <csymbol cd="ambiguous">superscript</csymbol>
     <ci>g</ci>
     <ci>normal-′</ci>
    </apply>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>y</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle f^{\prime}(g(f(y)))g^{\prime}(f(y))
  </annotation>
 </semantics>
</math>


</p>

<p>For example, consider the function <mtpl></mtpl>. It has an inverse . Because <mtpl></mtpl>, the above formula says that</p>

<p>

<math display="block" id="Chain_rule:47">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mfrac>
      <mi>d</mi>
      <mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
     </mfrac>
     <mrow>
      <mi>ln</mi>
      <mi>y</mi>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <msup>
      <mi>e</mi>
      <mrow>
       <mi>ln</mi>
       <mi>y</mi>
      </mrow>
     </msup>
    </mfrac>
    <mo>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>y</mi>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <ci>d</ci>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
      </apply>
      <apply>
       <ln></ln>
       <ci>y</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>e</ci>
       <apply>
        <ln></ln>
        <ci>y</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <divide></divide>
      <cn type="integer">1</cn>
      <ci>y</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d}{dy}\ln y=\frac{1}{e^{\ln y}}=\frac{1}{y}.
  </annotation>
 </semantics>
</math>

</p>

<p>This formula is true whenever <em>g</em> is differentiable and its inverse <em>f</em> is also differentiable. This formula can fail when one of these conditions is not true. For example, consider <mtpl></mtpl>. Its inverse is <mtpl></mtpl>, which is not differentiable at zero. If we attempt to use the above formula to compute the derivative of <em>f</em> at zero, then we must evaluate 1/<em>g</em>′(<em>f</em>(0)).  and , so we must evaluate 1/0, which is undefined. Therefore the formula fails in this case. This is not surprising because <em>f</em> is not differentiable at zero.</p>
<h3 id="higher-derivatives">Higher derivatives</h3>

<p><a href="Faà_di_Bruno's_formula" title="wikilink">Faà di Bruno's formula</a> generalizes the chain rule to higher derivatives. Assuming that  and , then the first few derivatives are:</p>

<p>

<math display="block" id="Chain_rule:48">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>x</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>u</mi>
     </mrow>
    </mfrac>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>u</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>u</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>u</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dy}{dx}=\frac{dy}{du}\frac{du}{dx}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Chain_rule:49">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>2</mn>
     </msup>
     <mi>y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>x</mi>
      <mn>2</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>2</mn>
       </msup>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>u</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>u</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>x</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mn>2</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>u</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>2</mn>
       </msup>
       <mi>u</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">2</cn>
      </apply>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">2</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>u</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d^{2}y}{dx^{2}}=\frac{d^{2}y}{du^{2}}\left(\frac{du}{dx}\right)^{2}+%
\frac{dy}{du}\frac{d^{2}u}{dx^{2}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Chain_rule:50">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <msup>
      <mi>d</mi>
      <mn>3</mn>
     </msup>
     <mi>y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <msup>
      <mi>x</mi>
      <mn>3</mn>
     </msup>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mfrac>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>u</mi>
        <mn>3</mn>
       </msup>
      </mrow>
     </mfrac>
     <msup>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mrow>
         <mi>d</mi>
         <mi>u</mi>
        </mrow>
        <mrow>
         <mi>d</mi>
         <mi>x</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mn>3</mn>
     </msup>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mpadded width="+1.7pt">
      <mn>3</mn>
     </mpadded>
     <mfrac>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>2</mn>
       </msup>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>u</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>u</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>x</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>2</mn>
       </msup>
       <mi>u</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>x</mi>
        <mn>2</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mi>d</mi>
       <mi>y</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <mi>u</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
       <mi>u</mi>
      </mrow>
      <mrow>
       <mi>d</mi>
       <msup>
        <mi>x</mi>
        <mn>3</mn>
       </msup>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">3</cn>
      </apply>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">3</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">3</cn>
        </apply>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <cn type="integer">3</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">3</cn>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>x</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>u</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">3</cn>
        </apply>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d^{3}y}{dx^{3}}=\frac{d^{3}y}{du^{3}}\left(\frac{du}{dx}\right)^{3}+3\,%
\frac{d^{2}y}{du^{2}}\frac{du}{dx}\frac{d^{2}u}{dx^{2}}+\frac{dy}{du}\frac{d^{%
3}u}{dx^{3}}
  </annotation>
 </semantics>
</math>

</p>

<p>

<math display="block" id="Chain_rule:51">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <msup>
       <mi>d</mi>
       <mn>4</mn>
      </msup>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <msup>
       <mi>x</mi>
       <mn>4</mn>
      </msup>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
        <mi>y</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>u</mi>
         <mn>4</mn>
        </msup>
       </mrow>
      </mfrac>
      <msup>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <mi>u</mi>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>x</mi>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mn>4</mn>
      </msup>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mpadded width="+1.7pt">
       <mn>6</mn>
      </mpadded>
      <mfrac>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>3</mn>
        </msup>
        <mi>y</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>u</mi>
         <mn>3</mn>
        </msup>
       </mrow>
      </mfrac>
      <msup>
       <mrow>
        <mo>(</mo>
        <mfrac>
         <mrow>
          <mi>d</mi>
          <mi>u</mi>
         </mrow>
         <mrow>
          <mi>d</mi>
          <mi>x</mi>
         </mrow>
        </mfrac>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mfrac>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>2</mn>
        </msup>
        <mi>u</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>x</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>2</mn>
        </msup>
        <mi>y</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>u</mi>
         <mn>2</mn>
        </msup>
       </mrow>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mpadded width="+1.7pt">
          <mn>4</mn>
         </mpadded>
         <mfrac>
          <mrow>
           <mi>d</mi>
           <mi>u</mi>
          </mrow>
          <mrow>
           <mi>d</mi>
           <mi>x</mi>
          </mrow>
         </mfrac>
         <mfrac>
          <mrow>
           <msup>
            <mi>d</mi>
            <mn>3</mn>
           </msup>
           <mi>u</mi>
          </mrow>
          <mrow>
           <mi>d</mi>
           <msup>
            <mi>x</mi>
            <mn>3</mn>
           </msup>
          </mrow>
         </mfrac>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mpadded width="+1.7pt">
          <mn>3</mn>
         </mpadded>
         <msup>
          <mrow>
           <mo>(</mo>
           <mfrac>
            <mrow>
             <msup>
              <mi>d</mi>
              <mn>2</mn>
             </msup>
             <mi>u</mi>
            </mrow>
            <mrow>
             <mi>d</mi>
             <msup>
              <mi>x</mi>
              <mn>2</mn>
             </msup>
            </mrow>
           </mfrac>
           <mo>)</mo>
          </mrow>
          <mn>2</mn>
         </msup>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>d</mi>
        <mi>y</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <mi>u</mi>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
        <mi>u</mi>
       </mrow>
       <mrow>
        <mi>d</mi>
        <msup>
         <mi>x</mi>
         <mn>4</mn>
        </msup>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>d</ci>
       <cn type="integer">4</cn>
      </apply>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>x</ci>
       <cn type="integer">4</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">4</cn>
        </apply>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <cn type="integer">4</cn>
      </apply>
     </apply>
     <apply>
      <times></times>
      <cn type="integer">6</cn>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">3</cn>
        </apply>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">3</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <apply>
        <divide></divide>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>u</ci>
        </apply>
        <apply>
         <times></times>
         <ci>d</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <cn type="integer">2</cn>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">2</cn>
        </apply>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>u</ci>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <cn type="integer">4</cn>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>u</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <ci>x</ci>
         </apply>
        </apply>
        <apply>
         <divide></divide>
         <apply>
          <times></times>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>d</ci>
           <cn type="integer">3</cn>
          </apply>
          <ci>u</ci>
         </apply>
         <apply>
          <times></times>
          <ci>d</ci>
          <apply>
           <csymbol cd="ambiguous">superscript</csymbol>
           <ci>x</ci>
           <cn type="integer">3</cn>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <times></times>
        <cn type="integer">3</cn>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <apply>
          <divide></divide>
          <apply>
           <times></times>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>d</ci>
            <cn type="integer">2</cn>
           </apply>
           <ci>u</ci>
          </apply>
          <apply>
           <times></times>
           <ci>d</ci>
           <apply>
            <csymbol cd="ambiguous">superscript</csymbol>
            <ci>x</ci>
            <cn type="integer">2</cn>
           </apply>
          </apply>
         </apply>
         <cn type="integer">2</cn>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <ci>u</ci>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>d</ci>
         <cn type="integer">4</cn>
        </apply>
        <ci>u</ci>
       </apply>
       <apply>
        <times></times>
        <ci>d</ci>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>x</ci>
         <cn type="integer">4</cn>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{d^{4}y}{dx^{4}}=\frac{d^{4}y}{du^{4}}\left(\frac{du}{dx}\right)^{4}+6\,%
\frac{d^{3}y}{du^{3}}\left(\frac{du}{dx}\right)^{2}\frac{d^{2}u}{dx^{2}}+\frac%
{d^{2}y}{du^{2}}\left(4\,\frac{du}{dx}\frac{d^{3}u}{dx^{3}}+3\,\left(\frac{d^{%
2}u}{dx^{2}}\right)^{2}\right)+\frac{dy}{du}\frac{d^{4}u}{dx^{4}}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="proofs">Proofs</h3>
<h4 id="first-proof">First proof</h4>

<p>One proof of the chain rule begins with the definition of the derivative:</p>

<p>

<math display="block" id="Chain_rule:52">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>f</mi>
        <mo>∘</mo>
        <mi>g</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <munder>
      <mo movablelimits="false">lim</mo>
      <mrow>
       <mi>x</mi>
       <mo>→</mo>
       <mi>a</mi>
      </mrow>
     </munder>
     <mfrac>
      <mrow>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mi>a</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <compose></compose>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
      <ci>normal-′</ci>
     </apply>
     <ci>a</ci>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <limit></limit>
      <apply>
       <ci>normal-→</ci>
       <ci>x</ci>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>a</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   (f\circ g)^{\prime}(a)=\lim_{x\to a}\frac{f(g(x))-f(g(a))}{x-a}.
  </annotation>
 </semantics>
</math>

 Assume for the moment that <em>g</em>(<em>x</em>) does not equal <em>g</em>(<em>a</em>) for any <em>x</em> near <em>a</em>. Then the previous expression is equal to the product of two factors:</p>

<p>

<math display="block" id="Chain_rule:53">
 <semantics>
  <mrow>
   <mrow>
    <munder>
     <mo movablelimits="false">lim</mo>
     <mrow>
      <mi>x</mi>
      <mo>→</mo>
      <mi>a</mi>
     </mrow>
    </munder>
    <mrow>
     <mfrac>
      <mrow>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>x</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
     </mfrac>
     <mo>⋅</mo>
     <mfrac>
      <mrow>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>x</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>-</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mrow>
       <mi>x</mi>
       <mo>-</mo>
       <mi>a</mi>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <limit></limit>
     <apply>
      <ci>normal-→</ci>
      <ci>x</ci>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <ci>normal-⋅</ci>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>a</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>x</ci>
       </apply>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>x</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \lim_{x\to a}\frac{f(g(x))-f(g(a))}{g(x)-g(a)}\cdot\frac{g(x)-g(a)}{x-a}.
  </annotation>
 </semantics>
</math>

 When <em>g</em> oscillates near <em>a</em>, then it might happen that no matter how close one gets to <em>a</em>, there is always an even closer <em>x</em> such that <em>g</em>(<em>x</em>) equals <em>g</em>(<em>a</em>). For example, this happens for <mtpl></mtpl> near the point . Whenever this happens, the above expression is undefined because it involves <a href="division_by_zero" title="wikilink">division by zero</a>. To work around this, introduce a function <em>Q</em> as follows:</p>

<p>

<math display="block" id="Chain_rule:54">
 <semantics>
  <mrow>
   <mrow>
    <mi>Q</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>y</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mo>{</mo>
    <mtable displaystyle="true">
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mstyle displaystyle="false">
         <mfrac>
          <mrow>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>y</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
           <mo>-</mo>
           <mrow>
            <mi>f</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mrow>
              <mi>g</mi>
              <mrow>
               <mo stretchy="false">(</mo>
               <mi>a</mi>
               <mo stretchy="false">)</mo>
              </mrow>
             </mrow>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
          <mrow>
           <mi>y</mi>
           <mo>-</mo>
           <mrow>
            <mi>g</mi>
            <mrow>
             <mo stretchy="false">(</mo>
             <mi>a</mi>
             <mo stretchy="false">)</mo>
            </mrow>
           </mrow>
          </mrow>
         </mfrac>
        </mstyle>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mi>y</mi>
         <mo>≠</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <msup>
          <mi>f</mi>
          <mo>′</mo>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mrow>
           <mi>g</mi>
           <mrow>
            <mo stretchy="false">(</mo>
            <mi>a</mi>
            <mo stretchy="false">)</mo>
           </mrow>
          </mrow>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>,</mo>
       </mrow>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <mrow>
         <mi>y</mi>
         <mo>=</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
        </mrow>
        <mo>.</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <csymbol cd="latexml">cases</csymbol>
     <apply>
      <divide></divide>
      <apply>
       <minus></minus>
       <apply>
        <times></times>
        <ci>f</ci>
        <ci>y</ci>
       </apply>
       <apply>
        <times></times>
        <ci>f</ci>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>a</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <minus></minus>
       <ci>y</ci>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <neq></neq>
      <ci>y</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <eq></eq>
      <ci>y</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(y)=\begin{cases}\frac{f(y)-f(g(a))}{y-g(a)},&y\neq g(a),\\
f^{\prime}(g(a)),&y=g(a).\end{cases}
  </annotation>
 </semantics>
</math>

 We will show that the <a href="difference_quotient" title="wikilink">difference quotient</a> for  is always equal to:</p>

<p>

<math display="block" id="Chain_rule:55">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>⋅</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>a</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo>-</mo>
      <mi>a</mi>
     </mrow>
    </mfrac>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <ci>normal-⋅</ci>
    <apply>
     <times></times>
     <ci>Q</ci>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>x</ci>
     </apply>
    </apply>
    <apply>
     <divide></divide>
     <apply>
      <minus></minus>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <minus></minus>
      <ci>x</ci>
      <ci>a</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(g(x))\cdot\frac{g(x)-g(a)}{x-a}.
  </annotation>
 </semantics>
</math>

 Whenever <em>g</em>(<em>x</em>) is not equal to <em>g</em>(<em>a</em>), this is clear because the factors of  cancel. When <em>g</em>(<em>x</em>) equals <em>g</em>(<em>a</em>), then the difference quotient for  is zero because <em>f</em>(<em>g</em>(<em>x</em>)) equals <em>f</em>(<em>g</em>(<em>a</em>)), and the above product is zero because it equals <em>f</em>′(<em>g</em>(<em>a</em>)) times zero. So the above product is always equal to the difference quotient, and to show that the derivative of  at <em>a</em> exists and to determine its value, we need only show that the limit as <em>x</em> goes to <em>a</em> of the above product exists and determine its value.</p>

<p>To do this, recall that the limit of a product exists if the limits of its factors exist. When this happens, the limit of the product of these two factors will equal the product of the limits of the factors. The two factors are <em>Q</em>(<em>g</em>(<em>x</em>)) and . The latter is the difference quotient for <em>g</em> at <em>a</em>, and because <em>g</em> is differentiable at <em>a</em> by assumption, its limit as <em>x</em> tends to <em>a</em> exists and equals <em>g</em>′(<em>a</em>).</p>

<p>It remains to study <em>Q</em>(<em>g</em>(<em>x</em>)). <em>Q</em> is defined wherever <em>f</em> is. Furthermore, because <em>f</em> is differentiable at <em>g</em>(<em>a</em>) by assumption, <em>Q</em> is continuous at <em>g</em>(<em>a</em>). <em>g</em> is continuous at <em>a</em> because it is differentiable at <em>a</em>, and therefore  is continuous at <em>a</em>. So its limit as <em>x</em> goes to <em>a</em> exists and equals <em>Q</em>(<em>g</em>(<em>a</em>)), which is <em>f</em>′(<em>g</em>(<em>a</em>)).</p>

<p>This shows that the limits of both factors exist and that they equal <em>f</em>′(<em>g</em>(<em>a</em>)) and <em>g</em>′(<em>a</em>), respectively. Therefore the derivative of  at <em>a</em> exists and equals <em>f</em>′(<em>g</em>(<em>a</em>))<em>g</em>′(<em>a</em>).</p>
<h4 id="second-proof">Second proof</h4>

<p>Another way of proving the chain rule is to measure the error in the linear approximation determined by the derivative. This proof has the advantage that it generalizes to several variables. It relies on the following equivalent definition of differentiability at a point: A function <em>g</em> is differentiable at <em>a</em> if there exists a real number <em>g</em>′(<em>a</em>) and a function <em>ε</em>(<em>h</em>) that tends to zero as <em>h</em> tends to zero, and furthermore</p>

<p>

<math display="block" id="Chain_rule:56">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>a</mi>
        <mo>+</mo>
        <mi>h</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>g</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>a</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>g</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>a</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>h</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>ε</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>h</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>h</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <plus></plus>
       <ci>a</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>a</ci>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>g</ci>
       <ci>normal-′</ci>
      </apply>
      <ci>a</ci>
      <ci>h</ci>
     </apply>
     <apply>
      <times></times>
      <ci>ε</ci>
      <ci>h</ci>
      <ci>h</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   g(a+h)-g(a)=g^{\prime}(a)h+\varepsilon(h)h.\,
  </annotation>
 </semantics>
</math>

 Here the left-hand side represents the true difference between the value of <em>g</em> at <em>a</em> and at , whereas the right-hand side represents the approximation determined by the derivative plus an error term.</p>

<p>In the situation of the chain rule, such a function <em>ε</em> exists because <em>g</em> is assumed to be differentiable at <em>a</em>. Again by assumption, a similar function also exists for <em>f</em> at <em>g</em>(<em>a</em>). Calling this function <em>η</em>, we have</p>

<p>

<math display="block" id="Chain_rule:57">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mi>k</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>f</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>k</mi>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>k</mi>
       <mo stretchy="false">)</mo>
      </mrow>
      <mi>k</mi>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
      <ci>k</ci>
     </apply>
     <apply>
      <times></times>
      <ci>η</ci>
      <ci>k</ci>
      <ci>k</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(g(a)+k)-f(g(a))=f^{\prime}(g(a))k+\eta(k)k.\,
  </annotation>
 </semantics>
</math>

 The above definition imposes no constraints on <em>η</em>(0), even though it is assumed that <em>η</em>(<em>k</em>) tends to zero as <em>k</em> tends to zero. If we set , then <em>η</em> is continuous at 0.</p>

<p>Proving the theorem requires studying the difference  as <em>h</em> tends to zero. The first step is to substitute for  using the definition of differentiability of <em>g</em> at <em>a</em>:</p>

<p>

<math display="block" id="Chain_rule:58">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>a</mi>
          <mo>+</mo>
          <mi>h</mi>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <mrow>
         <msup>
          <mi>g</mi>
          <mo>′</mo>
         </msup>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>h</mi>
        </mrow>
        <mo>+</mo>
        <mrow>
         <mi>ε</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>h</mi>
          <mo stretchy="false">)</mo>
         </mrow>
         <mi>h</mi>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <apply>
        <plus></plus>
        <ci>a</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>a</ci>
        <ci>h</ci>
       </apply>
       <apply>
        <times></times>
        <ci>ε</ci>
        <ci>h</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(g(a+h))-f(g(a))=f(g(a)+g^{\prime}(a)h+\varepsilon(h)h)-f(g(a)).
  </annotation>
 </semantics>
</math>

 The next step is to use the definition of differentiability of <em>f</em> at <em>g</em>(<em>a</em>). This requires a term of the form  for some <em>k</em>. In the above equation, the correct <em>k</em> varies with <em>h</em>. Set <mtpl></mtpl> and the right hand side becomes <mtpl></mtpl>. Applying the definition of the derivative gives:</p>

<p>

<math display="block" id="Chain_rule:59">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
        <mo>+</mo>
        <msub>
         <mi>k</mi>
         <mi>h</mi>
        </msub>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>-</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>f</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>k</mi>
       <mi>h</mi>
      </msub>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>k</mi>
        <mi>h</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
      <msub>
       <mi>k</mi>
       <mi>h</mi>
      </msub>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>k</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>h</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>η</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>h</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>k</ci>
       <ci>h</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f(g(a)+k_{h})-f(g(a))=f^{\prime}(g(a))k_{h}+\eta(k_{h})k_{h}.\,
  </annotation>
 </semantics>
</math>

 To study the behavior of this expression as <em>h</em> tends to zero, expand <em>k</em><sub><em>h</em></sub>. After regrouping the terms, the right-hand side becomes:</p>

<p>

<math display="block" id="Chain_rule:60">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msup>
      <mi>f</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>a</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msup>
      <mi>g</mi>
      <mo>′</mo>
     </msup>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>a</mi>
      <mo stretchy="false">)</mo>
     </mrow>
     <mi>h</mi>
    </mrow>
    <mo>+</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">[</mo>
      <mrow>
       <mrow>
        <msup>
         <mi>f</mi>
         <mo>′</mo>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mrow>
          <mi>g</mi>
          <mrow>
           <mo stretchy="false">(</mo>
           <mi>a</mi>
           <mo stretchy="false">)</mo>
          </mrow>
         </mrow>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>ε</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>h</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>η</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>k</mi>
          <mi>h</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <msup>
         <mi>g</mi>
         <mo>′</mo>
        </msup>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo>+</mo>
       <mrow>
        <mi>η</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>k</mi>
          <mi>h</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
        <mi>ε</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>h</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
      </mrow>
      <mo stretchy="false">]</mo>
     </mrow>
     <mi>h</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <plus></plus>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>f</ci>
      <ci>normal-′</ci>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>a</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <ci>g</ci>
      <ci>normal-′</ci>
     </apply>
     <ci>a</ci>
     <ci>h</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="latexml">delimited-[]</csymbol>
      <apply>
       <plus></plus>
       <apply>
        <times></times>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>f</ci>
         <ci>normal-′</ci>
        </apply>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>a</ci>
        </apply>
        <ci>ε</ci>
        <ci>h</ci>
       </apply>
       <apply>
        <times></times>
        <ci>η</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>h</ci>
        </apply>
        <apply>
         <csymbol cd="ambiguous">superscript</csymbol>
         <ci>g</ci>
         <ci>normal-′</ci>
        </apply>
        <ci>a</ci>
       </apply>
       <apply>
        <times></times>
        <ci>η</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>k</ci>
         <ci>h</ci>
        </apply>
        <ci>ε</ci>
        <ci>h</ci>
       </apply>
      </apply>
     </apply>
     <ci>h</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   f^{\prime}(g(a))g^{\prime}(a)h+[f^{\prime}(g(a))\varepsilon(h)+\eta(k_{h})g^{%
\prime}(a)+\eta(k_{h})\varepsilon(h)]h.\,
  </annotation>
 </semantics>
</math>

 Because <em>ε</em>(<em>h</em>) and <em>η</em>(<em>k</em><sub><em>h</em></sub>) tend to zero as <em>h</em> tends to zero, the first two bracketed terms tend to zero as <em>h</em> tends to zero. Applying the same theorem on products of limits as in the first proof, the third bracketed term also tends zero. Because the above expression is equal to the difference , by the definition of the derivative  is differentiable at <em>a</em> and its derivative is </p>

<p>The role of <em>Q</em> in the first proof is played by <em>η</em> in this proof. They are related by the equation:</p>

<p>

<math display="block" id="Chain_rule:61">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>Q</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>y</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <msup>
       <mi>f</mi>
       <mo>′</mo>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>g</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>a</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mi>η</mi>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>y</mi>
        <mo>-</mo>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>a</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>Q</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <times></times>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <ci>f</ci>
       <ci>normal-′</ci>
      </apply>
      <apply>
       <times></times>
       <ci>g</ci>
       <ci>a</ci>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>η</ci>
      <apply>
       <minus></minus>
       <ci>y</ci>
       <apply>
        <times></times>
        <ci>g</ci>
        <ci>a</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   Q(y)=f^{\prime}(g(a))+\eta(y-g(a)).\,
  </annotation>
 </semantics>
</math>

 The need to define <em>Q</em> at <em>g</em>(<em>a</em>) is analogous to the need to define <em>η</em> at zero.</p>
<h3 id="proof-via-infinitesimals">Proof via infinitesimals</h3>

<p>If 

<math display="inline" id="Chain_rule:62">
 <semantics>
  <mrow>
   <mi>y</mi>
   <mo>=</mo>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>x</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>y</ci>
    <apply>
     <times></times>
     <ci>f</ci>
     <ci>x</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   y=f(x)
  </annotation>
 </semantics>
</math>


 and 

<math display="inline" id="Chain_rule:63">
 <semantics>
  <mrow>
   <mi>x</mi>
   <mo>=</mo>
   <mrow>
    <mi>g</mi>
    <mrow>
     <mo stretchy="false">(</mo>
     <mi>t</mi>
     <mo stretchy="false">)</mo>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <ci>x</ci>
    <apply>
     <times></times>
     <ci>g</ci>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   x=g(t)
  </annotation>
 </semantics>
</math>

 then choosing infinitesimal 

<math display="inline" id="Chain_rule:64">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
   </mrow>
   <mo>≠</mo>
   <mn>0</mn>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <neq></neq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>t</ci>
    </apply>
    <cn type="integer">0</cn>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta t\not=0
  </annotation>
 </semantics>
</math>

 we compute the corresponding 

<math display="inline" id="Chain_rule:65">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>x</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>t</mi>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>t</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>g</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>t</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>x</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>g</ci>
      <apply>
       <plus></plus>
       <ci>t</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>t</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>t</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta x=g(t+\Delta t)-g(t)
  </annotation>
 </semantics>
</math>

 and then the corresponding 

<math display="inline" id="Chain_rule:66">
 <semantics>
  <mrow>
   <mrow>
    <mi mathvariant="normal">Δ</mi>
    <mi>y</mi>
   </mrow>
   <mo>=</mo>
   <mrow>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>x</mi>
       <mo>+</mo>
       <mrow>
        <mi mathvariant="normal">Δ</mi>
        <mi>x</mi>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
     <mi>f</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>x</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>normal-Δ</ci>
     <ci>y</ci>
    </apply>
    <apply>
     <minus></minus>
     <apply>
      <times></times>
      <ci>f</ci>
      <apply>
       <plus></plus>
       <ci>x</ci>
       <apply>
        <times></times>
        <ci>normal-Δ</ci>
        <ci>x</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <times></times>
      <ci>f</ci>
      <ci>x</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \Delta y=f(x+\Delta x)-f(x)
  </annotation>
 </semantics>
</math>

, so that</p>

<p>

<math display="block" id="Chain_rule:67">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>y</mi>
    </mrow>
    <mrow>
     <mi mathvariant="normal">Δ</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mfrac>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>x</mi>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>normal-Δ</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <ci>normal-Δ</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\Delta y}{\Delta t}=\frac{\Delta y}{\Delta x}\frac{\Delta x}{\Delta t}
  </annotation>
 </semantics>
</math>

 and applying the <a href="standard_part" title="wikilink">standard part</a> we obtain</p>

<p>

<math display="block" id="Chain_rule:68">
 <semantics>
  <mrow>
   <mfrac>
    <mrow>
     <mi>d</mi>
     <mi>y</mi>
    </mrow>
    <mrow>
     <mi>d</mi>
     <mi>t</mi>
    </mrow>
   </mfrac>
   <mo>=</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
    </mfrac>
    <mfrac>
     <mrow>
      <mi>d</mi>
      <mi>x</mi>
     </mrow>
     <mrow>
      <mi>d</mi>
      <mi>t</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <ci>d</ci>
      <ci>t</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>y</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>x</ci>
      </apply>
      <apply>
       <times></times>
       <ci>d</ci>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{dy}{dt}=\frac{dy}{dx}\frac{dx}{dt}
  </annotation>
 </semantics>
</math>

 which is the chain rule.</p>
<h2 id="higher-dimensions">Higher dimensions</h2>

<p>The simplest generalization of the chain rule to higher dimensions uses the <a href="Total_derivative#The_total_derivative_as_a_linear_map" title="wikilink">total derivative</a>. The total derivative is a linear transformation that captures how the function changes in all directions. Fix differentiable functions <mtpl></mtpl> and <mtpl></mtpl> and a point <strong>a</strong> in <strong>R</strong><sup><em>n</em></sup>. Let <em>D</em><sub><strong>a</strong></sub><em>g</em> denote the total derivative of <em>g</em> at <strong>a</strong> and <em>D</em><sub><em>g</em>(<strong>a</strong>)</sub><em>f</em> denote the total derivative of <em>f</em> at <em>g</em>(<strong>a</strong>). These two derivatives are linear transformations <mtpl></mtpl> and <mtpl></mtpl>, respectively, so they can be composed. The chain rule for total derivatives says that their composite is the total derivative of  at <strong>a</strong>:</p>

<p>

<math display="block" id="Chain_rule:69">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>D</mi>
      <mi>𝐚</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <msub>
        <mi>D</mi>
        <mrow>
         <mi>g</mi>
         <mrow>
          <mo stretchy="false">(</mo>
          <mi>𝐚</mi>
          <mo stretchy="false">)</mo>
         </mrow>
        </mrow>
       </msub>
       <mi>f</mi>
      </mrow>
      <mo>∘</mo>
      <msub>
       <mi>D</mi>
       <mi>𝐚</mi>
      </msub>
     </mrow>
     <mi>g</mi>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>D</ci>
      <ci>𝐚</ci>
     </apply>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>D</ci>
        <apply>
         <times></times>
         <ci>g</ci>
         <ci>𝐚</ci>
        </apply>
       </apply>
       <ci>f</ci>
      </apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>D</ci>
       <ci>𝐚</ci>
      </apply>
     </apply>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D_{\mathbf{a}}(f\circ g)=D_{g(\mathbf{a})}f\circ D_{\mathbf{a}}g,
  </annotation>
 </semantics>
</math>

 or for short,</p>

<p>

<math display="block" id="Chain_rule:70">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <mi>D</mi>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>f</mi>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mi>D</mi>
       <mi>f</mi>
      </mrow>
      <mo>∘</mo>
      <mi>D</mi>
     </mrow>
     <mi>g</mi>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <ci>D</ci>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <compose></compose>
      <apply>
       <times></times>
       <ci>D</ci>
       <ci>f</ci>
      </apply>
      <ci>D</ci>
     </apply>
     <ci>g</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   D(f\circ g)=Df\circ Dg.
  </annotation>
 </semantics>
</math>

 The higher-dimensional chain rule can be proved using a technique similar to the second proof given above.</p>

<p>Because the total derivative is a linear transformation, the functions appearing in the formula can be rewritten as matrices. The matrix corresponding to a total derivative is called a <a href="Jacobian_matrix" title="wikilink">Jacobian matrix</a>, and the composite of two derivatives corresponds to the product of their Jacobian matrices. From this perspective the chain rule therefore says:</p>

<p>

<math display="block" id="Chain_rule:71">
 <semantics>
  <mrow>
   <mrow>
    <mrow>
     <msub>
      <mi>J</mi>
      <mrow>
       <mi>f</mi>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐚</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <msub>
      <mi>J</mi>
      <mi>f</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <mi>g</mi>
       <mrow>
        <mo stretchy="false">(</mo>
        <mi>𝐚</mi>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>J</mi>
      <mi>g</mi>
     </msub>
     <mrow>
      <mo stretchy="false">(</mo>
      <mi>𝐚</mi>
      <mo stretchy="false">)</mo>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>J</ci>
      <apply>
       <compose></compose>
       <ci>f</ci>
       <ci>g</ci>
      </apply>
     </apply>
     <ci>𝐚</ci>
    </apply>
    <apply>
     <times></times>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>J</ci>
      <ci>f</ci>
     </apply>
     <apply>
      <times></times>
      <ci>g</ci>
      <ci>𝐚</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>J</ci>
      <ci>g</ci>
     </apply>
     <ci>𝐚</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{f\circ g}(\mathbf{a})=J_{f}(g(\mathbf{a}))J_{g}(\mathbf{a}),
  </annotation>
 </semantics>
</math>

 or for short,</p>

<p>

<math display="block" id="Chain_rule:72">
 <semantics>
  <mrow>
   <mrow>
    <msub>
     <mi>J</mi>
     <mrow>
      <mi>f</mi>
      <mo>∘</mo>
      <mi>g</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mo stretchy="false">(</mo>
      <mrow>
       <msub>
        <mi>J</mi>
        <mi>f</mi>
       </msub>
       <mo>∘</mo>
       <mi>g</mi>
      </mrow>
      <mo stretchy="false">)</mo>
     </mrow>
     <msub>
      <mi>J</mi>
      <mi>g</mi>
     </msub>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <apply>
      <compose></compose>
      <ci>f</ci>
      <ci>g</ci>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <compose></compose>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>J</ci>
       <ci>f</ci>
      </apply>
      <ci>g</ci>
     </apply>
     <apply>
      <csymbol cd="ambiguous">subscript</csymbol>
      <ci>J</ci>
      <ci>g</ci>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   J_{f\circ g}=(J_{f}\circ g)J_{g}.
  </annotation>
 </semantics>
</math>

</p>

<p>That is, the Jacobian of the composite function is the product of the Jacobians of the composed functions (evaluated at the appropriate points).</p>

<p>The higher-dimensional chain rule is a generalization of the one-dimensional chain rule. If <em>k</em>, <em>m</em>, and <em>n</em> are 1, so that  and , then the Jacobian matrices of <em>f</em> and <em>g</em> are . Specifically, they are:</p>

<p>

<math display="inline" id="Chain_rule:73">
 <semantics>
  <mrow>
   <msub>
    <mi>J</mi>
    <mi>g</mi>
   </msub>
   <mrow>
    <mo stretchy="false">(</mo>
    <mi>a</mi>
    <mo stretchy="false">)</mo>
   </mrow>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <times></times>
    <apply>
     <csymbol cd="ambiguous">subscript</csymbol>
     <ci>J</ci>
     <ci>g</ci>
    </apply>
    <ci>a</ci>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle J_{g}(a)
  </annotation>
 </semantics>
</math>


 The Jacobian of <em>f</em> ∘ <em>g</em> is the product of these  matrices, so it is , as expected from the one-dimensional chain rule. In the language of linear transformations, <em>D</em><sub><em>a</em></sub>(<em>g</em>) is the function which scales a vector by a factor of <em>g</em>′(<em>a</em>) and <em>D</em><sub><em>g</em>(<em>a</em>)</sub>(<em>f</em>) is the function which scales a vector by a factor of <em>f</em>′(<em>g</em>(<em>a</em>)). The chain rule says that the composite of these two linear transformations is the linear transformation <mtpl></mtpl>, and therefore it is the function that scales a vector by <em>f</em>′(<em>g</em>(<em>a</em>))⋅<em>g</em>′(<em>a</em>).</p>

<p>Another way of writing the chain rule is used when <em>f</em> and <em>g</em> are expressed in terms of their components as <mtpl></mtpl> and <mtpl></mtpl>. In this case, the above rule for Jacobian matrices is usually written as:</p>

<p>

<math display="block" id="Chain_rule:74">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>x</mi>
        <mi>n</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>u</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>u</mi>
         <mi>m</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>u</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>u</mi>
         <mi>m</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>x</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>x</mi>
         <mi>n</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>n</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>n</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial(y_{1},\ldots,y_{k})}{\partial(x_{1},\ldots,x_{n})}=\frac{%
\partial(y_{1},\ldots,y_{k})}{\partial(u_{1},\ldots,u_{m})}\frac{\partial(u_{1%
},\ldots,u_{m})}{\partial(x_{1},\ldots,x_{n})}.
  </annotation>
 </semantics>
</math>

</p>

<p>The chain rule for total derivatives implies a chain rule for partial derivatives. Recall that when the total derivative exists, the partial derivative in the <em>i</em>th coordinate direction is found by multiplying the Jacobian matrix by the <em>i</em>th basis vector. By doing this to the formula above, we find:</p>

<p>

<math display="block" id="Chain_rule:75">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>y</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>y</mi>
         <mi>k</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>u</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>u</mi>
         <mi>m</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow>
       <mo>∂</mo>
       <mrow>
        <mo stretchy="false">(</mo>
        <msub>
         <mi>u</mi>
         <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mi mathvariant="normal">…</mi>
        <mo>,</mo>
        <msub>
         <mi>u</mi>
         <mi>m</mi>
        </msub>
        <mo stretchy="false">)</mo>
       </mrow>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
     </mfrac>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <times></times>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>y</ci>
        <ci>k</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>m</ci>
       </apply>
      </apply>
     </apply>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <cn type="integer">1</cn>
       </apply>
       <ci>normal-…</ci>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>u</ci>
        <ci>m</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial(y_{1},\ldots,y_{k})}{\partial x_{i}}=\frac{\partial(y_{1},%
\ldots,y_{k})}{\partial(u_{1},\ldots,u_{m})}\frac{\partial(u_{1},\ldots,u_{m})%
}{\partial x_{i}}.
  </annotation>
 </semantics>
</math>

 Since the entries of the Jacobian matrix are partial derivatives, we may simplify the above formula to get:</p>

<p>

<math display="block" id="Chain_rule:76">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mrow>
       <mo stretchy="false">(</mo>
       <msub>
        <mi>y</mi>
        <mn>1</mn>
       </msub>
       <mo>,</mo>
       <mi mathvariant="normal">…</mi>
       <mo>,</mo>
       <msub>
        <mi>y</mi>
        <mi>k</mi>
       </msub>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mrow>
         <mo stretchy="false">(</mo>
         <msub>
          <mi>y</mi>
          <mn>1</mn>
         </msub>
         <mo>,</mo>
         <mi mathvariant="normal">…</mi>
         <mo>,</mo>
         <msub>
          <mi>y</mi>
          <mi>k</mi>
         </msub>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>u</mi>
         <mi mathvariant="normal">ℓ</mi>
        </msub>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>u</mi>
         <mi mathvariant="normal">ℓ</mi>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <cn type="integer">1</cn>
      </apply>
      <ci>normal-…</ci>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>y</ci>
       <ci>k</ci>
      </apply>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>normal-ℓ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <cn type="integer">1</cn>
        </apply>
        <ci>normal-…</ci>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>y</ci>
         <ci>k</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>normal-ℓ</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>normal-ℓ</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial(y_{1},\ldots,y_{k})}{\partial x_{i}}=\sum_{\ell=1}^{m}\frac{%
\partial(y_{1},\ldots,y_{k})}{\partial u_{\ell}}\frac{\partial u_{\ell}}{%
\partial x_{i}}.
  </annotation>
 </semantics>
</math>

 More conceptually, this rule expresses the fact that a change in the <em>x</em><sub><em>i</em></sub> direction may change all of <em>g</em><sub>1</sub> through <em>g</em><sub><em>k</em></sub>, and any of these changes may affect <em>f</em>.</p>

<p>In the special case where , so that <em>f</em> is a real-valued function, then this formula simplifies even further:</p>

<p>

<math display="block" id="Chain_rule:77">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <munderover>
      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
      <mrow>
       <mi mathvariant="normal">ℓ</mi>
       <mo>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>m</mi>
     </munderover>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>y</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>u</mi>
         <mi mathvariant="normal">ℓ</mi>
        </msub>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>u</mi>
         <mi mathvariant="normal">ℓ</mi>
        </msub>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>y</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <apply>
      <csymbol cd="ambiguous">superscript</csymbol>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <apply>
        <eq></eq>
        <ci>normal-ℓ</ci>
        <cn type="integer">1</cn>
       </apply>
      </apply>
      <ci>m</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>y</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>normal-ℓ</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>u</ci>
         <ci>normal-ℓ</ci>
        </apply>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial y}{\partial x_{i}}=\sum_{\ell=1}^{m}\frac{\partial y}{\partial u%
_{\ell}}\frac{\partial u_{\ell}}{\partial x_{i}}.
  </annotation>
 </semantics>
</math>

 This can be rewritten as a <a href="dot_product" title="wikilink">dot product</a>. Recalling that <mtpl> (<em>g</em><sub>1</sub>, ..., <em>g</em><sub><em>m</em></sub>)}}</mtpl>, the partial derivative <mtpl></mtpl> is also a vector, and the chain rule says that:</p>

<p>

<math display="block" id="Chain_rule:78">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mo>∇</mo>
     <mrow>
      <mi>f</mi>
      <mo>⋅</mo>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>𝐮</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <partialdiff></partialdiff>
      <ci>y</ci>
     </apply>
     <apply>
      <partialdiff></partialdiff>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <ci>x</ci>
       <ci>i</ci>
      </apply>
     </apply>
    </apply>
    <apply>
     <ci>normal-∇</ci>
     <apply>
      <ci>normal-⋅</ci>
      <ci>f</ci>
      <apply>
       <divide></divide>
       <apply>
        <partialdiff></partialdiff>
        <ci>𝐮</ci>
       </apply>
       <apply>
        <partialdiff></partialdiff>
        <apply>
         <csymbol cd="ambiguous">subscript</csymbol>
         <ci>x</ci>
         <ci>i</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial y}{\partial x_{i}}=\nabla f\cdot\frac{\partial\mathbf{u}}{%
\partial x_{i}}.
  </annotation>
 </semantics>
</math>

</p>
<h3 id="example">Example</h3>

<p>Given <mtpl></mtpl> where  and <mtpl></mtpl>, determine the value of  and  using the chain rule.</p>

<p>

<math display="block" id="Chain_rule:79">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <mo>∂</mo>
      <mi>u</mi>
     </mrow>
     <mrow>
      <mo>∂</mo>
      <mi>r</mi>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>u</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>x</mi>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>x</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>r</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>u</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>y</mi>
       </mrow>
      </mfrac>
      <mfrac>
       <mrow>
        <mo>∂</mo>
        <mi>y</mi>
       </mrow>
       <mrow>
        <mo>∂</mo>
        <mi>r</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mn>2</mn>
        <mi>x</mi>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mrow>
        <mi>sin</mi>
        <mrow>
         <mo stretchy="false">(</mo>
         <mi>t</mi>
         <mo stretchy="false">)</mo>
        </mrow>
       </mrow>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>2</mn>
       <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="false">(</mo>
       <mn>0</mn>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
     <mn>2</mn>
     <mi>r</mi>
     <mrow>
      <msup>
       <mi>sin</mi>
       <mn>2</mn>
      </msup>
      <mrow>
       <mo stretchy="false">(</mo>
       <mi>t</mi>
       <mo stretchy="false">)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>,</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <and></and>
    <apply>
     <eq></eq>
     <apply>
      <divide></divide>
      <apply>
       <partialdiff></partialdiff>
       <ci>u</ci>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <ci>r</ci>
      </apply>
     </apply>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>x</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>u</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>y</ci>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>y</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <ci>r</ci>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <plus></plus>
      <apply>
       <times></times>
       <apply>
        <times></times>
        <cn type="integer">2</cn>
        <ci>x</ci>
       </apply>
       <apply>
        <sin></sin>
        <ci>t</ci>
       </apply>
      </apply>
      <apply>
       <times></times>
       <cn type="integer">2</cn>
       <cn type="integer">0</cn>
      </apply>
     </apply>
    </apply>
    <apply>
     <eq></eq>
     <share href="#.cmml">
     </share>
     <apply>
      <times></times>
      <cn type="integer">2</cn>
      <ci>r</ci>
      <apply>
       <apply>
        <csymbol cd="ambiguous">superscript</csymbol>
        <sin></sin>
        <cn type="integer">2</cn>
       </apply>
       <ci>t</ci>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial u}{\partial r}=\frac{\partial u}{\partial x}\frac{\partial x}{%
\partial r}+\frac{\partial u}{\partial y}\frac{\partial y}{\partial r}=(2x)(%
\sin(t))+(2)(0)=2r\sin^{2}(t),
  </annotation>
 </semantics>
</math>

 and</p>

<p>

<math display="inline" id="Chain_rule:80">
 <semantics>
  <mstyle displaystyle="true">
   <mfrac>
    <mrow>
     <mo>∂</mo>
     <mi>u</mi>
    </mrow>
    <mrow>
     <mo>∂</mo>
     <mi>t</mi>
    </mrow>
   </mfrac>
  </mstyle>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <divide></divide>
    <apply>
     <partialdiff></partialdiff>
     <ci>u</ci>
    </apply>
    <apply>
     <partialdiff></partialdiff>
     <ci>t</ci>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \displaystyle\frac{\partial u}{\partial t}
  </annotation>
 </semantics>
</math>


</p>
<h3 id="higher-derivatives-of-multivariable-functions">Higher derivatives of multivariable functions</h3>

<p>Faà di Bruno's formula for higher-order derivatives of single-variable functions generalizes to the multivariable case. If  is a function of  as above, then the second derivative of  is:</p>

<p>

<math display="block" id="Chain_rule:81">
 <semantics>
  <mrow>
   <mrow>
    <mfrac>
     <mrow>
      <msup>
       <mo>∂</mo>
       <mn>2</mn>
      </msup>
      <mi>y</mi>
     </mrow>
     <mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mrow>
       <mo>∂</mo>
       <msub>
        <mi>x</mi>
        <mi>j</mi>
       </msub>
      </mrow>
     </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mi>k</mi>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <mi>y</mi>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>u</mi>
           <mi>k</mi>
          </msub>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <msup>
           <mo>∂</mo>
           <mn>2</mn>
          </msup>
          <msub>
           <mi>u</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mrow>
          <mrow>
           <mo>∂</mo>
           <msub>
            <mi>x</mi>
            <mi>i</mi>
           </msub>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <msub>
            <mi>x</mi>
            <mi>j</mi>
           </msub>
          </mrow>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>+</mo>
     <mrow>
      <munder>
       <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
       <mrow>
        <mi>k</mi>
        <mo>,</mo>
        <mi mathvariant="normal">ℓ</mi>
       </mrow>
      </munder>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <mrow>
          <msup>
           <mo>∂</mo>
           <mn>2</mn>
          </msup>
          <mi>y</mi>
         </mrow>
         <mrow>
          <mrow>
           <mo>∂</mo>
           <msub>
            <mi>u</mi>
            <mi>k</mi>
           </msub>
          </mrow>
          <mrow>
           <mo>∂</mo>
           <msub>
            <mi>u</mi>
            <mi mathvariant="normal">ℓ</mi>
           </msub>
          </mrow>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>u</mi>
           <mi>k</mi>
          </msub>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
         </mrow>
        </mfrac>
        <mfrac>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>u</mi>
           <mi mathvariant="normal">ℓ</mi>
          </msub>
         </mrow>
         <mrow>
          <mo>∂</mo>
          <msub>
           <mi>x</mi>
           <mi>j</mi>
          </msub>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mrow>
   </mrow>
   <mo>.</mo>
  </mrow>
  <annotation-xml encoding="MathML-Content">
   <apply>
    <eq></eq>
    <apply>
     <divide></divide>
     <apply>
      <apply>
       <csymbol cd="ambiguous">superscript</csymbol>
       <partialdiff></partialdiff>
       <cn type="integer">2</cn>
      </apply>
      <ci>y</ci>
     </apply>
     <apply>
      <times></times>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>i</ci>
       </apply>
      </apply>
      <apply>
       <partialdiff></partialdiff>
       <apply>
        <csymbol cd="ambiguous">subscript</csymbol>
        <ci>x</ci>
        <ci>j</ci>
       </apply>
      </apply>
     </apply>
    </apply>
    <apply>
     <plus></plus>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <ci>k</ci>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <ci>y</ci>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>k</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <partialdiff></partialdiff>
          <cn type="integer">2</cn>
         </apply>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <times></times>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>i</ci>
          </apply>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>x</ci>
           <ci>j</ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
     <apply>
      <apply>
       <csymbol cd="ambiguous">subscript</csymbol>
       <sum></sum>
       <list>
        <ci>k</ci>
        <ci>normal-ℓ</ci>
       </list>
      </apply>
      <apply>
       <times></times>
       <apply>
        <divide></divide>
        <apply>
         <apply>
          <csymbol cd="ambiguous">superscript</csymbol>
          <partialdiff></partialdiff>
          <cn type="integer">2</cn>
         </apply>
         <ci>y</ci>
        </apply>
        <apply>
         <times></times>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>u</ci>
           <ci>k</ci>
          </apply>
         </apply>
         <apply>
          <partialdiff></partialdiff>
          <apply>
           <csymbol cd="ambiguous">subscript</csymbol>
           <ci>u</ci>
           <ci>normal-ℓ</ci>
          </apply>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>k</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>i</ci>
         </apply>
        </apply>
       </apply>
       <apply>
        <divide></divide>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>u</ci>
          <ci>normal-ℓ</ci>
         </apply>
        </apply>
        <apply>
         <partialdiff></partialdiff>
         <apply>
          <csymbol cd="ambiguous">subscript</csymbol>
          <ci>x</ci>
          <ci>j</ci>
         </apply>
        </apply>
       </apply>
      </apply>
     </apply>
    </apply>
   </apply>
  </annotation-xml>
  <annotation encoding="application/x-tex">
   \frac{\partial^{2}y}{\partial x_{i}\partial x_{j}}=\sum_{k}\left(\frac{%
\partial y}{\partial u_{k}}\frac{\partial^{2}u_{k}}{\partial x_{i}\partial x_{%
j}}\right)+\sum_{k,\ell}\left(\frac{\partial^{2}y}{\partial u_{k}\partial u_{%
\ell}}\frac{\partial u_{k}}{\partial x_{i}}\frac{\partial u_{\ell}}{\partial x%
_{j}}\right).
  </annotation>
 </semantics>
</math>

</p>
<h2 id="further-generalizations">Further generalizations</h2>

<p>All extensions of calculus have a chain rule. In most of these, the formula remains the same, though the meaning of that formula may be vastly different.</p>

<p>One generalization is to <a href="manifold" title="wikilink">manifolds</a>. In this situation, the chain rule represents the fact that the derivative of  is the composite of the derivative of <em>f</em> and the derivative of <em>g</em>. This theorem is an immediate consequence of the higher dimensional chain rule given above, and it has exactly the same formula.</p>

<p>The chain rule is also valid for <a href="Fréchet_derivative" title="wikilink">Fréchet derivatives</a> in <a href="Banach_space" title="wikilink">Banach spaces</a>. The same formula holds as before. This case and the previous one admit a simultaneous generalization to <a href="Banach_manifold" title="wikilink">Banach manifolds</a>.</p>

<p>In <a href="abstract_algebra" title="wikilink">abstract algebra</a>, the derivative is interpreted as a morphism of modules of <a href="Kähler_differential" title="wikilink">Kähler differentials</a>. A <a href="ring_homomorphism" title="wikilink">ring homomorphism</a> of <a href="commutative_ring" title="wikilink">commutative rings</a>  determines a morphism of Kähler differentials <mtpl></mtpl> which sends an element <em>dr</em> to <em>d</em>(<em>f</em>(<em>r</em>)), the exterior differential of <em>f</em>(<em>r</em>). The formula  holds in this context as well.</p>

<p>The common feature of these examples is that they are expressions of the idea that the derivative is part of a <a class="uri" href="functor" title="wikilink">functor</a>. A functor is an operation on spaces and functions between them. It associates to each space a new space and to each function between two spaces a new function between the corresponding new spaces. In each of the above cases, the functor sends each space to its <a href="tangent_bundle" title="wikilink">tangent bundle</a> and it sends each function to its derivative. For example, in the manifold case, the derivative sends a <em>C</em><sup><em>r</em></sup>-manifold to a <em>C</em><sup><em>r</em>−1</sup>-manifold (its tangent bundle) and a <em>C</em><sup><em>r</em></sup>-function to its total derivative. There is one requirement for this to be a functor, namely that the derivative of a composite must be the composite of the derivatives. This is exactly the formula .</p>

<p>There are also chain rules in <a href="stochastic_calculus" title="wikilink">stochastic calculus</a>. One of these, <a href="Itō's_lemma" title="wikilink">Itō's lemma</a>, expresses the composite of an Itō process (or more generally a <a class="uri" href="semimartingale" title="wikilink">semimartingale</a>) <em>dX</em><sub><em>t</em></sub> with a twice-differentiable function <em>f</em>. In Itō's lemma, the derivative of the composite function depends not only on <em>dX</em><sub><em>t</em></sub> and the derivative of <em>f</em> but also on the second derivative of <em>f</em>. The dependence on the second derivative is a consequence of the non-zero <a href="quadratic_variation" title="wikilink">quadratic variation</a> of the stochastic process, which broadly speaking means that the process can move up and down in a very rough way. This variant of the chain rule is not an example of a functor because the two functions being composed are of different types.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Integration_by_substitution" title="wikilink">Integration by substitution</a></li>
<li><a href="Leibniz_integral_rule" title="wikilink">Leibniz integral rule</a></li>
<li><a href="Quotient_rule" title="wikilink">Quotient rule</a></li>
<li><a href="Triple_product_rule" title="wikilink">Triple product rule</a></li>
<li><a href="Product_rule" title="wikilink">Product rule</a></li>
<li><a href="Automatic_differentiation" title="wikilink">Automatic differentiation</a>, a computational method that makes heavy use of the chain rule to compute exact numerical derivatives.</li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li></li>
<li></li>
<li><a href="Khan_Academy" title="wikilink">Khan Academy</a> <a href="http://www.khanacademy.org/video/the-chain-rule?playlist=Calculus">Lesson 1</a> <a href="http://www.khanacademy.org/video/even-more-chain-rule?playlist=Calculus">Lesson 3</a></li>
<li><a class="uri" href="http://calculusapplets.com/chainrule.html">http://calculusapplets.com/chainrule.html</a></li>
<li><a href="https://sites.google.com/site/khanacnotes/the-chain-rule">The Chain Rule explained</a></li>
</ul>

<p>"</p>

<p><a href="Category:Differentiation_rules" title="wikilink">Category:Differentiation rules</a> <a href="Category:Articles_containing_proofs" title="wikilink">Category:Articles containing proofs</a> <a href="Category:Theorems_in_calculus" title="wikilink">Category:Theorems in calculus</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
</ol>
</section>
</body>
</html>

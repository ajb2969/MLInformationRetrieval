<html lang="en">
<head>
<meta charset="utf-8"/>
<title offset="1158">USB mass storage device class</title></head>
<body>
<h1>USB mass storage device class</h1>
<hr/>
<figure><b>(Figure)</b>
<figcaption>A <a href="USB_flash_drive" title="wikilink">USB flash drive</a> like this one will typically implement the USB mass storage device class.</figcaption>
</figure>

<p>The <strong>USB mass storage device class</strong> (also known as <strong>USB MSC</strong> or <strong>UMS</strong>) is a set of computing <a href="communications_protocol" title="wikilink">communications protocols</a> defined by the <a href="USB_Implementers_Forum" title="wikilink">USB Implementers Forum</a> that makes a <a class="uri" href="USB" title="wikilink">USB</a> device accessible to a host computing device and enables file transfers between the host and the USB device. To a host, the USB device acts as an external hard drive; the protocol set interfaces with a number of storage devices.</p>
<h2 id="uses">Uses</h2>

<p>Devices connected to computers via this standard include:</p>
<ul>
<li>External magnetic <a href="hard_drive" title="wikilink">hard drives</a></li>
<li>External optical drives, including <a class="uri" href="CD" title="wikilink">CD</a> and <a class="uri" href="DVD" title="wikilink">DVD</a> reader and writer drives</li>
<li>Portable <a href="flash_memory" title="wikilink">flash memory</a> <a href="USB_flash_drive" title="wikilink">devices</a></li>
<li><a href="Solid-state_drive" title="wikilink">Solid-state drives</a></li>
<li>Adapters between standard flash <a href="memory_card" title="wikilink">memory cards</a> and USB connections</li>
<li><a href="Digital_camera" title="wikilink">Digital cameras</a></li>
<li><a href="Digital_audio_player" title="wikilink">Digital audio</a> and <a href="portable_media_player" title="wikilink">portable media players</a></li>
<li><a href="Card_reader" title="wikilink">Card readers</a></li>
<li><a href="PDA" title="wikilink">PDAs</a></li>
<li><a href="Mobile_phones" title="wikilink">Mobile phones</a></li>
</ul>

<p>Devices supporting this standard are known as MSC (Mass Storage Class) devices. While MSC is the original abbreviation, UMS (Universal Mass Storage) has also come into common use.</p>
<h2 id="operating-system-support">Operating system support</h2>

<p>Most mainstream <a href="operating_system" title="wikilink">operating systems</a> include support for USB mass storage devices; support on older systems is usually available through patches.</p>
<h3 id="microsoft-windows">Microsoft Windows</h3>

<p>Microsoft Windows has supported MSC since Windows 2000 (Windows NT5). There is no support for USB supplied by Microsoft in Windows before <a href="Windows_95" title="wikilink">Windows 95</a> and <a href="Windows_NT_4.0" title="wikilink">Windows NT 4.0</a>. <a href="Windows_95" title="wikilink">Windows 95</a> OSR2.1, an update to the operating system, featured limited support for USB. During that time no generic USB mass-storage driver was produced by Microsoft (including for <a href="Windows_98" title="wikilink">Windows 98</a>), and a device-specific driver was needed for each type of USB storage device. Third-party, freeware drivers became available for Windows 98 and Windows 98SE, and third-party drivers are also available for Windows NT 4.0. <a href="Windows_2000" title="wikilink">Windows 2000</a> has support (via a generic driver) for standard USB mass-storage devices; <a href="Windows_Me" title="wikilink">Windows Me</a> and all later Windows versions also include support.</p>

<p><a href="Windows_Mobile" title="wikilink">Windows Mobile</a> supports accessing most USB mass-storage devices formatted with <a href="File_Allocation_Table" title="wikilink">FAT</a> on devices with USB Host. However, portable devices typically cannot provide enough power for hard-drive <a href="disk_enclosure" title="wikilink">disk enclosures</a> (a  hard drive typically requires the maximum 2.5 <a href="Watt" title="wikilink">W</a> in the USB specification) without a self-powered <a href="USB_hub" title="wikilink">USB hub</a>. A Windows Mobile device cannot display its file system as a mass-storage device unless the device implementer adds that functionality. However, third-party applications add MSC emulation to most WM devices (commercial Softick CardExport and free WM5torage). Only memory cards (not internal-storage memory) can generally be exported, due to file-systems issues; see <a href="#Device_access" title="wikilink">device access</a>, below.</p>

<p>Windows' <a class="uri" href="AutoRun" title="wikilink">AutoRun</a> feature worked on all removable media, allowing USB storage devices to become a portal for <a href="computer_virus" title="wikilink">computer viruses</a>. Beginning with <a href="Windows_7" title="wikilink">Windows 7</a> Microsoft limited AutoRun to CD and DVD drives, updating previous Windows versions.<a class="footnoteRef" href="#fn1" id="fnref1"><sup>1</sup></a></p>
<h3 id="ms-dos">MS-DOS</h3>

<p>Neither <a class="uri" href="MS-DOS" title="wikilink">MS-DOS</a> nor most compatible operating systems included support for USB. Third-party generic drivers, such as Duse, USBASPI and DOSUSB, are available to support USB mass-storage devices. <a class="uri" href="FreeDOS" title="wikilink">FreeDOS</a> supports USB mass storage as an <a href="Advanced_SCSI_Programming_Interface" title="wikilink">Advanced SCSI Programming Interface</a> (ASPI) interface.</p>
<h3 id="mac-os">Mac OS</h3>

<p><a href="Apple_Computer" title="wikilink">Apple Computer</a>'s <a href="Mac_OS" title="wikilink">Mac OS</a> 9 and <a href="Mac_OS_X" title="wikilink">X</a> support USB mass storage; Mac OS 8.5.1 (an older operating system) supported USB mass storage through an optional driver.</p>
<h3 id="linux">Linux</h3>

<p>The <a href="Linux_kernel" title="wikilink">Linux kernel</a> has supported USB mass-storage devices since its version 2.4 (2001), and a <a class="uri" href="backport" title="wikilink">backport</a> to kernel 2.2.18<a class="footnoteRef" href="#fn2" id="fnref2"><sup>2</sup></a> has been made. In Linux, in addition to generic drivers for USB mass storage device class devices, quirks, bug fixes and additional functionality for devices and controllers (vendor-enabled functions such as <a href="Parallel_ATA" title="wikilink">ATA</a> command pass-through for ATA-USB bridges—useful for <a class="uri" href="S.M.A.R.T." title="wikilink">S.M.A.R.T.</a> [or temperature] monitoring, controlling spin-up and spin-down of disks in hard drives and other options) exist. This includes <a href="Android_(operating_system)" title="wikilink">Android</a>-based devices, which support <a class="uri" href="USB-OTG" title="wikilink">USB-OTG</a>, since Android uses a Linux kernel.</p>
<h3 id="other-unix-related-systems">Other Unix-related systems</h3>

<p><a href="Solaris_Operating_System" title="wikilink">Solaris</a> has supported devices since its version 2.8 (1998), <a class="uri" href="NetBSD" title="wikilink">NetBSD</a> since its version 1.5 (2000), <a class="uri" href="FreeBSD" title="wikilink">FreeBSD</a> since its version 4.0 (2000) and <a class="uri" href="OpenBSD" title="wikilink">OpenBSD</a> since its version 2.7 (2000). Digital UNIX (later known as <a href="Tru64_UNIX" title="wikilink">Tru64 UNIX</a>), has supported USB and USB mass-storage devices since its version 4.0E (1998). <a class="uri" href="AIX" title="wikilink">AIX</a> has supported USB mass-storage devices since its 5.3 T9 and 6.1 T3 versions; however, it is not well-supported and lacks features such as partitioning and general blocking.<a class="footnoteRef" href="#fn3" id="fnref3"><sup>3</sup></a></p>
<h3 id="game-consoles-and-embedded-devices">Game consoles and embedded devices</h3>

<p>The <a href="Xbox_360" title="wikilink">Xbox 360</a> and <a href="PlayStation_3" title="wikilink">PlayStation 3</a> support most mass-storage devices for the data transfer of media such as pictures and music. As of April 2010, the Xbox 360 (a) used a mass-storage device for saved games<a class="footnoteRef" href="#fn4" id="fnref4"><sup>4</sup></a> and the PS3 allowed transfers between devices on a mass-storage device. Independent developers have released drivers for the <a href="TI-84_Plus" title="wikilink">TI-84 Plus</a> and <a href="TI-84_Plus_Silver_Edition" title="wikilink">TI-84 Plus Silver Edition</a> to access USB mass-storage devices.<a class="footnoteRef" href="#fn5" id="fnref5"><sup>5</sup></a> In these calculators, the <a class="uri" href="usb8x" title="wikilink">usb8x</a> driver supports the <a class="uri" href="msd8x" title="wikilink">msd8x</a> user-interface application.</p>
<h2 id="device-access">Device access</h2>

<p>  The USB mass-storage specification provides an interface to a number of industry-standard command sets, allowing a device to disclose its subclass. In practice, there is little support for specifying a command set via its subclass; most drivers only support the <a href="SCSI_command" title="wikilink">SCSI transparent command set</a>, designating their subset of the SCSI command set with their <a href="SCSI_Peripheral_Device_Type" title="wikilink">SCSI Peripheral Device Type</a> (PDT). Subclass codes specify the following command sets:</p>
<ol>
<li>Reduced Block Commands (RBC)</li>
<li><a href="Small_Form_Factor_committee" title="wikilink">SFF</a>-8020i, <a href="MultiMedia_Commands" title="wikilink">MMC</a>-2 (used by ATAPI-style CD and DVD drives)</li>
<li><a href="Quarter-inch_cartridge" title="wikilink">QIC</a>-157 (tape drives)</li>
<li><a href="Uniform_Floppy_Interface" title="wikilink">Uniform Floppy Interface</a> (UFI)</li>
<li>SFF-8070i (used by ARMD-style devices)</li>
<li>SCSI transparent command set (use "inquiry" to obtain the PDT)</li>
</ol>

<p>The specification does not require a particular <a href="file_system" title="wikilink">file system</a> on conforming devices. Based on the specified command set and any subset, it provides a means to read and write sectors of data (similar to the low-level interface used to access a <a href="hard_drive" title="wikilink">hard drive</a>). Operating systems may treat a USB mass-storage device like a hard drive; users may partition it in any format (such as MBR and GPT), and format it with any file system.</p>

<p>Because of its relative simplicity, the most-common file system on <a href="embedded_system" title="wikilink">embedded devices</a> such as <a href="USB_flash_drive" title="wikilink">USB flash drives</a>, cameras, or digital audio players is Microsoft's <a href="File_Allocation_Table" title="wikilink">FAT</a> or <a class="uri" href="FAT32" title="wikilink">FAT32</a> file system (with optional support for <a href="long_filename" title="wikilink">long filenames</a>). Large, USB-based hard disks may be formatted with <a class="uri" href="NTFS" title="wikilink">NTFS</a>, which (except for Windows) is less supported. However, a <a class="uri" href="keydrive" title="wikilink">keydrive</a> or other device may be formatted with another file system (<a href="HFS_Plus" title="wikilink">HFS Plus</a> on an <a href="Apple_Macintosh" title="wikilink">Apple Macintosh</a>, or <a class="uri" href="Ext2" title="wikilink">Ext2</a> on <a class="uri" href="Linux" title="wikilink">Linux</a>, or <a href="Unix_File_System" title="wikilink">Unix File System</a> on <a href="Solaris_(operating_system)" title="wikilink">Solaris</a> or BSD). This choice may limit (or prevent) access to a device's contents by equipment using a different operating system. OS-dependent storage options include <a href="Logical_volume_management" title="wikilink">LVM</a>, partition tables and software encryption.</p>

<p>In cameras, MP3 players and similar devices which must access a file system independent of an external host, the FAT32 file system is preferred by manufacturers. All such devices halt their file-system (<a href="umount" title="wikilink">dismount</a>) before making it available to a host operating system to prevent file-system corruption or other damage (although it is theoretically possible for both devices to use read-only mode or a <a href="cluster_file_system" title="wikilink">cluster file system</a>). Some devices have a write-protection switch (or option) allowing them to be used in read-only mode; this makes files available for shared use without the risk of virus infection.</p>

<p>Two main partitioning schemes are used by vendors of pre-formatted devices. One puts the file system (usually FAT32) directly on the device without partitioning, making it start from sector 0 without additional boot sectors, <a href="Header_(computing)" title="wikilink">headers</a> or partitions. The other uses a DOS partition table (and MBR code), with one partition spanning the entire device. This partition is often aligned to a high power of two of the sectors (such as 1 or 2 MB), common in <a href="SSD" title="wikilink">solid state drives</a> for performance and durability. Some devices with embedded storage resembling a USB mass-storage device (such as MP3 players with a USB port) will report a damaged (or missing) file system if they are reformatted with a different file system. However, most default-partition devices may be repartitioned (by reducing the first partition and file system) with additional partitions. Such devices will use the first partition for their own operations; after connecting to the host system, all partitions are available.</p>

<p>Devices connected by a single USB port may function as multiple USB devices, one of which is a USB mass-storage device. This simplifies distribution and access to drivers and documentation, primarily for the Microsoft Windows and Mac OS X operating systems. Such drivers are required to make full use of the device, usually because it does not fit a standard USB class or has additional functionality. An embedded USB mass-storage device makes it possible to install additional drivers without CD-ROM disks, floppies or Internet access to a vendor website; this is important, since many modern systems are supplied without optical or floppy drives. Internet access may be unavailable because the device provides network access (wireless, <a class="uri" href="GSM" title="wikilink">GSM</a> or Ethernet cards). The embedded USB mass storage is usually made permanently read-only by the vendor, preventing accidental corruption and use for other purposes (although it may be updated with proprietary protocols when performing a firmware upgrade). Advantages of this method of distribution are lower cost, simplified installation and ensuring driver portability.</p>
<h2 id="design">Design</h2>

<p>Some advanced <a href="hard_disk_drive" title="wikilink">hard disk drive</a> commands, such as <a href="Tagged_Command_Queuing" title="wikilink">Tagged Command Queuing</a> and <a href="Native_Command_Queuing" title="wikilink">Native Command Queuing</a> (which may increase performance), <a href="ATA_Secure_Erase" title="wikilink">ATA Secure Erase</a> (which allows all data on the drive to be securely erased) and <a class="uri" href="S.M.A.R.T." title="wikilink">S.M.A.R.T.</a> (accessing indicators of drive reliability) exist as extensions to low-level drive command sets such as <a class="uri" href="SCSI" title="wikilink">SCSI</a>, <a href="ATA_command_set" title="wikilink">ATA</a> and <a href="ATA_Packet_Interface" title="wikilink">ATAPI</a>. These features may not work when the drives are placed in a <a href="disk_enclosure" title="wikilink">disk enclosure</a> that supports a USB mass-storage interface. Some USB mass-storage interfaces are generic, providing basic read-write commands; although that works well for basic data transfers with devices containing hard drives, there is no simple way to send advanced, device-specific commands to such USB mass-storage devices (though, devices may create their own communication protocols over a standard USB control interface). The <a href="USB_Attached_SCSI" title="wikilink">USB Attached SCSI</a> (UAS) protocol, introduced in USB 3.0, fixes several of these issues, including command queuing, command pipes for hardware requiring them, and power management.</p>

<p>Specific USB 2.0 chipsets had proprietary methods of achieving SCSI pass-through, which could be used to read S.M.A.R.T. data from drives using tools such as <a class="uri" href="smartctl" title="wikilink">smartctl</a> (using the <code>-d</code> option followed by "chipset").<a class="footnoteRef" href="#fn6" id="fnref6"><sup>6</sup></a> More recent USB storage chipsets support the <a href="SCSI_/_ATA_Translation" title="wikilink">SCSI / ATA Translation</a> (SAT) as a generic protocol for interacting with ATA (and SATA) devices.<a class="footnoteRef" href="#fn7" id="fnref7"><sup>7</sup></a> Using esoteric ATA or SCSI pass-through commands (such as secure-erase or password protection) when a drive is connected via a USB bridge may cause drive failure, especially with the <a class="uri" href="hdparm" title="wikilink">hdparm</a> utility.<a class="footnoteRef" href="#fn8" id="fnref8"><sup>8</sup></a></p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="Disk_encryption_software" title="wikilink">Disk encryption software</a></li>
<li><a href="Media_Transfer_Protocol" title="wikilink">Media Transfer Protocol</a></li>
<li><a href="Picture_Transfer_Protocol" title="wikilink">Picture Transfer Protocol</a></li>
<li><a href="SCSI_/_ATA_Translation" title="wikilink">SCSI / ATA Translation</a></li>
<li><a href="USB_flash_drive" title="wikilink">USB flash drive</a></li>
<li><a href="USB#MASSSTORAGE" title="wikilink">USB mass storage (USB drive)</a></li>
</ul>
<h2 id="references">References</h2>
<h2 id="external-links">External links</h2>
<ul>
<li><a href="http://www.usb.org/developers/docs/devclass_docs/Mass_Storage_Specification_Overview_v1.4_2-19-2010.pdf">Mass Storage device class specification</a> USB Implementers Forum website</li>
<li><a href="http://www.usb.org/developers/docs/devclass_docs/usb_msc_boot_1.0.pdf">Bootability specification Mass Storage bootability specification</a>  describes how bootable USB mass-storage devices should work</li>
<li><a href="http://www.usb.org/developers/docs/devclass_docs/usbmassbulk_10.pdf">"USB Mass Storage Bulk-Only Transfer"</a> found at <a href="http://usb.org">USB</a> → Developers → Documents → Class Specs → Approved → Mass Storage → Mass Storage Bulk Only 1.0.</li>
<li><a href="http://svn.freebsd.org/viewvc/base/head/sys/dev/usb/storage/">USB Mass Storage Device source code in FreeBSD</a></li>
<li><a href="http://www.kernel.org/git/?p=linux/kernel/git/torvalds/linux-2.6.git;a=tree;f=drivers/usb/storage">USB Mass Storage source code in Linux</a></li>
<li><a href="https://www.technovelty.org/linux/what-actually-happens-when-you-plug-in-a-usb-device.html">What actually happens when you plug in a USB device?</a> Linux kernel internals</li>
</ul>

<p>"</p>

<p><a href="Category:USB" title="wikilink">Mass storage device class</a> <a href="Category:Computer_storage_devices" title="wikilink">Category:Computer storage devices</a> <a href="Category:Computer_storage_buses" title="wikilink">Category:Computer storage buses</a></p>
<section class="footnotes">
<hr/>
<ol>
<li id="fn1"><a href="#fnref1">↩</a></li>
<li id="fn2"><a href="#fnref2">↩</a></li>
<li id="fn3"><a href="#fnref3">↩</a></li>
<li id="fn4"><a href="#fnref4">↩</a></li>
<li id="fn5"><a href="#fnref5">↩</a></li>
<li id="fn6"><a href="#fnref6">↩</a></li>
<li id="fn7"><a href="#fnref7">↩</a></li>
<li id="fn8"><a href="#fnref8">↩</a></li>
</ol>
</section>
</body>
</html>
